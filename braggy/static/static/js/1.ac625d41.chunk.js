(this.webpackJsonp=this.webpackJsonp||[]).push([[1],[function(e,t,r){"use strict";e.exports=r(255)},function(e,t,r){"use strict";function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}r.d(t,"a",function(){return n})},function(e,t,r){"use strict";var n=r(1),i=r(5),o=r(0),a=r.n(o),s=(r(195),r(101)),l=r.n(s),u=r(530),c=r(520),h=r(539),p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(r){var o=t.defaultTheme,s=t.withTheme,p=void 0!==s&&s,f=t.name,d=Object(i.a)(t,["defaultTheme","withTheme","name"]),m=f,v=Object(u.a)(e,Object(n.a)({defaultTheme:o,Component:r,name:f||r.displayName,classNamePrefix:m},d)),g=a.a.forwardRef(function(e,t){e.classes;var s,l=e.innerRef,u=Object(i.a)(e,["classes","innerRef"]),d=v(e),m=u;return("string"===typeof f||p)&&(s=Object(h.a)()||o,f&&(m=Object(c.a)({theme:s,name:f,props:u})),p&&!m.theme&&(m.theme=s)),a.a.createElement(r,Object(n.a)({ref:l||t,classes:d},m))});return l()(g,r),g}},f=r(86);t.a=function(e,t){return p(e,Object(n.a)({defaultTheme:f.a},t))}},function(e,t,r){e.exports=r(423)()},function(e,t,r){e.exports=r(444)()},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(9);function i(e,t){if(null==e)return{};var r,i,o=Object(n.a)(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}},function(e,t,r){"use strict";function n(e){var t,r,i="";if(e)if("object"===typeof e)if(e.push)for(t=0;t<e.length;t++)e[t]&&(r=n(e[t]))&&(i&&(i+=" "),i+=r);else for(t in e)e[t]&&(r=n(t))&&(i&&(i+=" "),i+=r);else"boolean"===typeof e||e.call||(i&&(i+=" "),i+=e);return i}t.a=function(){for(var e,t=0,r="";t<arguments.length;)(e=n(arguments[t++]))&&(r&&(r+=" "),r+=e);return r}},function(e,t,r){e.exports=r(259)()},function(e,t,r){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(256)},function(e,t,r){"use strict";function n(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}r.d(t,"a",function(){return n})},function(e,t,r){var n;!function(){"use strict";var r={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var o=typeof n;if("string"===o||"number"===o)e.push(n);else if(Array.isArray(n)&&n.length){var a=i.apply(null,n);a&&e.push(a)}else if("object"===o)for(var s in n)r.call(n,s)&&n[s]&&e.push(s)}}return e.join(" ")}"undefined"!==typeof e&&e.exports?(i.default=i,e.exports=i):void 0===(n=function(){return i}.apply(t,[]))||(e.exports=n)}()},function(e,t,r){"use strict";t.__esModule=!0;var n,i=r(387),o=(n=i)&&n.__esModule?n:{default:n};t.default=o.default||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}},function(e,t,r){"use strict";t.__esModule=!0;var n,i=r(202),o=(n=i)&&n.__esModule?n:{default:n};t.default=function(e,t,r){return t in e?(0,o.default)(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},function(e,t,r){e.exports=r(382)()},function(e,t,r){"use strict";t.__esModule=!0;var n,i=r(121),o=(n=i)&&n.__esModule?n:{default:n};t.default=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"===typeof t?"undefined":(0,o.default)(t))&&"function"!==typeof t?e:t}},function(e,t,r){"use strict";r.d(t,"a",function(){return o}),r.d(t,"b",function(){return a}),r.d(t,"c",function(){return s});var n=r(0),i=r.n(n);function o(e,t){return i.a.isValidElement(e)&&-1!==t.indexOf(e.type.muiName)}function a(e,t){"function"===typeof e?e(t):e&&(e.current=t)}function s(e,t){return i.a.useMemo(function(){return null==e&&null==t?null:function(r){a(e,r),a(t,r)}},[e,t])}},function(e,t,r){e.exports=r(442)()},function(e,t,r){"use strict";r.d(t,"a",function(){return a});r(1),r(234);var n=r(0),i=r.n(n),o=i.a.createContext({});o.Consumer,o.Provider;function a(e,t){var r=Object(n.useContext)(o);return e||r[t]||t}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"l",function(){return OrthographicCamera}),__webpack_require__.d(__webpack_exports__,"s",function(){return UVMapping}),__webpack_require__.d(__webpack_exports__,"b",function(){return ClampToEdgeWrapping}),__webpack_require__.d(__webpack_exports__,"k",function(){return NearestFilter}),__webpack_require__.d(__webpack_exports__,"h",function(){return LinearFilter}),__webpack_require__.d(__webpack_exports__,"t",function(){return UnsignedByteType}),__webpack_require__.d(__webpack_exports__,"e",function(){return FloatType}),__webpack_require__.d(__webpack_exports__,"m",function(){return RGBAFormat}),__webpack_require__.d(__webpack_exports__,"i",function(){return LuminanceFormat}),__webpack_require__.d(__webpack_exports__,"n",function(){return Raycaster}),__webpack_require__.d(__webpack_exports__,"q",function(){return Shape}),__webpack_require__.d(__webpack_exports__,"a",function(){return CircleGeometry}),__webpack_require__.d(__webpack_exports__,"r",function(){return ShapeGeometry}),__webpack_require__.d(__webpack_exports__,"g",function(){return LineBasicMaterial}),__webpack_require__.d(__webpack_exports__,"p",function(){return ShaderMaterial}),__webpack_require__.d(__webpack_exports__,"c",function(){return Color}),__webpack_require__.d(__webpack_exports__,"u",function(){return Vector2}),__webpack_require__.d(__webpack_exports__,"f",function(){return Line}),__webpack_require__.d(__webpack_exports__,"j",function(){return Mesh}),__webpack_require__.d(__webpack_exports__,"v",function(){return WebGLRenderer}),__webpack_require__.d(__webpack_exports__,"o",function(){return Scene}),__webpack_require__.d(__webpack_exports__,"d",function(){return DataTexture}),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"===typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),"name"in Function.prototype===!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){var t=arguments;if(void 0===e||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(e),n=1;n<arguments.length;n++){var i=t[n];if(void 0!==i&&null!==i)for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])}return r});var _Math={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var e=[],t=0;t<256;t++)e[t]=(t<16?"0":"")+t.toString(16);return function(){var t=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(e[255&t]+e[t>>8&255]+e[t>>16&255]+e[t>>24&255]+"-"+e[255&r]+e[r>>8&255]+"-"+e[r>>16&15|64]+e[r>>24&255]+"-"+e[63&n|128]+e[n>>8&255]+"-"+e[n>>16&255]+e[n>>24&255]+e[255&i]+e[i>>8&255]+e[i>>16&255]+e[i>>24&255]).toUpperCase()}}(),clamp:function(e,t,r){return Math.max(t,Math.min(r,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,r,n,i){return n+(e-t)*(i-n)/(r-t)},lerp:function(e,t,r){return(1-r)*e+r*t},smoothstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*(3-2*e)},smootherstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*_Math.DEG2RAD},radToDeg:function(e){return e*_Math.RAD2DEG},isPowerOfTwo:function(e){return 0===(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}};function Matrix4(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("Matrix4: the constructor no longer reads arguments. use .set() instead.")}function Vector3(e,t,r){this.x=e||0,this.y=t||0,this.z=r||0}function Quaternion(e,t,r,n){this._x=e||0,this._y=t||0,this._z=r||0,this._w=void 0!==n?n:1}function EventDispatcher(){}function Euler(e,t,r,n){this._x=e||0,this._y=t||0,this._z=r||0,this._order=n||Euler.DefaultOrder}function Layers(){this.mask=1}function Matrix3(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.assign(Matrix4.prototype,{isMatrix4:!0,set:function(e,t,r,n,i,o,a,s,l,u,c,h,p,f,d,m){var v=this.elements;return v[0]=e,v[4]=t,v[8]=r,v[12]=n,v[1]=i,v[5]=o,v[9]=a,v[13]=s,v[2]=l,v[6]=u,v[10]=c,v[14]=h,v[3]=p,v[7]=f,v[11]=d,v[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Matrix4).fromArray(this.elements)},copy:function(e){var t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this},copyPosition:function(e){var t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this},extractBasis:function(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this},extractRotation:function(){var e=new Vector3;return function(t){var r=this.elements,n=t.elements,i=1/e.setFromMatrixColumn(t,0).length(),o=1/e.setFromMatrixColumn(t,1).length(),a=1/e.setFromMatrixColumn(t,2).length();return r[0]=n[0]*i,r[1]=n[1]*i,r[2]=n[2]*i,r[3]=0,r[4]=n[4]*o,r[5]=n[5]*o,r[6]=n[6]*o,r[7]=0,r[8]=n[8]*a,r[9]=n[9]*a,r[10]=n[10]*a,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}}(),makeRotationFromEuler:function(e){e&&e.isEuler||console.error("Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,r=e.x,n=e.y,i=e.z,o=Math.cos(r),a=Math.sin(r),s=Math.cos(n),l=Math.sin(n),u=Math.cos(i),c=Math.sin(i);if("XYZ"===e.order){var h=o*u,p=o*c,f=a*u,d=a*c;t[0]=s*u,t[4]=-s*c,t[8]=l,t[1]=p+f*l,t[5]=h-d*l,t[9]=-a*s,t[2]=d-h*l,t[6]=f+p*l,t[10]=o*s}else if("YXZ"===e.order){var m=s*u,v=s*c,g=l*u,y=l*c;t[0]=m+y*a,t[4]=g*a-v,t[8]=o*l,t[1]=o*c,t[5]=o*u,t[9]=-a,t[2]=v*a-g,t[6]=y+m*a,t[10]=o*s}else if("ZXY"===e.order){m=s*u,v=s*c,g=l*u,y=l*c;t[0]=m-y*a,t[4]=-o*c,t[8]=g+v*a,t[1]=v+g*a,t[5]=o*u,t[9]=y-m*a,t[2]=-o*l,t[6]=a,t[10]=o*s}else if("ZYX"===e.order){h=o*u,p=o*c,f=a*u,d=a*c;t[0]=s*u,t[4]=f*l-p,t[8]=h*l+d,t[1]=s*c,t[5]=d*l+h,t[9]=p*l-f,t[2]=-l,t[6]=a*s,t[10]=o*s}else if("YZX"===e.order){var b=o*s,x=o*l,w=a*s,S=a*l;t[0]=s*u,t[4]=S-b*c,t[8]=w*c+x,t[1]=c,t[5]=o*u,t[9]=-a*u,t[2]=-l*u,t[6]=x*c+w,t[10]=b-S*c}else if("XZY"===e.order){b=o*s,x=o*l,w=a*s,S=a*l;t[0]=s*u,t[4]=-c,t[8]=l*u,t[1]=b*c+S,t[5]=o*u,t[9]=x*c-w,t[2]=w*c-x,t[6]=a*u,t[10]=S*c+b}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(){var e=new Vector3(0,0,0),t=new Vector3(1,1,1);return function(r){return this.compose(e,r,t)}}(),lookAt:function(){var e=new Vector3,t=new Vector3,r=new Vector3;return function(n,i,o){var a=this.elements;return r.subVectors(n,i),0===r.lengthSq()&&(r.z=1),r.normalize(),e.crossVectors(o,r),0===e.lengthSq()&&(1===Math.abs(o.z)?r.x+=1e-4:r.z+=1e-4,r.normalize(),e.crossVectors(o,r)),e.normalize(),t.crossVectors(r,e),a[0]=e.x,a[4]=t.x,a[8]=r.x,a[1]=e.y,a[5]=t.y,a[9]=r.y,a[2]=e.z,a[6]=t.z,a[10]=r.z,this}}(),multiply:function(e,t){return void 0!==t?(console.warn("Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var r=e.elements,n=t.elements,i=this.elements,o=r[0],a=r[4],s=r[8],l=r[12],u=r[1],c=r[5],h=r[9],p=r[13],f=r[2],d=r[6],m=r[10],v=r[14],g=r[3],y=r[7],b=r[11],x=r[15],w=n[0],S=n[4],M=n[8],_=n[12],T=n[1],A=n[5],C=n[9],E=n[13],L=n[2],N=n[6],P=n[10],O=n[14],R=n[3],D=n[7],F=n[11],k=n[15];return i[0]=o*w+a*T+s*L+l*R,i[4]=o*S+a*A+s*N+l*D,i[8]=o*M+a*C+s*P+l*F,i[12]=o*_+a*E+s*O+l*k,i[1]=u*w+c*T+h*L+p*R,i[5]=u*S+c*A+h*N+p*D,i[9]=u*M+c*C+h*P+p*F,i[13]=u*_+c*E+h*O+p*k,i[2]=f*w+d*T+m*L+v*R,i[6]=f*S+d*A+m*N+v*D,i[10]=f*M+d*C+m*P+v*F,i[14]=f*_+d*E+m*O+v*k,i[3]=g*w+y*T+b*L+x*R,i[7]=g*S+y*A+b*N+x*D,i[11]=g*M+y*C+b*P+x*F,i[15]=g*_+y*E+b*O+x*k,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:function(){var e=new Vector3;return function(t){for(var r=0,n=t.count;r<n;r++)e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.applyMatrix4(this),t.setXYZ(r,e.x,e.y,e.z);return t}}(),determinant:function(){var e=this.elements,t=e[0],r=e[4],n=e[8],i=e[12],o=e[1],a=e[5],s=e[9],l=e[13],u=e[2],c=e[6],h=e[10],p=e[14];return e[3]*(+i*s*c-n*l*c-i*a*h+r*l*h+n*a*p-r*s*p)+e[7]*(+t*s*p-t*l*h+i*o*h-n*o*p+n*l*u-i*s*u)+e[11]*(+t*l*c-t*a*p-i*o*c+r*o*p+i*a*u-r*l*u)+e[15]*(-n*a*u-t*s*c+t*a*h+n*o*c-r*o*h+r*s*u)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var r=this.elements,n=e.elements,i=n[0],o=n[1],a=n[2],s=n[3],l=n[4],u=n[5],c=n[6],h=n[7],p=n[8],f=n[9],d=n[10],m=n[11],v=n[12],g=n[13],y=n[14],b=n[15],x=f*y*h-g*d*h+g*c*m-u*y*m-f*c*b+u*d*b,w=v*d*h-p*y*h-v*c*m+l*y*m+p*c*b-l*d*b,S=p*g*h-v*f*h+v*u*m-l*g*m-p*u*b+l*f*b,M=v*f*c-p*g*c-v*u*d+l*g*d+p*u*y-l*f*y,_=i*x+o*w+a*S+s*M;if(0===_){var T="Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(T);return console.warn(T),this.identity()}var A=1/_;return r[0]=x*A,r[1]=(g*d*s-f*y*s-g*a*m+o*y*m+f*a*b-o*d*b)*A,r[2]=(u*y*s-g*c*s+g*a*h-o*y*h-u*a*b+o*c*b)*A,r[3]=(f*c*s-u*d*s-f*a*h+o*d*h+u*a*m-o*c*m)*A,r[4]=w*A,r[5]=(p*y*s-v*d*s+v*a*m-i*y*m-p*a*b+i*d*b)*A,r[6]=(v*c*s-l*y*s-v*a*h+i*y*h+l*a*b-i*c*b)*A,r[7]=(l*d*s-p*c*s+p*a*h-i*d*h-l*a*m+i*c*m)*A,r[8]=S*A,r[9]=(v*f*s-p*g*s-v*o*m+i*g*m+p*o*b-i*f*b)*A,r[10]=(l*g*s-v*u*s+v*o*h-i*g*h-l*o*b+i*u*b)*A,r[11]=(p*u*s-l*f*s-p*o*h+i*f*h+l*o*m-i*u*m)*A,r[12]=M*A,r[13]=(p*g*a-v*f*a+v*o*d-i*g*d-p*o*y+i*f*y)*A,r[14]=(v*u*a-l*g*a-v*o*c+i*g*c+l*o*y-i*u*y)*A,r[15]=(l*f*a-p*u*a+p*o*c-i*f*c-l*o*d+i*u*d)*A,this},scale:function(e){var t=this.elements,r=e.x,n=e.y,i=e.z;return t[0]*=r,t[4]*=n,t[8]*=i,t[1]*=r,t[5]*=n,t[9]*=i,t[2]*=r,t[6]*=n,t[10]*=i,t[3]*=r,t[7]*=n,t[11]*=i,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,n))},makeTranslation:function(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var r=Math.cos(t),n=Math.sin(t),i=1-r,o=e.x,a=e.y,s=e.z,l=i*o,u=i*a;return this.set(l*o+r,l*a-n*s,l*s+n*a,0,l*a+n*s,u*a+r,u*s-n*o,0,l*s-n*a,u*s+n*o,i*s*s+r,0,0,0,0,1),this},makeScale:function(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this},makeShear:function(e,t,r){return this.set(1,t,r,0,e,1,r,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,r){var n=this.elements,i=t._x,o=t._y,a=t._z,s=t._w,l=i+i,u=o+o,c=a+a,h=i*l,p=i*u,f=i*c,d=o*u,m=o*c,v=a*c,g=s*l,y=s*u,b=s*c,x=r.x,w=r.y,S=r.z;return n[0]=(1-(d+v))*x,n[1]=(p+b)*x,n[2]=(f-y)*x,n[3]=0,n[4]=(p-b)*w,n[5]=(1-(h+v))*w,n[6]=(m+g)*w,n[7]=0,n[8]=(f+y)*S,n[9]=(m-g)*S,n[10]=(1-(h+d))*S,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this},decompose:function(){var e=new Vector3,t=new Matrix4;return function(r,n,i){var o=this.elements,a=e.set(o[0],o[1],o[2]).length(),s=e.set(o[4],o[5],o[6]).length(),l=e.set(o[8],o[9],o[10]).length();this.determinant()<0&&(a=-a),r.x=o[12],r.y=o[13],r.z=o[14],t.copy(this);var u=1/a,c=1/s,h=1/l;return t.elements[0]*=u,t.elements[1]*=u,t.elements[2]*=u,t.elements[4]*=c,t.elements[5]*=c,t.elements[6]*=c,t.elements[8]*=h,t.elements[9]*=h,t.elements[10]*=h,n.setFromRotationMatrix(t),i.x=a,i.y=s,i.z=l,this}}(),makePerspective:function(e,t,r,n,i,o){void 0===o&&console.warn("Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*i/(t-e),l=2*i/(r-n),u=(t+e)/(t-e),c=(r+n)/(r-n),h=-(o+i)/(o-i),p=-2*o*i/(o-i);return a[0]=s,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=l,a[9]=c,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=p,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(e,t,r,n,i,o){var a=this.elements,s=1/(t-e),l=1/(r-n),u=1/(o-i),c=(t+e)*s,h=(r+n)*l,p=(o+i)*u;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-c,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-p,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(e){for(var t=this.elements,r=e.elements,n=0;n<16;n++)if(t[n]!==r[n])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var r=0;r<16;r++)this.elements[r]=e[r+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}),Object.assign(Vector3.prototype,{isVector3:!0,set:function(e,t,r){return this.x=e,this.y=t,this.z=r,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(){var e=new Quaternion;return function(t){return t&&t.isEuler||console.error("Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(e.setFromEuler(t))}}(),applyAxisAngle:function(){var e=new Quaternion;return function(t,r){return this.applyQuaternion(e.setFromAxisAngle(t,r))}}(),applyMatrix3:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6]*n,this.y=i[1]*t+i[4]*r+i[7]*n,this.z=i[2]*t+i[5]*r+i[8]*n,this},applyMatrix4:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements,o=1/(i[3]*t+i[7]*r+i[11]*n+i[15]);return this.x=(i[0]*t+i[4]*r+i[8]*n+i[12])*o,this.y=(i[1]*t+i[5]*r+i[9]*n+i[13])*o,this.z=(i[2]*t+i[6]*r+i[10]*n+i[14])*o,this},applyQuaternion:function(e){var t=this.x,r=this.y,n=this.z,i=e.x,o=e.y,a=e.z,s=e.w,l=s*t+o*n-a*r,u=s*r+a*t-i*n,c=s*n+i*r-o*t,h=-i*t-o*r-a*n;return this.x=l*s+h*-i+u*-a-c*-o,this.y=u*s+h*-o+c*-i-l*-a,this.z=c*s+h*-a+l*-o-u*-i,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(){var e=new Matrix4;return function(t){return this.applyMatrix4(e.getInverse(t.projectionMatrix)).applyMatrix4(t.matrixWorld)}}(),transformDirection:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[4]*r+i[8]*n,this.y=i[1]*t+i[5]*r+i[9]*n,this.z=i[2]*t+i[6]*r+i[10]*n,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(){var e=new Vector3,t=new Vector3;return function(r,n){return e.set(r,r,r),t.set(n,n,n),this.clamp(e,t)}}(),clampLength:function(e,t){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},cross:function(e,t){return void 0!==t?(console.warn("Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var r=e.x,n=e.y,i=e.z,o=t.x,a=t.y,s=t.z;return this.x=n*s-i*a,this.y=i*o-r*s,this.z=r*a-n*o,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:function(){var e=new Vector3;return function(t){return e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e=new Vector3;return function(t){return this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){var t=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return Math.acos(_Math.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,r){var n=Math.sin(t)*e;return this.x=n*Math.sin(r),this.y=Math.cos(t)*e,this.z=n*Math.cos(r),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=n,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}}),Object.assign(Quaternion,{slerp:function(e,t,r,n){return r.copy(e).slerp(t,n)},slerpFlat:function(e,t,r,n,i,o,a){var s=r[n+0],l=r[n+1],u=r[n+2],c=r[n+3],h=i[o+0],p=i[o+1],f=i[o+2],d=i[o+3];if(c!==d||s!==h||l!==p||u!==f){var m=1-a,v=s*h+l*p+u*f+c*d,g=v>=0?1:-1,y=1-v*v;if(y>Number.EPSILON){var b=Math.sqrt(y),x=Math.atan2(b,v*g);m=Math.sin(m*x)/b,a=Math.sin(a*x)/b}var w=a*g;if(s=s*m+h*w,l=l*m+p*w,u=u*m+f*w,c=c*m+d*w,m===1-a){var S=1/Math.sqrt(s*s+l*l+u*u+c*c);s*=S,l*=S,u*=S,c*=S}}e[t]=s,e[t+1]=l,e[t+2]=u,e[t+3]=c}}),Object.defineProperties(Quaternion.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this.onChangeCallback()}}}),Object.assign(Quaternion.prototype,{isQuaternion:!0,set:function(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var r=e._x,n=e._y,i=e._z,o=e.order,a=Math.cos,s=Math.sin,l=a(r/2),u=a(n/2),c=a(i/2),h=s(r/2),p=s(n/2),f=s(i/2);return"XYZ"===o?(this._x=h*u*c+l*p*f,this._y=l*p*c-h*u*f,this._z=l*u*f+h*p*c,this._w=l*u*c-h*p*f):"YXZ"===o?(this._x=h*u*c+l*p*f,this._y=l*p*c-h*u*f,this._z=l*u*f-h*p*c,this._w=l*u*c+h*p*f):"ZXY"===o?(this._x=h*u*c-l*p*f,this._y=l*p*c+h*u*f,this._z=l*u*f+h*p*c,this._w=l*u*c-h*p*f):"ZYX"===o?(this._x=h*u*c-l*p*f,this._y=l*p*c+h*u*f,this._z=l*u*f-h*p*c,this._w=l*u*c+h*p*f):"YZX"===o?(this._x=h*u*c+l*p*f,this._y=l*p*c+h*u*f,this._z=l*u*f-h*p*c,this._w=l*u*c-h*p*f):"XZY"===o&&(this._x=h*u*c-l*p*f,this._y=l*p*c-h*u*f,this._z=l*u*f+h*p*c,this._w=l*u*c+h*p*f),!1!==t&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){var r=t/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this.onChangeCallback(),this},setFromRotationMatrix:function(e){var t,r=e.elements,n=r[0],i=r[4],o=r[8],a=r[1],s=r[5],l=r[9],u=r[2],c=r[6],h=r[10],p=n+s+h;return p>0?(t=.5/Math.sqrt(p+1),this._w=.25/t,this._x=(c-l)*t,this._y=(o-u)*t,this._z=(a-i)*t):n>s&&n>h?(t=2*Math.sqrt(1+n-s-h),this._w=(c-l)/t,this._x=.25*t,this._y=(i+a)/t,this._z=(o+u)/t):s>h?(t=2*Math.sqrt(1+s-n-h),this._w=(o-u)/t,this._x=(i+a)/t,this._y=.25*t,this._z=(l+c)/t):(t=2*Math.sqrt(1+h-n-s),this._w=(a-i)/t,this._x=(o+u)/t,this._y=(l+c)/t,this._z=.25*t),this.onChangeCallback(),this},setFromUnitVectors:function(){var e,t=new Vector3;return function(r,n){return void 0===t&&(t=new Vector3),(e=r.dot(n)+1)<1e-6?(e=0,Math.abs(r.x)>Math.abs(r.z)?t.set(-r.y,r.x,0):t.set(0,-r.z,r.y)):t.crossVectors(r,n),this._x=t.x,this._y=t.y,this._z=t.z,this._w=e,this.normalize()}}(),angleTo:function(e){return 2*Math.acos(Math.abs(_Math.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){var r=this.angleTo(e);if(0===r)return this;var n=Math.min(1,t/r);return this.slerp(e,n),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var r=e._x,n=e._y,i=e._z,o=e._w,a=t._x,s=t._y,l=t._z,u=t._w;return this._x=r*u+o*a+n*l-i*s,this._y=n*u+o*s+i*a-r*l,this._z=i*u+o*l+r*s-n*a,this._w=o*u-r*a-n*s-i*l,this.onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var r=this._x,n=this._y,i=this._z,o=this._w,a=o*e._w+r*e._x+n*e._y+i*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=r,this._y=n,this._z=i,this;var s=1-a*a;if(s<=Number.EPSILON){var l=1-t;return this._w=l*o+t*this._w,this._x=l*r+t*this._x,this._y=l*n+t*this._y,this._z=l*i+t*this._z,this.normalize()}var u=Math.sqrt(s),c=Math.atan2(u,a),h=Math.sin((1-t)*c)/u,p=Math.sin(t*c)/u;return this._w=o*h+this._w*p,this._x=r*h+this._x*p,this._y=n*h+this._y*p,this._z=i*h+this._z*p,this.onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(EventDispatcher.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var r=this._listeners[e];if(void 0!==r){var n=r.indexOf(t);-1!==n&&r.splice(n,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var r=t.slice(0),n=0,i=r.length;n<i;n++)r[n].call(this,e)}}}}),Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Euler.DefaultOrder="XYZ",Object.defineProperties(Euler.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this.onChangeCallback()}}}),Object.assign(Euler.prototype,{isEuler:!0,set:function(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._order=n||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,t,r){var n=_Math.clamp,i=e.elements,o=i[0],a=i[4],s=i[8],l=i[1],u=i[5],c=i[9],h=i[2],p=i[6],f=i[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(n(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-c,f),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(p,u),this._z=0)):"YXZ"===t?(this._x=Math.asin(-n(c,-1,1)),Math.abs(c)<.99999?(this._y=Math.atan2(s,f),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,o),this._z=0)):"ZXY"===t?(this._x=Math.asin(n(p,-1,1)),Math.abs(p)<.99999?(this._y=Math.atan2(-h,f),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(l,o))):"ZYX"===t?(this._y=Math.asin(-n(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(p,f),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-a,u))):"YZX"===t?(this._z=Math.asin(n(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(s,f))):"XZY"===t?(this._z=Math.asin(-n(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(p,u),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-c,f),this._y=0)):console.warn("Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==r&&this.onChangeCallback(),this},setFromQuaternion:function(){var e=new Matrix4;return function(t,r,n){return e.makeRotationFromQuaternion(t),this.setFromRotationMatrix(e,r,n)}}(),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(){var e=new Quaternion;return function(t){return e.setFromEuler(this),this.setFromQuaternion(e,t)}}(),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new Vector3(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(Layers.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},test:function(e){return 0!==(this.mask&e.mask)}}),Object.assign(Matrix3.prototype,{isMatrix3:!0,set:function(e,t,r,n,i,o,a,s,l){var u=this.elements;return u[0]=e,u[1]=n,u[2]=a,u[3]=t,u[4]=i,u[5]=s,u[6]=r,u[7]=o,u[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:function(){var e=new Vector3;return function(t){for(var r=0,n=t.count;r<n;r++)e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.applyMatrix3(this),t.setXYZ(r,e.x,e.y,e.z);return t}}(),multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var r=e.elements,n=t.elements,i=this.elements,o=r[0],a=r[3],s=r[6],l=r[1],u=r[4],c=r[7],h=r[2],p=r[5],f=r[8],d=n[0],m=n[3],v=n[6],g=n[1],y=n[4],b=n[7],x=n[2],w=n[5],S=n[8];return i[0]=o*d+a*g+s*x,i[3]=o*m+a*y+s*w,i[6]=o*v+a*b+s*S,i[1]=l*d+u*g+c*x,i[4]=l*m+u*y+c*w,i[7]=l*v+u*b+c*S,i[2]=h*d+p*g+f*x,i[5]=h*m+p*y+f*w,i[8]=h*v+p*b+f*S,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],a=e[5],s=e[6],l=e[7],u=e[8];return t*o*u-t*a*l-r*i*u+r*a*s+n*i*l-n*o*s},getInverse:function(e,t){e&&e.isMatrix4&&console.error("Matrix3: .getInverse() no longer takes a Matrix4 argument.");var r=e.elements,n=this.elements,i=r[0],o=r[1],a=r[2],s=r[3],l=r[4],u=r[5],c=r[6],h=r[7],p=r[8],f=p*l-u*h,d=u*c-p*s,m=h*s-l*c,v=i*f+o*d+a*m;if(0===v){var g="Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(g);return console.warn(g),this.identity()}var y=1/v;return n[0]=f*y,n[1]=(a*h-p*o)*y,n[2]=(u*o-a*l)*y,n[3]=d*y,n[4]=(p*i-a*c)*y,n[5]=(a*s-u*i)*y,n[6]=m*y,n[7]=(o*c-h*i)*y,n[8]=(l*i-o*s)*y,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,r,n,i,o,a){var s=Math.cos(i),l=Math.sin(i);this.set(r*s,r*l,-r*(s*o+l*a)+o+e,-n*l,n*s,-n*(-l*o+s*a)+a+t,0,0,1)},scale:function(e,t){var r=this.elements;return r[0]*=e,r[3]*=e,r[6]*=e,r[1]*=t,r[4]*=t,r[7]*=t,this},rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=this.elements,i=n[0],o=n[3],a=n[6],s=n[1],l=n[4],u=n[7];return n[0]=t*i+r*s,n[3]=t*o+r*l,n[6]=t*a+r*u,n[1]=-r*i+t*s,n[4]=-r*o+t*l,n[7]=-r*a+t*u,this},translate:function(e,t){var r=this.elements;return r[0]+=e*r[2],r[3]+=e*r[5],r[6]+=e*r[8],r[1]+=t*r[2],r[4]+=t*r[5],r[7]+=t*r[8],this},equals:function(e){for(var t=this.elements,r=e.elements,n=0;n<9;n++)if(t[n]!==r[n])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var r=0;r<9;r++)this.elements[r]=e[r+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}});var REVISION="102",MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},CullFaceNone=0,CullFaceBack=1,CullFaceFront=2,CullFaceFrontBack=3,FrontFaceDirectionCW=0,FrontFaceDirectionCCW=1,BasicShadowMap=0,PCFShadowMap=1,PCFSoftShadowMap=2,FrontSide=0,BackSide=1,DoubleSide=2,FlatShading=1,SmoothShading=2,NoColors=0,FaceColors=1,VertexColors=2,NoBlending=0,NormalBlending=1,AdditiveBlending=2,SubtractiveBlending=3,MultiplyBlending=4,CustomBlending=5,AddEquation=100,SubtractEquation=101,ReverseSubtractEquation=102,MinEquation=103,MaxEquation=104,ZeroFactor=200,OneFactor=201,SrcColorFactor=202,OneMinusSrcColorFactor=203,SrcAlphaFactor=204,OneMinusSrcAlphaFactor=205,DstAlphaFactor=206,OneMinusDstAlphaFactor=207,DstColorFactor=208,OneMinusDstColorFactor=209,SrcAlphaSaturateFactor=210,NeverDepth=0,AlwaysDepth=1,LessDepth=2,LessEqualDepth=3,EqualDepth=4,GreaterEqualDepth=5,GreaterDepth=6,NotEqualDepth=7,MultiplyOperation=0,MixOperation=1,AddOperation=2,NoToneMapping=0,LinearToneMapping=1,ReinhardToneMapping=2,Uncharted2ToneMapping=3,CineonToneMapping=4,ACESFilmicToneMapping=5,UVMapping=300,CubeReflectionMapping=301,CubeRefractionMapping=302,EquirectangularReflectionMapping=303,EquirectangularRefractionMapping=304,SphericalReflectionMapping=305,CubeUVReflectionMapping=306,CubeUVRefractionMapping=307,RepeatWrapping=1e3,ClampToEdgeWrapping=1001,MirroredRepeatWrapping=1002,NearestFilter=1003,NearestMipMapNearestFilter=1004,NearestMipMapLinearFilter=1005,LinearFilter=1006,LinearMipMapNearestFilter=1007,LinearMipMapLinearFilter=1008,UnsignedByteType=1009,ByteType=1010,ShortType=1011,UnsignedShortType=1012,IntType=1013,UnsignedIntType=1014,FloatType=1015,HalfFloatType=1016,UnsignedShort4444Type=1017,UnsignedShort5551Type=1018,UnsignedShort565Type=1019,UnsignedInt248Type=1020,AlphaFormat=1021,RGBFormat=1022,RGBAFormat=1023,LuminanceFormat=1024,LuminanceAlphaFormat=1025,RGBEFormat=RGBAFormat,DepthFormat=1026,DepthStencilFormat=1027,RedFormat=1028,RGB_S3TC_DXT1_Format=33776,RGBA_S3TC_DXT1_Format=33777,RGBA_S3TC_DXT3_Format=33778,RGBA_S3TC_DXT5_Format=33779,RGB_PVRTC_4BPPV1_Format=35840,RGB_PVRTC_2BPPV1_Format=35841,RGBA_PVRTC_4BPPV1_Format=35842,RGBA_PVRTC_2BPPV1_Format=35843,RGB_ETC1_Format=36196,RGBA_ASTC_4x4_Format=37808,RGBA_ASTC_5x4_Format=37809,RGBA_ASTC_5x5_Format=37810,RGBA_ASTC_6x5_Format=37811,RGBA_ASTC_6x6_Format=37812,RGBA_ASTC_8x5_Format=37813,RGBA_ASTC_8x6_Format=37814,RGBA_ASTC_8x8_Format=37815,RGBA_ASTC_10x5_Format=37816,RGBA_ASTC_10x6_Format=37817,RGBA_ASTC_10x8_Format=37818,RGBA_ASTC_10x10_Format=37819,RGBA_ASTC_12x10_Format=37820,RGBA_ASTC_12x12_Format=37821,LoopOnce=2200,LoopRepeat=2201,LoopPingPong=2202,InterpolateDiscrete=2300,InterpolateLinear=2301,InterpolateSmooth=2302,ZeroCurvatureEnding=2400,ZeroSlopeEnding=2401,WrapAroundEnding=2402,TrianglesDrawMode=0,TriangleStripDrawMode=1,TriangleFanDrawMode=2,LinearEncoding=3e3,sRGBEncoding=3001,GammaEncoding=3007,RGBEEncoding=3002,LogLuvEncoding=3003,RGBM7Encoding=3004,RGBM16Encoding=3005,RGBDEncoding=3006,BasicDepthPacking=3200,RGBADepthPacking=3201,TangentSpaceNormalMap=0,ObjectSpaceNormalMap=1,object3DId=0;function Object3D(){Object.defineProperty(this,"id",{value:object3DId++}),this.uuid=_Math.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Object3D.DefaultUp.clone();var e=new Vector3,t=new Euler,r=new Quaternion,n=new Vector3(1,1,1);t.onChange(function(){r.setFromEuler(t,!1)}),r.onChange(function(){t.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new Matrix4},normalMatrix:{value:new Matrix3}}),this.matrix=new Matrix4,this.matrixWorld=new Matrix4,this.matrixAutoUpdate=Object3D.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}Object3D.DefaultUp=new Vector3(0,1,0),Object3D.DefaultMatrixAutoUpdate=!0,Object3D.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:Object3D,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(){var e=new Quaternion;return function(t,r){return e.setFromAxisAngle(t,r),this.quaternion.multiply(e),this}}(),rotateOnWorldAxis:function(){var e=new Quaternion;return function(t,r){return e.setFromAxisAngle(t,r),this.quaternion.premultiply(e),this}}(),rotateX:function(){var e=new Vector3(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new Vector3(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new Vector3(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new Vector3;return function(t,r){return e.copy(t).applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(r)),this}}(),translateX:function(){var e=new Vector3(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new Vector3(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new Vector3(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var e=new Matrix4;return function(t){return t.applyMatrix4(e.getInverse(this.matrixWorld))}}(),lookAt:function(){var e=new Quaternion,t=new Matrix4,r=new Vector3,n=new Vector3;return function(i,o,a){i.isVector3?r.copy(i):r.set(i,o,a);var s=this.parent;this.updateWorldMatrix(!0,!1),n.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?t.lookAt(n,r,this.up):t.lookAt(r,n,this.up),this.quaternion.setFromRotationMatrix(t),s&&(t.extractRotation(s.matrixWorld),e.setFromRotationMatrix(t),this.quaternion.premultiply(e.inverse()))}}(),add:function(e){var t=arguments;if(arguments.length>1){for(var r=0;r<arguments.length;r++)this.add(t[r]);return this}return e===this?(console.error("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("Object3D.add: object not an instance of Object3D.",e),this)},remove:function(e){var t=arguments;if(arguments.length>1){for(var r=0;r<arguments.length;r++)this.remove(t[r]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,e.dispatchEvent({type:"removed"}),this.children.splice(n,1)),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var r=0,n=this.children.length;r<n;r++){var i=this.children[r].getObjectByProperty(e,t);if(void 0!==i)return i}},getWorldPosition:function(e){return void 0===e&&(console.warn("Object3D: .getWorldPosition() target is now required"),e=new Vector3),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var e=new Vector3,t=new Vector3;return function(r){return void 0===r&&(console.warn("Object3D: .getWorldQuaternion() target is now required"),r=new Quaternion),this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,r,t),r}}(),getWorldScale:function(){var e=new Vector3,t=new Quaternion;return function(r){return void 0===r&&(console.warn("Object3D: .getWorldScale() target is now required"),r=new Vector3),this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,t,r),r}}(),getWorldDirection:function(e){void 0===e&&(console.warn("Object3D: .getWorldDirection() target is now required"),e=new Vector3),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,r=0,n=t.length;r<n;r++)t[r].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,r=0,n=t.length;r<n;r++)t[r].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,r=0,n=t.length;r<n;r++)t[r].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var r=this.parent;if(!0===e&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var n=this.children,i=0,o=n.length;i<o;i++)n[i].updateWorldMatrix(!1,!0)},toJSON:function(e){var t=void 0===e||"string"===typeof e,r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var n={};function i(t,r){return void 0===t[r.uuid]&&(t[r.uuid]=r.toJSON(e)),r.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),!1===this.frustumCulled&&(n.frustumCulled=!1),0!==this.renderOrder&&(n.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(n.matrixAutoUpdate=!1),this.isMesh&&this.drawMode!==TrianglesDrawMode&&(n.drawMode=this.drawMode),this.isMesh||this.isLine||this.isPoints){n.geometry=i(e.geometries,this.geometry);var o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes){var a=o.shapes;if(Array.isArray(a))for(var s=0,l=a.length;s<l;s++){var u=a[s];i(e.shapes,u)}else i(e.shapes,a)}}if(void 0!==this.material)if(Array.isArray(this.material)){var c=[];for(s=0,l=this.material.length;s<l;s++)c.push(i(e.materials,this.material[s]));n.material=c}else n.material=i(e.materials,this.material);if(this.children.length>0){n.children=[];for(s=0;s<this.children.length;s++)n.children.push(this.children[s].toJSON(e).object)}if(t){var h=m(e.geometries),p=m(e.materials),f=m(e.textures),d=m(e.images);a=m(e.shapes);h.length>0&&(r.geometries=h),p.length>0&&(r.materials=p),f.length>0&&(r.textures=f),d.length>0&&(r.images=d),a.length>0&&(r.shapes=a)}return r.object=n,r;function m(e){var t=[];for(var r in e){var n=e[r];delete n.metadata,t.push(n)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var r=0;r<e.children.length;r++){var n=e.children[r];this.add(n.clone())}return this}});var ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Color(e,t,r){return void 0===t&&void 0===r?this.set(e):this.setRGB(e,t,r)}function Face3(e,t,r,n,i,o){this.a=e,this.b=t,this.c=r,this.normal=n&&n.isVector3?n:new Vector3,this.vertexNormals=Array.isArray(n)?n:[],this.color=i&&i.isColor?i:new Color,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==o?o:0}function Box3(e,t){this.min=void 0!==e?e:new Vector3(1/0,1/0,1/0),this.max=void 0!==t?t:new Vector3(-1/0,-1/0,-1/0)}function Sphere(e,t){this.center=void 0!==e?e:new Vector3,this.radius=void 0!==t?t:0}function Vector2(e,t){this.x=e||0,this.y=t||0}Object.assign(Color.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"===typeof e?this.setHex(e):"string"===typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,r){return this.r=e,this.g=t,this.b=r,this},setHSL:function(){function e(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+6*(t-e)*(2/3-r):e}return function(t,r,n){if(t=_Math.euclideanModulo(t,1),r=_Math.clamp(r,0,1),n=_Math.clamp(n,0,1),0===r)this.r=this.g=this.b=n;else{var i=n<=.5?n*(1+r):n+r-n*r,o=2*n-i;this.r=e(o,i,t+1/3),this.g=e(o,i,t),this.b=e(o,i,t-1/3)}return this}}(),setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("Color: Alpha component of "+e+" will be ignored.")}var r;if(r=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var n,i=r[1],o=r[2];switch(i){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,t(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,t(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var a=parseFloat(n[1])/360,s=parseInt(n[2],10)/100,l=parseInt(n[3],10)/100;return t(n[5]),this.setHSL(a,s,l)}}}else if(r=/^\#([A-Fa-f0-9]+)$/.exec(e)){var u,c=(u=r[1]).length;if(3===c)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(6===c)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}e&&e.length>0&&(void 0!==(u=ColorKeywords[e])?this.setHex(u):console.warn("Color: Unknown color "+e));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var r=t>0?1/t:1;return this.r=Math.pow(e.r,r),this.g=Math.pow(e.g,r),this.b=Math.pow(e.b,r),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(){function e(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}return function(t){return this.r=e(t.r),this.g=e(t.g),this.b=e(t.b),this}}(),copyLinearToSRGB:function(){function e(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}return function(t){return this.r=e(t.r),this.g=e(t.g),this.b=e(t.b),this}}(),convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){void 0===e&&(console.warn("Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,r,n=this.r,i=this.g,o=this.b,a=Math.max(n,i,o),s=Math.min(n,i,o),l=(s+a)/2;if(s===a)t=0,r=0;else{var u=a-s;switch(r=l<=.5?u/(a+s):u/(2-a-s),a){case n:t=(i-o)/u+(i<o?6:0);break;case i:t=(o-n)/u+2;break;case o:t=(n-i)/u+4}t/=6}return e.h=t,e.s=r,e.l=l,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(){var e={};return function(t,r,n){return this.getHSL(e),e.h+=t,e.s+=r,e.l+=n,this.setHSL(e.h,e.s,e.l),this}}(),add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},lerpHSL:function(){var e={h:0,s:0,l:0},t={h:0,s:0,l:0};return function(r,n){this.getHSL(e),r.getHSL(t);var i=_Math.lerp(e.h,t.h,n),o=_Math.lerp(e.s,t.s,n),a=_Math.lerp(e.l,t.l,n);return this.setHSL(i,o,a),this}}(),equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}}),Object.assign(Face3.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,r=e.vertexNormals.length;t<r;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,r=e.vertexColors.length;t<r;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}}),Object.assign(Box3.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,r=1/0,n=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,l=e.length;s<l;s+=3){var u=e[s],c=e[s+1],h=e[s+2];u<t&&(t=u),c<r&&(r=c),h<n&&(n=h),u>i&&(i=u),c>o&&(o=c),h>a&&(a=h)}return this.min.set(t,r,n),this.max.set(i,o,a),this},setFromBufferAttribute:function(e){for(var t=1/0,r=1/0,n=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,l=e.count;s<l;s++){var u=e.getX(s),c=e.getY(s),h=e.getZ(s);u<t&&(t=u),c<r&&(r=c),h<n&&(n=h),u>i&&(i=u),c>o&&(o=c),h>a&&(a=h)}return this.min.set(t,r,n),this.max.set(i,o,a),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new Vector3;return function(t,r){var n=e.copy(r).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return void 0===e&&(console.warn("Box3: .getCenter() target is now required"),e=new Vector3),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("Box3: .getSize() target is now required"),e=new Vector3),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(){var e,t,r,n=new Vector3;function i(i){var o=i.geometry;if(void 0!==o)if(o.isGeometry){var a=o.vertices;for(t=0,r=a.length;t<r;t++)n.copy(a[t]),n.applyMatrix4(i.matrixWorld),e.expandByPoint(n)}else if(o.isBufferGeometry){var s=o.attributes.position;if(void 0!==s)for(t=0,r=s.count;t<r;t++)n.fromBufferAttribute(s,t).applyMatrix4(i.matrixWorld),e.expandByPoint(n)}}return function(t){return e=this,t.updateMatrixWorld(!0),t.traverse(i),this}}(),containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return void 0===t&&(console.warn("Box3: .getParameter() target is now required"),t=new Vector3),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(){var e=new Vector3;return function(t){return this.clampPoint(t.center,e),e.distanceToSquared(t.center)<=t.radius*t.radius}}(),intersectsPlane:function(e){var t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant},intersectsTriangle:function(){var e=new Vector3,t=new Vector3,r=new Vector3,n=new Vector3,i=new Vector3,o=new Vector3,a=new Vector3,s=new Vector3,l=new Vector3,u=new Vector3;function c(n){var i,o;for(i=0,o=n.length-3;i<=o;i+=3){a.fromArray(n,i);var s=l.x*Math.abs(a.x)+l.y*Math.abs(a.y)+l.z*Math.abs(a.z),u=e.dot(a),c=t.dot(a),h=r.dot(a);if(Math.max(-Math.max(u,c,h),Math.min(u,c,h))>s)return!1}return!0}return function(a){if(this.isEmpty())return!1;this.getCenter(s),l.subVectors(this.max,s),e.subVectors(a.a,s),t.subVectors(a.b,s),r.subVectors(a.c,s),n.subVectors(t,e),i.subVectors(r,t),o.subVectors(e,r);var h=[0,-n.z,n.y,0,-i.z,i.y,0,-o.z,o.y,n.z,0,-n.x,i.z,0,-i.x,o.z,0,-o.x,-n.y,n.x,0,-i.y,i.x,0,-o.y,o.x,0];return!!c(h)&&(!!c(h=[1,0,0,0,1,0,0,0,1])&&(u.crossVectors(n,i),c(h=[u.x,u.y,u.z])))}}(),clampPoint:function(e,t){return void 0===t&&(console.warn("Box3: .clampPoint() target is now required"),t=new Vector3),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new Vector3;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),getBoundingSphere:function(){var e=new Vector3;return function(t){return void 0===t&&(console.warn("Box3: .getBoundingSphere() target is now required"),t=new Sphere),this.getCenter(t.center),t.radius=.5*this.getSize(e).length(),t}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(){var e=[new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3];return function(t){return this.isEmpty()?this:(e[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),e[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),e[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),e[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),e[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),e[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),e[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),e[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(e),this)}}(),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(Sphere.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(){var e=new Box3;return function(t,r){var n=this.center;void 0!==r?n.copy(r):e.setFromPoints(t).getCenter(n);for(var i=0,o=0,a=t.length;o<a;o++)i=Math.max(i,n.distanceToSquared(t[o]));return this.radius=Math.sqrt(i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var r=this.center.distanceToSquared(e);return void 0===t&&(console.warn("Sphere: .clampPoint() target is now required"),t=new Vector3),t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return void 0===e&&(console.warn("Sphere: .getBoundingBox() target is now required"),e=new Box3),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}}),Object.defineProperties(Vector2.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(Vector2.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,r=this.y,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6],this.y=n[1]*t+n[4]*r+n[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(){var e=new Vector2,t=new Vector2;return function(r,n){return e.set(r,r),t.set(n,n),this.clamp(e,t)}}(),clampLength:function(e,t){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y;return t*t+r*r},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var r=Math.cos(t),n=Math.sin(t),i=this.x-e.x,o=this.y-e.y;return this.x=i*r-o*n+e.x,this.y=i*n+o*r+e.y,this}});var geometryId=0;function Geometry(){Object.defineProperty(this,"id",{value:geometryId+=2}),this.uuid=_Math.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function Vector4(e,t,r,n){this.x=e||0,this.y=t||0,this.z=r||0,this.w=void 0!==n?n:1}function BufferAttribute(e,t,r){if(Array.isArray(e))throw new TypeError("BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===r,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function Int8BufferAttribute(e,t,r){BufferAttribute.call(this,new Int8Array(e),t,r)}function Uint8BufferAttribute(e,t,r){BufferAttribute.call(this,new Uint8Array(e),t,r)}function Uint8ClampedBufferAttribute(e,t,r){BufferAttribute.call(this,new Uint8ClampedArray(e),t,r)}function Int16BufferAttribute(e,t,r){BufferAttribute.call(this,new Int16Array(e),t,r)}function Uint16BufferAttribute(e,t,r){BufferAttribute.call(this,new Uint16Array(e),t,r)}function Int32BufferAttribute(e,t,r){BufferAttribute.call(this,new Int32Array(e),t,r)}function Uint32BufferAttribute(e,t,r){BufferAttribute.call(this,new Uint32Array(e),t,r)}function Float32BufferAttribute(e,t,r){BufferAttribute.call(this,new Float32Array(e),t,r)}function Float64BufferAttribute(e,t,r){BufferAttribute.call(this,new Float64Array(e),t,r)}function DirectGeometry(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function arrayMin(e){if(0===e.length)return 1/0;for(var t=e[0],r=1,n=e.length;r<n;++r)e[r]<t&&(t=e[r]);return t}function arrayMax(e){if(0===e.length)return-1/0;for(var t=e[0],r=1,n=e.length;r<n;++r)e[r]>t&&(t=e[r]);return t}Geometry.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:Geometry,isGeometry:!0,applyMatrix:function(e){for(var t=(new Matrix3).getNormalMatrix(e),r=0,n=this.vertices.length;r<n;r++){this.vertices[r].applyMatrix4(e)}for(r=0,n=this.faces.length;r<n;r++){var i=this.faces[r];i.normal.applyMatrix3(t).normalize();for(var o=0,a=i.vertexNormals.length;o<a;o++)i.vertexNormals[o].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var e=new Matrix4;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new Matrix4;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new Matrix4;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new Matrix4;return function(t,r,n){return e.makeTranslation(t,r,n),this.applyMatrix(e),this}}(),scale:function(){var e=new Matrix4;return function(t,r,n){return e.makeScale(t,r,n),this.applyMatrix(e),this}}(),lookAt:function(){var e=new Object3D;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),fromBufferGeometry:function(e){var t=this,r=null!==e.index?e.index.array:void 0,n=e.attributes,i=n.position.array,o=void 0!==n.normal?n.normal.array:void 0,a=void 0!==n.color?n.color.array:void 0,s=void 0!==n.uv?n.uv.array:void 0,l=void 0!==n.uv2?n.uv2.array:void 0;void 0!==l&&(this.faceVertexUvs[1]=[]);for(var u=0,c=0;u<i.length;u+=3,c+=2)t.vertices.push((new Vector3).fromArray(i,u)),void 0!==a&&t.colors.push((new Color).fromArray(a,u));function h(e,r,n,i){var u=void 0===a?[]:[t.colors[e].clone(),t.colors[r].clone(),t.colors[n].clone()],c=new Face3(e,r,n,void 0===o?[]:[(new Vector3).fromArray(o,3*e),(new Vector3).fromArray(o,3*r),(new Vector3).fromArray(o,3*n)],u,i);t.faces.push(c),void 0!==s&&t.faceVertexUvs[0].push([(new Vector2).fromArray(s,2*e),(new Vector2).fromArray(s,2*r),(new Vector2).fromArray(s,2*n)]),void 0!==l&&t.faceVertexUvs[1].push([(new Vector2).fromArray(l,2*e),(new Vector2).fromArray(l,2*r),(new Vector2).fromArray(l,2*n)])}var p=e.groups;if(p.length>0)for(u=0;u<p.length;u++)for(var f=p[u],d=f.start,m=(c=d,d+f.count);c<m;c+=3)void 0!==r?h(r[c],r[c+1],r[c+2],f.materialIndex):h(c,c+1,c+2,f.materialIndex);else if(void 0!==r)for(u=0;u<r.length;u+=3)h(r[u],r[u+1],r[u+2]);else for(u=0;u<i.length/3;u+=3)h(u,u+1,u+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){var e=new Vector3;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(e).negate(),this.translate(e.x,e.y,e.z),this}}(),normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,r=0===t?1:1/t,n=new Matrix4;return n.set(r,0,0,-r*e.x,0,r,0,-r*e.y,0,0,r,-r*e.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var e=new Vector3,t=new Vector3,r=0,n=this.faces.length;r<n;r++){var i=this.faces[r],o=this.vertices[i.a],a=this.vertices[i.b],s=this.vertices[i.c];e.subVectors(s,a),t.subVectors(o,a),e.cross(t),e.normalize(),i.normal.copy(e)}},computeVertexNormals:function(e){var t,r,n,i,o,a;for(void 0===e&&(e=!0),a=new Array(this.vertices.length),t=0,r=this.vertices.length;t<r;t++)a[t]=new Vector3;if(e){var s,l,u,c=new Vector3,h=new Vector3;for(n=0,i=this.faces.length;n<i;n++)o=this.faces[n],s=this.vertices[o.a],l=this.vertices[o.b],u=this.vertices[o.c],c.subVectors(u,l),h.subVectors(s,l),c.cross(h),a[o.a].add(c),a[o.b].add(c),a[o.c].add(c)}else for(this.computeFaceNormals(),n=0,i=this.faces.length;n<i;n++)a[(o=this.faces[n]).a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(t=0,r=this.vertices.length;t<r;t++)a[t].normalize();for(n=0,i=this.faces.length;n<i;n++){var p=(o=this.faces[n]).vertexNormals;3===p.length?(p[0].copy(a[o.a]),p[1].copy(a[o.b]),p[2].copy(a[o.c])):(p[0]=a[o.a].clone(),p[1]=a[o.b].clone(),p[2]=a[o.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,r;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){var n=(r=this.faces[e]).vertexNormals;3===n.length?(n[0].copy(r.normal),n[1].copy(r.normal),n[2].copy(r.normal)):(n[0]=r.normal.clone(),n[1]=r.normal.clone(),n[2]=r.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,r,n,i;for(r=0,n=this.faces.length;r<n;r++)for((i=this.faces[r]).__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),e=0,t=i.vertexNormals.length;e<t;e++)i.__originalVertexNormals[e]?i.__originalVertexNormals[e].copy(i.vertexNormals[e]):i.__originalVertexNormals[e]=i.vertexNormals[e].clone();var o=new Geometry;for(o.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var a=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(r=0,n=this.faces.length;r<n;r++)l=new Vector3,u={a:new Vector3,b:new Vector3,c:new Vector3},a.push(l),s.push(u)}var l,u,c=this.morphNormals[e];for(o.vertices=this.morphTargets[e].vertices,o.computeFaceNormals(),o.computeVertexNormals(),r=0,n=this.faces.length;r<n;r++)i=this.faces[r],l=c.faceNormals[r],u=c.vertexNormals[r],l.copy(i.normal),u.a.copy(i.vertexNormals[0]),u.b.copy(i.vertexNormals[1]),u.c.copy(i.vertexNormals[2])}for(r=0,n=this.faces.length;r<n;r++)(i=this.faces[r]).normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Sphere),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,r){if(e&&e.isGeometry){var n,i=this.vertices.length,o=this.vertices,a=e.vertices,s=this.faces,l=e.faces,u=this.faceVertexUvs[0],c=e.faceVertexUvs[0],h=this.colors,p=e.colors;void 0===r&&(r=0),void 0!==t&&(n=(new Matrix3).getNormalMatrix(t));for(var f=0,d=a.length;f<d;f++){var m=a[f].clone();void 0!==t&&m.applyMatrix4(t),o.push(m)}for(f=0,d=p.length;f<d;f++)h.push(p[f].clone());for(f=0,d=l.length;f<d;f++){var v,g,y,b=l[f],x=b.vertexNormals,w=b.vertexColors;(v=new Face3(b.a+i,b.b+i,b.c+i)).normal.copy(b.normal),void 0!==n&&v.normal.applyMatrix3(n).normalize();for(var S=0,M=x.length;S<M;S++)g=x[S].clone(),void 0!==n&&g.applyMatrix3(n).normalize(),v.vertexNormals.push(g);v.color.copy(b.color);for(S=0,M=w.length;S<M;S++)y=w[S],v.vertexColors.push(y.clone());v.materialIndex=b.materialIndex+r,s.push(v)}for(f=0,d=c.length;f<d;f++){var _=c[f],T=[];if(void 0!==_){for(S=0,M=_.length;S<M;S++)T.push(_[S].clone());u.push(T)}}}else console.error("Geometry.merge(): geometry not an instance of Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("Geometry.mergeMesh(): mesh not an instance of Mesh.",e)},mergeVertices:function(){var e,t,r,n,i,o,a,s,l={},u=[],c=[],h=Math.pow(10,4);for(r=0,n=this.vertices.length;r<n;r++)e=this.vertices[r],void 0===l[t=Math.round(e.x*h)+"_"+Math.round(e.y*h)+"_"+Math.round(e.z*h)]?(l[t]=r,u.push(this.vertices[r]),c[r]=u.length-1):c[r]=c[l[t]];var p=[];for(r=0,n=this.faces.length;r<n;r++){(i=this.faces[r]).a=c[i.a],i.b=c[i.b],i.c=c[i.c],o=[i.a,i.b,i.c];for(var f=0;f<3;f++)if(o[f]===o[(f+1)%3]){p.push(r);break}}for(r=p.length-1;r>=0;r--){var d=p[r];for(this.faces.splice(d,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(d,1)}var m=this.vertices.length-u.length;return this.vertices=u,m},setFromPoints:function(e){this.vertices=[];for(var t=0,r=e.length;t<r;t++){var n=e[t];this.vertices.push(new Vector3(n.x,n.y,n.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,r=0;r<t;r++)e[r]._id=r;e.sort(function(e,t){return e.materialIndex-t.materialIndex});var n,i,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];o&&o.length===t&&(n=[]),a&&a.length===t&&(i=[]);for(r=0;r<t;r++){var s=e[r]._id;n&&n.push(o[s]),i&&i.push(a[s])}n&&(this.faceVertexUvs[0]=n),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var r in t)void 0!==t[r]&&(e[r]=t[r]);return e}for(var n=[],i=0;i<this.vertices.length;i++){var o=this.vertices[i];n.push(o.x,o.y,o.z)}var a=[],s=[],l={},u=[],c={},h=[],p={};for(i=0;i<this.faces.length;i++){var f=this.faces[i],d=void 0!==this.faceVertexUvs[0][i],m=f.normal.length()>0,v=f.vertexNormals.length>0,g=1!==f.color.r||1!==f.color.g||1!==f.color.b,y=f.vertexColors.length>0,b=0;if(b=M(b,0,0),b=M(b,1,!0),b=M(b,2,!1),b=M(b,3,d),b=M(b,4,m),b=M(b,5,v),b=M(b,6,g),b=M(b,7,y),a.push(b),a.push(f.a,f.b,f.c),a.push(f.materialIndex),d){var x=this.faceVertexUvs[0][i];a.push(A(x[0]),A(x[1]),A(x[2]))}if(m&&a.push(_(f.normal)),v){var w=f.vertexNormals;a.push(_(w[0]),_(w[1]),_(w[2]))}if(g&&a.push(T(f.color)),y){var S=f.vertexColors;a.push(T(S[0]),T(S[1]),T(S[2]))}}function M(e,t,r){return r?e|1<<t:e&~(1<<t)}function _(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==l[t]?l[t]:(l[t]=s.length/3,s.push(e.x,e.y,e.z),l[t])}function T(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==c[t]?c[t]:(c[t]=u.length,u.push(e.getHex()),c[t])}function A(e){var t=e.x.toString()+e.y.toString();return void 0!==p[t]?p[t]:(p[t]=h.length/2,h.push(e.x,e.y),p[t])}return e.data={},e.data.vertices=n,e.data.normals=s,u.length>0&&(e.data.colors=u),h.length>0&&(e.data.uvs=[h]),e.data.faces=a,e},clone:function(){return(new Geometry).copy(this)},copy:function(e){var t,r,n,i,o,a;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var s=e.vertices;for(t=0,r=s.length;t<r;t++)this.vertices.push(s[t].clone());var l=e.colors;for(t=0,r=l.length;t<r;t++)this.colors.push(l[t].clone());var u=e.faces;for(t=0,r=u.length;t<r;t++)this.faces.push(u[t].clone());for(t=0,r=e.faceVertexUvs.length;t<r;t++){var c=e.faceVertexUvs[t];for(void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]),n=0,i=c.length;n<i;n++){var h=c[n],p=[];for(o=0,a=h.length;o<a;o++){var f=h[o];p.push(f.clone())}this.faceVertexUvs[t].push(p)}}var d=e.morphTargets;for(t=0,r=d.length;t<r;t++){var m={};if(m.name=d[t].name,void 0!==d[t].vertices)for(m.vertices=[],n=0,i=d[t].vertices.length;n<i;n++)m.vertices.push(d[t].vertices[n].clone());if(void 0!==d[t].normals)for(m.normals=[],n=0,i=d[t].normals.length;n<i;n++)m.normals.push(d[t].normals[n].clone());this.morphTargets.push(m)}var v=e.morphNormals;for(t=0,r=v.length;t<r;t++){var g={};if(void 0!==v[t].vertexNormals)for(g.vertexNormals=[],n=0,i=v[t].vertexNormals.length;n<i;n++){var y=v[t].vertexNormals[n],b={};b.a=y.a.clone(),b.b=y.b.clone(),b.c=y.c.clone(),g.vertexNormals.push(b)}if(void 0!==v[t].faceNormals)for(g.faceNormals=[],n=0,i=v[t].faceNormals.length;n<i;n++)g.faceNormals.push(v[t].faceNormals[n].clone());this.morphNormals.push(g)}var x=e.skinWeights;for(t=0,r=x.length;t<r;t++)this.skinWeights.push(x[t].clone());var w=e.skinIndices;for(t=0,r=w.length;t<r;t++)this.skinIndices.push(w[t].clone());var S=e.lineDistances;for(t=0,r=S.length;t<r;t++)this.lineDistances.push(S[t]);var M=e.boundingBox;null!==M&&(this.boundingBox=M.clone());var _=e.boundingSphere;return null!==_&&(this.boundingSphere=_.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.assign(Vector4.prototype,{isVector4:!0,set:function(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,r=this.y,n=this.z,i=this.w,o=e.elements;return this.x=o[0]*t+o[4]*r+o[8]*n+o[12]*i,this.y=o[1]*t+o[5]*r+o[9]*n+o[13]*i,this.z=o[2]*t+o[6]*r+o[10]*n+o[14]*i,this.w=o[3]*t+o[7]*r+o[11]*n+o[15]*i,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,r,n,i,o=e.elements,a=o[0],s=o[4],l=o[8],u=o[1],c=o[5],h=o[9],p=o[2],f=o[6],d=o[10];if(Math.abs(s-u)<.01&&Math.abs(l-p)<.01&&Math.abs(h-f)<.01){if(Math.abs(s+u)<.1&&Math.abs(l+p)<.1&&Math.abs(h+f)<.1&&Math.abs(a+c+d-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;var m=(a+1)/2,v=(c+1)/2,g=(d+1)/2,y=(s+u)/4,b=(l+p)/4,x=(h+f)/4;return m>v&&m>g?m<.01?(r=0,n=.707106781,i=.707106781):(n=y/(r=Math.sqrt(m)),i=b/r):v>g?v<.01?(r=.707106781,n=0,i=.707106781):(r=y/(n=Math.sqrt(v)),i=x/n):g<.01?(r=.707106781,n=.707106781,i=0):(r=b/(i=Math.sqrt(g)),n=x/i),this.set(r,n,i,t),this}var w=Math.sqrt((f-h)*(f-h)+(l-p)*(l-p)+(u-s)*(u-s));return Math.abs(w)<.001&&(w=1),this.x=(f-h)/w,this.y=(l-p)/w,this.z=(u-s)/w,this.w=Math.acos((a+c+d-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(){var e,t;return function(r,n){return void 0===e&&(e=new Vector4,t=new Vector4),e.set(r,r,r,r),t.set(n,n,n,n),this.clamp(e,t)}}(),clampLength:function(e,t){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),Object.defineProperty(BufferAttribute.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(BufferAttribute.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("BufferAttribute: array should be a Typed Array.");return this.count=void 0!==e?e.length/this.itemSize:0,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.dynamic=e.dynamic,this},copyAt:function(e,t,r){e*=this.itemSize,r*=t.itemSize;for(var n=0,i=this.itemSize;n<i;n++)this.array[e+n]=t.array[r+n];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,r=0,n=0,i=e.length;n<i;n++){var o=e[n];void 0===o&&(console.warn("BufferAttribute.copyColorsArray(): color is undefined",n),o=new Color),t[r++]=o.r,t[r++]=o.g,t[r++]=o.b}return this},copyVector2sArray:function(e){for(var t=this.array,r=0,n=0,i=e.length;n<i;n++){var o=e[n];void 0===o&&(console.warn("BufferAttribute.copyVector2sArray(): vector is undefined",n),o=new Vector2),t[r++]=o.x,t[r++]=o.y}return this},copyVector3sArray:function(e){for(var t=this.array,r=0,n=0,i=e.length;n<i;n++){var o=e[n];void 0===o&&(console.warn("BufferAttribute.copyVector3sArray(): vector is undefined",n),o=new Vector3),t[r++]=o.x,t[r++]=o.y,t[r++]=o.z}return this},copyVector4sArray:function(e){for(var t=this.array,r=0,n=0,i=e.length;n<i;n++){var o=e[n];void 0===o&&(console.warn("BufferAttribute.copyVector4sArray(): vector is undefined",n),o=new Vector4),t[r++]=o.x,t[r++]=o.y,t[r++]=o.z,t[r++]=o.w}return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this},setXYZ:function(e,t,r,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this},setXYZW:function(e,t,r,n,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this.array[e+3]=i,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),Int8BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Int8BufferAttribute.prototype.constructor=Int8BufferAttribute,Uint8BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Uint8BufferAttribute.prototype.constructor=Uint8BufferAttribute,Uint8ClampedBufferAttribute.prototype=Object.create(BufferAttribute.prototype),Uint8ClampedBufferAttribute.prototype.constructor=Uint8ClampedBufferAttribute,Int16BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Int16BufferAttribute.prototype.constructor=Int16BufferAttribute,Uint16BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Uint16BufferAttribute.prototype.constructor=Uint16BufferAttribute,Int32BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Int32BufferAttribute.prototype.constructor=Int32BufferAttribute,Uint32BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Uint32BufferAttribute.prototype.constructor=Uint32BufferAttribute,Float32BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Float32BufferAttribute.prototype.constructor=Float32BufferAttribute,Float64BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Float64BufferAttribute.prototype.constructor=Float64BufferAttribute,Object.assign(DirectGeometry.prototype,{computeGroups:function(e){for(var t,r=[],n=void 0,i=e.faces,o=0;o<i.length;o++){var a=i[o];a.materialIndex!==n&&(n=a.materialIndex,void 0!==t&&(t.count=3*o-t.start,r.push(t)),t={start:3*o,materialIndex:n})}void 0!==t&&(t.count=3*o-t.start,r.push(t)),this.groups=r},fromGeometry:function(e){var t,r=e.faces,n=e.vertices,i=e.faceVertexUvs,o=i[0]&&i[0].length>0,a=i[1]&&i[1].length>0,s=e.morphTargets,l=s.length;if(l>0){t=[];for(var u=0;u<l;u++)t[u]={name:s[u].name,data:[]};this.morphTargets.position=t}var c,h=e.morphNormals,p=h.length;if(p>0){c=[];for(u=0;u<p;u++)c[u]={name:h[u].name,data:[]};this.morphTargets.normal=c}var f=e.skinIndices,d=e.skinWeights,m=f.length===n.length,v=d.length===n.length;n.length>0&&0===r.length&&console.error("DirectGeometry: Faceless geometries are not supported.");for(u=0;u<r.length;u++){var g=r[u];this.vertices.push(n[g.a],n[g.b],n[g.c]);var y=g.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var b=g.normal;this.normals.push(b,b,b)}var x,w=g.vertexColors;if(3===w.length)this.colors.push(w[0],w[1],w[2]);else{var S=g.color;this.colors.push(S,S,S)}if(!0===o)void 0!==(x=i[0][u])?this.uvs.push(x[0],x[1],x[2]):(console.warn("DirectGeometry.fromGeometry(): Undefined vertexUv ",u),this.uvs.push(new Vector2,new Vector2,new Vector2));if(!0===a)void 0!==(x=i[1][u])?this.uvs2.push(x[0],x[1],x[2]):(console.warn("DirectGeometry.fromGeometry(): Undefined vertexUv2 ",u),this.uvs2.push(new Vector2,new Vector2,new Vector2));for(var M=0;M<l;M++){var _=s[M].vertices;t[M].data.push(_[g.a],_[g.b],_[g.c])}for(M=0;M<p;M++){var T=h[M].vertexNormals[u];c[M].data.push(T.a,T.b,T.c)}m&&this.skinIndices.push(f[g.a],f[g.b],f[g.c]),v&&this.skinWeights.push(d[g.a],d[g.b],d[g.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}});var bufferGeometryId=1;function BufferGeometry(){Object.defineProperty(this,"id",{value:bufferGeometryId+=2}),this.uuid=_Math.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}function SphereGeometry(e,t,r,n,i,o,a){Geometry.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:i,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new SphereBufferGeometry(e,t,r,n,i,o,a)),this.mergeVertices()}function SphereBufferGeometry(e,t,r,n,i,o,a){BufferGeometry.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:i,thetaStart:o,thetaLength:a},e=e||1,t=Math.max(3,Math.floor(t)||8),r=Math.max(2,Math.floor(r)||6),n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI;var s,l,u=(o=void 0!==o?o:0)+(a=void 0!==a?a:Math.PI),c=0,h=[],p=new Vector3,f=new Vector3,d=[],m=[],v=[],g=[];for(l=0;l<=r;l++){var y=[],b=l/r;for(s=0;s<=t;s++){var x=s/t;p.x=-e*Math.cos(n+x*i)*Math.sin(o+b*a),p.y=e*Math.cos(o+b*a),p.z=e*Math.sin(n+x*i)*Math.sin(o+b*a),m.push(p.x,p.y,p.z),f.set(p.x,p.y,p.z).normalize(),v.push(f.x,f.y,f.z),g.push(x,1-b),y.push(c++)}h.push(y)}for(l=0;l<r;l++)for(s=0;s<t;s++){var w=h[l][s+1],S=h[l][s],M=h[l+1][s],_=h[l+1][s+1];(0!==l||o>0)&&d.push(w,S,_),(l!==r-1||u<Math.PI)&&d.push(S,M,_)}this.setIndex(d),this.addAttribute("position",new Float32BufferAttribute(m,3)),this.addAttribute("normal",new Float32BufferAttribute(v,3)),this.addAttribute("uv",new Float32BufferAttribute(g,2))}BufferGeometry.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:BufferGeometry,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(arrayMax(e)>65535?Uint32BufferAttribute:Uint16BufferAttribute)(e,1):this.index=e},addAttribute:function(e,t){return t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):(this.attributes[e]=t,this):(console.warn("BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(e,new BufferAttribute(arguments[1],arguments[2])))},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,r){this.groups.push({start:e,count:t,materialIndex:void 0!==r?r:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToBufferAttribute(t),t.needsUpdate=!0);var r=this.attributes.normal;void 0!==r&&((new Matrix3).getNormalMatrix(e).applyToBufferAttribute(r),r.needsUpdate=!0);var n=this.attributes.tangent;void 0!==n&&((new Matrix3).getNormalMatrix(e).applyToBufferAttribute(n),n.needsUpdate=!0);return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var e=new Matrix4;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new Matrix4;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new Matrix4;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new Matrix4;return function(t,r,n){return e.makeTranslation(t,r,n),this.applyMatrix(e),this}}(),scale:function(){var e=new Matrix4;return function(t,r,n){return e.makeScale(t,r,n),this.applyMatrix(e),this}}(),lookAt:function(){var e=new Object3D;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),center:function(){var e=new Vector3;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(e).negate(),this.translate(e.x,e.y,e.z),this}}(),setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var r=new Float32BufferAttribute(3*t.vertices.length,3),n=new Float32BufferAttribute(3*t.colors.length,3);if(this.addAttribute("position",r.copyVector3sArray(t.vertices)),this.addAttribute("color",n.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var i=new Float32BufferAttribute(t.lineDistances.length,1);this.addAttribute("lineDistance",i.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){for(var t=[],r=0,n=e.length;r<n;r++){var i=e[r];t.push(i.x,i.y,i.z||0)}return this.addAttribute("position",new Float32BufferAttribute(t,3)),this},updateFromObject:function(e){var t,r=e.geometry;if(e.isMesh){var n=r.__directGeometry;if(!0===r.elementsNeedUpdate&&(n=void 0,r.elementsNeedUpdate=!1),void 0===n)return this.fromGeometry(r);n.verticesNeedUpdate=r.verticesNeedUpdate,n.normalsNeedUpdate=r.normalsNeedUpdate,n.colorsNeedUpdate=r.colorsNeedUpdate,n.uvsNeedUpdate=r.uvsNeedUpdate,n.groupsNeedUpdate=r.groupsNeedUpdate,r.verticesNeedUpdate=!1,r.normalsNeedUpdate=!1,r.colorsNeedUpdate=!1,r.uvsNeedUpdate=!1,r.groupsNeedUpdate=!1,r=n}return!0===r.verticesNeedUpdate&&(void 0!==(t=this.attributes.position)&&(t.copyVector3sArray(r.vertices),t.needsUpdate=!0),r.verticesNeedUpdate=!1),!0===r.normalsNeedUpdate&&(void 0!==(t=this.attributes.normal)&&(t.copyVector3sArray(r.normals),t.needsUpdate=!0),r.normalsNeedUpdate=!1),!0===r.colorsNeedUpdate&&(void 0!==(t=this.attributes.color)&&(t.copyColorsArray(r.colors),t.needsUpdate=!0),r.colorsNeedUpdate=!1),r.uvsNeedUpdate&&(void 0!==(t=this.attributes.uv)&&(t.copyVector2sArray(r.uvs),t.needsUpdate=!0),r.uvsNeedUpdate=!1),r.lineDistancesNeedUpdate&&(void 0!==(t=this.attributes.lineDistance)&&(t.copyArray(r.lineDistances),t.needsUpdate=!0),r.lineDistancesNeedUpdate=!1),r.groupsNeedUpdate&&(r.computeGroups(e.geometry),this.groups=r.groups,r.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new DirectGeometry).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.addAttribute("position",new BufferAttribute(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){var r=new Float32Array(3*e.normals.length);this.addAttribute("normal",new BufferAttribute(r,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var n=new Float32Array(3*e.colors.length);this.addAttribute("color",new BufferAttribute(n,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var i=new Float32Array(2*e.uvs.length);this.addAttribute("uv",new BufferAttribute(i,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var o=new Float32Array(2*e.uvs2.length);this.addAttribute("uv2",new BufferAttribute(o,2).copyVector2sArray(e.uvs2))}for(var a in this.groups=e.groups,e.morphTargets){for(var s=[],l=e.morphTargets[a],u=0,c=l.length;u<c;u++){var h=l[u],p=new Float32BufferAttribute(3*h.data.length,3);p.name=h.name,s.push(p.copyVector3sArray(h.data))}this.morphAttributes[a]=s}if(e.skinIndices.length>0){var f=new Float32BufferAttribute(4*e.skinIndices.length,4);this.addAttribute("skinIndex",f.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var d=new Float32BufferAttribute(4*e.skinWeights.length,4);this.addAttribute("skinWeight",d.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Box3);var e=this.attributes.position;void 0!==e?this.boundingBox.setFromBufferAttribute(e):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var e=new Box3,t=new Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new Sphere);var r=this.attributes.position;if(r){var n=this.boundingSphere.center;e.setFromBufferAttribute(r),e.getCenter(n);for(var i=0,o=0,a=r.count;o<a;o++)t.x=r.getX(o),t.y=r.getY(o),t.z=r.getZ(o),i=Math.max(i,n.distanceToSquared(t));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes;if(t.position){var r=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new BufferAttribute(new Float32Array(r.length),3));else for(var n=t.normal.array,i=0,o=n.length;i<o;i++)n[i]=0;var a,s,l,u=t.normal.array,c=new Vector3,h=new Vector3,p=new Vector3,f=new Vector3,d=new Vector3;if(e){var m=e.array;for(i=0,o=e.count;i<o;i+=3)a=3*m[i+0],s=3*m[i+1],l=3*m[i+2],c.fromArray(r,a),h.fromArray(r,s),p.fromArray(r,l),f.subVectors(p,h),d.subVectors(c,h),f.cross(d),u[a]+=f.x,u[a+1]+=f.y,u[a+2]+=f.z,u[s]+=f.x,u[s+1]+=f.y,u[s+2]+=f.z,u[l]+=f.x,u[l+1]+=f.y,u[l+2]+=f.z}else for(i=0,o=r.length;i<o;i+=9)c.fromArray(r,i),h.fromArray(r,i+3),p.fromArray(r,i+6),f.subVectors(p,h),d.subVectors(c,h),f.cross(d),u[i]=f.x,u[i+1]=f.y,u[i+2]=f.z,u[i+3]=f.x,u[i+4]=f.y,u[i+5]=f.z,u[i+6]=f.x,u[i+7]=f.y,u[i+8]=f.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var r=this.attributes;for(var n in r)if(void 0!==e.attributes[n])for(var i=r[n].array,o=e.attributes[n],a=o.array,s=0,l=o.itemSize*t;s<a.length;s++,l++)i[l]=a[s];return this}console.error("BufferGeometry.merge(): geometry not an instance of BufferGeometry.",e)},normalizeNormals:function(){var e=new Vector3;return function(){for(var t=this.attributes.normal,r=0,n=t.count;r<n;r++)e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.normalize(),t.setXYZ(r,e.x,e.y,e.z)}}(),toNonIndexed:function(){function e(e,t){for(var r=e.array,n=e.itemSize,i=new r.constructor(t.length*n),o=0,a=0,s=0,l=t.length;s<l;s++){o=t[s]*n;for(var u=0;u<n;u++)i[a++]=r[o++]}return new BufferAttribute(i,n)}if(null===this.index)return console.warn("BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new BufferGeometry,r=this.index.array,n=this.attributes;for(var i in n){var o=e(n[i],r);t.addAttribute(i,o)}var a=this.morphAttributes;for(i in a){for(var s=[],l=a[i],u=0,c=l.length;u<c;u++){o=e(l[u],r);s.push(o)}t.morphAttributes[i]=s}for(var h=this.groups,p=(u=0,h.length);u<p;u++){var f=h[u];t.addGroup(f.start,f.count,f.materialIndex)}return t},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var r in t)void 0!==t[r]&&(e[r]=t[r]);return e}e.data={attributes:{}};var n=this.index;null!==n&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});var i=this.attributes;for(var r in i){var o={itemSize:(p=i[r]).itemSize,type:p.array.constructor.name,array:Array.prototype.slice.call(p.array),normalized:p.normalized};""!==p.name&&(o.name=p.name),e.data.attributes[r]=o}var a={},s=!1;for(var r in this.morphAttributes){for(var l=this.morphAttributes[r],u=[],c=0,h=l.length;c<h;c++){var p;o={itemSize:(p=l[c]).itemSize,type:p.array.constructor.name,array:Array.prototype.slice.call(p.array),normalized:p.normalized};""!==p.name&&(o.name=p.name),u.push(o)}u.length>0&&(a[r]=u,s=!0)}s&&(e.data.morphAttributes=a);var f=this.groups;f.length>0&&(e.data.groups=JSON.parse(JSON.stringify(f)));var d=this.boundingSphere;return null!==d&&(e.data.boundingSphere={center:d.center.toArray(),radius:d.radius}),e},clone:function(){return(new BufferGeometry).copy(this)},copy:function(e){var t,r,n;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var i=e.index;null!==i&&this.setIndex(i.clone());var o=e.attributes;for(t in o){var a=o[t];this.addAttribute(t,a.clone())}var s=e.morphAttributes;for(t in s){var l=[],u=s[t];for(r=0,n=u.length;r<n;r++)l.push(u[r].clone());this.morphAttributes[t]=l}var c=e.groups;for(r=0,n=c.length;r<n;r++){var h=c[r];this.addGroup(h.start,h.count,h.materialIndex)}var p=e.boundingBox;null!==p&&(this.boundingBox=p.clone());var f=e.boundingSphere;return null!==f&&(this.boundingSphere=f.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),SphereGeometry.prototype=Object.create(Geometry.prototype),SphereGeometry.prototype.constructor=SphereGeometry,SphereBufferGeometry.prototype=Object.create(BufferGeometry.prototype),SphereBufferGeometry.prototype.constructor=SphereBufferGeometry;var materialId=0;function Material$1(){Object.defineProperty(this,"id",{value:materialId++}),this.uuid=_Math.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=NormalBlending,this.side=FrontSide,this.flatShading=!1,this.vertexTangents=!1,this.vertexColors=NoColors,this.opacity=1,this.transparent=!1,this.blendSrc=SrcAlphaFactor,this.blendDst=OneMinusSrcAlphaFactor,this.blendEquation=AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.userData={},this.needsUpdate=!0}function MeshBasicMaterial(e){Material$1.call(this),this.type="MeshBasicMaterial",this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function LineBasicMaterial(e){Material$1.call(this),this.type="LineBasicMaterial",this.color=new Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(e)}function Ray(e,t){this.origin=void 0!==e?e:new Vector3,this.direction=void 0!==t?t:new Vector3}function Triangle(e,t,r){this.a=void 0!==e?e:new Vector3,this.b=void 0!==t?t:new Vector3,this.c=void 0!==r?r:new Vector3}function Mesh(e,t){Object3D.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new BufferGeometry,this.material=void 0!==t?t:new MeshBasicMaterial({color:16777215*Math.random()}),this.drawMode=TrianglesDrawMode,this.updateMorphTargets()}function Line(e,t,r){1===r&&console.error("Line: parameter LinePieces no longer supported. Use LineSegments instead."),Object3D.call(this),this.type="Line",this.geometry=void 0!==e?e:new BufferGeometry,this.material=void 0!==t?t:new LineBasicMaterial({color:16777215*Math.random()})}Material$1.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:Material$1,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var r=e[t];if(void 0!==r)if("shading"!==t){var n=this[t];void 0!==n?n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[t]=r:console.warn(this.type+": '"+t+"' is not a property of this material.")}else console.warn(this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=r===FlatShading;else console.warn("Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e||"string"===typeof e;t&&(e={textures:{},images:{}});var r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function n(e){var t=[];for(var r in e){var n=e[r];delete n.metadata,t.push(n)}return t}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearCoat&&(r.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(r.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,r.reflectivity=this.reflectivity,void 0!==this.combine&&(r.combine=this.combine),void 0!==this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(r.size=this.size),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==NormalBlending&&(r.blending=this.blending),!0===this.flatShading&&(r.flatShading=this.flatShading),this.side!==FrontSide&&(r.side=this.side),this.vertexColors!==NoColors&&(r.vertexColors=this.vertexColors),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(r.morphTargets=!0),!0===this.skinning&&(r.skinning=!0),!1===this.visible&&(r.visible=!1),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),t){var i=n(e.textures),o=n(e.images);i.length>0&&(r.textures=i),o.length>0&&(r.images=o)}return r},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.lights=e.lights,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.userData=JSON.parse(JSON.stringify(e.userData)),this.clipShadows=e.clipShadows,this.clipIntersection=e.clipIntersection;var t=e.clippingPlanes,r=null;if(null!==t){var n=t.length;r=new Array(n);for(var i=0;i!==n;++i)r[i]=t[i].clone()}return this.clippingPlanes=r,this.shadowSide=e.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),MeshBasicMaterial.prototype=Object.create(Material$1.prototype),MeshBasicMaterial.prototype.constructor=MeshBasicMaterial,MeshBasicMaterial.prototype.isMeshBasicMaterial=!0,MeshBasicMaterial.prototype.copy=function(e){return Material$1.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},LineBasicMaterial.prototype=Object.create(Material$1.prototype),LineBasicMaterial.prototype.constructor=LineBasicMaterial,LineBasicMaterial.prototype.isLineBasicMaterial=!0,LineBasicMaterial.prototype.copy=function(e){return Material$1.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this},Object.assign(Ray.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return void 0===t&&(console.warn("Ray: .at() target is now required"),t=new Vector3),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(){var e=new Vector3;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){void 0===t&&(console.warn("Ray: .closestPointToPoint() target is now required"),t=new Vector3),t.subVectors(e,this.origin);var r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(r).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(){var e=new Vector3;return function(t){var r=e.subVectors(t,this.origin).dot(this.direction);return r<0?this.origin.distanceToSquared(t):(e.copy(this.direction).multiplyScalar(r).add(this.origin),e.distanceToSquared(t))}}(),distanceSqToSegment:function(){var e=new Vector3,t=new Vector3,r=new Vector3;return function(n,i,o,a){e.copy(n).add(i).multiplyScalar(.5),t.copy(i).sub(n).normalize(),r.copy(this.origin).sub(e);var s,l,u,c,h=.5*n.distanceTo(i),p=-this.direction.dot(t),f=r.dot(this.direction),d=-r.dot(t),m=r.lengthSq(),v=Math.abs(1-p*p);if(v>0)if(l=p*f-d,c=h*v,(s=p*d-f)>=0)if(l>=-c)if(l<=c){var g=1/v;u=(s*=g)*(s+p*(l*=g)+2*f)+l*(p*s+l+2*d)+m}else l=h,u=-(s=Math.max(0,-(p*l+f)))*s+l*(l+2*d)+m;else l=-h,u=-(s=Math.max(0,-(p*l+f)))*s+l*(l+2*d)+m;else l<=-c?u=-(s=Math.max(0,-(-p*h+f)))*s+(l=s>0?-h:Math.min(Math.max(-h,-d),h))*(l+2*d)+m:l<=c?(s=0,u=(l=Math.min(Math.max(-h,-d),h))*(l+2*d)+m):u=-(s=Math.max(0,-(p*h+f)))*s+(l=s>0?h:Math.min(Math.max(-h,-d),h))*(l+2*d)+m;else l=p>0?-h:h,u=-(s=Math.max(0,-(p*l+f)))*s+l*(l+2*d)+m;return o&&o.copy(this.direction).multiplyScalar(s).add(this.origin),a&&a.copy(t).multiplyScalar(l).add(e),u}}(),intersectSphere:function(){var e=new Vector3;return function(t,r){e.subVectors(t.center,this.origin);var n=e.dot(this.direction),i=e.dot(e)-n*n,o=t.radius*t.radius;if(i>o)return null;var a=Math.sqrt(o-i),s=n-a,l=n+a;return s<0&&l<0?null:s<0?this.at(l,r):this.at(s,r)}}(),intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null},intersectPlane:function(e,t){var r=this.distanceToPlane(e);return null===r?null:this.at(r,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){var r,n,i,o,a,s,l=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,h=this.origin;return l>=0?(r=(e.min.x-h.x)*l,n=(e.max.x-h.x)*l):(r=(e.max.x-h.x)*l,n=(e.min.x-h.x)*l),u>=0?(i=(e.min.y-h.y)*u,o=(e.max.y-h.y)*u):(i=(e.max.y-h.y)*u,o=(e.min.y-h.y)*u),r>o||i>n?null:((i>r||r!==r)&&(r=i),(o<n||n!==n)&&(n=o),c>=0?(a=(e.min.z-h.z)*c,s=(e.max.z-h.z)*c):(a=(e.max.z-h.z)*c,s=(e.min.z-h.z)*c),r>s||a>n?null:((a>r||r!==r)&&(r=a),(s<n||n!==n)&&(n=s),n<0?null:this.at(r>=0?r:n,t)))},intersectsBox:function(){var e=new Vector3;return function(t){return null!==this.intersectBox(t,e)}}(),intersectTriangle:function(){var e=new Vector3,t=new Vector3,r=new Vector3,n=new Vector3;return function(i,o,a,s,l){t.subVectors(o,i),r.subVectors(a,i),n.crossVectors(t,r);var u,c=this.direction.dot(n);if(c>0){if(s)return null;u=1}else{if(!(c<0))return null;u=-1,c=-c}e.subVectors(this.origin,i);var h=u*this.direction.dot(r.crossVectors(e,r));if(h<0)return null;var p=u*this.direction.dot(t.cross(e));if(p<0)return null;if(h+p>c)return null;var f=-u*e.dot(n);return f<0?null:this.at(f/c,l)}}(),applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}}),Object.assign(Triangle,{getNormal:function(){var e=new Vector3;return function(t,r,n,i){void 0===i&&(console.warn("Triangle: .getNormal() target is now required"),i=new Vector3),i.subVectors(n,r),e.subVectors(t,r),i.cross(e);var o=i.lengthSq();return o>0?i.multiplyScalar(1/Math.sqrt(o)):i.set(0,0,0)}}(),getBarycoord:function(){var e=new Vector3,t=new Vector3,r=new Vector3;return function(n,i,o,a,s){e.subVectors(a,i),t.subVectors(o,i),r.subVectors(n,i);var l=e.dot(e),u=e.dot(t),c=e.dot(r),h=t.dot(t),p=t.dot(r),f=l*h-u*u;if(void 0===s&&(console.warn("Triangle: .getBarycoord() target is now required"),s=new Vector3),0===f)return s.set(-2,-1,-1);var d=1/f,m=(h*c-u*p)*d,v=(l*p-u*c)*d;return s.set(1-m-v,v,m)}}(),containsPoint:function(){var e=new Vector3;return function(t,r,n,i){return Triangle.getBarycoord(t,r,n,i,e),e.x>=0&&e.y>=0&&e.x+e.y<=1}}(),getUV:function(){var e=new Vector3;return function(t,r,n,i,o,a,s,l){return this.getBarycoord(t,r,n,i,e),l.set(0,0),l.addScaledVector(o,e.x),l.addScaledVector(a,e.y),l.addScaledVector(s,e.z),l}}()}),Object.assign(Triangle.prototype,{set:function(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this},setFromPointsAndIndices:function(e,t,r,n){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[n]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){var e=new Vector3,t=new Vector3;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),getMidpoint:function(e){return void 0===e&&(console.warn("Triangle: .getMidpoint() target is now required"),e=new Vector3),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return Triangle.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return void 0===e&&(console.warn("Triangle: .getPlane() target is now required"),e=new Vector3),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return Triangle.getBarycoord(e,this.a,this.b,this.c,t)},containsPoint:function(e){return Triangle.containsPoint(e,this.a,this.b,this.c)},getUV:function(e,t,r,n,i){return Triangle.getUV(e,this.a,this.b,this.c,t,r,n,i)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(){var e=new Vector3,t=new Vector3,r=new Vector3,n=new Vector3,i=new Vector3,o=new Vector3;return function(a,s){void 0===s&&(console.warn("Triangle: .closestPointToPoint() target is now required"),s=new Vector3);var l,u,c=this.a,h=this.b,p=this.c;e.subVectors(h,c),t.subVectors(p,c),n.subVectors(a,c);var f=e.dot(n),d=t.dot(n);if(f<=0&&d<=0)return s.copy(c);i.subVectors(a,h);var m=e.dot(i),v=t.dot(i);if(m>=0&&v<=m)return s.copy(h);var g=f*v-m*d;if(g<=0&&f>=0&&m<=0)return l=f/(f-m),s.copy(c).addScaledVector(e,l);o.subVectors(a,p);var y=e.dot(o),b=t.dot(o);if(b>=0&&y<=b)return s.copy(p);var x=y*d-f*b;if(x<=0&&d>=0&&b<=0)return u=d/(d-b),s.copy(c).addScaledVector(t,u);var w=m*b-y*v;if(w<=0&&v-m>=0&&y-b>=0)return r.subVectors(p,h),u=(v-m)/(v-m+(y-b)),s.copy(h).addScaledVector(r,u);var S=1/(w+x+g);return l=x*S,u=g*S,s.copy(c).addScaledVector(e,l).addScaledVector(t,u)}}(),equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}),Mesh.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Mesh,isMesh:!0,setDrawMode:function(e){this.drawMode=e},copy:function(e){return Object3D.prototype.copy.call(this,e),this.drawMode=e.drawMode,void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e,t,r,n=this.geometry;if(n.isBufferGeometry){var i=n.morphAttributes,o=Object.keys(i);if(o.length>0){var a=i[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=a.length;e<t;e++)r=a[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=e}}else{var s=n.morphTargets;void 0!==s&&s.length>0&&console.error("Mesh.updateMorphTargets() no longer supports Geometry. Use BufferGeometry instead.")}},raycast:function(){var e=new Matrix4,t=new Ray,r=new Sphere,n=new Vector3,i=new Vector3,o=new Vector3,a=new Vector3,s=new Vector3,l=new Vector3,u=new Vector2,c=new Vector2,h=new Vector2,p=new Vector3,f=new Vector3;function d(e,t,r,n,i,o,a,s){if(null===(t.side===BackSide?n.intersectTriangle(a,o,i,!0,s):n.intersectTriangle(i,o,a,t.side!==DoubleSide,s)))return null;f.copy(s),f.applyMatrix4(e.matrixWorld);var l=r.ray.origin.distanceTo(f);return l<r.near||l>r.far?null:{distance:l,point:f.clone(),object:e}}function m(e,t,r,a,s,l,f,m,v){n.fromBufferAttribute(s,f),i.fromBufferAttribute(s,m),o.fromBufferAttribute(s,v);var g=d(e,t,r,a,n,i,o,p);if(g){l&&(u.fromBufferAttribute(l,f),c.fromBufferAttribute(l,m),h.fromBufferAttribute(l,v),g.uv=Triangle.getUV(p,n,i,o,u,c,h,new Vector2));var y=new Face3(f,m,v);Triangle.getNormal(n,i,o,y.normal),g.face=y}return g}return function(f,v){var g,y=this.geometry,b=this.material,x=this.matrixWorld;if(void 0!==b&&(null===y.boundingSphere&&y.computeBoundingSphere(),r.copy(y.boundingSphere),r.applyMatrix4(x),!1!==f.ray.intersectsSphere(r)&&(e.getInverse(x),t.copy(f.ray).applyMatrix4(e),null===y.boundingBox||!1!==t.intersectsBox(y.boundingBox))))if(y.isBufferGeometry){var w,S,M,_,T,A,C,E,L,N=y.index,P=y.attributes.position,O=y.attributes.uv,R=y.groups,D=y.drawRange;if(null!==N)if(Array.isArray(b))for(_=0,A=R.length;_<A;_++)for(L=b[(E=R[_]).materialIndex],T=Math.max(E.start,D.start),C=Math.min(E.start+E.count,D.start+D.count);T<C;T+=3)w=N.getX(T),S=N.getX(T+1),M=N.getX(T+2),(g=m(this,L,f,t,P,O,w,S,M))&&(g.faceIndex=Math.floor(T/3),g.face.materialIndex=E.materialIndex,v.push(g));else for(_=Math.max(0,D.start),A=Math.min(N.count,D.start+D.count);_<A;_+=3)w=N.getX(_),S=N.getX(_+1),M=N.getX(_+2),(g=m(this,b,f,t,P,O,w,S,M))&&(g.faceIndex=Math.floor(_/3),v.push(g));else if(void 0!==P)if(Array.isArray(b))for(_=0,A=R.length;_<A;_++)for(L=b[(E=R[_]).materialIndex],T=Math.max(E.start,D.start),C=Math.min(E.start+E.count,D.start+D.count);T<C;T+=3)(g=m(this,L,f,t,P,O,w=T,S=T+1,M=T+2))&&(g.faceIndex=Math.floor(T/3),g.face.materialIndex=E.materialIndex,v.push(g));else for(_=Math.max(0,D.start),A=Math.min(P.count,D.start+D.count);_<A;_+=3)(g=m(this,b,f,t,P,O,w=_,S=_+1,M=_+2))&&(g.faceIndex=Math.floor(_/3),v.push(g))}else if(y.isGeometry){var F,k,I,B,U=Array.isArray(b),V=y.vertices,j=y.faces,z=y.faceVertexUvs[0];z.length>0&&(B=z);for(var G=0,W=j.length;G<W;G++){var H=j[G],X=U?b[H.materialIndex]:b;if(void 0!==X){if(F=V[H.a],k=V[H.b],I=V[H.c],!0===X.morphTargets){var q=y.morphTargets,Y=this.morphTargetInfluences;n.set(0,0,0),i.set(0,0,0),o.set(0,0,0);for(var K=0,Q=q.length;K<Q;K++){var J=Y[K];if(0!==J){var Z=q[K].vertices;n.addScaledVector(a.subVectors(Z[H.a],F),J),i.addScaledVector(s.subVectors(Z[H.b],k),J),o.addScaledVector(l.subVectors(Z[H.c],I),J)}}n.add(F),i.add(k),o.add(I),F=n,k=i,I=o}if(g=d(this,X,f,t,F,k,I,p)){if(B&&B[G]){var $=B[G];u.copy($[0]),c.copy($[1]),h.copy($[2]),g.uv=Triangle.getUV(p,F,k,I,u,c,h,new Vector2)}g.face=H,g.faceIndex=G,v.push(g)}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Line.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Line,isLine:!0,computeLineDistances:function(){var e=new Vector3,t=new Vector3;return function(){var r=this.geometry;if(r.isBufferGeometry)if(null===r.index){for(var n=r.attributes.position,i=[0],o=1,a=n.count;o<a;o++)e.fromBufferAttribute(n,o-1),t.fromBufferAttribute(n,o),i[o]=i[o-1],i[o]+=e.distanceTo(t);r.addAttribute("lineDistance",new Float32BufferAttribute(i,1))}else console.warn("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(r.isGeometry){var s=r.vertices;(i=r.lineDistances)[0]=0;for(o=1,a=s.length;o<a;o++)i[o]=i[o-1],i[o]+=s[o-1].distanceTo(s[o])}return this}}(),raycast:function(){var e=new Matrix4,t=new Ray,r=new Sphere;return function(n,i){var o=n.linePrecision,a=this.geometry,s=this.matrixWorld;if(null===a.boundingSphere&&a.computeBoundingSphere(),r.copy(a.boundingSphere),r.applyMatrix4(s),r.radius+=o,!1!==n.ray.intersectsSphere(r)){e.getInverse(s),t.copy(n.ray).applyMatrix4(e);var l=o/((this.scale.x+this.scale.y+this.scale.z)/3),u=l*l,c=new Vector3,h=new Vector3,p=new Vector3,f=new Vector3,d=this&&this.isLineSegments?2:1;if(a.isBufferGeometry){var m=a.index,v=a.attributes.position.array;if(null!==m)for(var g=m.array,y=0,b=g.length-1;y<b;y+=d){var x=g[y],w=g[y+1];if(c.fromArray(v,3*x),h.fromArray(v,3*w),!(t.distanceSqToSegment(c,h,f,p)>u))f.applyMatrix4(this.matrixWorld),(_=n.ray.origin.distanceTo(f))<n.near||_>n.far||i.push({distance:_,point:p.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}else for(y=0,b=v.length/3-1;y<b;y+=d){if(c.fromArray(v,3*y),h.fromArray(v,3*y+3),!(t.distanceSqToSegment(c,h,f,p)>u))f.applyMatrix4(this.matrixWorld),(_=n.ray.origin.distanceTo(f))<n.near||_>n.far||i.push({distance:_,point:p.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}else if(a.isGeometry){var S=a.vertices,M=S.length;for(y=0;y<M-1;y+=d){var _;if(!(t.distanceSqToSegment(S[y],S[y+1],f,p)>u))f.applyMatrix4(this.matrixWorld),(_=n.ray.origin.distanceTo(f))<n.near||_>n.far||i.push({distance:_,point:p.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}}}}(),copy:function(e){return Object3D.prototype.copy.call(this,e),this.geometry.copy(e.geometry),this.material.copy(e.material),this},clone:function(){return(new this.constructor).copy(this)}});var CCDIKSolver=function(){function e(e,t){this.mesh=e,this.iks=t||[],this._valid()}function t(e,t){Object3D.call(this),this.root=e,this.iks=t||[],this.matrix.copy(e.matrixWorld),this.matrixAutoUpdate=!1,this.sphereGeometry=new SphereBufferGeometry(.25,16,8),this.targetSphereMaterial=new MeshBasicMaterial({color:new Color(16746632),depthTest:!1,depthWrite:!1,transparent:!0}),this.effectorSphereMaterial=new MeshBasicMaterial({color:new Color(8978312),depthTest:!1,depthWrite:!1,transparent:!0}),this.linkSphereMaterial=new MeshBasicMaterial({color:new Color(8947967),depthTest:!1,depthWrite:!1,transparent:!0}),this.lineMaterial=new LineBasicMaterial({color:new Color(16711680),depthTest:!1,depthWrite:!1,transparent:!0}),this._init()}return e.prototype={constructor:e,update:function(){var e=new Quaternion,t=new Vector3,r=new Vector3,n=new Vector3,i=new Vector3,o=new Vector3,a=new Quaternion,s=new Vector3,l=new Vector3,u=new Vector3;return function(){for(var c=this.mesh.skeleton.bones,h=this.iks,p=Math,f=0,d=h.length;f<d;f++){var m=h[f],v=c[m.effector],g=c[m.target];t.setFromMatrixPosition(g.matrixWorld);for(var y=m.links,b=void 0!==m.iteration?m.iteration:1,x=0;x<b;x++){for(var w=!1,S=0,M=y.length;S<M;S++){var _=c[y[S].index];if(!1===y[S].enabled)break;var T=y[S].limitation,A=y[S].rotationMin,C=y[S].rotationMax;_.matrixWorld.decompose(o,a,s),a.inverse(),n.setFromMatrixPosition(v.matrixWorld),i.subVectors(n,o),i.applyQuaternion(a),i.normalize(),r.subVectors(t,o),r.applyQuaternion(a),r.normalize();var E=r.dot(i);if(E>1?E=1:E<-1&&(E=-1),!((E=p.acos(E))<1e-5)){if(void 0!==m.minAngle&&E<m.minAngle&&(E=m.minAngle),void 0!==m.maxAngle&&E>m.maxAngle&&(E=m.maxAngle),l.crossVectors(i,r),l.normalize(),e.setFromAxisAngle(l,E),_.quaternion.multiply(e),void 0!==T){var L=_.quaternion.w;L>1&&(L=1);var N=p.sqrt(1-L*L);_.quaternion.set(T.x*N,T.y*N,T.z*N,L)}void 0!==A&&_.rotation.setFromVector3(_.rotation.toVector3(u).max(A)),void 0!==C&&_.rotation.setFromVector3(_.rotation.toVector3(u).min(C)),_.updateMatrixWorld(!0),w=!0}}if(!w)break}}return this}}(),createHelper:function(){return new t(this.mesh,this.mesh.geometry.userData.MMD.iks)},_valid:function(){for(var e=this.iks,t=this.mesh.skeleton.bones,r=0,n=e.length;r<n;r++){var i,o,a=e[r],s=t[a.effector],l=a.links;i=s;for(var u=0,c=l.length;u<c;u++)o=t[l[u].index],i.parent!==o&&console.warn("CCDIKSolver: bone "+i.name+" is not the child of bone "+o.name),i=o}}},t.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:t,updateMatrixWorld:function(){var e=new Matrix4,t=new Vector3;function r(e,r){return t.setFromMatrixPosition(e.matrixWorld).applyMatrix4(r)}function n(e,t,n,i){var o=r(n,i);e[3*t+0]=o.x,e[3*t+1]=o.y,e[3*t+2]=o.z}return function(t){var i=this.root;if(this.visible){var o=0,a=this.iks,s=i.skeleton.bones;e.getInverse(i.matrixWorld);for(var l=0,u=a.length;l<u;l++){var c=a[l],h=s[c.target],p=s[c.effector],f=this.children[o++],d=this.children[o++];f.position.copy(r(h,e)),d.position.copy(r(p,e));for(var m=0,v=c.links.length;m<v;m++){var g=s[c.links[m].index];this.children[o++].position.copy(r(g,e))}var y=this.children[o++],b=y.geometry.attributes.position.array;n(b,0,h,e),n(b,1,p,e);for(m=0,v=c.links.length;m<v;m++){n(b,m+2,g=s[c.links[m].index],e)}y.geometry.attributes.position.needsUpdate=!0}}this.matrix.copy(i.matrixWorld),Object3D.prototype.updateMatrixWorld.call(this,t)}}(),_init:function(){var e=this,t=this.iks;function r(t){return new Line(function(e){var t=new BufferGeometry,r=new Float32Array(3*(2+e.links.length));return t.addAttribute("position",new BufferAttribute(r,3)),t}(t),e.lineMaterial)}for(var n=0,i=t.length;n<i;n++){var o=t[n];this.add(new Mesh(e.sphereGeometry,e.targetSphereMaterial)),this.add(new Mesh(e.sphereGeometry,e.effectorSphereMaterial));for(var a=0,s=o.links.length;a<s;a++)this.add(new Mesh(e.sphereGeometry,e.linkSphereMaterial));this.add(r(o))}}}),e}();function AnimationAction(e,t,r){this._mixer=e,this._clip=t,this._localRoot=r||null;for(var n=t.tracks,i=n.length,o=new Array(i),a={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding},s=0;s!==i;++s){var l=n[s].createInterpolant(null);o[s]=l,l.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=LoopRepeat,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Interpolant(e,t,r,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new t.constructor(r),this.sampleValues=t,this.valueSize=r}function LinearInterpolant(e,t,r,n){Interpolant.call(this,e,t,r,n)}Object.assign(AnimationAction.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){var n=this._clip.duration,i=e._clip.duration,o=i/n,a=n/i;e.warp(1,o,t),this.warp(a,1,t)}return this},crossFadeTo:function(e,t,r){return e.crossFadeFrom(this,t,r)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,r){var n=this._mixer,i=n.time,o=this._timeScaleInterpolant,a=this.timeScale;null===o&&(o=n._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,l=o.sampleValues;return s[0]=i,s[1]=i+r,l[0]=e/a,l[1]=t/a,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,r,n){if(this.enabled){var i=this._startTime;if(null!==i){var o=(e-i)*r;if(o<0||0===r)return;this._startTime=null,t=r*o}t*=this._updateTimeScale(e);var a=this._updateTime(t),s=this._updateWeight(e);if(s>0)for(var l=this._interpolants,u=this._propertyBindings,c=0,h=l.length;c!==h;++c)l[c].evaluate(a),u[c].accumulate(n,s)}else this._updateWeight(e)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var r=this._weightInterpolant;if(null!==r){var n=r.evaluate(e)[0];t*=n,e>r.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var r=this._timeScaleInterpolant;if(null!==r)t*=r.evaluate(e)[0],e>r.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t,t},_updateTime:function(e){var t=this.time+e,r=this._clip.duration,n=this.loop,i=this._loopCount,o=n===LoopPingPong;if(0===e)return-1===i?t:o&&1===(1&i)?r-t:t;if(n===LoopOnce){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(t>=r)t=r;else{if(!(t<0))break e;t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),t>=r||t<0){var a=Math.floor(t/r);t-=r*a,i+=Math.abs(a);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=e>0?r:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){var l=e<0;this._setEndings(l,!l,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}if(o&&1===(1&i))return this.time=t,r-t}return this.time=t,t},_setEndings:function(e,t,r){var n=this._interpolantSettings;r?(n.endingStart=ZeroSlopeEnding,n.endingEnd=ZeroSlopeEnding):(n.endingStart=e?this.zeroSlopeAtStart?ZeroSlopeEnding:ZeroCurvatureEnding:WrapAroundEnding,n.endingEnd=t?this.zeroSlopeAtEnd?ZeroSlopeEnding:ZeroCurvatureEnding:WrapAroundEnding)},_scheduleFading:function(e,t,r){var n=this._mixer,i=n.time,o=this._weightInterpolant;null===o&&(o=n._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=i,s[0]=t,a[1]=i+e,s[1]=r,this}}),Object.assign(Interpolant.prototype,{evaluate:function(e){var t=this.parameterPositions,r=this._cachedIndex,n=t[r],i=t[r-1];e:{t:{var o;r:{n:if(!(e<n)){for(var a=r+2;;){if(void 0===n){if(e<i)break n;return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,e,i)}if(r===a)break;if(i=n,e<(n=t[++r]))break t}o=t.length;break r}if(e>=i)break e;var s=t[1];e<s&&(r=2,i=s);for(a=r-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,n);if(r===a)break;if(n=i,e>=(i=t[--r-1]))break t}o=r,r=0}for(;r<o;){var l=r+o>>>1;e<t[l]?o=l:r=l+1}if(n=t[r],void 0===(i=t[r-1]))return this._cachedIndex=0,this.beforeStart_(0,e,n);if(void 0===n)return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,i,e)}this._cachedIndex=r,this.intervalChanged_(r,i,n)}return this.interpolate_(r,i,e,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=e*n,o=0;o!==n;++o)t[o]=r[i+o];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Interpolant.prototype,{beforeStart_:Interpolant.prototype.copySampleValue_,afterEnd_:Interpolant.prototype.copySampleValue_}),LinearInterpolant.prototype=Object.assign(Object.create(Interpolant.prototype),{constructor:LinearInterpolant,interpolate_:function(e,t,r,n){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,l=s-a,u=(r-t)/(n-t),c=1-u,h=0;h!==a;++h)i[h]=o[l+h]*c+o[s+h]*u;return i}});var RESERVED_CHARS_RE="\\[\\]\\.:\\/";function Composite(e,t,r){var n=r||PropertyBinding.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}function PropertyBinding(e,t,r){this.path=t,this.parsedPath=r||PropertyBinding.parseTrackName(t),this.node=PropertyBinding.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function PropertyMixer(e,t,r){this.binding=e,this.valueSize=r;var n,i=Float64Array;switch(t){case"quaternion":n=this._slerp;break;case"string":case"bool":i=Array,n=this._select;break;default:n=this._lerp}this.buffer=new i(4*r),this._mixBufferRegion=n,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}Object.assign(Composite.prototype,{getValue:function(e,t){this.bind();var r=this._targetGroup.nCachedObjects_,n=this._bindings[r];void 0!==n&&n.getValue(e,t)},setValue:function(e,t){for(var r=this._bindings,n=this._targetGroup.nCachedObjects_,i=r.length;n!==i;++n)r[n].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}),Object.assign(PropertyBinding,{Composite:Composite,create:function(e,t,r){return e&&e.isAnimationObjectGroup?new PropertyBinding.Composite(e,t,r):new PropertyBinding(e,t,r)},sanitizeNodeName:function(){var e=new RegExp("["+RESERVED_CHARS_RE+"]","g");return function(t){return t.replace(/\s/g,"_").replace(e,"")}}(),parseTrackName:function(){var e="[^"+RESERVED_CHARS_RE+"]",t="[^"+RESERVED_CHARS_RE.replace("\\.","")+"]",r=/((?:WC+[\/:])*)/.source.replace("WC",e),n=/(WCOD+)?/.source.replace("WCOD",t),i=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",e),o=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",e),a=new RegExp("^"+r+n+i+o+"$"),s=["material","materials","bones"];return function(e){var t=a.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){var i=r.nodeName.substring(n+1);-1!==s.indexOf(i)&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=i)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}}(),findNode:function(e,t){if(!t||""===t||"root"===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var r=e.skeleton.getBoneByName(t);if(void 0!==r)return r}if(e.children){var n=function e(r){for(var n=0;n<r.length;n++){var i=r[n];if(i.name===t||i.uuid===t)return i;var o=e(i.children);if(o)return o}return null}(e.children);if(n)return n}return null}}),Object.assign(PropertyBinding.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)e[t++]=r[n]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=e[t++]},function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,r=t.objectName,n=t.propertyName,i=t.propertyIndex;if(e||(e=PropertyBinding.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(r){var o=t.objectIndex;switch(r){case"materials":if(!e.material)return void console.error("PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var a=0;a<e.length;a++)if(e[a].name===o){o=a;break}break;default:if(void 0===e[r])return void console.error("PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[r]}if(void 0!==o){if(void 0===e[o])return void console.error("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[o]}}var s=e[n];if(void 0!==s){var l=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);var u=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===n){if(!e.geometry)return void console.error("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(a=0;a<this.node.geometry.morphAttributes.position.length;a++)if(e.geometry.morphAttributes.position[a].name===i){i=a;break}}else{if(!e.geometry.morphTargets)return void console.error("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(a=0;a<this.node.geometry.morphTargets.length;a++)if(e.geometry.morphTargets[a].name===i){i=a;break}}}u=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(u=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][l]}else{var c=t.nodeName;console.error("PropertyBinding: Trying to update property for track: "+c+"."+n+" but it wasn't found.",e)}}else console.error("PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(PropertyBinding.prototype,{_getValue_unbound:PropertyBinding.prototype.getValue,_setValue_unbound:PropertyBinding.prototype.setValue}),Object.assign(PropertyMixer.prototype,{accumulate:function(e,t){var r=this.buffer,n=this.valueSize,i=e*n+n,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==n;++a)r[i+a]=r[a];o=t}else{var s=t/(o+=t);this._mixBufferRegion(r,i,0,s,n)}this.cumulativeWeight=o},apply:function(e){var t=this.valueSize,r=this.buffer,n=e*t+t,i=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,i<1){var a=3*t;this._mixBufferRegion(r,n,a,1-i,t)}for(var s=t,l=t+t;s!==l;++s)if(r[s]!==r[s+t]){o.setValue(r,n);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,r=this.valueSize,n=3*r;e.getValue(t,n);for(var i=r,o=n;i!==o;++i)t[i]=t[n+i%r];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,r,n,i){if(n>=.5)for(var o=0;o!==i;++o)e[t+o]=e[r+o]},_slerp:function(e,t,r,n){Quaternion.slerpFlat(e,t,e,t,e,r,n)},_lerp:function(e,t,r,n,i){for(var o=1-n,a=0;a!==i;++a){var s=t+a;e[s]=e[s]*o+e[r+a]*n}}});var AnimationUtils={arraySlice:function(e,t,r){return AnimationUtils.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==r?r:e.length)):e.slice(t,r)},convertArray:function(e,t,r){return!e||!r&&e.constructor===t?e:"number"===typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,r=new Array(t),n=0;n!==t;++n)r[n]=n;return r.sort(function(t,r){return e[t]-e[r]}),r},sortedArray:function(e,t,r){for(var n=e.length,i=new e.constructor(n),o=0,a=0;a!==n;++o)for(var s=r[o]*t,l=0;l!==t;++l)i[a++]=e[s+l];return i},flattenJSON:function(e,t,r,n){for(var i=1,o=e[0];void 0!==o&&void 0===o[n];)o=e[i++];if(void 0!==o){var a=o[n];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=o[n])&&(t.push(o.time),r.push.apply(r,a)),o=e[i++]}while(void 0!==o);else if(void 0!==a.toArray)do{void 0!==(a=o[n])&&(t.push(o.time),a.toArray(r,r.length)),o=e[i++]}while(void 0!==o);else do{void 0!==(a=o[n])&&(t.push(o.time),r.push(a)),o=e[i++]}while(void 0!==o)}}};function CubicInterpolant(e,t,r,n){Interpolant.call(this,e,t,r,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function DiscreteInterpolant(e,t,r,n){Interpolant.call(this,e,t,r,n)}function KeyframeTrack(e,t,r,n){if(void 0===e)throw new Error("KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=AnimationUtils.convertArray(t,this.TimeBufferType),this.values=AnimationUtils.convertArray(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}function BooleanKeyframeTrack(e,t,r){KeyframeTrack.call(this,e,t,r)}function ColorKeyframeTrack(e,t,r,n){KeyframeTrack.call(this,e,t,r,n)}function NumberKeyframeTrack(e,t,r,n){KeyframeTrack.call(this,e,t,r,n)}function QuaternionLinearInterpolant(e,t,r,n){Interpolant.call(this,e,t,r,n)}function QuaternionKeyframeTrack(e,t,r,n){KeyframeTrack.call(this,e,t,r,n)}function StringKeyframeTrack(e,t,r,n){KeyframeTrack.call(this,e,t,r,n)}function VectorKeyframeTrack(e,t,r,n){KeyframeTrack.call(this,e,t,r,n)}function AnimationClip(e,t,r){this.name=e,this.tracks=r,this.duration=void 0!==t?t:-1,this.uuid=_Math.generateUUID(),this.duration<0&&this.resetDuration()}function getTrackTypeForValueTypeName(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return VectorKeyframeTrack;case"color":return ColorKeyframeTrack;case"quaternion":return QuaternionKeyframeTrack;case"bool":case"boolean":return BooleanKeyframeTrack;case"string":return StringKeyframeTrack}throw new Error("KeyframeTrack: Unsupported typeName: "+e)}function parseKeyframeTrack(e){if(void 0===e.type)throw new Error("KeyframeTrack: track type undefined, can not parse");var t=getTrackTypeForValueTypeName(e.type);if(void 0===e.times){var r=[],n=[];AnimationUtils.flattenJSON(e.keys,r,n,"value"),e.times=r,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}function AnimationMixer(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Bone(){Object3D.call(this),this.type="Bone"}function BoxGeometry(e,t,r,n,i,o){Geometry.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:i,depthSegments:o},this.fromBufferGeometry(new BoxBufferGeometry(e,t,r,n,i,o)),this.mergeVertices()}function BoxBufferGeometry(e,t,r,n,i,o){BufferGeometry.call(this),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:i,depthSegments:o};var a=this;e=e||1,t=t||1,r=r||1,n=Math.floor(n)||1,i=Math.floor(i)||1,o=Math.floor(o)||1;var s=[],l=[],u=[],c=[],h=0,p=0;function f(e,t,r,n,i,o,f,d,m,v,g){var y,b,x=o/m,w=f/v,S=o/2,M=f/2,_=d/2,T=m+1,A=v+1,C=0,E=0,L=new Vector3;for(b=0;b<A;b++){var N=b*w-M;for(y=0;y<T;y++){var P=y*x-S;L[e]=P*n,L[t]=N*i,L[r]=_,l.push(L.x,L.y,L.z),L[e]=0,L[t]=0,L[r]=d>0?1:-1,u.push(L.x,L.y,L.z),c.push(y/m),c.push(1-b/v),C+=1}}for(b=0;b<v;b++)for(y=0;y<m;y++){var O=h+y+T*b,R=h+y+T*(b+1),D=h+(y+1)+T*(b+1),F=h+(y+1)+T*b;s.push(O,R,F),s.push(R,D,F),E+=6}a.addGroup(p,E,g),p+=E,h+=C}f("z","y","x",-1,-1,r,t,e,o,i,0),f("z","y","x",1,-1,r,t,-e,o,i,1),f("x","z","y",1,1,e,r,t,n,o,2),f("x","z","y",1,-1,e,r,-t,n,o,3),f("x","y","z",1,-1,e,t,r,n,i,4),f("x","y","z",-1,-1,e,t,-r,n,i,5),this.setIndex(s),this.addAttribute("position",new Float32BufferAttribute(l,3)),this.addAttribute("normal",new Float32BufferAttribute(u,3)),this.addAttribute("uv",new Float32BufferAttribute(c,2))}function CylinderGeometry(e,t,r,n,i,o,a,s){Geometry.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new CylinderBufferGeometry(e,t,r,n,i,o,a,s)),this.mergeVertices()}function CylinderBufferGeometry(e,t,r,n,i,o,a,s){BufferGeometry.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s};var l=this;e=void 0!==e?e:1,t=void 0!==t?t:1,r=r||1,n=Math.floor(n)||8,i=Math.floor(i)||1,o=void 0!==o&&o,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;var u=[],c=[],h=[],p=[],f=0,d=[],m=r/2,v=0;function g(r){var i,o,d,g=new Vector2,y=new Vector3,b=0,x=!0===r?e:t,w=!0===r?1:-1;for(o=f,i=1;i<=n;i++)c.push(0,m*w,0),h.push(0,w,0),p.push(.5,.5),f++;for(d=f,i=0;i<=n;i++){var S=i/n*s+a,M=Math.cos(S),_=Math.sin(S);y.x=x*_,y.y=m*w,y.z=x*M,c.push(y.x,y.y,y.z),h.push(0,w,0),g.x=.5*M+.5,g.y=.5*_*w+.5,p.push(g.x,g.y),f++}for(i=0;i<n;i++){var T=o+i,A=d+i;!0===r?u.push(A,A+1,T):u.push(A+1,A,T),b+=3}l.addGroup(v,b,!0===r?1:2),v+=b}!function(){var o,g,y=new Vector3,b=new Vector3,x=0,w=(t-e)/r;for(g=0;g<=i;g++){var S=[],M=g/i,_=M*(t-e)+e;for(o=0;o<=n;o++){var T=o/n,A=T*s+a,C=Math.sin(A),E=Math.cos(A);b.x=_*C,b.y=-M*r+m,b.z=_*E,c.push(b.x,b.y,b.z),y.set(C,w,E).normalize(),h.push(y.x,y.y,y.z),p.push(T,1-M),S.push(f++)}d.push(S)}for(o=0;o<n;o++)for(g=0;g<i;g++){var L=d[g][o],N=d[g+1][o],P=d[g+1][o+1],O=d[g][o+1];u.push(L,N,O),u.push(N,P,O),x+=6}l.addGroup(v,x,0),v+=x}(),!1===o&&(e>0&&g(!0),t>0&&g(!1)),this.setIndex(u),this.addAttribute("position",new Float32BufferAttribute(c,3)),this.addAttribute("normal",new Float32BufferAttribute(h,3)),this.addAttribute("uv",new Float32BufferAttribute(p,2))}CubicInterpolant.prototype=Object.assign(Object.create(Interpolant.prototype),{constructor:CubicInterpolant,DefaultSettings_:{endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding},intervalChanged_:function(e,t,r){var n=this.parameterPositions,i=e-2,o=e+1,a=n[i],s=n[o];if(void 0===a)switch(this.getSettings_().endingStart){case ZeroSlopeEnding:i=e,a=2*t-r;break;case WrapAroundEnding:a=t+n[i=n.length-2]-n[i+1];break;default:i=e,a=r}if(void 0===s)switch(this.getSettings_().endingEnd){case ZeroSlopeEnding:o=e,s=2*r-t;break;case WrapAroundEnding:o=1,s=r+n[1]-n[0];break;default:o=e-1,s=t}var l=.5*(r-t),u=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(s-r),this._offsetPrev=i*u,this._offsetNext=o*u},interpolate_:function(e,t,r,n){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,l=s-a,u=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,p=this._weightNext,f=(r-t)/(n-t),d=f*f,m=d*f,v=-h*m+2*h*d-h*f,g=(1+h)*m+(-1.5-2*h)*d+(-.5+h)*f+1,y=(-1-p)*m+(1.5+p)*d+.5*f,b=p*m-p*d,x=0;x!==a;++x)i[x]=v*o[u+x]+g*o[l+x]+y*o[s+x]+b*o[c+x];return i}}),DiscreteInterpolant.prototype=Object.assign(Object.create(Interpolant.prototype),{constructor:DiscreteInterpolant,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Object.assign(KeyframeTrack,{toJSON:function(e){var t,r=e.constructor;if(void 0!==r.toJSON)t=r.toJSON(e);else{t={name:e.name,times:AnimationUtils.convertArray(e.times,Array),values:AnimationUtils.convertArray(e.values,Array)};var n=e.getInterpolation();n!==e.DefaultInterpolation&&(t.interpolation=n)}return t.type=e.ValueTypeName,t}}),Object.assign(KeyframeTrack.prototype,{constructor:KeyframeTrack,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:InterpolateLinear,InterpolantFactoryMethodDiscrete:function(e){return new DiscreteInterpolant(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new LinearInterpolant(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new CubicInterpolant(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case InterpolateDiscrete:t=this.InterpolantFactoryMethodDiscrete;break;case InterpolateLinear:t=this.InterpolantFactoryMethodLinear;break;case InterpolateSmooth:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(r);this.setInterpolation(this.DefaultInterpolation)}return console.warn("KeyframeTrack:",r),this}return this.createInterpolant=t,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return InterpolateSmooth}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,r=0,n=t.length;r!==n;++r)t[r]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,r=0,n=t.length;r!==n;++r)t[r]*=e;return this},trim:function(e,t){for(var r=this.times,n=r.length,i=0,o=n-1;i!==n&&r[i]<e;)++i;for(;-1!==o&&r[o]>t;)--o;if(++o,0!==i||o!==n){i>=o&&(i=(o=Math.max(o,1))-1);var a=this.getValueSize();this.times=AnimationUtils.arraySlice(r,i,o),this.values=AnimationUtils.arraySlice(this.values,i*a,o*a)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("KeyframeTrack: Invalid value size in track.",this),e=!1);var r=this.times,n=this.values,i=r.length;0===i&&(console.error("KeyframeTrack: Track is empty.",this),e=!1);for(var o=null,a=0;a!==i;a++){var s=r[a];if("number"===typeof s&&isNaN(s)){console.error("KeyframeTrack: Time is not a valid number.",this,a,s),e=!1;break}if(null!==o&&o>s){console.error("KeyframeTrack: Out of order keys.",this,a,s,o),e=!1;break}o=s}if(void 0!==n&&AnimationUtils.isTypedArray(n)){a=0;for(var l=n.length;a!==l;++a){var u=n[a];if(isNaN(u)){console.error("KeyframeTrack: Value is not a valid number.",this,a,u),e=!1;break}}}return e},optimize:function(){for(var e=this.times,t=this.values,r=this.getValueSize(),n=this.getInterpolation()===InterpolateSmooth,i=1,o=e.length-1,a=1;a<o;++a){var s=!1,l=e[a];if(l!==e[a+1]&&(1!==a||l!==l[0]))if(n)s=!0;else for(var u=a*r,c=u-r,h=u+r,p=0;p!==r;++p){var f=t[u+p];if(f!==t[c+p]||f!==t[h+p]){s=!0;break}}if(s){if(a!==i){e[i]=e[a];var d=a*r,m=i*r;for(p=0;p!==r;++p)t[m+p]=t[d+p]}++i}}if(o>0){e[i]=e[o];for(d=o*r,m=i*r,p=0;p!==r;++p)t[m+p]=t[d+p];++i}return i!==e.length&&(this.times=AnimationUtils.arraySlice(e,0,i),this.values=AnimationUtils.arraySlice(t,0,i*r)),this},clone:function(){var e=AnimationUtils.arraySlice(this.times,0),t=AnimationUtils.arraySlice(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}),BooleanKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:BooleanKeyframeTrack,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:InterpolateDiscrete,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),ColorKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:ColorKeyframeTrack,ValueTypeName:"color"}),NumberKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:NumberKeyframeTrack,ValueTypeName:"number"}),QuaternionLinearInterpolant.prototype=Object.assign(Object.create(Interpolant.prototype),{constructor:QuaternionLinearInterpolant,interpolate_:function(e,t,r,n){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,l=(r-t)/(n-t),u=s+a;s!==u;s+=4)Quaternion.slerpFlat(i,0,o,s-a,o,s,l);return i}}),QuaternionKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:QuaternionKeyframeTrack,ValueTypeName:"quaternion",DefaultInterpolation:InterpolateLinear,InterpolantFactoryMethodLinear:function(e){return new QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),StringKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:StringKeyframeTrack,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:InterpolateDiscrete,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),VectorKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:VectorKeyframeTrack,ValueTypeName:"vector"}),Object.assign(AnimationClip,{parse:function(e){for(var t=[],r=e.tracks,n=1/(e.fps||1),i=0,o=r.length;i!==o;++i)t.push(parseKeyframeTrack(r[i]).scale(n));return new AnimationClip(e.name,e.duration,t)},toJSON:function(e){for(var t=[],r=e.tracks,n={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid},i=0,o=r.length;i!==o;++i)t.push(KeyframeTrack.toJSON(r[i]));return n},CreateFromMorphTargetSequence:function(e,t,r,n){for(var i=t.length,o=[],a=0;a<i;a++){var s=[],l=[];s.push((a+i-1)%i,a,(a+1)%i),l.push(0,1,0);var u=AnimationUtils.getKeyframeOrder(s);s=AnimationUtils.sortedArray(s,1,u),l=AnimationUtils.sortedArray(l,1,u),n||0!==s[0]||(s.push(i),l.push(l[0])),o.push(new NumberKeyframeTrack(".morphTargetInfluences["+t[a].name+"]",s,l).scale(1/r))}return new AnimationClip(e,-1,o)},findByName:function(e,t){var r=e;if(!Array.isArray(e)){var n=e;r=n.geometry&&n.geometry.animations||n.animations}for(var i=0;i<r.length;i++)if(r[i].name===t)return r[i];return null},CreateClipsFromMorphTargetSequences:function(e,t,r){for(var n={},i=/^([\w-]*?)([\d]+)$/,o=0,a=e.length;o<a;o++){var s=e[o],l=s.name.match(i);if(l&&l.length>1){var u=n[h=l[1]];u||(n[h]=u=[]),u.push(s)}}var c=[];for(var h in n)c.push(AnimationClip.CreateFromMorphTargetSequence(h,n[h],t,r));return c},parseAnimation:function(e,t){if(!e)return console.error("AnimationClip: No animation in JSONLoader data."),null;for(var r=function(e,t,r,n,i){if(0!==r.length){var o=[],a=[];AnimationUtils.flattenJSON(r,o,a,n),0!==o.length&&i.push(new e(t,o,a))}},n=[],i=e.name||"default",o=e.length||-1,a=e.fps||30,s=e.hierarchy||[],l=0;l<s.length;l++){var u=s[l].keys;if(u&&0!==u.length)if(u[0].morphTargets){for(var c={},h=0;h<u.length;h++)if(u[h].morphTargets)for(var p=0;p<u[h].morphTargets.length;p++)c[u[h].morphTargets[p]]=-1;for(var f in c){var d=[],m=[];for(p=0;p!==u[h].morphTargets.length;++p){var v=u[h];d.push(v.time),m.push(v.morphTarget===f?1:0)}n.push(new NumberKeyframeTrack(".morphTargetInfluence["+f+"]",d,m))}o=c.length*(a||1)}else{var g=".bones["+t[l].name+"]";r(VectorKeyframeTrack,g+".position",u,"pos",n),r(QuaternionKeyframeTrack,g+".quaternion",u,"rot",n),r(VectorKeyframeTrack,g+".scale",u,"scl",n)}}return 0===n.length?null:new AnimationClip(i,o,n)}}),Object.assign(AnimationClip.prototype,{resetDuration:function(){for(var e=0,t=0,r=this.tracks.length;t!==r;++t){var n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}return this.duration=e,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new AnimationClip(this.name,this.duration,e)}}),AnimationMixer.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:AnimationMixer,_bindAction:function(e,t){var r=e._localRoot||this._root,n=e._clip.tracks,i=n.length,o=e._propertyBindings,a=e._interpolants,s=r.uuid,l=this._bindingsByRootAndName,u=l[s];void 0===u&&(u={},l[s]=u);for(var c=0;c!==i;++c){var h=n[c],p=h.name,f=u[p];if(void 0!==f)o[c]=f;else{if(void 0!==(f=o[c])){null===f._cacheIndex&&(++f.referenceCount,this._addInactiveBinding(f,s,p));continue}var d=t&&t._propertyBindings[c].binding.parsedPath;++(f=new PropertyMixer(PropertyBinding.create(r,p,d),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(f,s,p),o[c]=f}a[c].resultBuffer=f.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,r=e._clip.uuid,n=this._actionsByClip[r];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,r,t)}for(var i=e._propertyBindings,o=0,a=i.length;o!==a;++o){var s=i[o];0===s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,r=0,n=t.length;r!==n;++r){var i=t[r];0===--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,r){var n=this._actions,i=this._actionsByClip,o=i[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=o;else{var a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=n.length,n.push(e),o.actionByRoot[r]=e},_removeInactiveAction:function(e){var t=this._actions,r=t[t.length-1],n=e._cacheIndex;r._cacheIndex=n,t[n]=r,t.pop(),e._cacheIndex=null;var i=e._clip.uuid,o=this._actionsByClip,a=o[i],s=a.knownActions,l=s[s.length-1],u=e._byClipCacheIndex;l._byClipCacheIndex=u,s[u]=l,s.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete o[i],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,r=0,n=t.length;r!==n;++r){var i=t[r];0===--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(e){var t=this._actions,r=e._cacheIndex,n=this._nActiveActions++,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i},_takeBackAction:function(e){var t=this._actions,r=e._cacheIndex,n=--this._nActiveActions,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i},_addInactiveBinding:function(e,t,r){var n=this._bindingsByRootAndName,i=n[t],o=this._bindings;void 0===i&&(i={},n[t]=i),i[r]=e,e._cacheIndex=o.length,o.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,r=e.binding,n=r.rootNode.uuid,i=r.path,o=this._bindingsByRootAndName,a=o[n],s=t[t.length-1],l=e._cacheIndex;s._cacheIndex=l,t[l]=s,t.pop(),delete a[i];e:{for(var u in a)break e;delete o[n]}},_lendBinding:function(e){var t=this._bindings,r=e._cacheIndex,n=this._nActiveBindings++,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i},_takeBackBinding:function(e){var t=this._bindings,r=e._cacheIndex,n=--this._nActiveBindings,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,r=e[t];return void 0===r&&((r=new LinearInterpolant(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=r),r},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,r=e.__cacheIndex,n=--this._nActiveControlInterpolants,i=t[n];e.__cacheIndex=n,t[n]=e,i.__cacheIndex=r,t[r]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var r=t||this._root,n=r.uuid,i="string"===typeof e?AnimationClip.findByName(r,e):e,o=null!==i?i.uuid:e,a=this._actionsByClip[o],s=null;if(void 0!==a){var l=a.actionByRoot[n];if(void 0!==l)return l;s=a.knownActions[0],null===i&&(i=s._clip)}if(null===i)return null;var u=new AnimationAction(this,i,t);return this._bindAction(u,s),this._addInactiveAction(u,o,n),u},existingAction:function(e,t){var r=t||this._root,n=r.uuid,i="string"===typeof e?AnimationClip.findByName(r,e):e,o=i?i.uuid:e,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[n]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,r=this._bindings,n=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==t;++i)e[i].reset();for(i=0;i!==n;++i)r[i].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,r=this._nActiveActions,n=this.time+=e,i=Math.sign(e),o=this._accuIndex^=1,a=0;a!==r;++a){t[a]._update(n,e,i,o)}var s=this._bindings,l=this._nActiveBindings;for(a=0;a!==l;++a)s[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,r=e.uuid,n=this._actionsByClip,i=n[r];if(void 0!==i){for(var o=i.knownActions,a=0,s=o.length;a!==s;++a){var l=o[a];this._deactivateAction(l);var u=l._cacheIndex,c=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,c._cacheIndex=u,t[u]=c,t.pop(),this._removeInactiveBindingsForAction(l)}delete n[r]}},uncacheRoot:function(e){var t=e.uuid,r=this._actionsByClip;for(var n in r){var i=r[n].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var o=this._bindingsByRootAndName[t];if(void 0!==o)for(var a in o){var s=o[a];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(e,t){var r=this.existingAction(e,t);null!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}}),Bone.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Bone,isBone:!0}),BoxGeometry.prototype=Object.create(Geometry.prototype),BoxGeometry.prototype.constructor=BoxGeometry,BoxBufferGeometry.prototype=Object.create(BufferGeometry.prototype),BoxBufferGeometry.prototype.constructor=BoxBufferGeometry,CylinderGeometry.prototype=Object.create(Geometry.prototype),CylinderGeometry.prototype.constructor=CylinderGeometry,CylinderBufferGeometry.prototype=Object.create(BufferGeometry.prototype),CylinderBufferGeometry.prototype.constructor=CylinderBufferGeometry;var MMDPhysics=function(){function e(e,r,n,i){if("undefined"===typeof Ammo)throw new Error("MMDPhysics: Import ammo.js https://github.com/kripken/ammo.js");n=n||[],i=i||{},this.manager=new t,this.mesh=e,this.unitStep=void 0!==i.unitStep?i.unitStep:1/65,this.maxStepNum=void 0!==i.maxStepNum?i.maxStepNum:3,this.gravity=new Vector3(0,-98,0),void 0!==i.gravity&&this.gravity.copy(i.gravity),this.world=void 0!==i.world?i.world:null,this.bodies=[],this.constraints=[],this._init(e,r,n)}function t(){this.threeVector3s=[],this.threeMatrix4s=[],this.threeQuaternions=[],this.threeEulers=[],this.transforms=[],this.quaternions=[],this.vector3s=[]}function r(e,t,r,n){this.mesh=e,this.world=t,this.params=r,this.manager=n,this.body=null,this.bone=null,this.boneOffsetForm=null,this.boneOffsetFormInverse=null,this._init()}function n(e,t,r,n,i,o){this.mesh=e,this.world=t,this.bodyA=r,this.bodyB=n,this.params=i,this.manager=o,this.constraint=null,this._init()}function i(e,t){Object3D.call(this),this.root=e,this.physics=t,this.matrix.copy(e.matrixWorld),this.matrixAutoUpdate=!1,this.materials=[],this.materials.push(new MeshBasicMaterial({color:new Color(16746632),wireframe:!0,depthTest:!1,depthWrite:!1,opacity:.25,transparent:!0})),this.materials.push(new MeshBasicMaterial({color:new Color(8978312),wireframe:!0,depthTest:!1,depthWrite:!1,opacity:.25,transparent:!0})),this.materials.push(new MeshBasicMaterial({color:new Color(8947967),wireframe:!0,depthTest:!1,depthWrite:!1,opacity:.25,transparent:!0})),this._init()}return e.prototype={constructor:e,update:function(e){var t,r=this.manager,n=this.mesh,i=!1,o=r.allocThreeVector3(),a=r.allocThreeQuaternion(),s=r.allocThreeVector3();return n.matrixWorld.decompose(o,a,s),1===s.x&&1===s.y&&1===s.z||(i=!0),i&&(null!==(t=n.parent)&&(n.parent=null),s.copy(this.mesh.scale),n.scale.set(1,1,1),n.updateMatrixWorld(!0)),this._updateRigidBodies(),this._stepSimulation(e),this._updateBones(),i&&(null!==t&&(n.parent=t),n.scale.copy(s)),r.freeThreeVector3(s),r.freeThreeQuaternion(a),r.freeThreeVector3(o),this},reset:function(){for(var e=0,t=this.bodies.length;e<t;e++)this.bodies[e].reset();return this},warmup:function(e){for(var t=0;t<e;t++)this.update(1/60);return this},setGravity:function(e){return this.world.setGravity(new Ammo.btVector3(e.x,e.y,e.z)),this.gravity.copy(e),this},createHelper:function(){return new i(this.mesh,this)},_init:function(e,t,r){var n=this.manager,i=e.parent;null!==i&&(i=null);var o=n.allocThreeVector3(),a=n.allocThreeQuaternion(),s=n.allocThreeVector3();o.copy(e.position),a.copy(e.quaternion),s.copy(e.scale),e.position.set(0,0,0),e.quaternion.set(0,0,0,1),e.scale.set(1,1,1),e.updateMatrixWorld(!0),null===this.world&&(this.world=this._createWorld(),this.setGravity(this.gravity)),this._initRigidBodies(t),this._initConstraints(r),null!==i&&(e.parent=i),e.position.copy(o),e.quaternion.copy(a),e.scale.copy(s),e.updateMatrixWorld(!0),this.reset(),n.freeThreeVector3(o),n.freeThreeQuaternion(a),n.freeThreeVector3(s)},_createWorld:function(){var e=new Ammo.btDefaultCollisionConfiguration,t=new Ammo.btCollisionDispatcher(e),r=new Ammo.btDbvtBroadphase,n=new Ammo.btSequentialImpulseConstraintSolver;return new Ammo.btDiscreteDynamicsWorld(t,r,n,e)},_initRigidBodies:function(e){for(var t=0,n=e.length;t<n;t++)this.bodies.push(new r(this.mesh,this.world,e[t],this.manager))},_initConstraints:function(e){for(var t=0,r=e.length;t<r;t++){var i=e[t],o=this.bodies[i.rigidBodyIndex1],a=this.bodies[i.rigidBodyIndex2];this.constraints.push(new n(this.mesh,this.world,o,a,i,this.manager))}},_stepSimulation:function(e){var t=this.unitStep,r=e,n=1+(e/t|0);r<t&&(r=t,n=1),n>this.maxStepNum&&(n=this.maxStepNum),this.world.stepSimulation(r,n,t)},_updateRigidBodies:function(){for(var e=0,t=this.bodies.length;e<t;e++)this.bodies[e].updateFromBone()},_updateBones:function(){for(var e=0,t=this.bodies.length;e<t;e++)this.bodies[e].updateBone()}},t.prototype={constructor:t,allocThreeVector3:function(){return this.threeVector3s.length>0?this.threeVector3s.pop():new Vector3},freeThreeVector3:function(e){this.threeVector3s.push(e)},allocThreeMatrix4:function(){return this.threeMatrix4s.length>0?this.threeMatrix4s.pop():new Matrix4},freeThreeMatrix4:function(e){this.threeMatrix4s.push(e)},allocThreeQuaternion:function(){return this.threeQuaternions.length>0?this.threeQuaternions.pop():new Quaternion},freeThreeQuaternion:function(e){this.threeQuaternions.push(e)},allocThreeEuler:function(){return this.threeEulers.length>0?this.threeEulers.pop():new Euler},freeThreeEuler:function(e){this.threeEulers.push(e)},allocTransform:function(){return this.transforms.length>0?this.transforms.pop():new Ammo.btTransform},freeTransform:function(e){this.transforms.push(e)},allocQuaternion:function(){return this.quaternions.length>0?this.quaternions.pop():new Ammo.btQuaternion},freeQuaternion:function(e){this.quaternions.push(e)},allocVector3:function(){return this.vector3s.length>0?this.vector3s.pop():new Ammo.btVector3},freeVector3:function(e){this.vector3s.push(e)},setIdentity:function(e){e.setIdentity()},getBasis:function(e){var t=this.allocQuaternion();return e.getBasis().getRotation(t),t},getBasisAsMatrix3:function(e){var t=this.getBasis(e),r=this.quaternionToMatrix3(t);return this.freeQuaternion(t),r},getOrigin:function(e){return e.getOrigin()},setOrigin:function(e,t){e.getOrigin().setValue(t.x(),t.y(),t.z())},copyOrigin:function(e,t){var r=t.getOrigin();this.setOrigin(e,r)},setBasis:function(e,t){e.setRotation(t)},setBasisFromMatrix3:function(e,t){var r=this.matrix3ToQuaternion(t);this.setBasis(e,r),this.freeQuaternion(r)},setOriginFromArray3:function(e,t){e.getOrigin().setValue(t[0],t[1],t[2])},setOriginFromThreeVector3:function(e,t){e.getOrigin().setValue(t.x,t.y,t.z)},setBasisFromArray3:function(e,t){var r=this.allocThreeQuaternion(),n=this.allocThreeEuler();n.set(t[0],t[1],t[2]),this.setBasisFromThreeQuaternion(e,r.setFromEuler(n)),this.freeThreeEuler(n),this.freeThreeQuaternion(r)},setBasisFromThreeQuaternion:function(e,t){var r=this.allocQuaternion();r.setX(t.x),r.setY(t.y),r.setZ(t.z),r.setW(t.w),this.setBasis(e,r),this.freeQuaternion(r)},multiplyTransforms:function(e,t){var r=this.allocTransform();this.setIdentity(r);var n=this.getBasisAsMatrix3(e),i=this.getBasisAsMatrix3(t),o=this.getOrigin(e),a=this.getOrigin(t),s=this.multiplyMatrix3ByVector3(n,a),l=this.addVector3(s,o);this.setOrigin(r,l);var u=this.multiplyMatrices3(n,i);return this.setBasisFromMatrix3(r,u),this.freeVector3(s),this.freeVector3(l),r},inverseTransform:function(e){var t=this.allocTransform(),r=this.getBasisAsMatrix3(e),n=this.getOrigin(e),i=this.transposeMatrix3(r),o=this.negativeVector3(n),a=this.multiplyMatrix3ByVector3(i,o);return this.setOrigin(t,a),this.setBasisFromMatrix3(t,i),this.freeVector3(o),this.freeVector3(a),t},multiplyMatrices3:function(e,t){var r=[],n=this.rowOfMatrix3(e,0),i=this.rowOfMatrix3(e,1),o=this.rowOfMatrix3(e,2),a=this.columnOfMatrix3(t,0),s=this.columnOfMatrix3(t,1),l=this.columnOfMatrix3(t,2);return r[0]=this.dotVectors3(n,a),r[1]=this.dotVectors3(n,s),r[2]=this.dotVectors3(n,l),r[3]=this.dotVectors3(i,a),r[4]=this.dotVectors3(i,s),r[5]=this.dotVectors3(i,l),r[6]=this.dotVectors3(o,a),r[7]=this.dotVectors3(o,s),r[8]=this.dotVectors3(o,l),this.freeVector3(n),this.freeVector3(i),this.freeVector3(o),this.freeVector3(a),this.freeVector3(s),this.freeVector3(l),r},addVector3:function(e,t){var r=this.allocVector3();return r.setValue(e.x()+t.x(),e.y()+t.y(),e.z()+t.z()),r},dotVectors3:function(e,t){return e.x()*t.x()+e.y()*t.y()+e.z()*t.z()},rowOfMatrix3:function(e,t){var r=this.allocVector3();return r.setValue(e[3*t+0],e[3*t+1],e[3*t+2]),r},columnOfMatrix3:function(e,t){var r=this.allocVector3();return r.setValue(e[t+0],e[t+3],e[t+6]),r},negativeVector3:function(e){var t=this.allocVector3();return t.setValue(-e.x(),-e.y(),-e.z()),t},multiplyMatrix3ByVector3:function(e,t){var r=this.allocVector3(),n=this.rowOfMatrix3(e,0),i=this.rowOfMatrix3(e,1),o=this.rowOfMatrix3(e,2),a=this.dotVectors3(n,t),s=this.dotVectors3(i,t),l=this.dotVectors3(o,t);return r.setValue(a,s,l),this.freeVector3(n),this.freeVector3(i),this.freeVector3(o),r},transposeMatrix3:function(e){var t=[];return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t},quaternionToMatrix3:function(e){var t=[],r=e.x(),n=e.y(),i=e.z(),o=e.w(),a=r*r,s=n*n,l=i*i,u=r*n,c=n*i,h=i*r,p=r*o,f=n*o,d=i*o;return t[0]=1-2*(s+l),t[1]=2*(u-d),t[2]=2*(h+f),t[3]=2*(u+d),t[4]=1-2*(l+a),t[5]=2*(c-p),t[6]=2*(h-f),t[7]=2*(c+p),t[8]=1-2*(a+s),t},matrix3ToQuaternion:function(e){var t,r,n,i,o,a=e[0]+e[4]+e[8];a>0?(o=.25*(t=2*Math.sqrt(a+1)),r=(e[7]-e[5])/t,n=(e[2]-e[6])/t,i=(e[3]-e[1])/t):e[0]>e[4]&&e[0]>e[8]?(t=2*Math.sqrt(1+e[0]-e[4]-e[8]),o=(e[7]-e[5])/t,r=.25*t,n=(e[1]+e[3])/t,i=(e[2]+e[6])/t):e[4]>e[8]?(t=2*Math.sqrt(1+e[4]-e[0]-e[8]),o=(e[2]-e[6])/t,r=(e[1]+e[3])/t,n=.25*t,i=(e[5]+e[7])/t):(t=2*Math.sqrt(1+e[8]-e[0]-e[4]),o=(e[3]-e[1])/t,r=(e[2]+e[6])/t,n=(e[5]+e[7])/t,i=.25*t);var s=this.allocQuaternion();return s.setX(r),s.setY(n),s.setZ(i),s.setW(o),s}},r.prototype={constructor:e.RigidBody,reset:function(){return this._setTransformFromBone(),this},updateFromBone:function(){return-1!==this.params.boneIndex&&0===this.params.type&&this._setTransformFromBone(),this},updateBone:function(){return 0===this.params.type||-1===this.params.boneIndex?this:(this._updateBoneRotation(),1===this.params.type&&this._updateBonePosition(),this.bone.updateMatrixWorld(!0),2===this.params.type&&this._setPositionFromBone(),this)},_init:function(){var e=this.manager,t=this.params,r=this.mesh.skeleton.bones,n=-1===t.boneIndex?new Bone:r[t.boneIndex],i=function(e){switch(e.shapeType){case 0:return new Ammo.btSphereShape(e.width);case 1:return new Ammo.btBoxShape(new Ammo.btVector3(e.width,e.height,e.depth));case 2:return new Ammo.btCapsuleShape(e.width,e.height);default:throw"unknown shape type "+e.shapeType}}(t),o=0===t.type?0:t.weight,a=e.allocVector3();a.setValue(0,0,0),0!==o&&i.calculateLocalInertia(o,a);var s=e.allocTransform();e.setIdentity(s),e.setOriginFromArray3(s,t.position),e.setBasisFromArray3(s,t.rotation);var l=e.allocThreeVector3(),u=e.allocTransform();e.setIdentity(u),e.setOriginFromThreeVector3(u,n.getWorldPosition(l));var c=e.multiplyTransforms(u,s),h=new Ammo.btDefaultMotionState(c),p=new Ammo.btRigidBodyConstructionInfo(o,h,i,a);p.set_m_friction(t.friction),p.set_m_restitution(t.restitution);var f=new Ammo.btRigidBody(p);0===t.type&&(f.setCollisionFlags(2|f.getCollisionFlags()),f.setActivationState(4)),f.setDamping(t.positionDamping,t.rotationDamping),f.setSleepingThresholds(0,0),this.world.addRigidBody(f,1<<t.groupIndex,t.groupTarget),this.body=f,this.bone=n,this.boneOffsetForm=s,this.boneOffsetFormInverse=e.inverseTransform(s),e.freeVector3(a),e.freeTransform(c),e.freeTransform(u),e.freeThreeVector3(l)},_getBoneTransform:function(){var e=this.manager,t=e.allocThreeVector3(),r=e.allocThreeQuaternion(),n=e.allocThreeVector3();this.bone.matrixWorld.decompose(t,r,n);var i=e.allocTransform();e.setOriginFromThreeVector3(i,t),e.setBasisFromThreeQuaternion(i,r);var o=e.multiplyTransforms(i,this.boneOffsetForm);return e.freeTransform(i),e.freeThreeVector3(n),e.freeThreeQuaternion(r),e.freeThreeVector3(t),o},_getWorldTransformForBone:function(){var e=this.manager,t=e.allocTransform();this.body.getMotionState().getWorldTransform(t);var r=e.multiplyTransforms(t,this.boneOffsetFormInverse);return e.freeTransform(t),r},_setTransformFromBone:function(){var e=this.manager,t=this._getBoneTransform();this.body.setCenterOfMassTransform(t),this.body.getMotionState().setWorldTransform(t),e.freeTransform(t)},_setPositionFromBone:function(){var e=this.manager,t=this._getBoneTransform(),r=e.allocTransform();this.body.getMotionState().getWorldTransform(r),e.copyOrigin(r,t),this.body.setCenterOfMassTransform(r),this.body.getMotionState().setWorldTransform(r),e.freeTransform(r),e.freeTransform(t)},_updateBoneRotation:function(){var e=this.manager,t=this._getWorldTransformForBone(),r=e.getBasis(t),n=e.allocThreeQuaternion(),i=e.allocThreeQuaternion(),o=e.allocThreeQuaternion();n.set(r.x(),r.y(),r.z(),r.w()),i.setFromRotationMatrix(this.bone.matrixWorld),i.conjugate(),i.multiply(n),o.setFromRotationMatrix(this.bone.matrix),this.bone.quaternion.copy(i.multiply(o)),e.freeThreeQuaternion(n),e.freeThreeQuaternion(i),e.freeThreeQuaternion(o),e.freeQuaternion(r),e.freeTransform(t)},_updateBonePosition:function(){var e=this.manager,t=this.body.getCenterOfMassTransform().getOrigin(),r=e.allocThreeMatrix4();r.copy(this.bone.parent.matrixWorld).getInverse(r);var n=e.allocThreeVector3();n.set(t.x(),t.y(),t.z()).applyMatrix4(r),this.bone.position.copy(n),e.freeThreeVector3(n),e.freeThreeMatrix4(r)}},n.prototype={constructor:n,_init:function(){var e=this.manager,t=this.params,r=this.bodyA,n=this.bodyB,i=e.allocTransform();e.setIdentity(i),e.setOriginFromArray3(i,t.position),e.setBasisFromArray3(i,t.rotation);var o=e.allocTransform(),a=e.allocTransform();r.body.getMotionState().getWorldTransform(o),n.body.getMotionState().getWorldTransform(a);var s=e.inverseTransform(o),l=e.inverseTransform(a),u=e.multiplyTransforms(s,i),c=e.multiplyTransforms(l,i),h=new Ammo.btGeneric6DofSpringConstraint(r.body,n.body,u,c,!0),p=e.allocVector3(),f=e.allocVector3(),d=e.allocVector3(),m=e.allocVector3();p.setValue(t.translationLimitation1[0],t.translationLimitation1[1],t.translationLimitation1[2]),f.setValue(t.translationLimitation2[0],t.translationLimitation2[1],t.translationLimitation2[2]),d.setValue(t.rotationLimitation1[0],t.rotationLimitation1[1],t.rotationLimitation1[2]),m.setValue(t.rotationLimitation2[0],t.rotationLimitation2[1],t.rotationLimitation2[2]),h.setLinearLowerLimit(p),h.setLinearUpperLimit(f),h.setAngularLowerLimit(d),h.setAngularUpperLimit(m);for(var v=0;v<3;v++)0!==t.springPosition[v]&&(h.enableSpring(v,!0),h.setStiffness(v,t.springPosition[v]));for(v=0;v<3;v++)0!==t.springRotation[v]&&(h.enableSpring(v+3,!0),h.setStiffness(v+3,t.springRotation[v]));if(void 0!==h.setParam)for(v=0;v<6;v++)h.setParam(2,.475,v);this.world.addConstraint(h,!0),this.constraint=h,e.freeTransform(i),e.freeTransform(o),e.freeTransform(a),e.freeTransform(s),e.freeTransform(l),e.freeTransform(u),e.freeTransform(c),e.freeVector3(p),e.freeVector3(f),e.freeVector3(d),e.freeVector3(m)}},i.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:i,updateMatrixWorld:function(){var e=new Vector3,t=new Quaternion,r=new Vector3,n=new Matrix4;return function(i){var o=this.root;if(this.visible){var a=this.physics.bodies;n.copy(o.matrixWorld).decompose(e,t,r).compose(e,t,r.set(1,1,1)).getInverse(n);for(var s=0,l=a.length;s<l;s++){var u=a[s].body,c=this.children[s],h=u.getCenterOfMassTransform(),p=h.getOrigin(),f=h.getRotation();c.position.set(p.x(),p.y(),p.z()).applyMatrix4(n),c.quaternion.setFromRotationMatrix(n).multiply(t.set(f.x(),f.y(),f.z(),f.w()))}}this.matrix.copy(o.matrixWorld).decompose(e,t,r).compose(e,t,r.set(1,1,1)),Object3D.prototype.updateMatrixWorld.call(this,i)}}(),_init:function(){var e=this.physics.bodies;function t(e){switch(e.shapeType){case 0:return new SphereBufferGeometry(e.width,16,8);case 1:return new BoxBufferGeometry(2*e.width,2*e.height,2*e.depth,8,8,8);case 2:return new r(e.width,e.height,16,8);default:return null}}function r(e,t,r,n){var i=new CylinderBufferGeometry(e,e,t,r,n,!0),o=new Mesh(new SphereBufferGeometry(e,r,n,0,2*Math.PI,0,Math.PI/2)),a=new Mesh(new SphereBufferGeometry(e,r,n,0,2*Math.PI,Math.PI/2,Math.PI/2));return o.position.set(0,t/2,0),a.position.set(0,-t/2,0),o.updateMatrix(),a.updateMatrix(),i.merge(o.geometry,o.matrix),i.merge(a.geometry,a.matrix),i}for(var n=0,i=e.length;n<i;n++){var o=e[n].params;this.add(new Mesh(t(o),this.materials[o.type]))}}}),e}(),MMDAnimationHelper=function(){function e(e){e=e||{},this.meshes=[],this.camera=null,this.cameraTarget=new Object3D,this.cameraTarget.name="target",this.audio=null,this.audioManager=null,this.objects=new WeakMap,this.configuration={sync:void 0===e.sync||e.sync,afterglow:void 0!==e.afterglow?e.afterglow:0,resetPhysicsOnLoop:void 0===e.resetPhysicsOnLoop||e.resetPhysicsOnLoop},this.enabled={animation:!0,ik:!0,grant:!0,physics:!0,cameraAnimation:!0},this.onBeforePhysics=function(e){},this.sharedPhysics=!1,this.masterPhysics=null}function t(e,t){t=t||{},this.audio=e,this.elapsedTime=0,this.currentTime=0,this.delayTime=void 0!==t.delayTime?t.delayTime:0,this.audioDuration=this.audio.buffer.duration,this.duration=this.audioDuration+this.delayTime}function r(e,t){this.mesh=e,this.grants=t||[]}return e.prototype={constructor:e,add:function(e,t){if(t=t||{},e.isSkinnedMesh)this._addMesh(e,t);else if(e.isCamera)this._setupCamera(e,t);else{if("Audio"!==e.type)throw new Error("MMDAnimationHelper.add: accepts only SkinnedMesh or Camera or Audio instance.");this._setupAudio(e,t)}return this.configuration.sync&&this._syncDuration(),this},remove:function(e){if(e.isSkinnedMesh)this._removeMesh(e);else if(e.isCamera)this._clearCamera(e);else{if("Audio"!==e.type)throw new Error("MMDAnimationHelper.remove: accepts only SkinnedMesh or Camera or Audio instance.");this._clearAudio(e)}return this.configuration.sync&&this._syncDuration(),this},update:function(e){null!==this.audioManager&&this.audioManager.control(e);for(var t=0;t<this.meshes.length;t++)this._animateMesh(this.meshes[t],e);return this.sharedPhysics&&this._updateSharedPhysics(e),null!==this.camera&&this._animateCamera(this.camera,e),this},pose:function(e,t,r){!1!==(r=r||{}).resetPose&&e.pose();for(var n=e.skeleton.bones,i=t.bones,o={},a=0,s=n.length;a<s;a++)o[n[a].name]=a;var l=new Vector3,u=new Quaternion;for(a=0,s=i.length;a<s;a++){var c=i[a],h=o[c.name];if(void 0!==h){var p=n[h];p.position.add(l.fromArray(c.translation)),p.quaternion.multiply(u.fromArray(c.quaternion))}}return e.updateMatrixWorld(!0),!1!==r.ik&&this._createCCDIKSolver(e).update(r.saveOriginalBonesBeforeIK),!1!==r.grant&&this.createGrantSolver(e).update(),this},enable:function(e,t){if(void 0===this.enabled[e])throw new Error("MMDAnimationHelper.enable: unknown key "+e);if(this.enabled[e]=t,"physics"===e)for(var r=0,n=this.meshes.length;r<n;r++)this._optimizeIK(this.meshes[r],t);return this},createGrantSolver:function(e){return new r(e,e.geometry.userData.MMD.grants)},_addMesh:function(e,t){if(this.meshes.indexOf(e)>=0)throw new Error("MMDAnimationHelper._addMesh: SkinnedMesh '"+e.name+"' has already been added.");return this.meshes.push(e),this.objects.set(e,{looped:!1}),this._setupMeshAnimation(e,t.animation),!1!==t.physics&&this._setupMeshPhysics(e,t),this},_setupCamera:function(e,t){if(this.camera===e)throw new Error("MMDAnimationHelper._setupCamera: Camera '"+e.name+"' has already been set.");return this.camera&&this.clearCamera(this.camera),this.camera=e,e.add(this.cameraTarget),this.objects.set(e,{}),void 0!==t.animation&&this._setupCameraAnimation(e,t.animation),this},_setupAudio:function(e,r){if(this.audio===e)throw new Error("MMDAnimationHelper._setupAudio: Audio '"+e.name+"' has already been set.");return this.audio&&this.clearAudio(this.audio),this.audio=e,this.audioManager=new t(e,r),this.objects.set(this.audioManager,{duration:this.audioManager.duration}),this},_removeMesh:function(e){for(var t=!1,r=0,n=0,i=this.meshes.length;n<i;n++)this.meshes[n]!==e?this.meshes[r++]=this.meshes[n]:(this.objects.delete(e),t=!0);if(!t)throw new Error("MMDAnimationHelper._removeMesh: SkinnedMesh '"+e.name+"' has not been added yet.");return this.meshes.length=r,this},_clearCamera:function(e){if(e!==this.camera)throw new Error("MMDAnimationHelper._clearCamera: Camera '"+e.name+"' has not been set yet.");return this.camera.remove(this.cameraTarget),this.objects.delete(this.camera),this.camera=null,this},_clearAudio:function(e){if(e!==this.audio)throw new Error("MMDAnimationHelper._clearAudio: Audio '"+e.name+"' has not been set yet.");return this.objects.delete(this.audioManager),this.audio=null,this.audioManager=null,this},_setupMeshAnimation:function(e,t){var r=this.objects.get(e);if(void 0!==t){var n=Array.isArray(t)?t:[t];r.mixer=new AnimationMixer(e);for(var i=0,o=n.length;i<o;i++)r.mixer.clipAction(n[i]).play();r.mixer.addEventListener("loop",function(e){var t=e.action._clip.tracks;t.length>0&&".bones"!==t[0].name.slice(0,6)||(r.looped=!0)})}return r.ikSolver=this._createCCDIKSolver(e),r.grantSolver=this.createGrantSolver(e),this},_setupCameraAnimation:function(e,t){var r=Array.isArray(t)?t:[t],n=this.objects.get(e);n.mixer=new AnimationMixer(e);for(var i=0,o=r.length;i<o;i++)n.mixer.clipAction(r[i]).play()},_setupMeshPhysics:function(e,t){var r=this.objects.get(e);if(void 0===t.world&&this.sharedPhysics){var n=this._getMasterPhysics();null!==n&&(world=n.world)}r.physics=this._createMMDPhysics(e,t),r.mixer&&!1!==t.animationWarmup&&(this._animateMesh(e,0),r.physics.reset()),r.physics.warmup(void 0!==t.warmup?t.warmup:60),this._optimizeIK(e,!0)},_animateMesh:function(e,t){var r=this.objects.get(e),n=r.mixer,i=r.ikSolver,o=r.grantSolver,a=r.physics,s=r.looped;n&&this.enabled.animation&&(this._restoreBones(e),n.update(t),this._saveBones(e),i&&this.enabled.ik&&(e.updateMatrixWorld(!0),i.update()),o&&this.enabled.grant&&o.update()),!0===s&&this.enabled.physics&&(a&&this.configuration.resetPhysicsOnLoop&&a.reset(),r.looped=!1),a&&this.enabled.physics&&!this.sharedPhysics&&(this.onBeforePhysics(e),a.update(t))},_animateCamera:function(e,t){var r=this.objects.get(e).mixer;r&&this.enabled.cameraAnimation&&(r.update(t),e.updateProjectionMatrix(),e.up.set(0,1,0),e.up.applyQuaternion(e.quaternion),e.lookAt(this.cameraTarget.position))},_optimizeIK:function(e,t){for(var r=e.geometry.userData.MMD.iks,n=e.geometry.userData.MMD.bones,i=0,o=r.length;i<o;i++)for(var a=r[i].links,s=0,l=a.length;s<l;s++){var u=a[s];u.enabled=!0!==t||!(n[u.index].rigidBodyType>0)}},_createCCDIKSolver:function(e){if(void 0===CCDIKSolver)throw new Error("MMDAnimationHelper: Import CCDIKSolver.");return new CCDIKSolver(e,e.geometry.userData.MMD.iks)},_createMMDPhysics:function(e,t){if(void 0===MMDPhysics)throw new Error("MMDPhysics: Import MMDPhysics.");return new MMDPhysics(e,e.geometry.userData.MMD.rigidBodies,e.geometry.userData.MMD.constraints,t)},_syncDuration:function(){for(var e=0,t=this.objects,r=this.meshes,n=this.camera,i=this.audioManager,o=0,a=r.length;o<a;o++){if(void 0!==(u=this.objects.get(r[o]).mixer))for(var s=0;s<u._actions.length;s++){var l=u._actions[s]._clip;t.has(l)||t.set(l,{duration:l.duration}),e=Math.max(e,t.get(l).duration)}}if(null!==n&&void 0!==(u=this.objects.get(n).mixer))for(o=0,a=u._actions.length;o<a;o++){l=u._actions[o]._clip;t.has(l)||t.set(l,{duration:l.duration}),e=Math.max(e,t.get(l).duration)}null!==i&&(e=Math.max(e,t.get(i).duration)),e+=this.configuration.afterglow;for(o=0,a=this.meshes.length;o<a;o++){var u;if(void 0!==(u=this.objects.get(this.meshes[o]).mixer)){s=0;for(var c=u._actions.length;s<c;s++)u._actions[s]._clip.duration=e}}if(null!==n&&void 0!==(u=this.objects.get(n).mixer))for(o=0,a=u._actions.length;o<a;o++)u._actions[o]._clip.duration=e;null!==i&&(i.duration=e)},_updatePropertyMixersBuffer:function(e){for(var t=this.objects.get(e).mixer,r=t._bindings,n=t._accuIndex,i=0,o=r.length;i<o;i++){var a=r[i],s=a.buffer,l=(n+1)*a.valueSize;a.binding.getValue(s,l)}},_saveBones:function(e){var t=this.objects.get(e),r=e.skeleton.bones,n=t.backupBones;void 0===n&&(n=new Float32Array(7*r.length),t.backupBones=n);for(var i=0,o=r.length;i<o;i++){var a=r[i];a.position.toArray(n,7*i),a.quaternion.toArray(n,7*i+3)}},_restoreBones:function(e){var t=this.objects.get(e).backupBones;if(void 0!==t)for(var r=e.skeleton.bones,n=0,i=r.length;n<i;n++){var o=r[n];o.position.fromArray(t,7*n),o.quaternion.fromArray(t,7*n+3)}},_getMasterPhysics:function(){if(null!==this.masterPhysics)return this.masterPhysics;for(var e=0,t=this.meshes.length;e<t;e++){var r=this.meshes[e].physics;if(void 0!==r&&null!==r)return this.masterPhysics=r,this.masterPhysics}return null},_updateSharedPhysics:function(e){if(0!==this.meshes.length&&this.enabled.physics&&this.sharedPhysics){var t=this._getMasterPhysics();if(null!==t){for(var r=0,n=this.meshes.length;r<n;r++){null!==(i=this.meshes[r].physics)&&void 0!==i&&i.updateRigidBodies()}t.stepSimulation(e);for(r=0,n=this.meshes.length;r<n;r++){var i;null!==(i=this.meshes[r].physics)&&void 0!==i&&i.updateBones()}}}}},t.prototype={constructor:t,control:function(e){return this.elapsed+=e,this.currentTime+=e,this._shouldStopAudio()&&this.audio.stop(),this._shouldStartAudio()&&this.audio.play(),this},_shouldStartAudio:function(){if(this.audio.isPlaying)return!1;for(;this.currentTime>=this.duration;)this.currentTime-=this.duration;return!(this.currentTime<this.delayTime)&&(!(this.currentTime-this.delayTime>this.audioDuration)&&(this.audio.startTime=this.currentTime-this.delayTime,!0))},_shouldStopAudio:function(){return this.audio.isPlaying&&this.currentTime>=this.duration}},r.prototype={constructor:r,update:function(){var e=new Quaternion;return function(){for(var t=this.mesh.skeleton.bones,r=this.grants,n=0,i=r.length;n<i;n++){var o=r[n],a=t[o.index],s=t[o.parentIndex];o.isLocal?(o.affectPosition,o.affectRotation):(o.affectPosition,o.affectRotation&&(e.set(0,0,0,1),e.slerp(s.quaternion,o.ratio),a.quaternion.multiply(e)))}return this}}()},e}(),AnimationClipCreator=function(){};function Camera(){Object3D.call(this),this.type="Camera",this.matrixWorldInverse=new Matrix4,this.projectionMatrix=new Matrix4,this.projectionMatrixInverse=new Matrix4}function PerspectiveCamera(e,t,r,n){Camera.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==r?r:.1,this.far=void 0!==n?n:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function cloneUniforms(e){var t={};for(var r in e)for(var n in t[r]={},e[r]){var i=e[r][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?t[r][n]=i.clone():Array.isArray(i)?t[r][n]=i.slice():t[r][n]=i}return t}function mergeUniforms(e){for(var t={},r=0;r<e.length;r++){var n=cloneUniforms(e[r]);for(var i in n)t[i]=n[i]}return t}AnimationClipCreator.CreateRotationAnimation=function(e,t){return new AnimationClip(null,e,[new NumberKeyframeTrack(".rotation["+(t=t||"x")+"]",[0,e],[0,360])])},AnimationClipCreator.CreateScaleAxisAnimation=function(e,t){return new AnimationClip(null,e,[new NumberKeyframeTrack(".scale["+(t=t||"x")+"]",[0,e],[0,1])])},AnimationClipCreator.CreateShakeAnimation=function(e,t){for(var r=[],n=[],i=new Vector3,o=0;o<10*e;o++)r.push(o/10),i.set(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1).multiply(t).toArray(n,n.length);return new AnimationClip(null,e,[new VectorKeyframeTrack(".position",r,n)])},AnimationClipCreator.CreatePulsationAnimation=function(e,t){for(var r=[],n=[],i=new Vector3,o=0;o<10*e;o++){r.push(o/10);var a=Math.random()*t;i.set(a,a,a).toArray(n,n.length)}return new AnimationClip(null,e,[new VectorKeyframeTrack(".scale",r,n)])},AnimationClipCreator.CreateVisibilityAnimation=function(e){return new AnimationClip(null,e,[new BooleanKeyframeTrack(".visible",[0,e/2,e],[!0,!1,!0])])},AnimationClipCreator.CreateMaterialColorAnimation=function(e,t){for(var r=[],n=[],i=e/t.length,o=0;o<=t.length;o++)r.push(o*i),n.push(t[o%t.length]);return new AnimationClip(null,e,[new ColorKeyframeTrack(".material[0].color",r,n)])},Camera.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Camera,isCamera:!0,copy:function(e,t){return Object3D.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("Camera: .getWorldDirection() target is now required"),e=new Vector3),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){Object3D.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),PerspectiveCamera.prototype=Object.assign(Object.create(Camera.prototype),{constructor:PerspectiveCamera,isPerspectiveCamera:!0,copy:function(e,t){return Camera.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*_Math.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*_Math.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*_Math.RAD2DEG*Math.atan(Math.tan(.5*_Math.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,r,n,i,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*_Math.DEG2RAD*this.fov)/this.zoom,r=2*t,n=this.aspect*r,i=-.5*n,o=this.view;if(null!==this.view&&this.view.enabled){var a=o.fullWidth,s=o.fullHeight;i+=o.offsetX*n/a,t-=o.offsetY*r/s,n*=o.width/a,r*=o.height/s}var l=this.filmOffset;0!==l&&(i+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+n,t,t-r,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=Object3D.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}});var UniformsUtils={clone:cloneUniforms,merge:mergeUniforms},default_vertex="\nvoid main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",default_fragment="\nvoid main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}\n",_canvas;function ShaderMaterial(e){Material$1.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=default_vertex,this.fragmentShader=default_fragment,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==e&&(void 0!==e.attributes&&console.error("ShaderMaterial: attributes should now be defined in BufferGeometry instead."),this.setValues(e))}function Scene(){Object3D.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function OrthographicCamera(e,t,r,n,i,o){Camera.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==e?e:-1,this.right=void 0!==t?t:1,this.top=void 0!==r?r:1,this.bottom=void 0!==n?n:-1,this.near=void 0!==i?i:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}ShaderMaterial.prototype=Object.create(Material$1.prototype),ShaderMaterial.prototype.constructor=ShaderMaterial,ShaderMaterial.prototype.isShaderMaterial=!0,ShaderMaterial.prototype.copy=function(e){return Material$1.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=cloneUniforms(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},ShaderMaterial.prototype.toJSON=function(e){var t=Material$1.prototype.toJSON.call(this,e);for(var r in t.uniforms={},this.uniforms){var n=this.uniforms[r].value;n&&n.isTexture?t.uniforms[r]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[r]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[r]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[r]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[r]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[r]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[r]={type:"m4",value:n.toArray()}:t.uniforms[r]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;var i={};for(var o in this.extensions)!0===this.extensions[o]&&(i[o]=!0);return Object.keys(i).length>0&&(t.extensions=i),t},Scene.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Scene,isScene:!0,copy:function(e,t){return Object3D.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=Object3D.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t},dispose:function(){this.dispatchEvent({type:"dispose"})}}),OrthographicCamera.prototype=Object.assign(Object.create(Camera.prototype),{constructor:OrthographicCamera,isOrthographicCamera:!0,copy:function(e,t){return Camera.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,r,n,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2,i=r-e,o=r+e,a=n+t,s=n-t;if(null!==this.view&&this.view.enabled){var l=this.zoom/(this.view.width/this.view.fullWidth),u=this.zoom/(this.view.height/this.view.fullHeight),c=(this.right-this.left)/this.view.width,h=(this.top-this.bottom)/this.view.height;o=(i+=c*(this.view.offsetX/l))+c*(this.view.width/l),s=(a-=h*(this.view.offsetY/u))-h*(this.view.height/u)}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=Object3D.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}});var ImageUtils={getDataURL:function(e){var t;if("undefined"==typeof HTMLCanvasElement)return e.src;if(e instanceof HTMLCanvasElement)t=e;else{void 0===_canvas&&(_canvas=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),_canvas.width=e.width,_canvas.height=e.height;var r=_canvas.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=_canvas}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}},textureId=0;function Texture(e,t,r,n,i,o,a,s,l,u){Object.defineProperty(this,"id",{value:textureId++}),this.uuid=_Math.generateUUID(),this.name="",this.image=void 0!==e?e:Texture.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:Texture.DEFAULT_MAPPING,this.wrapS=void 0!==r?r:ClampToEdgeWrapping,this.wrapT=void 0!==n?n:ClampToEdgeWrapping,this.magFilter=void 0!==i?i:LinearFilter,this.minFilter=void 0!==o?o:LinearMipMapLinearFilter,this.anisotropy=void 0!==l?l:1,this.format=void 0!==a?a:RGBAFormat,this.type=void 0!==s?s:UnsignedByteType,this.offset=new Vector2(0,0),this.repeat=new Vector2(1,1),this.center=new Vector2(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Matrix3,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==u?u:LinearEncoding,this.version=0,this.onUpdate=null}function WebGLRenderTarget(e,t,r){this.width=e,this.height=t,this.scissor=new Vector4(0,0,e,t),this.scissorTest=!1,this.viewport=new Vector4(0,0,e,t),r=r||{},this.texture=new Texture(void 0,void 0,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,this.texture.minFilter=void 0!==r.minFilter?r.minFilter:LinearFilter,this.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,this.stencilBuffer=void 0===r.stencilBuffer||r.stencilBuffer,this.depthTexture=void 0!==r.depthTexture?r.depthTexture:null}function PlaneGeometry(e,t,r,n){Geometry.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n},this.fromBufferGeometry(new PlaneBufferGeometry(e,t,r,n)),this.mergeVertices()}function PlaneBufferGeometry(e,t,r,n){BufferGeometry.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n};var i,o,a=(e=e||1)/2,s=(t=t||1)/2,l=Math.floor(r)||1,u=Math.floor(n)||1,c=l+1,h=u+1,p=e/l,f=t/u,d=[],m=[],v=[],g=[];for(o=0;o<h;o++){var y=o*f-s;for(i=0;i<c;i++){var b=i*p-a;m.push(b,-y,0),v.push(0,0,1),g.push(i/l),g.push(1-o/u)}}for(o=0;o<u;o++)for(i=0;i<l;i++){var x=i+c*o,w=i+c*(o+1),S=i+1+c*(o+1),M=i+1+c*o;d.push(x,w,M),d.push(w,S,M)}this.setIndex(d),this.addAttribute("position",new Float32BufferAttribute(m,3)),this.addAttribute("normal",new Float32BufferAttribute(v,3)),this.addAttribute("uv",new Float32BufferAttribute(g,2))}Texture.DEFAULT_IMAGE=void 0,Texture.DEFAULT_MAPPING=UVMapping,Texture.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:Texture,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var n=this.image;if(void 0===n.uuid&&(n.uuid=_Math.generateUUID()),!t&&void 0===e.images[n.uuid]){var i;if(Array.isArray(n)){i=[];for(var o=0,a=n.length;o<a;o++)i.push(ImageUtils.getDataURL(n[o]))}else i=ImageUtils.getDataURL(n);e.images[n.uuid]={uuid:n.uuid,url:i}}r.image=n.uuid}return t||(e.textures[this.uuid]=r),r},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping!==UVMapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case RepeatWrapping:e.x=e.x-Math.floor(e.x);break;case ClampToEdgeWrapping:e.x=e.x<0?0:1;break;case MirroredRepeatWrapping:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case RepeatWrapping:e.y=e.y-Math.floor(e.y);break;case ClampToEdgeWrapping:e.y=e.y<0?0:1;break;case MirroredRepeatWrapping:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(Texture.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),WebGLRenderTarget.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:WebGLRenderTarget,isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),PlaneGeometry.prototype=Object.create(Geometry.prototype),PlaneGeometry.prototype.constructor=PlaneGeometry,PlaneBufferGeometry.prototype=Object.create(BufferGeometry.prototype),PlaneBufferGeometry.prototype.constructor=PlaneBufferGeometry;var BokehShader={defines:{DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tColor:{value:null},tDepth:{value:null},focus:{value:1},aspect:{value:1},aperture:{value:.025},maxblur:{value:1},nearClip:{value:1},farClip:{value:1e3}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","varying vec2 vUv;","uniform sampler2D tColor;","uniform sampler2D tDepth;","uniform float maxblur;","uniform float aperture;","uniform float nearClip;","uniform float farClip;","uniform float focus;","uniform float aspect;","#include <packing>","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, nearClip, farClip );","\t#else","\treturn orthographicDepthToViewZ( depth, nearClip, farClip );","\t#endif","}","void main() {","vec2 aspectcorrect = vec2( 1.0, aspect );","float viewZ = getViewZ( getDepth( vUv ) );","float factor = ( focus + viewZ );","vec2 dofblur = vec2 ( clamp( factor * aperture, -maxblur, maxblur ) );","vec2 dofblur9 = dofblur * 0.9;","vec2 dofblur7 = dofblur * 0.7;","vec2 dofblur4 = dofblur * 0.4;","vec4 col = vec4( 0.0 );","col += texture2D( tColor, vUv.xy );","col += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.4,   0.0  ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur4 );","gl_FragColor = col / 41.0;","gl_FragColor.a = 1.0;","}"].join("\n")},BokehShader2={uniforms:{textureWidth:{value:1},textureHeight:{value:1},focalDepth:{value:1},focalLength:{value:24},fstop:{value:.9},tColor:{value:null},tDepth:{value:null},maxblur:{value:1},showFocus:{value:0},manualdof:{value:0},vignetting:{value:0},depthblur:{value:0},threshold:{value:.5},gain:{value:2},bias:{value:.5},fringe:{value:.7},znear:{value:.1},zfar:{value:100},noise:{value:1},dithering:{value:1e-4},pentagon:{value:0},shaderFocus:{value:1},focusCoords:{value:new Vector2}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","varying vec2 vUv;","uniform sampler2D tColor;","uniform sampler2D tDepth;","uniform float textureWidth;","uniform float textureHeight;","uniform float focalDepth;  //focal distance value in meters, but you may use autofocus option below","uniform float focalLength; //focal length in mm","uniform float fstop; //f-stop value","uniform bool showFocus; //show debug focus point and focal range (red = focal point, green = focal range)","","uniform float znear; // camera clipping start","uniform float zfar; // camera clipping end","//------------------------------------------","//user variables","const int samples = SAMPLES; //samples on the first ring","const int rings = RINGS; //ring count","const int maxringsamples = rings * samples;","uniform bool manualdof; // manual dof calculation","float ndofstart = 1.0; // near dof blur start","float ndofdist = 2.0; // near dof blur falloff distance","float fdofstart = 1.0; // far dof blur start","float fdofdist = 3.0; // far dof blur falloff distance","float CoC = 0.03; //circle of confusion size in mm (35mm film = 0.03mm)","uniform bool vignetting; // use optical lens vignetting","float vignout = 1.3; // vignetting outer border","float vignin = 0.0; // vignetting inner border","float vignfade = 22.0; // f-stops till vignete fades","uniform bool shaderFocus;","// disable if you use external focalDepth value","uniform vec2 focusCoords;","// autofocus point on screen (0.0,0.0 - left lower corner, 1.0,1.0 - upper right)","// if center of screen use vec2(0.5, 0.5);","uniform float maxblur;","//clamp value of max blur (0.0 = no blur, 1.0 default)","uniform float threshold; // highlight threshold;","uniform float gain; // highlight gain;","uniform float bias; // bokeh edge bias","uniform float fringe; // bokeh chromatic aberration / fringing","uniform bool noise; //use noise instead of pattern for sample dithering","uniform float dithering;","uniform bool depthblur; // blur the depth buffer","float dbsize = 1.25; // depth blur size","","uniform bool pentagon; //use pentagon as bokeh shape?","float feather = 0.4; //pentagon shape feather","//------------------------------------------","float penta(vec2 coords) {","//pentagonal shape","float scale = float(rings) - 1.3;","vec4  HS0 = vec4( 1.0,         0.0,         0.0,  1.0);","vec4  HS1 = vec4( 0.309016994, 0.951056516, 0.0,  1.0);","vec4  HS2 = vec4(-0.809016994, 0.587785252, 0.0,  1.0);","vec4  HS3 = vec4(-0.809016994,-0.587785252, 0.0,  1.0);","vec4  HS4 = vec4( 0.309016994,-0.951056516, 0.0,  1.0);","vec4  HS5 = vec4( 0.0        ,0.0         , 1.0,  1.0);","vec4  one = vec4( 1.0 );","vec4 P = vec4((coords),vec2(scale, scale));","vec4 dist = vec4(0.0);","float inorout = -4.0;","dist.x = dot( P, HS0 );","dist.y = dot( P, HS1 );","dist.z = dot( P, HS2 );","dist.w = dot( P, HS3 );","dist = smoothstep( -feather, feather, dist );","inorout += dot( dist, one );","dist.x = dot( P, HS4 );","dist.y = HS5.w - abs( P.z );","dist = smoothstep( -feather, feather, dist );","inorout += dist.x;","return clamp( inorout, 0.0, 1.0 );","}","float bdepth(vec2 coords) {","// Depth buffer blur","float d = 0.0;","float kernel[9];","vec2 offset[9];","vec2 wh = vec2(1.0/textureWidth,1.0/textureHeight) * dbsize;","offset[0] = vec2(-wh.x,-wh.y);","offset[1] = vec2( 0.0, -wh.y);","offset[2] = vec2( wh.x -wh.y);","offset[3] = vec2(-wh.x,  0.0);","offset[4] = vec2( 0.0,   0.0);","offset[5] = vec2( wh.x,  0.0);","offset[6] = vec2(-wh.x, wh.y);","offset[7] = vec2( 0.0,  wh.y);","offset[8] = vec2( wh.x, wh.y);","kernel[0] = 1.0/16.0;   kernel[1] = 2.0/16.0;   kernel[2] = 1.0/16.0;","kernel[3] = 2.0/16.0;   kernel[4] = 4.0/16.0;   kernel[5] = 2.0/16.0;","kernel[6] = 1.0/16.0;   kernel[7] = 2.0/16.0;   kernel[8] = 1.0/16.0;","for( int i=0; i<9; i++ ) {","float tmp = texture2D(tDepth, coords + offset[i]).r;","d += tmp * kernel[i];","}","return d;","}","vec3 color(vec2 coords,float blur) {","//processing the sample","vec3 col = vec3(0.0);","vec2 texel = vec2(1.0/textureWidth,1.0/textureHeight);","col.r = texture2D(tColor,coords + vec2(0.0,1.0)*texel*fringe*blur).r;","col.g = texture2D(tColor,coords + vec2(-0.866,-0.5)*texel*fringe*blur).g;","col.b = texture2D(tColor,coords + vec2(0.866,-0.5)*texel*fringe*blur).b;","vec3 lumcoeff = vec3(0.299,0.587,0.114);","float lum = dot(col.rgb, lumcoeff);","float thresh = max((lum-threshold)*gain, 0.0);","return col+mix(vec3(0.0),col,thresh*blur);","}","vec3 debugFocus(vec3 col, float blur, float depth) {","float edge = 0.002*depth; //distance based edge smoothing","float m = clamp(smoothstep(0.0,edge,blur),0.0,1.0);","float e = clamp(smoothstep(1.0-edge,1.0,blur),0.0,1.0);","col = mix(col,vec3(1.0,0.5,0.0),(1.0-m)*0.6);","col = mix(col,vec3(0.0,0.5,1.0),((1.0-e)-(1.0-m))*0.2);","return col;","}","float linearize(float depth) {","return -zfar * znear / (depth * (zfar - znear) - zfar);","}","float vignette() {","float dist = distance(vUv.xy, vec2(0.5,0.5));","dist = smoothstep(vignout+(fstop/vignfade), vignin+(fstop/vignfade), dist);","return clamp(dist,0.0,1.0);","}","float gather(float i, float j, int ringsamples, inout vec3 col, float w, float h, float blur) {","float rings2 = float(rings);","float step = PI*2.0 / float(ringsamples);","float pw = cos(j*step)*i;","float ph = sin(j*step)*i;","float p = 1.0;","if (pentagon) {","p = penta(vec2(pw,ph));","}","col += color(vUv.xy + vec2(pw*w,ph*h), blur) * mix(1.0, i/rings2, bias) * p;","return 1.0 * mix(1.0, i /rings2, bias) * p;","}","void main() {","//scene depth calculation","float depth = linearize(texture2D(tDepth,vUv.xy).x);","// Blur depth?","if ( depthblur ) {","depth = linearize(bdepth(vUv.xy));","}","//focal plane calculation","float fDepth = focalDepth;","if (shaderFocus) {","fDepth = linearize(texture2D(tDepth,focusCoords).x);","}","// dof blur factor calculation","float blur = 0.0;","if (manualdof) {","float a = depth-fDepth; // Focal plane","float b = (a-fdofstart)/fdofdist; // Far DoF","float c = (-a-ndofstart)/ndofdist; // Near Dof","blur = (a>0.0) ? b : c;","} else {","float f = focalLength; // focal length in mm","float d = fDepth*1000.0; // focal plane in mm","float o = depth*1000.0; // depth in mm","float a = (o*f)/(o-f);","float b = (d*f)/(d-f);","float c = (d-f)/(d*fstop*CoC);","blur = abs(a-b)*c;","}","blur = clamp(blur,0.0,1.0);","// calculation of pattern for dithering","vec2 noise = vec2(rand(vUv.xy), rand( vUv.xy + vec2( 0.4, 0.6 ) ) )*dithering*blur;","// getting blur x and y step factor","float w = (1.0/textureWidth)*blur*maxblur+noise.x;","float h = (1.0/textureHeight)*blur*maxblur+noise.y;","// calculation of final color","vec3 col = vec3(0.0);","if(blur < 0.05) {","//some optimization thingy","col = texture2D(tColor, vUv.xy).rgb;","} else {","col = texture2D(tColor, vUv.xy).rgb;","float s = 1.0;","int ringsamples;","for (int i = 1; i <= rings; i++) {","","ringsamples = i * samples;","for (int j = 0 ; j < maxringsamples ; j++) {","if (j >= ringsamples) break;","s += gather(float(i), float(j), ringsamples, col, w, h, blur);","}","","}","col /= s; //divide by sample count","}","if (showFocus) {","col = debugFocus(col, blur, depth);","}","if (vignetting) {","col *= vignette();","}","gl_FragColor.rgb = col;","gl_FragColor.a = 1.0;","} "].join("\n")},BokehDepthShader={uniforms:{mNear:{value:1},mFar:{value:1e3}},vertexShader:["varying float vViewZDepth;","void main() {","\t#include <begin_vertex>","\t#include <project_vertex>","\tvViewZDepth = - mvPosition.z;","}"].join("\n"),fragmentShader:["uniform float mNear;","uniform float mFar;","varying float vViewZDepth;","void main() {","\tfloat color = 1.0 - smoothstep( mNear, mFar, vViewZDepth );","\tgl_FragColor = vec4( vec3( color ), 1.0 );","} "].join("\n")},CinematicCamera=function(e,t,r,n){PerspectiveCamera.call(this,e,t,r,n),this.type="CinematicCamera",this.postprocessing={enabled:!0},this.shaderSettings={rings:3,samples:4};var i=BokehDepthShader;this.materialDepth=new ShaderMaterial({uniforms:i.uniforms,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader}),this.materialDepth.uniforms.mNear.value=r,this.materialDepth.uniforms.mFar.value=n,this.setLens(),this.initPostProcessing()};function Group(){Object3D.call(this),this.type="Group"}CinematicCamera.prototype=Object.create(PerspectiveCamera.prototype),CinematicCamera.prototype.constructor=CinematicCamera,CinematicCamera.prototype.setLens=function(e,t,r,n){void 0===e&&(e=35),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e),void 0===r&&(r=8),void 0===n&&(n=.019),this.fNumber=r,this.coc=n,this.aperture=e/this.fNumber,this.hyperFocal=e*e/(this.aperture*this.coc)},CinematicCamera.prototype.linearize=function(e){var t=this.far,r=this.near;return-t*r/(e*(t-r)-t)},CinematicCamera.prototype.smoothstep=function(e,t,r){var n=this.saturate((r-e)/(t-e));return n*n*(3-2*n)},CinematicCamera.prototype.saturate=function(e){return Math.max(0,Math.min(1,e))},CinematicCamera.prototype.focusAt=function(e){void 0===e&&(e=20);var t=this.getFocalLength();this.focus=e,this.nearPoint=this.hyperFocal*this.focus/(this.hyperFocal+(this.focus-t)),this.farPoint=this.hyperFocal*this.focus/(this.hyperFocal-(this.focus-t)),this.depthOfField=this.farPoint-this.nearPoint,this.depthOfField<0&&(this.depthOfField=0),this.sdistance=this.smoothstep(this.near,this.far,this.focus),this.ldistance=this.linearize(1-this.sdistance),this.postprocessing.bokeh_uniforms.focalDepth.value=this.ldistance},CinematicCamera.prototype.initPostProcessing=function(){if(this.postprocessing.enabled){this.postprocessing.scene=new Scene,this.postprocessing.camera=new OrthographicCamera(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,-1e4,1e4),this.postprocessing.scene.add(this.postprocessing.camera);var e={minFilter:LinearFilter,magFilter:LinearFilter,format:RGBFormat};this.postprocessing.rtTextureDepth=new WebGLRenderTarget(window.innerWidth,window.innerHeight,e),this.postprocessing.rtTextureColor=new WebGLRenderTarget(window.innerWidth,window.innerHeight,e);var t=BokehShader;this.postprocessing.bokeh_uniforms=UniformsUtils.clone(t.uniforms),this.postprocessing.bokeh_uniforms.tColor.value=this.postprocessing.rtTextureColor.texture,this.postprocessing.bokeh_uniforms.tDepth.value=this.postprocessing.rtTextureDepth.texture,this.postprocessing.bokeh_uniforms.manualdof.value=0,this.postprocessing.bokeh_uniforms.shaderFocus.value=0,this.postprocessing.bokeh_uniforms.fstop.value=2.8,this.postprocessing.bokeh_uniforms.showFocus.value=1,this.postprocessing.bokeh_uniforms.focalDepth.value=.1,this.postprocessing.bokeh_uniforms.znear.value=this.near,this.postprocessing.bokeh_uniforms.zfar.value=this.near,this.postprocessing.bokeh_uniforms.textureWidth.value=window.innerWidth,this.postprocessing.bokeh_uniforms.textureHeight.value=window.innerHeight,this.postprocessing.materialBokeh=new ShaderMaterial({uniforms:this.postprocessing.bokeh_uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,defines:{RINGS:this.shaderSettings.rings,SAMPLES:this.shaderSettings.samples,DEPTH_PACKING:1}}),this.postprocessing.quad=new Mesh(new PlaneBufferGeometry(window.innerWidth,window.innerHeight),this.postprocessing.materialBokeh),this.postprocessing.quad.position.z=-500,this.postprocessing.scene.add(this.postprocessing.quad)}},CinematicCamera.prototype.renderCinematic=function(e,t){if(this.postprocessing.enabled){var r=t.getRenderTarget();t.clear(),e.overrideMaterial=null,t.setRenderTarget(this.postprocessing.rtTextureColor),t.clear(),t.render(e,camera),e.overrideMaterial=this.materialDepth,t.setRenderTarget(this.postprocessing.rtTextureDepth),t.clear(),t.render(e,camera),t.setRenderTarget(null),t.render(this.postprocessing.scene,this.postprocessing.camera),t.setRenderTarget(r)}},Group.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Group,isGroup:!0});var Car=function(){var e,t,r,n=0,i={LEFT:37,UP:38,RIGHT:39,DOWN:40,BRAKE:32},o=0,a=0,s=null,l=null,u=null,c=new Group,h=new Group,p=null,f=null,d=null,m=1,v=1,g=!1,y={brake:!1,moveForward:!1,moveBackward:!1,moveLeft:!1,moveRight:!1};function b(n,o,a,s,l){this.enabled=!0,this.elemNames={flWheel:"wheel_fl",frWheel:"wheel_fr",rlWheel:"wheel_rl",rrWheel:"wheel_rr",steeringWheel:"steering_wheel"},this.maxSpeed=n||180,e=.25*-this.maxSpeed,this.acceleration=o||10,t=.5*this.acceleration,this.turningRadius=s||6,r=2*this.acceleration,this.brakePower=a||10,this.speed=0,i=l||i,this.wheelRotationAxis="x",this.wheelTurnAxis="z",this.steeringWheelTurnAxis="y",document.addEventListener("keydown",this.onKeyDown,!1),document.addEventListener("keyup",this.onKeyUp,!1)}function x(e){return 1===e?1:1-Math.pow(2,-10*e)}return b.prototype={constructor:b,onKeyDown:function(e){switch(e.keyCode){case i.BRAKE:y.brake=!0,y.moveForward=!1,y.moveBackward=!1;break;case i.UP:y.moveForward=!0;break;case i.DOWN:y.moveBackward=!0;break;case i.LEFT:y.moveLeft=!0;break;case i.RIGHT:y.moveRight=!0}},onKeyUp:function(e){switch(e.keyCode){case i.BRAKE:y.brake=!1;break;case i.UP:y.moveForward=!1;break;case i.DOWN:y.moveBackward=!1;break;case i.LEFT:y.moveLeft=!1;break;case i.RIGHT:y.moveRight=!1}},dispose:function(){document.removeEventListener("keydown",this.onKeyDown,!1),document.removeEventListener("keyup",this.onKeyUp,!1)},update:function(i){if(g&&this.enabled){var b=1;if(y.brake&&(b=this.brakePower),y.moveForward&&(this.speed=_Math.clamp(this.speed+i*this.acceleration,e,this.maxSpeed),n=_Math.clamp(n+i,-1,1)),y.moveBackward&&(this.speed=_Math.clamp(this.speed-i*t,e,this.maxSpeed),n=_Math.clamp(n-i,-1,1)),y.moveLeft&&(o=_Math.clamp(o+1.5*i,-.6,.6)),y.moveRight&&(o=_Math.clamp(o-1.5*i,-.6,.6)),!y.moveForward&&!y.moveBackward)if(this.speed>0){var w=x(this.speed/this.maxSpeed);this.speed=_Math.clamp(this.speed-w*i*r*b,0,this.maxSpeed),n=_Math.clamp(n-w*i,0,1)}else{w=x(this.speed/e);this.speed=_Math.clamp(this.speed+w*i*t*b,e,0),n=_Math.clamp(n+w*i,-1,0)}y.moveLeft||y.moveRight||(o=o>0?_Math.clamp(o-1.5*i,0,.6):_Math.clamp(o+1.5*i,-.6,0));var S=-this.speed*i;a-=S*this.turningRadius*.02*o,s.position.x+=Math.sin(a)*S*v,s.position.z+=Math.cos(a)*S*v,s.rotation.y=a;var M=S*(-2/m)*v;c.rotation[this.wheelRotationAxis]-=M,h.rotation[this.wheelRotationAxis]-=M,p.rotation[this.wheelRotationAxis]-=M,f.rotation[this.wheelRotationAxis]-=M,l.rotation[this.wheelTurnAxis]=o,u.rotation[this.wheelTurnAxis]=o,d.rotation[this.steeringWheelTurnAxis]=6*-o}},setModel:function(e,t){t&&(this.elemNames=t),s=e,this.setupWheels(),this.computeDimensions(),g=!0},setupWheels:function(){for(l=s.getObjectByName(this.elemNames.flWheel),u=s.getObjectByName(this.elemNames.frWheel),p=s.getObjectByName(this.elemNames.rlWheel),f=s.getObjectByName(this.elemNames.rrWheel),null!==this.elemNames.steeringWheel&&(d=s.getObjectByName(this.elemNames.steeringWheel));l.children.length>0;)c.add(l.children[0]);for(;u.children.length>0;)h.add(u.children[0]);l.add(c),u.add(h)},computeDimensions:function(){var e=(new Box3).setFromObject(l),t=new Vector3;e.getSize(t),m=Math.max(t.x,t.y,t.z),e.setFromObject(s),t=e.getSize(t),v=Math.max(t.x,t.y,t.z)}},b}(),DeviceOrientationControls=function(e){var t=this;this.object=e,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var r=function(e){t.deviceOrientation=e},n=function(){t.screenOrientation=window.orientation||0},i=function(){var e=new Vector3(0,0,1),t=new Euler,r=new Quaternion,n=new Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(i,o,a,s,l){t.set(a,o,-s,"YXZ"),i.setFromEuler(t),i.multiply(n),i.multiply(r.setFromAxisAngle(e,-l))}}();this.connect=function(){n(),window.addEventListener("orientationchange",n,!1),window.addEventListener("deviceorientation",r,!1),t.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",n,!1),window.removeEventListener("deviceorientation",r,!1),t.enabled=!1},this.update=function(){if(!1!==t.enabled){var e=t.deviceOrientation;if(e){var r=e.alpha?_Math.degToRad(e.alpha)+t.alphaOffset:0,n=e.beta?_Math.degToRad(e.beta):0,o=e.gamma?_Math.degToRad(e.gamma):0,a=t.screenOrientation?_Math.degToRad(t.screenOrientation):0;i(t.object.quaternion,r,n,o,a)}}},this.dispose=function(){t.disconnect()},this.connect()};function Plane(e,t){this.normal=void 0!==e?e:new Vector3(1,0,0),this.constant=void 0!==t?t:0}function Raycaster(e,t,r,n){this.ray=new Ray(e,t),this.near=r||0,this.far=n||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function ascSort(e,t){return e.distance-t.distance}function _intersectObject(e,t,r,n){if(!1!==e.visible&&(e.raycast(t,r),!0===n))for(var i=e.children,o=0,a=i.length;o<a;o++)_intersectObject(i[o],t,r,!0)}Object.assign(Plane.prototype,{set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,r,n){return this.normal.set(e,t,r),this.constant=n,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new Vector3,t=new Vector3;return function(r,n,i){var o=e.subVectors(i,n).cross(t.subVectors(r,n)).normalize();return this.setFromNormalAndCoplanarPoint(o,r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return void 0===t&&(console.warn("Plane: .projectPoint() target is now required"),t=new Vector3),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(){var e=new Vector3;return function(t,r){void 0===r&&(console.warn("Plane: .intersectLine() target is now required"),r=new Vector3);var n=t.delta(e),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(t.start)?r.copy(t.start):void 0;var o=-(t.start.dot(this.normal)+this.constant)/i;return o<0||o>1?void 0:r.copy(n).multiplyScalar(o).add(t.start)}}(),intersectsLine:function(e){var t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("Plane: .coplanarPoint() target is now required"),e=new Vector3),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new Vector3,t=new Matrix3;return function(r,n){var i=n||t.getNormalMatrix(r),o=this.coplanarPoint(e).applyMatrix4(r),a=this.normal.applyMatrix3(i).normalize();return this.constant=-o.dot(a),this}}(),translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}}),Object.assign(Raycaster.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize()):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld)):console.error("Raycaster: Unsupported camera type.")},intersectObject:function(e,t,r){var n=r||[];return _intersectObject(e,this,n,t),n.sort(ascSort),n},intersectObjects:function(e,t,r){var n=r||[];if(!1===Array.isArray(e))return console.warn("Raycaster.intersectObjects: objects is not an Array."),n;for(var i=0,o=e.length;i<o;i++)_intersectObject(e[i],this,n,t);return n.sort(ascSort),n}});var DragControls=function(e,t,r){if(e instanceof Camera){console.warn("DragControls: Constructor now expects ( objects, camera, domElement )");var n=e;e=t,t=n}var i=new Plane,o=new Raycaster,a=new Vector2,s=new Vector3,l=new Vector3,u=new Vector3,c=new Matrix4,h=null,p=null,f=this;function d(){r.addEventListener("mousemove",v,!1),r.addEventListener("mousedown",g,!1),r.addEventListener("mouseup",y,!1),r.addEventListener("mouseleave",y,!1),r.addEventListener("touchmove",b,!1),r.addEventListener("touchstart",x,!1),r.addEventListener("touchend",w,!1)}function m(){r.removeEventListener("mousemove",v,!1),r.removeEventListener("mousedown",g,!1),r.removeEventListener("mouseup",y,!1),r.removeEventListener("mouseleave",y,!1),r.removeEventListener("touchmove",b,!1),r.removeEventListener("touchstart",x,!1),r.removeEventListener("touchend",w,!1)}function v(n){n.preventDefault();var d=r.getBoundingClientRect();if(a.x=(n.clientX-d.left)/d.width*2-1,a.y=-(n.clientY-d.top)/d.height*2+1,o.setFromCamera(a,t),h&&f.enabled)return o.ray.intersectPlane(i,l)&&h.position.copy(l.sub(s).applyMatrix4(c)),void f.dispatchEvent({type:"drag",object:h});o.setFromCamera(a,t);var m=o.intersectObjects(e);if(m.length>0){var v=m[0].object;i.setFromNormalAndCoplanarPoint(t.getWorldDirection(i.normal),u.setFromMatrixPosition(v.matrixWorld)),p!==v&&(f.dispatchEvent({type:"hoveron",object:v}),r.style.cursor="pointer",p=v)}else null!==p&&(f.dispatchEvent({type:"hoveroff",object:p}),r.style.cursor="auto",p=null)}function g(n){n.preventDefault(),o.setFromCamera(a,t);var p=o.intersectObjects(e);p.length>0&&(h=p[0].object,o.ray.intersectPlane(i,l)&&(c.getInverse(h.parent.matrixWorld),s.copy(l).sub(u.setFromMatrixPosition(h.matrixWorld))),r.style.cursor="move",f.dispatchEvent({type:"dragstart",object:h}))}function y(e){e.preventDefault(),h&&(f.dispatchEvent({type:"dragend",object:h}),h=null),r.style.cursor=p?"pointer":"auto"}function b(e){e.preventDefault(),e=e.changedTouches[0];var n=r.getBoundingClientRect();if(a.x=(e.clientX-n.left)/n.width*2-1,a.y=-(e.clientY-n.top)/n.height*2+1,o.setFromCamera(a,t),h&&f.enabled)return o.ray.intersectPlane(i,l)&&h.position.copy(l.sub(s).applyMatrix4(c)),void f.dispatchEvent({type:"drag",object:h})}function x(n){n.preventDefault(),n=n.changedTouches[0];var p=r.getBoundingClientRect();a.x=(n.clientX-p.left)/p.width*2-1,a.y=-(n.clientY-p.top)/p.height*2+1,o.setFromCamera(a,t);var d=o.intersectObjects(e);d.length>0&&(h=d[0].object,i.setFromNormalAndCoplanarPoint(t.getWorldDirection(i.normal),u.setFromMatrixPosition(h.matrixWorld)),o.ray.intersectPlane(i,l)&&(c.getInverse(h.parent.matrixWorld),s.copy(l).sub(u.setFromMatrixPosition(h.matrixWorld))),r.style.cursor="move",f.dispatchEvent({type:"dragstart",object:h}))}function w(e){e.preventDefault(),h&&(f.dispatchEvent({type:"dragend",object:h}),h=null),r.style.cursor="auto"}d(),this.enabled=!0,this.activate=d,this.deactivate=m,this.dispose=function(){m()},this.setObjects=function(){console.error("DragControls: setObjects() has been removed.")},this.on=function(e,t){console.warn("DragControls: on() has been deprecated. Use addEventListener() instead."),f.addEventListener(e,t)},this.off=function(e,t){console.warn("DragControls: off() has been deprecated. Use removeEventListener() instead."),f.removeEventListener(e,t)},this.notify=function(e){console.error("DragControls: notify() has been deprecated. Use dispatchEvent() instead."),f.dispatchEvent({type:e})}};function Spherical(e,t,r){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==r?r:0,this}DragControls.prototype=Object.create(EventDispatcher.prototype),DragControls.prototype.constructor=DragControls,Object.assign(Spherical.prototype,{set:function(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(_Math.clamp(t/this.radius,-1,1))),this}});var EditorControls=function(e,t){t=void 0!==t?t:document,this.enabled=!0,this.center=new Vector3,this.panSpeed=.001,this.zoomSpeed=.1,this.rotationSpeed=.005;var r=this,n=new Vector3,i=new Vector3,o=new Box3,a={NONE:-1,ROTATE:0,ZOOM:1,PAN:2},s=a.NONE,l=this.center,u=new Matrix3,c=new Vector2,h=new Vector2,p=new Spherical,f=new Sphere,d={type:"change"};function m(e){!1!==r.enabled&&(0===e.button?s=a.ROTATE:1===e.button?s=a.ZOOM:2===e.button&&(s=a.PAN),h.set(e.clientX,e.clientY),t.addEventListener("mousemove",v,!1),t.addEventListener("mouseup",g,!1),t.addEventListener("mouseout",g,!1),t.addEventListener("dblclick",g,!1))}function v(e){if(!1!==r.enabled){c.set(e.clientX,e.clientY);var t=c.x-h.x,n=c.y-h.y;s===a.ROTATE?r.rotate(i.set(-t*r.rotationSpeed,-n*r.rotationSpeed,0)):s===a.ZOOM?r.zoom(i.set(0,0,n)):s===a.PAN&&r.pan(i.set(-t,n,0)),h.set(e.clientX,e.clientY)}}function g(e){t.removeEventListener("mousemove",v,!1),t.removeEventListener("mouseup",g,!1),t.removeEventListener("mouseout",g,!1),t.removeEventListener("dblclick",g,!1),s=a.NONE}function y(e){e.preventDefault(),r.zoom(i.set(0,0,e.deltaY>0?1:-1))}function b(e){e.preventDefault()}this.focus=function(t){var n;o.setFromObject(t),!1===o.isEmpty()?(o.getCenter(l),n=o.getBoundingSphere(f).radius):(l.setFromMatrixPosition(t.matrixWorld),n=.1),i.set(0,0,1),i.applyQuaternion(e.quaternion),i.multiplyScalar(4*n),e.position.copy(l).add(i),r.dispatchEvent(d)},this.pan=function(t){var n=e.position.distanceTo(l);t.multiplyScalar(n*r.panSpeed),t.applyMatrix3(u.getNormalMatrix(e.matrix)),e.position.add(t),l.add(t),r.dispatchEvent(d)},this.zoom=function(t){var n=e.position.distanceTo(l);t.multiplyScalar(n*r.zoomSpeed),t.length()>n||(t.applyMatrix3(u.getNormalMatrix(e.matrix)),e.position.add(t),r.dispatchEvent(d))},this.rotate=function(t){n.copy(e.position).sub(l),p.setFromVector3(n),p.theta+=t.x,p.phi+=t.y,p.makeSafe(),n.setFromSpherical(p),e.position.copy(l).add(n),e.lookAt(l),r.dispatchEvent(d)},this.dispose=function(){t.removeEventListener("contextmenu",b,!1),t.removeEventListener("mousedown",m,!1),t.removeEventListener("wheel",y,!1),t.removeEventListener("mousemove",v,!1),t.removeEventListener("mouseup",g,!1),t.removeEventListener("mouseout",g,!1),t.removeEventListener("dblclick",g,!1),t.removeEventListener("touchstart",M,!1),t.removeEventListener("touchmove",_,!1)},t.addEventListener("contextmenu",b,!1),t.addEventListener("mousedown",m,!1),t.addEventListener("wheel",y,!1);var x=[new Vector3,new Vector3,new Vector3],w=[new Vector3,new Vector3,new Vector3],S=null;function M(e){if(!1!==r.enabled){switch(e.touches.length){case 1:x[0].set(e.touches[0].pageX,e.touches[0].pageY,0),x[1].set(e.touches[0].pageX,e.touches[0].pageY,0);break;case 2:x[0].set(e.touches[0].pageX,e.touches[0].pageY,0),x[1].set(e.touches[1].pageX,e.touches[1].pageY,0),S=x[0].distanceTo(x[1])}w[0].copy(x[0]),w[1].copy(x[1])}}function _(e){if(!1!==r.enabled){switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:x[0].set(e.touches[0].pageX,e.touches[0].pageY,0),x[1].set(e.touches[0].pageX,e.touches[0].pageY,0),r.rotate(x[0].sub(a(x[0],w)).multiplyScalar(-r.rotationSpeed));break;case 2:x[0].set(e.touches[0].pageX,e.touches[0].pageY,0),x[1].set(e.touches[1].pageX,e.touches[1].pageY,0);var t=x[0].distanceTo(x[1]);r.zoom(i.set(0,0,S-t)),S=t;var n=x[0].clone().sub(a(x[0],w)),o=x[1].clone().sub(a(x[1],w));n.x=-n.x,o.x=-o.x,r.pan(n.add(o).multiplyScalar(.5))}w[0].copy(x[0]),w[1].copy(x[1])}function a(e,t){var r=t[0];for(var n in t)r.distanceTo(e)>t[n].distanceTo(e)&&(r=t[n]);return r}}t.addEventListener("touchstart",M,!1),t.addEventListener("touchmove",_,!1)};EditorControls.prototype=Object.create(EventDispatcher.prototype),EditorControls.prototype.constructor=EditorControls;var FirstPersonControls=function(e,t){this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.movementSpeed=1,this.lookSpeed=.005,this.lookVertical=!0,this.autoForward=!1,this.activeLook=!0,this.heightSpeed=!1,this.heightCoef=1,this.heightMin=0,this.heightMax=1,this.constrainVertical=!1,this.verticalMin=0,this.verticalMax=Math.PI,this.autoSpeedFactor=0,this.mouseX=0,this.mouseY=0,this.moveForward=!1,this.moveBackward=!1,this.moveLeft=!1,this.moveRight=!1,this.mouseDragOn=!1,this.viewHalfX=0,this.viewHalfY=0;var r=0,n=0,i=new Vector3,o=new Spherical,a=new Vector3;function s(e){e.preventDefault()}this.domElement!==document&&this.domElement.setAttribute("tabindex",-1),this.handleResize=function(){this.domElement===document?(this.viewHalfX=window.innerWidth/2,this.viewHalfY=window.innerHeight/2):(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2)},this.onMouseDown=function(e){if(this.domElement!==document&&this.domElement.focus(),e.preventDefault(),e.stopPropagation(),this.activeLook)switch(e.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0}this.mouseDragOn=!0},this.onMouseUp=function(e){if(e.preventDefault(),e.stopPropagation(),this.activeLook)switch(e.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1}this.mouseDragOn=!1},this.onMouseMove=function(e){this.domElement===document?(this.mouseX=e.pageX-this.viewHalfX,this.mouseY=e.pageY-this.viewHalfY):(this.mouseX=e.pageX-this.domElement.offsetLeft-this.viewHalfX,this.mouseY=e.pageY-this.domElement.offsetTop-this.viewHalfY)},this.onKeyDown=function(e){switch(e.keyCode){case 38:case 87:this.moveForward=!0;break;case 37:case 65:this.moveLeft=!0;break;case 40:case 83:this.moveBackward=!0;break;case 39:case 68:this.moveRight=!0;break;case 82:this.moveUp=!0;break;case 70:this.moveDown=!0}},this.onKeyUp=function(e){switch(e.keyCode){case 38:case 87:this.moveForward=!1;break;case 37:case 65:this.moveLeft=!1;break;case 40:case 83:this.moveBackward=!1;break;case 39:case 68:this.moveRight=!1;break;case 82:this.moveUp=!1;break;case 70:this.moveDown=!1}},this.lookAt=function(e,t,r){return e.isVector3?a.copy(e):a.set(e,t,r),this.object.lookAt(a),d(this),this},this.update=function(){var e=new Vector3;return function(t){if(!1!==this.enabled){if(this.heightSpeed){var i=_Math.clamp(this.object.position.y,this.heightMin,this.heightMax)-this.heightMin;this.autoSpeedFactor=t*(i*this.heightCoef)}else this.autoSpeedFactor=0;var o=t*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.object.translateZ(-(o+this.autoSpeedFactor)),this.moveBackward&&this.object.translateZ(o),this.moveLeft&&this.object.translateX(-o),this.moveRight&&this.object.translateX(o),this.moveUp&&this.object.translateY(o),this.moveDown&&this.object.translateY(-o);var a=t*this.lookSpeed;this.activeLook||(a=0);var s=1;this.constrainVertical&&(s=Math.PI/(this.verticalMax-this.verticalMin)),n-=this.mouseX*a,this.lookVertical&&(r-=this.mouseY*a*s),r=Math.max(-85,Math.min(85,r));var l=_Math.degToRad(90-r),u=_Math.degToRad(n);this.constrainVertical&&(l=_Math.mapLinear(l,0,Math.PI,this.verticalMin,this.verticalMax));var c=this.object.position;e.setFromSphericalCoords(1,l,u).add(c),this.object.lookAt(e)}}}(),this.dispose=function(){this.domElement.removeEventListener("contextmenu",s,!1),this.domElement.removeEventListener("mousedown",u,!1),this.domElement.removeEventListener("mousemove",l,!1),this.domElement.removeEventListener("mouseup",c,!1),window.removeEventListener("keydown",h,!1),window.removeEventListener("keyup",p,!1)};var l=f(this,this.onMouseMove),u=f(this,this.onMouseDown),c=f(this,this.onMouseUp),h=f(this,this.onKeyDown),p=f(this,this.onKeyUp);function f(e,t){return function(){t.apply(e,arguments)}}function d(e){var t=e.object.quaternion;i.set(0,0,-1).applyQuaternion(t),o.setFromVector3(i),r=90-_Math.radToDeg(o.phi),n=_Math.radToDeg(o.theta)}this.domElement.addEventListener("contextmenu",s,!1),this.domElement.addEventListener("mousemove",l,!1),this.domElement.addEventListener("mousedown",u,!1),this.domElement.addEventListener("mouseup",c,!1),window.addEventListener("keydown",h,!1),window.addEventListener("keyup",p,!1),this.handleResize(),d(this)},FlyControls=function(e,t){function r(e,t){return function(){t.apply(e,arguments)}}function n(e){e.preventDefault()}this.object=e,this.domElement=void 0!==t?t:document,t&&this.domElement.setAttribute("tabindex",-1),this.movementSpeed=1,this.rollSpeed=.005,this.dragToLook=!1,this.autoForward=!1,this.tmpQuaternion=new Quaternion,this.mouseStatus=0,this.moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this.moveVector=new Vector3(0,0,0),this.rotationVector=new Vector3(0,0,0),this.keydown=function(e){if(!e.altKey){switch(e.keyCode){case 16:this.movementSpeedMultiplier=.1;break;case 87:this.moveState.forward=1;break;case 83:this.moveState.back=1;break;case 65:this.moveState.left=1;break;case 68:this.moveState.right=1;break;case 82:this.moveState.up=1;break;case 70:this.moveState.down=1;break;case 38:this.moveState.pitchUp=1;break;case 40:this.moveState.pitchDown=1;break;case 37:this.moveState.yawLeft=1;break;case 39:this.moveState.yawRight=1;break;case 81:this.moveState.rollLeft=1;break;case 69:this.moveState.rollRight=1}this.updateMovementVector(),this.updateRotationVector()}},this.keyup=function(e){switch(e.keyCode){case 16:this.movementSpeedMultiplier=1;break;case 87:this.moveState.forward=0;break;case 83:this.moveState.back=0;break;case 65:this.moveState.left=0;break;case 68:this.moveState.right=0;break;case 82:this.moveState.up=0;break;case 70:this.moveState.down=0;break;case 38:this.moveState.pitchUp=0;break;case 40:this.moveState.pitchDown=0;break;case 37:this.moveState.yawLeft=0;break;case 39:this.moveState.yawRight=0;break;case 81:this.moveState.rollLeft=0;break;case 69:this.moveState.rollRight=0}this.updateMovementVector(),this.updateRotationVector()},this.mousedown=function(e){if(this.domElement!==document&&this.domElement.focus(),e.preventDefault(),e.stopPropagation(),this.dragToLook)this.mouseStatus++;else{switch(e.button){case 0:this.moveState.forward=1;break;case 2:this.moveState.back=1}this.updateMovementVector()}},this.mousemove=function(e){if(!this.dragToLook||this.mouseStatus>0){var t=this.getContainerDimensions(),r=t.size[0]/2,n=t.size[1]/2;this.moveState.yawLeft=-(e.pageX-t.offset[0]-r)/r,this.moveState.pitchDown=(e.pageY-t.offset[1]-n)/n,this.updateRotationVector()}},this.mouseup=function(e){if(e.preventDefault(),e.stopPropagation(),this.dragToLook)this.mouseStatus--,this.moveState.yawLeft=this.moveState.pitchDown=0;else{switch(e.button){case 0:this.moveState.forward=0;break;case 2:this.moveState.back=0}this.updateMovementVector()}this.updateRotationVector()},this.update=function(e){var t=e*this.movementSpeed,r=e*this.rollSpeed;this.object.translateX(this.moveVector.x*t),this.object.translateY(this.moveVector.y*t),this.object.translateZ(this.moveVector.z*t),this.tmpQuaternion.set(this.rotationVector.x*r,this.rotationVector.y*r,this.rotationVector.z*r,1).normalize(),this.object.quaternion.multiply(this.tmpQuaternion),this.object.rotation.setFromQuaternion(this.object.quaternion,this.object.rotation.order)},this.updateMovementVector=function(){var e=this.moveState.forward||this.autoForward&&!this.moveState.back?1:0;this.moveVector.x=-this.moveState.left+this.moveState.right,this.moveVector.y=-this.moveState.down+this.moveState.up,this.moveVector.z=-e+this.moveState.back},this.updateRotationVector=function(){this.rotationVector.x=-this.moveState.pitchDown+this.moveState.pitchUp,this.rotationVector.y=-this.moveState.yawRight+this.moveState.yawLeft,this.rotationVector.z=-this.moveState.rollRight+this.moveState.rollLeft},this.getContainerDimensions=function(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}},this.dispose=function(){this.domElement.removeEventListener("contextmenu",n,!1),this.domElement.removeEventListener("mousedown",o,!1),this.domElement.removeEventListener("mousemove",i,!1),this.domElement.removeEventListener("mouseup",a,!1),window.removeEventListener("keydown",s,!1),window.removeEventListener("keyup",l,!1)};var i=r(this,this.mousemove),o=r(this,this.mousedown),a=r(this,this.mouseup),s=r(this,this.keydown),l=r(this,this.keyup);this.domElement.addEventListener("contextmenu",n,!1),this.domElement.addEventListener("mousemove",i,!1),this.domElement.addEventListener("mousedown",o,!1),this.domElement.addEventListener("mouseup",a,!1),window.addEventListener("keydown",s,!1),window.addEventListener("keyup",l,!1),this.updateMovementVector(),this.updateRotationVector()},MapControls=function(e,t){this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:MOUSE.LEFT,MIDDLE:MOUSE.MIDDLE,RIGHT:MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return u.phi},this.getAzimuthalAngle=function(){return u.theta},this.saveState=function(){r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(n),r.update(),s=a.NONE},this.update=function(){var t=new Vector3,i=(new Quaternion).setFromUnitVectors(e.up,new Vector3(0,1,0)),o=i.clone().inverse(),d=new Vector3,m=new Quaternion;return function(){var e=r.object.position;return t.copy(e).sub(r.target),t.applyQuaternion(i),u.setFromVector3(t),r.autoRotate&&s===a.NONE&&L(2*Math.PI/60/60*r.autoRotateSpeed),u.theta+=c.theta,u.phi+=c.phi,u.theta=Math.max(r.minAzimuthAngle,Math.min(r.maxAzimuthAngle,u.theta)),u.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,u.phi)),u.makeSafe(),u.radius*=h,u.radius=Math.max(r.minDistance,Math.min(r.maxDistance,u.radius)),r.target.add(p),t.setFromSpherical(u),t.applyQuaternion(o),e.copy(r.target).add(t),r.object.lookAt(r.target),!0===r.enableDamping?(c.theta*=1-r.dampingFactor,c.phi*=1-r.dampingFactor,p.multiplyScalar(1-r.dampingFactor)):(c.set(0,0,0),p.set(0,0,0)),h=1,!!(f||d.distanceToSquared(r.object.position)>l||8*(1-m.dot(r.object.quaternion))>l)&&(r.dispatchEvent(n),d.copy(r.object.position),m.copy(r.object.quaternion),f=!1,!0)}}(),this.dispose=function(){r.domElement.removeEventListener("contextmenu",Y,!1),r.domElement.removeEventListener("mousedown",V,!1),r.domElement.removeEventListener("wheel",G,!1),r.domElement.removeEventListener("touchstart",H,!1),r.domElement.removeEventListener("touchend",q,!1),r.domElement.removeEventListener("touchmove",X,!1),document.removeEventListener("mousemove",j,!1),document.removeEventListener("mouseup",z,!1),window.removeEventListener("keydown",W,!1)};var r=this,n={type:"change"},i={type:"start"},o={type:"end"},a={NONE:0,ROTATE_UP:1,ROTATE_LEFT:2,ROTATE:3,DOLLY:4,DOLLY_ROTATE:7,PAN:8,DOLLY_PAN:12},s=a.NONE,l=1e-6,u=new Spherical,c=new Spherical,h=1,p=new Vector3,f=!1,d=new Vector2,m=new Vector2,v=new Vector2,g=new Vector2,y=new Vector2,b=new Vector2,x=new Vector2,w=new Vector2,S=new Vector2,M=new Vector2,_=new Vector2,T=new Vector2,A=new Vector2,C=new Vector2;function E(){return Math.pow(.95,r.zoomSpeed)}function L(e){c.theta-=e}function N(e){c.phi-=e}var P=function(){var e=new Vector3;return function(t,r){e.setFromMatrixColumn(r,0),e.multiplyScalar(-t),p.add(e)}}(),O=function(){var e=new Vector3;return function(t,n){!0===r.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(r.object.up,e)),e.multiplyScalar(t),p.add(e)}}(),R=function(){var e=new Vector3;return function(t,n){var i=r.domElement===document?r.domElement.body:r.domElement;if(r.object.isPerspectiveCamera){var o=r.object.position;e.copy(o).sub(r.target);var a=e.length();a*=Math.tan(r.object.fov/2*Math.PI/180),P(2*t*a/i.clientHeight,r.object.matrix),O(2*n*a/i.clientHeight,r.object.matrix)}else r.object.isOrthographicCamera?(P(t*(r.object.right-r.object.left)/r.object.zoom/i.clientWidth,r.object.matrix),O(n*(r.object.top-r.object.bottom)/r.object.zoom/i.clientHeight,r.object.matrix)):(console.warn("WARNING: MapControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}}();function D(e){r.object.isPerspectiveCamera?h/=e:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom*e)),r.object.updateProjectionMatrix(),f=!0):(console.warn("WARNING: MapControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function F(e){r.object.isPerspectiveCamera?h*=e:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/e)),r.object.updateProjectionMatrix(),f=!0):(console.warn("WARNING: MapControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function k(e){d.set(e.clientX,e.clientY)}function I(e){if(!1!==r.enableRotate&&0!==(s&a.ROTATE)){if(v.set(e.touches[0].pageX,e.touches[0].pageY),g.set(e.touches[1].pageX,e.touches[1].pageY),y.subVectors(v,d),b.subVectors(g,m),x.subVectors(m,d),w.subVectors(g,v),function(){if(!B(x))return!1;if(!B(w))return!1;if(!U(y))return!1;if(!U(b))return!1;return y.dot(b)>0}()){var t=r.domElement===document?r.domElement.body:r.domElement;N(2*Math.PI*y.y/t.clientHeight),s=a.ROTATE_UP}else 0!==(s&a.ROTATE_LEFT)&&L((x.angle()-w.angle())*r.rotateSpeed);d.copy(v),m.copy(g)}}var B=function(){var e=Math.sin(Math.PI/6);return function(t){return Math.abs(Math.sin(t.angle()))<e}}(),U=function(){var e=Math.cos(Math.PI/2-Math.PI/6);return function(t){return Math.abs(Math.cos(t.angle()))<e}}();function V(e){if(!1!==r.enabled){switch(e.preventDefault(),e.button){case r.mouseButtons.LEFT:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enableRotate)return;k(e),s=a.ROTATE}else{if(!1===r.enablePan)return;!function(e){S.set(e.clientX,e.clientY)}(e),s=a.PAN}break;case r.mouseButtons.MIDDLE:if(!1===r.enableZoom)return;!function(e){T.set(e.clientX,e.clientY)}(e),s=a.DOLLY;break;case r.mouseButtons.RIGHT:if(!1===r.enableRotate)return;k(e),s=a.ROTATE}s!==a.NONE&&(document.addEventListener("mousemove",j,!1),document.addEventListener("mouseup",z,!1),r.dispatchEvent(i))}}function j(e){if(!1!==r.enabled)switch(e.preventDefault(),s){case a.ROTATE:if(!1===r.enableRotate)return;!function(e){v.set(e.clientX,e.clientY),y.subVectors(v,d).multiplyScalar(r.rotateSpeed);var t=r.domElement===document?r.domElement.body:r.domElement;L(2*Math.PI*y.x/t.clientHeight),N(2*Math.PI*y.y/t.clientHeight),d.copy(v),r.update()}(e);break;case a.DOLLY:if(!1===r.enableZoom)return;!function(e){A.set(e.clientX,e.clientY),C.subVectors(A,T),C.y>0?D(E()):C.y<0&&F(E()),T.copy(A),r.update()}(e);break;case a.PAN:if(!1===r.enablePan)return;!function(e){M.set(e.clientX,e.clientY),_.subVectors(M,S).multiplyScalar(r.panSpeed),R(_.x,_.y),S.copy(M),r.update()}(e)}}function z(e){!1!==r.enabled&&(document.removeEventListener("mousemove",j,!1),document.removeEventListener("mouseup",z,!1),r.dispatchEvent(o),s=a.NONE)}function G(e){!1===r.enabled||!1===r.enableZoom||s!==a.NONE&&s!==a.ROTATE||(e.preventDefault(),e.stopPropagation(),r.dispatchEvent(i),function(e){e.deltaY<0?F(E()):e.deltaY>0&&D(E()),r.update()}(e),r.dispatchEvent(o))}function W(e){!1!==r.enabled&&!1!==r.enableKeys&&!1!==r.enablePan&&function(e){switch(e.keyCode){case r.keys.UP:R(0,r.keyPanSpeed),r.update();break;case r.keys.BOTTOM:R(0,-r.keyPanSpeed),r.update();break;case r.keys.LEFT:R(r.keyPanSpeed,0),r.update();break;case r.keys.RIGHT:R(-r.keyPanSpeed,0),r.update()}}(e)}function H(e){if(!1!==r.enabled){switch(e.preventDefault(),e.touches.length){case 1:if(!1===r.enablePan)return;!function(e){r.enablePan&&S.set(e.touches[0].pageX,e.touches[0].pageY)}(e),s=a.PAN;break;case 2:if(!1===r.enableZoom&&!1===r.enableRotate)return;!function(e){d.set(e.touches[0].pageX,e.touches[0].pageY),m.set(e.touches[1].pageX,e.touches[1].pageY)}(e),function(e){if(r.enableZoom){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,i=Math.sqrt(t*t+n*n);T.set(0,i)}}(e),s=a.DOLLY_ROTATE;break;default:s=a.NONE}s!==a.NONE&&r.dispatchEvent(i)}}function X(e){if(!1!==r.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(!1===r.enablePan)return;if(s!==a.PAN)return;!function(e){!1!==r.enablePan&&0!==(s&a.PAN)&&(M.set(e.touches[0].pageX,e.touches[0].pageY),_.subVectors(M,S).multiplyScalar(r.panSpeed),R(_.x,_.y),S.copy(M))}(e),r.update();break;case 2:if(!1===r.enableZoom&&!1===r.enableRotate)return;if(0===(s&a.DOLLY_ROTATE))return;I(e),function(e){if(!1!==r.enableZoom&&0!==(s&a.DOLLY)){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,i=Math.sqrt(t*t+n*n);A.set(0,i),C.set(0,Math.pow(A.y/T.y,r.zoomSpeed)),D(C.y),T.copy(A)}}(e),r.update();break;default:s=a.NONE}}function q(e){!1!==r.enabled&&(r.dispatchEvent(o),s=a.NONE)}function Y(e){!1!==r.enabled&&e.preventDefault()}r.domElement.addEventListener("contextmenu",Y,!1),r.domElement.addEventListener("mousedown",V,!1),r.domElement.addEventListener("wheel",G,!1),r.domElement.addEventListener("touchstart",H,!1),r.domElement.addEventListener("touchend",q,!1),r.domElement.addEventListener("touchmove",X,!1),window.addEventListener("keydown",W,!1),this.update()};MapControls.prototype=Object.create(EventDispatcher.prototype),MapControls.prototype.constructor=MapControls,Object.defineProperties(MapControls.prototype,{center:{get:function(){return console.warn("MapControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("MapControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("MapControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("MapControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("MapControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("MapControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("MapControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("MapControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("MapControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("MapControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("MapControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("MapControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("MapControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}});var OrbitControls=function(e,t){this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:MOUSE.LEFT,MIDDLE:MOUSE.MIDDLE,RIGHT:MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return u.phi},this.getAzimuthalAngle=function(){return u.theta},this.saveState=function(){r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(n),r.update(),s=a.NONE},this.update=function(){var t=new Vector3,i=(new Quaternion).setFromUnitVectors(e.up,new Vector3(0,1,0)),o=i.clone().inverse(),d=new Vector3,m=new Quaternion;return function(){var e=r.object.position;return t.copy(e).sub(r.target),t.applyQuaternion(i),u.setFromVector3(t),r.autoRotate&&s===a.NONE&&_(2*Math.PI/60/60*r.autoRotateSpeed),u.theta+=c.theta,u.phi+=c.phi,u.theta=Math.max(r.minAzimuthAngle,Math.min(r.maxAzimuthAngle,u.theta)),u.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,u.phi)),u.makeSafe(),u.radius*=h,u.radius=Math.max(r.minDistance,Math.min(r.maxDistance,u.radius)),r.target.add(p),t.setFromSpherical(u),t.applyQuaternion(o),e.copy(r.target).add(t),r.object.lookAt(r.target),!0===r.enableDamping?(c.theta*=1-r.dampingFactor,c.phi*=1-r.dampingFactor,p.multiplyScalar(1-r.dampingFactor)):(c.set(0,0,0),p.set(0,0,0)),h=1,!!(f||d.distanceToSquared(r.object.position)>l||8*(1-m.dot(r.object.quaternion))>l)&&(r.dispatchEvent(n),d.copy(r.object.position),m.copy(r.object.quaternion),f=!1,!0)}}(),this.dispose=function(){r.domElement.removeEventListener("contextmenu",V,!1),r.domElement.removeEventListener("mousedown",O,!1),r.domElement.removeEventListener("wheel",F,!1),r.domElement.removeEventListener("touchstart",I,!1),r.domElement.removeEventListener("touchend",U,!1),r.domElement.removeEventListener("touchmove",B,!1),document.removeEventListener("mousemove",R,!1),document.removeEventListener("mouseup",D,!1),window.removeEventListener("keydown",k,!1)};var r=this,n={type:"change"},i={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY_PAN:4},s=a.NONE,l=1e-6,u=new Spherical,c=new Spherical,h=1,p=new Vector3,f=!1,d=new Vector2,m=new Vector2,v=new Vector2,g=new Vector2,y=new Vector2,b=new Vector2,x=new Vector2,w=new Vector2,S=new Vector2;function M(){return Math.pow(.95,r.zoomSpeed)}function _(e){c.theta-=e}function T(e){c.phi-=e}var A=function(){var e=new Vector3;return function(t,r){e.setFromMatrixColumn(r,0),e.multiplyScalar(-t),p.add(e)}}(),C=function(){var e=new Vector3;return function(t,n){!0===r.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(r.object.up,e)),e.multiplyScalar(t),p.add(e)}}(),E=function(){var e=new Vector3;return function(t,n){var i=r.domElement===document?r.domElement.body:r.domElement;if(r.object.isPerspectiveCamera){var o=r.object.position;e.copy(o).sub(r.target);var a=e.length();a*=Math.tan(r.object.fov/2*Math.PI/180),A(2*t*a/i.clientHeight,r.object.matrix),C(2*n*a/i.clientHeight,r.object.matrix)}else r.object.isOrthographicCamera?(A(t*(r.object.right-r.object.left)/r.object.zoom/i.clientWidth,r.object.matrix),C(n*(r.object.top-r.object.bottom)/r.object.zoom/i.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}}();function L(e){r.object.isPerspectiveCamera?h/=e:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom*e)),r.object.updateProjectionMatrix(),f=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function N(e){r.object.isPerspectiveCamera?h*=e:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/e)),r.object.updateProjectionMatrix(),f=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function P(e){g.set(e.clientX,e.clientY)}function O(e){if(!1!==r.enabled){switch(e.preventDefault(),r.domElement.focus?r.domElement.focus():window.focus(),e.button){case r.mouseButtons.LEFT:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enablePan)return;P(e),s=a.PAN}else{if(!1===r.enableRotate)return;!function(e){d.set(e.clientX,e.clientY)}(e),s=a.ROTATE}break;case r.mouseButtons.MIDDLE:if(!1===r.enableZoom)return;!function(e){x.set(e.clientX,e.clientY)}(e),s=a.DOLLY;break;case r.mouseButtons.RIGHT:if(!1===r.enablePan)return;P(e),s=a.PAN}s!==a.NONE&&(document.addEventListener("mousemove",R,!1),document.addEventListener("mouseup",D,!1),r.dispatchEvent(i))}}function R(e){if(!1!==r.enabled)switch(e.preventDefault(),s){case a.ROTATE:if(!1===r.enableRotate)return;!function(e){m.set(e.clientX,e.clientY),v.subVectors(m,d).multiplyScalar(r.rotateSpeed);var t=r.domElement===document?r.domElement.body:r.domElement;_(2*Math.PI*v.x/t.clientHeight),T(2*Math.PI*v.y/t.clientHeight),d.copy(m),r.update()}(e);break;case a.DOLLY:if(!1===r.enableZoom)return;!function(e){w.set(e.clientX,e.clientY),S.subVectors(w,x),S.y>0?L(M()):S.y<0&&N(M()),x.copy(w),r.update()}(e);break;case a.PAN:if(!1===r.enablePan)return;!function(e){y.set(e.clientX,e.clientY),b.subVectors(y,g).multiplyScalar(r.panSpeed),E(b.x,b.y),g.copy(y),r.update()}(e)}}function D(e){!1!==r.enabled&&(document.removeEventListener("mousemove",R,!1),document.removeEventListener("mouseup",D,!1),r.dispatchEvent(o),s=a.NONE)}function F(e){!1===r.enabled||!1===r.enableZoom||s!==a.NONE&&s!==a.ROTATE||(e.preventDefault(),e.stopPropagation(),r.dispatchEvent(i),function(e){e.deltaY<0?N(M()):e.deltaY>0&&L(M()),r.update()}(e),r.dispatchEvent(o))}function k(e){!1!==r.enabled&&!1!==r.enableKeys&&!1!==r.enablePan&&function(e){var t=!1;switch(e.keyCode){case r.keys.UP:E(0,r.keyPanSpeed),t=!0;break;case r.keys.BOTTOM:E(0,-r.keyPanSpeed),t=!0;break;case r.keys.LEFT:E(r.keyPanSpeed,0),t=!0;break;case r.keys.RIGHT:E(-r.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),r.update())}(e)}function I(e){if(!1!==r.enabled){switch(e.preventDefault(),e.touches.length){case 1:if(!1===r.enableRotate)return;!function(e){d.set(e.touches[0].pageX,e.touches[0].pageY)}(e),s=a.TOUCH_ROTATE;break;case 2:if(!1===r.enableZoom&&!1===r.enablePan)return;!function(e){if(r.enableZoom){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,i=Math.sqrt(t*t+n*n);x.set(0,i)}if(r.enablePan){var o=.5*(e.touches[0].pageX+e.touches[1].pageX),a=.5*(e.touches[0].pageY+e.touches[1].pageY);g.set(o,a)}}(e),s=a.TOUCH_DOLLY_PAN;break;default:s=a.NONE}s!==a.NONE&&r.dispatchEvent(i)}}function B(e){if(!1!==r.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(!1===r.enableRotate)return;if(s!==a.TOUCH_ROTATE)return;!function(e){m.set(e.touches[0].pageX,e.touches[0].pageY),v.subVectors(m,d).multiplyScalar(r.rotateSpeed);var t=r.domElement===document?r.domElement.body:r.domElement;_(2*Math.PI*v.x/t.clientHeight),T(2*Math.PI*v.y/t.clientHeight),d.copy(m),r.update()}(e);break;case 2:if(!1===r.enableZoom&&!1===r.enablePan)return;if(s!==a.TOUCH_DOLLY_PAN)return;!function(e){if(r.enableZoom){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,i=Math.sqrt(t*t+n*n);w.set(0,i),S.set(0,Math.pow(w.y/x.y,r.zoomSpeed)),L(S.y),x.copy(w)}if(r.enablePan){var o=.5*(e.touches[0].pageX+e.touches[1].pageX),a=.5*(e.touches[0].pageY+e.touches[1].pageY);y.set(o,a),b.subVectors(y,g).multiplyScalar(r.panSpeed),E(b.x,b.y),g.copy(y)}r.update()}(e);break;default:s=a.NONE}}function U(e){!1!==r.enabled&&(r.dispatchEvent(o),s=a.NONE)}function V(e){!1!==r.enabled&&e.preventDefault()}r.domElement.addEventListener("contextmenu",V,!1),r.domElement.addEventListener("mousedown",O,!1),r.domElement.addEventListener("wheel",F,!1),r.domElement.addEventListener("touchstart",I,!1),r.domElement.addEventListener("touchend",U,!1),r.domElement.addEventListener("touchmove",B,!1),window.addEventListener("keydown",k,!1),this.update()};OrbitControls.prototype=Object.create(EventDispatcher.prototype),OrbitControls.prototype.constructor=OrbitControls,Object.defineProperties(OrbitControls.prototype,{center:{get:function(){return console.warn("OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}});var OrthographicTrackballControls=function(e,t){var r=this,n={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.radius=0,this.rotateSpeed=1,this.zoomSpeed=1.2,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.noRoll=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.keys=[65,83,68],this.target=new Vector3;var i=!0,o=n.NONE,a=n.NONE,s=new Vector3,l=new Vector3,u=new Vector3,c=new Vector2,h=new Vector2,p=0,f=0,d=new Vector2,m=new Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.left0=this.object.left,this.right0=this.object.right,this.top0=this.object.top,this.bottom0=this.object.bottom;var v={type:"change"},g={type:"start"},y={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}this.radius=.5*Math.min(this.screen.width,this.screen.height),this.left0=this.object.left,this.right0=this.object.right,this.top0=this.object.top,this.bottom0=this.object.bottom};var b=function(){var e=new Vector2;return function(t,n){return e.set((t-r.screen.left)/r.screen.width,(n-r.screen.top)/r.screen.height),e}}(),x=function(){var e=new Vector3,t=new Vector3,n=new Vector3;return function(i,o){n.set((i-.5*r.screen.width-r.screen.left)/r.radius,(.5*r.screen.height+r.screen.top-o)/r.radius,0);var a=n.length();return r.noRoll?a<Math.SQRT1_2?n.z=Math.sqrt(1-a*a):n.z=.5/a:a>1?n.normalize():n.z=Math.sqrt(1-a*a),s.copy(r.object.position).sub(r.target),e.copy(r.object.up).setLength(n.y),e.add(t.copy(r.object.up).cross(s).setLength(n.x)),e.add(s.setLength(n.z)),e}}();function w(e){!1!==r.enabled&&(window.removeEventListener("keydown",w),a=o,o===n.NONE&&(e.keyCode!==r.keys[n.ROTATE]||r.noRotate?e.keyCode!==r.keys[n.ZOOM]||r.noZoom?e.keyCode!==r.keys[n.PAN]||r.noPan||(o=n.PAN):o=n.ZOOM:o=n.ROTATE))}function S(e){!1!==r.enabled&&(o=a,window.addEventListener("keydown",w,!1))}function M(e){!1!==r.enabled&&(e.preventDefault(),e.stopPropagation(),o===n.NONE&&(o=e.button),o!==n.ROTATE||r.noRotate?o!==n.ZOOM||r.noZoom?o!==n.PAN||r.noPan||(d.copy(b(e.pageX,e.pageY)),m.copy(d)):(c.copy(b(e.pageX,e.pageY)),h.copy(c)):(l.copy(x(e.pageX,e.pageY)),u.copy(l)),document.addEventListener("mousemove",_,!1),document.addEventListener("mouseup",T,!1),r.dispatchEvent(g))}function _(e){!1!==r.enabled&&(e.preventDefault(),e.stopPropagation(),o!==n.ROTATE||r.noRotate?o!==n.ZOOM||r.noZoom?o!==n.PAN||r.noPan||m.copy(b(e.pageX,e.pageY)):h.copy(b(e.pageX,e.pageY)):u.copy(x(e.pageX,e.pageY)))}function T(e){!1!==r.enabled&&(e.preventDefault(),e.stopPropagation(),o=n.NONE,document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",T),r.dispatchEvent(y))}function A(e){!1!==r.enabled&&(e.preventDefault(),e.stopPropagation(),c.y+=.01*e.deltaY,r.dispatchEvent(g),r.dispatchEvent(y))}function C(e){if(!1!==r.enabled){switch(e.touches.length){case 1:o=n.TOUCH_ROTATE,l.copy(x(e.touches[0].pageX,e.touches[0].pageY)),u.copy(l);break;case 2:o=n.TOUCH_ZOOM_PAN;var t=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY;f=p=Math.sqrt(t*t+i*i);var a=(e.touches[0].pageX+e.touches[1].pageX)/2,s=(e.touches[0].pageY+e.touches[1].pageY)/2;d.copy(b(a,s)),m.copy(d);break;default:o=n.NONE}r.dispatchEvent(g)}}function E(e){if(!1!==r.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:u.copy(x(e.touches[0].pageX,e.touches[0].pageY));break;case 2:var t=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY;f=Math.sqrt(t*t+i*i);var a=(e.touches[0].pageX+e.touches[1].pageX)/2,s=(e.touches[0].pageY+e.touches[1].pageY)/2;m.copy(b(a,s));break;default:o=n.NONE}}function L(e){if(!1!==r.enabled){switch(e.touches.length){case 1:u.copy(x(e.touches[0].pageX,e.touches[0].pageY)),l.copy(u);break;case 2:p=f=0;var t=(e.touches[0].pageX+e.touches[1].pageX)/2,i=(e.touches[0].pageY+e.touches[1].pageY)/2;m.copy(b(t,i)),d.copy(m)}o=n.NONE,r.dispatchEvent(y)}}function N(e){e.preventDefault()}this.rotateCamera=function(){var e=new Vector3,t=new Quaternion;return function(){var n=Math.acos(l.dot(u)/l.length()/u.length());n&&(e.crossVectors(l,u).normalize(),n*=r.rotateSpeed,t.setFromAxisAngle(e,-n),s.applyQuaternion(t),r.object.up.applyQuaternion(t),u.applyQuaternion(t),r.staticMoving?l.copy(u):(t.setFromAxisAngle(e,n*(r.dynamicDampingFactor-1)),l.applyQuaternion(t)),i=!0)}}(),this.zoomCamera=function(){if(o===n.TOUCH_ZOOM_PAN){var e=f/p;p=f,r.object.zoom*=e,i=!0}else{e=1+(h.y-c.y)*r.zoomSpeed;Math.abs(e-1)>1e-6&&e>0&&(r.object.zoom/=e,r.staticMoving?c.copy(h):c.y+=(h.y-c.y)*this.dynamicDampingFactor,i=!0)}},this.panCamera=function(){var e=new Vector2,t=new Vector3,n=new Vector3;return function(){if(e.copy(m).sub(d),e.lengthSq()){var o=(r.object.right-r.object.left)/r.object.zoom,a=(r.object.top-r.object.bottom)/r.object.zoom;e.x*=o,e.y*=a,n.copy(s).cross(r.object.up).setLength(e.x),n.add(t.copy(r.object.up).setLength(e.y)),r.object.position.add(n),r.target.add(n),r.staticMoving?d.copy(m):d.add(e.subVectors(m,d).multiplyScalar(r.dynamicDampingFactor)),i=!0}}}(),this.update=function(){s.subVectors(r.object.position,r.target),r.noRotate||r.rotateCamera(),r.noZoom||(r.zoomCamera(),i&&r.object.updateProjectionMatrix()),r.noPan||r.panCamera(),r.object.position.addVectors(r.target,s),r.object.lookAt(r.target),i&&(r.dispatchEvent(v),i=!1)},this.reset=function(){o=n.NONE,a=n.NONE,r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.up.copy(r.up0),s.subVectors(r.object.position,r.target),r.object.left=r.left0,r.object.right=r.right0,r.object.top=r.top0,r.object.bottom=r.bottom0,r.object.lookAt(r.target),r.dispatchEvent(v),i=!1},this.dispose=function(){this.domElement.removeEventListener("contextmenu",N,!1),this.domElement.removeEventListener("mousedown",M,!1),this.domElement.removeEventListener("wheel",A,!1),this.domElement.removeEventListener("touchstart",C,!1),this.domElement.removeEventListener("touchend",L,!1),this.domElement.removeEventListener("touchmove",E,!1),document.removeEventListener("mousemove",_,!1),document.removeEventListener("mouseup",T,!1),window.removeEventListener("keydown",w,!1),window.removeEventListener("keyup",S,!1)},this.domElement.addEventListener("contextmenu",N,!1),this.domElement.addEventListener("mousedown",M,!1),this.domElement.addEventListener("wheel",A,!1),this.domElement.addEventListener("touchstart",C,!1),this.domElement.addEventListener("touchend",L,!1),this.domElement.addEventListener("touchmove",E,!1),window.addEventListener("keydown",w,!1),window.addEventListener("keyup",S,!1),this.handleResize(),this.update()};OrthographicTrackballControls.prototype=Object.create(EventDispatcher.prototype),OrthographicTrackballControls.prototype.constructor=OrthographicTrackballControls;var PointerLockControls=function(e,t){var r=this;this.domElement=t||document.body,this.isLocked=!1,e.rotation.set(0,0,0);var n=new Object3D;n.add(e);var i=new Object3D;i.position.y=10,i.add(n);var o=Math.PI/2;function a(e){if(!1!==r.isLocked){var t=e.movementX||e.mozMovementX||e.webkitMovementX||0,a=e.movementY||e.mozMovementY||e.webkitMovementY||0;i.rotation.y-=.002*t,n.rotation.x-=.002*a,n.rotation.x=Math.max(-o,Math.min(o,n.rotation.x))}}function s(){document.pointerLockElement===r.domElement?(r.dispatchEvent({type:"lock"}),r.isLocked=!0):(r.dispatchEvent({type:"unlock"}),r.isLocked=!1)}function l(){console.error("PointerLockControls: Unable to use Pointer Lock API")}this.connect=function(){document.addEventListener("mousemove",a,!1),document.addEventListener("pointerlockchange",s,!1),document.addEventListener("pointerlockerror",l,!1)},this.disconnect=function(){document.removeEventListener("mousemove",a,!1),document.removeEventListener("pointerlockchange",s,!1),document.removeEventListener("pointerlockerror",l,!1)},this.dispose=function(){this.disconnect()},this.getObject=function(){return i},this.getDirection=function(){var e=new Vector3(0,0,-1),t=new Euler(0,0,0,"YXZ");return function(r){return t.set(n.rotation.x,i.rotation.y,0),r.copy(e).applyEuler(t),r}}(),this.lock=function(){this.domElement.requestPointerLock()},this.unlock=function(){document.exitPointerLock()},this.connect()};PointerLockControls.prototype=Object.create(EventDispatcher.prototype),PointerLockControls.prototype.constructor=PointerLockControls;var TrackballControls=function(e,t){var r=this,n={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.target=new Vector3;var i=new Vector3,o=n.NONE,a=n.NONE,s=new Vector3,l=new Vector2,u=new Vector2,c=new Vector3,h=0,p=new Vector2,f=new Vector2,d=0,m=0,v=new Vector2,g=new Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone();var y={type:"change"},b={type:"start"},x={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}};var w=function(){var e=new Vector2;return function(t,n){return e.set((t-r.screen.left)/r.screen.width,(n-r.screen.top)/r.screen.height),e}}(),S=function(){var e=new Vector2;return function(t,n){return e.set((t-.5*r.screen.width-r.screen.left)/(.5*r.screen.width),(r.screen.height+2*(r.screen.top-n))/r.screen.width),e}}();function M(e){!1!==r.enabled&&(window.removeEventListener("keydown",M),a=o,o===n.NONE&&(e.keyCode!==r.keys[n.ROTATE]||r.noRotate?e.keyCode!==r.keys[n.ZOOM]||r.noZoom?e.keyCode!==r.keys[n.PAN]||r.noPan||(o=n.PAN):o=n.ZOOM:o=n.ROTATE))}function _(e){!1!==r.enabled&&(o=a,window.addEventListener("keydown",M,!1))}function T(e){!1!==r.enabled&&(e.preventDefault(),e.stopPropagation(),o===n.NONE&&(o=e.button),o!==n.ROTATE||r.noRotate?o!==n.ZOOM||r.noZoom?o!==n.PAN||r.noPan||(v.copy(w(e.pageX,e.pageY)),g.copy(v)):(p.copy(w(e.pageX,e.pageY)),f.copy(p)):(u.copy(S(e.pageX,e.pageY)),l.copy(u)),document.addEventListener("mousemove",A,!1),document.addEventListener("mouseup",C,!1),r.dispatchEvent(b))}function A(e){!1!==r.enabled&&(e.preventDefault(),e.stopPropagation(),o!==n.ROTATE||r.noRotate?o!==n.ZOOM||r.noZoom?o!==n.PAN||r.noPan||g.copy(w(e.pageX,e.pageY)):f.copy(w(e.pageX,e.pageY)):(l.copy(u),u.copy(S(e.pageX,e.pageY))))}function C(e){!1!==r.enabled&&(e.preventDefault(),e.stopPropagation(),o=n.NONE,document.removeEventListener("mousemove",A),document.removeEventListener("mouseup",C),r.dispatchEvent(x))}function E(e){if(!1!==r.enabled&&!0!==r.noZoom){switch(e.preventDefault(),e.stopPropagation(),e.deltaMode){case 2:p.y-=.025*e.deltaY;break;case 1:p.y-=.01*e.deltaY;break;default:p.y-=25e-5*e.deltaY}r.dispatchEvent(b),r.dispatchEvent(x)}}function L(e){if(!1!==r.enabled){switch(e.preventDefault(),e.touches.length){case 1:o=n.TOUCH_ROTATE,u.copy(S(e.touches[0].pageX,e.touches[0].pageY)),l.copy(u);break;default:o=n.TOUCH_ZOOM_PAN;var t=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY;m=d=Math.sqrt(t*t+i*i);var a=(e.touches[0].pageX+e.touches[1].pageX)/2,s=(e.touches[0].pageY+e.touches[1].pageY)/2;v.copy(w(a,s)),g.copy(v)}r.dispatchEvent(b)}}function N(e){if(!1!==r.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:l.copy(u),u.copy(S(e.touches[0].pageX,e.touches[0].pageY));break;default:var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY;m=Math.sqrt(t*t+n*n);var i=(e.touches[0].pageX+e.touches[1].pageX)/2,o=(e.touches[0].pageY+e.touches[1].pageY)/2;g.copy(w(i,o))}}function P(e){if(!1!==r.enabled){switch(e.touches.length){case 0:o=n.NONE;break;case 1:o=n.TOUCH_ROTATE,u.copy(S(e.touches[0].pageX,e.touches[0].pageY)),l.copy(u)}r.dispatchEvent(x)}}function O(e){!1!==r.enabled&&e.preventDefault()}this.rotateCamera=function(){var e,t=new Vector3,n=new Quaternion,i=new Vector3,o=new Vector3,a=new Vector3,p=new Vector3;return function(){p.set(u.x-l.x,u.y-l.y,0),(e=p.length())?(s.copy(r.object.position).sub(r.target),i.copy(s).normalize(),o.copy(r.object.up).normalize(),a.crossVectors(o,i).normalize(),o.setLength(u.y-l.y),a.setLength(u.x-l.x),p.copy(o.add(a)),t.crossVectors(p,s).normalize(),e*=r.rotateSpeed,n.setFromAxisAngle(t,e),s.applyQuaternion(n),r.object.up.applyQuaternion(n),c.copy(t),h=e):!r.staticMoving&&h&&(h*=Math.sqrt(1-r.dynamicDampingFactor),s.copy(r.object.position).sub(r.target),n.setFromAxisAngle(c,h),s.applyQuaternion(n),r.object.up.applyQuaternion(n)),l.copy(u)}}(),this.zoomCamera=function(){var e;o===n.TOUCH_ZOOM_PAN?(e=d/m,d=m,s.multiplyScalar(e)):(1!==(e=1+(f.y-p.y)*r.zoomSpeed)&&e>0&&s.multiplyScalar(e),r.staticMoving?p.copy(f):p.y+=(f.y-p.y)*this.dynamicDampingFactor)},this.panCamera=function(){var e=new Vector2,t=new Vector3,n=new Vector3;return function(){e.copy(g).sub(v),e.lengthSq()&&(e.multiplyScalar(s.length()*r.panSpeed),n.copy(s).cross(r.object.up).setLength(e.x),n.add(t.copy(r.object.up).setLength(e.y)),r.object.position.add(n),r.target.add(n),r.staticMoving?v.copy(g):v.add(e.subVectors(g,v).multiplyScalar(r.dynamicDampingFactor)))}}(),this.checkDistances=function(){r.noZoom&&r.noPan||(s.lengthSq()>r.maxDistance*r.maxDistance&&(r.object.position.addVectors(r.target,s.setLength(r.maxDistance)),p.copy(f)),s.lengthSq()<r.minDistance*r.minDistance&&(r.object.position.addVectors(r.target,s.setLength(r.minDistance)),p.copy(f)))},this.update=function(){s.subVectors(r.object.position,r.target),r.noRotate||r.rotateCamera(),r.noZoom||r.zoomCamera(),r.noPan||r.panCamera(),r.object.position.addVectors(r.target,s),r.checkDistances(),r.object.lookAt(r.target),i.distanceToSquared(r.object.position)>1e-6&&(r.dispatchEvent(y),i.copy(r.object.position))},this.reset=function(){o=n.NONE,a=n.NONE,r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.up.copy(r.up0),s.subVectors(r.object.position,r.target),r.object.lookAt(r.target),r.dispatchEvent(y),i.copy(r.object.position)},this.dispose=function(){this.domElement.removeEventListener("contextmenu",O,!1),this.domElement.removeEventListener("mousedown",T,!1),this.domElement.removeEventListener("wheel",E,!1),this.domElement.removeEventListener("touchstart",L,!1),this.domElement.removeEventListener("touchend",P,!1),this.domElement.removeEventListener("touchmove",N,!1),document.removeEventListener("mousemove",A,!1),document.removeEventListener("mouseup",C,!1),window.removeEventListener("keydown",M,!1),window.removeEventListener("keyup",_,!1)},this.domElement.addEventListener("contextmenu",O,!1),this.domElement.addEventListener("mousedown",T,!1),this.domElement.addEventListener("wheel",E,!1),this.domElement.addEventListener("touchstart",L,!1),this.domElement.addEventListener("touchend",P,!1),this.domElement.addEventListener("touchmove",N,!1),window.addEventListener("keydown",M,!1),window.addEventListener("keyup",_,!1),this.handleResize(),this.update()};function PolyhedronGeometry(e,t,r,n){Geometry.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:n},this.fromBufferGeometry(new PolyhedronBufferGeometry(e,t,r,n)),this.mergeVertices()}function PolyhedronBufferGeometry(e,t,r,n){BufferGeometry.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:n},r=r||1;var i=[],o=[];function a(e,t,r,n){var i,o,a=Math.pow(2,n),l=[];for(i=0;i<=a;i++){l[i]=[];var u=e.clone().lerp(r,i/a),c=t.clone().lerp(r,i/a),h=a-i;for(o=0;o<=h;o++)l[i][o]=0===o&&i===a?u:u.clone().lerp(c,o/h)}for(i=0;i<a;i++)for(o=0;o<2*(a-i)-1;o++){var p=Math.floor(o/2);o%2===0?(s(l[i][p+1]),s(l[i+1][p]),s(l[i][p])):(s(l[i][p+1]),s(l[i+1][p+1]),s(l[i+1][p]))}}function s(e){i.push(e.x,e.y,e.z)}function l(t,r){var n=3*t;r.x=e[n+0],r.y=e[n+1],r.z=e[n+2]}function u(e,t,r,n){n<0&&1===e.x&&(o[t]=e.x-1),0===r.x&&0===r.z&&(o[t]=n/2/Math.PI+.5)}function c(e){return Math.atan2(e.z,-e.x)}!function(e){for(var r=new Vector3,n=new Vector3,i=new Vector3,o=0;o<t.length;o+=3)l(t[o+0],r),l(t[o+1],n),l(t[o+2],i),a(r,n,i,e)}(n=n||0),function(e){for(var t=new Vector3,r=0;r<i.length;r+=3)t.x=i[r+0],t.y=i[r+1],t.z=i[r+2],t.normalize().multiplyScalar(e),i[r+0]=t.x,i[r+1]=t.y,i[r+2]=t.z}(r),function(){for(var e=new Vector3,t=0;t<i.length;t+=3){e.x=i[t+0],e.y=i[t+1],e.z=i[t+2];var r=c(e)/2/Math.PI+.5,n=(a=e,Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+.5);o.push(r,1-n)}var a;(function(){for(var e=new Vector3,t=new Vector3,r=new Vector3,n=new Vector3,a=new Vector2,s=new Vector2,l=new Vector2,h=0,p=0;h<i.length;h+=9,p+=6){e.set(i[h+0],i[h+1],i[h+2]),t.set(i[h+3],i[h+4],i[h+5]),r.set(i[h+6],i[h+7],i[h+8]),a.set(o[p+0],o[p+1]),s.set(o[p+2],o[p+3]),l.set(o[p+4],o[p+5]),n.copy(e).add(t).add(r).divideScalar(3);var f=c(n);u(a,p+0,e,f),u(s,p+2,t,f),u(l,p+4,r,f)}})(),function(){for(var e=0;e<o.length;e+=6){var t=o[e+0],r=o[e+2],n=o[e+4],i=Math.max(t,r,n),a=Math.min(t,r,n);i>.9&&a<.1&&(t<.2&&(o[e+0]+=1),r<.2&&(o[e+2]+=1),n<.2&&(o[e+4]+=1))}}()}(),this.addAttribute("position",new Float32BufferAttribute(i,3)),this.addAttribute("normal",new Float32BufferAttribute(i.slice(),3)),this.addAttribute("uv",new Float32BufferAttribute(o,2)),0===n?this.computeVertexNormals():this.normalizeNormals()}function OctahedronGeometry(e,t){Geometry.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new OctahedronBufferGeometry(e,t)),this.mergeVertices()}function OctahedronBufferGeometry(e,t){PolyhedronBufferGeometry.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function TorusGeometry(e,t,r,n,i){Geometry.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,arc:i},this.fromBufferGeometry(new TorusBufferGeometry(e,t,r,n,i)),this.mergeVertices()}function TorusBufferGeometry(e,t,r,n,i){BufferGeometry.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,arc:i},e=e||1,t=t||.4,r=Math.floor(r)||8,n=Math.floor(n)||6,i=i||2*Math.PI;var o,a,s=[],l=[],u=[],c=[],h=new Vector3,p=new Vector3,f=new Vector3;for(o=0;o<=r;o++)for(a=0;a<=n;a++){var d=a/n*i,m=o/r*Math.PI*2;p.x=(e+t*Math.cos(m))*Math.cos(d),p.y=(e+t*Math.cos(m))*Math.sin(d),p.z=t*Math.sin(m),l.push(p.x,p.y,p.z),h.x=e*Math.cos(d),h.y=e*Math.sin(d),f.subVectors(p,h).normalize(),u.push(f.x,f.y,f.z),c.push(a/n),c.push(o/r)}for(o=1;o<=r;o++)for(a=1;a<=n;a++){var v=(n+1)*o+a-1,g=(n+1)*(o-1)+a-1,y=(n+1)*(o-1)+a,b=(n+1)*o+a;s.push(v,g,b),s.push(g,y,b)}this.setIndex(s),this.addAttribute("position",new Float32BufferAttribute(l,3)),this.addAttribute("normal",new Float32BufferAttribute(u,3)),this.addAttribute("uv",new Float32BufferAttribute(c,2))}TrackballControls.prototype=Object.create(EventDispatcher.prototype),TrackballControls.prototype.constructor=TrackballControls,PolyhedronGeometry.prototype=Object.create(Geometry.prototype),PolyhedronGeometry.prototype.constructor=PolyhedronGeometry,PolyhedronBufferGeometry.prototype=Object.create(BufferGeometry.prototype),PolyhedronBufferGeometry.prototype.constructor=PolyhedronBufferGeometry,OctahedronGeometry.prototype=Object.create(Geometry.prototype),OctahedronGeometry.prototype.constructor=OctahedronGeometry,OctahedronBufferGeometry.prototype=Object.create(PolyhedronBufferGeometry.prototype),OctahedronBufferGeometry.prototype.constructor=OctahedronBufferGeometry,TorusGeometry.prototype=Object.create(Geometry.prototype),TorusGeometry.prototype.constructor=TorusGeometry,TorusBufferGeometry.prototype=Object.create(BufferGeometry.prototype),TorusBufferGeometry.prototype.constructor=TorusBufferGeometry;var TransformControls=function(e,t){Object3D.call(this),t=void 0!==t?t:document,this.visible=!1;var r=new TransformControlsGizmo;this.add(r);var n=new TransformControlsPlane;this.add(n);var i=this;B("camera",e),B("object",void 0),B("enabled",!0),B("axis",null),B("mode","translate"),B("translationSnap",null),B("rotationSnap",null),B("space","world"),B("size",1),B("dragging",!1),B("showX",!0),B("showY",!0),B("showZ",!0);var o={type:"change"},a={type:"mouseDown"},s={type:"mouseUp",mode:i.mode},l={type:"objectChange"},u=new Raycaster,c=new Vector3,h=new Quaternion,p={X:new Vector3(1,0,0),Y:new Vector3(0,1,0),Z:new Vector3(0,0,1)},f=new Vector3,d=new Vector3,m=new Vector3,v=new Vector3,g=new Vector3,y=new Vector3,b=0,x=new Vector3,w=new Quaternion,S=new Vector3,M=new Vector3,_=new Quaternion,T=new Quaternion,A=new Vector3,C=new Vector3,E=new Quaternion,L=new Vector3,N=new Vector3,P=new Quaternion,O=new Quaternion,R=new Vector3,D=new Vector3,F=new Vector3,k=new Quaternion,I=new Vector3;function B(e,t){var a=t;Object.defineProperty(i,e,{get:function(){return void 0!==a?a:t},set:function(t){a!==t&&(a=t,n[e]=t,r[e]=t,i.dispatchEvent({type:e+"-changed",value:t}),i.dispatchEvent(o))}}),i[e]=t,n[e]=t,r[e]=t}function U(e){var r=e.changedTouches?e.changedTouches[0]:e,n=t.getBoundingClientRect();return{x:(r.clientX-n.left)/n.width*2-1,y:-(r.clientY-n.top)/n.height*2+1,button:e.button}}function V(e){i.enabled&&i.pointerHover(U(e))}function j(e){i.enabled&&(document.addEventListener("mousemove",z,!1),i.pointerHover(U(e)),i.pointerDown(U(e)))}function z(e){i.enabled&&i.pointerMove(U(e))}function G(e){i.enabled&&(document.removeEventListener("mousemove",z,!1),i.pointerUp(U(e)))}B("worldPosition",N),B("worldPositionStart",C),B("worldQuaternion",P),B("worldQuaternionStart",E),B("cameraPosition",x),B("cameraQuaternion",w),B("pointStart",f),B("pointEnd",d),B("rotationAxis",v),B("rotationAngle",b),B("eye",D),t.addEventListener("mousedown",j,!1),t.addEventListener("touchstart",j,!1),t.addEventListener("mousemove",V,!1),t.addEventListener("touchmove",V,!1),t.addEventListener("touchmove",z,!1),document.addEventListener("mouseup",G,!1),t.addEventListener("touchend",G,!1),t.addEventListener("touchcancel",G,!1),t.addEventListener("touchleave",G,!1),this.dispose=function(){t.removeEventListener("mousedown",j),t.removeEventListener("touchstart",j),t.removeEventListener("mousemove",V),t.removeEventListener("touchmove",V),t.removeEventListener("touchmove",z),document.removeEventListener("mouseup",G),t.removeEventListener("touchend",G),t.removeEventListener("touchcancel",G),t.removeEventListener("touchleave",G)},this.attach=function(e){this.object=e,this.visible=!0},this.detach=function(){this.object=void 0,this.visible=!1,this.axis=null},this.updateMatrixWorld=function(){void 0!==this.object&&(this.object.updateMatrixWorld(),this.object.parent.matrixWorld.decompose(M,_,A),this.object.matrixWorld.decompose(N,P,R),T.copy(_).inverse(),O.copy(P).inverse()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(x,w,S),this.camera instanceof PerspectiveCamera?D.copy(x).sub(N).normalize():this.camera instanceof OrthographicCamera&&D.copy(x).normalize(),Object3D.prototype.updateMatrixWorld.call(this)},this.pointerHover=function(e){if(void 0!==this.object&&!0!==this.dragging&&(void 0===e.button||0===e.button)){u.setFromCamera(e,this.camera);var t=u.intersectObjects(r.picker[this.mode].children,!0)[0]||!1;this.axis=t?t.object.name:null}},this.pointerDown=function(e){if(void 0!==this.object&&!0!==this.dragging&&(void 0===e.button||0===e.button)&&(0===e.button||void 0===e.button)&&null!==this.axis){u.setFromCamera(e,this.camera);var t=u.intersectObjects([n],!0)[0]||!1;if(t){var r=this.space;if("scale"===this.mode?r="local":"E"!==this.axis&&"XYZE"!==this.axis&&"XYZ"!==this.axis||(r="world"),"local"===r&&"rotate"===this.mode){var i=this.rotationSnap;"X"===this.axis&&i&&(this.object.rotation.x=Math.round(this.object.rotation.x/i)*i),"Y"===this.axis&&i&&(this.object.rotation.y=Math.round(this.object.rotation.y/i)*i),"Z"===this.axis&&i&&(this.object.rotation.z=Math.round(this.object.rotation.z/i)*i)}this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),F.copy(this.object.position),k.copy(this.object.quaternion),I.copy(this.object.scale),this.object.matrixWorld.decompose(C,E,L),f.copy(t.point).sub(C)}this.dragging=!0,a.mode=this.mode,this.dispatchEvent(a)}},this.pointerMove=function(e){var t=this.axis,r=this.mode,i=this.object,a=this.space;if("scale"===r?a="local":"E"!==t&&"XYZE"!==t&&"XYZ"!==t||(a="world"),void 0!==i&&null!==t&&!1!==this.dragging&&(void 0===e.button||0===e.button)){u.setFromCamera(e,this.camera);var s=u.intersectObjects([n],!0)[0]||!1;if(!1!==s){if(d.copy(s.point).sub(C),"translate"===r)m.copy(d).sub(f),"local"===a&&"XYZ"!==t&&m.applyQuaternion(O),-1===t.indexOf("X")&&(m.x=0),-1===t.indexOf("Y")&&(m.y=0),-1===t.indexOf("Z")&&(m.z=0),"local"===a&&"XYZ"!==t?m.applyQuaternion(k).divide(A):m.applyQuaternion(T).divide(A),i.position.copy(m).add(F),this.translationSnap&&("local"===a&&(i.position.applyQuaternion(h.copy(k).inverse()),-1!==t.search("X")&&(i.position.x=Math.round(i.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(i.position.y=Math.round(i.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(i.position.z=Math.round(i.position.z/this.translationSnap)*this.translationSnap),i.position.applyQuaternion(k)),"world"===a&&(i.parent&&i.position.add(c.setFromMatrixPosition(i.parent.matrixWorld)),-1!==t.search("X")&&(i.position.x=Math.round(i.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(i.position.y=Math.round(i.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(i.position.z=Math.round(i.position.z/this.translationSnap)*this.translationSnap),i.parent&&i.position.sub(c.setFromMatrixPosition(i.parent.matrixWorld))));else if("scale"===r){if(-1!==t.search("XYZ")){var x=d.length()/f.length();d.dot(f)<0&&(x*=-1),c.set(x,x,x)}else c.copy(d).divide(f),-1===t.search("X")&&(c.x=1),-1===t.search("Y")&&(c.y=1),-1===t.search("Z")&&(c.z=1);i.scale.copy(I).multiply(c)}else if("rotate"===r){m.copy(d).sub(f);var w=20/N.distanceTo(c.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(v.copy(D),b=d.angleTo(f),g.copy(f).normalize(),y.copy(d).normalize(),b*=y.cross(g).dot(D)<0?1:-1):"XYZE"===t?(v.copy(m).cross(D).normalize(),b=m.dot(c.copy(v).cross(this.eye))*w):"X"!==t&&"Y"!==t&&"Z"!==t||(v.copy(p[t]),c.copy(p[t]),"local"===a&&c.applyQuaternion(P),b=m.dot(c.cross(D).normalize())*w),this.rotationSnap&&(b=Math.round(b/this.rotationSnap)*this.rotationSnap),this.rotationAngle=b,"local"===a&&"E"!==t&&"XYZE"!==t?(i.quaternion.copy(k),i.quaternion.multiply(h.setFromAxisAngle(v,b)).normalize()):(v.applyQuaternion(T),i.quaternion.copy(h.setFromAxisAngle(v,b)),i.quaternion.multiply(k).normalize())}this.dispatchEvent(o),this.dispatchEvent(l)}}},this.pointerUp=function(e){void 0!==e.button&&0!==e.button||(this.dragging&&null!==this.axis&&(s.mode=this.mode,this.dispatchEvent(s)),this.dragging=!1,void 0===e.button&&(this.axis=null))},this.getMode=function(){return i.mode},this.setMode=function(e){i.mode=e},this.setTranslationSnap=function(e){i.translationSnap=e},this.setRotationSnap=function(e){i.rotationSnap=e},this.setSize=function(e){i.size=e},this.setSpace=function(e){i.space=e},this.update=function(){console.warn("TransformControls: update function has been depricated.")}};TransformControls.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:TransformControls,isTransformControls:!0});var TransformControlsGizmo=function(){Object3D.call(this),this.type="TransformControlsGizmo";var e=new MeshBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,side:DoubleSide,fog:!1}),t=new LineBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,linewidth:1,fog:!1}),r=e.clone();r.opacity=.15;var n=e.clone();n.opacity=.33;var i=e.clone();i.color.set(16711680);var o=e.clone();o.color.set(65280);var a=e.clone();a.color.set(255);var s=e.clone();s.opacity=.25;var l=s.clone();l.color.set(16776960);var u=s.clone();u.color.set(65535);var c=s.clone();c.color.set(16711935),e.clone().color.set(16776960);var h=t.clone();h.color.set(16711680);var p=t.clone();p.color.set(65280);var f=t.clone();f.color.set(255);var d=t.clone();d.color.set(65535);var m=t.clone();m.color.set(16711935);var v=t.clone();v.color.set(16776960);var g=t.clone();g.color.set(7895160);var y=v.clone();y.opacity=.25;var b=new CylinderBufferGeometry(0,.05,.2,12,1,!1),x=new BoxBufferGeometry(.125,.125,.125),w=new BufferGeometry;w.addAttribute("position",new Float32BufferAttribute([0,0,0,1,0,0],3));var S=function(e,t){for(var r=new BufferGeometry,n=[],i=0;i<=64*t;++i)n.push(0,Math.cos(i/32*Math.PI)*e,Math.sin(i/32*Math.PI)*e);return r.addAttribute("position",new Float32BufferAttribute(n,3)),r},M={X:[[new Mesh(b,i),[1,0,0],[0,0,-Math.PI/2],null,"fwd"],[new Mesh(b,i),[1,0,0],[0,0,Math.PI/2],null,"bwd"],[new Line(w,h)]],Y:[[new Mesh(b,o),[0,1,0],null,null,"fwd"],[new Mesh(b,o),[0,1,0],[Math.PI,0,0],null,"bwd"],[new Line(w,p),null,[0,0,Math.PI/2]]],Z:[[new Mesh(b,a),[0,0,1],[Math.PI/2,0,0],null,"fwd"],[new Mesh(b,a),[0,0,1],[-Math.PI/2,0,0],null,"bwd"],[new Line(w,f),null,[0,-Math.PI/2,0]]],XYZ:[[new Mesh(new OctahedronBufferGeometry(.1,0),s),[0,0,0],[0,0,0]]],XY:[[new Mesh(new PlaneBufferGeometry(.295,.295),l),[.15,.15,0]],[new Line(w,v),[.18,.3,0],null,[.125,1,1]],[new Line(w,v),[.3,.18,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new Mesh(new PlaneBufferGeometry(.295,.295),u),[0,.15,.15],[0,Math.PI/2,0]],[new Line(w,d),[0,.18,.3],[0,0,Math.PI/2],[.125,1,1]],[new Line(w,d),[0,.3,.18],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new Mesh(new PlaneBufferGeometry(.295,.295),c),[.15,0,.15],[-Math.PI/2,0,0]],[new Line(w,m),[.18,0,.3],null,[.125,1,1]],[new Line(w,m),[.3,0,.18],[0,-Math.PI/2,0],[.125,1,1]]]},_={X:[[new Mesh(new CylinderBufferGeometry(.2,0,1,4,1,!1),r),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new Mesh(new CylinderBufferGeometry(.2,0,1,4,1,!1),r),[0,.6,0]]],Z:[[new Mesh(new CylinderBufferGeometry(.2,0,1,4,1,!1),r),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new Mesh(new OctahedronBufferGeometry(.2,0),r)]],XY:[[new Mesh(new PlaneBufferGeometry(.4,.4),r),[.2,.2,0]]],YZ:[[new Mesh(new PlaneBufferGeometry(.4,.4),r),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new Mesh(new PlaneBufferGeometry(.4,.4),r),[.2,0,.2],[-Math.PI/2,0,0]]]},T={START:[[new Mesh(new OctahedronBufferGeometry(.01,2),n),null,null,null,"helper"]],END:[[new Mesh(new OctahedronBufferGeometry(.01,2),n),null,null,null,"helper"]],DELTA:[[new Line(function(e,t){var r=new BufferGeometry;return r.addAttribute("position",new Float32BufferAttribute([0,0,0,1,1,1],3)),r}(),n),null,null,null,"helper"]],X:[[new Line(w,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Line(w,n.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Line(w,n.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},A={X:[[new Line(S(1,.5),h)],[new Mesh(new OctahedronBufferGeometry(.04,0),i),[0,0,.99],null,[1,3,1]]],Y:[[new Line(S(1,.5),p),null,[0,0,-Math.PI/2]],[new Mesh(new OctahedronBufferGeometry(.04,0),o),[0,0,.99],null,[3,1,1]]],Z:[[new Line(S(1,.5),f),null,[0,Math.PI/2,0]],[new Mesh(new OctahedronBufferGeometry(.04,0),a),[.99,0,0],null,[1,3,1]]],E:[[new Line(S(1.25,1),y),null,[0,Math.PI/2,0]],[new Mesh(new CylinderBufferGeometry(.03,0,.15,4,1,!1),y),[1.17,0,0],[0,0,-Math.PI/2],[1,1,.001]],[new Mesh(new CylinderBufferGeometry(.03,0,.15,4,1,!1),y),[-1.17,0,0],[0,0,Math.PI/2],[1,1,.001]],[new Mesh(new CylinderBufferGeometry(.03,0,.15,4,1,!1),y),[0,-1.17,0],[Math.PI,0,0],[1,1,.001]],[new Mesh(new CylinderBufferGeometry(.03,0,.15,4,1,!1),y),[0,1.17,0],[0,0,0],[1,1,.001]]],XYZE:[[new Line(S(1,1),g),null,[0,Math.PI/2,0]]]},C={AXIS:[[new Line(w,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},E={X:[[new Mesh(new TorusBufferGeometry(1,.1,4,24),r),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new Mesh(new TorusBufferGeometry(1,.1,4,24),r),[0,0,0],[Math.PI/2,0,0]]],Z:[[new Mesh(new TorusBufferGeometry(1,.1,4,24),r),[0,0,0],[0,0,-Math.PI/2]]],E:[[new Mesh(new TorusBufferGeometry(1.25,.1,2,24),r)]],XYZE:[[new Mesh(new SphereBufferGeometry(.7,10,8),r)]]},L={X:[[new Mesh(x,i),[.8,0,0],[0,0,-Math.PI/2]],[new Line(w,h),null,null,[.8,1,1]]],Y:[[new Mesh(x,o),[0,.8,0]],[new Line(w,p),null,[0,0,Math.PI/2],[.8,1,1]]],Z:[[new Mesh(x,a),[0,0,.8],[Math.PI/2,0,0]],[new Line(w,f),null,[0,-Math.PI/2,0],[.8,1,1]]],XY:[[new Mesh(x,l),[.85,.85,0],null,[2,2,.2]],[new Line(w,v),[.855,.98,0],null,[.125,1,1]],[new Line(w,v),[.98,.855,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new Mesh(x,u),[0,.85,.85],null,[.2,2,2]],[new Line(w,d),[0,.855,.98],[0,0,Math.PI/2],[.125,1,1]],[new Line(w,d),[0,.98,.855],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new Mesh(x,c),[.85,0,.85],null,[2,.2,2]],[new Line(w,m),[.855,0,.98],null,[.125,1,1]],[new Line(w,m),[.98,0,.855],[0,-Math.PI/2,0],[.125,1,1]]],XYZX:[[new Mesh(new BoxBufferGeometry(.125,.125,.125),s),[1.1,0,0]]],XYZY:[[new Mesh(new BoxBufferGeometry(.125,.125,.125),s),[0,1.1,0]]],XYZZ:[[new Mesh(new BoxBufferGeometry(.125,.125,.125),s),[0,0,1.1]]]},N={X:[[new Mesh(new CylinderBufferGeometry(.2,0,.8,4,1,!1),r),[.5,0,0],[0,0,-Math.PI/2]]],Y:[[new Mesh(new CylinderBufferGeometry(.2,0,.8,4,1,!1),r),[0,.5,0]]],Z:[[new Mesh(new CylinderBufferGeometry(.2,0,.8,4,1,!1),r),[0,0,.5],[Math.PI/2,0,0]]],XY:[[new Mesh(x,r),[.85,.85,0],null,[3,3,.2]]],YZ:[[new Mesh(x,r),[0,.85,.85],null,[.2,3,3]]],XZ:[[new Mesh(x,r),[.85,0,.85],null,[3,.2,3]]],XYZX:[[new Mesh(new BoxBufferGeometry(.2,.2,.2),r),[1.1,0,0]]],XYZY:[[new Mesh(new BoxBufferGeometry(.2,.2,.2),r),[0,1.1,0]]],XYZZ:[[new Mesh(new BoxBufferGeometry(.2,.2,.2),r),[0,0,1.1]]]},P={X:[[new Line(w,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Line(w,n.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Line(w,n.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},O=function(e){var t=new Object3D;for(var r in e)for(var n=e[r].length;n--;){var i=e[r][n][0].clone(),o=e[r][n][1],a=e[r][n][2],s=e[r][n][3],l=e[r][n][4];i.name=r,i.tag=l,o&&i.position.set(o[0],o[1],o[2]),a&&i.rotation.set(a[0],a[1],a[2]),s&&i.scale.set(s[0],s[1],s[2]),i.updateMatrix();var u=i.geometry.clone();u.applyMatrix(i.matrix),i.geometry=u,i.position.set(0,0,0),i.rotation.set(0,0,0),i.scale.set(1,1,1),t.add(i)}return t},R=new Vector3(0,0,0),D=new Euler,F=new Vector3(0,1,0),k=new Vector3(0,0,0),I=new Matrix4,B=new Quaternion,U=new Quaternion,V=new Quaternion,j=new Vector3(1,0,0),z=new Vector3(0,1,0),G=new Vector3(0,0,1);this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=O(M)),this.add(this.gizmo.rotate=O(A)),this.add(this.gizmo.scale=O(L)),this.add(this.picker.translate=O(_)),this.add(this.picker.rotate=O(E)),this.add(this.picker.scale=O(N)),this.add(this.helper.translate=O(T)),this.add(this.helper.rotate=O(C)),this.add(this.helper.scale=O(P)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1,this.updateMatrixWorld=function(){var e=this.space;"scale"===this.mode&&(e="local");var t="local"===e?this.worldQuaternion:V;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;var r=[];r=(r=(r=r.concat(this.picker[this.mode].children)).concat(this.gizmo[this.mode].children)).concat(this.helper[this.mode].children);for(var n=0;n<r.length;n++){var i=r[n];i.visible=!0,i.rotation.set(0,0,0),i.position.copy(this.worldPosition);var o=this.worldPosition.distanceTo(this.cameraPosition);if(i.scale.set(1,1,1).multiplyScalar(o*this.size/7),"helper"!==i.tag){if(i.quaternion.copy(t),"translate"===this.mode||"scale"===this.mode){"X"!==i.name&&"XYZX"!==i.name||Math.abs(F.copy(j).applyQuaternion(t).dot(this.eye))>.99&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),"Y"!==i.name&&"XYZY"!==i.name||Math.abs(F.copy(z).applyQuaternion(t).dot(this.eye))>.99&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),"Z"!==i.name&&"XYZZ"!==i.name||Math.abs(F.copy(G).applyQuaternion(t).dot(this.eye))>.99&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),"XY"===i.name&&Math.abs(F.copy(G).applyQuaternion(t).dot(this.eye))<.2&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),"YZ"===i.name&&Math.abs(F.copy(j).applyQuaternion(t).dot(this.eye))<.2&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),"XZ"===i.name&&Math.abs(F.copy(z).applyQuaternion(t).dot(this.eye))<.2&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),-1!==i.name.search("X")&&(F.copy(j).applyQuaternion(t).dot(this.eye)<-.4?"fwd"===i.tag?i.visible=!1:i.scale.x*=-1:"bwd"===i.tag&&(i.visible=!1)),-1!==i.name.search("Y")&&(F.copy(z).applyQuaternion(t).dot(this.eye)<-.4?"fwd"===i.tag?i.visible=!1:i.scale.y*=-1:"bwd"===i.tag&&(i.visible=!1)),-1!==i.name.search("Z")&&(F.copy(G).applyQuaternion(t).dot(this.eye)<-.4?"fwd"===i.tag?i.visible=!1:i.scale.z*=-1:"bwd"===i.tag&&(i.visible=!1))}else"rotate"===this.mode&&(U.copy(t),F.copy(this.eye).applyQuaternion(B.copy(t).inverse()),-1!==i.name.search("E")&&i.quaternion.setFromRotationMatrix(I.lookAt(this.eye,k,z)),"X"===i.name&&(B.setFromAxisAngle(j,Math.atan2(-F.y,F.z)),B.multiplyQuaternions(U,B),i.quaternion.copy(B)),"Y"===i.name&&(B.setFromAxisAngle(z,Math.atan2(F.x,F.z)),B.multiplyQuaternions(U,B),i.quaternion.copy(B)),"Z"===i.name&&(B.setFromAxisAngle(G,Math.atan2(F.y,F.x)),B.multiplyQuaternions(U,B),i.quaternion.copy(B)));i.visible=i.visible&&(-1===i.name.indexOf("X")||this.showX),i.visible=i.visible&&(-1===i.name.indexOf("Y")||this.showY),i.visible=i.visible&&(-1===i.name.indexOf("Z")||this.showZ),i.visible=i.visible&&(-1===i.name.indexOf("E")||this.showX&&this.showY&&this.showZ),i.material._opacity=i.material._opacity||i.material.opacity,i.material._color=i.material._color||i.material.color.clone(),i.material.color.copy(i.material._color),i.material.opacity=i.material._opacity,this.enabled?this.axis&&(i.name===this.axis?(i.material.opacity=1,i.material.color.lerp(new Color(1,1,1),.5)):this.axis.split("").some(function(e){return i.name===e})?(i.material.opacity=1,i.material.color.lerp(new Color(1,1,1),.5)):(i.material.opacity*=.25,i.material.color.lerp(new Color(1,1,1),.5))):(i.material.opacity*=.5,i.material.color.lerp(new Color(1,1,1),.5))}else i.visible=!1,"AXIS"===i.name?(i.position.copy(this.worldPositionStart),i.visible=!!this.axis,"X"===this.axis&&(B.setFromEuler(D.set(0,0,0)),i.quaternion.copy(t).multiply(B),Math.abs(F.copy(j).applyQuaternion(t).dot(this.eye))>.9&&(i.visible=!1)),"Y"===this.axis&&(B.setFromEuler(D.set(0,0,Math.PI/2)),i.quaternion.copy(t).multiply(B),Math.abs(F.copy(z).applyQuaternion(t).dot(this.eye))>.9&&(i.visible=!1)),"Z"===this.axis&&(B.setFromEuler(D.set(0,Math.PI/2,0)),i.quaternion.copy(t).multiply(B),Math.abs(F.copy(G).applyQuaternion(t).dot(this.eye))>.9&&(i.visible=!1)),"XYZE"===this.axis&&(B.setFromEuler(D.set(0,Math.PI/2,0)),F.copy(this.rotationAxis),i.quaternion.setFromRotationMatrix(I.lookAt(k,F,z)),i.quaternion.multiply(B),i.visible=this.dragging),"E"===this.axis&&(i.visible=!1)):"START"===i.name?(i.position.copy(this.worldPositionStart),i.visible=this.dragging):"END"===i.name?(i.position.copy(this.worldPosition),i.visible=this.dragging):"DELTA"===i.name?(i.position.copy(this.worldPositionStart),i.quaternion.copy(this.worldQuaternionStart),R.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),R.applyQuaternion(this.worldQuaternionStart.clone().inverse()),i.scale.copy(R),i.visible=this.dragging):(i.quaternion.copy(t),this.dragging?i.position.copy(this.worldPositionStart):i.position.copy(this.worldPosition),this.axis&&(i.visible=-1!==this.axis.search(i.name)))}Object3D.prototype.updateMatrixWorld.call(this)}};TransformControlsGizmo.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:TransformControlsGizmo,isTransformControlsGizmo:!0});var TransformControlsPlane=function(){Mesh.call(this,new PlaneBufferGeometry(1e5,1e5,2,2),new MeshBasicMaterial({visible:!1,wireframe:!0,side:DoubleSide,transparent:!0,opacity:.1})),this.type="TransformControlsPlane";var e=new Vector3(1,0,0),t=new Vector3(0,1,0),r=new Vector3(0,0,1),n=new Vector3,i=new Vector3,o=new Vector3,a=new Matrix4,s=new Quaternion;this.updateMatrixWorld=function(){var l=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(l="local"),e.set(1,0,0).applyQuaternion("local"===l?this.worldQuaternion:s),t.set(0,1,0).applyQuaternion("local"===l?this.worldQuaternion:s),r.set(0,0,1).applyQuaternion("local"===l?this.worldQuaternion:s),o.copy(t),this.mode){case"translate":case"scale":switch(this.axis){case"X":o.copy(this.eye).cross(e),i.copy(e).cross(o);break;case"Y":o.copy(this.eye).cross(t),i.copy(t).cross(o);break;case"Z":o.copy(this.eye).cross(r),i.copy(r).cross(o);break;case"XY":i.copy(r);break;case"YZ":i.copy(e);break;case"XZ":o.copy(r),i.copy(t);break;case"XYZ":case"E":i.set(0,0,0)}break;case"rotate":default:i.set(0,0,0)}0===i.length()?this.quaternion.copy(this.cameraQuaternion):(a.lookAt(n.set(0,0,0),i,o),this.quaternion.setFromRotationMatrix(a)),Object3D.prototype.updateMatrixWorld.call(this)}};function Line3(e,t){this.start=void 0!==e?e:new Vector3,this.end=void 0!==t?t:new Vector3}TransformControlsPlane.prototype=Object.assign(Object.create(Mesh.prototype),{constructor:TransformControlsPlane,isTransformControlsPlane:!0}),Object.assign(Line3.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return void 0===e&&(console.warn("Line3: .getCenter() target is now required"),e=new Vector3),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return void 0===e&&(console.warn("Line3: .delta() target is now required"),e=new Vector3),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return void 0===t&&(console.warn("Line3: .at() target is now required"),t=new Vector3),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(){var e=new Vector3,t=new Vector3;return function(r,n){e.subVectors(r,this.start),t.subVectors(this.end,this.start);var i=t.dot(t),o=t.dot(e)/i;return n&&(o=_Math.clamp(o,0,1)),o}}(),closestPointToPoint:function(e,t,r){var n=this.closestPointToPointParameter(e,t);return void 0===r&&(console.warn("Line3: .closestPointToPoint() target is now required"),r=new Vector3),this.delta(r).multiplyScalar(n).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}});var Visible=0,Deleted=1;function QuickHull(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new VertexList,this.unassigned=new VertexList,this.vertices=[]}function Face(){this.normal=new Vector3,this.midpoint=new Vector3,this.area=0,this.constant=0,this.outside=null,this.mark=Visible,this.edge=null}function HalfEdge(e,t){this.vertex=e,this.prev=null,this.next=null,this.twin=null,this.face=t}function VertexNode(e){this.point=e,this.prev=null,this.next=null,this.face=null}function VertexList(){this.head=null,this.tail=null}function ConvexGeometry(e){Geometry.call(this),this.fromBufferGeometry(new ConvexBufferGeometry(e)),this.mergeVertices()}function ConvexBufferGeometry(e){BufferGeometry.call(this);var t=[],r=[];void 0===QuickHull&&console.error("ConvexBufferGeometry: ConvexBufferGeometry relies on QuickHull");for(var n=(new QuickHull).setFromPoints(e).faces,i=0;i<n.length;i++){var o=n[i],a=o.edge;do{var s=a.head().point;t.push(s.x,s.y,s.z),r.push(o.normal.x,o.normal.y,o.normal.z),a=a.next}while(a!==o.edge)}this.addAttribute("position",new Float32BufferAttribute(t,3)),this.addAttribute("normal",new Float32BufferAttribute(r,3))}Object.assign(QuickHull.prototype,{setFromPoints:function(e){!0!==Array.isArray(e)&&console.error("QuickHull: Points parameter is not an array."),e.length<4&&console.error("QuickHull: The algorithm needs at least four points."),this.makeEmpty();for(var t=0,r=e.length;t<r;t++)this.vertices.push(new VertexNode(e[t]));return this.compute(),this},setFromObject:function(e){var t=[];return e.updateMatrixWorld(!0),e.traverse(function(e){var r,n,i,o=e.geometry;if(void 0!==o)if(o.isGeometry){var a=o.vertices;for(r=0,n=a.length;r<n;r++)(i=a[r].clone()).applyMatrix4(e.matrixWorld),t.push(i)}else if(o.isBufferGeometry){var s=o.attributes.position;if(void 0!==s)for(r=0,n=s.count;r<n;r++)(i=new Vector3).fromBufferAttribute(s,r).applyMatrix4(e.matrixWorld),t.push(i)}}),this.setFromPoints(t)},makeEmpty:function(){return this.faces=[],this.vertices=[],this},addVertexToFace:function(e,t){return e.face=t,null===t.outside?this.assigned.append(e):this.assigned.insertBefore(t.outside,e),t.outside=e,this},removeVertexFromFace:function(e,t){return e===t.outside&&(null!==e.next&&e.next.face===t?t.outside=e.next:t.outside=null),this.assigned.remove(e),this},removeAllVerticesFromFace:function(e){if(null!==e.outside){for(var t=e.outside,r=e.outside;null!==r.next&&r.next.face===e;)r=r.next;return this.assigned.removeSubList(t,r),t.prev=r.next=null,e.outside=null,t}},deleteFaceVertices:function(e,t){var r=this.removeAllVerticesFromFace(e);if(void 0!==r)if(void 0===t)this.unassigned.appendChain(r);else{var n=r;do{var i=n.next;t.distanceToPoint(n.point)>this.tolerance?this.addVertexToFace(n,t):this.unassigned.append(n),n=i}while(null!==n)}return this},resolveUnassignedPoints:function(e){if(!1===this.unassigned.isEmpty()){var t=this.unassigned.first();do{for(var r=t.next,n=this.tolerance,i=null,o=0;o<e.length;o++){var a=e[o];if(a.mark===Visible){var s=a.distanceToPoint(t.point);if(s>n&&(n=s,i=a),n>1e3*this.tolerance)break}}null!==i&&this.addVertexToFace(t,i),t=r}while(null!==t)}return this},computeExtremes:function(){var e,t,r,n=new Vector3,i=new Vector3,o=[],a=[];for(e=0;e<3;e++)o[e]=a[e]=this.vertices[0];for(n.copy(this.vertices[0].point),i.copy(this.vertices[0].point),e=0,t=this.vertices.length;e<t;e++){var s=this.vertices[e],l=s.point;for(r=0;r<3;r++)l.getComponent(r)<n.getComponent(r)&&(n.setComponent(r,l.getComponent(r)),o[r]=s);for(r=0;r<3;r++)l.getComponent(r)>i.getComponent(r)&&(i.setComponent(r,l.getComponent(r)),a[r]=s)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(n.x),Math.abs(i.x))+Math.max(Math.abs(n.y),Math.abs(i.y))+Math.max(Math.abs(n.z),Math.abs(i.z))),{min:o,max:a}},computeInitialHull:function(){var e,t,r;return function(){void 0===e&&(e=new Line3,t=new Plane,r=new Vector3);var n,i,o,a,s,l,u,c,h,p=this.vertices,f=this.computeExtremes(),d=f.min,m=f.max,v=0,g=0;for(l=0;l<3;l++)(h=m[l].point.getComponent(l)-d[l].point.getComponent(l))>v&&(v=h,g=l);for(i=d[g],o=m[g],v=0,e.set(i.point,o.point),l=0,u=this.vertices.length;l<u;l++)(n=p[l])!==i&&n!==o&&(e.closestPointToPoint(n.point,!0,r),(h=r.distanceToSquared(n.point))>v&&(v=h,a=n));for(v=-1,t.setFromCoplanarPoints(i.point,o.point,a.point),l=0,u=this.vertices.length;l<u;l++)(n=p[l])!==i&&n!==o&&n!==a&&(h=Math.abs(t.distanceToPoint(n.point)))>v&&(v=h,s=n);var y=[];if(t.distanceToPoint(s.point)<0)for(y.push(Face.create(i,o,a),Face.create(s,o,i),Face.create(s,a,o),Face.create(s,i,a)),l=0;l<3;l++)c=(l+1)%3,y[l+1].getEdge(2).setTwin(y[0].getEdge(c)),y[l+1].getEdge(1).setTwin(y[c+1].getEdge(0));else for(y.push(Face.create(i,a,o),Face.create(s,i,o),Face.create(s,o,a),Face.create(s,a,i)),l=0;l<3;l++)c=(l+1)%3,y[l+1].getEdge(2).setTwin(y[0].getEdge((3-l)%3)),y[l+1].getEdge(0).setTwin(y[c+1].getEdge(1));for(l=0;l<4;l++)this.faces.push(y[l]);for(l=0,u=p.length;l<u;l++)if((n=p[l])!==i&&n!==o&&n!==a&&n!==s){v=this.tolerance;var b=null;for(c=0;c<4;c++)(h=this.faces[c].distanceToPoint(n.point))>v&&(v=h,b=this.faces[c]);null!==b&&this.addVertexToFace(n,b)}return this}}(),reindexFaces:function(){for(var e=[],t=0;t<this.faces.length;t++){var r=this.faces[t];r.mark===Visible&&e.push(r)}return this.faces=e,this},nextVertexToAdd:function(){if(!1===this.assigned.isEmpty()){var e,t=0,r=this.assigned.first().face,n=r.outside;do{var i=r.distanceToPoint(n.point);i>t&&(t=i,e=n),n=n.next}while(null!==n&&n.face===r);return e}},computeHorizon:function(e,t,r,n){var i;this.deleteFaceVertices(r),r.mark=Deleted,i=null===t?t=r.getEdge(0):t.next;do{var o=i.twin,a=o.face;a.mark===Visible&&(a.distanceToPoint(e)>this.tolerance?this.computeHorizon(e,o,a,n):n.push(i)),i=i.next}while(i!==t);return this},addAdjoiningFace:function(e,t){var r=Face.create(e,t.tail(),t.head());return this.faces.push(r),r.getEdge(-1).setTwin(t.twin),r.getEdge(0)},addNewFaces:function(e,t){this.newFaces=[];for(var r=null,n=null,i=0;i<t.length;i++){var o=t[i],a=this.addAdjoiningFace(e,o);null===r?r=a:a.next.setTwin(n),this.newFaces.push(a.face),n=a}return r.next.setTwin(n),this},addVertexToHull:function(e){var t=[];return this.unassigned.clear(),this.removeVertexFromFace(e,e.face),this.computeHorizon(e.point,null,e.face,t),this.addNewFaces(e,t),this.resolveUnassignedPoints(this.newFaces),this},cleanup:function(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this},compute:function(){var e;for(this.computeInitialHull();void 0!==(e=this.nextVertexToAdd());)this.addVertexToHull(e);return this.reindexFaces(),this.cleanup(),this}}),Object.assign(Face,{create:function(e,t,r){var n=new Face,i=new HalfEdge(e,n),o=new HalfEdge(t,n),a=new HalfEdge(r,n);return i.next=a.prev=o,o.next=i.prev=a,a.next=o.prev=i,n.edge=i,n.compute()}}),Object.assign(Face.prototype,{getEdge:function(e){for(var t=this.edge;e>0;)t=t.next,e--;for(;e<0;)t=t.prev,e++;return t},compute:function(){var e;return function(){void 0===e&&(e=new Triangle);var t=this.edge.tail(),r=this.edge.head(),n=this.edge.next.head();return e.set(t.point,r.point,n.point),e.getNormal(this.normal),e.getMidpoint(this.midpoint),this.area=e.getArea(),this.constant=this.normal.dot(this.midpoint),this}}(),distanceToPoint:function(e){return this.normal.dot(e)-this.constant}}),Object.assign(HalfEdge.prototype,{head:function(){return this.vertex},tail:function(){return this.prev?this.prev.vertex:null},length:function(){var e=this.head(),t=this.tail();return null!==t?t.point.distanceTo(e.point):-1},lengthSquared:function(){var e=this.head(),t=this.tail();return null!==t?t.point.distanceToSquared(e.point):-1},setTwin:function(e){return this.twin=e,e.twin=this,this}}),Object.assign(VertexList.prototype,{first:function(){return this.head},last:function(){return this.tail},clear:function(){return this.head=this.tail=null,this},insertBefore:function(e,t){return t.prev=e.prev,t.next=e,null===t.prev?this.head=t:t.prev.next=t,e.prev=t,this},insertAfter:function(e,t){return t.prev=e,t.next=e.next,null===t.next?this.tail=t:t.next.prev=t,e.next=t,this},append:function(e){return null===this.head?this.head=e:this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e,this},appendChain:function(e){for(null===this.head?this.head=e:this.tail.next=e,e.prev=this.tail;null!==e.next;)e=e.next;return this.tail=e,this},remove:function(e){return null===e.prev?this.head=e.next:e.prev.next=e.next,null===e.next?this.tail=e.prev:e.next.prev=e.prev,this},removeSubList:function(e,t){return null===e.prev?this.head=t.next:e.prev.next=t.next,null===t.next?this.tail=e.prev:t.next.prev=e.prev,this},isEmpty:function(){return null===this.head}}),ConvexGeometry.prototype=Object.create(Geometry.prototype),ConvexGeometry.prototype.constructor=ConvexGeometry,ConvexBufferGeometry.prototype=Object.create(BufferGeometry.prototype),ConvexBufferGeometry.prototype.constructor=ConvexBufferGeometry;var ConvexObjectBreaker=function(e,t){this.minSizeForBreak=e||1.4,this.smallDelta=t||1e-4,this.tempLine1=new Line3,this.tempPlane1=new Plane,this.tempPlane2=new Plane,this.tempPlane_Cut=new Plane,this.tempCM1=new Vector3,this.tempCM2=new Vector3,this.tempVector3=new Vector3,this.tempVector3_2=new Vector3,this.tempVector3_3=new Vector3,this.tempVector3_P0=new Vector3,this.tempVector3_P1=new Vector3,this.tempVector3_P2=new Vector3,this.tempVector3_N0=new Vector3,this.tempVector3_N1=new Vector3,this.tempVector3_AB=new Vector3,this.tempVector3_CB=new Vector3,this.tempResultObjects={object1:null,object2:null},this.segments=[];for(var r=0;r<900;r++)this.segments[r]=!1};function Curve(){this.type="Curve",this.arcLengthDivisions=200}function GrannyKnot(){Curve.call(this)}function HeartCurve(e){Curve.call(this),this.scale=void 0===e?5:e}function VivianiCurve(e){Curve.call(this),this.scale=void 0===e?70:e}function KnotCurve(){Curve.call(this)}function HelixCurve(){Curve.call(this)}function TrefoilKnot(e){Curve.call(this),this.scale=void 0===e?10:e}function TorusKnot(e){Curve.call(this),this.scale=void 0===e?10:e}function CinquefoilKnot(e){Curve.call(this),this.scale=void 0===e?10:e}function TrefoilPolynomialKnot(e){Curve.call(this),this.scale=void 0===e?10:e}ConvexObjectBreaker.prototype={constructor:ConvexObjectBreaker,prepareBreakableObject:function(e,t,r,n,i){e.geometry.isBufferGeometry||console.error("ConvexObjectBreaker.prepareBreakableObject(): Parameter object must have a BufferGeometry.");var o=e.userData;o.mass=t,o.velocity=r.clone(),o.angularVelocity=n.clone(),o.breakable=i},subdivideByImpact:function(e,t,r,n,i){var o=[],a=this.tempPlane1,s=this.tempPlane2;this.tempVector3.addVectors(t,r),a.setFromCoplanarPoints(t,e.position,this.tempVector3);var l=i+n,u=this;return function i(c,h,p,f){if(Math.random()<.05*f||f>l)o.push(c);else{var d=Math.PI;0===f?(s.normal.copy(a.normal),s.constant=a.constant):f<=n?(d=(p-h)*(.2+.6*Math.random())+h,u.tempVector3_2.copy(e.position).sub(t).applyAxisAngle(r,d).add(t),s.setFromCoplanarPoints(t,u.tempVector3,u.tempVector3_2)):(d=(.5*(1&f)+.2*(2-Math.random()))*Math.PI,u.tempVector3_2.copy(t).sub(c.position).applyAxisAngle(r,d).add(c.position),u.tempVector3_3.copy(r).add(c.position),s.setFromCoplanarPoints(c.position,u.tempVector3_3,u.tempVector3_2)),u.cutByPlane(c,s,u.tempResultObjects);var m=u.tempResultObjects.object1,v=u.tempResultObjects.object2;m&&i(m,h,d,f+1),v&&i(v,d,p,f+1)}}(e,0,2*Math.PI,0),o},cutByPlane:function(e,t,r){var n=e.geometry,i=n.attributes.position.array,o=n.attributes.normal.array,a=i.length/3,s=a/3,l=n.getIndex();function u(e,t){var r=3*e+t;return l?l[r]:r}l&&(s=(l=l.array).length/3);for(var c=[],h=[],p=this.smallDelta,f=a*a,d=0;d<f;d++)this.segments[d]=!1;var m=this.tempVector3_P0,v=this.tempVector3_P1,g=this.tempVector3_N0,y=this.tempVector3_N1;for(d=0;d<s-1;d++){var b=u(d,0),x=u(d,1),w=u(d,2);g.set(o[b],o[b]+1,o[b]+2);for(var S=d+1;S<s;S++){var M=u(S,0),_=u(S,1),T=u(S,2);y.set(o[M],o[M]+1,o[M]+2),1-g.dot(y)<p&&(b===M||b===_||b===T?x===M||x===_||x===T?(this.segments[b*a+x]=!0,this.segments[x*a+b]=!0):(this.segments[w*a+b]=!0,this.segments[b*a+w]=!0):x!==M&&x!==_&&x!==T||(this.segments[w*a+x]=!0,this.segments[x*a+w]=!0))}}var A=this.tempPlane_Cut;e.updateMatrix(),ConvexObjectBreaker.transformPlaneToLocalSpace(t,e.matrix,A);for(d=0;d<s;d++)for(var C=u(d,0),E=u(d,1),L=u(d,2),N=0;N<3;N++){var P=0===N?C:1===N?E:L,O=0===N?E:1===N?L:C;if(!this.segments[P*a+O]){this.segments[P*a+O]=!0,this.segments[O*a+P]=!0,m.set(i[3*P],i[3*P+1],i[3*P+2]),v.set(i[3*O],i[3*O+1],i[3*O+2]);var R=0;(D=A.distanceToPoint(m))>p?(R=2,h.push(m.clone())):D<-p?(R=1,c.push(m.clone())):(R=3,c.push(m.clone()),h.push(m.clone()));var D,F=0;if((D=A.distanceToPoint(v))>p?(F=2,h.push(v.clone())):D<-p?(F=1,c.push(v.clone())):(F=3,c.push(v.clone()),h.push(v.clone())),1===R&&2===F||2===R&&1===F){this.tempLine1.start.copy(m),this.tempLine1.end.copy(v);var k=new Vector3;if(void 0===(k=A.intersectLine(this.tempLine1,k)))return console.error("Internal error: segment does not intersect plane."),r.segmentedObject1=null,r.segmentedObject2=null,0;c.push(k),h.push(k.clone())}}}var I=.5*e.userData.mass;this.tempCM1.set(0,0,0);var B=0,U=c.length;if(U>0){for(d=0;d<U;d++)this.tempCM1.add(c[d]);this.tempCM1.divideScalar(U);for(d=0;d<U;d++){(z=c[d]).sub(this.tempCM1),B=Math.max(B,z.x,z.y,z.z)}this.tempCM1.add(e.position)}this.tempCM2.set(0,0,0);var V=0,j=h.length;if(j>0){for(d=0;d<j;d++)this.tempCM2.add(h[d]);this.tempCM2.divideScalar(j);for(d=0;d<j;d++){var z;(z=h[d]).sub(this.tempCM2),V=Math.max(V,z.x,z.y,z.z)}this.tempCM2.add(e.position)}var G=null,W=null,H=0;return U>4&&((G=new Mesh(new ConvexBufferGeometry(c),e.material)).position.copy(this.tempCM1),G.quaternion.copy(e.quaternion),this.prepareBreakableObject(G,I,e.userData.velocity,e.userData.angularVelocity,2*B>this.minSizeForBreak),H++),j>4&&((W=new Mesh(new ConvexBufferGeometry(h),e.material)).position.copy(this.tempCM2),W.quaternion.copy(e.quaternion),this.prepareBreakableObject(W,I,e.userData.velocity,e.userData.angularVelocity,2*V>this.minSizeForBreak),H++),r.object1=G,r.object2=W,H}},ConvexObjectBreaker.transformFreeVector=function(e,t){var r=e.x,n=e.y,i=e.z,o=t.elements;return e.x=o[0]*r+o[4]*n+o[8]*i,e.y=o[1]*r+o[5]*n+o[9]*i,e.z=o[2]*r+o[6]*n+o[10]*i,e},ConvexObjectBreaker.transformFreeVectorInverse=function(e,t){var r=e.x,n=e.y,i=e.z,o=t.elements;return e.x=o[0]*r+o[1]*n+o[2]*i,e.y=o[4]*r+o[5]*n+o[6]*i,e.z=o[8]*r+o[9]*n+o[10]*i,e},ConvexObjectBreaker.transformTiedVectorInverse=function(e,t){var r=e.x,n=e.y,i=e.z,o=t.elements;return e.x=o[0]*r+o[1]*n+o[2]*i-o[12],e.y=o[4]*r+o[5]*n+o[6]*i-o[13],e.z=o[8]*r+o[9]*n+o[10]*i-o[14],e},ConvexObjectBreaker.transformPlaneToLocalSpace=function(){var e=new Vector3;return function(t,r,n){n.normal.copy(t.normal),n.constant=t.constant;var i=ConvexObjectBreaker.transformTiedVectorInverse(t.coplanarPoint(e),r);ConvexObjectBreaker.transformFreeVectorInverse(n.normal,r),n.constant=-i.dot(n.normal)}}(),Object.assign(Curve.prototype,{getPoint:function(){return console.warn("Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var r=this.getUtoTmapping(e);return this.getPoint(r,t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],r=0;r<=e;r++)t.push(this.getPoint(r/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,r,n=[],i=this.getPoint(0),o=0;for(n.push(0),r=1;r<=e;r++)o+=(t=this.getPoint(r/e)).distanceTo(i),n.push(o),i=t;return this.cacheArcLengths=n,n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var r,n=this.getLengths(),i=0,o=n.length;r=t||e*n[o-1];for(var a,s=0,l=o-1;s<=l;)if((a=n[i=Math.floor(s+(l-s)/2)]-r)<0)s=i+1;else{if(!(a>0)){l=i;break}l=i-1}if(n[i=l]===r)return i/(o-1);var u=n[i];return(i+(r-u)/(n[i+1]-u))/(o-1)},getTangent:function(e){var t=e-1e-4,r=e+1e-4;t<0&&(t=0),r>1&&(r=1);var n=this.getPoint(t);return this.getPoint(r).clone().sub(n).normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var r,n,i,o=new Vector3,a=[],s=[],l=[],u=new Vector3,c=new Matrix4;for(r=0;r<=e;r++)n=r/e,a[r]=this.getTangentAt(n),a[r].normalize();s[0]=new Vector3,l[0]=new Vector3;var h=Number.MAX_VALUE,p=Math.abs(a[0].x),f=Math.abs(a[0].y),d=Math.abs(a[0].z);for(p<=h&&(h=p,o.set(1,0,0)),f<=h&&(h=f,o.set(0,1,0)),d<=h&&o.set(0,0,1),u.crossVectors(a[0],o).normalize(),s[0].crossVectors(a[0],u),l[0].crossVectors(a[0],s[0]),r=1;r<=e;r++)s[r]=s[r-1].clone(),l[r]=l[r-1].clone(),u.crossVectors(a[r-1],a[r]),u.length()>Number.EPSILON&&(u.normalize(),i=Math.acos(_Math.clamp(a[r-1].dot(a[r]),-1,1)),s[r].applyMatrix4(c.makeRotationAxis(u,i))),l[r].crossVectors(a[r],s[r]);if(!0===t)for(i=Math.acos(_Math.clamp(s[0].dot(s[e]),-1,1)),i/=e,a[0].dot(u.crossVectors(s[0],s[e]))>0&&(i=-i),r=1;r<=e;r++)s[r].applyMatrix4(c.makeRotationAxis(a[r],i*r)),l[r].crossVectors(a[r],s[r]);return{tangents:a,normals:s,binormals:l}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),GrannyKnot.prototype=Object.create(Curve.prototype),GrannyKnot.prototype.constructor=GrannyKnot,GrannyKnot.prototype.getPoint=function(e,t){var r=t||new Vector3;e=2*Math.PI*e;var n=-.22*Math.cos(e)-1.28*Math.sin(e)-.44*Math.cos(3*e)-.78*Math.sin(3*e),i=-.1*Math.cos(2*e)-.27*Math.sin(2*e)+.38*Math.cos(4*e)+.46*Math.sin(4*e),o=.7*Math.cos(3*e)-.4*Math.sin(3*e);return r.set(n,i,o).multiplyScalar(20)},HeartCurve.prototype=Object.create(Curve.prototype),HeartCurve.prototype.constructor=HeartCurve,HeartCurve.prototype.getPoint=function(e,t){var r=t||new Vector3;e*=2*Math.PI;var n=16*Math.pow(Math.sin(e),3),i=13*Math.cos(e)-5*Math.cos(2*e)-2*Math.cos(3*e)-Math.cos(4*e);return r.set(n,i,0).multiplyScalar(this.scale)},VivianiCurve.prototype=Object.create(Curve.prototype),VivianiCurve.prototype.constructor=VivianiCurve,VivianiCurve.prototype.getPoint=function(e,t){var r=t||new Vector3;e=4*e*Math.PI;var n=this.scale/2,i=n*(1+Math.cos(e)),o=n*Math.sin(e),a=2*n*Math.sin(e/2);return r.set(i,o,a)},KnotCurve.prototype=Object.create(Curve.prototype),KnotCurve.prototype.constructor=KnotCurve,KnotCurve.prototype.getPoint=function(e,t){var r=t||new Vector3;e*=2*Math.PI;var n=50*Math.sin(e),i=Math.cos(e)*(10+50*Math.cos(e)),o=Math.sin(e)*(10+50*Math.cos(e));return r.set(n,i,o)},HelixCurve.prototype=Object.create(Curve.prototype),HelixCurve.prototype.constructor=HelixCurve,HelixCurve.prototype.getPoint=function(e,t){var r=t||new Vector3,n=2*Math.PI*e*150/30,i=30*Math.cos(n),o=30*Math.sin(n),a=150*e;return r.set(i,o,a)},TrefoilKnot.prototype=Object.create(Curve.prototype),TrefoilKnot.prototype.constructor=TrefoilKnot,TrefoilKnot.prototype.getPoint=function(e,t){var r=t||new Vector3;e*=2*Math.PI;var n=(2+Math.cos(3*e))*Math.cos(2*e),i=(2+Math.cos(3*e))*Math.sin(2*e),o=Math.sin(3*e);return r.set(n,i,o).multiplyScalar(this.scale)},TorusKnot.prototype=Object.create(Curve.prototype),TorusKnot.prototype.constructor=TorusKnot,TorusKnot.prototype.getPoint=function(e,t){var r=t||new Vector3;e*=2*Math.PI;var n=(2+Math.cos(4*e))*Math.cos(3*e),i=(2+Math.cos(4*e))*Math.sin(3*e),o=Math.sin(4*e);return r.set(n,i,o).multiplyScalar(this.scale)},CinquefoilKnot.prototype=Object.create(Curve.prototype),CinquefoilKnot.prototype.constructor=CinquefoilKnot,CinquefoilKnot.prototype.getPoint=function(e,t){var r=t||new Vector3;e*=2*Math.PI;var n=(2+Math.cos(5*e))*Math.cos(2*e),i=(2+Math.cos(5*e))*Math.sin(2*e),o=Math.sin(5*e);return r.set(n,i,o).multiplyScalar(this.scale)},TrefoilPolynomialKnot.prototype=Object.create(Curve.prototype),TrefoilPolynomialKnot.prototype.constructor=TrefoilPolynomialKnot,TrefoilPolynomialKnot.prototype.getPoint=function(e,t){var r=t||new Vector3;e=4*e-2;var n=Math.pow(e,3)-3*e,i=Math.pow(e,4)-4*e*e,o=.2*Math.pow(e,5)-2*e;return r.set(n,i,o).multiplyScalar(this.scale)};var scaleTo=function(e,t,r){return r*(t-e)+e};function FigureEightPolynomialKnot(e){Curve.call(this),this.scale=void 0===e?1:e}function DecoratedTorusKnot4a(e){Curve.call(this),this.scale=void 0===e?40:e}function DecoratedTorusKnot4b(e){Curve.call(this),this.scale=void 0===e?40:e}function DecoratedTorusKnot5a(e){Curve.call(this),this.scale=void 0===e?40:e}function DecoratedTorusKnot5c(e){Curve.call(this),this.scale=void 0===e?40:e}FigureEightPolynomialKnot.prototype=Object.create(Curve.prototype),FigureEightPolynomialKnot.prototype.constructor=FigureEightPolynomialKnot,FigureEightPolynomialKnot.prototype.getPoint=function(e,t){var r=t||new Vector3,n=.4*(e=scaleTo(-4,4,e))*(e*e-7)*(e*e-10),i=Math.pow(e,4)-13*e*e,o=.1*e*(e*e-4)*(e*e-9)*(e*e-12);return r.set(n,i,o).multiplyScalar(this.scale)},DecoratedTorusKnot4a.prototype=Object.create(Curve.prototype),DecoratedTorusKnot4a.prototype.constructor=DecoratedTorusKnot4a,DecoratedTorusKnot4a.prototype.getPoint=function(e,t){var r=t||new Vector3;e*=2*Math.PI;var n=Math.cos(2*e)*(1+.6*(Math.cos(5*e)+.75*Math.cos(10*e))),i=Math.sin(2*e)*(1+.6*(Math.cos(5*e)+.75*Math.cos(10*e))),o=.35*Math.sin(5*e);return r.set(n,i,o).multiplyScalar(this.scale)},DecoratedTorusKnot4b.prototype=Object.create(Curve.prototype),DecoratedTorusKnot4b.prototype.constructor=DecoratedTorusKnot4b,DecoratedTorusKnot4b.prototype.getPoint=function(e,t){var r=t||new Vector3,n=e*Math.PI*2,i=Math.cos(2*n)*(1+.45*Math.cos(3*n)+.4*Math.cos(9*n)),o=Math.sin(2*n)*(1+.45*Math.cos(3*n)+.4*Math.cos(9*n)),a=.2*Math.sin(9*n);return r.set(i,o,a).multiplyScalar(this.scale)},DecoratedTorusKnot5a.prototype=Object.create(Curve.prototype),DecoratedTorusKnot5a.prototype.constructor=DecoratedTorusKnot5a,DecoratedTorusKnot5a.prototype.getPoint=function(e,t){var r=t||new Vector3,n=e*Math.PI*2,i=Math.cos(3*n)*(1+.3*Math.cos(5*n)+.5*Math.cos(10*n)),o=Math.sin(3*n)*(1+.3*Math.cos(5*n)+.5*Math.cos(10*n)),a=.2*Math.sin(20*n);return r.set(i,o,a).multiplyScalar(this.scale)},DecoratedTorusKnot5c.prototype=Object.create(Curve.prototype),DecoratedTorusKnot5c.prototype.constructor=DecoratedTorusKnot5c,DecoratedTorusKnot5c.prototype.getPoint=function(e,t){var r=t||new Vector3,n=e*Math.PI*2,i=Math.cos(4*n)*(1+.5*(Math.cos(5*n)+.4*Math.cos(20*n))),o=Math.sin(4*n)*(1+.5*(Math.cos(5*n)+.4*Math.cos(20*n))),a=.35*Math.sin(15*n);return r.set(i,o,a).multiplyScalar(this.scale)};var NURBSUtils={findSpan:function(e,t,r){var n=r.length-e-1;if(t>=r[n])return n-1;if(t<=r[e])return e;for(var i=e,o=n,a=Math.floor((i+o)/2);t<r[a]||t>=r[a+1];)t<r[a]?o=a:i=a,a=Math.floor((i+o)/2);return a},calcBasisFunctions:function(e,t,r,n){var i=[],o=[],a=[];i[0]=1;for(var s=1;s<=r;++s){o[s]=t-n[e+1-s],a[s]=n[e+s]-t;for(var l=0,u=0;u<s;++u){var c=a[u+1],h=o[s-u],p=i[u]/(c+h);i[u]=l+c*p,l=h*p}i[s]=l}return i},calcBSplinePoint:function(e,t,r,n){for(var i=this.findSpan(e,n,t),o=this.calcBasisFunctions(i,n,e,t),a=new Vector4(0,0,0,0),s=0;s<=e;++s){var l=r[i-e+s],u=o[s],c=l.w*u;a.x+=l.x*c,a.y+=l.y*c,a.z+=l.z*c,a.w+=l.w*u}return a},calcBasisFunctionDerivatives:function(e,t,r,n,i){for(var o=[],a=0;a<=r;++a)o[a]=0;var s=[];for(a=0;a<=n;++a)s[a]=o.slice(0);var l=[];for(a=0;a<=r;++a)l[a]=o.slice(0);l[0][0]=1;for(var u=o.slice(0),c=o.slice(0),h=1;h<=r;++h){u[h]=t-i[e+1-h],c[h]=i[e+h]-t;for(var p=0,f=0;f<h;++f){var d=c[f+1],m=u[h-f];l[h][f]=d+m;var v=l[f][h-1]/l[h][f];l[f][h]=p+d*v,p=m*v}l[h][h]=p}for(h=0;h<=r;++h)s[0][h]=l[h][r];for(f=0;f<=r;++f){var g=0,y=1,b=[];for(a=0;a<=r;++a)b[a]=o.slice(0);b[0][0]=1;for(var x=1;x<=n;++x){var w=0,S=f-x,M=r-x;f>=x&&(b[y][0]=b[g][0]/l[M+1][S],w=b[y][0]*l[S][M]);var _=f-1<=M?x-1:r-f;for(h=S>=-1?1:-S;h<=_;++h)b[y][h]=(b[g][h]-b[g][h-1])/l[M+1][S+h],w+=b[y][h]*l[S+h][M];f<=M&&(b[y][x]=-b[g][x-1]/l[M+1][f],w+=b[y][x]*l[f][M]),s[x][f]=w;h=g;g=y,y=h}}for(f=r,x=1;x<=n;++x){for(h=0;h<=r;++h)s[x][h]*=f;f*=r-x}return s},calcBSplineDerivatives:function(e,t,r,n,i){for(var o=i<e?i:e,a=[],s=this.findSpan(e,n,t),l=this.calcBasisFunctionDerivatives(s,n,e,o,t),u=[],c=0;c<r.length;++c){var h=(f=r[c].clone()).w;f.x*=h,f.y*=h,f.z*=h,u[c]=f}for(var p=0;p<=o;++p){for(var f=u[s-e].clone().multiplyScalar(l[p][0]),d=1;d<=e;++d)f.add(u[s-e+d].clone().multiplyScalar(l[p][d]));a[p]=f}for(p=o+1;p<=i+1;++p)a[p]=new Vector4(0,0,0);return a},calcKoverI:function(e,t){for(var r=1,n=2;n<=e;++n)r*=n;var i=1;for(n=2;n<=t;++n)i*=n;for(n=2;n<=e-t;++n)i*=n;return r/i},calcRationalCurveDerivatives:function(e){for(var t=e.length,r=[],n=[],i=0;i<t;++i){var o=e[i];r[i]=new Vector3(o.x,o.y,o.z),n[i]=o.w}for(var a=[],s=0;s<t;++s){var l=r[s].clone();for(i=1;i<=s;++i)l.sub(a[s-i].clone().multiplyScalar(this.calcKoverI(s,i)*n[i]));a[s]=l.divideScalar(n[0])}return a},calcNURBSDerivatives:function(e,t,r,n,i){var o=this.calcBSplineDerivatives(e,t,r,n,i);return this.calcRationalCurveDerivatives(o)},calcSurfacePoint:function(e,t,r,n,i,o,a,s){for(var l=this.findSpan(e,o,r),u=this.findSpan(t,a,n),c=this.calcBasisFunctions(l,o,e,r),h=this.calcBasisFunctions(u,a,t,n),p=[],f=0;f<=t;++f){p[f]=new Vector4(0,0,0,0);for(var d=0;d<=e;++d){var m=i[l-e+d][u-t+f].clone(),v=m.w;m.x*=v,m.y*=v,m.z*=v,p[f].add(m.multiplyScalar(c[d]))}}var g=new Vector4(0,0,0,0);for(f=0;f<=t;++f)g.add(p[f].multiplyScalar(h[f]));g.divideScalar(g.w),s.set(g.x,g.y,g.z)}},NURBSCurve=function(e,t,r,n,i){Curve.call(this),this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=n||0,this.endKnot=i||this.knots.length-1;for(var o=0;o<r.length;++o){var a=r[o];this.controlPoints[o]=new Vector4(a.x,a.y,a.z,a.w)}};NURBSCurve.prototype=Object.create(Curve.prototype),NURBSCurve.prototype.constructor=NURBSCurve,NURBSCurve.prototype.getPoint=function(e){var t=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),r=NURBSUtils.calcBSplinePoint(this.degree,this.knots,this.controlPoints,t);return 1!=r.w&&r.divideScalar(r.w),new Vector3(r.x,r.y,r.z)},NURBSCurve.prototype.getTangent=function(e){var t=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),r=NURBSUtils.calcNURBSDerivatives(this.degree,this.knots,this.controlPoints,t,1)[1].clone();return r.normalize(),r};var NURBSSurface=function(e,t,r,n,i){this.degree1=e,this.degree2=t,this.knots1=r,this.knots2=n,this.controlPoints=[];for(var o=r.length-e-1,a=n.length-t-1,s=0;s<o;++s){this.controlPoints[s]=[];for(var l=0;l<a;++l){var u=i[s][l];this.controlPoints[s][l]=new Vector4(u.x,u.y,u.z,u.w)}}};function StereoCamera(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new PerspectiveCamera,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new PerspectiveCamera,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}NURBSSurface.prototype={constructor:NURBSSurface,getPoint:function(e,t,r){var n=this.knots1[0]+e*(this.knots1[this.knots1.length-1]-this.knots1[0]),i=this.knots2[0]+t*(this.knots2[this.knots2.length-1]-this.knots2[0]);NURBSUtils.calcSurfacePoint(this.degree1,this.degree2,this.knots1,this.knots2,this.controlPoints,n,i,r)}},Object.assign(StereoCamera.prototype,{update:function(){var e,t,r,n,i,o,a,s,l=new Matrix4,u=new Matrix4;return function(c){if(e!==this||t!==c.focus||r!==c.fov||n!==c.aspect*this.aspect||i!==c.near||o!==c.far||a!==c.zoom||s!==this.eyeSep){e=this,t=c.focus,r=c.fov,n=c.aspect*this.aspect,i=c.near,o=c.far,a=c.zoom;var h,p,f=c.projectionMatrix.clone(),d=(s=this.eyeSep/2)*i/t,m=i*Math.tan(_Math.DEG2RAD*r*.5)/a;u.elements[12]=-s,l.elements[12]=s,h=-m*n+d,p=m*n+d,f.elements[0]=2*i/(p-h),f.elements[8]=(p+h)/(p-h),this.cameraL.projectionMatrix.copy(f),h=-m*n-d,p=m*n-d,f.elements[0]=2*i/(p-h),f.elements[8]=(p+h)/(p-h),this.cameraR.projectionMatrix.copy(f)}this.cameraL.matrixWorld.copy(c.matrixWorld).multiply(u),this.cameraR.matrixWorld.copy(c.matrixWorld).multiply(l)}}()});var AnaglyphEffect=function(e,t,r){this.colorMatrixLeft=(new Matrix3).fromArray([1.0671679973602295,-.0016435992438346148,.0001777536963345483,-.028107794001698494,-.00019593400065787137,-.0002875397040043026,-.04279090091586113,15809757314855233e-21,-.00024287120322696865]),this.colorMatrixRight=(new Matrix3).fromArray([-.0355340838432312,-.06440307199954987,.018319187685847282,-.10269022732973099,.8079727292060852,-.04835830628871918,.0001224992738571018,-.009558862075209618,.567823588848114]);var n=new OrthographicCamera(-1,1,1,-1,0,1),i=new Scene,o=new StereoCamera,a={minFilter:LinearFilter,magFilter:NearestFilter,format:RGBAFormat};void 0===t&&(t=512),void 0===r&&(r=512);var s=new WebGLRenderTarget(t,r,a),l=new WebGLRenderTarget(t,r,a),u=new ShaderMaterial({uniforms:{mapLeft:{value:s.texture},mapRight:{value:l.texture},colorMatrixLeft:{value:this.colorMatrixLeft},colorMatrixRight:{value:this.colorMatrixRight}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = vec2( uv.x, uv.y );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D mapLeft;","uniform sampler2D mapRight;","varying vec2 vUv;","uniform mat3 colorMatrixLeft;","uniform mat3 colorMatrixRight;","float lin( float c ) {","\treturn c <= 0.04045 ? c * 0.0773993808 :","\t\t\tpow( c * 0.9478672986 + 0.0521327014, 2.4 );","}","vec4 lin( vec4 c ) {","\treturn vec4( lin( c.r ), lin( c.g ), lin( c.b ), c.a );","}","float dev( float c ) {","\treturn c <= 0.0031308 ? c * 12.92","\t\t\t: pow( c, 0.41666 ) * 1.055 - 0.055;","}","void main() {","\tvec2 uv = vUv;","\tvec4 colorL = lin( texture2D( mapLeft, uv ) );","\tvec4 colorR = lin( texture2D( mapRight, uv ) );","\tvec3 color = clamp(","\t\t\tcolorMatrixLeft * colorL.rgb +","\t\t\tcolorMatrixRight * colorR.rgb, 0., 1. );","\tgl_FragColor = vec4(","\t\t\tdev( color.r ), dev( color.g ), dev( color.b ),","\t\t\tmax( colorL.a, colorR.a ) );","}"].join("\n")}),c=new Mesh(new PlaneBufferGeometry(2,2),u);i.add(c),this.setSize=function(t,r){e.setSize(t,r);var n=e.getPixelRatio();s.setSize(t*n,r*n),l.setSize(t*n,r*n)},this.render=function(t,r){var a=e.getRenderTarget();t.updateMatrixWorld(),null===r.parent&&r.updateMatrixWorld(),o.update(r),e.setRenderTarget(s),e.clear(),e.render(t,o.cameraL),e.setRenderTarget(l),e.clear(),e.render(t,o.cameraR),e.setRenderTarget(null),e.render(i,n),e.setRenderTarget(a)},this.dispose=function(){s&&s.dispose(),l&&l.dispose(),c&&c.geometry.dispose(),u&&u.dispose()}},AsciiEffect=function(e,t,r){t=void 0===t?" .:-=+*#%@":t,r||(r={});var n,i,o=r.resolution?r.resolution:.15,a=r.scale?r.scale:1,s=!!r.color&&r.color,l=!!r.alpha&&r.alpha,u=!!r.block&&r.block,c=!!r.invert&&r.invert,h=document.createElement("div");h.style.cursor="default";var p,f,d,m=document.createElement("table");h.appendChild(m),this.setSize=function(t,r){n=t,i=r,e.setSize(t,r),function(){p=Math.round(n*M),f=Math.round(i*M),x.width=p,x.height=f,(d=e.domElement).style.backgroundColor&&(m.rows[0].cells[0].style.backgroundColor=d.style.backgroundColor,m.rows[0].cells[0].style.color=d.style.color);m.cellSpacing=0,m.cellPadding=0;var t=m.style;t.display="inline",t.width=Math.round(p/M*a)+"px",t.height=Math.round(f/M*a)+"px",t.whiteSpace="pre",t.margin="0px",t.padding="0px",t.letterSpacing=A+"px",t.fontFamily=y,t.fontSize=_+"px",t.lineHeight=T+"px",t.textAlign="left",t.textDecoration="none"}()},this.render=function(t,r){e.render(t,r),function(e,t){w.clearRect(0,0,p,f),w.drawImage(b,0,0,p,f);for(var r=w.getImageData(0,0,p,f).data,n="",i=0;i<f;i+=2){for(var o=0;o<p;o++){var a,h,d=4*(i*p+o),m=r[d],v=r[d+1],g=r[d+2],y=r[d+3];h=(.3*m+.59*v+.11*g)/255,0==y&&(h=1),a=Math.floor((1-h)*(S.length-1)),c&&(a=S.length-a-1);var x=S[a];void 0!==x&&" "!=x||(x="&nbsp;"),n+=s?"<span style='color:rgb("+m+","+v+","+g+");"+(u?"background-color:rgb("+m+","+v+","+g+");":"")+(l?"opacity:"+y/255+";":"")+"'>"+x+"</span>":x}n+="<br/>"}t.innerHTML="<tr><td>"+n+"</td></tr>"}(0,m)},this.domElement=h;var v=" .,:;i1tfLCG08@".split(""),g=" CGO08@".split(""),y="courier new, monospace",b=e.domElement,x=document.createElement("canvas");if(x.getContext){var w=x.getContext("2d");if(w.getImageData){var S=s?g:v;t&&(S=t);var M=.5;M=.25,o&&(M=o);var _=2/M*a,T=2/M*a,A=0;switch(a){case 1:A=-1;break;case 2:case 3:A=-2.1;break;case 4:A=-3.1;break;case 5:A=-4.15}}}},alphamap_fragment="\n#ifdef USE_ALPHAMAP\n\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n\n#endif\n",alphamap_pars_fragment="\n#ifdef USE_ALPHAMAP\n\n\tuniform sampler2D alphaMap;\n\n#endif\n",alphatest_fragment="\n#ifdef ALPHATEST\n\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n\n#endif\n",aomap_fragment="\n#ifdef USE_AOMAP\n\n\t// reads channel R, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\n\t#endif\n\n#endif\n",aomap_pars_fragment="\n#ifdef USE_AOMAP\n\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n\n#endif\n",begin_vertex="\nvec3 transformed = vec3( position );\n",beginnormal_vertex="\nvec3 objectNormal = vec3( normal );\n\n#ifdef USE_TANGENT\n\n\tvec3 objectTangent = vec3( tangent.xyz );\n\n#endif\n",bsdfs='\n\n// Analytical approximation of the DFG LUT, one half of the\n// split-sum approximation used in indirect specular lighting.\n// via \'environmentBRDF\' from "Physically Based Shading on Mobile"\n// https://www.unrealengine.com/blog/physically-based-shading-on-mobile - environmentBRDF for GGX on mobile\nvec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\n\tvec4 r = roughness * c0 + c1;\n\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n\n}\n\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\n\t// based upon Frostbite 3 Moving to Physically-based Rendering\n\t// page 32, equation 26: E[window1]\n\t// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\n\t// this is intended to be used on spot and point lights who are represented as luminous intensity\n\t// but who must be converted to luminous irradiance for surface lighting calculation\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\n\tif( cutoffDistance > 0.0 ) {\n\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\n\t}\n\n\treturn distanceFalloff;\n\n#else\n\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\n\t}\n\n\treturn 1.0;\n\n#endif\n\n}\n\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\n\treturn RECIPROCAL_PI * diffuseColor;\n\n} // validated\n\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\n\t// Original approximation by Christophe Schlick \'94\n\t// float fresnel = pow( 1.0 - dotLH, 5.0 );\n\n\t// Optimized variant (presented by Epic at SIGGRAPH \'13)\n\t// https://cdn2.unrealengine.com/Resources/files/2013SiggraphPresentationsNotes-26915738.pdf\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n\n} // validated\n\n// Microfacet Models for Refraction through Rough Surfaces - equation (34)\n// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html\n// alpha is "roughness squared" in Disney\u2019s reparameterization\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\n\t// geometry term (normalized) = G(l)\u22c5G(v) / 4(n\u22c5l)(n\u22c5v)\n\t// also see #12151\n\n\tfloat a2 = pow2( alpha );\n\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\n\treturn 1.0 / ( gl * gv );\n\n} // validated\n\n// Moving Frostbite to Physically Based Rendering 3.0 - page 12, listing 2\n// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\n\tfloat a2 = pow2( alpha );\n\n\t// dotNL and dotNV are explicitly swapped. This is not a mistake.\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\n\treturn 0.5 / max( gv + gl, EPSILON );\n\n}\n\n// Microfacet Models for Refraction through Rough Surfaces - equation (33)\n// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html\n// alpha is "roughness squared" in Disney\u2019s reparameterization\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\n\tfloat a2 = pow2( alpha );\n\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0; // avoid alpha = 0 with dotNH = 1\n\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n\n}\n\n// GGX Distribution, Schlick Fresnel, GGX-Smith Visibility\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\n\tfloat alpha = pow2( roughness ); // UE4\'s roughness\n\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\n\tfloat D = D_GGX( alpha, dotNH );\n\n\treturn F * ( G * D );\n\n} // validated\n\n// Rect Area Light\n\n// Real-Time Polygonal-Light Shading with Linearly Transformed Cosines\n// by Eric Heitz, Jonathan Dupuy, Stephen Hill and David Neubelt\n// code: https://github.com/selfshadow/ltc_code/\n\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\n\tfloat dotNV = saturate( dot( N, V ) );\n\n\t// texture parameterized by sqrt( GGX alpha ) and sqrt( 1 - cos( theta ) )\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\n\treturn uv;\n\n}\n\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\n\t// Real-Time Area Lighting: a Journey from Research to Production (p.102)\n\t// An approximation of the form factor of a horizon-clipped rectangle.\n\n\tfloat l = length( f );\n\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n\n}\n\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\n\tfloat x = dot( v1, v2 );\n\n\tfloat y = abs( x );\n\n\t// rational polynomial approximation to theta / sin( theta ) / 2PI\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\n\treturn cross( v1, v2 ) * theta_sintheta;\n\n}\n\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\n\t// bail if point is on back side of plane of light\n\t// assumes ccw winding order of light vertices\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\n\t// construct orthonormal basis around N\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 ); // negated from paper; possibly due to a different handedness of world coordinate system\n\n\t// compute transform\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\n\t// transform rect\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\n\t// project rect onto sphere\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\n\t// calculate vector form factor\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\n\t// adjust for horizon clipping\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n\n}\n\n// End Rect Area Light\n\n// ref: https://www.unrealengine.com/blog/physically-based-shading-on-mobile - environmentBRDF for GGX on mobile\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\n\treturn specularColor * brdf.x + brdf.y;\n\n} // validated\n\n// Fdez-Ag\xfcera\'s "Multiple-Scattering Microfacet Model for Real-Time Image Based Lighting"\n// Approximates multiscattering in order to preserve energy.\n// http://www.jcgt.org/published/0008/01/03/\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\n\tvec3 F = F_Schlick( specularColor, dotNV );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\n\t// Paper incorrect indicates coefficient is PI/21, and will\n\t// be corrected to 1/21 in future updates.\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619; // 1/21\n\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n\n}\n\nfloat G_BlinnPhong_Implicit(  ) {\n\n\t// geometry term is (n dot l)(n dot v) / 4(n dot l)(n dot v)\n\treturn 0.25;\n\n}\n\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n\n}\n\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\n\t//float dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\t//float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\n\tfloat G = G_BlinnPhong_Implicit(  );\n\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\n\treturn F * ( G * D );\n\n} // validated\n\n// source: http://simonstechblog.blogspot.ca/2011/12/microfacet-brdf.html\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\n\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n',bumpmap_pars_fragment="\n#ifdef USE_BUMPMAP\n\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\n\t// Bump Mapping Unparametrized Surfaces on the GPU by Morten S. Mikkelsen\n\t// http://api.unrealengine.com/attachments/Engine/Rendering/LightingAndShadows/BumpMappingWithoutTangentSpace/mm_sfgrad_bump.pdf\n\n\t// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\n\tvec2 dHdxy_fwd() {\n\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n\t\treturn vec2( dBx, dBy );\n\n\t}\n\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\n\t\t// Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\n\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\t\t// normalized\n\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\n\t}\n\n#endif\n",clipping_planes_fragment="\n#if NUM_CLIPPING_PLANES > 0\n\n\tvec4 plane;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\n\t}\n\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\n\t\tbool clipped = true;\n\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\n\t\t}\n\n\t\tif ( clipped ) discard;\n\n\t#endif\n\n#endif\n",clipping_planes_pars_fragment="\n#if NUM_CLIPPING_PLANES > 0\n\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n\n#endif\n",clipping_planes_pars_vertex="\n#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex="\n#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment="\n#ifdef USE_COLOR\n\n\tdiffuseColor.rgb *= vColor;\n\n#endif\n",color_pars_fragment="\n#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif\n",color_pars_vertex="\n#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif\n",color_vertex="\n#ifdef USE_COLOR\n\n\tvColor.xyz = color.xyz;\n\n#endif\n",common="\n#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\n\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\n// expects values in the range of [0,1]x[0,1], returns values in the [0,1] range.\n// do not collapse into a single function per: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\n\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\n\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n}\n\n// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n\n}\n\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\n\treturn - distance * planeNormal + point;\n\n}\n\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n\n}\n\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n\n}\n\nmat3 transposeMat3( const in mat3 m ) {\n\n\tmat3 tmp;\n\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\n\treturn tmp;\n\n}\n\n// https://en.wikipedia.org/wiki/Relative_luminance\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\n\treturn dot( weights, color.rgb );\n\n}\n",cube_uv_reflection_fragment="\n#ifdef ENVMAP_TYPE_CUBE_UV\n\n#define cubeUV_textureSize (1024.0)\n\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\n\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\t// Clamp the value to the max mip level counts. hard coded to 6 mips\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\n\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\t// float powScale = exp2(roughnessLevel + mipLevel);\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\t// float scale =  1.0 / exp2(roughnessLevel + 2.0 + mipLevel);\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\t// float mipOffset = 0.75*(1.0 - 1.0/exp2(mipLevel))/exp2(roughnessLevel);\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\n\tfloat rcpPowScale = 1.0 / powScale;\n\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\n\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\n\t// round to nearest mipmap if we are not interpolating.\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\n\t// Tri linear interpolation.\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\n\tvec4 result = mix(color10, color20, t);\n\n\treturn vec4(result.rgb, 1.0);\n}\n\n#endif\n",defaultnormal_vertex="\nvec3 transformedNormal = normalMatrix * objectNormal;\n\n#ifdef FLIP_SIDED\n\n\ttransformedNormal = - transformedNormal;\n\n#endif\n\n#ifdef USE_TANGENT\n\n\tvec3 transformedTangent = normalMatrix * objectTangent;\n\n\t#ifdef FLIP_SIDED\n\n\t\ttransformedTangent = - transformedTangent;\n\n\t#endif\n\n#endif\n",displacementmap_pars_vertex="\n#ifdef USE_DISPLACEMENTMAP\n\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n\n#endif\n",displacementmap_vertex="\n#ifdef USE_DISPLACEMENTMAP\n\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n\n#endif\n",emissivemap_fragment="\n#ifdef USE_EMISSIVEMAP\n\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n\n#endif\n",emissivemap_pars_fragment="\n#ifdef USE_EMISSIVEMAP\n\n\tuniform sampler2D emissiveMap;\n\n#endif\n",encodings_fragment="\ngl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment="\n// For a discussion of what this is, please read this: http://lousodrome.net/blog/light/2013/05/26/gamma-correct-and-hdr-rendering-in-a-32-bits-buffer/\n\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\n\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\n\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\n\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\n\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\n\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\n\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n//  return vec4( value.brg, ( 3.0 + 128.0 ) / 256.0 );\n}\n\n// reference: http://iwasbeingirony.blogspot.ca/2010/06/difference-between-rgbm-and-rgbd.html\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\n\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\n\n// reference: http://iwasbeingirony.blogspot.ca/2010/06/difference-between-rgbm-and-rgbd.html\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\n\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\n\n// LogLuv reference: http://graphicrants.blogspot.ca/2009/04/rgbm-color-encoding.html\n\n// M matrix, for encoding\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\n\n// Inverse M matrix, for decoding\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}\n",envmap_fragment="\n#ifdef USE_ENVMAP\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\n\t\t// Transforming Normal Vectors with the Inverse Transformation\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\n\t\t#else\n\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t\t#endif\n\n\t#else\n\n\t\tvec3 reflectVec = vReflect;\n\n\t#endif\n\n\t#ifdef ENVMAP_TYPE_CUBE\n\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\n\t\tvec2 sampleUV;\n\n\t\treflectVec = normalize( reflectVec );\n\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\n\t\treflectVec = normalize( reflectVec );\n\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\n\t#else\n\n\t\tvec4 envColor = vec4( 0.0 );\n\n\t#endif\n\n\tenvColor = envMapTexelToLinear( envColor );\n\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\n\t#endif\n\n#endif\n",envmap_pars_fragment="\n#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n\n#ifdef USE_ENVMAP\n\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n\n#endif\n",envmap_pars_vertex="\n#ifdef USE_ENVMAP\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\n\t#else\n\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\n\t#endif\n\n#endif\n",envmap_vertex="\n#ifdef USE_ENVMAP\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\tvWorldPosition = worldPosition.xyz;\n\n\t#else\n\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\n\t\t#else\n\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t\t#endif\n\n\t#endif\n\n#endif\n",fog_vertex="\n#ifdef USE_FOG\n\n\tfogDepth = -mvPosition.z;\n\n#endif\n",fog_pars_vertex="\n#ifdef USE_FOG\n\n\tvarying float fogDepth;\n\n#endif\n",fog_fragment="\n#ifdef USE_FOG\n\n\t#ifdef FOG_EXP2\n\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\n\t#else\n\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\n\t#endif\n\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n\n#endif\n",fog_pars_fragment="\n#ifdef USE_FOG\n\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\n\t#ifdef FOG_EXP2\n\n\t\tuniform float fogDensity;\n\n\t#else\n\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\n\t#endif\n\n#endif\n",gradientmap_pars_fragment="\n#ifdef TOON\n\n\tuniform sampler2D gradientMap;\n\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\n\t\t// dotNL will be from -1.0 to 1.0\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\n\t\t#ifdef USE_GRADIENTMAP\n\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\n\t\t#else\n\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\n\t\t#endif\n\t}\n\n#endif\n",lightmap_fragment="\n#ifdef USE_LIGHTMAP\n\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity; // factor of PI should not be present; included here to prevent breakage\n\n#endif\n",lightmap_pars_fragment="\n#ifdef USE_LIGHTMAP\n\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n\n#endif\n",lights_lambert_vertex="\nvec3 diffuse = vec3( 1.0 );\n\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\n\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\n\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\n\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n\n#if NUM_POINT_LIGHTS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\n\t}\n\n#endif\n\n#if NUM_SPOT_LIGHTS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\t}\n\n#endif\n#if NUM_DIR_LIGHTS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\n\t}\n\n#endif\n\n#if NUM_HEMI_LIGHTS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\n\t\t#endif\n\n\t}\n\n#endif\n",lights_pars_begin="\nuniform vec3 ambientLightColor;\n\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\n\tvec3 irradiance = ambientLightColor;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *= PI;\n\n\t#endif\n\n\treturn irradiance;\n\n}\n\n#if NUM_DIR_LIGHTS > 0\n\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\n\t}\n\n#endif\n#if NUM_POINT_LIGHTS > 0\n\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\n\t// directLight is an out parameter as having it as a return value caused compiler errors on some devices\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\n\t\tfloat lightDistance = length( lVector );\n\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\n\t}\n\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\n\t// directLight is an out parameter as having it as a return value caused compiler errors on some devices\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\n\t\tif ( angleCos > spotLight.coneCos ) {\n\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\n\t\t} else {\n\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\n\t\t}\n\t}\n\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\n\t// Pre-computed values of LinearTransformedCosine approximation of BRDF\n\t// BRDF approximation Texture is 64x64\n\tuniform sampler2D ltc_1; // RGBA Float\n\tuniform sampler2D ltc_2; // RGBA Float\n\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\t\tirradiance *= PI;\n\n\t\t#endif\n\n\t\treturn irradiance;\n\n\t}\n\n#endif\n",envmap_physical_pars_fragment="\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\n\tvec3 getLightProbeIndirectIrradiance(  const in GeometricContext geometry, const in int maxMIPLevel ) {\n\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\n\t\t\t// TODO: replace with properly filtered cubemaps and access the irradiance LOD level, be it the last LOD level\n\t\t\t// of a specular cubemap, or just the default level of a specially created irradiance cubemap.\n\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\n\t\t\t#else\n\n\t\t\t\t// force the bias high to get the last LOD level as it is the most blurred.\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\n\t\t#else\n\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\n\t\t#endif\n\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\n\t}\n\n\t// taken from here: http://casual-effects.blogspot.ca/2011/08/plausible-environment-lighting-in-two.html\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\n\t\t//float envMapWidth = pow( 2.0, maxMIPLevelScalar );\n\t\t//float desiredMIPLevel = log2( envMapWidth * sqrt( 3.0 ) ) - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\n\t\t// clamp to allowable LOD ranges.\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\n\t}\n\n\tvec3 getLightProbeIndirectRadiance(  const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\n\t\t#else\n\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\n\t\t#endif\n\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\n\t\t\t#else\n\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\n\t\t\t#else\n\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\n\t\t\t#else\n\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#endif\n\n\t\treturn envMapColor.rgb * envMapIntensity;\n\n\t}\n\n#endif\n",lights_phong_fragment="\nBlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment="\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\nstruct BlinnPhongMaterial {\n\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n\n};\n\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\n\t#ifdef TOON\n\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\n\t#else\n\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\n\t#endif\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *= PI; // punctual light\n\n\t#endif\n\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n\n}\n\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment="\nPhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat ); // Burley clearcoat model\n\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment="\nstruct PhysicalMaterial {\n\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n\n};\n\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\n\n// Clear coat directional hemishperical reflectance (this approximation should be improved)\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n\n}\n\n#if NUM_RECT_AREA_LIGHTS > 0\n\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight; // counterclockwise; light shines in local neg z direction\n\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\n\t\t// LTC Fresnel Approximation by Stephen Hill\n\t\t// http://blog.selfshadow.com/publications/s2016-advances/s2016_ltc_fresnel.pdf\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\n\t}\n\n#endif\n\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\n\tvec3 irradiance = dotNL * directLight.color;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *= PI; // punctual light\n\n\t#endif\n\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n\t#ifndef STANDARD\n\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\n\t#endif\n\n}\n\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\t// Defer to the IndirectSpecular function to compute\n\t// the indirectDiffuse if energy preservation is enabled.\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\n\t\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n\t#endif\n\n}\n\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\n\tfloat clearCoatInv = 1.0 - clearCoatDHR;\n\n\t// Both indirect specular and diffuse light accumulate here\n\t// if energy preservation enabled, and PMREM provided.\n\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\tvec3 singleScattering = vec3( 0.0 );\n\t\tvec3 multiScattering = vec3( 0.0 );\n\t\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\n\t\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\n\t\t// The multiscattering paper uses the below formula for calculating diffuse \n\t\t// for dielectrics, but this is already handled when initially computing the \n\t\t// specular and diffuse color, so we can just use the diffuseColor directly.\n\t\t//vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\t\tvec3 diffuse = material.diffuseColor;\n\n\t\treflectedLight.indirectSpecular += clearCoatInv * radiance * singleScattering;\n\t\treflectedLight.indirectDiffuse += multiScattering * cosineWeightedIrradiance;\n\t\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n\n\t#else\n\n\t\treflectedLight.indirectSpecular += clearCoatInv * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\n\t#endif\n\n\t#ifndef STANDARD\n\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\n\t#endif\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\n\n// ref: https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n\n}\n",lights_fragment_begin="\nGeometricContext geometry;\n\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\n\nIncidentLight directLight;\n\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tPointLight pointLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tpointLight = pointLights[ i ];\n\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\n#endif\n\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tSpotLight spotLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tspotLight = spotLights[ i ];\n\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\n#endif\n\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tDirectionalLight directionalLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tdirectionalLight = directionalLights[ i ];\n\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\n#endif\n\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\n\tRectAreaLight rectAreaLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\n\t}\n\n#endif\n\n#if defined( RE_IndirectDiffuse )\n\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\n\t\t}\n\n\t#endif\n\n#endif\n\n#if defined( RE_IndirectSpecular )\n\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n\n#endif\n",lights_fragment_maps="\n#if defined( RE_IndirectDiffuse )\n\n\t#ifdef USE_LIGHTMAP\n\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\t\tlightMapIrradiance *= PI; // factor of PI should not be present; included here to prevent breakage\n\n\t\t#endif\n\n\t\tirradiance += lightMapIrradiance;\n\n\t#endif\n\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\tirradiance += getLightProbeIndirectIrradiance(  geometry, maxMipLevel );\n\n\t#endif\n\n#endif\n\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\n\tradiance += getLightProbeIndirectRadiance(  geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance(  geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n\n#endif\n",lights_fragment_end="\n#if defined( RE_IndirectDiffuse )\n\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n\n#endif\n\n#if defined( RE_IndirectSpecular )\n\n\tRE_IndirectSpecular( radiance, irradiance, clearCoatRadiance, geometry, material, reflectedLight );\n\n#endif\n",logdepthbuf_fragment="\n#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n\n#endif\n",logdepthbuf_pars_fragment="\n#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\n#endif\n",logdepthbuf_pars_vertex="\n#ifdef USE_LOGDEPTHBUF\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvarying float vFragDepth;\n\n\t#else\n\n\t\tuniform float logDepthBufFC;\n\n\t#endif\n\n#endif\n",logdepthbuf_vertex="\n#ifdef USE_LOGDEPTHBUF\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\n\t#else\n\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\n\t\tgl_Position.z *= gl_Position.w;\n\n\t#endif\n\n#endif\n",map_fragment="\n#ifdef USE_MAP\n\n\tvec4 texelColor = texture2D( map, vUv );\n\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n\n#endif\n",map_pars_fragment="\n#ifdef USE_MAP\n\n\tuniform sampler2D map;\n\n#endif\n",map_particle_fragment="\n#ifdef USE_MAP\n\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n\n#endif\n",map_particle_pars_fragment="\n#ifdef USE_MAP\n\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n\n#endif\n",metalnessmap_fragment="\nfloat metalnessFactor = metalness;\n\n#ifdef USE_METALNESSMAP\n\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\n\t// reads channel B, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\n\tmetalnessFactor *= texelMetalness.b;\n\n#endif\n",metalnessmap_pars_fragment="\n#ifdef USE_METALNESSMAP\n\n\tuniform sampler2D metalnessMap;\n\n#endif\n",morphnormal_vertex="\n#ifdef USE_MORPHNORMALS\n\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n\n#endif\n",morphtarget_pars_vertex="\n#ifdef USE_MORPHTARGETS\n\n\t#ifndef USE_MORPHNORMALS\n\n\tuniform float morphTargetInfluences[ 8 ];\n\n\t#else\n\n\tuniform float morphTargetInfluences[ 4 ];\n\n\t#endif\n\n#endif\n",morphtarget_vertex="\n#ifdef USE_MORPHTARGETS\n\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\n\t#ifndef USE_MORPHNORMALS\n\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\n\t#endif\n\n#endif\n",normal_fragment_begin="\n#ifdef FLAT_SHADED\n\n\t// Workaround for Adreno/Nexus5 not able able to do dFdx( vViewPosition ) ...\n\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n\n#else\n\n\tvec3 normal = normalize( vNormal );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t#endif\n\n\t#ifdef USE_TANGENT\n\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t\t#endif\n\n\t#endif\n\n#endif\n",normal_fragment_maps="\n#ifdef USE_NORMALMAP\n\n\t#ifdef OBJECTSPACE_NORMALMAP\n\n\t\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0; // overrides both flatShading and attribute normals\n\n\t\t#ifdef FLIP_SIDED\n\n\t\t\tnormal = - normal;\n\n\t\t#endif\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t\t#endif\n\n\t\tnormal = normalize( normalMatrix * normal );\n\n\t#else // tangent-space normal map\n\n\t\t#ifdef USE_TANGENT\n\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy = normalScale * mapN.xy;\n\t\t\tnormal = normalize( vTBN * mapN );\n\n\t\t#else\n\n\t\t\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\n\t\t#endif\n\n\t#endif\n\n#elif defined( USE_BUMPMAP )\n\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n\n#endif\n",normalmap_pars_fragment="\n#ifdef USE_NORMALMAP\n\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\n\t#ifdef OBJECTSPACE_NORMALMAP\n\n\t\tuniform mat3 normalMatrix;\n\n\t#else\n\n\t\t// Per-Pixel Tangent Space Normal Mapping\n\t\t// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\n\n\t\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\n\t\t\t// Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\n\n\t\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\t\tvec2 st0 = dFdx( vUv.st );\n\t\t\tvec2 st1 = dFdy( vUv.st );\n\n\t\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s ); // we do not care about the magnitude\n\n\t\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\t\tvec3 N = normalize( surf_norm );\n\t\t\tmat3 tsn = mat3( S, T, N );\n\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\n\t\t\tmapN.xy *= normalScale;\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t\t\treturn normalize( tsn * mapN );\n\n\t\t}\n\n\t#endif\n\n#endif\n",packing="\nvec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\n\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\n\nconst float PackUpscale = 256. / 255.; // fraction -> 0..1 (including 1)\nconst float UnpackDownscale = 255. / 256.; // 0..1 -> fraction (excluding 1)\n\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\n\nconst float ShiftRight8 = 1. / 256.;\n\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8; // tidy overflow\n\treturn r * PackUpscale;\n}\n\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\n\n// NOTE: viewZ/eyeZ is < 0 when in front of the camera per OpenGL conventions\n\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\n\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment="\n#ifdef PREMULTIPLIED_ALPHA\n\n\t// Get get normal blending with premultipled, use with CustomBlending, OneFactor, OneMinusSrcAlphaFactor, AddEquation.\n\tgl_FragColor.rgb *= gl_FragColor.a;\n\n#endif\n",project_vertex="\nvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment="\n#if defined( DITHERING )\n\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n\n#endif\n",dithering_pars_fragment="\n#if defined( DITHERING )\n\n\t// based on https://www.shadertoy.com/view/MslGR8\n\tvec3 dithering( vec3 color ) {\n\t\t//Calculate grid position\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\n\t\t//Shift the individual colors differently, thus making it even harder to see the dithering pattern\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\n\t\t//modify shift acording to grid position.\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\n\t\t//shift the color by dither_shift\n\t\treturn color + dither_shift_RGB;\n\t}\n\n#endif\n",roughnessmap_fragment="\nfloat roughnessFactor = roughness;\n\n#ifdef USE_ROUGHNESSMAP\n\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\n\t// reads channel G, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\n\troughnessFactor *= texelRoughness.g;\n\n#endif\n",roughnessmap_pars_fragment="\n#ifdef USE_ROUGHNESSMAP\n\n\tuniform sampler2D roughnessMap;\n\n#endif\n",shadowmap_pars_fragment="\n#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHTS > 0\n\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHTS > 0\n\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\n\t#endif\n\n\t#if NUM_POINT_LIGHTS > 0\n\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\n\t}\n\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\n\t\tvec2 f = fract( uv * size + 0.5 );\n\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\n\t\treturn c;\n\n\t}\n\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\n\t\tfloat shadow = 1.0;\n\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\n\t\t// if ( something && something ) breaks ATI OpenGL shader compiler\n\t\t// if ( all( something, something ) ) using this instead\n\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n\t\tbool frustumTest = all( frustumTestVec );\n\n\t\tif ( frustumTest ) {\n\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\n\t\t#else // no percentage-closer filtering:\n\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\n\t\t#endif\n\n\t\t}\n\n\t\treturn shadow;\n\n\t}\n\n\t// cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D\n\t// vector suitable for 2D texture mapping. This code uses the following layout for the\n\t// 2D texture:\n\t//\n\t// xzXZ\n\t//  y Y\n\t//\n\t// Y - Positive y direction\n\t// y - Negative y direction\n\t// X - Positive x direction\n\t// x - Negative x direction\n\t// Z - Positive z direction\n\t// z - Negative z direction\n\t//\n\t// Source and test bed:\n\t// https://gist.github.com/tschw/da10c43c467ce8afd0c4\n\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\n\t\t// Number of texels to avoid at the edge of each square\n\n\t\tvec3 absV = abs( v );\n\n\t\t// Intersect unit cube\n\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\n\t\t// Apply scale to avoid seams\n\n\t\t// two texels less per square (one texel will do for NEAREST)\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\n\t\t// Unwrap\n\n\t\t// space: -1 ... 1 range for each square\n\t\t//\n\t\t// #X##\t\tdim    := ( 4 , 2 )\n\t\t//  # #\t\tcenter := ( 1 , 1 )\n\n\t\tvec2 planar = v.xy;\n\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\n\t\tif ( absV.z >= almostOne ) {\n\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\n\t\t} else if ( absV.x >= almostOne ) {\n\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\n\t\t} else if ( absV.y >= almostOne ) {\n\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\n\t\t}\n\n\t\t// Transform to UV space\n\n\t\t// scale := 0.5 / dim\n\t\t// translate := ( center + 0.5 ) / dim\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\n\t}\n\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\n\t\t// for point lights, the uniform @vShadowCoord is re-purposed to hold\n\t\t// the vector from the light to the world-space position of the fragment.\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\n\t\t// dp = normalized distance from light to fragment position\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?\n\t\tdp += shadowBias;\n\n\t\t// bd3D = base direction 3D\n\t\tvec3 bd3D = normalize( lightToPosition );\n\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\n\t\t#else // no percentage-closer filtering\n\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\n\t\t#endif\n\n\t}\n\n#endif\n",shadowmap_pars_vertex="\n#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHTS > 0\n\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHTS > 0\n\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\n\t#endif\n\n\t#if NUM_POINT_LIGHTS > 0\n\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\n\t#endif\n#endif\n",shadowmap_vertex="\n#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHTS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\n\t}\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHTS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\n\t}\n\n\t#endif\n\n\t#if NUM_POINT_LIGHTS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\n\t}\n\n\t#endif\n#endif\n",shadowmask_pars_fragment="\nfloat getShadowMask() {\n\n\tfloat shadow = 1.0;\n\n\t#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHTS > 0\n\n\tDirectionalLight directionalLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\n\t}\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHTS > 0\n\n\tSpotLight spotLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\n\t}\n\n\t#endif\n\n\t#if NUM_POINT_LIGHTS > 0\n\n\tPointLight pointLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\n\t}\n\n\t#endif\n\t#endif\n\n\treturn shadow;\n\n}\n",skinbase_vertex="\n#ifdef USE_SKINNING\n\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif\n",skinning_pars_vertex="\n#ifdef USE_SKINNING\n\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\n\t#ifdef BONE_TEXTURE\n\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\n\t\t\ty = dy * ( y + 0.5 );\n\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\n\t\t\treturn bone;\n\n\t\t}\n\n\t#else\n\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\n\t\t}\n\n\t#endif\n\n#endif\n",skinning_vertex="\n#ifdef USE_SKINNING\n\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n\n#endif\n",skinnormal_vertex="\n#ifdef USE_SKINNING\n\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\n\t#ifdef USE_TANGENT\n\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\n\t#endif\n\n#endif\n",specularmap_fragment="\nfloat specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n\n#else\n\n\tspecularStrength = 1.0;\n\n#endif\n",specularmap_pars_fragment="\n#ifdef USE_SPECULARMAP\n\n\tuniform sampler2D specularMap;\n\n#endif\n",tonemapping_fragment="\n#if defined( TONE_MAPPING )\n\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n\n#endif\n",tonemapping_pars_fragment="\n#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\n\n// exposure only\nvec3 LinearToneMapping( vec3 color ) {\n\n\treturn toneMappingExposure * color;\n\n}\n\n// source: https://www.cs.utah.edu/~reinhard/cdrom/\nvec3 ReinhardToneMapping( vec3 color ) {\n\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n\n}\n\n// source: http://filmicgames.com/archives/75\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\n\t// John Hable's filmic operator from Uncharted 2 video game\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n\n}\n\n// source: http://filmicgames.com/archives/75\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\n\t// optimized filmic operator by Jim Hejl and Richard Burgess-Dawson\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n\n}\n\n// source: https://knarkowicz.wordpress.com/2016/01/06/aces-filmic-tone-mapping-curve/\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n\n}\n",uv_pars_fragment="\n#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\n\tvarying vec2 vUv;\n\n#endif\n",uv_pars_vertex="\n#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n\n#endif\n",uv_vertex="\n#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\n#endif\n",uv2_pars_fragment="\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tvarying vec2 vUv2;\n\n#endif\n",uv2_pars_vertex="\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\n#endif\n",uv2_vertex="\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tvUv2 = uv2;\n\n#endif\n",worldpos_vertex="\n#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\n#endif\n",background_frag="\nuniform sampler2D t2D;\n\nvarying vec2 vUv;\n\nvoid main() {\n\n\tvec4 texColor = texture2D( t2D, vUv );\n\n\tgl_FragColor = mapTexelToLinear( texColor );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\n}\n",background_vert="\nvarying vec2 vUv;\nuniform mat3 uvTransform;\n\nvoid main() {\n\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n\n}\n",cube_frag="\nuniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\n\nvarying vec3 vWorldDirection;\n\nvoid main() {\n\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\n\tgl_FragColor = mapTexelToLinear( texColor );\n\tgl_FragColor.a *= opacity;\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\n}\n",cube_vert="\nvarying vec3 vWorldDirection;\n\n#include <common>\n\nvoid main() {\n\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\n\tgl_Position.z = gl_Position.w; // set z to camera.far\n\n}\n",depth_frag="\n#if DEPTH_PACKING == 3200\n\n\tuniform float opacity;\n\n#endif\n\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( 1.0 );\n\n\t#if DEPTH_PACKING == 3200\n\n\t\tdiffuseColor.a = opacity;\n\n\t#endif\n\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\t#include <logdepthbuf_fragment>\n\n\t#if DEPTH_PACKING == 3200\n\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\n\t#elif DEPTH_PACKING == 3201\n\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\n\t#endif\n\n}\n",depth_vert="\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_DISPLACEMENTMAP\n\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n}\n",distanceRGBA_frag="\n#define DISTANCE\n\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main () {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( 1.0 );\n\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist ); // clamp to [ 0, 1 ]\n\n\tgl_FragColor = packDepthToRGBA( dist );\n\n}\n",distanceRGBA_vert="\n#define DISTANCE\n\nvarying vec3 vWorldPosition;\n\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_DISPLACEMENTMAP\n\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvWorldPosition = worldPosition.xyz;\n\n}\n",equirect_frag="\nuniform sampler2D tEquirect;\n\nvarying vec3 vWorldDirection;\n\n#include <common>\n\nvoid main() {\n\n\tvec3 direction = normalize( vWorldDirection );\n\n\tvec2 sampleUV;\n\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\n\tgl_FragColor = mapTexelToLinear( texColor );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\n}\n",equirect_vert="\nvarying vec3 vWorldDirection;\n\n#include <common>\n\nvoid main() {\n\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\n}\n",linedashed_frag="\nuniform vec3 diffuse;\nuniform float opacity;\n\nuniform float dashSize;\nuniform float totalSize;\n\nvarying float vLineDistance;\n\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\n\t\tdiscard;\n\n\t}\n\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\n\toutgoingLight = diffuseColor.rgb; // simple shader\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\n}\n",linedashed_vert="\nuniform float scale;\nattribute float lineDistance;\n\nvarying float vLineDistance;\n\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <color_vertex>\n\n\tvLineDistance = scale * lineDistance;\n\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\n}\n",meshbasic_frag="\nuniform vec3 diffuse;\nuniform float opacity;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\n\t// accumulation (baked indirect lighting only)\n\t#ifdef USE_LIGHTMAP\n\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\n\t#else\n\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\n\t#endif\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\n}\n",meshbasic_vert="\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_ENVMAP\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n\n}\n",meshlambert_frag="\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\n\t#else\n\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\n\t#endif\n\n\t#include <lightmap_fragment>\n\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\n\t#else\n\n\t\treflectedLight.directDiffuse = vLightFront;\n\n\t#endif\n\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert="\n#define LAMBERT\n\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshmatcap_frag="\n#define MATCAP\n\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks\n\n\t#ifdef USE_MATCAP\n\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\n\t#else\n\n\t\tvec4 matcapColor = vec4( 1.0 );\n\n\t#endif\n\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\n}\n",meshmatcap_vert="\n#define MATCAP\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\t\tvNormal = normalize( transformedNormal );\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n}\n",meshphong_frag="\n#define PHONG\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n",meshphong_vert="\n#define PHONG\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n",meshphysical_frag="\n#define PHYSICAL\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n",meshphysical_vert="\n#define PHYSICAL\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n\t#ifdef USE_TANGENT\n\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\n\t#endif\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n",normal_frag="\n#define NORMAL\n\nuniform float opacity;\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\n\tvarying vec3 vViewPosition;\n\n#endif\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n\nvoid main() {\n\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\n}\n",normal_vert="\n#define NORMAL\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\n\tvarying vec3 vViewPosition;\n\n#endif\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n\t#ifdef USE_TANGENT\n\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\n\t#endif\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\n\tvViewPosition = - mvPosition.xyz;\n\n#endif\n\n}\n",points_frag="\nuniform vec3 diffuse;\nuniform float opacity;\n\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\n\toutgoingLight = diffuseColor.rgb;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\n}\n",points_vert="\nuniform float size;\nuniform float scale;\n\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\n\tgl_PointSize = size;\n\n\t#ifdef USE_SIZEATTENUATION\n\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\n\t#endif\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n\n}\n",shadow_frag="\nuniform vec3 color;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n\nvoid main() {\n\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\n\t#include <fog_fragment>\n\n}\n",shadow_vert="\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n\nvoid main() {\n\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n",sprite_frag="\nuniform vec3 diffuse;\nuniform float opacity;\n\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphatest_fragment>\n\n\toutgoingLight = diffuseColor.rgb;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\n}\n",sprite_vert="\nuniform float rotation;\nuniform vec2 center;\n\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\n\t#ifndef USE_SIZEATTENUATION\n\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\n\t#endif\n\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\n\tmvPosition.xy += rotatedPosition;\n\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\n}\n",ShaderChunk={alphamap_fragment:alphamap_fragment,alphamap_pars_fragment:alphamap_pars_fragment,alphatest_fragment:alphatest_fragment,aomap_fragment:aomap_fragment,aomap_pars_fragment:aomap_pars_fragment,begin_vertex:begin_vertex,beginnormal_vertex:beginnormal_vertex,bsdfs:bsdfs,bumpmap_pars_fragment:bumpmap_pars_fragment,clipping_planes_fragment:clipping_planes_fragment,clipping_planes_pars_fragment:clipping_planes_pars_fragment,clipping_planes_pars_vertex:clipping_planes_pars_vertex,clipping_planes_vertex:clipping_planes_vertex,color_fragment:color_fragment,color_pars_fragment:color_pars_fragment,color_pars_vertex:color_pars_vertex,color_vertex:color_vertex,common:common,cube_uv_reflection_fragment:cube_uv_reflection_fragment,defaultnormal_vertex:defaultnormal_vertex,displacementmap_pars_vertex:displacementmap_pars_vertex,displacementmap_vertex:displacementmap_vertex,emissivemap_fragment:emissivemap_fragment,emissivemap_pars_fragment:emissivemap_pars_fragment,encodings_fragment:encodings_fragment,encodings_pars_fragment:encodings_pars_fragment,envmap_fragment:envmap_fragment,envmap_pars_fragment:envmap_pars_fragment,envmap_pars_vertex:envmap_pars_vertex,envmap_physical_pars_fragment:envmap_physical_pars_fragment,envmap_vertex:envmap_vertex,fog_vertex:fog_vertex,fog_pars_vertex:fog_pars_vertex,fog_fragment:fog_fragment,fog_pars_fragment:fog_pars_fragment,gradientmap_pars_fragment:gradientmap_pars_fragment,lightmap_fragment:lightmap_fragment,lightmap_pars_fragment:lightmap_pars_fragment,lights_lambert_vertex:lights_lambert_vertex,lights_pars_begin:lights_pars_begin,lights_phong_fragment:lights_phong_fragment,lights_phong_pars_fragment:lights_phong_pars_fragment,lights_physical_fragment:lights_physical_fragment,lights_physical_pars_fragment:lights_physical_pars_fragment,lights_fragment_begin:lights_fragment_begin,lights_fragment_maps:lights_fragment_maps,lights_fragment_end:lights_fragment_end,logdepthbuf_fragment:logdepthbuf_fragment,logdepthbuf_pars_fragment:logdepthbuf_pars_fragment,logdepthbuf_pars_vertex:logdepthbuf_pars_vertex,logdepthbuf_vertex:logdepthbuf_vertex,map_fragment:map_fragment,map_pars_fragment:map_pars_fragment,map_particle_fragment:map_particle_fragment,map_particle_pars_fragment:map_particle_pars_fragment,metalnessmap_fragment:metalnessmap_fragment,metalnessmap_pars_fragment:metalnessmap_pars_fragment,morphnormal_vertex:morphnormal_vertex,morphtarget_pars_vertex:morphtarget_pars_vertex,morphtarget_vertex:morphtarget_vertex,normal_fragment_begin:normal_fragment_begin,normal_fragment_maps:normal_fragment_maps,normalmap_pars_fragment:normalmap_pars_fragment,packing:packing,premultiplied_alpha_fragment:premultiplied_alpha_fragment,project_vertex:project_vertex,dithering_fragment:dithering_fragment,dithering_pars_fragment:dithering_pars_fragment,roughnessmap_fragment:roughnessmap_fragment,roughnessmap_pars_fragment:roughnessmap_pars_fragment,shadowmap_pars_fragment:shadowmap_pars_fragment,shadowmap_pars_vertex:shadowmap_pars_vertex,shadowmap_vertex:shadowmap_vertex,shadowmask_pars_fragment:shadowmask_pars_fragment,skinbase_vertex:skinbase_vertex,skinning_pars_vertex:skinning_pars_vertex,skinning_vertex:skinning_vertex,skinnormal_vertex:skinnormal_vertex,specularmap_fragment:specularmap_fragment,specularmap_pars_fragment:specularmap_pars_fragment,tonemapping_fragment:tonemapping_fragment,tonemapping_pars_fragment:tonemapping_pars_fragment,uv_pars_fragment:uv_pars_fragment,uv_pars_vertex:uv_pars_vertex,uv_vertex:uv_vertex,uv2_pars_fragment:uv2_pars_fragment,uv2_pars_vertex:uv2_pars_vertex,uv2_vertex:uv2_vertex,worldpos_vertex:worldpos_vertex,background_frag:background_frag,background_vert:background_vert,cube_frag:cube_frag,cube_vert:cube_vert,depth_frag:depth_frag,depth_vert:depth_vert,distanceRGBA_frag:distanceRGBA_frag,distanceRGBA_vert:distanceRGBA_vert,equirect_frag:equirect_frag,equirect_vert:equirect_vert,linedashed_frag:linedashed_frag,linedashed_vert:linedashed_vert,meshbasic_frag:meshbasic_frag,meshbasic_vert:meshbasic_vert,meshlambert_frag:meshlambert_frag,meshlambert_vert:meshlambert_vert,meshmatcap_frag:meshmatcap_frag,meshmatcap_vert:meshmatcap_vert,meshphong_frag:meshphong_frag,meshphong_vert:meshphong_vert,meshphysical_frag:meshphysical_frag,meshphysical_vert:meshphysical_vert,normal_frag:normal_frag,normal_vert:normal_vert,points_frag:points_frag,points_vert:points_vert,shadow_frag:shadow_frag,shadow_vert:shadow_vert,sprite_frag:sprite_frag,sprite_vert:sprite_vert},UniformsLib={common:{diffuse:{value:new Color(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Matrix3},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Vector2(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Color(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Color(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new Matrix3}},sprite:{diffuse:{value:new Color(15658734)},opacity:{value:1},center:{value:new Vector2(.5,.5)},rotation:{value:0},map:{value:null},uvTransform:{value:new Matrix3}}},ShaderLib={basic:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.fog]),vertexShader:ShaderChunk.meshbasic_vert,fragmentShader:ShaderChunk.meshbasic_frag},lambert:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)}}]),vertexShader:ShaderChunk.meshlambert_vert,fragmentShader:ShaderChunk.meshlambert_frag},phong:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.gradientmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)},specular:{value:new Color(1118481)},shininess:{value:30}}]),vertexShader:ShaderChunk.meshphong_vert,fragmentShader:ShaderChunk.meshphong_frag},standard:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.roughnessmap,UniformsLib.metalnessmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag},matcap:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,{matcap:{value:null}}]),vertexShader:ShaderChunk.meshmatcap_vert,fragmentShader:ShaderChunk.meshmatcap_frag},points:{uniforms:mergeUniforms([UniformsLib.points,UniformsLib.fog]),vertexShader:ShaderChunk.points_vert,fragmentShader:ShaderChunk.points_frag},dashed:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ShaderChunk.linedashed_vert,fragmentShader:ShaderChunk.linedashed_frag},depth:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap]),vertexShader:ShaderChunk.depth_vert,fragmentShader:ShaderChunk.depth_frag},normal:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,{opacity:{value:1}}]),vertexShader:ShaderChunk.normal_vert,fragmentShader:ShaderChunk.normal_frag},sprite:{uniforms:mergeUniforms([UniformsLib.sprite,UniformsLib.fog]),vertexShader:ShaderChunk.sprite_vert,fragmentShader:ShaderChunk.sprite_frag},background:{uniforms:{uvTransform:{value:new Matrix3},t2D:{value:null}},vertexShader:ShaderChunk.background_vert,fragmentShader:ShaderChunk.background_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ShaderChunk.cube_vert,fragmentShader:ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ShaderChunk.equirect_vert,fragmentShader:ShaderChunk.equirect_frag},distanceRGBA:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap,{referencePosition:{value:new Vector3},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ShaderChunk.distanceRGBA_vert,fragmentShader:ShaderChunk.distanceRGBA_frag},shadow:{uniforms:mergeUniforms([UniformsLib.lights,UniformsLib.fog,{color:{value:new Color(0)},opacity:{value:1}}]),vertexShader:ShaderChunk.shadow_vert,fragmentShader:ShaderChunk.shadow_frag}};ShaderLib.physical={uniforms:mergeUniforms([ShaderLib.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag};var OutlineEffect=function(e,t){t=t||{},this.enabled=!0;var r=void 0!==t.defaultThickness?t.defaultThickness:.003,n=(new Color).fromArray(void 0!==t.defaultColor?t.defaultColor:[0,0,0]),i=void 0!==t.defaultAlpha?t.defaultAlpha:1,o=void 0!==t.defaultKeepAlive&&t.defaultKeepAlive,a={},s=60,l={},u={},c={MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical"},h={outlineThickness:{type:"f",value:r},outlineColor:{type:"c",value:n},outlineAlpha:{type:"f",value:i}},p=["#include <fog_pars_vertex>","uniform float outlineThickness;","vec4 calculateOutline( vec4 pos, vec3 objectNormal, vec4 skinned ) {","\tfloat thickness = outlineThickness;","\tconst float ratio = 1.0;","\tvec4 pos2 = projectionMatrix * modelViewMatrix * vec4( skinned.xyz + objectNormal, 1.0 );","\tvec4 norm = normalize( pos - pos2 );","\treturn pos + norm * thickness * pos.w * ratio;","}"].join("\n"),f=["#if ! defined( LAMBERT ) && ! defined( PHONG ) && ! defined( TOON ) && ! defined( PHYSICAL )","\t#ifndef USE_ENVMAP","\t\tvec3 objectNormal = normalize( normal );","\t#endif","#endif","#ifdef FLIP_SIDED","\tobjectNormal = -objectNormal;","#endif","#ifdef DECLARE_TRANSFORMED","\tvec3 transformed = vec3( position );","#endif","gl_Position = calculateOutline( gl_Position, objectNormal, vec4( transformed, 1.0 ) );","#include <fog_vertex>"].join("\n"),d=["#include <common>","#include <fog_pars_fragment>","uniform vec3 outlineColor;","uniform float outlineAlpha;","void main() {","\tgl_FragColor = vec4( outlineColor, outlineAlpha );","\t#include <fog_fragment>","}"].join("\n");function m(){return new ShaderMaterial({name:"invisible",visible:!1})}function v(e){var t,r,n=c[e.type];e.userData.outlineParameters;if(void 0!==n){var i=ShaderLib[n];t=i.uniforms,r=i.vertexShader}else if(!0===e.isRawShaderMaterial){if(t=e.uniforms,r=e.vertexShader,!/attribute\s+vec3\s+position\s*;/.test(r)||!/attribute\s+vec3\s+normal\s*;/.test(r))return console.warn("OutlineEffect requires both vec3 position and normal attributes in vertex shader, does not draw outline for "+e.name+"(uuid:"+e.uuid+") material."),m()}else{if(!0!==e.isShaderMaterial)return m();t=e.uniforms,r=e.vertexShader}var o=Object.assign({},t,h),a=r.replace(/void\s+main\s*\(\s*\)/,p+"\nvoid main()").replace(/\}\s*$/,f+"\n}").replace(/#include\s+<[\w_]*light[\w_]*>/g,""),s={};return/vec3\s+transformed\s*=/.test(r)||/#include\s+<begin_vertex>/.test(r)||(s.DECLARE_TRANSFORMED=!0),new ShaderMaterial({defines:s,uniforms:o,vertexShader:a,fragmentShader:d,side:BackSide,skinning:!1,morphTargets:!1,morphNormals:!1,fog:!1})}function g(e){var t=function(e){var t=a[e.uuid];return void 0===t&&(t={material:v(e),used:!0,keepAlive:o,count:0},a[e.uuid]=t),t.used=!0,t.material}(e);return l[t.uuid]=e,function(e,t){if("invisible"===e.name)return;var r=t.userData.outlineParameters;e.skinning=t.skinning,e.morphTargets=t.morphTargets,e.morphNormals=t.morphNormals,e.fog=t.fog,void 0!==r?(!1===t.visible?e.visible=!1:e.visible=void 0===r.visible||r.visible,e.transparent=void 0!==r.alpha&&r.alpha<1||t.transparent,void 0!==r.keepAlive&&(a[t.uuid].keepAlive=r.keepAlive)):(e.transparent=t.transparent,e.visible=t.visible);!0!==t.wireframe&&!1!==t.depthTest||(e.visible=!1)}(t,e),t}function y(e){if(void 0!==e.material){if(Array.isArray(e.material))for(var t=0,r=e.material.length;t<r;t++)e.material[t]=g(e.material[t]);else e.material=g(e.material);u[e.uuid]=e.onBeforeRender,e.onBeforeRender=x}}function b(e){if(void 0!==e.material){if(Array.isArray(e.material))for(var t=0,r=e.material.length;t<r;t++)e.material[t]=l[e.material[t].uuid];else e.material=l[e.material.uuid];e.onBeforeRender=u[e.uuid]}}function x(e,t,r,n,i,o){var a=l[i.uuid];void 0!==a&&function(e,t){var r=t.userData.outlineParameters;e.uniforms.outlineAlpha.value=t.opacity,void 0!==r&&(void 0!==r.thickness&&(e.uniforms.outlineThickness.value=r.thickness),void 0!==r.color&&e.uniforms.outlineColor.value.fromArray(r.color),void 0!==r.alpha&&(e.uniforms.outlineAlpha.value=r.alpha))}(i,a)}this.render=function(t,r){var n=null,i=!1;if(void 0!==arguments[2]&&(console.warn("OutlineEffect.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),n=arguments[2]),void 0!==arguments[3]&&(console.warn("OutlineEffect.render(): the forceClear argument has been removed. Use .clear() instead."),i=arguments[3]),e.setRenderTarget(n),i&&e.clear(),!1!==this.enabled){var o=e.autoClear;e.autoClear=this.autoClear,e.render(t,r);var c=t.autoUpdate,h=t.background,p=e.shadowMap.enabled;t.autoUpdate=!1,t.background=null,e.autoClear=!1,e.shadowMap.enabled=!1,t.traverse(y),e.render(t,r),t.traverse(b),function(){for(var e,t=0,r=(e=Object.keys(l)).length;t<r;t++)l[e[t]]=void 0;for(t=0,r=(e=Object.keys(u)).length;t<r;t++)u[e[t]]=void 0;for(t=0,r=(e=Object.keys(a)).length;t<r;t++){var n=e[t];!1===a[n].used?(a[n].count++,!1===a[n].keepAlive&&a[n].count>s&&delete a[n]):(a[n].used=!1,a[n].count=0)}}(),t.autoUpdate=c,t.background=h,e.autoClear=o,e.shadowMap.enabled=p}else e.render(t,r)},this.autoClear=e.autoClear,this.domElement=e.domElement,this.shadowMap=e.shadowMap,this.clear=function(t,r,n){e.clear(t,r,n)},this.getPixelRatio=function(){return e.getPixelRatio()},this.setPixelRatio=function(t){e.setPixelRatio(t)},this.getSize=function(t){return e.getSize(t)},this.setSize=function(t,r,n){e.setSize(t,r,n)},this.setViewport=function(t,r,n,i){e.setViewport(t,r,n,i)},this.setScissor=function(t,r,n,i){e.setScissor(t,r,n,i)},this.setScissorTest=function(t){e.setScissorTest(t)},this.setRenderTarget=function(t){e.setRenderTarget(t)}},ParallaxBarrierEffect=function(e){var t=new OrthographicCamera(-1,1,1,-1,0,1),r=new Scene,n=new StereoCamera,i={minFilter:LinearFilter,magFilter:NearestFilter,format:RGBAFormat},o=new WebGLRenderTarget(512,512,i),a=new WebGLRenderTarget(512,512,i),s=new ShaderMaterial({uniforms:{mapLeft:{value:o.texture},mapRight:{value:a.texture}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = vec2( uv.x, uv.y );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D mapLeft;","uniform sampler2D mapRight;","varying vec2 vUv;","void main() {","\tvec2 uv = vUv;","\tif ( ( mod( gl_FragCoord.y, 2.0 ) ) > 1.00 ) {","\t\tgl_FragColor = texture2D( mapLeft, uv );","\t} else {","\t\tgl_FragColor = texture2D( mapRight, uv );","\t}","}"].join("\n")}),l=new Mesh(new PlaneBufferGeometry(2,2),s);r.add(l),this.setSize=function(t,r){e.setSize(t,r);var n=e.getPixelRatio();o.setSize(t*n,r*n),a.setSize(t*n,r*n)},this.render=function(i,s){i.updateMatrixWorld(),null===s.parent&&s.updateMatrixWorld(),n.update(s),e.setRenderTarget(o),e.clear(),e.render(i,n.cameraL),e.setRenderTarget(a),e.clear(),e.render(i,n.cameraR),e.setRenderTarget(null),e.render(r,t)}},PeppersGhostEffect=function(e){var t,r,n,i=this;i.cameraDistance=15,i.reflectFromAbove=!1;var o=new PerspectiveCamera,a=new PerspectiveCamera,s=new PerspectiveCamera,l=new PerspectiveCamera,u=new Vector3,c=new Quaternion,h=new Vector3;e.autoClear=!1,this.setSize=function(i,o){t=i/2,i<o?(r=i/3,n=i/3):(r=o/3,n=o/3),e.setSize(i,o)},this.render=function(p,f){p.updateMatrixWorld(),null===f.parent&&f.updateMatrixWorld(),f.matrixWorld.decompose(u,c,h),o.position.copy(u),o.quaternion.copy(c),o.translateZ(i.cameraDistance),o.lookAt(p.position),a.position.copy(u),a.quaternion.copy(c),a.translateZ(-i.cameraDistance),a.lookAt(p.position),a.rotation.z+=Math.PI/180*180,s.position.copy(u),s.quaternion.copy(c),s.translateX(-i.cameraDistance),s.lookAt(p.position),s.rotation.x+=Math.PI/180*90,l.position.copy(u),l.quaternion.copy(c),l.translateX(i.cameraDistance),l.lookAt(p.position),l.rotation.x+=Math.PI/180*90,e.clear(),e.setScissorTest(!0),e.setScissor(t-r/2,2*n,r,n),e.setViewport(t-r/2,2*n,r,n),i.reflectFromAbove?e.render(p,a):e.render(p,o),e.setScissor(t-r/2,0,r,n),e.setViewport(t-r/2,0,r,n),i.reflectFromAbove?e.render(p,o):e.render(p,a),e.setScissor(t-r/2-r,n,r,n),e.setViewport(t-r/2-r,n,r,n),i.reflectFromAbove?e.render(p,l):e.render(p,s),e.setScissor(t+r/2,n,r,n),e.setViewport(t+r/2,n,r,n),i.reflectFromAbove?e.render(p,s):e.render(p,l),e.setScissorTest(!1)}},StereoEffect=function(e){var t=new StereoCamera;t.aspect=.5;var r=new Vector2;this.setEyeSeparation=function(e){t.eyeSep=e},this.setSize=function(t,r){e.setSize(t,r)},this.render=function(n,i){n.updateMatrixWorld(),null===i.parent&&i.updateMatrixWorld(),t.update(i),e.getSize(r),e.autoClear&&e.clear(),e.setScissorTest(!0),e.setScissor(0,0,r.width/2,r.height),e.setViewport(0,0,r.width/2,r.height),e.render(n,t.cameraL),e.setScissor(r.width/2,0,r.width/2,r.height),e.setViewport(r.width/2,0,r.width/2,r.height),e.render(n,t.cameraR),e.setScissorTest(!1)}};function MeshLambertMaterial(e){Material$1.call(this),this.type="MeshLambertMaterial",this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}MeshLambertMaterial.prototype=Object.create(Material$1.prototype),MeshLambertMaterial.prototype.constructor=MeshLambertMaterial,MeshLambertMaterial.prototype.isMeshLambertMaterial=!0,MeshLambertMaterial.prototype.copy=function(e){return Material$1.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};var ColladaExporter=function(){};ColladaExporter.prototype={constructor:ColladaExporter,parse:function(e,t,r){void 0===r&&(r={}),""!==(r=Object.assign({version:"1.4.1",author:null,textureDirectory:""},r)).textureDirectory&&(r.textureDirectory=(r.textureDirectory+"/").replace(/\\/g,"/").replace(/\/+/g,"/"));var n,i,o=r.version;if("1.4.1"!==o&&"1.5.0"!==o)return console.warn("ColladaExporter : Version "+o+" not supported for export. Only 1.4.1 and 1.5.0."),null;function a(e,t){return n=n||document.createElement("canvas"),i=i||n.getContext("2d"),n.width=e.naturalWidth,n.height=e.naturalHeight,i.drawImage(e,0,0),function(e){for(var t=atob(e),r=new Uint8Array(t.length),n=0,i=r.length;n<i;n++)r[n]=t.charCodeAt(n);return r}(n.toDataURL("image/"+t,1).replace(/^data:image\/(png|jpg);base64,/,""))}var s,l=["getX","getY","getZ","getW"];function u(e){if(e.isInterleavedBufferAttribute){for(var t=new e.array.constructor(e.count*e.itemSize),r=e.itemSize,n=0,i=e.count;n<i;n++)for(var o=0;o<r;o++)t[n*r+o]=e[l[o]](n);return t}return e.array}function c(e,t,r,n){var i=u(e);return'<source id="'+t+'"><float_array id="'+t+'-array" count="'+i.length+'">'+i.join(" ")+'</float_array><technique_common><accessor source="#'+t+'-array" count="'+Math.floor(i.length/e.itemSize)+'" stride="'+e.itemSize+'">'+r.map(function(e){return'<param name="'+e+'" type="'+n+'" />'}).join("")+"</accessor></technique_common></source>"}function h(e){var t=d.get(e);if(null==t){t="image-"+(v.length+1);var n=e.name||t,i='<image id="'+t+'" name="'+n+'">';i+="1.5.0"===o?"<init_from><ref>"+r.textureDirectory+n+".png</ref></init_from>":"<init_from>"+r.textureDirectory+n+".png</init_from>",i+="</image>",v.push(i),d.set(e,t),m.push({directory:r.textureDirectory,name:n,ext:"png",data:a(e.image,"png"),original:e})}return t}var p=new WeakMap,f=new WeakMap,d=new WeakMap,m=[],v=[],g=[],y=[],b=[],x=function e(t){var r='<node name="'+t.name+'">';if(r+=function(e){return e.updateMatrix(),(s=s||new Matrix4).copy(e.matrix),s.transpose(),"<matrix>"+s.toArray().join(" ")+"</matrix>"}(t),t instanceof Mesh&&null!=t.geometry){var n=function(e){var t,r,n,i=p.get(e);if(!i){var o=e;o instanceof Geometry&&(o=(new BufferGeometry).fromGeometry(o));var a="Mesh"+(g.length+1),s=o.index?o.index.count*o.index.itemSize:o.attributes.position.count,l=null!=o.groups&&0!==o.groups.length?o.groups:[{start:0,count:s,materialIndex:0}],h='<geometry id="'+a+'" name="'+e.name+'"><mesh>',f=a+"-position",d=a+"-vertices";h+=c(o.attributes.position,f,["X","Y","Z"],"float"),h+='<vertices id="'+d+'"><input semantic="POSITION" source="#'+f+'" /></vertices>';var m='<input semantic="VERTEX" source="#'+d+'" offset="0" />';if("normal"in o.attributes){var v=a+"-normal";h+=c(o.attributes.normal,v,["X","Y","Z"],"float"),m+='<input semantic="NORMAL" source="#'+v+'" offset="0" />'}if("uv"in o.attributes){var y=a+"-texcoord";h+=c(o.attributes.uv,y,["S","T"],"float"),m+='<input semantic="TEXCOORD" source="#'+y+'" offset="0" set="0" />'}if("color"in o.attributes){var b=a+"-color";h+=c(o.attributes.color,b,["X","Y","Z"],"uint8"),m+='<input semantic="COLOR" source="#'+b+'" offset="0" />'}var x=null;if(o.index)x=u(o.index);else for(var w=0,S=(x=new Array(s)).length;w<S;w++)x[w]=w;for(w=0,S=l.length;w<S;w++){var M=l[w],_=(t=x,r=M.start,n=M.count,Array.isArray(t)?t.slice(r,r+n):new t.constructor(t.buffer,r*t.BYTES_PER_ELEMENT,n)),T=_.length/3;h+='<triangles material="MESH_MATERIAL_'+M.materialIndex+'" count="'+T+'">',h+=m,h+="<p>"+_.join(" ")+"</p>",h+="</triangles>"}h+="</mesh></geometry>",g.push(h),i={meshid:a,bufferGeometry:o},p.set(e,i)}return i}(t.geometry),i=n.meshid,o=n.bufferGeometry,a=null,l=t.material||new MeshBasicMaterial,d=Array.isArray(l)?l:[l];a=(o.groups.length>d.length?new Array(o.groups.length):new Array(d.length)).fill().map(function(e,t){return function(e){var t=f.get(e);if(null==t){t="Mat"+(y.length+1);var r="phong";e instanceof MeshLambertMaterial?r="lambert":e instanceof MeshBasicMaterial&&(r="constant",null!==e.map&&console.warn("ColladaExporter: Texture maps not supported with MeshBasicMaterial."));var n=e.emissive?e.emissive:new Color(0,0,0),i=e.color?e.color:new Color(0,0,0),o=e.specular?e.specular:new Color(1,1,1),a=e.shininess||0,s=e.reflectivity||0,l="";!0===e.transparent&&(l+="<transparent>"+(e.map?'<texture texture="diffuse-sampler"></texture>':"<float>1</float>")+"</transparent>",e.opacity<1&&(l+="<transparency><float>"+e.opacity+"</float></transparency>"));var u='<technique sid="common"><'+r+"><emission>"+(e.emissiveMap?'<texture texture="emissive-sampler" texcoord="TEXCOORD" />':'<color sid="emission">'+n.r+" "+n.g+" "+n.b+" 1</color>")+"</emission>"+("constant"!==r?"<diffuse>"+(e.map?'<texture texture="diffuse-sampler" texcoord="TEXCOORD" />':'<color sid="diffuse">'+i.r+" "+i.g+" "+i.b+" 1</color>")+"</diffuse>":"")+("phong"===r?'<specular><color sid="specular">'+o.r+" "+o.g+" "+o.b+" 1</color></specular><shininess>"+(e.specularMap?'<texture texture="specular-sampler" texcoord="TEXCOORD" />':'<float sid="shininess">'+a+"</float>")+"</shininess>":"")+"<reflective><color>"+i.r+" "+i.g+" "+i.b+" 1</color></reflective><reflectivity><float>"+s+"</float></reflectivity>"+l+"</"+r+"></technique>",c='<effect id="'+t+'-effect"><profile_COMMON>'+(e.map?'<newparam sid="diffuse-surface"><surface type="2D"><init_from>'+h(e.map)+'</init_from></surface></newparam><newparam sid="diffuse-sampler"><sampler2D><source>diffuse-surface</source></sampler2D></newparam>':"")+(e.specularMap?'<newparam sid="specular-surface"><surface type="2D"><init_from>'+h(e.specularMap)+'</init_from></surface></newparam><newparam sid="specular-sampler"><sampler2D><source>specular-surface</source></sampler2D></newparam>':"")+(e.emissiveMap?'<newparam sid="emissive-surface"><surface type="2D"><init_from>'+h(e.emissiveMap)+'</init_from></surface></newparam><newparam sid="emissive-sampler"><sampler2D><source>emissive-surface</source></sampler2D></newparam>':"")+u+(e.side===DoubleSide?'<extra><technique><double_sided sid="double_sided" type="int">1</double_sided></technique></extra>':"")+"</profile_COMMON></effect>";b.push('<material id="'+t+'" name="'+e.name+'"><instance_effect url="#'+t+'-effect" /></material>'),y.push(c),f.set(e,t)}return t}(d[t%d.length])}),r+='<instance_geometry url="#'+i+'">'+(null!=a?"<bind_material><technique_common>"+a.map(function(e,t){return'<instance_material symbol="MESH_MATERIAL_'+t+'" target="#'+e+'" ><bind_vertex_input semantic="TEXCOORD" input_semantic="TEXCOORD" input_set="0" /></instance_material>'}).join("")+"</technique_common></bind_material>":"")+"</instance_geometry>"}return t.children.forEach(function(t){return r+=e(t)}),r+="</node>"}(e),w='<?xml version="1.0" encoding="UTF-8" standalone="no" ?><COLLADA xmlns="'+("1.4.1"===o?"http://www.collada.org/2005/11/COLLADASchema":"https://www.khronos.org/collada/")+'" version="'+o+'"><asset><contributor><authoring_tool>js Collada Exporter</authoring_tool>'+(null!==r.author?"<author>"+r.author+"</author>":"")+"</contributor><created>"+(new Date).toISOString()+"</created><modified>"+(new Date).toISOString()+"</modified><up_axis>Y_UP</up_axis></asset>";w+="<library_images>"+v.join("")+"</library_images>",w+="<library_effects>"+y.join("")+"</library_effects>",w+="<library_materials>"+b.join("")+"</library_materials>",w+="<library_geometries>"+g.join("")+"</library_geometries>",w+='<library_visual_scenes><visual_scene id="Scene" name="scene">'+x+"</visual_scene></library_visual_scenes>",w+='<scene><instance_visual_scene url="#Scene"/></scene>';var S={data:function(e){var t=/^<\//,r=/(\?>$)|(\/>$)/,n=/<[^>]+>[^<]*<\/[^<]+>/,i=0;return e.match(/(<[^>]+>[^<]+<\/[^<]+>)|(<[^>]+>)/g).map(function(e){n.test(e)||r.test(e)||!t.test(e)||i--;var o=""+function e(t,r){return r>0?t+e(t,r-1):""}("  ",i)+e;return n.test(e)||r.test(e)||t.test(e)||i++,o}).join("\n")}(w+="</COLLADA>"),textures:m};return"function"===typeof t&&requestAnimationFrame(function(){return t(S)}),S}};var WEBGL_CONSTANTS={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,FLOAT:5126,UNSIGNED_INT:5125,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},THREE_TO_WEBGL={};THREE_TO_WEBGL[NearestFilter]=WEBGL_CONSTANTS.NEAREST,THREE_TO_WEBGL[NearestMipMapNearestFilter]=WEBGL_CONSTANTS.NEAREST_MIPMAP_NEAREST,THREE_TO_WEBGL[NearestMipMapLinearFilter]=WEBGL_CONSTANTS.NEAREST_MIPMAP_LINEAR,THREE_TO_WEBGL[LinearFilter]=WEBGL_CONSTANTS.LINEAR,THREE_TO_WEBGL[LinearMipMapNearestFilter]=WEBGL_CONSTANTS.LINEAR_MIPMAP_NEAREST,THREE_TO_WEBGL[LinearMipMapLinearFilter]=WEBGL_CONSTANTS.LINEAR_MIPMAP_LINEAR,THREE_TO_WEBGL[ClampToEdgeWrapping]=WEBGL_CONSTANTS.CLAMP_TO_EDGE,THREE_TO_WEBGL[RepeatWrapping]=WEBGL_CONSTANTS.REPEAT,THREE_TO_WEBGL[MirroredRepeatWrapping]=WEBGL_CONSTANTS.MIRRORED_REPEAT;var PATH_PROPERTIES={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},GLTFExporter=function(){};GLTFExporter.prototype={constructor:GLTFExporter,parse:function(e,t,r){(r=Object.assign({},{binary:!1,trs:!1,onlyVisible:!0,truncateDrawRange:!0,embedImages:!0,animations:[],forceIndices:!1,forcePowerOfTwoTextures:!1},r)).animations.length>0&&(r.trs=!0);var n,i={asset:{version:"2.0",generator:"GLTFExporter"}},o=0,a=[],s=[],l=new Map,u=[],c={},h={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map};function p(e,t){return e.length===t.length&&e.every(function(e,r){return e===t[r]})}function f(e){return 4*Math.ceil(e/4)}function d(e,t){t=t||0;var r=f(e.byteLength);if(r!==e.byteLength){var n=new Uint8Array(r);if(n.set(new Uint8Array(e)),0!==t)for(var i=e.byteLength;i<r;i++)n[i]=t;return n.buffer}return e}function m(e){try{return JSON.parse(JSON.stringify(e.userData))}catch(t){return console.warn("GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+t.message),{}}}function v(e,t){var r=!1,n={};0===t.offset.x&&0===t.offset.y||(n.offset=t.offset.toArray(),r=!0),0!==t.rotation&&(n.rotation=t.rotation,r=!0),1===t.repeat.x&&1===t.repeat.y||(n.scale=t.repeat.toArray(),r=!0),r&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=n,c.KHR_texture_transform=!0)}function g(e){return i.buffers||(i.buffers=[{byteLength:0}]),a.push(e),0}function y(e,t,n,a){var s;if(e.array.constructor===Float32Array)s=WEBGL_CONSTANTS.FLOAT;else if(e.array.constructor===Uint32Array)s=WEBGL_CONSTANTS.UNSIGNED_INT;else if(e.array.constructor===Uint16Array)s=WEBGL_CONSTANTS.UNSIGNED_SHORT;else{if(e.array.constructor!==Uint8Array)throw new Error("GLTFExporter: Unsupported bufferAttribute component type.");s=WEBGL_CONSTANTS.UNSIGNED_BYTE}if(void 0===n&&(n=0),void 0===a&&(a=e.count),r.truncateDrawRange&&void 0!==t&&null===t.index){var l=n+a,u=t.drawRange.count===1/0?e.count:t.drawRange.start+t.drawRange.count;n=Math.max(n,t.drawRange.start),(a=Math.min(l,u)-n)<0&&(a=0)}if(0===a)return null;var c,h=function(e,t,r){for(var n={min:new Array(e.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(e.itemSize).fill(Number.NEGATIVE_INFINITY)},i=t;i<t+r;i++)for(var o=0;o<e.itemSize;o++){var a=e.array[i*e.itemSize+o];n.min[o]=Math.min(n.min[o],a),n.max[o]=Math.max(n.max[o],a)}return n}(e,n,a);void 0!==t&&(c=e===t.index?WEBGL_CONSTANTS.ELEMENT_ARRAY_BUFFER:WEBGL_CONSTANTS.ARRAY_BUFFER);var p=function(e,t,r,n,a){var s;i.bufferViews||(i.bufferViews=[]),s=t===WEBGL_CONSTANTS.UNSIGNED_BYTE?1:t===WEBGL_CONSTANTS.UNSIGNED_SHORT?2:4;for(var l=f(n*e.itemSize*s),u=new DataView(new ArrayBuffer(l)),c=0,h=r;h<r+n;h++)for(var p=0;p<e.itemSize;p++){var d=e.array[h*e.itemSize+p];t===WEBGL_CONSTANTS.FLOAT?u.setFloat32(c,d,!0):t===WEBGL_CONSTANTS.UNSIGNED_INT?u.setUint32(c,d,!0):t===WEBGL_CONSTANTS.UNSIGNED_SHORT?u.setUint16(c,d,!0):t===WEBGL_CONSTANTS.UNSIGNED_BYTE&&u.setUint8(c,d),c+=s}var m={buffer:g(u.buffer),byteOffset:o,byteLength:l};return void 0!==a&&(m.target=a),a===WEBGL_CONSTANTS.ARRAY_BUFFER&&(m.byteStride=e.itemSize*s),o+=l,i.bufferViews.push(m),{id:i.bufferViews.length-1,byteLength:0}}(e,s,n,a,c),d={bufferView:p.id,byteOffset:p.byteOffset,componentType:s,count:a,max:h.max,min:h.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",16:"MAT4"}[e.itemSize]};return i.accessors||(i.accessors=[]),i.accessors.push(d),i.accessors.length-1}function b(e,t,a){h.images.has(e)||h.images.set(e,{});var l=h.images.get(e),u=t===RGBAFormat?"image/png":"image/jpeg",c=u+":flipY/"+a.toString();if(void 0!==l[c])return l[c];i.images||(i.images=[]);var p={mimeType:u};if(r.embedImages){var f=n=n||document.createElement("canvas");f.width=e.width,f.height=e.height,r.forcePowerOfTwoTextures&&!function(e){return _Math.isPowerOfTwo(e.width)&&_Math.isPowerOfTwo(e.height)}(e)&&(console.warn("GLTFExporter: Resized non-power-of-two image.",e),f.width=_Math.floorPowerOfTwo(f.width),f.height=_Math.floorPowerOfTwo(f.height));var m=f.getContext("2d");!0===a&&(m.translate(0,f.height),m.scale(1,-1)),m.drawImage(e,0,0,f.width,f.height),!0===r.binary?s.push(new Promise(function(e){f.toBlob(function(t){(function(e){return i.bufferViews||(i.bufferViews=[]),new Promise(function(t){var r=new window.FileReader;r.readAsArrayBuffer(e),r.onloadend=function(){var e=d(r.result),n={buffer:g(e),byteOffset:o,byteLength:e.byteLength};o+=e.byteLength,i.bufferViews.push(n),t(i.bufferViews.length-1)}})})(t).then(function(t){p.bufferView=t,e()})},u)})):p.uri=f.toDataURL(u)}else p.uri=e.src;i.images.push(p);var v=i.images.length-1;return l[c]=v,v}function x(e){i.samplers||(i.samplers=[]);var t={magFilter:THREE_TO_WEBGL[e.magFilter],minFilter:THREE_TO_WEBGL[e.minFilter],wrapS:THREE_TO_WEBGL[e.wrapS],wrapT:THREE_TO_WEBGL[e.wrapT]};return i.samplers.push(t),i.samplers.length-1}function w(e){if(h.textures.has(e))return h.textures.get(e);i.textures||(i.textures=[]);var t={sampler:x(e),source:b(e.image,e.format,e.flipY)};i.textures.push(t);var r=i.textures.length-1;return h.textures.set(e,r),r}function S(e){if(h.materials.has(e))return h.materials.get(e);if(i.materials||(i.materials=[]),e.isShaderMaterial)return console.warn("GLTFExporter: ShaderMaterial not supported."),null;var t={pbrMetallicRoughness:{}};e.isMeshBasicMaterial?(t.extensions={KHR_materials_unlit:{}},c.KHR_materials_unlit=!0):e.isMeshStandardMaterial||console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");var r=e.color.toArray().concat([e.opacity]);if(p(r,[1,1,1,1])||(t.pbrMetallicRoughness.baseColorFactor=r),e.isMeshStandardMaterial?(t.pbrMetallicRoughness.metallicFactor=e.metalness,t.pbrMetallicRoughness.roughnessFactor=e.roughness):e.isMeshBasicMaterial?(t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9):(t.pbrMetallicRoughness.metallicFactor=.5,t.pbrMetallicRoughness.roughnessFactor=.5),e.metalnessMap||e.roughnessMap)if(e.metalnessMap===e.roughnessMap){var n={index:w(e.metalnessMap)};v(n,e.metalnessMap),t.pbrMetallicRoughness.metallicRoughnessTexture=n}else console.warn("GLTFExporter: Ignoring metalnessMap and roughnessMap because they are not the same Texture.");if(e.map){var o={index:w(e.map)};v(o,e.map),t.pbrMetallicRoughness.baseColorTexture=o}if(e.isMeshBasicMaterial||e.isLineBasicMaterial||e.isPointsMaterial);else{var a=e.emissive.clone().multiplyScalar(e.emissiveIntensity).toArray();if(p(a,[0,0,0])||(t.emissiveFactor=a),e.emissiveMap){var s={index:w(e.emissiveMap)};v(s,e.emissiveMap),t.emissiveTexture=s}}if(e.normalMap){var l={index:w(e.normalMap)};-1!==e.normalScale.x&&(e.normalScale.x!==e.normalScale.y&&console.warn("GLTFExporter: Normal scale components are different, ignoring Y and exporting X."),l.scale=e.normalScale.x),v(l,e.normalMap),t.normalTexture=l}if(e.aoMap){var u={index:w(e.aoMap),texCoord:1};1!==e.aoMapIntensity&&(u.strength=e.aoMapIntensity),v(u,e.aoMap),t.occlusionTexture=u}(e.transparent||e.alphaTest>0)&&(t.alphaMode=e.opacity<1?"BLEND":"MASK",e.alphaTest>0&&.5!==e.alphaTest&&(t.alphaCutoff=e.alphaTest)),e.side===DoubleSide&&(t.doubleSided=!0),""!==e.name&&(t.name=e.name),Object.keys(e.userData).length>0&&(t.extras=m(e)),i.materials.push(t);var f=i.materials.length-1;return h.materials.set(e,f),f}function M(e){var t=e.geometry.uuid+":"+e.material.uuid;if(h.meshes.has(t))return h.meshes.get(t);var n,o=e.geometry;if(e.isLineSegments)n=WEBGL_CONSTANTS.LINES;else if(e.isLineLoop)n=WEBGL_CONSTANTS.LINE_LOOP;else if(e.isLine)n=WEBGL_CONSTANTS.LINE_STRIP;else if(e.isPoints)n=WEBGL_CONSTANTS.POINTS;else{if(!o.isBufferGeometry){console.warn("GLTFExporter: Exporting Geometry will increase file size. Use BufferGeometry instead.");var a=new BufferGeometry;a.fromGeometry(o),o=a}e.drawMode===TriangleFanDrawMode?(console.warn("GLTFExporter: TriangleFanDrawMode and wireframe incompatible."),n=WEBGL_CONSTANTS.TRIANGLE_FAN):n=e.drawMode===TriangleStripDrawMode?e.material.wireframe?WEBGL_CONSTANTS.LINE_STRIP:WEBGL_CONSTANTS.TRIANGLE_STRIP:e.material.wireframe?WEBGL_CONSTANTS.LINES:WEBGL_CONSTANTS.TRIANGLES}var s={},l={},u=[],c=[],p={uv:"TEXCOORD_0",uv2:"TEXCOORD_1",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},f=o.getAttribute("normal");void 0===f||function(e){if(h.attributesNormalized.has(e))return!1;for(var t=new Vector3,r=0,n=e.count;r<n;r++)if(Math.abs(t.fromArray(e.array,3*r).length()-1)>5e-4)return!1;return!0}(f)||(console.warn("GLTFExporter: Creating normalized normal attribute from the non-normalized one."),o.addAttribute("normal",function(e){if(h.attributesNormalized.has(e))return h.attributesNormalized.get(e);for(var t=e.clone(),r=new Vector3,n=0,i=t.count;n<i;n++)r.fromArray(t.array,3*n),0===r.x&&0===r.y&&0===r.z?r.setX(1):r.normalize(),r.toArray(t.array,3*n);return h.attributesNormalized.set(e,t),t}(f)));var d=null;for(var v in o.attributes){var g=o.attributes[v];if(v=p[v]||v.toUpperCase(),h.attributes.has(g))l[v]=h.attributes.get(g);else{d=null;var b=g.array;if("JOINTS_0"!==v||b instanceof Uint16Array||b instanceof Uint8Array||(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),d=new BufferAttribute(new Uint16Array(b),g.itemSize,g.normalized)),"MORPH"!==v.substr(0,5)){var x=y(d||g,o);null!==x&&(l[v]=x,h.attributes.set(g,x))}}}if(void 0!==f&&o.addAttribute("normal",f),0===Object.keys(l).length)return null;if(void 0!==e.morphTargetInfluences&&e.morphTargetInfluences.length>0){var w=[],M=[],_={};if(void 0!==e.morphTargetDictionary)for(var T in e.morphTargetDictionary)_[e.morphTargetDictionary[T]]=T;for(var A=0;A<e.morphTargetInfluences.length;++A){var C={},E=!1;for(var v in o.morphAttributes)if("position"===v||"normal"===v){g=o.morphAttributes[v][A];var L=v.toUpperCase(),N=o.attributes[v];if(h.attributes.has(g))C[L]=h.attributes.get(g);else{for(var P=g.clone(),O=0,R=g.count;O<R;O++)P.setXYZ(O,g.getX(O)-N.getX(O),g.getY(O)-N.getY(O),g.getZ(O)-N.getZ(O));C[L]=y(P,o),h.attributes.set(N,C[L])}}else E||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),E=!0);c.push(C),w.push(e.morphTargetInfluences[A]),void 0!==e.morphTargetDictionary&&M.push(_[A])}s.weights=w,M.length>0&&(s.extras={},s.extras.targetNames=M)}var D=Object.keys(o.userData).length>0?m(o):void 0,F=r.forceIndices,k=Array.isArray(e.material);if(k&&0===o.groups.length)return null;!F&&null===o.index&&k&&(console.warn("GLTFExporter: Creating index for non-indexed multi-material mesh."),F=!0);var I=!1;if(null===o.index&&F){for(var B=[],U=(A=0,o.attributes.position.count);A<U;A++)B[A]=A;o.setIndex(B),I=!0}var V=k?e.material:[e.material],j=k?o.groups:[{materialIndex:0,start:void 0,count:void 0}];for(A=0,U=j.length;A<U;A++){var z={mode:n,attributes:l};D&&(z.extras=D),c.length>0&&(z.targets=c),null!==o.index&&(h.attributes.has(o.index)?z.indices=h.attributes.get(o.index):(z.indices=y(o.index,o,j[A].start,j[A].count),h.attributes.set(o.index,z.indices)));var G=S(V[j[A].materialIndex]);null!==G&&(z.material=G),u.push(z)}I&&o.setIndex(null),s.primitives=u,i.meshes||(i.meshes=[]),i.meshes.push(s);var W=i.meshes.length-1;return h.meshes.set(t,W),W}function _(e,t){i.animations||(i.animations=[]);for(var r=(e=GLTFExporter.Utils.mergeMorphTargetTracks(e.clone(),t)).tracks,n=[],o=[],a=0;a<r.length;++a){var s=r[a],u=PropertyBinding.parseTrackName(s.name),c=PropertyBinding.findNode(t,u.nodeName),h=PATH_PROPERTIES[u.propertyName];if("bones"===u.objectName&&(c=!0===c.isSkinnedMesh?c.skeleton.getBoneByName(u.objectIndex):void 0),!c||!h)return console.warn('GLTFExporter: Could not export animation track "%s".',s.name),null;var p,f=s.values.length/s.times.length;h===PATH_PROPERTIES.morphTargetInfluences&&(f/=c.morphTargetInfluences.length),!0===s.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(p="CUBICSPLINE",f/=3):p=s.getInterpolation()===InterpolateDiscrete?"STEP":"LINEAR",o.push({input:y(new BufferAttribute(s.times,1)),output:y(new BufferAttribute(s.values,f)),interpolation:p}),n.push({sampler:o.length-1,target:{node:l.get(c),path:h}})}return i.animations.push({name:e.name||"clip_"+i.animations.length,samplers:o,channels:n}),i.animations.length-1}function T(e){var t=i.nodes[l.get(e)],r=e.skeleton,n=e.skeleton.bones[0];if(void 0===n)return null;for(var o=[],a=new Float32Array(16*r.bones.length),s=0;s<r.bones.length;++s)o.push(l.get(r.bones[s])),r.boneInverses[s].toArray(a,16*s);return void 0===i.skins&&(i.skins=[]),i.skins.push({inverseBindMatrices:y(new BufferAttribute(a,16)),joints:o,skeleton:l.get(n)}),t.skin=i.skins.length-1}function A(e){var t={};e.name&&(t.name=e.name),t.color=e.color.toArray(),t.intensity=e.intensity,e.isDirectionalLight?t.type="directional":e.isPointLight?(t.type="point",e.distance>0&&(t.range=e.distance)):e.isSpotLight&&(t.type="spot",e.distance>0&&(t.range=e.distance),t.spot={},t.spot.innerConeAngle=(e.penumbra-1)*e.angle*-1,t.spot.outerConeAngle=e.angle),void 0!==e.decay&&2!==e.decay&&console.warn("GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),!e.target||e.target.parent===e&&0===e.target.position.x&&0===e.target.position.y&&-1===e.target.position.z||console.warn("GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1.");var r=i.extensions.KHR_lights_punctual.lights;return r.push(t),r.length-1}function C(e){i.nodes||(i.nodes=[]);var t={};if(r.trs){var n=e.quaternion.toArray(),o=e.position.toArray(),a=e.scale.toArray();p(n,[0,0,0,1])||(t.rotation=n),p(o,[0,0,0])||(t.translation=o),p(a,[1,1,1])||(t.scale=a)}else e.updateMatrix(),p(e.matrix.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])||(t.matrix=e.matrix.elements);if(""!==e.name&&(t.name=String(e.name)),e.userData&&Object.keys(e.userData).length>0&&(t.extras=m(e)),e.isMesh||e.isLine||e.isPoints){var s=M(e);null!==s&&(t.mesh=s)}else if(e.isCamera)t.camera=function(e){i.cameras||(i.cameras=[]);var t=e.isOrthographicCamera,r={type:t?"orthographic":"perspective"};return t?r.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:r.perspective={aspectRatio:e.aspect,yfov:_Math.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},""!==e.name&&(r.name=e.type),i.cameras.push(r),i.cameras.length-1}(e);else if(e.isDirectionalLight||e.isPointLight||e.isSpotLight)c.KHR_lights_punctual||(i.extensions=i.extensions||{},i.extensions.KHR_lights_punctual={lights:[]},c.KHR_lights_punctual=!0),t.extensions=t.extensions||{},t.extensions.KHR_lights_punctual={light:A(e)};else if(e.isLight)return console.warn("GLTFExporter: Only directional, point, and spot lights are supported."),null;if(e.isSkinnedMesh&&u.push(e),e.children.length>0){for(var h=[],f=0,d=e.children.length;f<d;f++){var v=e.children[f];if(v.visible||!1===r.onlyVisible){var g=C(v);null!==g&&h.push(g)}}h.length>0&&(t.children=h)}i.nodes.push(t);var y=i.nodes.length-1;return l.set(e,y),y}function E(e){i.scenes||(i.scenes=[],i.scene=0);var t={nodes:[]};""!==e.name&&(t.name=e.name),e.userData&&Object.keys(e.userData).length>0&&(t.extras=m(e)),i.scenes.push(t);for(var n=[],o=0,a=e.children.length;o<a;o++){var s=e.children[o];if(s.visible||!1===r.onlyVisible){var l=C(s);null!==l&&n.push(l)}}n.length>0&&(t.nodes=n)}!function(e){e=e instanceof Array?e:[e];for(var t=[],n=0;n<e.length;n++)e[n]instanceof Scene?E(e[n]):t.push(e[n]);for(t.length>0&&function(e){var t=new Scene;t.name="AuxScene";for(var r=0;r<e.length;r++)t.children.push(e[r]);E(t)}(t),n=0;n<u.length;++n)T(u[n]);for(n=0;n<r.animations.length;++n)_(r.animations[n],e[0])}(e),Promise.all(s).then(function(){var e=new Blob(a,{type:"application/octet-stream"}),n=Object.keys(c);if(n.length>0&&(i.extensionsUsed=n),i.buffers&&i.buffers.length>0){i.buffers[0].byteLength=e.size;var o=new window.FileReader;if(!0===r.binary){o.readAsArrayBuffer(e),o.onloadend=function(){var e=d(o.result),r=new DataView(new ArrayBuffer(8));r.setUint32(0,e.byteLength,!0),r.setUint32(4,5130562,!0);var n=d(function(e){if(void 0!==window.TextEncoder)return(new TextEncoder).encode(e).buffer;for(var t=new Uint8Array(new ArrayBuffer(e.length)),r=0,n=e.length;r<n;r++){var i=e.charCodeAt(r);t[r]=i>255?32:i}return t.buffer}(JSON.stringify(i)),32),a=new DataView(new ArrayBuffer(8));a.setUint32(0,n.byteLength,!0),a.setUint32(4,1313821514,!0);var s=new ArrayBuffer(12),l=new DataView(s);l.setUint32(0,1179937895,!0),l.setUint32(4,2,!0);var u=12+a.byteLength+n.byteLength+r.byteLength+e.byteLength;l.setUint32(8,u,!0);var c=new Blob([s,a,n,r,e],{type:"application/octet-stream"}),h=new window.FileReader;h.readAsArrayBuffer(c),h.onloadend=function(){t(h.result)}}}else o.readAsDataURL(e),o.onloadend=function(){var e=o.result;i.buffers[0].uri=e,t(i)}}else t(i)})}},GLTFExporter.Utils={insertKeyframe:function(e,t){var r,n=e.getValueSize(),i=new e.TimeBufferType(e.times.length+1),o=new e.ValueBufferType(e.values.length+n),a=e.createInterpolant(new e.ValueBufferType(n));if(0===e.times.length){i[0]=t;for(var s=0;s<n;s++)o[s]=0;r=0}else if(t<e.times[0]){if(Math.abs(e.times[0]-t)<.001)return 0;i[0]=t,i.set(e.times,1),o.set(a.evaluate(t),0),o.set(e.values,n),r=0}else if(t>e.times[e.times.length-1]){if(Math.abs(e.times[e.times.length-1]-t)<.001)return e.times.length-1;i[i.length-1]=t,i.set(e.times,0),o.set(e.values,0),o.set(a.evaluate(t),e.values.length),r=i.length-1}else for(s=0;s<e.times.length;s++){if(Math.abs(e.times[s]-t)<.001)return s;if(e.times[s]<t&&e.times[s+1]>t){i.set(e.times.slice(0,s+1),0),i[s+1]=t,i.set(e.times.slice(s+1),s+2),o.set(e.values.slice(0,(s+1)*n),0),o.set(a.evaluate(t),(s+1)*n),o.set(e.values.slice((s+1)*n),(s+2)*n),r=s+1;break}}return e.times=i,e.values=o,r},mergeMorphTargetTracks:function(e,t){for(var r=[],n={},i=e.tracks,o=0;o<i.length;++o){var a=i[o],s=PropertyBinding.parseTrackName(a.name),l=PropertyBinding.findNode(t,s.nodeName);if("morphTargetInfluences"===s.propertyName&&void 0!==s.propertyIndex){if(a.createInterpolant!==a.InterpolantFactoryMethodDiscrete&&a.createInterpolant!==a.InterpolantFactoryMethodLinear){if(a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),(a=a.clone()).setInterpolation(InterpolateLinear)}var u,c=l.morphTargetInfluences.length,h=l.morphTargetDictionary[s.propertyIndex];if(void 0===h)throw new Error("GLTFExporter: Morph target name not found: "+s.propertyIndex);if(void 0!==n[l.uuid]){var p=a.createInterpolant(new a.ValueBufferType(1));u=n[l.uuid];for(m=0;m<u.times.length;m++)u.values[m*c+h]=p.evaluate(u.times[m]);for(m=0;m<a.times.length;m++){var f=this.insertKeyframe(u,a.times[m]);u.values[f*c+h]=a.values[m]}}else{for(var d=new((u=a.clone()).ValueBufferType)(c*u.times.length),m=0;m<u.times.length;m++)d[m*c+h]=u.values[m];u.name=".morphTargetInfluences",u.values=d,n[l.uuid]=u,r.push(u)}}else r.push(a)}return e.tracks=r,e}};var MMDExporter=function(){var e;this.parseVpd=function(t,r,n){if(!0!==t.isSkinnedMesh)return console.warn("MMDExporter: parseVpd() requires SkinnedMesh instance."),null;function i(e){Math.abs(e)<1e-6&&(e=0);var t=e.toString();-1===t.indexOf(".")&&(t+=".");var r=(t+="000000").indexOf(".");return t.slice(0,r)+"."+t.slice(r+1,r+7)}function o(e){for(var t=[],r=0,n=e.length;r<n;r++)t.push(i(e[r]));return t.join(",")}t.updateMatrixWorld(!0);var a=t.skeleton.bones,s=function(e){var t=e.clone();return t.pose(),t.skeleton.bones}(t),l=new Vector3,u=new Quaternion,c=new Quaternion,h=new Matrix4,p=[];p.push("Vocaloid Pose Data file"),p.push(""),p.push((""!==t.name?t.name.replace(/\s/g,"_"):"skin")+".osm;"),p.push(a.length+";"),p.push("");for(var f=0,d=a.length;f<d;f++){var m=a[f],v=s[f];!0===n&&void 0!==m.userData.ik&&void 0!==m.userData.ik.originalMatrix?h.fromArray(m.userData.ik.originalMatrix):h.copy(m.matrix),l.setFromMatrixPosition(h),u.setFromRotationMatrix(h);var g=l.sub(v.position).toArray(),y=c.copy(v.quaternion).conjugate().multiply(u).toArray();g[2]=-g[2],y[0]=-y[0],y[1]=-y[1],p.push("Bone"+f+"{"+m.name),p.push("  "+o(g)+";"),p.push("  "+o(y)+";"),p.push("}"),p.push("")}p.push("");var b=p.join("\n");return!0===r?function(t){if(void 0===e){var r=(new MMDParser.CharsetEncoder).s2uTable;e={};for(var n=Object.keys(r),i=0,o=n.length;i<o;i++){var a=n[i],s=r[a];a=parseInt(a),e[s]=a}}var l=[];for(i=0,o=t.length;i<o;i++){var u=t.charCodeAt(i);if(void 0===(s=e[u]))throw"cannot convert charcode 0x"+u.toString(16);s>255?(l.push(s>>8&255),l.push(255&s)):l.push(255&s)}return new Uint8Array(l)}(b):b}},OBJExporter=function(){};OBJExporter.prototype={constructor:OBJExporter,parse:function(e){var t,r,n,i,o,a="",s=0,l=0,u=0,c=new Vector3,h=new Vector3,p=new Vector2,f=[];return e.traverse(function(e){e instanceof Mesh&&function(e){var n=0,d=0,m=0,v=e.geometry,g=new Matrix3;if(v instanceof Geometry&&(v=(new BufferGeometry).setFromObject(e)),v instanceof BufferGeometry){var y=v.getAttribute("position"),b=v.getAttribute("normal"),x=v.getAttribute("uv"),w=v.getIndex();if(a+="o "+e.name+"\n",e.material&&e.material.name&&(a+="usemtl "+e.material.name+"\n"),void 0!==y)for(t=0,i=y.count;t<i;t++,n++)c.x=y.getX(t),c.y=y.getY(t),c.z=y.getZ(t),c.applyMatrix4(e.matrixWorld),a+="v "+c.x+" "+c.y+" "+c.z+"\n";if(void 0!==x)for(t=0,i=x.count;t<i;t++,m++)p.x=x.getX(t),p.y=x.getY(t),a+="vt "+p.x+" "+p.y+"\n";if(void 0!==b)for(g.getNormalMatrix(e.matrixWorld),t=0,i=b.count;t<i;t++,d++)h.x=b.getX(t),h.y=b.getY(t),h.z=b.getZ(t),h.applyMatrix3(g),a+="vn "+h.x+" "+h.y+" "+h.z+"\n";if(null!==w)for(t=0,i=w.count;t<i;t+=3){for(o=0;o<3;o++)r=w.getX(t+o)+1,f[o]=s+r+(b||x?"/"+(x?l+r:"")+(b?"/"+(u+r):""):"");a+="f "+f.join(" ")+"\n"}else for(t=0,i=y.count;t<i;t+=3){for(o=0;o<3;o++)r=t+o+1,f[o]=s+r+(b||x?"/"+(x?l+r:"")+(b?"/"+(u+r):""):"");a+="f "+f.join(" ")+"\n"}}else console.warn("OBJExporter.parseMesh(): geometry type unsupported",v);s+=n,l+=m,u+=d}(e),e instanceof Line&&function(e){var o=0,l=e.geometry,u=e.type;if(l instanceof Geometry&&(l=(new BufferGeometry).setFromObject(e)),l instanceof BufferGeometry){var h=l.getAttribute("position");if(a+="o "+e.name+"\n",void 0!==h)for(t=0,i=h.count;t<i;t++,o++)c.x=h.getX(t),c.y=h.getY(t),c.z=h.getZ(t),c.applyMatrix4(e.matrixWorld),a+="v "+c.x+" "+c.y+" "+c.z+"\n";if("Line"===u){for(a+="l ",r=1,i=h.count;r<=i;r++)a+=s+r+" ";a+="\n"}if("LineSegments"===u)for(n=1+(r=1),i=h.count;r<i;n=(r+=2)+1)a+="l "+(s+r)+" "+(s+n)+"\n"}else console.warn("OBJExporter.parseLine(): geometry type unsupported",l);s+=o}(e)}),a}};var PLYExporter=function(){};PLYExporter.prototype={constructor:PLYExporter,parse:function(e,t,r){function n(t){e.traverse(function(e){if(!0===e.isMesh){var r=e,n=r.geometry;!0===n.isGeometry&&(n=o.get(n)),!0===n.isBufferGeometry&&void 0!==n.getAttribute("position")&&t(r,n)}})}t&&"object"===typeof t&&(console.warn('PLYExporter: The options parameter is now the third argument to the "parse" function. See the documentation for the new API.'),r=t,t=void 0);var i=(r=Object.assign({binary:!1,excludeAttributes:[]},r)).excludeAttributes,o=new WeakMap,a=!1,s=!1,l=!1,u=0,c=0;e.traverse(function(e){if(!0===e.isMesh){var t=e,r=t.geometry;if(!0===r.isGeometry){var n=o.get(r)||(new BufferGeometry).setFromObject(t);o.set(r,n),r=n}if(!0===r.isBufferGeometry){var i=r.getAttribute("position"),h=r.getAttribute("normal"),p=r.getAttribute("uv"),f=r.getAttribute("color"),d=r.getIndex();if(void 0===i)return;u+=i.count,c+=d?d.count/3:i.count/3,void 0!==h&&(a=!0),void 0!==p&&(l=!0),void 0!==f&&(s=!0)}}});var h=-1===i.indexOf("index");if(a=a&&-1===i.indexOf("normal"),s=s&&-1===i.indexOf("color"),l=l&&-1===i.indexOf("uv"),h&&c!==Math.floor(c))return console.error("PLYExporter: Failed to generate a valid PLY file with triangle indices because the number of indices is not divisible by 3."),null;var p=1;u>256&&(p=2),u>65536&&(p=4);var f="ply\nformat "+(r.binary?"binary_big_endian":"ascii")+" 1.0\nelement vertex "+u+"\nproperty float x\nproperty float y\nproperty float z\n";!0===a&&(f+="property float nx\nproperty float ny\nproperty float nz\n"),!0===l&&(f+="property float s\nproperty float t\n"),!0===s&&(f+="property uchar red\nproperty uchar green\nproperty uchar blue\n"),!0===h&&(f+="element face "+c+"\nproperty list uchar uint"+8*p+" vertex_index\n"),f+="end_header\n";var d=new Vector3,m=new Matrix3,v=null;if(!0===r.binary){var g=(new TextEncoder).encode(f),y=u*(12+(a?12:0)+(s?3:0)+(l?8:0)),b=h?c*(3*p+1):0,x=new DataView(new ArrayBuffer(g.length+y+b));new Uint8Array(x.buffer).set(g,0);var w=g.length,S=g.length+y,M=0;n(function(e,t){var r=t.getAttribute("position"),n=t.getAttribute("normal"),i=t.getAttribute("uv"),o=t.getAttribute("color"),u=t.getIndex();m.getNormalMatrix(e.matrixWorld);for(var c=0,f=r.count;c<f;c++)d.x=r.getX(c),d.y=r.getY(c),d.z=r.getZ(c),d.applyMatrix4(e.matrixWorld),x.setFloat32(w,d.x),w+=4,x.setFloat32(w,d.y),w+=4,x.setFloat32(w,d.z),w+=4,!0===a&&(null!=n?(d.x=n.getX(c),d.y=n.getY(c),d.z=n.getZ(c),d.applyMatrix3(m),x.setFloat32(w,d.x),w+=4,x.setFloat32(w,d.y),w+=4,x.setFloat32(w,d.z),w+=4):(x.setFloat32(w,0),w+=4,x.setFloat32(w,0),w+=4,x.setFloat32(w,0),w+=4)),!0===l&&(null!=i?(x.setFloat32(w,i.getX(c)),w+=4,x.setFloat32(w,i.getY(c)),w+=4):!1!==l&&(x.setFloat32(w,0),w+=4,x.setFloat32(w,0),w+=4)),!0===s&&(null!=o?(x.setUint8(w,Math.floor(255*o.getX(c))),w+=1,x.setUint8(w,Math.floor(255*o.getY(c))),w+=1,x.setUint8(w,Math.floor(255*o.getZ(c))),w+=1):(x.setUint8(w,255),w+=1,x.setUint8(w,255),w+=1,x.setUint8(w,255),w+=1));if(!0===h){var v="setUint"+8*p;if(null!==u)for(c=0,f=u.count;c<f;c+=3)x.setUint8(S,3),S+=1,x[v](S,u.getX(c+0)+M),S+=p,x[v](S,u.getX(c+1)+M),S+=p,x[v](S,u.getX(c+2)+M),S+=p;else for(c=0,f=r.count;c<f;c+=3)x.setUint8(S,3),S+=1,x[v](S,M+c),S+=p,x[v](S,M+c+1),S+=p,x[v](S,M+c+2),S+=p}M+=r.count}),v=x.buffer}else{M=0;var _="",T="";n(function(e,t){var r=t.getAttribute("position"),n=t.getAttribute("normal"),i=t.getAttribute("uv"),o=t.getAttribute("color"),u=t.getIndex();m.getNormalMatrix(e.matrixWorld);for(var p=0,f=r.count;p<f;p++){d.x=r.getX(p),d.y=r.getY(p),d.z=r.getZ(p),d.applyMatrix4(e.matrixWorld);var v=d.x+" "+d.y+" "+d.z;!0===a&&(null!=n?(d.x=n.getX(p),d.y=n.getY(p),d.z=n.getZ(p),d.applyMatrix3(m),v+=" "+d.x+" "+d.y+" "+d.z):v+=" 0 0 0"),!0===l&&(null!=i?v+=" "+i.getX(p)+" "+i.getY(p):!1!==l&&(v+=" 0 0")),!0===s&&(v+=null!=o?" "+Math.floor(255*o.getX(p))+" "+Math.floor(255*o.getY(p))+" "+Math.floor(255*o.getZ(p)):" 255 255 255"),_+=v+"\n"}if(!0===h){if(null!==u)for(p=0,f=u.count;p<f;p+=3)T+="3 "+(u.getX(p+0)+M),T+=" "+(u.getX(p+1)+M),T+=" "+(u.getX(p+2)+M)+"\n";else for(p=0,f=r.count;p<f;p+=3)T+="3 "+(M+p)+" "+(M+p+1)+" "+(M+p+2)+"\n";c+=u?u.count/3:r.count/3}M+=r.count}),v=""+f+_+"\n"+(h?T+"\n":"")}return"function"===typeof t&&requestAnimationFrame(function(){return t(v)}),v}};var STLExporter=function(){};STLExporter.prototype={constructor:STLExporter,parse:function(){var e=new Vector3,t=new Matrix3;return function(r,n){void 0===n&&(n={});var i=void 0!==n.binary&&n.binary,o=[],a=0;if(r.traverse(function(e){if(e.isMesh){var t=e.geometry;t.isBufferGeometry&&(t=(new Geometry).fromBufferGeometry(t)),t.isGeometry&&(a+=t.faces.length,o.push({geometry:t,matrixWorld:e.matrixWorld}))}}),i){var s=80,l=new ArrayBuffer(2*a+3*a*4*4+80+4);(b=new DataView(l)).setUint32(s,a,!0),s+=4;for(var u=0,c=o.length;u<c;u++){var h=(x=o[u]).geometry.vertices,p=x.geometry.faces,f=x.matrixWorld;t.getNormalMatrix(f);for(var d=0,m=p.length;d<m;d++){var v=p[d];e.copy(v.normal).applyMatrix3(t).normalize(),b.setFloat32(s,e.x,!0),s+=4,b.setFloat32(s,e.y,!0),s+=4,b.setFloat32(s,e.z,!0),s+=4;for(var g=[v.a,v.b,v.c],y=0;y<3;y++)e.copy(h[g[y]]).applyMatrix4(f),b.setFloat32(s,e.x,!0),s+=4,b.setFloat32(s,e.y,!0),s+=4,b.setFloat32(s,e.z,!0),s+=4;b.setUint16(s,0,!0),s+=2}}return b}var b="";b+="solid exported\n";for(u=0,c=o.length;u<c;u++){var x;h=(x=o[u]).geometry.vertices,p=x.geometry.faces,f=x.matrixWorld;t.getNormalMatrix(f);for(d=0,m=p.length;d<m;d++){v=p[d];e.copy(v.normal).applyMatrix3(t).normalize(),b+="\tfacet normal "+e.x+" "+e.y+" "+e.z+"\n",b+="\t\touter loop\n";for(g=[v.a,v.b,v.c],y=0;y<3;y++)e.copy(h[g[y]]).applyMatrix4(f),b+="\t\t\tvertex "+e.x+" "+e.y+" "+e.z+"\n";b+="\t\tendloop\n",b+="\tendfacet\n"}}return b+="endsolid exported\n"}}()};var TypedGeometryExporter=function(){};TypedGeometryExporter.prototype={constructor:TypedGeometryExporter,parse:function(e){var t={metadata:{version:4,type:"TypedGeometry",generator:"TypedGeometryExporter"}},r=["vertices","normals","uvs"];for(var n in r){for(var i=r[n],o=e[i],a=[],s=0,l=o.length;s<l;s++)a[s]=o[s];t[i]=a}var u=e.boundingSphere;return null!==u&&(t.boundingSphere={center:u.center.toArray(),radius:u.radius}),t}};var BoxLineGeometry=function(e,t,r,n,i,o){BufferGeometry.call(this);for(var a=(e=e||1)/2,s=(t=t||1)/2,l=(r=r||1)/2,u=e/(n=Math.floor(n)||1),c=t/(i=Math.floor(i)||1),h=r/(o=Math.floor(o)||1),p=[],f=-a,d=-s,m=-l,v=0;v<=n;v++)p.push(f,-s,-l,f,s,-l),p.push(f,s,-l,f,s,l),p.push(f,s,l,f,-s,l),p.push(f,-s,l,f,-s,-l),f+=u;for(v=0;v<=i;v++)p.push(-a,d,-l,a,d,-l),p.push(a,d,-l,a,d,l),p.push(a,d,l,-a,d,l),p.push(-a,d,l,-a,d,-l),d+=c;for(v=0;v<=o;v++)p.push(-a,-s,m,-a,s,m),p.push(-a,s,m,a,s,m),p.push(a,s,m,a,-s,m),p.push(a,-s,m,-a,-s,m),m+=h;this.addAttribute("position",new Float32BufferAttribute(p,3))};function DecalGeometry(e,t,r,n){BufferGeometry.call(this);var i=[],o=[],a=[],s=new Vector3,l=new Matrix4;l.makeRotationFromEuler(r),l.setPosition(t);var u=(new Matrix4).getInverse(l);function c(t,r,n){r.applyMatrix4(e.matrixWorld),r.applyMatrix4(u),t.push(new DecalVertex(r.clone(),n.clone()))}function h(e,t){for(var r=[],i=.5*Math.abs(n.dot(t)),o=0;o<e.length;o+=3){var a,s,l,u,c,h,f;switch(((a=e[o+0].position.dot(t)-i>0)?1:0)+((s=e[o+1].position.dot(t)-i>0)?1:0)+((l=e[o+2].position.dot(t)-i>0)?1:0)){case 0:r.push(e[o]),r.push(e[o+1]),r.push(e[o+2]);break;case 1:if(a&&(u=e[o+1],c=e[o+2],h=p(e[o],u,t,i),f=p(e[o],c,t,i)),s){u=e[o],c=e[o+2],h=p(e[o+1],u,t,i),f=p(e[o+1],c,t,i),r.push(h),r.push(c.clone()),r.push(u.clone()),r.push(c.clone()),r.push(h.clone()),r.push(f);break}l&&(u=e[o],c=e[o+1],h=p(e[o+2],u,t,i),f=p(e[o+2],c,t,i)),r.push(u.clone()),r.push(c.clone()),r.push(h),r.push(f),r.push(h.clone()),r.push(c.clone());break;case 2:a||(c=p(u=e[o].clone(),e[o+1],t,i),h=p(u,e[o+2],t,i),r.push(u),r.push(c),r.push(h)),s||(c=p(u=e[o+1].clone(),e[o+2],t,i),h=p(u,e[o],t,i),r.push(u),r.push(c),r.push(h)),l||(c=p(u=e[o+2].clone(),e[o],t,i),h=p(u,e[o+1],t,i),r.push(u),r.push(c),r.push(h))}}return r}function p(e,t,r,n){var i=e.position.dot(r)-n,o=i/(i-(t.position.dot(r)-n));return new DecalVertex(new Vector3(e.position.x+o*(t.position.x-e.position.x),e.position.y+o*(t.position.y-e.position.y),e.position.z+o*(t.position.z-e.position.z)),new Vector3(e.normal.x+o*(t.normal.x-e.normal.x),e.normal.y+o*(t.normal.y-e.normal.y),e.normal.z+o*(t.normal.z-e.normal.z)))}!function(){var t,r=new BufferGeometry,u=[],p=new Vector3,f=new Vector3;e.geometry.isGeometry?r.fromGeometry(e.geometry):r.copy(e.geometry);var d=r.attributes.position,m=r.attributes.normal;if(null!==r.index){var v=r.index;for(t=0;t<v.count;t++)p.fromBufferAttribute(d,v.getX(t)),f.fromBufferAttribute(m,v.getX(t)),c(u,p,f)}else for(t=0;t<d.count;t++)p.fromBufferAttribute(d,t),f.fromBufferAttribute(m,t),c(u,p,f);for(u=h(u,s.set(1,0,0)),u=h(u,s.set(-1,0,0)),u=h(u,s.set(0,1,0)),u=h(u,s.set(0,-1,0)),u=h(u,s.set(0,0,1)),u=h(u,s.set(0,0,-1)),t=0;t<u.length;t++){var g=u[t];a.push(.5+g.position.x/n.x,.5+g.position.y/n.y),g.position.applyMatrix4(l),i.push(g.position.x,g.position.y,g.position.z),o.push(g.normal.x,g.normal.y,g.normal.z)}}(),this.addAttribute("position",new Float32BufferAttribute(i,3)),this.addAttribute("normal",new Float32BufferAttribute(o,3)),this.addAttribute("uv",new Float32BufferAttribute(a,2))}function DecalVertex(e,t){this.position=e,this.normal=t}function hilbert2D(e,t,r,n,i,o,a){e=void 0!==e?e:new Vector3(0,0,0);var s=(t=void 0!==t?t:10)/2,l=(r=void 0!==r?r:1,n=void 0!==n?n:0,i=void 0!==i?i:1,o=void 0!==o?o:2,a=void 0!==a?a:3,[new Vector3(e.x-s,e.y,e.z-s),new Vector3(e.x-s,e.y,e.z+s),new Vector3(e.x+s,e.y,e.z+s),new Vector3(e.x+s,e.y,e.z-s)]),u=[l[n],l[i],l[o],l[a]];if(0<=--r){var c=[];return Array.prototype.push.apply(c,hilbert2D(u[0],s,r,n,a,o,i)),Array.prototype.push.apply(c,hilbert2D(u[1],s,r,n,i,o,a)),Array.prototype.push.apply(c,hilbert2D(u[2],s,r,n,i,o,a)),Array.prototype.push.apply(c,hilbert2D(u[3],s,r,o,i,n,a)),c}return u}function hilbert3D(e,t,r,n,i,o,a,s,l,u,c){e=void 0!==e?e:new Vector3(0,0,0);var h=(t=void 0!==t?t:10)/2,p=(r=void 0!==r?r:1,n=void 0!==n?n:0,i=void 0!==i?i:1,o=void 0!==o?o:2,a=void 0!==a?a:3,s=void 0!==s?s:4,l=void 0!==l?l:5,u=void 0!==u?u:6,c=void 0!==c?c:7,[new Vector3(e.x-h,e.y+h,e.z-h),new Vector3(e.x-h,e.y+h,e.z+h),new Vector3(e.x-h,e.y-h,e.z+h),new Vector3(e.x-h,e.y-h,e.z-h),new Vector3(e.x+h,e.y-h,e.z-h),new Vector3(e.x+h,e.y-h,e.z+h),new Vector3(e.x+h,e.y+h,e.z+h),new Vector3(e.x+h,e.y+h,e.z-h)]),f=[p[n],p[i],p[o],p[a],p[s],p[l],p[u],p[c]];if(--r>=0){var d=[];return Array.prototype.push.apply(d,hilbert3D(f[0],h,r,n,a,s,c,u,l,o,i)),Array.prototype.push.apply(d,hilbert3D(f[1],h,r,n,c,u,i,o,l,s,a)),Array.prototype.push.apply(d,hilbert3D(f[2],h,r,n,c,u,i,o,l,s,a)),Array.prototype.push.apply(d,hilbert3D(f[3],h,r,o,a,n,i,u,c,s,l)),Array.prototype.push.apply(d,hilbert3D(f[4],h,r,o,a,n,i,u,c,s,l)),Array.prototype.push.apply(d,hilbert3D(f[5],h,r,s,a,o,l,u,i,n,c)),Array.prototype.push.apply(d,hilbert3D(f[6],h,r,s,a,o,l,u,i,n,c)),Array.prototype.push.apply(d,hilbert3D(f[7],h,r,u,l,o,i,n,a,s,c)),d}return f}BoxLineGeometry.prototype=Object.create(BufferGeometry.prototype),BoxLineGeometry.prototype.constructor=BoxLineGeometry,DecalGeometry.prototype=Object.create(BufferGeometry.prototype),DecalGeometry.prototype.constructor=DecalGeometry,DecalVertex.prototype.clone=function(){return new DecalVertex(this.position.clone(),this.normal.clone())};var SimplexNoise=function(e){void 0==e&&(e=Math),this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(var t=0;t<256;t++)this.p[t]=Math.floor(256*e.random());this.perm=[];for(t=0;t<512;t++)this.perm[t]=this.p[255&t];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]};SimplexNoise.prototype.dot=function(e,t,r){return e[0]*t+e[1]*r},SimplexNoise.prototype.dot3=function(e,t,r,n){return e[0]*t+e[1]*r+e[2]*n},SimplexNoise.prototype.dot4=function(e,t,r,n,i){return e[0]*t+e[1]*r+e[2]*n+e[3]*i},SimplexNoise.prototype.noise=function(e,t){var r,n,i=(e+t)*(.5*(Math.sqrt(3)-1)),o=Math.floor(e+i),a=Math.floor(t+i),s=(3-Math.sqrt(3))/6,l=(o+a)*s,u=e-(o-l),c=t-(a-l);u>c?(r=1,n=0):(r=0,n=1);var h=u-r+s,p=c-n+s,f=u-1+2*s,d=c-1+2*s,m=255&o,v=255&a,g=this.perm[m+this.perm[v]]%12,y=this.perm[m+r+this.perm[v+n]]%12,b=this.perm[m+1+this.perm[v+1]]%12,x=.5-u*u-c*c,w=.5-h*h-p*p,S=.5-f*f-d*d;return 70*((x<0?0:(x*=x)*x*this.dot(this.grad3[g],u,c))+(w<0?0:(w*=w)*w*this.dot(this.grad3[y],h,p))+(S<0?0:(S*=S)*S*this.dot(this.grad3[b],f,d)))},SimplexNoise.prototype.noise3d=function(e,t,r){var n,i,o,a,s,l,u=(e+t+r)*(1/3),c=Math.floor(e+u),h=Math.floor(t+u),p=Math.floor(r+u),f=1/6,d=(c+h+p)*f,m=e-(c-d),v=t-(h-d),g=r-(p-d);m>=v?v>=g?(n=1,i=0,o=0,a=1,s=1,l=0):m>=g?(n=1,i=0,o=0,a=1,s=0,l=1):(n=0,i=0,o=1,a=1,s=0,l=1):v<g?(n=0,i=0,o=1,a=0,s=1,l=1):m<g?(n=0,i=1,o=0,a=0,s=1,l=1):(n=0,i=1,o=0,a=1,s=1,l=0);var y=m-n+f,b=v-i+f,x=g-o+f,w=m-a+2*f,S=v-s+2*f,M=g-l+2*f,_=m-1+.5,T=v-1+.5,A=g-1+.5,C=255&c,E=255&h,L=255&p,N=this.perm[C+this.perm[E+this.perm[L]]]%12,P=this.perm[C+n+this.perm[E+i+this.perm[L+o]]]%12,O=this.perm[C+a+this.perm[E+s+this.perm[L+l]]]%12,R=this.perm[C+1+this.perm[E+1+this.perm[L+1]]]%12,D=.6-m*m-v*v-g*g,F=.6-y*y-b*b-x*x,k=.6-w*w-S*S-M*M,I=.6-_*_-T*T-A*A;return 32*((D<0?0:(D*=D)*D*this.dot3(this.grad3[N],m,v,g))+(F<0?0:(F*=F)*F*this.dot3(this.grad3[P],y,b,x))+(k<0?0:(k*=k)*k*this.dot3(this.grad3[O],w,S,M))+(I<0?0:(I*=I)*I*this.dot3(this.grad3[R],_,T,A)))},SimplexNoise.prototype.noise4d=function(e,t,r,n){var i,o,a,s,l,u,c,h,p,f,d,m,v=this.grad4,g=this.simplex,y=this.perm,b=(Math.sqrt(5)-1)/4,x=(5-Math.sqrt(5))/20,w=(e+t+r+n)*b,S=Math.floor(e+w),M=Math.floor(t+w),_=Math.floor(r+w),T=Math.floor(n+w),A=(S+M+_+T)*x,C=e-(S-A),E=t-(M-A),L=r-(_-A),N=n-(T-A),P=(C>E?32:0)+(C>L?16:0)+(E>L?8:0)+(C>N?4:0)+(E>N?2:0)+(L>N?1:0),O=C-(i=g[P][0]>=3?1:0)+x,R=E-(o=g[P][1]>=3?1:0)+x,D=L-(a=g[P][2]>=3?1:0)+x,F=N-(s=g[P][3]>=3?1:0)+x,k=C-(l=g[P][0]>=2?1:0)+2*x,I=E-(u=g[P][1]>=2?1:0)+2*x,B=L-(c=g[P][2]>=2?1:0)+2*x,U=N-(h=g[P][3]>=2?1:0)+2*x,V=C-(p=g[P][0]>=1?1:0)+3*x,j=E-(f=g[P][1]>=1?1:0)+3*x,z=L-(d=g[P][2]>=1?1:0)+3*x,G=N-(m=g[P][3]>=1?1:0)+3*x,W=C-1+4*x,H=E-1+4*x,X=L-1+4*x,q=N-1+4*x,Y=255&S,K=255&M,Q=255&_,J=255&T,Z=y[Y+y[K+y[Q+y[J]]]]%32,$=y[Y+i+y[K+o+y[Q+a+y[J+s]]]]%32,ee=y[Y+l+y[K+u+y[Q+c+y[J+h]]]]%32,te=y[Y+p+y[K+f+y[Q+d+y[J+m]]]]%32,re=y[Y+1+y[K+1+y[Q+1+y[J+1]]]]%32,ne=.6-C*C-E*E-L*L-N*N,ie=.6-O*O-R*R-D*D-F*F,oe=.6-k*k-I*I-B*B-U*U,ae=.6-V*V-j*j-z*z-G*G,se=.6-W*W-H*H-X*X-q*q;return 27*((ne<0?0:(ne*=ne)*ne*this.dot4(v[Z],C,E,L,N))+(ie<0?0:(ie*=ie)*ie*this.dot4(v[$],O,R,D,F))+(oe<0?0:(oe*=oe)*oe*this.dot4(v[ee],k,I,B,U))+(ae<0?0:(ae*=ae)*ae*this.dot4(v[te],V,j,z,G))+(se<0?0:(se*=se)*se*this.dot4(v[re],W,H,X,q)))};var LightningStrike=function e(t){BufferGeometry.call(this),this.type="LightningStrike",t=t||{},this.init(e.copyParameters(t,t)),this.createMesh()};LightningStrike.prototype=Object.create(BufferGeometry.prototype),LightningStrike.prototype.constructor=LightningStrike,LightningStrike.prototype.isLightningStrike=!0,LightningStrike.RAY_INITIALIZED=0,LightningStrike.RAY_UNBORN=1,LightningStrike.RAY_PROPAGATING=2,LightningStrike.RAY_STEADY=3,LightningStrike.RAY_VANISHING=4,LightningStrike.RAY_EXTINGUISHED=5,LightningStrike.COS30DEG=Math.cos(30*Math.PI/180),LightningStrike.SIN30DEG=Math.sin(30*Math.PI/180),LightningStrike.createRandomGenerator=function(){for(var e=[],t=0;t<2053;t++)e.push(Math.random());var r={currentSeed:0,random:function(){var t=e[r.currentSeed];return r.currentSeed=(r.currentSeed+1)%2053,t},getSeed:function(){return r.currentSeed/2053},setSeed:function(e){r.currentSeed=Math.floor(2053*e)%2053}};return r},LightningStrike.copyParameters=function(e,t){t=t||{};var r=function(r){return t===e?r:r.clone()};return(e=e||{}).sourceOffset=void 0!==t.sourceOffset?r(t.sourceOffset):new Vector3(0,100,0),e.destOffset=void 0!==t.destOffset?r(t.destOffset):new Vector3(0,0,0),e.timeScale=void 0!==t.timeScale?t.timeScale:1,e.roughness=void 0!==t.roughness?t.roughness:.9,e.straightness=void 0!==t.straightness?t.straightness:.7,e.up0=void 0!==t.up0?r(t.up0):new Vector3(0,0,1),e.up1=void 0!==t.up1?r(t.up1):new Vector3(0,0,1),e.radius0=void 0!==t.radius0?t.radius0:1,e.radius1=void 0!==t.radius1?t.radius1:1,e.radius0Factor=void 0!==t.radius0Factor?t.radius0Factor:.5,e.radius1Factor=void 0!==t.radius1Factor?t.radius1Factor:.2,e.minRadius=void 0!==t.minRadius?t.minRadius:.2,e.isEternal=void 0!==t.isEternal?t.isEternal:void 0===t.birthTime||void 0===t.deathTime,e.birthTime=t.birthTime,e.deathTime=t.deathTime,e.propagationTimeFactor=void 0!==t.propagationTimeFactor?t.propagationTimeFactor:.1,e.vanishingTimeFactor=void 0!==t.vanishingTimeFactor?t.vanishingTimeFactor:.9,e.subrayPeriod=void 0!==t.subrayPeriod?t.subrayPeriod:4,e.subrayDutyCycle=void 0!==t.subrayDutyCycle?t.subrayDutyCycle:.6,e.maxIterations=void 0!==t.maxIterations?t.maxIterations:9,e.isStatic=void 0!==t.isStatic&&t.isStatic,e.ramification=void 0!==t.ramification?t.ramification:5,e.maxSubrayRecursion=void 0!==t.maxSubrayRecursion?t.maxSubrayRecursion:3,e.recursionProbability=void 0!==t.recursionProbability?t.recursionProbability:.6,e.generateUVs=void 0!==t.generateUVs&&t.generateUVs,e.randomGenerator=t.randomGenerator,e.noiseSeed=t.noiseSeed,e.onDecideSubrayCreation=t.onDecideSubrayCreation,e.onSubrayCreation=t.onSubrayCreation,e},LightningStrike.prototype.update=function(e){this.isStatic||(this.rayParameters.isEternal||this.rayParameters.birthTime<=e&&e<=this.rayParameters.deathTime?(this.updateMesh(e),e<this.subrays[0].endPropagationTime?this.state=LightningStrike.RAY_PROPAGATING:e>this.subrays[0].beginVanishingTime?this.state=LightningStrike.RAY_VANISHING:this.state=LightningStrike.RAY_STEADY,this.visible=!0):(this.visible=!1,e<this.rayParameters.birthTime?this.state=LightningStrike.RAY_UNBORN:this.state=LightningStrike.RAY_EXTINGUISHED))},LightningStrike.prototype.init=function(e){this.rayParameters=e,this.maxIterations=void 0!==e.maxIterations?Math.floor(e.maxIterations):9,e.maxIterations=this.maxIterations,this.isStatic=void 0!==e.isStatic&&e.isStatic,e.isStatic=this.isStatic,this.ramification=void 0!==e.ramification?Math.floor(e.ramification):5,e.ramification=this.ramification,this.maxSubrayRecursion=void 0!==e.maxSubrayRecursion?Math.floor(e.maxSubrayRecursion):3,e.maxSubrayRecursion=this.maxSubrayRecursion,this.recursionProbability=void 0!==e.recursionProbability?e.recursionProbability:.6,e.recursionProbability=this.recursionProbability,this.generateUVs=void 0!==e.generateUVs&&e.generateUVs,e.generateUVs=this.generateUVs,void 0!==e.randomGenerator?(this.randomGenerator=e.randomGenerator,this.seedGenerator=e.randomGenerator,void 0!==e.noiseSeed&&this.seedGenerator.setSeed(e.noiseSeed)):(this.randomGenerator=LightningStrike.createRandomGenerator(),this.seedGenerator=Math),void 0!==e.onDecideSubrayCreation?this.onDecideSubrayCreation=e.onDecideSubrayCreation:(this.createDefaultSubrayCreationCallbacks(),void 0!==e.onSubrayCreation&&(this.onSubrayCreation=e.onSubrayCreation)),this.state=LightningStrike.RAY_INITIALIZED,this.maxSubrays=Math.ceil(1+Math.pow(this.ramification,Math.max(0,this.maxSubrayRecursion-1))),e.maxSubrays=this.maxSubrays,this.maxRaySegments=2*(1<<this.maxIterations),this.subrays=[];for(var t=0;t<this.maxSubrays;t++)this.subrays.push(this.createSubray());this.raySegments=[];for(t=0;t<this.maxRaySegments;t++)this.raySegments.push(this.createSegment());this.time=0,this.timeFraction=0,this.currentSegmentCallback=null,this.currentCreateTriangleVertices=this.generateUVs?this.createTriangleVerticesWithUVs:this.createTriangleVerticesWithoutUVs,this.numSubrays=0,this.currentSubray=null,this.currentSegmentIndex=0,this.isInitialSegment=!1,this.subrayProbability=0,this.currentVertex=0,this.currentIndex=0,this.currentCoordinate=0,this.currentUVCoordinate=0,this.vertices=null,this.uvs=null,this.indices=null,this.positionAttribute=null,this.uvsAttribute=null,this.simplexX=new SimplexNoise(this.seedGenerator),this.simplexY=new SimplexNoise(this.seedGenerator),this.simplexZ=new SimplexNoise(this.seedGenerator),this.forwards=new Vector3,this.forwardsFill=new Vector3,this.side=new Vector3,this.down=new Vector3,this.middlePos=new Vector3,this.middleLinPos=new Vector3,this.newPos=new Vector3,this.vPos=new Vector3,this.cross1=new Vector3},LightningStrike.prototype.createMesh=function(){var e=1<<this.maxIterations,t=3*(e+1)*this.maxSubrays,r=18*e*this.maxSubrays;this.vertices=new Float32Array(3*t),this.indices=new Uint32Array(r),this.generateUVs&&(this.uvs=new Float32Array(2*t)),this.fillMesh(0),this.setIndex(new Uint32BufferAttribute(this.indices,1)),this.positionAttribute=new Float32BufferAttribute(this.vertices,3),this.addAttribute("position",this.positionAttribute),this.generateUVs&&(this.uvsAttribute=new Float32BufferAttribute(new Float32Array(this.uvs),2),this.addAttribute("uv",this.uvsAttribute)),this.isStatic||(this.index.dynamic=!0,this.positionAttribute.dynamic=!0,this.generateUVs&&(this.uvsAttribute.dynamic=!0)),this.vertices=this.positionAttribute.array,this.indices=this.index.array,this.generateUVs&&(this.uvs=this.uvsAttribute.array)},LightningStrike.prototype.updateMesh=function(e){this.fillMesh(e),this.drawRange.count=this.currentIndex,this.index.needsUpdate=!0,this.positionAttribute.needsUpdate=!0,this.generateUVs&&(this.uvsAttribute.needsUpdate=!0)},LightningStrike.prototype.fillMesh=function(e){var t=this;this.currentVertex=0,this.currentIndex=0,this.currentCoordinate=0,this.currentUVCoordinate=0,this.fractalRay(e,function(r){var n=t.currentSubray;e<n.birthTime||(this.rayParameters.isEternal&&0==t.currentSubray.recursion?(t.createPrism(r),t.onDecideSubrayCreation(r,t)):e<n.endPropagationTime?t.timeFraction>=r.fraction0*n.propagationTimeFactor&&(t.createPrism(r),t.onDecideSubrayCreation(r,t)):e<n.beginVanishingTime?(t.createPrism(r),t.onDecideSubrayCreation(r,t)):(t.timeFraction<=n.vanishingTimeFactor+r.fraction1*(1-n.vanishingTimeFactor)&&t.createPrism(r),t.onDecideSubrayCreation(r,t)))})},LightningStrike.prototype.addNewSubray=function(e){return this.subrays[this.numSubrays++]},LightningStrike.prototype.initSubray=function(e,t){e.pos0.copy(t.sourceOffset),e.pos1.copy(t.destOffset),e.up0.copy(t.up0),e.up1.copy(t.up1),e.radius0=t.radius0,e.radius1=t.radius1,e.birthTime=t.birthTime,e.deathTime=t.deathTime,e.timeScale=t.timeScale,e.roughness=t.roughness,e.straightness=t.straightness,e.propagationTimeFactor=t.propagationTimeFactor,e.vanishingTimeFactor=t.vanishingTimeFactor,e.maxIterations=this.maxIterations,e.seed=void 0!==t.noiseSeed?t.noiseSeed:0,e.recursion=0},LightningStrike.prototype.fractalRay=function(e,t){this.time=e,this.currentSegmentCallback=t,this.numSubrays=0,this.initSubray(this.addNewSubray(),this.rayParameters);for(var r=0;r<this.numSubrays;r++){var n=this.subrays[r];this.currentSubray=n,this.randomGenerator.setSeed(n.seed),n.endPropagationTime=_Math.lerp(n.birthTime,n.deathTime,n.propagationTimeFactor),n.beginVanishingTime=_Math.lerp(n.deathTime,n.birthTime,1-n.vanishingTimeFactor);var i=this.randomGenerator.random;n.linPos0.set(i(),i(),i()).multiplyScalar(1e3),n.linPos1.set(i(),i(),i()).multiplyScalar(1e3),this.timeFraction=(e-n.birthTime)/(n.deathTime-n.birthTime),this.currentSegmentIndex=0,this.isInitialSegment=!0;var o=this.getNewSegment();o.iteration=0,o.pos0.copy(n.pos0),o.pos1.copy(n.pos1),o.linPos0.copy(n.linPos0),o.linPos1.copy(n.linPos1),o.up0.copy(n.up0),o.up1.copy(n.up1),o.radius0=n.radius0,o.radius1=n.radius1,o.fraction0=0,o.fraction1=1,o.positionVariationFactor=1-n.straightness,this.subrayProbability=this.ramification*Math.pow(this.recursionProbability,n.recursion)/(1<<n.maxIterations),this.fractalRayRecursive(o)}this.currentSegmentCallback=null,this.currentSubray=null},LightningStrike.prototype.fractalRayRecursive=function(e){if(e.iteration>=this.currentSubray.maxIterations)this.currentSegmentCallback(e);else{this.forwards.subVectors(e.pos1,e.pos0);var t=this.forwards.length();t<1e-6&&(this.forwards.set(0,0,.01),t=this.forwards.length());var r=.5*(e.radius0+e.radius1),n=.5*(e.fraction0+e.fraction1),i=this.time*this.currentSubray.timeScale*Math.pow(2,e.iteration);this.middlePos.lerpVectors(e.pos0,e.pos1,.5),this.middleLinPos.lerpVectors(e.linPos0,e.linPos1,.5);var o=this.middleLinPos;this.newPos.set(this.simplexX.noise4d(o.x,o.y,o.z,i),this.simplexY.noise4d(o.x,o.y,o.z,i),this.simplexZ.noise4d(o.x,o.y,o.z,i)),this.newPos.multiplyScalar(e.positionVariationFactor*t),this.newPos.add(this.middlePos);var a=this.getNewSegment();a.pos0.copy(e.pos0),a.pos1.copy(this.newPos),a.linPos0.copy(e.linPos0),a.linPos1.copy(this.middleLinPos),a.up0.copy(e.up0),a.up1.copy(e.up1),a.radius0=e.radius0,a.radius1=r,a.fraction0=e.fraction0,a.fraction1=n,a.positionVariationFactor=e.positionVariationFactor*this.currentSubray.roughness,a.iteration=e.iteration+1;var s=this.getNewSegment();s.pos0.copy(this.newPos),s.pos1.copy(e.pos1),s.linPos0.copy(this.middleLinPos),s.linPos1.copy(e.linPos1),this.cross1.crossVectors(e.up0,this.forwards.normalize()),s.up0.crossVectors(this.forwards,this.cross1).normalize(),s.up1.copy(e.up1),s.radius0=r,s.radius1=e.radius1,s.fraction0=n,s.fraction1=e.fraction1,s.positionVariationFactor=e.positionVariationFactor*this.currentSubray.roughness,s.iteration=e.iteration+1,this.fractalRayRecursive(a),this.fractalRayRecursive(s)}},LightningStrike.prototype.createPrism=function(e){this.forwardsFill.subVectors(e.pos1,e.pos0).normalize(),this.isInitialSegment&&(this.currentCreateTriangleVertices(e.pos0,e.up0,this.forwardsFill,e.radius0,0),this.isInitialSegment=!1),this.currentCreateTriangleVertices(e.pos1,e.up0,this.forwardsFill,e.radius1,e.fraction1),this.createPrismFaces()},LightningStrike.prototype.createTriangleVerticesWithoutUVs=function(e,t,r,n){this.side.crossVectors(t,r).multiplyScalar(n*LightningStrike.COS30DEG),this.down.copy(t).multiplyScalar(-n*LightningStrike.SIN30DEG);var i=this.vPos,o=this.vertices;i.copy(e).sub(this.side).add(this.down),o[this.currentCoordinate++]=i.x,o[this.currentCoordinate++]=i.y,o[this.currentCoordinate++]=i.z,i.copy(e).add(this.side).add(this.down),o[this.currentCoordinate++]=i.x,o[this.currentCoordinate++]=i.y,o[this.currentCoordinate++]=i.z,i.copy(t).multiplyScalar(n).add(e),o[this.currentCoordinate++]=i.x,o[this.currentCoordinate++]=i.y,o[this.currentCoordinate++]=i.z,this.currentVertex+=3},LightningStrike.prototype.createTriangleVerticesWithUVs=function(e,t,r,n,i){this.side.crossVectors(t,r).multiplyScalar(n*LightningStrike.COS30DEG),this.down.copy(t).multiplyScalar(-n*LightningStrike.SIN30DEG);var o=this.vPos,a=this.vertices,s=this.uvs;o.copy(e).sub(this.side).add(this.down),a[this.currentCoordinate++]=o.x,a[this.currentCoordinate++]=o.y,a[this.currentCoordinate++]=o.z,s[this.currentUVCoordinate++]=i,s[this.currentUVCoordinate++]=0,o.copy(e).add(this.side).add(this.down),a[this.currentCoordinate++]=o.x,a[this.currentCoordinate++]=o.y,a[this.currentCoordinate++]=o.z,s[this.currentUVCoordinate++]=i,s[this.currentUVCoordinate++]=.5,o.copy(t).multiplyScalar(n).add(e),a[this.currentCoordinate++]=o.x,a[this.currentCoordinate++]=o.y,a[this.currentCoordinate++]=o.z,s[this.currentUVCoordinate++]=i,s[this.currentUVCoordinate++]=1,this.currentVertex+=3},LightningStrike.prototype.createPrismFaces=function(e,t){var r=this.indices;e=this.currentVertex-6;r[this.currentIndex++]=e+1,r[this.currentIndex++]=e+2,r[this.currentIndex++]=e+5,r[this.currentIndex++]=e+1,r[this.currentIndex++]=e+5,r[this.currentIndex++]=e+4,r[this.currentIndex++]=e+0,r[this.currentIndex++]=e+1,r[this.currentIndex++]=e+4,r[this.currentIndex++]=e+0,r[this.currentIndex++]=e+4,r[this.currentIndex++]=e+3,r[this.currentIndex++]=e+2,r[this.currentIndex++]=e+0,r[this.currentIndex++]=e+3,r[this.currentIndex++]=e+2,r[this.currentIndex++]=e+3,r[this.currentIndex++]=e+5},LightningStrike.prototype.createDefaultSubrayCreationCallbacks=function(){var e=this.randomGenerator.random;this.onDecideSubrayCreation=function(t,r){var n=r.currentSubray,i=r.rayParameters.subrayPeriod,o=r.rayParameters.subrayDutyCycle,a=r.rayParameters.isEternal&&0==n.recursion?-e()*i:_Math.lerp(n.birthTime,n.endPropagationTime,t.fraction0)-e()*i,s=r.time-a,l=Math.floor(s/i),u=e()*(l+1),c=s%i<=o*i;h=r.subrayProbability;var h=0;if(c&&(h=r.subrayProbability),n.recursion<r.maxSubrayRecursion&&r.numSubrays<r.maxSubrays&&e()<h){var p=r.addNewSubray(),f=r.randomGenerator.getSeed();p.seed=u,r.randomGenerator.setSeed(u),p.recursion=n.recursion+1,p.maxIterations=Math.max(1,n.maxIterations-1),p.linPos0.set(e(),e(),e()).multiplyScalar(1e3),p.linPos1.set(e(),e(),e()).multiplyScalar(1e3),p.up0.copy(n.up0),p.up1.copy(n.up1),p.radius0=t.radius0*r.rayParameters.radius0Factor,p.radius1=Math.min(r.rayParameters.minRadius,t.radius1*r.rayParameters.radius1Factor),p.birthTime=a+l*i,p.deathTime=p.birthTime+i*o,r.rayParameters.isEternal||0!=n.recursion||(p.birthTime=Math.max(p.birthTime,n.birthTime),p.deathTime=Math.min(p.deathTime,n.deathTime)),p.timeScale=2*n.timeScale,p.roughness=n.roughness,p.straightness=n.straightness,p.propagationTimeFactor=n.propagationTimeFactor,p.vanishingTimeFactor=n.vanishingTimeFactor,r.onSubrayCreation(t,n,p,r),r.randomGenerator.setSeed(f)}};var t=new Vector3,r=new Vector3,n=new Vector3,i=new Vector3;this.onSubrayCreation=function(e,t,r,n){n.subrayCylinderPosition(e,t,r,.5,.6,.2)},this.subrayConePosition=function(o,a,s,l,u,c){s.pos0.copy(o.pos0),t.subVectors(a.pos1,a.pos0),r.copy(t).normalize(),t.multiplyScalar(o.fraction0+(1-o.fraction0)*(e()*l));var h=t.length();n.crossVectors(a.up0,r);var p=2*Math.PI*e();n.multiplyScalar(Math.cos(p)),i.copy(a.up0).multiplyScalar(Math.sin(p)),s.pos1.copy(n).add(i).multiplyScalar(h*u*(c+e()*(1-c))).add(t).add(a.pos0)},this.subrayCylinderPosition=function(o,a,s,l,u,c){s.pos0.copy(o.pos0),t.subVectors(a.pos1,a.pos0),r.copy(t).normalize(),t.multiplyScalar(o.fraction0+(1-o.fraction0)*((2*e()-1)*l));var h=t.length();n.crossVectors(a.up0,r);var p=2*Math.PI*e();n.multiplyScalar(Math.cos(p)),i.copy(a.up0).multiplyScalar(Math.sin(p)),s.pos1.copy(n).add(i).multiplyScalar(h*u*(c+e()*(1-c))).add(t).add(a.pos0)}},LightningStrike.prototype.createSubray=function(){return{seed:0,maxIterations:0,recursion:0,pos0:new Vector3,pos1:new Vector3,linPos0:new Vector3,linPos1:new Vector3,up0:new Vector3,up1:new Vector3,radius0:0,radius1:0,birthTime:0,deathTime:0,timeScale:0,roughness:0,straightness:0,propagationTimeFactor:0,vanishingTimeFactor:0,endPropagationTime:0,beginVanishingTime:0}},LightningStrike.prototype.createSegment=function(){return{iteration:0,pos0:new Vector3,pos1:new Vector3,linPos0:new Vector3,linPos1:new Vector3,up0:new Vector3,up1:new Vector3,radius0:0,radius1:0,fraction0:0,fraction1:0,positionVariationFactor:0}},LightningStrike.prototype.getNewSegment=function(){return this.raySegments[this.currentSegmentIndex++]},LightningStrike.prototype.copy=function(e){return BufferGeometry.prototype.copy.call(this,e),this.init(LightningStrike.copyParameters({},e.rayParameters)),this},LightningStrike.prototype.clone=function(){return new this.constructor(LightningStrike.copyParameters({},this.rayParameters))};var TeapotBufferGeometry=function(e,t,r,n,i,o,a){var s=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,3,16,17,18,7,19,20,21,11,22,23,24,15,25,26,27,18,28,29,30,21,31,32,33,24,34,35,36,27,37,38,39,30,40,41,0,33,42,43,4,36,44,45,8,39,46,47,12,12,13,14,15,48,49,50,51,52,53,54,55,56,57,58,59,15,25,26,27,51,60,61,62,55,63,64,65,59,66,67,68,27,37,38,39,62,69,70,71,65,72,73,74,68,75,76,77,39,46,47,12,71,78,79,48,74,80,81,52,77,82,83,56,56,57,58,59,84,85,86,87,88,89,90,91,92,93,94,95,59,66,67,68,87,96,97,98,91,99,100,101,95,102,103,104,68,75,76,77,98,105,106,107,101,108,109,110,104,111,112,113,77,82,83,56,107,114,115,84,110,116,117,88,113,118,119,92,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,123,136,137,120,127,138,139,124,131,140,141,128,135,142,143,132,132,133,134,135,144,145,146,147,148,149,150,151,68,152,153,154,135,142,143,132,147,155,156,144,151,157,158,148,154,159,160,68,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,164,177,178,161,168,179,180,165,172,181,182,169,176,183,184,173,173,174,175,176,185,186,187,188,189,190,191,192,193,194,195,196,176,183,184,173,188,197,198,185,192,199,200,189,196,201,202,193,203,203,203,203,204,205,206,207,208,208,208,208,209,210,211,212,203,203,203,203,207,213,214,215,208,208,208,208,212,216,217,218,203,203,203,203,215,219,220,221,208,208,208,208,218,222,223,224,203,203,203,203,221,225,226,204,208,208,208,208,224,227,228,209,209,210,211,212,229,230,231,232,233,234,235,236,237,238,239,240,212,216,217,218,232,241,242,243,236,244,245,246,240,247,248,249,218,222,223,224,243,250,251,252,246,253,254,255,249,256,257,258,224,227,228,209,252,259,260,229,255,261,262,233,258,263,264,237,265,265,265,265,266,267,268,269,270,271,272,273,92,119,118,113,265,265,265,265,269,274,275,276,273,277,278,279,113,112,111,104,265,265,265,265,276,280,281,282,279,283,284,285,104,103,102,95,265,265,265,265,282,286,287,266,285,288,289,270,95,94,93,92],l=[1.4,0,2.4,1.4,-.784,2.4,.784,-1.4,2.4,0,-1.4,2.4,1.3375,0,2.53125,1.3375,-.749,2.53125,.749,-1.3375,2.53125,0,-1.3375,2.53125,1.4375,0,2.53125,1.4375,-.805,2.53125,.805,-1.4375,2.53125,0,-1.4375,2.53125,1.5,0,2.4,1.5,-.84,2.4,.84,-1.5,2.4,0,-1.5,2.4,-.784,-1.4,2.4,-1.4,-.784,2.4,-1.4,0,2.4,-.749,-1.3375,2.53125,-1.3375,-.749,2.53125,-1.3375,0,2.53125,-.805,-1.4375,2.53125,-1.4375,-.805,2.53125,-1.4375,0,2.53125,-.84,-1.5,2.4,-1.5,-.84,2.4,-1.5,0,2.4,-1.4,.784,2.4,-.784,1.4,2.4,0,1.4,2.4,-1.3375,.749,2.53125,-.749,1.3375,2.53125,0,1.3375,2.53125,-1.4375,.805,2.53125,-.805,1.4375,2.53125,0,1.4375,2.53125,-1.5,.84,2.4,-.84,1.5,2.4,0,1.5,2.4,.784,1.4,2.4,1.4,.784,2.4,.749,1.3375,2.53125,1.3375,.749,2.53125,.805,1.4375,2.53125,1.4375,.805,2.53125,.84,1.5,2.4,1.5,.84,2.4,1.75,0,1.875,1.75,-.98,1.875,.98,-1.75,1.875,0,-1.75,1.875,2,0,1.35,2,-1.12,1.35,1.12,-2,1.35,0,-2,1.35,2,0,.9,2,-1.12,.9,1.12,-2,.9,0,-2,.9,-.98,-1.75,1.875,-1.75,-.98,1.875,-1.75,0,1.875,-1.12,-2,1.35,-2,-1.12,1.35,-2,0,1.35,-1.12,-2,.9,-2,-1.12,.9,-2,0,.9,-1.75,.98,1.875,-.98,1.75,1.875,0,1.75,1.875,-2,1.12,1.35,-1.12,2,1.35,0,2,1.35,-2,1.12,.9,-1.12,2,.9,0,2,.9,.98,1.75,1.875,1.75,.98,1.875,1.12,2,1.35,2,1.12,1.35,1.12,2,.9,2,1.12,.9,2,0,.45,2,-1.12,.45,1.12,-2,.45,0,-2,.45,1.5,0,.225,1.5,-.84,.225,.84,-1.5,.225,0,-1.5,.225,1.5,0,.15,1.5,-.84,.15,.84,-1.5,.15,0,-1.5,.15,-1.12,-2,.45,-2,-1.12,.45,-2,0,.45,-.84,-1.5,.225,-1.5,-.84,.225,-1.5,0,.225,-.84,-1.5,.15,-1.5,-.84,.15,-1.5,0,.15,-2,1.12,.45,-1.12,2,.45,0,2,.45,-1.5,.84,.225,-.84,1.5,.225,0,1.5,.225,-1.5,.84,.15,-.84,1.5,.15,0,1.5,.15,1.12,2,.45,2,1.12,.45,.84,1.5,.225,1.5,.84,.225,.84,1.5,.15,1.5,.84,.15,-1.6,0,2.025,-1.6,-.3,2.025,-1.5,-.3,2.25,-1.5,0,2.25,-2.3,0,2.025,-2.3,-.3,2.025,-2.5,-.3,2.25,-2.5,0,2.25,-2.7,0,2.025,-2.7,-.3,2.025,-3,-.3,2.25,-3,0,2.25,-2.7,0,1.8,-2.7,-.3,1.8,-3,-.3,1.8,-3,0,1.8,-1.5,.3,2.25,-1.6,.3,2.025,-2.5,.3,2.25,-2.3,.3,2.025,-3,.3,2.25,-2.7,.3,2.025,-3,.3,1.8,-2.7,.3,1.8,-2.7,0,1.575,-2.7,-.3,1.575,-3,-.3,1.35,-3,0,1.35,-2.5,0,1.125,-2.5,-.3,1.125,-2.65,-.3,.9375,-2.65,0,.9375,-2,-.3,.9,-1.9,-.3,.6,-1.9,0,.6,-3,.3,1.35,-2.7,.3,1.575,-2.65,.3,.9375,-2.5,.3,1.125,-1.9,.3,.6,-2,.3,.9,1.7,0,1.425,1.7,-.66,1.425,1.7,-.66,.6,1.7,0,.6,2.6,0,1.425,2.6,-.66,1.425,3.1,-.66,.825,3.1,0,.825,2.3,0,2.1,2.3,-.25,2.1,2.4,-.25,2.025,2.4,0,2.025,2.7,0,2.4,2.7,-.25,2.4,3.3,-.25,2.4,3.3,0,2.4,1.7,.66,.6,1.7,.66,1.425,3.1,.66,.825,2.6,.66,1.425,2.4,.25,2.025,2.3,.25,2.1,3.3,.25,2.4,2.7,.25,2.4,2.8,0,2.475,2.8,-.25,2.475,3.525,-.25,2.49375,3.525,0,2.49375,2.9,0,2.475,2.9,-.15,2.475,3.45,-.15,2.5125,3.45,0,2.5125,2.8,0,2.4,2.8,-.15,2.4,3.2,-.15,2.4,3.2,0,2.4,3.525,.25,2.49375,2.8,.25,2.475,3.45,.15,2.5125,2.9,.15,2.475,3.2,.15,2.4,2.8,.15,2.4,0,0,3.15,.8,0,3.15,.8,-.45,3.15,.45,-.8,3.15,0,-.8,3.15,0,0,2.85,.2,0,2.7,.2,-.112,2.7,.112,-.2,2.7,0,-.2,2.7,-.45,-.8,3.15,-.8,-.45,3.15,-.8,0,3.15,-.112,-.2,2.7,-.2,-.112,2.7,-.2,0,2.7,-.8,.45,3.15,-.45,.8,3.15,0,.8,3.15,-.2,.112,2.7,-.112,.2,2.7,0,.2,2.7,.45,.8,3.15,.8,.45,3.15,.112,.2,2.7,.2,.112,2.7,.4,0,2.55,.4,-.224,2.55,.224,-.4,2.55,0,-.4,2.55,1.3,0,2.55,1.3,-.728,2.55,.728,-1.3,2.55,0,-1.3,2.55,1.3,0,2.4,1.3,-.728,2.4,.728,-1.3,2.4,0,-1.3,2.4,-.224,-.4,2.55,-.4,-.224,2.55,-.4,0,2.55,-.728,-1.3,2.55,-1.3,-.728,2.55,-1.3,0,2.55,-.728,-1.3,2.4,-1.3,-.728,2.4,-1.3,0,2.4,-.4,.224,2.55,-.224,.4,2.55,0,.4,2.55,-1.3,.728,2.55,-.728,1.3,2.55,0,1.3,2.55,-1.3,.728,2.4,-.728,1.3,2.4,0,1.3,2.4,.224,.4,2.55,.4,.224,2.55,.728,1.3,2.55,1.3,.728,2.55,.728,1.3,2.4,1.3,.728,2.4,0,0,0,1.425,0,0,1.425,.798,0,.798,1.425,0,0,1.425,0,1.5,0,.075,1.5,.84,.075,.84,1.5,.075,0,1.5,.075,-.798,1.425,0,-1.425,.798,0,-1.425,0,0,-.84,1.5,.075,-1.5,.84,.075,-1.5,0,.075,-1.425,-.798,0,-.798,-1.425,0,0,-1.425,0,-1.5,-.84,.075,-.84,-1.5,.075,0,-1.5,.075,.798,-1.425,0,1.425,-.798,0,.84,-1.5,.075,1.5,-.84,.075];BufferGeometry.call(this),e=e||50,t=void 0!==t?Math.max(2,Math.floor(t)||10):10,o=void 0===o||o;var u=3.15*((a=void 0===a||a)?1:1.3)/2,c=e/u,h=(r=void 0===r||r)?(8*t-4)*t:0;h+=(n=void 0===n||n)?(16*t-4)*t:0,h+=(i=void 0===i||i)?40*t*t:0;var p=new Uint32Array(3*h),f=r?4:0;f+=n?8:0,f+=i?20:0,f*=(t+1)*(t+1);var d=new Float32Array(3*f),m=new Float32Array(3*f),v=new Float32Array(2*f),g=new Matrix4;g.set(-1,3,-3,1,3,-6,3,0,-3,3,0,0,1,0,0,0);var y,b,x,w,S,M,_,T,A,C,E,L,N,P,O,R,D=[],F=[],k=[],I=[],B=[],U=[],V=[],j=[],z=[],G=new Vector3,W=0,H=0,X=new Vector3,q=new Matrix4,Y=new Matrix4,K=new Vector4,Q=new Vector4,J=new Vector4,Z=new Vector4,$=new Vector3,ee=new Vector3,te=g.clone();te.transpose();var re=function(e,t,r){return!(d[3*e]===d[3*t]&&d[3*e+1]===d[3*t+1]&&d[3*e+2]===d[3*t+2]||d[3*e]===d[3*r]&&d[3*e+1]===d[3*r+1]&&d[3*e+2]===d[3*r+2]||d[3*t]===d[3*r]&&d[3*t+1]===d[3*r+1]&&d[3*t+2]===d[3*r+2])};for(y=0;y<3;y++)U[y]=new Matrix4;var ne=r?32:28;_=t+1;for(var ie=0,oe=0,ae=0,se=0,le=0,ue=i?0:20;ue<ne;ue++)if(n||ue<20||ue>=28){for(y=0;y<3;y++){for(b=0;b<4;b++)for(x=0;x<4;x++)D[4*x+b]=l[3*s[16*ue+4*b+x]+y],o&&ue>=20&&ue<28&&2!==y&&(D[4*x+b]*=1.077),a||2!==y||(D[4*x+b]*=1.3);q.set(D[0],D[1],D[2],D[3],D[4],D[5],D[6],D[7],D[8],D[9],D[10],D[11],D[12],D[13],D[14],D[15]),Y.multiplyMatrices(q,g),U[y].multiplyMatrices(te,Y)}for(S=0;S<=t;S++)for(T=S/t,M=0;M<=t;M++){for(A=M/t,L=4,C=E=1;L--;)F[L]=C,k[L]=E,C*=T,E*=A,3===L?(I[L]=B[L]=0,W=H=1):(I[L]=W*(3-L),B[L]=H*(3-L),W*=T,H*=A);for(K.fromArray(F),Q.fromArray(k),J.fromArray(I),Z.fromArray(B),y=0;y<3;y++)(w=K.clone()).applyMatrix4(U[y]),V[y]=w.dot(Q),(w=J.clone()).applyMatrix4(U[y]),j[y]=w.dot(Q),(w=K.clone()).applyMatrix4(U[y]),z[y]=w.dot(Z);$.fromArray(j),ee.fromArray(z),G.crossVectors(ee,$),G.normalize(),0===V[0]&&0===V[1]?X.set(0,V[2]>u?1:-1,0):X.set(G.x,G.z,-G.y),d[oe++]=c*V[0],d[oe++]=c*(V[2]-u),d[oe++]=-c*V[1],m[ae++]=X.x,m[ae++]=X.y,m[ae++]=X.z,v[se++]=1-A,v[se++]=1-T}for(S=0;S<t;S++)for(M=0;M<t;M++)R=(N=ie*_*_+S*_+M)+_,re(N,P=N+1,O=P+_)&&(p[le++]=N,p[le++]=P,p[le++]=O),re(N,O,R)&&(p[le++]=N,p[le++]=O,p[le++]=R);ie++}this.setIndex(new BufferAttribute(p,1)),this.addAttribute("position",new BufferAttribute(d,3)),this.addAttribute("normal",new BufferAttribute(m,3)),this.addAttribute("uv",new BufferAttribute(v,2)),this.computeBoundingSphere()};function DataTexture(e,t,r,n,i,o,a,s,l,u,c,h){Texture.call(this,null,o,a,s,l,u,n,i,c,h),this.image={data:e,width:t,height:r},this.magFilter=void 0!==l?l:NearestFilter,this.minFilter=void 0!==u?u:NearestFilter,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function GPUComputationRenderer(e,t,r){this.variables=[],this.currentTextureIndex=0;var n=new Scene,i=new Camera;i.position.z=1;var o={texture:{value:null}},a=u("uniform sampler2D texture;\n\nvoid main() {\n\n\tvec2 uv = gl_FragCoord.xy / resolution.xy;\n\n\tgl_FragColor = texture2D( texture, uv );\n\n}\n",o),s=new Mesh(new PlaneBufferGeometry(2,2),a);function l(r){r.defines.resolution="vec2( "+e.toFixed(1)+", "+t.toFixed(1)+" )"}function u(e,t){var r=new ShaderMaterial({uniforms:t=t||{},vertexShader:"void main()\t{\n\n\tgl_Position = vec4( position, 1.0 );\n\n}\n",fragmentShader:e});return l(r),r}n.add(s),this.addVariable=function(e,t,r){var n={name:e,initialValueTexture:r,material:this.createShaderMaterial(t),dependencies:null,renderTargets:[],wrapS:null,wrapT:null,minFilter:NearestFilter,magFilter:NearestFilter};return this.variables.push(n),n},this.setVariableDependencies=function(e,t){e.dependencies=t},this.init=function(){if(!r.extensions.get("OES_texture_float"))return"No OES_texture_float support for float textures.";if(0===r.capabilities.maxVertexTextures)return"No support for vertex shader textures.";for(var n=0;n<this.variables.length;n++){var i=this.variables[n];i.renderTargets[0]=this.createRenderTarget(e,t,i.wrapS,i.wrapT,i.minFilter,i.magFilter),i.renderTargets[1]=this.createRenderTarget(e,t,i.wrapS,i.wrapT,i.minFilter,i.magFilter),this.renderTexture(i.initialValueTexture,i.renderTargets[0]),this.renderTexture(i.initialValueTexture,i.renderTargets[1]);var o=i.material,a=o.uniforms;if(null!==i.dependencies)for(var s=0;s<i.dependencies.length;s++){var l=i.dependencies[s];if(l.name!==i.name){for(var u=!1,c=0;c<this.variables.length;c++)if(l.name===this.variables[c].name){u=!0;break}if(!u)return"Variable dependency not found. Variable="+i.name+", dependency="+l.name}a[l.name]={value:null},o.fragmentShader="\nuniform sampler2D "+l.name+";\n"+o.fragmentShader}}return this.currentTextureIndex=0,null},this.compute=function(){for(var e=this.currentTextureIndex,t=0===this.currentTextureIndex?1:0,r=0,n=this.variables.length;r<n;r++){var i=this.variables[r];if(null!==i.dependencies)for(var o=i.material.uniforms,a=0,s=i.dependencies.length;a<s;a++){var l=i.dependencies[a];o[l.name].value=l.renderTargets[e].texture}this.doRenderTarget(i.material,i.renderTargets[t])}this.currentTextureIndex=t},this.getCurrentRenderTarget=function(e){return e.renderTargets[this.currentTextureIndex]},this.getAlternateRenderTarget=function(e){return e.renderTargets[0===this.currentTextureIndex?1:0]},this.addResolutionDefine=l,this.createShaderMaterial=u,this.createRenderTarget=function(r,n,i,o,a,s){return new WebGLRenderTarget(r=r||e,n=n||t,{wrapS:i=i||ClampToEdgeWrapping,wrapT:o=o||ClampToEdgeWrapping,minFilter:a=a||NearestFilter,magFilter:s=s||NearestFilter,format:RGBAFormat,type:/(iPad|iPhone|iPod)/g.test(navigator.userAgent)?HalfFloatType:FloatType,stencilBuffer:!1,depthBuffer:!1})},this.createTexture=function(){var r=new DataTexture(new Float32Array(e*t*4),e,t,RGBAFormat,FloatType);return r.needsUpdate=!0,r},this.renderTexture=function(e,t){o.texture.value=e,this.doRenderTarget(a,t),o.texture.value=null},this.doRenderTarget=function(e,t){var o=r.getRenderTarget();s.material=e,r.setRenderTarget(t),r.render(n,i),s.material=a,r.setRenderTarget(o)}}TeapotBufferGeometry.prototype=Object.create(BufferGeometry.prototype),TeapotBufferGeometry.prototype.constructor=TeapotBufferGeometry,DataTexture.prototype=Object.create(Texture.prototype),DataTexture.prototype.constructor=DataTexture,DataTexture.prototype.isDataTexture=!0;var Cache={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function LoadingManager(e,t,r){var n=this,i=!1,o=0,a=0,s=void 0;this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(e){a++,!1===i&&void 0!==n.onStart&&n.onStart(e,o,a),i=!0},this.itemEnd=function(e){o++,void 0!==n.onProgress&&n.onProgress(e,o,a),o===a&&(i=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(e){void 0!==n.onError&&n.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this}}var DefaultLoadingManager=new LoadingManager;function ImageLoader(e){this.manager=void 0!==e?e:DefaultLoadingManager}function TextureLoader(e){this.manager=void 0!==e?e:DefaultLoadingManager}function PointsMaterial(e){Material$1.call(this),this.type="PointsMaterial",this.color=new Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function Points(e,t){Object3D.call(this),this.type="Points",this.geometry=void 0!==e?e:new BufferGeometry,this.material=void 0!==t?t:new PointsMaterial({color:16777215*Math.random()})}Object.assign(ImageLoader.prototype,{crossOrigin:"anonymous",load:function(e,t,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=Cache.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout(function(){t&&t(o),i.manager.itemEnd(e)},0),o;var a=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){a.removeEventListener("load",s,!1),a.removeEventListener("error",l,!1),Cache.add(e,this),t&&t(this),i.manager.itemEnd(e)}function l(t){a.removeEventListener("load",s,!1),a.removeEventListener("error",l,!1),n&&n(t),i.manager.itemError(e),i.manager.itemEnd(e)}return a.addEventListener("load",s,!1),a.addEventListener("error",l,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(e),a.src=e,a},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(TextureLoader.prototype,{crossOrigin:"anonymous",load:function(e,t,r,n){var i=new Texture,o=new ImageLoader(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(r){i.image=r;var n=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);i.format=n?RGBFormat:RGBAFormat,i.needsUpdate=!0,void 0!==t&&t(i)},r,n),i},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),PointsMaterial.prototype=Object.create(Material$1.prototype),PointsMaterial.prototype.constructor=PointsMaterial,PointsMaterial.prototype.isPointsMaterial=!0,PointsMaterial.prototype.copy=function(e){return Material$1.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this},Points.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Points,isPoints:!0,raycast:function(){var e=new Matrix4,t=new Ray,r=new Sphere;return function(n,i){var o=this,a=this.geometry,s=this.matrixWorld,l=n.params.Points.threshold;if(null===a.boundingSphere&&a.computeBoundingSphere(),r.copy(a.boundingSphere),r.applyMatrix4(s),r.radius+=l,!1!==n.ray.intersectsSphere(r)){e.getInverse(s),t.copy(n.ray).applyMatrix4(e);var u=l/((this.scale.x+this.scale.y+this.scale.z)/3),c=u*u,h=new Vector3,p=new Vector3;if(a.isBufferGeometry){var f=a.index,d=a.attributes.position.array;if(null!==f)for(var m=f.array,v=0,g=m.length;v<g;v++){var y=m[v];h.fromArray(d,3*y),w(h,y)}else{v=0;for(var b=d.length/3;v<b;v++)h.fromArray(d,3*v),w(h,v)}}else{var x=a.vertices;for(v=0,b=x.length;v<b;v++)w(x[v],v)}}function w(e,r){var a=t.distanceSqToPoint(e);if(a<c){t.closestPointToPoint(e,p),p.applyMatrix4(s);var l=n.ray.origin.distanceTo(p);if(l<n.near||l>n.far)return;i.push({distance:l,distanceToRay:Math.sqrt(a),point:p.clone(),index:r,face:null,object:o})}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var GPUParticleSystem=function(e){Object3D.apply(this,arguments),e=e||{},this.PARTICLE_COUNT=e.maxParticles||1e6,this.PARTICLE_CONTAINERS=e.containerCount||1,this.PARTICLE_NOISE_TEXTURE=e.particleNoiseTex||null,this.PARTICLE_SPRITE_TEXTURE=e.particleSpriteTex||null,this.PARTICLES_PER_CONTAINER=Math.ceil(this.PARTICLE_COUNT/this.PARTICLE_CONTAINERS),this.PARTICLE_CURSOR=0,this.time=0,this.particleContainers=[],this.rand=[];var t,r={vertexShader:["uniform float uTime;","uniform float uScale;","uniform sampler2D tNoise;","attribute vec3 positionStart;","attribute float startTime;","attribute vec3 velocity;","attribute float turbulence;","attribute vec3 color;","attribute float size;","attribute float lifeTime;","varying vec4 vColor;","varying float lifeLeft;","void main() {","\tvColor = vec4( color, 1.0 );","\tvec3 newPosition;","\tvec3 v;","\tfloat timeElapsed = uTime - startTime;","\tlifeLeft = 1.0 - ( timeElapsed / lifeTime );","\tgl_PointSize = ( uScale * size ) * lifeLeft;","\tv.x = ( velocity.x - 0.5 ) * 3.0;","\tv.y = ( velocity.y - 0.5 ) * 3.0;","\tv.z = ( velocity.z - 0.5 ) * 3.0;","\tnewPosition = positionStart + ( v * 10.0 ) * timeElapsed;","\tvec3 noise = texture2D( tNoise, vec2( newPosition.x * 0.015 + ( uTime * 0.05 ), newPosition.y * 0.02 + ( uTime * 0.015 ) ) ).rgb;","\tvec3 noiseVel = ( noise.rgb - 0.5 ) * 30.0;","\tnewPosition = mix( newPosition, newPosition + vec3( noiseVel * ( turbulence * 5.0 ) ), ( timeElapsed / lifeTime ) );","\tif( v.y > 0. && v.y < .05 ) {","\t\tlifeLeft = 0.0;","\t}","\tif( v.x < - 1.45 ) {","\t\tlifeLeft = 0.0;","\t}","\tif( timeElapsed > 0.0 ) {","\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( newPosition, 1.0 );","\t} else {","\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","\t\tlifeLeft = 0.0;","\t\tgl_PointSize = 0.;","\t}","}"].join("\n"),fragmentShader:["float scaleLinear( float value, vec2 valueDomain ) {","\treturn ( value - valueDomain.x ) / ( valueDomain.y - valueDomain.x );","}","float scaleLinear( float value, vec2 valueDomain, vec2 valueRange ) {","\treturn mix( valueRange.x, valueRange.y, scaleLinear( value, valueDomain ) );","}","varying vec4 vColor;","varying float lifeLeft;","uniform sampler2D tSprite;","void main() {","\tfloat alpha = 0.;","\tif( lifeLeft > 0.995 ) {","\t\talpha = scaleLinear( lifeLeft, vec2( 1.0, 0.995 ), vec2( 0.0, 1.0 ) );","\t} else {","\t\talpha = lifeLeft * 0.75;","\t}","\tvec4 tex = texture2D( tSprite, gl_PointCoord );","\tgl_FragColor = vec4( vColor.rgb * tex.a, alpha * tex.a );","}"].join("\n")};for(t=1e5;t>0;t--)this.rand.push(Math.random()-.5);this.random=function(){return++t>=this.rand.length?this.rand[t=1]:this.rand[t]};var n=new TextureLoader;this.particleNoiseTex=this.PARTICLE_NOISE_TEXTURE||n.load("textures/perlin-512.png"),this.particleNoiseTex.wrapS=this.particleNoiseTex.wrapT=RepeatWrapping,this.particleSpriteTex=this.PARTICLE_SPRITE_TEXTURE||n.load("textures/particle2.png"),this.particleSpriteTex.wrapS=this.particleSpriteTex.wrapT=RepeatWrapping,this.particleShaderMat=new ShaderMaterial({transparent:!0,depthWrite:!1,uniforms:{uTime:{value:0},uScale:{value:1},tNoise:{value:this.particleNoiseTex},tSprite:{value:this.particleSpriteTex}},blending:AdditiveBlending,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader}),this.particleShaderMat.defaultAttributeValues.particlePositionsStartTime=[0,0,0,0],this.particleShaderMat.defaultAttributeValues.particleVelColSizeLife=[0,0,0,0],this.init=function(){for(var e=0;e<this.PARTICLE_CONTAINERS;e++){var t=new GPUParticleContainer(this.PARTICLES_PER_CONTAINER,this);this.particleContainers.push(t),this.add(t)}},this.spawnParticle=function(e){this.PARTICLE_CURSOR++,this.PARTICLE_CURSOR>=this.PARTICLE_COUNT&&(this.PARTICLE_CURSOR=1),this.particleContainers[Math.floor(this.PARTICLE_CURSOR/this.PARTICLES_PER_CONTAINER)].spawnParticle(e)},this.update=function(e){for(var t=0;t<this.PARTICLE_CONTAINERS;t++)this.particleContainers[t].update(e)},this.dispose=function(){this.particleShaderMat.dispose(),this.particleNoiseTex.dispose(),this.particleSpriteTex.dispose();for(var e=0;e<this.PARTICLE_CONTAINERS;e++)this.particleContainers[e].dispose()},this.init()};GPUParticleSystem.prototype=Object.create(Object3D.prototype),GPUParticleSystem.prototype.constructor=GPUParticleSystem;var GPUParticleContainer=function(e,t){Object3D.apply(this,arguments),this.PARTICLE_COUNT=e||1e5,this.PARTICLE_CURSOR=0,this.time=0,this.offset=0,this.count=0,this.DPR=window.devicePixelRatio,this.GPUParticleSystem=t,this.particleUpdate=!1,this.particleShaderGeo=new BufferGeometry,this.particleShaderGeo.addAttribute("position",new BufferAttribute(new Float32Array(3*this.PARTICLE_COUNT),3).setDynamic(!0)),this.particleShaderGeo.addAttribute("positionStart",new BufferAttribute(new Float32Array(3*this.PARTICLE_COUNT),3).setDynamic(!0)),this.particleShaderGeo.addAttribute("startTime",new BufferAttribute(new Float32Array(this.PARTICLE_COUNT),1).setDynamic(!0)),this.particleShaderGeo.addAttribute("velocity",new BufferAttribute(new Float32Array(3*this.PARTICLE_COUNT),3).setDynamic(!0)),this.particleShaderGeo.addAttribute("turbulence",new BufferAttribute(new Float32Array(this.PARTICLE_COUNT),1).setDynamic(!0)),this.particleShaderGeo.addAttribute("color",new BufferAttribute(new Float32Array(3*this.PARTICLE_COUNT),3).setDynamic(!0)),this.particleShaderGeo.addAttribute("size",new BufferAttribute(new Float32Array(this.PARTICLE_COUNT),1).setDynamic(!0)),this.particleShaderGeo.addAttribute("lifeTime",new BufferAttribute(new Float32Array(this.PARTICLE_COUNT),1).setDynamic(!0)),this.particleShaderMat=this.GPUParticleSystem.particleShaderMat;var r=new Vector3,n=new Vector3,i=new Color;this.spawnParticle=function(e){var o=this.particleShaderGeo.getAttribute("positionStart"),a=this.particleShaderGeo.getAttribute("startTime"),s=this.particleShaderGeo.getAttribute("velocity"),l=this.particleShaderGeo.getAttribute("turbulence"),u=this.particleShaderGeo.getAttribute("color"),c=this.particleShaderGeo.getAttribute("size"),h=this.particleShaderGeo.getAttribute("lifeTime");r=void 0!==(e=e||{}).position?r.copy(e.position):r.set(0,0,0),n=void 0!==e.velocity?n.copy(e.velocity):n.set(0,0,0),i=void 0!==e.color?i.set(e.color):i.set(16777215);var p=void 0!==e.positionRandomness?e.positionRandomness:0,f=void 0!==e.velocityRandomness?e.velocityRandomness:0,d=void 0!==e.colorRandomness?e.colorRandomness:1,m=void 0!==e.turbulence?e.turbulence:1,v=void 0!==e.lifetime?e.lifetime:5,g=void 0!==e.size?e.size:10,y=void 0!==e.sizeRandomness?e.sizeRandomness:0,b=void 0!==e.smoothPosition&&e.smoothPosition;void 0!==this.DPR&&(g*=this.DPR);var x=this.PARTICLE_CURSOR;o.array[3*x+0]=r.x+t.random()*p,o.array[3*x+1]=r.y+t.random()*p,o.array[3*x+2]=r.z+t.random()*p,!0===b&&(o.array[3*x+0]+=-n.x*t.random(),o.array[3*x+1]+=-n.y*t.random(),o.array[3*x+2]+=-n.z*t.random());var w=n.x+t.random()*f,S=n.y+t.random()*f,M=n.z+t.random()*f;w=_Math.clamp((w- -2)/4,0,1),S=_Math.clamp((S- -2)/4,0,1),M=_Math.clamp((M- -2)/4,0,1),s.array[3*x+0]=w,s.array[3*x+1]=S,s.array[3*x+2]=M,i.r=_Math.clamp(i.r+t.random()*d,0,1),i.g=_Math.clamp(i.g+t.random()*d,0,1),i.b=_Math.clamp(i.b+t.random()*d,0,1),u.array[3*x+0]=i.r,u.array[3*x+1]=i.g,u.array[3*x+2]=i.b,l.array[x]=m,c.array[x]=g+t.random()*y,h.array[x]=v,a.array[x]=this.time+.02*t.random(),0===this.offset&&(this.offset=this.PARTICLE_CURSOR),this.count++,this.PARTICLE_CURSOR++,this.PARTICLE_CURSOR>=this.PARTICLE_COUNT&&(this.PARTICLE_CURSOR=0),this.particleUpdate=!0},this.init=function(){this.particleSystem=new Points(this.particleShaderGeo,this.particleShaderMat),this.particleSystem.frustumCulled=!1,this.add(this.particleSystem)},this.update=function(e){this.time=e,this.particleShaderMat.uniforms.uTime.value=e,this.geometryUpdate()},this.geometryUpdate=function(){if(!0===this.particleUpdate){this.particleUpdate=!1;var e=this.particleShaderGeo.getAttribute("positionStart"),t=this.particleShaderGeo.getAttribute("startTime"),r=this.particleShaderGeo.getAttribute("velocity"),n=this.particleShaderGeo.getAttribute("turbulence"),i=this.particleShaderGeo.getAttribute("color"),o=this.particleShaderGeo.getAttribute("size"),a=this.particleShaderGeo.getAttribute("lifeTime");this.offset+this.count<this.PARTICLE_COUNT?(e.updateRange.offset=this.offset*e.itemSize,t.updateRange.offset=this.offset*t.itemSize,r.updateRange.offset=this.offset*r.itemSize,n.updateRange.offset=this.offset*n.itemSize,i.updateRange.offset=this.offset*i.itemSize,o.updateRange.offset=this.offset*o.itemSize,a.updateRange.offset=this.offset*a.itemSize,e.updateRange.count=this.count*e.itemSize,t.updateRange.count=this.count*t.itemSize,r.updateRange.count=this.count*r.itemSize,n.updateRange.count=this.count*n.itemSize,i.updateRange.count=this.count*i.itemSize,o.updateRange.count=this.count*o.itemSize,a.updateRange.count=this.count*a.itemSize):(e.updateRange.offset=0,t.updateRange.offset=0,r.updateRange.offset=0,n.updateRange.offset=0,i.updateRange.offset=0,o.updateRange.offset=0,a.updateRange.offset=0,e.updateRange.count=-1,t.updateRange.count=-1,r.updateRange.count=-1,n.updateRange.count=-1,i.updateRange.count=-1,o.updateRange.count=-1,a.updateRange.count=-1),e.needsUpdate=!0,t.needsUpdate=!0,r.needsUpdate=!0,n.needsUpdate=!0,i.needsUpdate=!0,o.needsUpdate=!0,a.needsUpdate=!0,this.offset=0,this.count=0}},this.dispose=function(){this.particleShaderGeo.dispose()},this.init()};GPUParticleContainer.prototype=Object.create(Object3D.prototype),GPUParticleContainer.prototype.constructor=GPUParticleContainer;var Gyroscope=function(){Object3D.call(this)};Gyroscope.prototype=Object.create(Object3D.prototype),Gyroscope.prototype.constructor=Gyroscope,Gyroscope.prototype.updateMatrixWorld=function(){var e=new Vector3,t=new Quaternion,r=new Vector3,n=new Vector3,i=new Quaternion,o=new Vector3;return function(a){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||a)&&(null!==this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(n,i,o),this.matrix.decompose(e,t,r),this.matrixWorld.compose(n,t,o)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0);for(var s=0,l=this.children.length;s<l;s++)this.children[s].updateMatrixWorld(a)}}();var ImprovedNoise=function(){for(var e=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],t=0;t<256;t++)e[256+t]=e[t];function r(e){return e*e*e*(e*(6*e-15)+10)}function n(e,t,r){return t+e*(r-t)}function i(e,t,r,n){var i=15&e,o=i<8?t:r,a=i<4?r:12==i||14==i?t:n;return(0==(1&i)?o:-o)+(0==(2&i)?a:-a)}return{noise:function(t,o,a){var s=Math.floor(t),l=Math.floor(o),u=Math.floor(a),c=255&s,h=255&l,p=255&u,f=(t-=s)-1,d=(o-=l)-1,m=(a-=u)-1,v=r(t),g=r(o),y=r(a),b=e[c]+h,x=e[b]+p,w=e[b+1]+p,S=e[c+1]+h,M=e[S]+p,_=e[S+1]+p;return n(y,n(g,n(v,i(e[x],t,o,a),i(e[M],f,o,a)),n(v,i(e[w],t,d,a),i(e[_],f,d,a))),n(g,n(v,i(e[x+1],t,o,m),i(e[M+1],f,o,a-1)),n(v,i(e[w+1],t,d,m),i(e[_+1],f,d,m))))}}};function Frustum(e,t,r,n,i,o){this.planes=[void 0!==e?e:new Plane,void 0!==t?t:new Plane,void 0!==r?r:new Plane,void 0!==n?n:new Plane,void 0!==i?i:new Plane,void 0!==o?o:new Plane]}Object.assign(Frustum.prototype,{set:function(e,t,r,n,i,o){var a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(r),a[3].copy(n),a[4].copy(i),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,r=0;r<6;r++)t[r].copy(e.planes[r]);return this},setFromMatrix:function(e){var t=this.planes,r=e.elements,n=r[0],i=r[1],o=r[2],a=r[3],s=r[4],l=r[5],u=r[6],c=r[7],h=r[8],p=r[9],f=r[10],d=r[11],m=r[12],v=r[13],g=r[14],y=r[15];return t[0].setComponents(a-n,c-s,d-h,y-m).normalize(),t[1].setComponents(a+n,c+s,d+h,y+m).normalize(),t[2].setComponents(a+i,c+l,d+p,y+v).normalize(),t[3].setComponents(a-i,c-l,d-p,y-v).normalize(),t[4].setComponents(a-o,c-u,d-f,y-g).normalize(),t[5].setComponents(a+o,c+u,d+f,y+g).normalize(),this},intersectsObject:function(){var e=new Sphere;return function(t){var r=t.geometry;return null===r.boundingSphere&&r.computeBoundingSphere(),e.copy(r.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSprite:function(){var e=new Sphere;return function(t){return e.center.set(0,0,0),e.radius=.7071067811865476,e.applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSphere:function(e){for(var t=this.planes,r=e.center,n=-e.radius,i=0;i<6;i++){if(t[i].distanceToPoint(r)<n)return!1}return!0},intersectsBox:function(){var e=new Vector3;return function(t){for(var r=this.planes,n=0;n<6;n++){var i=r[n];if(e.x=i.normal.x>0?t.max.x:t.min.x,e.y=i.normal.y>0?t.max.y:t.min.y,e.z=i.normal.z>0?t.max.z:t.min.z,i.distanceToPoint(e)<0)return!1}return!0}}(),containsPoint:function(e){for(var t=this.planes,r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}});var SelectionBox=function(){var e=new Frustum,t=new Vector3;function r(e,t,r){this.camera=e,this.scene=t,this.startPoint=new Vector3,this.endPoint=new Vector3,this.collection=[],this.deep=r||Number.MAX_VALUE}return r.prototype.select=function(t,r){return this.startPoint=t||this.startPoint,this.endPoint=r||this.endPoint,this.collection=[],this.updateFrustum(this.startPoint,this.endPoint),this.searchChildInFrustum(e,this.scene),this.collection},r.prototype.updateFrustum=function(t,r){t=t||this.startPoint,r=r||this.endPoint,this.camera.updateProjectionMatrix(),this.camera.updateMatrixWorld();var n=t.clone();n.x=Math.min(t.x,r.x),n.y=Math.max(t.y,r.y),r.x=Math.max(t.x,r.x),r.y=Math.min(t.y,r.y);var i=this.camera.position.clone(),o=n.clone(),a=new Vector3(r.x,n.y,0),s=r.clone(),l=new Vector3(n.x,r.y,0);o.unproject(this.camera),a.unproject(this.camera),s.unproject(this.camera),l.unproject(this.camera);var u=o.clone().sub(i),c=a.clone().sub(i),h=s.clone().sub(i);u.normalize(),c.normalize(),h.normalize(),u.multiplyScalar(this.deep),c.multiplyScalar(this.deep),h.multiplyScalar(this.deep),u.add(i),c.add(i),h.add(i);var p=e.planes;p[0].setFromCoplanarPoints(i,o,a),p[1].setFromCoplanarPoints(i,a,s),p[2].setFromCoplanarPoints(s,l,i),p[3].setFromCoplanarPoints(l,o,i),p[4].setFromCoplanarPoints(a,s,l),p[5].setFromCoplanarPoints(h,c,u),p[5].normal.multiplyScalar(-1)},r.prototype.searchChildInFrustum=function(e,r){if(r.isMesh&&void 0!==r.material&&(r.geometry.computeBoundingSphere(),t.copy(r.geometry.boundingSphere.center),t.applyMatrix4(r.matrixWorld),e.containsPoint(t)&&this.collection.push(r)),r.children.length>0)for(var n=0;n<r.children.length;n++)this.searchChildInFrustum(e,r.children[n])},r}(),SelectionHelper=function(){function e(e,t,r){this.element=document.createElement("div"),this.element.classList.add(r),this.element.style.pointerEvents="none",this.renderer=t,this.startPoint={x:0,y:0},this.pointTopLeft={x:0,y:0},this.pointBottomRight={x:0,y:0},this.isDown=!1,this.renderer.domElement.addEventListener("mousedown",function(e){this.isDown=!0,this.onSelectStart(e)}.bind(this),!1),this.renderer.domElement.addEventListener("mousemove",function(e){this.isDown&&this.onSelectMove(e)}.bind(this),!1),this.renderer.domElement.addEventListener("mouseup",function(e){this.isDown=!1,this.onSelectOver(e)}.bind(this),!1)}return e.prototype.onSelectStart=function(e){this.renderer.domElement.parentElement.appendChild(this.element),this.element.style.left=e.clientX+"px",this.element.style.top=e.clientY+"px",this.element.style.width="0px",this.element.style.height="0px",this.startPoint.x=e.clientX,this.startPoint.y=e.clientY},e.prototype.onSelectMove=function(e){this.pointBottomRight.x=Math.max(this.startPoint.x,e.clientX),this.pointBottomRight.y=Math.max(this.startPoint.y,e.clientY),this.pointTopLeft.x=Math.min(this.startPoint.x,e.clientX),this.pointTopLeft.y=Math.min(this.startPoint.y,e.clientY),this.element.style.left=this.pointTopLeft.x+"px",this.element.style.top=this.pointTopLeft.y+"px",this.element.style.width=this.pointBottomRight.x-this.pointTopLeft.x+"px",this.element.style.height=this.pointBottomRight.y-this.pointTopLeft.y+"px"},e.prototype.onSelectOver=function(){this.element.parentElement.removeChild(this.element)},e}();function InstancedBufferGeometry(){BufferGeometry.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function InterleavedBuffer(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function InstancedInterleavedBuffer(e,t,r){InterleavedBuffer.call(this,e,t),this.meshPerAttribute=r||1}function InterleavedBufferAttribute(e,t,r,n){this.data=e,this.itemSize=t,this.offset=r,this.normalized=!0===n}function WireframeGeometry(e){BufferGeometry.call(this),this.type="WireframeGeometry";var t,r,n,i,o,a,s,l,u,c,h=[],p=[0,0],f={},d=["a","b","c"];if(e&&e.isGeometry){var m=e.faces;for(t=0,n=m.length;t<n;t++){var v=m[t];for(r=0;r<3;r++)s=v[d[r]],l=v[d[(r+1)%3]],p[0]=Math.min(s,l),p[1]=Math.max(s,l),void 0===f[u=p[0]+","+p[1]]&&(f[u]={index1:p[0],index2:p[1]})}for(u in f)a=f[u],c=e.vertices[a.index1],h.push(c.x,c.y,c.z),c=e.vertices[a.index2],h.push(c.x,c.y,c.z)}else if(e&&e.isBufferGeometry){var g,y,b,x,w,S,M;if(c=new Vector3,null!==e.index){for(g=e.attributes.position,y=e.index,0===(b=e.groups).length&&(b=[{start:0,count:y.count,materialIndex:0}]),i=0,o=b.length;i<o;++i)for(t=w=(x=b[i]).start,n=w+x.count;t<n;t+=3)for(r=0;r<3;r++)s=y.getX(t+r),l=y.getX(t+(r+1)%3),p[0]=Math.min(s,l),p[1]=Math.max(s,l),void 0===f[u=p[0]+","+p[1]]&&(f[u]={index1:p[0],index2:p[1]});for(u in f)a=f[u],c.fromBufferAttribute(g,a.index1),h.push(c.x,c.y,c.z),c.fromBufferAttribute(g,a.index2),h.push(c.x,c.y,c.z)}else for(t=0,n=(g=e.attributes.position).count/3;t<n;t++)for(r=0;r<3;r++)S=3*t+r,c.fromBufferAttribute(g,S),h.push(c.x,c.y,c.z),M=3*t+(r+1)%3,c.fromBufferAttribute(g,M),h.push(c.x,c.y,c.z)}this.addAttribute("position",new Float32BufferAttribute(h,3))}InstancedBufferGeometry.prototype=Object.assign(Object.create(BufferGeometry.prototype),{constructor:InstancedBufferGeometry,isInstancedBufferGeometry:!0,copy:function(e){return BufferGeometry.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)}}),Object.defineProperty(InterleavedBuffer.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(InterleavedBuffer.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("BufferAttribute: array should be a Typed Array.");return this.count=void 0!==e?e.length/this.stride:0,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function(e,t,r){e*=this.stride,r*=t.stride;for(var n=0,i=this.stride;n<i;n++)this.array[e+n]=t.array[r+n];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}}),InstancedInterleavedBuffer.prototype=Object.assign(Object.create(InterleavedBuffer.prototype),{constructor:InstancedInterleavedBuffer,isInstancedInterleavedBuffer:!0,copy:function(e){return InterleavedBuffer.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.defineProperties(InterleavedBufferAttribute.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(InterleavedBufferAttribute.prototype,{isInterleavedBufferAttribute:!0,setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this},setXYZ:function(e,t,r,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this},setXYZW:function(e,t,r,n,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this.data.array[e+3]=i,this}}),WireframeGeometry.prototype=Object.create(BufferGeometry.prototype),WireframeGeometry.prototype.constructor=WireframeGeometry;var LineSegmentsGeometry=function(){InstancedBufferGeometry.call(this),this.type="LineSegmentsGeometry";new BufferGeometry;this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.addAttribute("position",new Float32BufferAttribute([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.addAttribute("uv",new Float32BufferAttribute([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2))};LineSegmentsGeometry.prototype=Object.assign(Object.create(InstancedBufferGeometry.prototype),{constructor:LineSegmentsGeometry,isLineSegmentsGeometry:!0,applyMatrix:function(e){var t=this.attributes.instanceStart,r=this.attributes.instanceEnd;return void 0!==t&&(e.applyToBufferAttribute(t),e.applyToBufferAttribute(r),t.data.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},setPositions:function(e){var t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));var r=new InstancedInterleavedBuffer(t,6,1);return this.addAttribute("instanceStart",new InterleavedBufferAttribute(r,3,0)),this.addAttribute("instanceEnd",new InterleavedBufferAttribute(r,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this},setColors:function(e){var t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));var r=new InstancedInterleavedBuffer(t,6,1);return this.addAttribute("instanceColorStart",new InterleavedBufferAttribute(r,3,0)),this.addAttribute("instanceColorEnd",new InterleavedBufferAttribute(r,3,3)),this},fromWireframeGeometry:function(e){return this.setPositions(e.attributes.position.array),this},fromEdgesGeometry:function(e){return this.setPositions(e.attributes.position.array),this},fromMesh:function(e){return this.fromWireframeGeometry(new WireframeGeometry(e.geometry)),this},fromLineSegements:function(e){var t=e.geometry;return t.isGeometry?this.setPositions(t.vertices):t.isBufferGeometry&&this.setPositions(t.position.array),this},computeBoundingBox:function(){var e=new Box3;return function(){null===this.boundingBox&&(this.boundingBox=new Box3);var t=this.attributes.instanceStart,r=this.attributes.instanceEnd;void 0!==t&&void 0!==r&&(this.boundingBox.setFromBufferAttribute(t),e.setFromBufferAttribute(r),this.boundingBox.union(e))}}(),computeBoundingSphere:function(){var e=new Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new Sphere),null===this.boundingBox&&this.computeBoundingBox();var t=this.attributes.instanceStart,r=this.attributes.instanceEnd;if(void 0!==t&&void 0!==r){var n=this.boundingSphere.center;this.boundingBox.getCenter(n);for(var i=0,o=0,a=t.count;o<a;o++)e.fromBufferAttribute(t,o),i=Math.max(i,n.distanceToSquared(e)),e.fromBufferAttribute(r,o),i=Math.max(i,n.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error("LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}}(),toJSON:function(){},clone:function(){},copy:function(e){return this}}),UniformsLib.line={linewidth:{value:1},resolution:{value:new Vector2(1,1)},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}},ShaderLib.line={uniforms:UniformsUtils.merge([UniformsLib.common,UniformsLib.fog,UniformsLib.line]),vertexShader:"\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\tvarying vec2 vUv;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\tvUv = uv;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec2 ndcStart = clipStart.xy / clipStart.w;\n\t\t\tvec2 ndcEnd = clipEnd.xy / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd - ndcStart;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t// perpendicular to dir\n\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\n\t\t\t// undo aspect ratio adjustment\n\t\t\tdir.x /= aspect;\n\t\t\toffset.x /= aspect;\n\n\t\t\t// sign flip\n\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t// endcaps\n\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\toffset += - dir;\n\n\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\toffset += dir;\n\n\t\t\t}\n\n\t\t\t// adjust for linewidth\n\t\t\toffset *= linewidth;\n\n\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\toffset /= resolution.y;\n\n\t\t\t// select end\n\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t// back to clip space\n\t\t\toffset *= clip.w;\n\n\t\t\tclip.xy += offset;\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashSize;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\tfloat a = vUv.x;\n\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t}\n\n\t\t\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, diffuseColor.a );\n\n\t\t\t#include <premultiplied_alpha_fragment>\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <encodings_fragment>\n\t\t\t#include <fog_fragment>\n\n\t\t}\n\t\t"};var LineMaterial=function(e){ShaderMaterial.call(this,{type:"LineMaterial",uniforms:UniformsUtils.clone(ShaderLib.line.uniforms),vertexShader:ShaderLib.line.vertexShader,fragmentShader:ShaderLib.line.fragmentShader}),this.dashed=!1,Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(e){this.uniforms.diffuse.value=e}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(e){this.uniforms.linewidth.value=e}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(e){this.uniforms.dashScale.value=e}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(e){this.uniforms.dashSize.value=e}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(e){this.uniforms.gapSize.value=e}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(e){this.uniforms.resolution.value.copy(e)}}}),this.setValues(e)};LineMaterial.prototype=Object.create(ShaderMaterial.prototype),LineMaterial.prototype.constructor=LineMaterial,LineMaterial.prototype.isLineMaterial=!0,LineMaterial.prototype.copy=function(e){return ShaderMaterial.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.resolution=e.resolution,this};var LineSegments2=function(e,t){Mesh.call(this),this.type="LineSegments2",this.geometry=void 0!==e?e:new LineSegmentsGeometry,this.material=void 0!==t?t:new LineMaterial({color:16777215*Math.random()})};LineSegments2.prototype=Object.assign(Object.create(Mesh.prototype),{constructor:LineSegments2,isLineSegments2:!0,computeLineDistances:function(){var e=new Vector3,t=new Vector3;return function(){for(var r=this.geometry,n=r.attributes.instanceStart,i=r.attributes.instanceEnd,o=new Float32Array(2*n.data.count),a=0,s=0,l=n.data.count;a<l;a++,s+=2)e.fromBufferAttribute(n,a),t.fromBufferAttribute(i,a),o[s]=0===s?0:o[s-1],o[s+1]=o[s]+e.distanceTo(t);var u=new InstancedInterleavedBuffer(o,2,1);return r.addAttribute("instanceDistanceStart",new InterleavedBufferAttribute(u,1,0)),r.addAttribute("instanceDistanceEnd",new InterleavedBufferAttribute(u,1,1)),this}}(),copy:function(e){return this}});var LineGeometry=function(){LineSegmentsGeometry.call(this),this.type="LineGeometry"};LineGeometry.prototype=Object.assign(Object.create(LineSegmentsGeometry.prototype),{constructor:LineGeometry,isLineGeometry:!0,setPositions:function(e){for(var t=e.length-3,r=new Float32Array(2*t),n=0;n<t;n+=3)r[2*n]=e[n],r[2*n+1]=e[n+1],r[2*n+2]=e[n+2],r[2*n+3]=e[n+3],r[2*n+4]=e[n+4],r[2*n+5]=e[n+5];return LineSegmentsGeometry.prototype.setPositions.call(this,r),this},setColors:function(e){for(var t=e.length-3,r=new Float32Array(2*t),n=0;n<t;n+=3)r[2*n]=e[n],r[2*n+1]=e[n+1],r[2*n+2]=e[n+2],r[2*n+3]=e[n+3],r[2*n+4]=e[n+4],r[2*n+5]=e[n+5];return LineSegmentsGeometry.prototype.setColors.call(this,r),this},fromLine:function(e){var t=e.geometry;return t.isGeometry?this.setPositions(t.vertices):t.isBufferGeometry&&this.setPositions(t.position.array),this},copy:function(e){return this}});var Line2=function(e,t){LineSegments2.call(this),this.type="Line2",this.geometry=void 0!==e?e:new LineGeometry,this.material=void 0!==t?t:new LineMaterial({color:16777215*Math.random()})};Line2.prototype=Object.assign(Object.create(LineSegments2.prototype),{constructor:Line2,isLine2:!0,copy:function(e){return this}});var Wireframe=function(e,t){Mesh.call(this),this.type="Wireframe",this.geometry=void 0!==e?e:new LineSegmentsGeometry,this.material=void 0!==t?t:new LineMaterial({color:16777215*Math.random()})};Wireframe.prototype=Object.assign(Object.create(Mesh.prototype),{constructor:Wireframe,isWireframe:!0,computeLineDistances:function(){var e=new Vector3,t=new Vector3;return function(){for(var r=this.geometry,n=r.attributes.instanceStart,i=r.attributes.instanceEnd,o=new Float32Array(2*n.data.count),a=0,s=0,l=n.data.count;a<l;a++,s+=2)e.fromBufferAttribute(n,a),t.fromBufferAttribute(i,a),o[s]=0===s?0:o[s-1],o[s+1]=o[s]+e.distanceTo(t);var u=new InstancedInterleavedBuffer(o,2,1);return r.addAttribute("instanceDistanceStart",new InterleavedBufferAttribute(u,1,0)),r.addAttribute("instanceDistanceEnd",new InterleavedBufferAttribute(u,1,1)),this}}(),copy:function(e){return this}});var WireframeGeometry2=function(e){LineSegmentsGeometry.call(this),this.type="WireframeGeometry2",this.fromWireframeGeometry(new WireframeGeometry(e))};WireframeGeometry2.prototype=Object.assign(Object.create(LineSegmentsGeometry.prototype),{constructor:WireframeGeometry2,isWireframeGeometry2:!0,copy:function(e){return this}});var loading={};function FileLoader(e){this.manager=void 0!==e?e:DefaultLoadingManager}function MeshPhongMaterial(e){Material$1.call(this),this.type="MeshPhongMaterial",this.color=new Color(16777215),this.specular=new Color(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}Object.assign(FileLoader.prototype,{load:function(e,t,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=Cache.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout(function(){t&&t(o),i.manager.itemEnd(e)},0),o;if(void 0===loading[e]){var a=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(a){var s=a[1],l=!!a[2],u=a[3];u=decodeURIComponent(u),l&&(u=atob(u));try{var c,h=(this.responseType||"").toLowerCase();switch(h){case"arraybuffer":case"blob":for(var p=new Uint8Array(u.length),f=0;f<u.length;f++)p[f]=u.charCodeAt(f);c="blob"===h?new Blob([p.buffer],{type:s}):p.buffer;break;case"document":var d=new DOMParser;c=d.parseFromString(u,s);break;case"json":c=JSON.parse(u);break;default:c=u}setTimeout(function(){t&&t(c),i.manager.itemEnd(e)},0)}catch(g){setTimeout(function(){n&&n(g),i.manager.itemError(e),i.manager.itemEnd(e)},0)}}else{loading[e]=[],loading[e].push({onLoad:t,onProgress:r,onError:n});var m=new XMLHttpRequest;for(var v in m.open("GET",e,!0),m.addEventListener("load",function(t){var r=this.response;Cache.add(e,r);var n=loading[e];if(delete loading[e],200===this.status||0===this.status){0===this.status&&console.warn("FileLoader: HTTP Status 0 received.");for(var o=0,a=n.length;o<a;o++){(s=n[o]).onLoad&&s.onLoad(r)}i.manager.itemEnd(e)}else{for(o=0,a=n.length;o<a;o++){var s;(s=n[o]).onError&&s.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}},!1),m.addEventListener("progress",function(t){for(var r=loading[e],n=0,i=r.length;n<i;n++){var o=r[n];o.onProgress&&o.onProgress(t)}},!1),m.addEventListener("error",function(t){var r=loading[e];delete loading[e];for(var n=0,o=r.length;n<o;n++){var a=r[n];a.onError&&a.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)},!1),m.addEventListener("abort",function(t){var r=loading[e];delete loading[e];for(var n=0,o=r.length;n<o;n++){var a=r[n];a.onError&&a.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)},!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(v,this.requestHeader[v]);m.send(null)}return i.manager.itemStart(e),m}loading[e].push({onLoad:t,onProgress:r,onError:n})},setPath:function(e){return this.path=e,this},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),MeshPhongMaterial.prototype=Object.create(Material$1.prototype),MeshPhongMaterial.prototype.constructor=MeshPhongMaterial,MeshPhongMaterial.prototype.isMeshPhongMaterial=!0,MeshPhongMaterial.prototype.copy=function(e){return Material$1.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};var LoaderUtils={decodeText:function(e){if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",r=0,n=e.length;r<n;r++)t+=String.fromCharCode(e[r]);return decodeURIComponent(escape(t))},extractUrlBase:function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}},ThreeMFLoader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager,this.availableExtensions=[]};ThreeMFLoader.prototype={constructor:ThreeMFLoader,load:function(e,t,r,n){var i=this,o=new FileLoader(i.manager);o.setPath(i.path),o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){var t=this;function r(e){var t={type:e.getAttribute("type")},r=e.getAttribute("id");r&&(t.id=r);var n=e.getAttribute("pid");n&&(t.pid=n);var i=e.getAttribute("pindex");i&&(t.pindex=i);var o=e.getAttribute("thumbnail");o&&(t.thumbnail=o);var a=e.getAttribute("partnumber");a&&(t.partnumber=a);var s=e.getAttribute("name");s&&(t.name=s);var l=e.querySelector("mesh");l&&(t.mesh=function(e,t){for(var r={},n=[],i=e.querySelectorAll("vertices vertex"),o=0;o<i.length;o++){var a=i[o],s=a.getAttribute("x"),l=a.getAttribute("y"),u=a.getAttribute("z");n.push(parseFloat(s),parseFloat(l),parseFloat(u))}for(r.vertices=new Float32Array(n.length),o=0;o<n.length;o++)r.vertices[o]=n[o];var c=[],h=[],p=e.querySelectorAll("triangles triangle");for(o=0;o<p.length;o++){var f=p[o],d=f.getAttribute("v1"),m=f.getAttribute("v2"),v=f.getAttribute("v3"),g=f.getAttribute("p1"),y=f.getAttribute("p2"),b=f.getAttribute("p3"),x=f.getAttribute("pid");h.push(parseInt(d,10),parseInt(m,10),parseInt(v,10));var w={};g&&(w.p1=parseInt(g,10)),y&&(w.p2=parseInt(y,10)),b&&(w.p3=parseInt(b,10)),x&&(w.pid=x),0<Object.keys(w).length&&c.push(w)}for(r.triangleProperties=c,r.triangles=new Uint32Array(h.length),o=0;o<h.length;o++)r.triangles[o]=h[o];return r}(l));var u=e.querySelector("components");return u&&(t.components=void 0),t}function n(e){var t={unit:e.getAttribute("unit")||"millimeter"},n=e.querySelectorAll("metadata");n&&(t.metadata=function(e){for(var t={},r=0;r<e.length;r++){var n=e[r],i=n.getAttribute("name");0<=["Title","Designer","Description","Copyright","LicenseTerms","Rating","CreationDate","ModificationDate"].indexOf(i)&&(t[i]=n.textContent)}return t}(n));var i=e.querySelector("resources");i&&(t.resources=function(e){var t={},n=e.querySelector("basematerials");n&&(t.basematerial=void 0),t.object={};for(var i=e.querySelectorAll("object"),o=0;o<i.length;o++){var a=r(i[o]);t.object[a.id]=a}return t}(i));var o=e.querySelector("build");return o&&(t.build=function(e){for(var t=[],r=e.querySelectorAll("item"),n=0;n<r.length;n++){var i=r[n],o={objectid:i.getAttribute("objectid")},a=i.getAttribute("transform");if(a){var s=[];a.split(" ").forEach(function(e){s.push(parseFloat(e))});var l=new Matrix4;o.transform=l.set(s[0],s[3],s[6],s[9],s[1],s[4],s[7],s[10],s[2],s[5],s[8],s[11],0,0,0,1)}t.push(o)}return t}(o)),t}function i(e,t){var r=new BufferGeometry;r.setIndex(new BufferAttribute(e.triangles,1)),r.addAttribute("position",new BufferAttribute(e.vertices,3)),e.colors&&r.addAttribute("color",new BufferAttribute(e.colors,3)),r.computeBoundingSphere();var n={flatShading:!0};return e.colors&&0<e.colors.length?n.vertexColors=VertexColors:n.color=11184895,new Mesh(r,new MeshPhongMaterial(n))}function o(e,r,n,i){if(e){for(var o=[],a=Object.keys(e),s=0;s<a.length;s++)for(var l=a[s],u=0;u<t.availableExtensions.length;u++){(c=t.availableExtensions[u]).ns===l&&o.push(c)}for(s=0;s<o.length;s++){var c;(c=o[s]).apply(n,e[c.ns],r)}}}var a=function(e){var t,r,i=null,o=null,a=[],s=[],l={},u={};try{i=new JSZip(e)}catch(w){if(w instanceof ReferenceError)return console.error("ThreeMFLoader: jszip missing and file is compressed."),null}for(o in i.files)o.match(/\.rels$/)?t=o:o.match(/^3D\/.*\.model$/)?a.push(o):o.match(/^3D\/Metadata\/.*\.xml$/)||(o.match(/^3D\/Textures\/.*/)?s.push(o):o.match(/^3D\/Other\/.*/));var c=new Uint8Array(i.file(t).asArrayBuffer());r=function(e){var t=(new DOMParser).parseFromString(e,"application/xml").querySelector("Relationship"),r=t.getAttribute("Target"),n=t.getAttribute("Id"),i=t.getAttribute("Type");return{target:r,id:n,type:i}}(LoaderUtils.decodeText(c));for(var h=0;h<a.length;h++){var p=a[h],f=new Uint8Array(i.file(p).asArrayBuffer()),d=LoaderUtils.decodeText(f),m=(new DOMParser).parseFromString(d,"application/xml");"model"!==m.documentElement.nodeName.toLowerCase()&&console.error("ThreeMFLoader: Error loading 3MF - no 3MF document found: ",p);var v=m.querySelector("model"),g={};for(h=0;h<v.attributes.length;h++){var y=v.attributes[h];y.name.match(/^xmlns:(.+)$/)&&(g[y.value]=RegExp.$1)}var b=n(v);b.xml=v,0<Object.keys(g).length&&(b.extensions=g),l[p]=b}for(h=0;h<s.length;h++){var x=s[h];u[x]=i.file(x).asBinary()}return{rels:r,model:l,printTicket:{},texture:u,other:{}}}(e);return function(e,t,r){for(var n=new Group,i=r.model[t.target.substring(1)].build,o=0;o<i.length;o++){var a=i[o],s=e[a.objectid];a.transform&&s.geometry.applyMatrix(a.transform),n.add(s)}return n}(function(e){for(var t=e.model,r={},n=Object.keys(t),a=0;a<n.length;a++)for(var s=t[n[a]],l=s.xml,u=s.extensions,c=Object.keys(s.resources.object),h=0;h<c.length;h++){var p=c[h],f=s.resources.object[p].mesh;o(u,f,l),r[p]=i(f)}return r}(a),a.rels,a)},addExtension:function(e){this.availableExtensions.push(e)}};var AMFLoader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager};AMFLoader.prototype={constructor:AMFLoader,load:function(e,t,r,n){var i=this,o=new FileLoader(i.manager);o.setPath(i.path),o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){function t(e){for(var t="AMF Material",n=e.attributes.id.textContent,i={r:1,g:1,b:1,a:1},o=null,a=0;a<e.childNodes.length;a++){var s=e.childNodes[a];"metadata"===s.nodeName&&void 0!==s.attributes.type?"name"===s.attributes.type.value&&(t=s.textContent):"color"===s.nodeName&&(i=r(s))}return o=new MeshPhongMaterial({flatShading:!0,color:new Color(i.r,i.g,i.b),name:t}),1!==i.a&&(o.transparent=!0,o.opacity=i.a),{id:n,material:o}}function r(e){for(var t={r:1,g:1,b:1,a:1},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];"r"===n.nodeName?t.r=n.textContent:"g"===n.nodeName?t.g=n.textContent:"b"===n.nodeName?t.b=n.textContent:"a"===n.nodeName&&(t.a=n.textContent)}return t}function n(e){var t={name:"",triangles:[],materialid:null},r=e.firstElementChild;for(void 0!==e.attributes.materialid&&(t.materialId=e.attributes.materialid.nodeValue);r;){if("metadata"===r.nodeName)void 0!==r.attributes.type&&"name"===r.attributes.type.value&&(t.name=r.textContent);else if("triangle"===r.nodeName){var n=r.getElementsByTagName("v1")[0].textContent,i=r.getElementsByTagName("v2")[0].textContent,o=r.getElementsByTagName("v3")[0].textContent;t.triangles.push(n,i,o)}r=r.nextElementSibling}return t}function i(e){for(var t=[],r=[],n=e.firstElementChild;n;){if("vertex"===n.nodeName)for(var i=n.firstElementChild;i;){if("coordinates"===i.nodeName){var o=i.getElementsByTagName("x")[0].textContent,a=i.getElementsByTagName("y")[0].textContent,s=i.getElementsByTagName("z")[0].textContent;t.push(o,a,s)}else if("normal"===i.nodeName){var l=i.getElementsByTagName("nx")[0].textContent,u=i.getElementsByTagName("ny")[0].textContent,c=i.getElementsByTagName("nz")[0].textContent;r.push(l,u,c)}i=i.nextElementSibling}n=n.nextElementSibling}return{vertices:t,normals:r}}function o(e){for(var t=e.attributes.id.textContent,o={name:"amfobject",meshes:[]},a=null,s=e.firstElementChild;s;){if("metadata"===s.nodeName)void 0!==s.attributes.type&&"name"===s.attributes.type.value&&(o.name=s.textContent);else if("color"===s.nodeName)a=r(s);else if("mesh"===s.nodeName){for(var l=s.firstElementChild,u={vertices:[],normals:[],volumes:[],color:a};l;){if("vertices"===l.nodeName){var c=i(l);u.normals=u.normals.concat(c.normals),u.vertices=u.vertices.concat(c.vertices)}else"volume"===l.nodeName&&u.volumes.push(n(l));l=l.nextElementSibling}o.meshes.push(u)}s=s.nextElementSibling}return{id:t,obj:o}}var a,s,l=function(e){var t=new DataView(e);if("PK"===String.fromCharCode(t.getUint8(0),t.getUint8(1))){var r=null,n=null;console.log("AMFLoader: Loading Zip");try{r=new JSZip(e)}catch(a){if(a instanceof ReferenceError)return console.log("AMFLoader: jszip missing and file is compressed."),null}for(n in r.files)if(".amf"===n.toLowerCase().substr(-4))break;console.log("AMFLoader: Trying to load file asset: "+n),t=new DataView(r.file(n).asArrayBuffer())}var i=LoaderUtils.decodeText(t),o=(new DOMParser).parseFromString(i,"application/xml");return"amf"!==o.documentElement.nodeName.toLowerCase()?(console.log("AMFLoader: Error loading AMF - no AMF document found."),null):o}(e),u="",c="",h=function(e){var t=1,r="millimeter";void 0!==e.documentElement.attributes.unit&&(r=e.documentElement.attributes.unit.value.toLowerCase());var n={millimeter:1,inch:25.4,feet:304.8,meter:1e3,micron:.001};return void 0!==n[r]&&(t=n[r]),console.log("AMFLoader: Unit scale: "+t),t}(l),p={},f={},d=l.documentElement.childNodes;for(a=0;a<d.length;a++){var m=d[a];if("metadata"===m.nodeName)void 0!==m.attributes.type&&("name"===m.attributes.type.value?u=m.textContent:"author"===m.attributes.type.value&&(c=m.textContent));else if("material"===m.nodeName){var v=t(m);p[v.id]=v.material}else if("object"===m.nodeName){var g=o(m);f[g.id]=g.obj}}var y=new Group,b=new MeshPhongMaterial({color:11184895,flatShading:!0});for(var x in y.name=u,y.userData.author=c,y.userData.loader="AMF",f){var w=f[x],S=w.meshes,M=new Group;for(M.name=w.name||"",a=0;a<S.length;a++){var _=b,T=S[a],A=new Float32BufferAttribute(T.vertices,3),C=null;if(T.normals.length&&(C=new Float32BufferAttribute(T.normals,3)),T.color){var E=T.color;(_=b.clone()).color=new Color(E.r,E.g,E.b),1!==E.a&&(_.transparent=!0,_.opacity=E.a)}var L=T.volumes;for(s=0;s<L.length;s++){var N=L[s],P=new BufferGeometry,O=_;P.setIndex(N.triangles),P.addAttribute("position",A.clone()),C&&P.addAttribute("normal",C.clone()),void 0!==p[N.materialId]&&(O=p[N.materialId]),P.scale(h,h,h),M.add(new Mesh(P,O.clone()))}}y.add(M)}return y}};var AssimpJSONLoader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager};function Skeleton(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var r=0,n=this.bones.length;r<n;r++)this.boneInverses.push(new Matrix4)}}function SkinnedMesh(e,t){e&&e.isGeometry&&console.error("SkinnedMesh no longer supports Geometry. Use BufferGeometry instead."),Mesh.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Matrix4,this.bindMatrixInverse=new Matrix4}AssimpJSONLoader.prototype={constructor:AssimpJSONLoader,crossOrigin:"anonymous",load:function(e,t,r,n){var i=this,o=void 0===i.path?LoaderUtils.extractUrlBase(e):i.path,a=new FileLoader(this.manager);a.setPath(i.path),a.load(e,function(e){var r=JSON.parse(e),a=r.__metadata__;if("undefined"!==typeof a){if("assimp2json"!==a.format)return void n("AssimpJSONLoader: Not an assimp2json scene.");if(a.version<100&&a.version>=200)return void n("AssimpJSONLoader: Unsupported assimp2json file format version.")}t(i.parse(r,o))},r,n)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,t){function r(e,t){for(var r=new Array(e.length),n=0;n<e.length;++n)r[n]=t.call(this,e[n]);return r}var n=new TextureLoader(this.manager);n.setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);var i=r(e.meshes,function(e){var t,r,n,i=new BufferGeometry,o=[],a=e.vertices||[],s=e.normals||[],l=e.texturecoords||[],u=e.colors||[];for(l=l[0]||[],t=0,r=e.faces.length;t<r;t++)n=e.faces[t],o.push(n[0],n[1],n[2]);return i.setIndex(o),i.addAttribute("position",new Float32BufferAttribute(a,3)),s.length>0&&i.addAttribute("normal",new Float32BufferAttribute(s,3)),l.length>0&&i.addAttribute("uv",new Float32BufferAttribute(l,2)),u.length>0&&i.addAttribute("color",new Float32BufferAttribute(u,3)),i.computeBoundingSphere(),i}),o=r(e.materials,function(e){var t=new MeshPhongMaterial;for(var r in e.properties){var i=e.properties[r],o=i.key,a=i.value;switch(o){case"$tex.file":var s=i.semantic;if(1===s||2===s||4===s||5===s||6===s){var l;switch(s){case 1:l="map";break;case 2:l="specularMap";break;case 4:l="emissiveMap";break;case 5:l="bumpMap";break;case 6:l="normalMap"}var u=n.load(a);u.wrapS=u.wrapT=RepeatWrapping,t[l]=u}break;case"?mat.name":t.name=a;break;case"$clr.diffuse":t.color.fromArray(a);break;case"$clr.specular":t.specular.fromArray(a);break;case"$clr.emissive":t.emissive.fromArray(a);break;case"$mat.shininess":t.shininess=a;break;case"$mat.shadingm":t.flatShading=1===a;break;case"$mat.opacity":a<1&&(t.opacity=a,t.transparent=!0)}}return t});return function e(t,r,n,i){var o,a,s=new Object3D;for(s.name=r.name||"",s.matrix=(new Matrix4).fromArray(r.transformation).transpose(),s.matrix.decompose(s.position,s.quaternion,s.scale),o=0;r.meshes&&o<r.meshes.length;o++)a=r.meshes[o],s.add(new Mesh(n[a],i[t.meshes[a].materialindex]));for(o=0;r.children&&o<r.children.length;o++)s.add(e(t,r.children[o],n,i));return s}(e,e.rootnode,i,o)}},Object.assign(Skeleton.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var r=new Matrix4;this.bones[e]&&r.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(r)}},pose:function(){var e,t,r;for(t=0,r=this.bones.length;t<r;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,r=this.bones.length;t<r;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:function(){var e=new Matrix4,t=new Matrix4;return function(){for(var r=this.bones,n=this.boneInverses,i=this.boneMatrices,o=this.boneTexture,a=0,s=r.length;a<s;a++){var l=r[a]?r[a].matrixWorld:t;e.multiplyMatrices(l,n[a]),e.toArray(i,16*a)}void 0!==o&&(o.needsUpdate=!0)}}(),clone:function(){return new Skeleton(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t=0,r=this.bones.length;t<r;t++){var n=this.bones[t];if(n.name===e)return n}}}),SkinnedMesh.prototype=Object.assign(Object.create(Mesh.prototype),{constructor:SkinnedMesh,isSkinnedMesh:!0,bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new Vector4,t=this.geometry.attributes.skinWeight,r=0,n=t.count;r<n;r++){e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.w=t.getW(r);var i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){Mesh.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var AssimpLoader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager};AssimpLoader.prototype={constructor:AssimpLoader,crossOrigin:"anonymous",load:function(e,t,r,n){var i=this,o=void 0===i.path?LoaderUtils.extractUrlBase(e):i.path,a=new FileLoader(this.manager);a.setPath(i.path),a.setResponseType("arraybuffer"),a.load(e,function(e){t(i.parse(e,o))},r,n)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,t){var r=new TextureLoader(this.manager);r.setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);var n={KeyFrame:function(e,t){this.time=e,this.matrix=t.clone(),this.position=new Vector3,this.quaternion=new Quaternion,this.scale=new Vector3(1,1,1),this.matrix.decompose(this.position,this.quaternion,this.scale),this.clone=function(){return new n.KeyFrame(this.time,this.matrix)},this.lerp=function(e,t){var r=(t-=this.time)/(e.time-this.time),i=1-r,o=this.position,a=this.quaternion,s=e.position,l=e.quaternion;return n.KeyFrame.tempAniPos.x=o.x*i+s.x*r,n.KeyFrame.tempAniPos.y=o.y*i+s.y*r,n.KeyFrame.tempAniPos.z=o.z*i+s.z*r,n.KeyFrame.tempAniQuat.set(a.x,a.y,a.z,a.w),n.KeyFrame.tempAniQuat.slerp(l,r),n.KeyFrame.tempAniMatrix.compose(n.KeyFrame.tempAniPos,n.KeyFrame.tempAniQuat,n.KeyFrame.tempAniScale)}}};n.KeyFrame.tempAniPos=new Vector3,n.KeyFrame.tempAniQuat=new Quaternion,n.KeyFrame.tempAniScale=new Vector3(1,1,1),n.KeyFrame.tempAniMatrix=new Matrix4,n.KeyFrameTrack=function(){this.keys=[],this.target=null,this.time=0,this.length=0,this._accelTable={},this.fps=20,this.addKey=function(e){this.keys.push(e)},this.init=function(){if(this.sortKeys(),this.keys.length>0?this.length=this.keys[this.keys.length-1].time:this.length=0,this.fps)for(var e=0;e<this.length*this.fps;e++)for(var t=0;t<this.keys.length;t++){if(this.keys[t].time==e){this._accelTable[e]=t;break}if(this.keys[t].time<e/this.fps&&this.keys[t+1]&&this.keys[t+1].time>=e/this.fps){this._accelTable[e]=t;break}}},this.parseFromThree=function(e){var t=e.fps;this.target=e.node;for(var r=e.hierarchy[0].keys,i=0;i<r.length;i++)this.addKey(new n.KeyFrame(i/t||r[i].time,r[i].targets[0].data));this.init()},this.parseFromCollada=function(e){for(var t=e.keys,r=this.fps,i=0;i<t.length;i++)this.addKey(new n.KeyFrame(i/r||t[i].time,t[i].matrix));this.init()},this.sortKeys=function(){this.keys.sort(this.keySortFunc)},this.keySortFunc=function(e,t){return e.time-t.time},this.clone=function(){var e=new n.KeyFrameTrack;e.target=this.target,e.time=this.time,e.length=this.length;for(var t=0;t<this.keys.length;t++)e.addKey(this.keys[t].clone());return e.init(),e},this.reTarget=function(e,t){t||(t=n.TrackTargetNodeNameCompare),this.target=t(e,this.target)},this.keySearchAccel=function(e){return e*=this.fps,e=Math.floor(e),this._accelTable[e]||0},this.setTime=function(e){e=Math.abs(e),this.length&&(e=e%this.length+.05);for(var t=null,r=null,n=this.keySearchAccel(e);n<this.keys.length;n++){if(this.keys[n].time==e){t=this.keys[n],r=this.keys[n];break}if(this.keys[n].time<e&&this.keys[n+1]&&this.keys[n+1].time>e){t=this.keys[n],r=this.keys[n+1];break}if(this.keys[n].time<e&&n==this.keys.length-1){t=this.keys[n],(r=this.keys[0].clone()).time+=this.length+.05;break}}return t&&r&&t!==r?(this.target.matrixAutoUpdate=!1,this.target.matrix.copy(t.lerp(r,e)),void(this.target.matrixWorldNeedsUpdate=!0)):t&&r&&t==r?(this.target.matrixAutoUpdate=!1,this.target.matrix.copy(t.matrix),void(this.target.matrixWorldNeedsUpdate=!0)):void 0}},n.TrackTargetNodeNameCompare=function(e,t){return function e(t,r){if(t.name==r)return t;for(var n=0;n<t.children.length;n++){var i=e(t.children[n],r);if(i)return i}return null}(e,t.name)},n.Animation=function(){this.tracks=[],this.length=0,this.addTrack=function(e){this.tracks.push(e),this.length=Math.max(e.length,this.length)},this.setTime=function(e){this.time=e;for(var t=0;t<this.tracks.length;t++)this.tracks[t].setTime(e)},this.clone=function(e,t){t||(t=n.TrackTargetNodeNameCompare);var r=new n.Animation;r.target=e;for(var i=0;i<this.tracks.length;i++){var o=this.tracks[i].clone();o.reTarget(e,t),r.addTrack(o)}return r}};var i=4660,o=4661,a=4662,s=4663,l=4664,u=4665,c=4666,h=4667,p=4668,f=4669,d=4670,m=1,v=2,g=4,y=256,b=65536,x=1,w=4,S=1,M=3,_=1,T=6,A=8,C=10,E=4;function L(e){return y<<e}function N(e){return b<<e}function P(e,t){var r=new Bone;for(var n in r.matrix.copy(e.matrix),r.matrixWorld.copy(e.matrixWorld),r.position.copy(e.position),r.quaternion.copy(e.quaternion),r.scale.copy(e.scale),t.nodeCount++,r.name="bone_"+e.name+t.nodeCount.toString(),t.nodeToBoneMap[e.name]||(t.nodeToBoneMap[e.name]=[]),t.nodeToBoneMap[e.name].push(r),e.children){var i=P(e.children[n],t);i&&r.add(i)}return r}function O(e,t){for(var r=[],n=0;n<e.length;n++)r.push({i:e[n],w:t[n]});for(r.sort(function(e,t){return t.w-e.w});r.length<4;)r.push({i:0,w:0});r.length>4&&(r.length=4);var i=0;for(n=0;n<4;n++)i+=r[n].w*r[n].w;i=Math.sqrt(i);for(n=0;n<4;n++)r[n].w=r[n].w/i,e[n]=r[n].i,t[n]=r[n].w}function R(e,t){if(0==e.name.indexOf("bone_"+t))return e;for(var r in e.children){var n=R(e.children[r],t);if(n)return n}}function D(){this.mPrimitiveTypes=0,this.mNumVertices=0,this.mNumFaces=0,this.mNumBones=0,this.mMaterialIndex=0,this.mVertices=[],this.mNormals=[],this.mTangents=[],this.mBitangents=[],this.mColors=[[]],this.mTextureCoords=[[]],this.mFaces=[],this.mBones=[],this.hookupSkeletons=function(e,t){if(0!=this.mBones.length){for(var r=[],n=[],i=e.findNode(this.mBones[0].mName);i.mParent&&i.mParent.isBone;)i=i.mParent;var o=P(l=i.toTHREE(e),e);this.threeNode.add(o);for(var a=0;a<this.mBones.length;a++){if(u=R(o,this.mBones[a].mName)){var s=u;r.push(s),n.push(this.mBones[a].mOffsetMatrix.toTHREE())}else{if(!(i=e.findNode(this.mBones[a].mName)))return;var l;(l=i.toTHREE(e)).parent,o=P(l,e);this.threeNode.add(o);var u;s=u=R(o,this.mBones[a].mName);r.push(s),n.push(this.mBones[a].mOffsetMatrix.toTHREE())}}var c=new Skeleton(r,n);this.threeNode.bind(c,new Matrix4),this.threeNode.material.skinning=!0}},this.toTHREE=function(e){if(this.threeNode)return this.threeNode;var t,r,n=new BufferGeometry;if(t=e.mMaterials[this.mMaterialIndex]?e.mMaterials[this.mMaterialIndex].toTHREE(e):new MeshLambertMaterial,n.setIndex(new BufferAttribute(new Uint32Array(this.mIndexArray),1)),n.addAttribute("position",new BufferAttribute(this.mVertexBuffer,3)),this.mNormalBuffer&&this.mNormalBuffer.length>0&&n.addAttribute("normal",new BufferAttribute(this.mNormalBuffer,3)),this.mColorBuffer&&this.mColorBuffer.length>0&&n.addAttribute("color",new BufferAttribute(this.mColorBuffer,4)),this.mTexCoordsBuffers[0]&&this.mTexCoordsBuffers[0].length>0&&n.addAttribute("uv",new BufferAttribute(new Float32Array(this.mTexCoordsBuffers[0]),2)),this.mTexCoordsBuffers[1]&&this.mTexCoordsBuffers[1].length>0&&n.addAttribute("uv1",new BufferAttribute(new Float32Array(this.mTexCoordsBuffers[1]),2)),this.mTangentBuffer&&this.mTangentBuffer.length>0&&n.addAttribute("tangents",new BufferAttribute(this.mTangentBuffer,3)),this.mBitangentBuffer&&this.mBitangentBuffer.length>0&&n.addAttribute("bitangents",new BufferAttribute(this.mBitangentBuffer,3)),this.mBones.length>0){for(var i=[],o=[],a=0;a<this.mBones.length;a++)for(var s=0;s<this.mBones[a].mWeights.length;s++){var l=this.mBones[a].mWeights[s];l&&(i[l.mVertexId]||(i[l.mVertexId]=[]),o[l.mVertexId]||(o[l.mVertexId]=[]),i[l.mVertexId].push(l.mWeight),o[l.mVertexId].push(parseInt(a)))}for(var a in o)O(o[a],i[a]);var u=[],c=[];for(a=0;a<i.length;a++)for(s=0;s<4;s++)i[a]&&o[a]?(u.push(i[a][s]),c.push(o[a][s])):(u.push(0),c.push(0));n.addAttribute("skinWeight",new BufferAttribute(new Float32Array(u),E)),n.addAttribute("skinIndex",new BufferAttribute(new Float32Array(c),E))}return 0==this.mBones.length&&(r=new Mesh(n,t)),this.mBones.length>0&&(r=new SkinnedMesh(n,t)).normalizeSkinWeights(),this.threeNode=r,r}}function F(){this.mNumIndices=0,this.mIndices=[]}function k(){this.x=0,this.y=0,this.z=0,this.toTHREE=function(){return new Vector3(this.x,this.y,this.z)}}function I(){this.r=0,this.g=0,this.b=0,this.a=0,this.toTHREE=function(){return new Color(this.r,this.g,this.b,1)}}function B(){this.x=0,this.y=0,this.z=0,this.w=0,this.toTHREE=function(){return new Quaternion(this.x,this.y,this.z,this.w)}}function U(){this.mVertexId=0,this.mWeight=0}function V(){this.data=[],this.toString=function(){var e="";return this.data.forEach(function(t){e+=String.fromCharCode(t)}),e.replace(/[^\x20-\x7E]+/g,"")}}function j(){this.mTime=0,this.mValue=null}function z(){this.mTime=0,this.mValue=null}function G(){this.mName="",this.mTransformation=[],this.mNumChildren=0,this.mNumMeshes=0,this.mMeshes=[],this.mChildren=[],this.toTHREE=function(e){if(this.threeNode)return this.threeNode;var t=new Object3D;t.name=this.mName,t.matrix=this.mTransformation.toTHREE();for(var r=0;r<this.mChildren.length;r++)t.add(this.mChildren[r].toTHREE(e));for(r=0;r<this.mMeshes.length;r++)t.add(e.mMeshes[this.mMeshes[r]].toTHREE(e));return this.threeNode=t,t.matrix.decompose(t.position,t.quaternion,t.scale),t}}function W(){this.mName="",this.mNumWeights=0,this.mOffsetMatrix=0}function H(){this.mKey="",this.mSemantic=0,this.mIndex=0,this.mData=[],this.mDataLength=0,this.mType=0,this.dataAsColor=function(){var e=new Uint8Array(this.mData).buffer,t=new DataView(e);return new Color(t.getFloat32(0,!0),t.getFloat32(4,!0),t.getFloat32(8,!0))},this.dataAsFloat=function(){var e=new Uint8Array(this.mData).buffer;return new DataView(e).getFloat32(0,!0)},this.dataAsBool=function(){var e=new Uint8Array(this.mData).buffer;return!!new DataView(e).getFloat32(0,!0)},this.dataAsString=function(){var e=new V;return e.data=this.mData,e.toString()},this.dataAsMap=function(){var e=new V;e.data=this.mData;var t=e.toString();return-1!=(t=t.replace(/\\/g,"/")).indexOf("/")&&(t=t.substr(t.lastIndexOf("/")+1)),r.load(t)}}var X={"?mat.name":"name","$mat.shadingm":"shading","$mat.twosided":"twoSided","$mat.wireframe":"wireframe","$clr.ambient":"ambient","$clr.diffuse":"color","$clr.specular":"specular","$clr.emissive":"emissive","$clr.transparent":"transparent","$clr.reflective":"reflect","$mat.shininess":"shininess","$mat.reflectivity":"reflectivity","$mat.refracti":"refraction","$tex.file":"map"},q={"?mat.name":"string","$mat.shadingm":"bool","$mat.twosided":"bool","$mat.wireframe":"bool","$clr.ambient":"color","$clr.diffuse":"color","$clr.specular":"color","$clr.emissive":"color","$clr.transparent":"color","$clr.reflective":"color","$mat.shininess":"float","$mat.reflectivity":"float","$mat.refracti":"float","$tex.file":"map"};function Y(){this.mNumAllocated=0,this.mNumProperties=0,this.mProperties=[],this.toTHREE=function(e){this.mProperties[0].dataAsString();for(var t=new MeshPhongMaterial,r=0;r<this.mProperties.length;r++)if("float"==q[this.mProperties[r].mKey]&&(t[X[this.mProperties[r].mKey]]=this.mProperties[r].dataAsFloat()),"color"==q[this.mProperties[r].mKey]&&(t[X[this.mProperties[r].mKey]]=this.mProperties[r].dataAsColor()),"bool"==q[this.mProperties[r].mKey]&&(t[X[this.mProperties[r].mKey]]=this.mProperties[r].dataAsBool()),"string"==q[this.mProperties[r].mKey]&&(t[X[this.mProperties[r].mKey]]=this.mProperties[r].dataAsString()),"map"==q[this.mProperties[r].mKey]){var n=this.mProperties[r];n.mSemantic==_&&(t.map=this.mProperties[r].dataAsMap()),n.mSemantic==T&&(t.normalMap=this.mProperties[r].dataAsMap()),n.mSemantic==C&&(t.lightMap=this.mProperties[r].dataAsMap()),n.mSemantic==A&&(t.alphaMap=this.mProperties[r].dataAsMap())}return t.ambient.r=.53,t.ambient.g=.53,t.ambient.b=.53,t.color.r=1,t.color.g=1,t.color.b=1,t}}function K(e,t,r){var n=new Vector3,i=1-r;return n.x=e.x*r+t.x*i,n.y=e.y*r+t.y*i,n.z=e.z*r+t.z*i,n}function Q(e,t,r){return e.clone().slerp(t,1-r)}function J(e,t,r,n){if(1==e.length)return e[0].mValue.toTHREE();for(var i=1/0,o=null,a=null,s=0;s<e.length;s++){var l=Math.abs(e[s].mTime-t);l<i&&e[s].mTime<=t&&(i=l,o=e[s],a=e[s+1])}if(o){if(a){var u=a.mTime-o.mTime,c=(o.mTime-t)/u;return n(o.mValue.toTHREE(),a.mValue.toTHREE(),c)}(a=e[0].clone()).mTime+=r;u=a.mTime-o.mTime,c=(o.mTime-t)/u;return n(o.mValue.toTHREE(),a.mValue.toTHREE(),c)}return null}function Z(){this.mNodeName="",this.mNumPositionKeys=0,this.mNumRotationKeys=0,this.mNumScalingKeys=0,this.mPositionKeys=[],this.mRotationKeys=[],this.mScalingKeys=[],this.mPreState="",this.mPostState="",this.init=function(e){function t(t){t.mTime/=e}e||(e=1),this.mPositionKeys.forEach(t),this.mRotationKeys.forEach(t),this.mScalingKeys.forEach(t)},this.sortKeys=function(){function e(e,t){return e.mTime-t.mTime}this.mPositionKeys.sort(e),this.mRotationKeys.sort(e),this.mScalingKeys.sort(e)},this.getLength=function(){return Math.max(Math.max.apply(null,this.mPositionKeys.map(function(e){return e.mTime})),Math.max.apply(null,this.mRotationKeys.map(function(e){return e.mTime})),Math.max.apply(null,this.mScalingKeys.map(function(e){return e.mTime})))},this.toTHREE=function(e,t){this.sortKeys();for(var r=this.getLength(),i=new n.KeyFrameTrack,o=0;o<r;o+=.05){var a=new Matrix4,s=o,l=J(this.mPositionKeys,s,r,K),u=J(this.mScalingKeys,s,r,K),c=J(this.mRotationKeys,s,r,Q);a.compose(l,c,u);var h=new n.KeyFrame(s,a);i.addKey(h)}i.target=e.findNode(this.mNodeName).toTHREE();var p=[i];if(e.nodeToBoneMap[this.mNodeName])for(o=0;o<e.nodeToBoneMap[this.mNodeName].length;o++){var f=i.clone();f.target=e.nodeToBoneMap[this.mNodeName][o],p.push(f)}return p}}function $(){this.mName="",this.mDuration=0,this.mTicksPerSecond=0,this.mNumChannels=0,this.mChannels=[],this.toTHREE=function(e){var t=new n.Animation;for(var r in this.mChannels){this.mChannels[r].init(this.mTicksPerSecond);var i=this.mChannels[r].toTHREE(e);for(var o in i)i[o].init(),t.addTrack(i[o])}return t.length=Math.max.apply(null,t.tracks.map(function(e){return e.length})),t}}function ee(){this.mWidth=0,this.mHeight=0,this.texAchFormatHint=[],this.pcData=[]}function te(){this.mName="",this.mType=0,this.mAttenuationConstant=0,this.mAttenuationLinear=0,this.mAttenuationQuadratic=0,this.mAngleInnerCone=0,this.mAngleOuterCone=0,this.mColorDiffuse=null,this.mColorSpecular=null,this.mColorAmbient=null}function re(){this.mName="",this.mPosition=null,this.mLookAt=null,this.mUp=null,this.mHorizontalFOV=0,this.mClipPlaneNear=0,this.mClipPlaneFar=0,this.mAspect=0}function ne(){this.mFlags=0,this.mNumMeshes=0,this.mNumMaterials=0,this.mNumAnimations=0,this.mNumTextures=0,this.mNumLights=0,this.mNumCameras=0,this.mRootNode=null,this.mMeshes=[],this.mMaterials=[],this.mAnimations=[],this.mLights=[],this.mCameras=[],this.nodeToBoneMap={},this.findNode=function(e,t){if(t||(t=this.mRootNode),t.mName==e)return t;for(var r=0;r<t.mChildren.length;r++){var n=this.findNode(e,t.mChildren[r]);if(n)return n}return null},this.toTHREE=function(){this.nodeCount=0,function(e){for(var t in e.mMeshes){var r=e.mMeshes[t];for(var n in r.mBones){var i=e.findNode(r.mBones[n].mName);i&&(i.isBone=!0)}}}(this);var e=this.mRootNode.toTHREE(this);for(var t in this.mMeshes)this.mMeshes[t].hookupSkeletons(this,e);if(this.mAnimations.length>0)var r=this.mAnimations[0].toTHREE(this);return{object:e,animation:r}}}function ie(){this.elements=[[],[],[],[]],this.toTHREE=function(){for(var e=new Matrix4,t=0;t<4;++t)for(var r=0;r<4;++r)e.elements[4*t+r]=this.elements[r][t];return e}}var oe=!0;function ae(e){var t=e.getFloat32(e.readOffset,oe);return e.readOffset+=4,t}function se(e){var t=e.getFloat64(e.readOffset,oe);return e.readOffset+=8,t}function le(e){var t=e.getUint8(e.readOffset);return e.readOffset+=1,t}function ue(e){var t=e.getUint16(e.readOffset,oe);return e.readOffset+=2,t}function ce(e){var t=e.getUint32(e.readOffset,oe);return e.readOffset+=4,t}function he(e){var t=e.getUint32(e.readOffset,oe);return e.readOffset+=4,t}function pe(e){var t=new k;return t.x=ae(e),t.y=ae(e),t.z=ae(e),t}function fe(e){var t=new I;return t.r=ae(e),t.g=ae(e),t.b=ae(e),t}function de(e){var t=new V,r=ce(e);return e.ReadBytes(t.data,1,r),t.toString()}function me(e){var t=new U;return t.mVertexId=ce(e),t.mWeight=ae(e),t}function ve(e){for(var t=new ie,r=0;r<4;++r)for(var n=0;n<4;++n)t.elements[r][n]=ae(e);return t}function ge(e){var t=new j;return t.mTime=se(e),t.mValue=pe(e),t}function ye(e){var t=new z;return t.mTime=se(e),t.mValue=function(e){var t=new B;return t.w=ae(e),t.x=ae(e),t.y=ae(e),t.z=ae(e),t}(e),t}function be(e,t,r){for(var n=0;n<r;n++)t[n]=ge(e)}function xe(e,t,r){return e.Seek(sizeof(t)*r,De)}function we(e){if(!e)throw"asset failed"}function Se(e,t){return we(he(e)==c),he(e),t.mName=de(e),t.mNumWeights=ce(e),t.mOffsetMatrix=ve(e),Oe?xe(e,t.mWeights,t.mNumWeights):(t.mWeights=[],function(e,t,r){for(var n=0;n<r;n++)t[n]=me(e)}(e,t.mWeights,t.mNumWeights)),t}function Me(e,t){we(he(e)==s),he(e),t.mPrimitiveTypes=ce(e),t.mNumVertices=ce(e),t.mNumFaces=ce(e),t.mNumBones=ce(e),t.mMaterialIndex=ce(e),t.mNumUVComponents=[];var r=ce(e);r&m&&(Oe?xe(e,t.mVertices,t.mNumVertices):(t.mVertices=[],t.mVertexBuffer=e.subArray32(e.readOffset,e.readOffset+3*t.mNumVertices*4),e.Seek(3*t.mNumVertices*4,De))),r&v&&(Oe?xe(e,t.mNormals,t.mNumVertices):(t.mNormals=[],t.mNormalBuffer=e.subArray32(e.readOffset,e.readOffset+3*t.mNumVertices*4),e.Seek(3*t.mNumVertices*4,De))),r&g&&(Oe?(xe(e,t.mTangents,t.mNumVertices),xe(e,t.mBitangents,t.mNumVertices)):(t.mTangents=[],t.mTangentBuffer=e.subArray32(e.readOffset,e.readOffset+3*t.mNumVertices*4),e.Seek(3*t.mNumVertices*4,De),t.mBitangents=[],t.mBitangentBuffer=e.subArray32(e.readOffset,e.readOffset+3*t.mNumVertices*4),e.Seek(3*t.mNumVertices*4,De)));for(var n=0;n<x&&r&N(n);++n)Oe?xe(e,t.mColors[n],t.mNumVertices):(t.mColors[n]=[],t.mColorBuffer=e.subArray32(e.readOffset,e.readOffset+4*t.mNumVertices*4),e.Seek(4*t.mNumVertices*4,De));t.mTexCoordsBuffers=[];for(n=0;n<w&&r&L(n);++n)if(t.mNumUVComponents[n]=ce(e),Oe)xe(e,t.mTextureCoords[n],t.mNumVertices);else{t.mTextureCoords[n]=[],t.mTexCoordsBuffers[n]=[];for(var i=0;i<t.mNumVertices;i++)t.mTexCoordsBuffers[n].push(ae(e)),t.mTexCoordsBuffers[n].push(ae(e)),ae(e)}if(Oe)ce(e);else{t.mFaces=[],t.mIndexArray=[];for(var o=0;o<t.mNumFaces;++o){var a=t.mFaces[o]=new F;a.mNumIndices=ue(e),a.mIndices=[];for(var l=0;l<a.mNumIndices;++l)t.mNumVertices<65536?a.mIndices[l]=ue(e):a.mIndices[l]=ce(e);if(3===a.mNumIndices)t.mIndexArray.push(a.mIndices[0]),t.mIndexArray.push(a.mIndices[1]),t.mIndexArray.push(a.mIndices[2]);else{if(4!==a.mNumIndices)throw new Error("Sorry, can't currently triangulate polys. Use the triangulate preprocessor in Assimp.");t.mIndexArray.push(a.mIndices[0]),t.mIndexArray.push(a.mIndices[1]),t.mIndexArray.push(a.mIndices[2]),t.mIndexArray.push(a.mIndices[2]),t.mIndexArray.push(a.mIndices[3]),t.mIndexArray.push(a.mIndices[0])}}}if(t.mNumBones){t.mBones=[];for(l=0;l<t.mNumBones;++l)t.mBones[l]=new W,Se(e,t.mBones[l])}}function _e(e,t){we(he(e)==d),he(e),t.mKey=de(e),t.mSemantic=ce(e),t.mIndex=ce(e),t.mDataLength=ce(e),t.mType=ce(e),t.mData=[],e.ReadBytes(t.mData,1,t.mDataLength)}function Te(e,t){if(we(he(e)==f),he(e),t.mNumAllocated=t.mNumProperties=ce(e),t.mNumProperties){t.mProperties&&delete t.mProperties,t.mProperties=[];for(var r=0;r<t.mNumProperties;++r)t.mProperties[r]=new H,_e(e,t.mProperties[r])}}function Ae(e,t){we(he(e)==l),he(e),t.mNodeName=de(e),t.mNumPositionKeys=ce(e),t.mNumRotationKeys=ce(e),t.mNumScalingKeys=ce(e),t.mPreState=ce(e),t.mPostState=ce(e),t.mNumPositionKeys&&(Oe?xe(e,t.mPositionKeys,t.mNumPositionKeys):(t.mPositionKeys=[],be(e,t.mPositionKeys,t.mNumPositionKeys))),t.mNumRotationKeys&&(Oe?xe(e,t.mRotationKeys,t.mNumRotationKeys):(t.mRotationKeys=[],function(e,t,r){for(var n=0;n<r;n++)t[n]=ye(e)}(e,t.mRotationKeys,t.mNumRotationKeys))),t.mNumScalingKeys&&(Oe?xe(e,t.mScalingKeys,t.mNumScalingKeys):(t.mScalingKeys=[],be(e,t.mScalingKeys,t.mNumScalingKeys)))}function Ce(e,t){if(we(he(e)==h),he(e),t.mName=de(e),t.mDuration=se(e),t.mTicksPerSecond=se(e),t.mNumChannels=ce(e),t.mNumChannels){t.mChannels=[];for(var r=0;r<t.mNumChannels;++r)t.mChannels[r]=new Z,Ae(e,t.mChannels[r])}}function Ee(e,t){we(he(e)==a),he(e),t.mWidth=ce(e),t.mHeight=ce(e),e.ReadBytes(t.achFormatHint,1,4),Oe||(t.mHeight?(t.pcData=[],e.ReadBytes(t.pcData,1,t.mWidth*t.mHeight*4)):(t.pcData=[],e.ReadBytes(t.pcData,1,t.mWidth)))}function Le(e,t){we(he(e)==o),he(e),t.mName=de(e),t.mType=ce(e),t.mType!=S&&(t.mAttenuationConstant=ae(e),t.mAttenuationLinear=ae(e),t.mAttenuationQuadratic=ae(e)),t.mColorDiffuse=fe(e),t.mColorSpecular=fe(e),t.mColorAmbient=fe(e),t.mType==M&&(t.mAngleInnerCone=ae(e),t.mAngleOuterCone=ae(e))}function Ne(e,t){we(he(e)==i),he(e),t.mName=de(e),t.mPosition=pe(e),t.mLookAt=pe(e),t.mUp=pe(e),t.mHorizontalFOV=ae(e),t.mClipPlaneNear=ae(e),t.mClipPlaneFar=ae(e),t.mAspect=ae(e)}function Pe(e,t){if(we(he(e)==u),he(e),t.mFlags=ce(e),t.mNumMeshes=ce(e),t.mNumMaterials=ce(e),t.mNumAnimations=ce(e),t.mNumTextures=ce(e),t.mNumLights=ce(e),t.mNumCameras=ce(e),t.mRootNode=new G,t.mRootNode=function e(t,r,n){we(he(t)==p),he(t);var i=new G;if(i.mParent=r,i.mDepth=n,i.mName=de(t),i.mTransformation=ve(t),i.mNumChildren=ce(t),i.mNumMeshes=ce(t),i.mNumMeshes){i.mMeshes=[];for(var o=0;o<i.mNumMeshes;++o)i.mMeshes[o]=ce(t)}if(i.mNumChildren)for(i.mChildren=[],o=0;o<i.mNumChildren;++o){var a=e(t,i,n++);i.mChildren[o]=a}return i}(e,null,0),t.mNumMeshes){t.mMeshes=[];for(var r=0;r<t.mNumMeshes;++r)t.mMeshes[r]=new D,Me(e,t.mMeshes[r])}if(t.mNumMaterials){t.mMaterials=[];for(r=0;r<t.mNumMaterials;++r)t.mMaterials[r]=new Y,Te(e,t.mMaterials[r])}if(t.mNumAnimations){t.mAnimations=[];for(r=0;r<t.mNumAnimations;++r)t.mAnimations[r]=new $,Ce(e,t.mAnimations[r])}if(t.mNumTextures){t.mTextures=[];for(r=0;r<t.mNumTextures;++r)t.mTextures[r]=new ee,Ee(e,t.mTextures[r])}if(t.mNumLights){t.mLights=[];for(r=0;r<t.mNumLights;++r)t.mLights[r]=new te,Le(e,t.mLights[r])}if(t.mNumCameras){t.mCameras=[];for(r=0;r<t.mNumCameras;++r)t.mCameras[r]=new re,Ne(e,t.mCameras[r])}}var Oe,Re,De=0,Fe=1;return function(e){var t=new ne,r=new DataView(e);if(function(e){e.readOffset=0,e.Seek=function(t,r){r==De&&(e.readOffset+=t),r==Fe&&(e.readOffset=t)},e.ReadBytes=function(e,t,r){for(var n=t*r,i=0;i<n;i++)e[i]=le(this)},e.subArray32=function(e,t){var r=this.buffer.slice(e,t);return new Float32Array(r)},e.subArrayUint16=function(e,t){var r=this.buffer.slice(e,t);return new Uint16Array(r)},e.subArrayUint8=function(e,t){var r=this.buffer.slice(e,t);return new Uint8Array(r)},e.subArrayUint32=function(e,t){var r=this.buffer.slice(e,t);return new Uint32Array(r)}}(r),r.Seek(44,De),ce(r),ce(r),ce(r),ce(r),Oe=ue(r)>0,Re=ue(r)>0,Oe)throw"Shortened binaries are not supported!";if(r.Seek(256,De),r.Seek(128,De),r.Seek(64,De),!Re)return Pe(r,t),t.toTHREE();var n=he(r),i=r.FileSize()-r.Tell(),o=[];r.Read(o,1,i);var a=[];uncompress(a,n,o,i),Pe(new ArrayBuffer(a),t)}(e)}};var AWD_FIELD_INT8=1,AWD_FIELD_INT16=2,AWD_FIELD_INT32=3,AWD_FIELD_UINT8=4,AWD_FIELD_UINT16=5,AWD_FIELD_UINT32=6,AWD_FIELD_FLOAT32=7,AWD_FIELD_FLOAT64=8,AWD_FIELD_BOOL=21,AWD_FIELD_BADDR=23,AWD_FIELD_VECTOR2x1=41,AWD_FIELD_VECTOR3x1=42,AWD_FIELD_VECTOR4x1=43,AWD_FIELD_MTX3x2=44,AWD_FIELD_MTX3x3=45,AWD_FIELD_MTX4x3=46,AWD_FIELD_MTX4x4=47,BOOL=21,BADDR=23,UINT8=4,UINT16=5,FLOAT32=7,FLOAT64=8,littleEndian=!0;function Block(){this.id=0,this.data=null}function AWDProperties(){}AWDProperties.prototype={set:function(e,t){this[e]=t},get:function(e,t){return this.hasOwnProperty(e)?this[e]:t}};var AWDLoader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager,this.trunk=new Object3D,this.materialFactory=void 0,this._url="",this._baseDir="",this._data=void 0,this._ptr=0,this._version=[],this._streaming=!1,this._optimized_for_accuracy=!1,this._compression=0,this._bodylen=4294967295,this._blocks=[new Block],this._accuracyMatrix=!1,this._accuracyGeo=!1,this._accuracyProps=!1};function Light(e,t){Object3D.call(this),this.type="Light",this.color=new Color(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function LightShadow(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new Vector2(512,512),this.map=null,this.matrix=new Matrix4}function PointLight(e,t,r,n){Light.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==r?r:0,this.decay=void 0!==n?n:1,this.shadow=new LightShadow(new PerspectiveCamera(90,1,.5,500))}function DirectionalLightShadow(){LightShadow.call(this,new OrthographicCamera(-5,5,5,-5,.5,500))}function DirectionalLight(e,t){Light.call(this,e,t),this.type="DirectionalLight",this.position.copy(Object3D.DefaultUp),this.updateMatrix(),this.target=new Object3D,this.shadow=new DirectionalLightShadow}function SpotLightShadow(){LightShadow.call(this,new PerspectiveCamera(50,1,.5,500))}function SpotLight(e,t,r,n,i,o){Light.call(this,e,t),this.type="SpotLight",this.position.copy(Object3D.DefaultUp),this.updateMatrix(),this.target=new Object3D,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==r?r:0,this.angle=void 0!==n?n:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==o?o:1,this.shadow=new SpotLightShadow}function HemisphereLight(e,t,r){Light.call(this,e,r),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Object3D.DefaultUp),this.updateMatrix(),this.groundColor=new Color(t)}AWDLoader.prototype={constructor:AWDLoader,load:function(e,t,r,n){var i=this;this._url=e,this._baseDir=e.substr(0,e.lastIndexOf("/")+1);var o=new FileLoader(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){var t=e.byteLength;for(this._ptr=0,this._data=new DataView(e),this._parseHeader(),0!=this._compression&&console.error("compressed AWD not supported"),this._streaming||this._bodylen==e.byteLength-this._ptr||console.error("AWDLoader: body len does not match file length",this._bodylen,t-this._ptr);this._ptr<t;)this.parseNextBlock();return this.trunk},parseNextBlock:function(){var e,t,r=this.readU32(),n=(this.readU8(),this.readU8()),i=(this.readU8(),this.readU32());switch(n){case 1:e=this.parseMeshData(i);break;case 22:e=this.parseContainer(i);break;case 23:e=this.parseMeshInstance(i);break;case 81:e=this.parseMaterial(i);break;case 82:e=this.parseTexture(i);break;case 101:e=this.parseSkeleton(i);break;case 112:e=this.parseMeshPoseAnimation(i,!1);break;case 113:e=this.parseVertexAnimationSet(i);break;case 102:e=this.parseSkeletonPose(i);break;case 103:e=this.parseSkeletonAnimation(i);break;case 122:e=this.parseAnimatorSet(i);break;default:this._ptr+=i}this._blocks[r]=t=new Block,t.data=e,t.id=r},_parseHeader:function(){var e=this._version;if(4282180!=(this.readU8()<<16|this.readU8()<<8|this.readU8()))throw new Error("AWDLoader - bad magic");e[0]=this.readU8(),e[1]=this.readU8();var t=this.readU16();this._streaming=1==(1&t),2===e[0]&&1===e[1]&&(this._accuracyMatrix=2===(2&t),this._accuracyGeo=4===(4&t),this._accuracyProps=8===(8&t)),this._geoNrType=this._accuracyGeo?FLOAT64:FLOAT32,this._matrixNrType=this._accuracyMatrix?FLOAT64:FLOAT32,this._propsNrType=this._accuracyProps?FLOAT64:FLOAT32,this._optimized_for_accuracy=2===(2&t),this._compression=this.readU8(),this._bodylen=this.readU32()},parseContainer:function(e){var t=new Object3D,r=this.readU32(),n=this.parseMatrix4();return t.name=this.readUTF(),t.applyMatrix(n),(this._blocks[r].data||this.trunk).add(t),this.parseProperties({1:this._matrixNrType,2:this._matrixNrType,3:this._matrixNrType,4:UINT8}),t.extra=this.parseUserAttributes(),t},parseMeshInstance:function(e){var t,r,n,i,o,a,s,l,u,c,h,p,f;for(a=this.readU32(),l=this.parseMatrix4(),t=this.readUTF(),s=this.readU32(),p=this.readU16(),n=this.getBlock(s),u=[],f=0;f<p;f++)h=this.readU32(),c=this.getBlock(h),u.push(c);if(o=[],(i=n.length)>1)for(r=new Object3D,f=0;f<i;f++){var d=new Mesh(n[f]);o.push(d),r.add(d)}else r=new Mesh(n[0]),o.push(r);r.applyMatrix(l),r.name=t,(this.getBlock(a)||this.trunk).add(r);var m=u.length,v=Math.max(i,m);for(f=0;f<v;f++)o[f%i].material=u[f%m];return this.parseProperties(null),r.extra=this.parseUserAttributes(),r},parseMaterial:function(e){var t,r,n,i,o,a;for(t=this.readUTF(),r=this.readU8(),a=this.readU8(),n=this.parseProperties({1:AWD_FIELD_INT32,2:AWD_FIELD_BADDR,11:AWD_FIELD_BOOL,12:AWD_FIELD_FLOAT32,13:AWD_FIELD_BOOL}),0;0<a;){this.readU16();this.parseProperties(null),this.parseUserAttributes()}if(o=this.parseUserAttributes(),void 0!==this.materialFactory&&(i=this.materialFactory(t)))return i;if(i=new MeshPhongMaterial,1===r)i.color.setHex(n.get(1,13421772));else if(2===r){var s=n.get(2,0);i.map=this.getBlock(s)}return i.extra=o,i.alphaThreshold=n.get(12,0),i.repeat=n.get(13,!1),i},parseTexture:function(e){var t,r;this.readUTF();if(0===this.readU8()){r=this.readU32();var n=this.readUTFBytes(r);console.log(n),t=this.loadTexture(n)}return this.parseProperties(null),this.parseUserAttributes(),t},loadTexture:function(e){var t=new Texture;return new ImageLoader(this.manager).load(this._baseDir+e,function(e){t.image=e,t.needsUpdate=!0}),t},parseSkeleton:function(e){this.readUTF();var t=this.readU16(),r=[],n=0;for(this.parseProperties(null);n<t;){var i,o;this.readU16(),(i=new Bone).parent=this.readU16()-1,i.name=this.readUTF(),o=this.parseMatrix4(),i.skinMatrix=o,this.parseProperties(null),this.parseUserAttributes(),r.push(i),n++}return this.parseUserAttributes(),r},parseSkeletonPose:function(e){this.readUTF();var t=this.readU16();this.parseProperties(null);for(var r=[],n=0;n<t;){var i;i=1===this.readU8()?this.parseMatrix4():new Matrix4,r[n]=i,n++}return this.parseUserAttributes(),r},parseSkeletonAnimation:function(e){this.readUTF();var t,r,n,i=[],o=this.readU16();this.parseProperties(null);for(var a=0;a<o;)r=this.readU32(),t=this.readU16(),n=this._blocks[r].data,i.push({pose:n,duration:t}),a++;if(0!==i.length)return this.parseUserAttributes(),i},parseVertexAnimationSet:function(e){this.readUTF();for(var t,r=this.readU16(),n=(this.parseProperties({1:UINT16}),0),i=[];n<r;)t=this.readU32(),i.push(this._blocks[t].data),n++;return this.parseUserAttributes(),i},parseAnimatorSet:function(e){this.readUTF();var t,r,n=this.readU16(),i=this.parseProperties({1:BADDR});t=this.readU32();for(var o=this.readU16(),a=[],s=0;s<o;s++)a.push(this.readU32());this.readU16(),Boolean(this.readU8());this.parseUserAttributes(),this.parseUserAttributes();var l,u=[];for(s=0;s<a.length;s++)u.push(this._blocks[a[s]].data);for(r=this._blocks[t].data,1==n&&(l={animationSet:r,skeleton:this._blocks[i.get(1,0)].data}),s=0;s<u.length;s++)u[s].animator=l;return l},parseMeshData:function(e){var t,r,n=this.readUTF(),i=this.readU16(),o=0,a=[];for(this.parseProperties({1:this._geoNrType,2:this._geoNrType});o<i;){var s,l,u;for((t=new BufferGeometry).name=n,a.push(t),s=this.readU32(),l=this._ptr+s,this.parseProperties({1:this._geoNrType,2:this._geoNrType});this._ptr<l;){var c=0,h=this.readU8(),p=(this.readU8(),this.readU32()),f=p+this._ptr;if(1===h)for(u=new BufferAttribute(r=new Float32Array(p/12*3),3),t.addAttribute("position",u),c=0;this._ptr<f;)r[c]=-this.readF32(),r[c+1]=this.readF32(),r[c+2]=this.readF32(),c+=3;else if(2===h)for(u=new BufferAttribute(r=new Uint16Array(p/2),1),t.setIndex(u),c=0;this._ptr<f;)r[c+1]=this.readU16(),r[c]=this.readU16(),r[c+2]=this.readU16(),c+=3;else if(3===h)for(u=new BufferAttribute(r=new Float32Array(p/8*2),2),t.addAttribute("uv",u),c=0;this._ptr<f;)r[c]=this.readF32(),r[c+1]=1-this.readF32(),c+=2;else if(4===h)for(u=new BufferAttribute(r=new Float32Array(p/12*3),3),t.addAttribute("normal",u),c=0;this._ptr<f;)r[c]=-this.readF32(),r[c+1]=this.readF32(),r[c+2]=this.readF32(),c+=3;else this._ptr=f}this.parseUserAttributes(),t.computeBoundingSphere(),o++}return this.parseUserAttributes(),a},parseMeshPoseAnimation:function(e,t){var r,n,i,o,a,s,l,u,c,h=1,p=0,f={},d=[],m=(this.readUTF(),this.readU32()),v=this.getBlock(m);if(null!==v){for((s=v.geometry).morphTargets=[],t||(h=this.readU16()),r=this.readU16(),l=this.readU16(),u=0;u<l;)d.push(this.readU16()),u++;for(c=this.parseProperties({1:BOOL,2:BOOL}),f.looping=c.get(1,!0),f.stitchFinalFrame=c.get(2,!1),n=0;n<h;){for(this.readU16(),i=0;i<r;)for(u=0,o=this.readU32(),a=this._ptr+o;u<l;){if(1===d[u]){var g=new Float32Array(o/4);for(s.morphTargets.push({array:g}),p=0;this._ptr<a;)g[p]=this.readF32(),g[p+1]=this.readF32(),g[p+2]=this.readF32(),p+=3;i++}else this._ptr=a;u++}n++}return this.parseUserAttributes(),null}console.log("parseMeshPoseAnimation target mesh not found at:",m)},getBlock:function(e){return this._blocks[e].data},parseMatrix4:function(){var e=new Matrix4,t=e.elements;return t[0]=this.readF32(),t[1]=this.readF32(),t[2]=this.readF32(),t[3]=0,t[4]=this.readF32(),t[5]=this.readF32(),t[6]=this.readF32(),t[7]=0,t[8]=this.readF32(),t[9]=this.readF32(),t[10]=this.readF32(),t[11]=0,t[12]=-this.readF32(),t[13]=this.readF32(),t[14]=this.readF32(),t[15]=1,e},parseProperties:function(e){var t=this.readU32(),r=this._ptr+t,n=new AWDProperties;if(e)for(;this._ptr<r;){var i,o=this.readU16(),a=this.readU32();e.hasOwnProperty(o)?(i=e[o],n.set(o,this.parseAttrValue(i,a))):this._ptr+=a}return n},parseUserAttributes:function(){return this._ptr=this.readU32()+this._ptr,null},parseAttrValue:function(e,t){var r,n;switch(e){case AWD_FIELD_INT8:r=1,n=this.readI8;break;case AWD_FIELD_INT16:r=2,n=this.readI16;break;case AWD_FIELD_INT32:r=4,n=this.readI32;break;case AWD_FIELD_BOOL:case AWD_FIELD_UINT8:r=1,n=this.readU8;break;case AWD_FIELD_UINT16:r=2,n=this.readU16;break;case AWD_FIELD_UINT32:case AWD_FIELD_BADDR:r=4,n=this.readU32;break;case AWD_FIELD_FLOAT32:r=4,n=this.readF32;break;case AWD_FIELD_FLOAT64:r=8,n=this.readF64;break;case AWD_FIELD_VECTOR2x1:case AWD_FIELD_VECTOR3x1:case AWD_FIELD_VECTOR4x1:case AWD_FIELD_MTX3x2:case AWD_FIELD_MTX3x3:case AWD_FIELD_MTX4x3:case AWD_FIELD_MTX4x4:r=8,n=this.readF64}if(r<t){var i,o,a;for(i=[],o=0,a=t/r;o<a;)i.push(n.call(this)),o++;return i}return n.call(this)},readU8:function(){return this._data.getUint8(this._ptr++)},readI8:function(){return this._data.getInt8(this._ptr++)},readU16:function(){var e=this._data.getUint16(this._ptr,littleEndian);return this._ptr+=2,e},readI16:function(){var e=this._data.getInt16(this._ptr,littleEndian);return this._ptr+=2,e},readU32:function(){var e=this._data.getUint32(this._ptr,littleEndian);return this._ptr+=4,e},readI32:function(){var e=this._data.getInt32(this._ptr,littleEndian);return this._ptr+=4,e},readF32:function(){var e=this._data.getFloat32(this._ptr,littleEndian);return this._ptr+=4,e},readF64:function(){var e=this._data.getFloat64(this._ptr,littleEndian);return this._ptr+=8,e},readUTF:function(){var e=this.readU16();return this.readUTFBytes(e)},readUTFBytes:function(e){for(var t=[],r=0;t.length<e;){var n=this._data.getUint8(this._ptr++,littleEndian);if(n<128)t[r++]=String.fromCharCode(n);else if(n>191&&n<224){var i=this._data.getUint8(this._ptr++,littleEndian);t[r++]=String.fromCharCode((31&n)<<6|63&i)}else{i=this._data.getUint8(this._ptr++,littleEndian);var o=this._data.getUint8(this._ptr++,littleEndian);t[r++]=String.fromCharCode((15&n)<<12|(63&i)<<6|63&o)}}return t.join("")}},Light.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Light,isLight:!0,copy:function(e){return Object3D.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=Object3D.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),Object.assign(LightShadow.prototype,{copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),PointLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:PointLight,isPointLight:!0,copy:function(e){return Light.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),DirectionalLightShadow.prototype=Object.assign(Object.create(LightShadow.prototype),{constructor:DirectionalLightShadow}),DirectionalLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:DirectionalLight,isDirectionalLight:!0,copy:function(e){return Light.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),SpotLightShadow.prototype=Object.assign(Object.create(LightShadow.prototype),{constructor:SpotLightShadow,isSpotLightShadow:!0,update:function(e){var t=this.camera,r=2*_Math.RAD2DEG*e.angle,n=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;r===t.fov&&n===t.aspect&&i===t.far||(t.fov=r,t.aspect=n,t.far=i,t.updateProjectionMatrix())}}),SpotLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:SpotLight,isSpotLight:!0,copy:function(e){return Light.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),HemisphereLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:HemisphereLight,isHemisphereLight:!0,copy:function(e){return Light.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}});var BabylonLoader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager};BabylonLoader.prototype={constructor:BabylonLoader,load:function(e,t,r,n){var i=this,o=new FileLoader(i.manager);o.setPath(i.path),o.load(e,function(e){t(i.parse(JSON.parse(e)))},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){function t(e){var t=new BufferGeometry,r=e.indices,n=e.positions,i=e.normals,o=e.uvs;t.setIndex(r);for(var a=2,s=n.length;a<s;a+=3)n[a]=-n[a];if(t.addAttribute("position",new Float32BufferAttribute(n,3)),i){for(a=2,s=i.length;a<s;a+=3)i[a]=-i[a];t.addAttribute("normal",new Float32BufferAttribute(i,3))}o&&t.addAttribute("uv",new Float32BufferAttribute(o,2));var l=e.subMeshes;if(l)for(a=0,s=l.length;a<s;a++){var u=l[a];t.addGroup(u.indexStart,u.indexCount)}return t}return function(e,r){for(var n={},i=new Scene,o=e.cameras,a=0,s=o.length;a<s;a++){var l=new PerspectiveCamera((p=o[a]).fov/Math.PI*180,1.33,p.minZ,p.maxZ);l.name=p.name,l.position.fromArray(p.position),p.rotation&&l.rotation.fromArray(p.rotation),n[p.id]=l}var u=e.lights;for(a=0,s=u.length;a<s;a++){var c;switch((p=u[a]).type){case 0:c=new PointLight;break;case 1:c=new DirectionalLight;break;case 2:c=new SpotLight;break;case 3:c=new HemisphereLight}c.name=p.name,p.position&&c.position.set(p.position[0],p.position[1],-p.position[2]),c.color.fromArray(p.diffuse),p.groundColor&&c.groundColor.fromArray(p.groundColor),p.intensity&&(c.intensity=p.intensity),n[p.id]=c,i.add(c)}var h=e.meshes;for(a=0,s=h.length;a<s;a++){var p,f;(f=(p=h[a]).indices?new Mesh(t(p),r[p.materialId]):new Group).name=p.name,f.position.set(p.position[0],p.position[1],-p.position[2]),f.rotation.fromArray(p.rotation),p.rotationQuaternion&&f.quaternion.fromArray(p.rotationQuaternion),f.scale.fromArray(p.scaling),p.parentId?n[p.parentId].add(f):i.add(f),n[p.id]=f}return i}(e,function(e){for(var t={},r=0,n=e.materials.length;r<n;r++){var i=e.materials[r],o=new MeshPhongMaterial;o.name=i.name,o.color.fromArray(i.diffuse),o.emissive.fromArray(i.emissive),o.specular.fromArray(i.specular),o.shininess=i.specularPower,o.opacity=i.alpha,t[i.id]=o}if(e.multiMaterials)for(r=0,n=e.multiMaterials.length;r<n;r++)i=e.multiMaterials[r],console.warn("BabylonLoader: Multi materials not yet supported."),t[i.id]=new MeshPhongMaterial;return t}(e))}};var BVHLoader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager,this.animateBonePositions=!0,this.animateBoneRotations=!0};function AmbientLight(e,t){Light.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function LineSegments(e,t){Line.call(this,e,t),this.type="LineSegments"}BVHLoader.prototype={constructor:BVHLoader,load:function(e,t,r,n){var i=this,o=new FileLoader(i.manager);o.setPath(i.path),o.load(e,function(e){t(i.parse(e))},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){function t(e,r,n){if("ENDSITE"!==n.type){var i={time:r,position:new Vector3,rotation:new Quaternion};n.frames.push(i);for(var o=new Quaternion,a=new Vector3(1,0,0),s=new Vector3(0,1,0),l=new Vector3(0,0,1),u=0;u<n.channels.length;u++)switch(n.channels[u]){case"Xposition":i.position.x=parseFloat(e.shift().trim());break;case"Yposition":i.position.y=parseFloat(e.shift().trim());break;case"Zposition":i.position.z=parseFloat(e.shift().trim());break;case"Xrotation":o.setFromAxisAngle(a,parseFloat(e.shift().trim())*Math.PI/180),i.rotation.multiply(o);break;case"Yrotation":o.setFromAxisAngle(s,parseFloat(e.shift().trim())*Math.PI/180),i.rotation.multiply(o);break;case"Zrotation":o.setFromAxisAngle(l,parseFloat(e.shift().trim())*Math.PI/180),i.rotation.multiply(o);break;default:console.warn("BVHLoader: Invalid channel type.")}for(u=0;u<n.children.length;u++)t(e,r,n.children[u])}}function r(e){for(var t;0===(t=e.shift().trim()).length;);return t}var n=this,i=function(e){"HIERARCHY"!==r(e)&&console.error("BVHLoader: HIERARCHY expected.");var n=[],i=function e(t,n,i){var o={name:"",type:"",frames:[]};i.push(o);var a=n.split(/[\s]+/);"END"===a[0].toUpperCase()&&"SITE"===a[1].toUpperCase()?(o.type="ENDSITE",o.name="ENDSITE"):(o.name=a[1],o.type=a[0].toUpperCase()),"{"!==r(t)&&console.error("BVHLoader: Expected opening { after type & name"),"OFFSET"!==(a=r(t).split(/[\s]+/))[0]&&console.error("BVHLoader: Expected OFFSET but got: "+a[0]),4!==a.length&&console.error("BVHLoader: Invalid number of values for OFFSET.");var s=new Vector3(parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3]));if((isNaN(s.x)||isNaN(s.y)||isNaN(s.z))&&console.error("BVHLoader: Invalid values of OFFSET."),o.offset=s,"ENDSITE"!==o.type){"CHANNELS"!==(a=r(t).split(/[\s]+/))[0]&&console.error("BVHLoader: Expected CHANNELS definition.");var l=parseInt(a[1]);o.channels=a.splice(2,l),o.children=[]}for(;;){var u=r(t);if("}"===u)return o;o.children.push(e(t,u,i))}}(e,r(e),n);"MOTION"!==r(e)&&console.error("BVHLoader: MOTION expected.");var o=r(e).split(/[\s]+/),a=parseInt(o[1]);isNaN(a)&&console.error("BVHLoader: Failed to read number of frames."),o=r(e).split(/[\s]+/);var s=parseFloat(o[2]);isNaN(s)&&console.error("BVHLoader: Failed to read frame time.");for(var l=0;l<a;l++)t(o=r(e).split(/[\s]+/),l*s,i);return n}(e.split(/[\r\n]+/g)),o=[];!function e(t,r){var n=new Bone;if(r.push(n),n.position.add(t.offset),n.name=t.name,"ENDSITE"!==t.type)for(var i=0;i<t.children.length;i++)n.add(e(t.children[i],r));return n}(i[0],o);var a=function(e){for(var t=[],r=0;r<e.length;r++){var i=e[r];if("ENDSITE"!==i.type){for(var o=[],a=[],s=[],l=0;l<i.frames.length;l++){var u=i.frames[l];o.push(u.time),a.push(u.position.x+i.offset.x),a.push(u.position.y+i.offset.y),a.push(u.position.z+i.offset.z),s.push(u.rotation.x),s.push(u.rotation.y),s.push(u.rotation.z),s.push(u.rotation.w)}n.animateBonePositions&&t.push(new VectorKeyframeTrack(".bones["+i.name+"].position",o,a)),n.animateBoneRotations&&t.push(new QuaternionKeyframeTrack(".bones["+i.name+"].quaternion",o,s))}}return new AnimationClip("animation",-1,t)}(i);return{skeleton:new Skeleton(o),clip:a}}},AmbientLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:AmbientLight,isAmbientLight:!0}),LineSegments.prototype=Object.assign(Object.create(Line.prototype),{constructor:LineSegments,isLineSegments:!0,computeLineDistances:function(){var e=new Vector3,t=new Vector3;return function(){var r=this.geometry;if(r.isBufferGeometry)if(null===r.index){for(var n=r.attributes.position,i=[],o=0,a=n.count;o<a;o+=2)e.fromBufferAttribute(n,o),t.fromBufferAttribute(n,o+1),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+e.distanceTo(t);r.addAttribute("lineDistance",new Float32BufferAttribute(i,1))}else console.warn("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(r.isGeometry){var s=r.vertices;for(i=r.lineDistances,o=0,a=s.length;o<a;o+=2)e.copy(s[o]),t.copy(s[o+1]),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+e.distanceTo(t)}return this}}()});var TGALoader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager};TGALoader.prototype={constructor:TGALoader,load:function(e,t,r,n){var i=this,o=new Texture,a=new FileLoader(this.manager);return a.setResponseType("arraybuffer"),a.setPath(this.path),a.load(e,function(e){o.image=i.parse(e),o.needsUpdate=!0,void 0!==t&&t(o)},r,n),o},parse:function(e){var t=0,r=1,n=2,i=3,o=9,a=10,s=11,l=48,u=4,c=0,h=1,p=2,f=3;e.length<19&&console.error("TGALoader: Not enough data to contain header.");var d=new Uint8Array(e),m=0,v={id_length:d[m++],colormap_type:d[m++],image_type:d[m++],colormap_index:d[m++]|d[m++]<<8,colormap_length:d[m++]|d[m++]<<8,colormap_size:d[m++],origin:[d[m++]|d[m++]<<8,d[m++]|d[m++]<<8],width:d[m++]|d[m++]<<8,height:d[m++]|d[m++]<<8,pixel_size:d[m++],flags:d[m++]};!function(e){switch(e.image_type){case r:case o:(e.colormap_length>256||24!==e.colormap_size||1!==e.colormap_type)&&console.error("TGALoader: Invalid type colormap data for indexed type.");break;case n:case i:case a:case s:e.colormap_type&&console.error("TGALoader: Invalid type colormap data for colormap type.");break;case t:console.error("TGALoader: No data.");default:console.error('TGALoader: Invalid type "%s".',e.image_type)}(e.width<=0||e.height<=0)&&console.error("TGALoader: Invalid image size."),8!==e.pixel_size&&16!==e.pixel_size&&24!==e.pixel_size&&32!==e.pixel_size&&console.error('TGALoader: Invalid pixel size "%s".',e.pixel_size)}(v),v.id_length+m>e.length&&console.error("TGALoader: No data."),m+=v.id_length;var g=!1,y=!1,b=!1;switch(v.image_type){case o:g=!0,y=!0;break;case r:y=!0;break;case a:g=!0;break;case n:break;case s:g=!0,b=!0;break;case i:b=!0}var x="undefined"!==typeof OffscreenCanvas,w=x?new OffscreenCanvas(v.width,v.height):document.createElement("canvas");w.width=v.width,w.height=v.height;var S=w.getContext("2d"),M=S.createImageData(v.width,v.height),_=function(e,t,r,n,i){var o,a,s,l;if(a=r.pixel_size>>3,s=r.width*r.height*a,t&&(l=i.subarray(n,n+=r.colormap_length*(r.colormap_size>>3))),e){var u,c,h;o=new Uint8Array(s);for(var p=0,f=new Uint8Array(a);p<s;)if(c=1+(127&(u=i[n++])),128&u){for(h=0;h<a;++h)f[h]=i[n++];for(h=0;h<c;++h)o.set(f,p+h*a);p+=a*c}else{for(c*=a,h=0;h<c;++h)o[p+h]=i[n++];p+=c}}else o=i.subarray(n,n+=t?r.width*r.height:s);return{pixel_data:o,palettes:l}}(g,y,v,m,d);!function(e,t,r,n,i){var o,a,s,d,m,g;switch((v.flags&l)>>u){default:case p:o=0,s=1,m=t,a=0,d=1,g=r;break;case c:o=0,s=1,m=t,a=r-1,d=-1,g=-1;break;case f:o=t-1,s=-1,m=-1,a=0,d=1,g=r;break;case h:o=t-1,s=-1,m=-1,a=r-1,d=-1,g=-1}if(b)switch(v.pixel_size){case 8:!function(e,t,r,n,i,o,a,s){var l,u,c,h=0,p=v.width;for(c=t;c!==n;c+=r)for(u=i;u!==a;u+=o,h++)l=s[h],e[4*(u+p*c)+0]=l,e[4*(u+p*c)+1]=l,e[4*(u+p*c)+2]=l,e[4*(u+p*c)+3]=255}(e,a,d,g,o,s,m,n);break;case 16:!function(e,t,r,n,i,o,a,s){var l,u,c=0,h=v.width;for(u=t;u!==n;u+=r)for(l=i;l!==a;l+=o,c+=2)e[4*(l+h*u)+0]=s[c+0],e[4*(l+h*u)+1]=s[c+0],e[4*(l+h*u)+2]=s[c+0],e[4*(l+h*u)+3]=s[c+1]}(e,a,d,g,o,s,m,n);break;default:console.error("TGALoader: Format not supported.")}else switch(v.pixel_size){case 8:!function(e,t,r,n,i,o,a,s,l){var u,c,h,p=l,f=0,d=v.width;for(h=t;h!==n;h+=r)for(c=i;c!==a;c+=o,f++)u=s[f],e[4*(c+d*h)+3]=255,e[4*(c+d*h)+2]=p[3*u+0],e[4*(c+d*h)+1]=p[3*u+1],e[4*(c+d*h)+0]=p[3*u+2]}(e,a,d,g,o,s,m,n,i);break;case 16:!function(e,t,r,n,i,o,a,s){var l,u,c,h=0,p=v.width;for(c=t;c!==n;c+=r)for(u=i;u!==a;u+=o,h+=2)l=s[h+0]+(s[h+1]<<8),e[4*(u+p*c)+0]=(31744&l)>>7,e[4*(u+p*c)+1]=(992&l)>>2,e[4*(u+p*c)+2]=(31&l)>>3,e[4*(u+p*c)+3]=32768&l?0:255}(e,a,d,g,o,s,m,n);break;case 24:!function(e,t,r,n,i,o,a,s){var l,u,c=0,h=v.width;for(u=t;u!==n;u+=r)for(l=i;l!==a;l+=o,c+=3)e[4*(l+h*u)+3]=255,e[4*(l+h*u)+2]=s[c+0],e[4*(l+h*u)+1]=s[c+1],e[4*(l+h*u)+0]=s[c+2]}(e,a,d,g,o,s,m,n);break;case 32:!function(e,t,r,n,i,o,a,s){var l,u,c=0,h=v.width;for(u=t;u!==n;u+=r)for(l=i;l!==a;l+=o,c+=4)e[4*(l+h*u)+2]=s[c+0],e[4*(l+h*u)+1]=s[c+1],e[4*(l+h*u)+0]=s[c+2],e[4*(l+h*u)+3]=s[c+3]}(e,a,d,g,o,s,m,n);break;default:console.error("TGALoader: Format not supported.")}}(M.data,v.width,v.height,_.pixel_data,_.palettes);return S.putImageData(M,0,0),x?w.transferToImageBitmap():w},setPath:function(e){return this.path=e,this}};var ColladaLoader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager};function CompressedTexture(e,t,r,n,i,o,a,s,l,u,c,h){Texture.call(this,null,o,a,s,l,u,n,i,c,h),this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function CompressedTextureLoader(e){this.manager=void 0!==e?e:DefaultLoadingManager,this._parser=null}ColladaLoader.prototype={constructor:ColladaLoader,crossOrigin:"anonymous",load:function(e,t,r,n){var i=this,o=void 0===i.path?LoaderUtils.extractUrlBase(e):i.path,a=new FileLoader(i.manager);a.setPath(i.path),a.load(e,function(e){t(i.parse(e,o))},r,n)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},options:{set convertUpAxis(e){console.warn("ColladaLoader: options.convertUpAxis() has been removed. Up axis is converted automatically.")}},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,t){function r(e,t){for(var r=[],n=e.childNodes,i=0,o=n.length;i<o;i++){var a=n[i];a.nodeName===t&&r.push(a)}return r}function n(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),r=new Array(t.length),n=0,i=t.length;n<i;n++)r[n]=t[n];return r}function i(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),r=new Array(t.length),n=0,i=t.length;n<i;n++)r[n]=parseFloat(t[n]);return r}function o(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),r=new Array(t.length),n=0,i=t.length;n<i;n++)r[n]=parseInt(t[n]);return r}function a(e){return e.substring(1)}function s(e){return 0===Object.keys(e).length}function l(e){return void 0!==e&&!0===e.hasAttribute("meter")?parseFloat(e.getAttribute("meter")):1}function u(e){return void 0!==e?e.textContent:"Y_UP"}function c(e,t,n,i){var o=r(e,t)[0];if(void 0!==o)for(var a=r(o,n),s=0;s<a.length;s++)i(a[s])}function h(e,t){for(var r in e){e[r].build=t(e[r])}}function p(e,t){return void 0!==e.build?e.build:(e.build=t(e),e.build)}function f(e){for(var t={inputs:{}},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"input":var o=a(i.getAttribute("source")),s=i.getAttribute("semantic");t.inputs[s]=o}}return t}function d(e){var t={},r=e.getAttribute("target").split("/"),n=r.shift(),i=r.shift(),o=-1!==i.indexOf("("),s=-1!==i.indexOf(".");if(s)r=i.split("."),i=r.shift(),t.member=r.shift();else if(o){var l=i.split("(");i=l.shift();for(var u=0;u<l.length;u++)l[u]=parseInt(l[u].replace(/\)/,""));t.indices=l}return t.id=n,t.sid=i,t.arraySyntax=o,t.memberSyntax=s,t.sampler=a(e.getAttribute("source")),t}function m(e){var t=[],r=e.channels,n=e.samplers,i=e.sources;for(var o in r)if(r.hasOwnProperty(o)){var a=r[o],s=n[a.sampler],l=s.inputs.INPUT,u=s.inputs.OUTPUT;w(g(a,i[l],i[u]),t)}return t}function v(e){return p(Xe.animations[e],m)}function g(e,t,r){var n,i,o,a,s,l,u=Xe.nodes[e.id],c=Fe(u.id),h=u.transforms[e.sid],p=u.matrix.clone().transpose(),f={};switch(h){case"matrix":for(o=0,a=t.array.length;o<a;o++)if(n=t.array[o],i=o*r.stride,void 0===f[n]&&(f[n]={}),!0===e.arraySyntax){var d=r.array[i],m=e.indices[0]+4*e.indices[1];f[n][m]=d}else for(s=0,l=r.stride;s<l;s++)f[n][s]=r.array[i+s];break;case"translate":case"rotate":case"scale":console.warn('ColladaLoader: Animation transform type "%s" not yet implemented.',h)}var v=function(e,t){var r=[];for(var n in e)r.push({time:parseFloat(n),value:e[n]});r.sort(function(e,t){return e.time-t.time});for(var i=0;i<16;i++)S(r,i,t.elements[i]);return r}(f,p);return{name:c.uuid,keyframes:v}}var y=new Vector3,b=new Vector3,x=new Quaternion;function w(e,t){for(var r=e.keyframes,n=e.name,i=[],o=[],a=[],s=[],l=0,u=r.length;l<u;l++){var c=r[l],h=c.time,p=c.value;_e.fromArray(p).transpose(),_e.decompose(y,x,b),i.push(h),o.push(y.x,y.y,y.z),a.push(x.x,x.y,x.z,x.w),s.push(b.x,b.y,b.z)}return o.length>0&&t.push(new VectorKeyframeTrack(n+".position",i,o)),a.length>0&&t.push(new QuaternionKeyframeTrack(n+".quaternion",i,a)),s.length>0&&t.push(new VectorKeyframeTrack(n+".scale",i,s)),t}function S(e,t,r){var n,i,o,a=!0;for(i=0,o=e.length;i<o;i++)void 0===(n=e[i]).value[t]?n.value[t]=null:a=!1;if(!0===a)for(i=0,o=e.length;i<o;i++)(n=e[i]).value[t]=r;else!function(e,t){for(var r,n,i=0,o=e.length;i<o;i++){var a=e[i];if(null===a.value[t]){if(r=M(e,i,t),n=_(e,i,t),null===r){a.value[t]=n.value[t];continue}if(null===n){a.value[t]=r.value[t];continue}T(a,r,n,t)}}}(e,t)}function M(e,t,r){for(;t>=0;){var n=e[t];if(null!==n.value[r])return n;t--}return null}function _(e,t,r){for(;t<e.length;){var n=e[t];if(null!==n.value[r])return n;t++}return null}function T(e,t,r,n){r.time-t.time!==0?e.value[n]=(e.time-t.time)*(r.value[n]-t.value[n])/(r.time-t.time)+t.value[n]:e.value[n]=t.value[n]}function A(e){for(var t=[],r=e.name,n=e.end-e.start||-1,i=e.animations,o=0,a=i.length;o<a;o++)for(var s=v(i[o]),l=0,u=s.length;l<u;l++)t.push(s[l]);return new AnimationClip(r,n,t)}function C(e){return p(Xe.clips[e],A)}function E(e){for(var t={sources:{}},r=0,n=e.childNodes.length;r<n;r++){var o=e.childNodes[r];if(1===o.nodeType)switch(o.nodeName){case"bind_shape_matrix":t.bindShapeMatrix=i(o.textContent);break;case"source":var a=o.getAttribute("id");t.sources[a]=ie(o);break;case"joints":t.joints=L(o);break;case"vertex_weights":t.vertexWeights=N(o)}}return t}function L(e){for(var t={inputs:{}},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"input":var o=i.getAttribute("semantic"),s=a(i.getAttribute("source"));t.inputs[o]=s}}return t}function N(e){for(var t={inputs:{}},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"input":var s=i.getAttribute("semantic"),l=a(i.getAttribute("source")),u=parseInt(i.getAttribute("offset"));t.inputs[s]={id:l,offset:u};break;case"vcount":t.vcount=o(i.textContent);break;case"v":t.v=o(i.textContent)}}return t}function P(e){var t={id:e.id},r=Xe.geometries[t.id];return void 0!==e.skin&&(t.skin=function(e){var t,r,n,i={joints:[],indices:{array:[],stride:4},weights:{array:[],stride:4}},o=e.sources,a=e.vertexWeights,s=a.vcount,l=a.v,u=a.inputs.JOINT.offset,c=a.inputs.WEIGHT.offset,h=e.sources[e.joints.inputs.JOINT],p=e.sources[e.joints.inputs.INV_BIND_MATRIX],f=o[a.inputs.WEIGHT.id].array,d=0;for(t=0,n=s.length;t<n;t++){var m=s[t],v=[];for(r=0;r<m;r++){var g=l[d+u],y=l[d+c],b=f[y];v.push({index:g,weight:b}),d+=2}for(v.sort(M),r=0;r<4;r++){var x=v[r];void 0!==x?(i.indices.array.push(x.index),i.weights.array.push(x.weight)):(i.indices.array.push(0),i.weights.array.push(0))}}e.bindShapeMatrix?i.bindMatrix=(new Matrix4).fromArray(e.bindShapeMatrix).transpose():i.bindMatrix=(new Matrix4).identity();for(t=0,n=h.array.length;t<n;t++){var w=h.array[t],S=(new Matrix4).fromArray(p.array,t*p.stride).transpose();i.joints.push({name:w,boneInverse:S})}return i;function M(e,t){return t.weight-e.weight}}(e.skin),r.sources.skinIndices=t.skin.indices,r.sources.skinWeights=t.skin.weights),t}function O(e){return void 0!==e.build?e.build:e.init_from}function R(e){var t=Xe.images[e];return void 0!==t?p(t,O):(console.warn("ColladaLoader: Couldn't find image with ID:",e),null)}function D(e){for(var t={surfaces:{},samplers:{}},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"newparam":F(i,t);break;case"technique":t.technique=B(i);break;case"extra":t.extra=W(i)}}return t}function F(e,t){for(var r=e.getAttribute("sid"),n=0,i=e.childNodes.length;n<i;n++){var o=e.childNodes[n];if(1===o.nodeType)switch(o.nodeName){case"surface":t.surfaces[r]=k(o);break;case"sampler2D":t.samplers[r]=I(o)}}}function k(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"init_from":t.init_from=i.textContent}}return t}function I(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"source":t.source=i.textContent}}return t}function B(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"constant":case"lambert":case"blinn":case"phong":t.type=i.nodeName,t.parameters=U(i)}}return t}function U(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":t[i.nodeName]=V(i);break;case"transparent":t[i.nodeName]={opaque:i.getAttribute("opaque"),data:V(i)}}}return t}function V(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var o=e.childNodes[r];if(1===o.nodeType)switch(o.nodeName){case"color":t[o.nodeName]=i(o.textContent);break;case"float":t[o.nodeName]=parseFloat(o.textContent);break;case"texture":t[o.nodeName]={id:o.getAttribute("texture"),extra:j(o)}}}return t}function j(e){for(var t={technique:{}},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"extra":z(i,t)}}return t}function z(e,t){for(var r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"technique":G(i,t)}}}function G(e,t){for(var r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":t.technique[i.nodeName]=parseFloat(i.textContent);break;case"wrapU":case"wrapV":"TRUE"===i.textContent.toUpperCase()?t.technique[i.nodeName]=1:"FALSE"===i.textContent.toUpperCase()?t.technique[i.nodeName]=0:t.technique[i.nodeName]=parseInt(i.textContent)}}}function W(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"technique":t.technique=H(i)}}return t}function H(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"double_sided":t[i.nodeName]=parseInt(i.textContent)}}return t}function X(e){return e}function q(e){var t,r,n=(t=e.url,p(Xe.effects[t],X)),i=n.profile.technique,o=n.profile.extra;switch(i.type){case"phong":case"blinn":r=new MeshPhongMaterial;break;case"lambert":r=new MeshLambertMaterial;break;default:r=new MeshBasicMaterial}function a(e){var t=n.profile.samplers[e.id],r=null;void 0!==t?r=R(n.profile.surfaces[t.source].init_from):(console.warn("ColladaLoader: Undefined sampler. Access image directly (see #12530)."),r=R(e.id));if(null!==r){var i=function(e){var t,r=e.slice(2+(e.lastIndexOf(".")-1>>>0));switch(r=r.toLowerCase()){case"tga":t=Ve;break;default:t=ze}return t}(r);if(void 0!==i){var o=i.load(r),a=e.extra;if(void 0!==a&&void 0!==a.technique&&!1===s(a.technique)){var l=a.technique;o.wrapS=l.wrapU?RepeatWrapping:ClampToEdgeWrapping,o.wrapT=l.wrapV?RepeatWrapping:ClampToEdgeWrapping,o.offset.set(l.offsetU||0,l.offsetV||0),o.repeat.set(l.repeatU||1,l.repeatV||1)}else o.wrapS=RepeatWrapping,o.wrapT=RepeatWrapping;return o}return console.warn("ColladaLoader: Loader for texture %s not found.",r),null}return console.warn("ColladaLoader: Couldn't create texture with ID:",e.id),null}r.name=e.name||"";var l=i.parameters;for(var u in l){var c=l[u];switch(u){case"diffuse":c.color&&r.color.fromArray(c.color),c.texture&&(r.map=a(c.texture));break;case"specular":c.color&&r.specular&&r.specular.fromArray(c.color),c.texture&&(r.specularMap=a(c.texture));break;case"bump":c.texture&&(r.normalMap=a(c.texture));break;case"ambient":c.texture&&(r.lightMap=a(c.texture));break;case"shininess":c.float&&r.shininess&&(r.shininess=c.float);break;case"emission":c.color&&r.emissive&&r.emissive.fromArray(c.color),c.texture&&(r.emissiveMap=a(c.texture))}}var h=l.transparent,f=l.transparency;if(void 0===f&&h&&(f={float:1}),void 0===h&&f&&(h={opaque:"A_ONE",data:{color:[1,1,1,1]}}),h&&f)if(h.data.texture)r.transparent=!0;else{var d=h.data.color;switch(h.opaque){case"A_ONE":r.opacity=d[3]*f.float;break;case"RGB_ZERO":r.opacity=1-d[0]*f.float;break;case"A_ZERO":r.opacity=1-d[3]*f.float;break;case"RGB_ONE":r.opacity=d[0]*f.float;break;default:console.warn('ColladaLoader: Invalid opaque type "%s" of transparent tag.',h.opaque)}r.opacity<1&&(r.transparent=!0)}return void 0!==o&&void 0!==o.technique&&1===o.technique.double_sided&&(r.side=DoubleSide),r}function Y(e){return p(Xe.materials[e],q)}function K(e){for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];switch(r.nodeName){case"technique_common":return Q(r)}}return{}}function Q(e){for(var t={},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];switch(n.nodeName){case"perspective":case"orthographic":t.technique=n.nodeName,t.parameters=J(n)}}return t}function J(e){for(var t={},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];switch(n.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":t[n.nodeName]=parseFloat(n.textContent)}}return t}function Z(e){var t;switch(e.optics.technique){case"perspective":t=new PerspectiveCamera(e.optics.parameters.yfov,e.optics.parameters.aspect_ratio,e.optics.parameters.znear,e.optics.parameters.zfar);break;case"orthographic":var r=e.optics.parameters.ymag,n=e.optics.parameters.xmag,i=e.optics.parameters.aspect_ratio;n=void 0===n?r*i:n,r=void 0===r?n/i:r,t=new OrthographicCamera(-(n*=.5),n,r*=.5,-r,e.optics.parameters.znear,e.optics.parameters.zfar);break;default:t=new PerspectiveCamera}return t.name=e.name||"",t}function $(e){var t=Xe.cameras[e];return void 0!==t?p(t,Z):(console.warn("ColladaLoader: Couldn't find camera with ID:",e),null)}function ee(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"directional":case"point":case"spot":case"ambient":t.technique=i.nodeName,t.parameters=te(i)}}return t}function te(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var o=e.childNodes[r];if(1===o.nodeType)switch(o.nodeName){case"color":var a=i(o.textContent);t.color=(new Color).fromArray(a);break;case"falloff_angle":t.falloffAngle=parseFloat(o.textContent);break;case"quadratic_attenuation":var s=parseFloat(o.textContent);t.distance=s?Math.sqrt(1/s):0}}return t}function re(e){var t;switch(e.technique){case"directional":t=new DirectionalLight;break;case"point":t=new PointLight;break;case"spot":t=new SpotLight;break;case"ambient":t=new AmbientLight}return e.parameters.color&&t.color.copy(e.parameters.color),e.parameters.distance&&(t.distance=e.parameters.distance),t}function ne(e){var t=Xe.lights[e];return void 0!==t?p(t,re):(console.warn("ColladaLoader: Couldn't find light with ID:",e),null)}function ie(e){for(var t={array:[],stride:3},o=0;o<e.childNodes.length;o++){var a=e.childNodes[o];if(1===a.nodeType)switch(a.nodeName){case"float_array":t.array=i(a.textContent);break;case"Name_array":t.array=n(a.textContent);break;case"technique_common":var s=r(a,"accessor")[0];void 0!==s&&(t.stride=parseInt(s.getAttribute("stride")))}}return t}function oe(e){for(var t={},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];1===n.nodeType&&(t[n.getAttribute("semantic")]=a(n.getAttribute("source")))}return t}function ae(e){for(var t={type:e.nodeName,material:e.getAttribute("material"),count:parseInt(e.getAttribute("count")),inputs:{},stride:0,hasUV:!1},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"input":var s=a(i.getAttribute("source")),l=i.getAttribute("semantic"),u=parseInt(i.getAttribute("offset")),c=parseInt(i.getAttribute("set")),h=c>0?l+c:l;t.inputs[h]={id:s,offset:u},t.stride=Math.max(t.stride,u+1),"TEXCOORD"===l&&(t.hasUV=!0);break;case"vcount":t.vcount=o(i.textContent);break;case"p":t.p=o(i.textContent)}}return t}function se(e){for(var t=0,r=0,n=e.length;r<n;r++){!0===e[r].hasUV&&t++}t>0&&t<e.length&&(e.uvsNeedsFix=!0)}function le(e){var t={},r=e.sources,n=e.vertices,i=e.primitives;if(0===i.length)return{};var o=function(e){for(var t={},r=0;r<e.length;r++){var n=e[r];void 0===t[n.type]&&(t[n.type]=[]),t[n.type].push(n)}return t}(i);for(var a in o){var s=o[a];se(s),t[a]=ue(s,r,n)}return t}function ue(e,t,r){for(var n={},i={array:[],stride:0},o={array:[],stride:0},a={array:[],stride:0},s={array:[],stride:0},l={array:[],stride:0},u=[],c=4,h=[],p=4,f=new BufferGeometry,d=[],m=0,v=0;v<e.length;v++){var g=e[v],y=g.inputs,b=0;switch(g.type){case"lines":case"linestrips":b=2*g.count;break;case"triangles":b=3*g.count;break;case"polylist":for(var x=0;x<g.count;x++){var w=g.vcount[x];switch(w){case 3:b+=3;break;case 4:b+=6;break;default:b+=3*(w-2)}}break;default:console.warn("ColladaLoader: Unknow primitive type:",g.type)}for(var S in f.addGroup(m,b,v),m+=b,g.material&&d.push(g.material),y){var M=y[S];switch(S){case"VERTEX":for(var _ in r){var T=r[_];switch(_){case"POSITION":var A=i.array.length;if(ce(g,t[T],M.offset,i.array),i.stride=t[T].stride,t.skinWeights&&t.skinIndices&&(ce(g,t.skinIndices,M.offset,u),ce(g,t.skinWeights,M.offset,h)),!1===g.hasUV&&!0===e.uvsNeedsFix){b=(i.array.length-A)/i.stride;for(var C=0;C<b;C++)a.array.push(0,0)}break;case"NORMAL":ce(g,t[T],M.offset,o.array),o.stride=t[T].stride;break;case"COLOR":ce(g,t[T],M.offset,l.array),l.stride=t[T].stride;break;case"TEXCOORD":ce(g,t[T],M.offset,a.array),a.stride=t[T].stride;break;case"TEXCOORD1":ce(g,t[T],M.offset,s.array),a.stride=t[T].stride;break;default:console.warn('ColladaLoader: Semantic "%s" not handled in geometry build process.',_)}}break;case"NORMAL":ce(g,t[M.id],M.offset,o.array),o.stride=t[M.id].stride;break;case"COLOR":ce(g,t[M.id],M.offset,l.array),l.stride=t[M.id].stride;break;case"TEXCOORD":ce(g,t[M.id],M.offset,a.array),a.stride=t[M.id].stride;break;case"TEXCOORD1":ce(g,t[M.id],M.offset,s.array),s.stride=t[M.id].stride}}}return i.array.length>0&&f.addAttribute("position",new Float32BufferAttribute(i.array,i.stride)),o.array.length>0&&f.addAttribute("normal",new Float32BufferAttribute(o.array,o.stride)),l.array.length>0&&f.addAttribute("color",new Float32BufferAttribute(l.array,l.stride)),a.array.length>0&&f.addAttribute("uv",new Float32BufferAttribute(a.array,a.stride)),s.array.length>0&&f.addAttribute("uv2",new Float32BufferAttribute(s.array,s.stride)),u.length>0&&f.addAttribute("skinIndex",new Float32BufferAttribute(u,c)),h.length>0&&f.addAttribute("skinWeight",new Float32BufferAttribute(h,p)),n.data=f,n.type=e[0].type,n.materialKeys=d,n}function ce(e,t,r,n){var i=e.p,o=e.stride,a=e.vcount;function s(e){for(var t=i[e+r]*u,o=t+u;t<o;t++)n.push(l[t])}var l=t.array,u=t.stride;if(void 0!==e.vcount)for(var c=0,h=0,p=a.length;h<p;h++){var f=a[h];if(4===f){var d=c+1*o,m=c+2*o,v=c+3*o;s(c+0*o),s(d),s(v),s(d),s(m),s(v)}else if(3===f){d=c+1*o,m=c+2*o;s(c+0*o),s(d),s(m)}else if(f>4)for(var g=1,y=f-2;g<=y;g++){d=c+o*g,m=c+o*(g+1);s(c+0*o),s(d),s(m)}c+=o*f}else for(h=0,p=i.length;h<p;h+=o)s(h)}function he(e){return p(Xe.geometries[e],le)}function pe(e){return void 0!==e.build?e.build:e}function fe(e,t){for(var r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"joint":t.joints[n.getAttribute("sid")]=de(n);break;case"link":t.links.push(ve(n))}}}function de(e){for(var t,r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"prismatic":case"revolute":t=me(n)}}return t}function me(e,t){t={sid:e.getAttribute("sid"),name:e.getAttribute("name")||"",axis:new Vector3,limits:{min:0,max:0},type:e.nodeName,static:!1,zeroPosition:0,middlePosition:0};for(var r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"axis":var o=i(n.textContent);t.axis.fromArray(o);break;case"limits":var a=n.getElementsByTagName("max")[0],s=n.getElementsByTagName("min")[0];t.limits.max=parseFloat(a.textContent),t.limits.min=parseFloat(s.textContent)}}return t.limits.min>=t.limits.max&&(t.static=!0),t.middlePosition=(t.limits.min+t.limits.max)/2,t}function ve(e){for(var t={sid:e.getAttribute("sid"),name:e.getAttribute("name")||"",attachments:[],transforms:[]},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"attachment_full":t.attachments.push(ge(n));break;case"matrix":case"translate":case"rotate":t.transforms.push(ye(n))}}return t}function ge(e){for(var t={joint:e.getAttribute("joint").split("/").pop(),transforms:[],links:[]},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"link":t.links.push(ve(n));break;case"matrix":case"translate":case"rotate":t.transforms.push(ye(n))}}return t}function ye(e){var t={type:e.nodeName},r=i(e.textContent);switch(t.type){case"matrix":t.obj=new Matrix4,t.obj.fromArray(r).transpose();break;case"translate":t.obj=new Vector3,t.obj.fromArray(r);break;case"rotate":t.obj=new Vector3,t.obj.fromArray(r),t.angle=_Math.degToRad(r[3])}return t}function be(e,t){for(var r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"technique_common":xe(n,t)}}}function xe(e,t){for(var r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"inertia":t.inertia=i(n.textContent);break;case"mass":t.mass=i(n.textContent)[0]}}}function we(e){for(var t={target:e.getAttribute("target").split("/").pop()},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"axis":var i=n.getElementsByTagName("param")[0];t.axis=i.textContent;var o=t.axis.split("inst_").pop().split("axis")[0];t.jointIndex=o.substr(0,o.length-1)}}return t}function Se(e){return void 0!==e.build?e.build:e}function Me(e){for(var t=[],r=Be.querySelector('[id="'+e.id+'"]'),n=0;n<r.childNodes.length;n++){var o=r.childNodes[n];if(1===o.nodeType)switch(o.nodeName){case"matrix":var a=i(o.textContent),s=(new Matrix4).fromArray(a).transpose();t.push({sid:o.getAttribute("sid"),type:o.nodeName,obj:s});break;case"translate":case"scale":a=i(o.textContent);var l=(new Vector3).fromArray(a);t.push({sid:o.getAttribute("sid"),type:o.nodeName,obj:l});break;case"rotate":a=i(o.textContent),l=(new Vector3).fromArray(a);var u=_Math.degToRad(a[3]);t.push({sid:o.getAttribute("sid"),type:o.nodeName,obj:l,angle:u})}}return t}var _e=new Matrix4,Te=new Vector3;function Ae(e){for(var t={name:e.getAttribute("name")||"",type:e.getAttribute("type"),id:e.getAttribute("id"),sid:e.getAttribute("sid"),matrix:new Matrix4,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"node":t.nodes.push(n.getAttribute("id")),Ae(n);break;case"instance_camera":t.instanceCameras.push(a(n.getAttribute("url")));break;case"instance_controller":t.instanceControllers.push(Ce(n));break;case"instance_light":t.instanceLights.push(a(n.getAttribute("url")));break;case"instance_geometry":t.instanceGeometries.push(Ce(n));break;case"instance_node":t.instanceNodes.push(a(n.getAttribute("url")));break;case"matrix":var o=i(n.textContent);t.matrix.multiply(_e.fromArray(o).transpose()),t.transforms[n.getAttribute("sid")]=n.nodeName;break;case"translate":o=i(n.textContent);Te.fromArray(o),t.matrix.multiply(_e.makeTranslation(Te.x,Te.y,Te.z)),t.transforms[n.getAttribute("sid")]=n.nodeName;break;case"rotate":o=i(n.textContent);var s=_Math.degToRad(o[3]);t.matrix.multiply(_e.makeRotationAxis(Te.fromArray(o),s)),t.transforms[n.getAttribute("sid")]=n.nodeName;break;case"scale":o=i(n.textContent);t.matrix.scale(Te.fromArray(o)),t.transforms[n.getAttribute("sid")]=n.nodeName;break;case"extra":break;default:console.log(n)}}return De(t.id)?console.warn("ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",t.id):Xe.nodes[t.id]=t,t}function Ce(e){for(var t={id:a(e.getAttribute("url")),materials:{},skeletons:[]},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];switch(n.nodeName){case"bind_material":for(var i=n.getElementsByTagName("instance_material"),o=0;o<i.length;o++){var s=i[o],l=s.getAttribute("symbol"),u=s.getAttribute("target");t.materials[l]=a(u)}break;case"skeleton":t.skeletons.push(a(n.textContent))}}return t}function Ee(e,t){var r,n,i,o=[],a=[];for(r=0;r<e.length;r++){var s=e[r];if(De(s))Le(Fe(s),t,o);else if(i=s,void 0!==Xe.visualScenes[i])for(var l=Xe.visualScenes[s].children,u=0;u<l.length;u++){var c=l[u];if("JOINT"===c.type)Le(Fe(c.id),t,o)}else console.error("ColladaLoader: Unable to find root bone of skeleton with ID:",s)}for(r=0;r<t.length;r++)for(u=0;u<o.length;u++)if((n=o[u]).bone.name===t[r].name){a[r]=n,n.processed=!0;break}for(r=0;r<o.length;r++)!1===(n=o[r]).processed&&(a.push(n),n.processed=!0);var h=[],p=[];for(r=0;r<a.length;r++)n=a[r],h.push(n.bone),p.push(n.boneInverse);return new Skeleton(h,p)}function Le(e,t,r){e.traverse(function(e){if(!0===e.isBone){for(var n,i=0;i<t.length;i++){var o=t[i];if(o.name===e.name){n=o.boneInverse;break}}void 0===n&&(n=new Matrix4),r.push({bone:e,boneInverse:n,processed:!1})}})}function Ne(e){for(var t,r=[],n=e.matrix,i=e.nodes,o=e.type,a=e.instanceCameras,s=e.instanceControllers,l=e.instanceLights,u=e.instanceGeometries,c=e.instanceNodes,h=0,f=i.length;h<f;h++)r.push(Fe(i[h]));for(h=0,f=a.length;h<f;h++){var d=$(a[h]);null!==d&&r.push(d.clone())}for(h=0,f=s.length;h<f;h++)for(var m=s[h],v=(t=m.id,p(Xe.controllers[t],P)),g=Re(he(v.id),m.materials),y=Ee(m.skeletons,v.skin.joints),b=0,x=g.length;b<x;b++){var w;(w=g[b]).isSkinnedMesh&&(w.bind(y,v.skin.bindMatrix),w.normalizeSkinWeights()),r.push(w)}for(h=0,f=l.length;h<f;h++){var S=ne(l[h]);null!==S&&r.push(S.clone())}for(h=0,f=u.length;h<f;h++)for(b=0,x=(g=Re(he((m=u[h]).id),m.materials)).length;b<x;b++)r.push(g[b]);for(h=0,f=c.length;h<f;h++)r.push(Fe(c[h]).clone());if(0===i.length&&1===r.length)w=r[0];else{w="JOINT"===o?new Bone:new Group;for(h=0;h<r.length;h++)w.add(r[h])}return""===w.name&&(w.name="JOINT"===o?e.sid:e.name),w.matrix.copy(n),w.matrix.decompose(w.position,w.quaternion,w.scale),w}var Pe=new MeshBasicMaterial({color:16711935});function Oe(e,t){for(var r=[],n=0,i=e.length;n<i;n++){var o=t[e[n]];void 0===o?(console.warn("ColladaLoader: Material with key %s not found. Apply fallback material.",e[n]),r.push(Pe)):r.push(Y(o))}return r}function Re(e,t){var r=[];for(var n in e){var i=e[n],o=Oe(i.materialKeys,t);0===o.length&&("lines"===n||"linestrips"===n?o.push(new LineBasicMaterial):o.push(new MeshPhongMaterial));var a=void 0!==i.data.attributes.skinIndex;if(a)for(var s=0,l=o.length;s<l;s++)o[s].skinning=!0;var u,c=1===o.length?o[0]:o;switch(n){case"lines":u=new LineSegments(i.data,c);break;case"linestrips":u=new Line(i.data,c);break;case"triangles":case"polylist":u=a?new SkinnedMesh(i.data,c):new Mesh(i.data,c)}r.push(u)}return r}function De(e){return void 0!==Xe.nodes[e]}function Fe(e){return p(Xe.nodes[e],Ne)}function ke(e){var t=new Group;t.name=e.name;for(var r=e.children,n=0;n<r.length;n++){var i=r[n];t.add(Fe(i.id))}return t}function Ie(e){return p(Xe.visualScenes[e],ke)}if(0===e.length)return{scene:new Scene};var Be=r((new DOMParser).parseFromString(e,"application/xml"),"COLLADA")[0],Ue=Be.getAttribute("version");console.log("ColladaLoader: File version",Ue);var Ve,je=function(e){return{unit:l(r(e,"unit")[0]),upAxis:u(r(e,"up_axis")[0])}}(r(Be,"asset")[0]),ze=new TextureLoader(this.manager);ze.setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin),TGALoader&&(Ve=new TGALoader(this.manager)).setPath(this.resourcePath||t);var Ge=[],We={},He=0,Xe={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};c(Be,"library_animations","animation",function(e){for(var t={sources:{},samplers:{},channels:{}},r=0,n=e.childNodes.length;r<n;r++){var i,o=e.childNodes[r];if(1===o.nodeType)switch(o.nodeName){case"source":i=o.getAttribute("id"),t.sources[i]=ie(o);break;case"sampler":i=o.getAttribute("id"),t.samplers[i]=f(o);break;case"channel":i=o.getAttribute("target"),t.channels[i]=d(o);break;default:console.log(o)}}Xe.animations[e.getAttribute("id")]=t}),c(Be,"library_animation_clips","animation_clip",function(e){for(var t={name:e.getAttribute("id")||"default",start:parseFloat(e.getAttribute("start")||0),end:parseFloat(e.getAttribute("end")||0),animations:[]},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"instance_animation":t.animations.push(a(i.getAttribute("url")))}}Xe.clips[e.getAttribute("id")]=t}),c(Be,"library_controllers","controller",function(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"skin":t.id=a(i.getAttribute("source")),t.skin=E(i);break;case"morph":t.id=a(i.getAttribute("source")),console.warn("ColladaLoader: Morph target animation not supported yet.")}}Xe.controllers[e.getAttribute("id")]=t}),c(Be,"library_images","image",function(e){var t={init_from:r(e,"init_from")[0].textContent};Xe.images[e.getAttribute("id")]=t}),c(Be,"library_effects","effect",function(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"profile_COMMON":t.profile=D(i)}}Xe.effects[e.getAttribute("id")]=t}),c(Be,"library_materials","material",function(e){for(var t={name:e.getAttribute("name")},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"instance_effect":t.url=a(i.getAttribute("url"))}}Xe.materials[e.getAttribute("id")]=t}),c(Be,"library_cameras","camera",function(e){for(var t={name:e.getAttribute("name")},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"optics":t.optics=K(i)}}Xe.cameras[e.getAttribute("id")]=t}),c(Be,"library_lights","light",function(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"technique_common":t=ee(i)}}Xe.lights[e.getAttribute("id")]=t}),c(Be,"library_geometries","geometry",function(e){var t={name:e.getAttribute("name"),sources:{},vertices:{},primitives:[]},n=r(e,"mesh")[0];if(void 0!==n){for(var i=0;i<n.childNodes.length;i++){var o=n.childNodes[i];if(1===o.nodeType){var a=o.getAttribute("id");switch(o.nodeName){case"source":t.sources[a]=ie(o);break;case"vertices":t.vertices=oe(o);break;case"polygons":console.warn("ColladaLoader: Unsupported primitive type: ",o.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":t.primitives.push(ae(o));break;default:console.log(o)}}}Xe.geometries[e.getAttribute("id")]=t}}),c(Be,"library_nodes","node",Ae),c(Be,"library_visual_scenes","visual_scene",function(e){var t={name:e.getAttribute("name"),children:[]};!function(e){for(var t=e.getElementsByTagName("node"),r=0;r<t.length;r++){var n=t[r];!1===n.hasAttribute("id")&&n.setAttribute("id","three_default_"+He++)}}(e);for(var n=r(e,"node"),i=0;i<n.length;i++)t.children.push(Ae(n[i]));Xe.visualScenes[e.getAttribute("id")]=t}),c(Be,"library_kinematics_models","kinematics_model",function(e){for(var t={name:e.getAttribute("name")||"",joints:{},links:[]},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"technique_common":fe(n,t)}}Xe.kinematicsModels[e.getAttribute("id")]=t}),c(Be,"library_physics_models","physics_model",function(e){for(var t={name:e.getAttribute("name")||"",rigidBodies:{}},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"rigid_body":t.rigidBodies[n.getAttribute("name")]={},be(n,t.rigidBodies[n.getAttribute("name")])}}Xe.physicsModels[e.getAttribute("id")]=t}),c(Be,"scene","instance_kinematics_scene",function(e){for(var t={bindJointAxis:[]},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"bind_joint_axis":t.bindJointAxis.push(we(n))}}Xe.kinematicsScenes[a(e.getAttribute("url"))]=t}),h(Xe.animations,m),h(Xe.clips,A),h(Xe.controllers,P),h(Xe.images,O),h(Xe.effects,X),h(Xe.materials,q),h(Xe.cameras,Z),h(Xe.lights,re),h(Xe.geometries,le),h(Xe.visualScenes,ke),function(){var e=Xe.clips;if(!0===s(e)){if(!1===s(Xe.animations)){var t=[];for(var r in Xe.animations)for(var n=v(r),i=0,o=n.length;i<o;i++)t.push(n[i]);Ge.push(new AnimationClip("default",-1,t))}}else for(var r in e)Ge.push(C(r))}(),function(){var e=Object.keys(Xe.kinematicsModels)[0],t=Object.keys(Xe.kinematicsScenes)[0],r=Object.keys(Xe.visualScenes)[0];if(void 0!==e&&void 0!==t){for(var n,i=(n=e,p(Xe.kinematicsModels[n],pe)),o=function(e){return p(Xe.kinematicsScenes[e],Se)}(t),a=Ie(r),s=o.bindJointAxis,l={},u=0,c=s.length;u<c;u++){var h=s[u],f=Be.querySelector('[sid="'+h.target+'"]');if(f){var d=f.parentElement;v(h.jointIndex,d)}}var m=new Matrix4;We={joints:i&&i.joints,getJointValue:function(e){var t=l[e];if(t)return t.position;console.warn("ColladaLoader: Joint "+e+" doesn't exist.")},setJointValue:function(e,t){var r=l[e];if(r){var n=r.joint;if(t>n.limits.max||t<n.limits.min)console.warn("ColladaLoader: Joint "+e+" value "+t+" outside of limits (min: "+n.limits.min+", max: "+n.limits.max+").");else if(n.static)console.warn("ColladaLoader: Joint "+e+" is static.");else{var i=r.object,o=n.axis,a=r.transforms;_e.identity();for(var s=0;s<a.length;s++){var u=a[s];if(u.sid&&-1!==u.sid.indexOf(e))switch(n.type){case"revolute":_e.multiply(m.makeRotationAxis(o,_Math.degToRad(t)));break;case"prismatic":_e.multiply(m.makeTranslation(o.x*t,o.y*t,o.z*t));break;default:console.warn("ColladaLoader: Unknown joint type: "+n.type)}else switch(u.type){case"matrix":_e.multiply(u.obj);break;case"translate":_e.multiply(m.makeTranslation(u.obj.x,u.obj.y,u.obj.z));break;case"scale":_e.scale(u.obj);break;case"rotate":_e.multiply(m.makeRotationAxis(u.obj,u.angle))}}i.matrix.copy(_e),i.matrix.decompose(i.position,i.quaternion,i.scale),l[e].position=t}}else console.log("ColladaLoader: "+e+" does not exist.")}}}function v(e,t){var r=t.getAttribute("name"),n=i.joints[e];a.traverse(function(i){i.name===r&&(l[e]={object:i,transforms:Me(t),joint:n,position:n.zeroPosition})})}}();var qe=function(e){return Ie(a(r(e,"instance_visual_scene")[0].getAttribute("url")))}(r(Be,"scene")[0]);return"Z_UP"===je.upAxis&&qe.quaternion.setFromEuler(new Euler(-Math.PI/2,0,0)),qe.scale.multiplyScalar(je.unit),{animations:Ge,kinematics:We,library:Xe,scene:qe}}},CompressedTexture.prototype=Object.create(Texture.prototype),CompressedTexture.prototype.constructor=CompressedTexture,CompressedTexture.prototype.isCompressedTexture=!0,Object.assign(CompressedTextureLoader.prototype,{load:function(e,t,r,n){var i=this,o=[],a=new CompressedTexture;a.image=o;var s=new FileLoader(this.manager);function l(l){s.load(e[l],function(e){var r=i._parser(e,!0);o[l]={width:r.width,height:r.height,format:r.format,mipmaps:r.mipmaps},6===(u+=1)&&(1===r.mipmapCount&&(a.minFilter=LinearFilter),a.format=r.format,a.needsUpdate=!0,t&&t(a))},r,n)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(e))for(var u=0,c=0,h=e.length;c<h;++c)l(c);else s.load(e,function(e){var r=i._parser(e,!0);if(r.isCubemap)for(var n=r.mipmaps.length/r.mipmapCount,s=0;s<n;s++){o[s]={mipmaps:[]};for(var l=0;l<r.mipmapCount;l++)o[s].mipmaps.push(r.mipmaps[s*r.mipmapCount+l]),o[s].format=r.format,o[s].width=r.width,o[s].height=r.height}else a.image.width=r.width,a.image.height=r.height,a.mipmaps=r.mipmaps;1===r.mipmapCount&&(a.minFilter=LinearFilter),a.format=r.format,a.needsUpdate=!0,t&&t(a)},r,n);return a},setPath:function(e){return this.path=e,this}});var DDSLoader=function e(t){CompressedTextureLoader.call(this,t),this._parser=e.parse};function RawShaderMaterial(e){ShaderMaterial.call(this,e),this.type="RawShaderMaterial"}function LineLoop(e,t){Line.call(this,e,t),this.type="LineLoop"}function LineDashedMaterial(e){LineBasicMaterial.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}function MeshDepthMaterial(e){Material$1.call(this),this.type="MeshDepthMaterial",this.depthPacking=BasicDepthPacking,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(e)}function MeshDistanceMaterial(e){Material$1.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Vector3,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(e)}function MeshNormalMaterial(e){Material$1.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function MeshStandardMaterial(e){Material$1.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Color(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function MeshPhysicalMaterial(e){MeshStandardMaterial.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(e)}function MeshToonMaterial(e){MeshPhongMaterial.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(e)}function ShadowMaterial(e){Material$1.call(this),this.type="ShadowMaterial",this.color=new Color(0),this.transparent=!0,this.setValues(e)}function SpriteMaterial(e){Material$1.call(this),this.type="SpriteMaterial",this.color=new Color(16777215),this.map=null,this.rotation=0,this.sizeAttenuation=!0,this.lights=!1,this.transparent=!0,this.setValues(e)}function MaterialLoader(e){this.manager=void 0!==e?e:DefaultLoadingManager,this.textures={}}function Loader$1(){}DDSLoader.prototype=Object.create(CompressedTextureLoader.prototype),DDSLoader.prototype.constructor=DDSLoader,DDSLoader.parse=function(e,t){var r={mipmaps:[],width:0,height:0,format:null,mipmapCount:1};function n(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}function i(e,t,r,n){for(var i=r*n*4,o=new Uint8Array(e,t,i),a=new Uint8Array(i),s=0,l=0,u=0;u<n;u++)for(var c=0;c<r;c++){var h=o[l],p=o[++l],f=o[++l],d=o[++l];l++,a[s]=f,a[++s]=p,a[++s]=h,a[++s]=d,s++}return a}var o,a=n("DXT1"),s=n("DXT3"),l=n("DXT5"),u=n("ETC1"),c=new Int32Array(e,0,31);if(542327876!==c[0])return console.error("DDSLoader.parse: Invalid magic number in DDS header."),r;if(4&!c[20])return console.error("DDSLoader.parse: Unsupported format, must contain a FourCC code."),r;var h,p=c[21],f=!1;switch(p){case a:o=8,r.format=RGB_S3TC_DXT1_Format;break;case s:o=16,r.format=RGBA_S3TC_DXT3_Format;break;case l:o=16,r.format=RGBA_S3TC_DXT5_Format;break;case u:o=8,r.format=RGB_ETC1_Format;break;default:if(!(32===c[22]&&16711680&c[23]&&65280&c[24]&&255&c[25]&&4278190080&c[26]))return console.error("DDSLoader.parse: Unsupported FourCC code ",(h=p,String.fromCharCode(255&h,h>>8&255,h>>16&255,h>>24&255))),r;f=!0,o=64,r.format=RGBAFormat}r.mipmapCount=1,131072&c[2]&&!1!==t&&(r.mipmapCount=Math.max(1,c[7]));var d=c[28];if(r.isCubemap=!!(512&d),r.isCubemap&&(!(1024&d)||!(2048&d)||!(4096&d)||!(8192&d)||!(16384&d)||!(32768&d)))return console.error("DDSLoader.parse: Incomplete cubemap faces"),r;r.width=c[4],r.height=c[3];for(var m=c[1]+4,v=r.isCubemap?6:1,g=0;g<v;g++)for(var y=r.width,b=r.height,x=0;x<r.mipmapCount;x++){if(f)var w=(S=i(e,m,y,b)).length;else{w=Math.max(4,y)/4*Math.max(4,b)/4*o;var S=new Uint8Array(e,m,w)}var M={data:S,width:y,height:b};r.mipmaps.push(M),m+=w,y=Math.max(y>>1,1),b=Math.max(b>>1,1)}return r},RawShaderMaterial.prototype=Object.create(ShaderMaterial.prototype),RawShaderMaterial.prototype.constructor=RawShaderMaterial,RawShaderMaterial.prototype.isRawShaderMaterial=!0,LineLoop.prototype=Object.assign(Object.create(Line.prototype),{constructor:LineLoop,isLineLoop:!0}),LineDashedMaterial.prototype=Object.create(LineBasicMaterial.prototype),LineDashedMaterial.prototype.constructor=LineDashedMaterial,LineDashedMaterial.prototype.isLineDashedMaterial=!0,LineDashedMaterial.prototype.copy=function(e){return LineBasicMaterial.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this},MeshDepthMaterial.prototype=Object.create(Material$1.prototype),MeshDepthMaterial.prototype.constructor=MeshDepthMaterial,MeshDepthMaterial.prototype.isMeshDepthMaterial=!0,MeshDepthMaterial.prototype.copy=function(e){return Material$1.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},MeshDistanceMaterial.prototype=Object.create(Material$1.prototype),MeshDistanceMaterial.prototype.constructor=MeshDistanceMaterial,MeshDistanceMaterial.prototype.isMeshDistanceMaterial=!0,MeshDistanceMaterial.prototype.copy=function(e){return Material$1.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},MeshNormalMaterial.prototype=Object.create(Material$1.prototype),MeshNormalMaterial.prototype.constructor=MeshNormalMaterial,MeshNormalMaterial.prototype.isMeshNormalMaterial=!0,MeshNormalMaterial.prototype.copy=function(e){return Material$1.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},MeshStandardMaterial.prototype=Object.create(Material$1.prototype),MeshStandardMaterial.prototype.constructor=MeshStandardMaterial,MeshStandardMaterial.prototype.isMeshStandardMaterial=!0,MeshStandardMaterial.prototype.copy=function(e){return Material$1.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},MeshPhysicalMaterial.prototype=Object.create(MeshStandardMaterial.prototype),MeshPhysicalMaterial.prototype.constructor=MeshPhysicalMaterial,MeshPhysicalMaterial.prototype.isMeshPhysicalMaterial=!0,MeshPhysicalMaterial.prototype.copy=function(e){return MeshStandardMaterial.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=e.clearCoat,this.clearCoatRoughness=e.clearCoatRoughness,this},MeshToonMaterial.prototype=Object.create(MeshPhongMaterial.prototype),MeshToonMaterial.prototype.constructor=MeshToonMaterial,MeshToonMaterial.prototype.isMeshToonMaterial=!0,MeshToonMaterial.prototype.copy=function(e){return MeshPhongMaterial.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this},ShadowMaterial.prototype=Object.create(Material$1.prototype),ShadowMaterial.prototype.constructor=ShadowMaterial,ShadowMaterial.prototype.isShadowMaterial=!0,ShadowMaterial.prototype.copy=function(e){return Material$1.prototype.copy.call(this,e),this.color.copy(e.color),this},SpriteMaterial.prototype=Object.create(Material$1.prototype),SpriteMaterial.prototype.constructor=SpriteMaterial,SpriteMaterial.prototype.isSpriteMaterial=!0,SpriteMaterial.prototype.copy=function(e){return Material$1.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this},Object.assign(MaterialLoader.prototype,{load:function(e,t,r,n){var i=this,o=new FileLoader(i.manager);o.setPath(i.path),o.load(e,function(e){t(i.parse(JSON.parse(e)))},r,n)},parse:function(e){var t=this.textures;function r(e){return void 0===t[e]&&console.warn("MaterialLoader: Undefined texture",e),t[e]}var n=new{LineBasicMaterial:LineBasicMaterial,LineDashedMaterial:LineDashedMaterial,MeshBasicMaterial:MeshBasicMaterial,MeshDepthMaterial:MeshDepthMaterial,MeshDistanceMaterial:MeshDistanceMaterial,MeshLambertMaterial:MeshLambertMaterial,MeshNormalMaterial:MeshNormalMaterial,MeshPhongMaterial:MeshPhongMaterial,MeshPhysicalMaterial:MeshPhysicalMaterial,MeshStandardMaterial:MeshStandardMaterial,MeshToonMaterial:MeshToonMaterial,PointsMaterial:PointsMaterial,RawShaderMaterial:RawShaderMaterial,ShaderMaterial:ShaderMaterial,ShadowMaterial:ShadowMaterial,SpriteMaterial:SpriteMaterial}[e.type];if(void 0!==e.uuid&&(n.uuid=e.uuid),void 0!==e.name&&(n.name=e.name),void 0!==e.color&&n.color.setHex(e.color),void 0!==e.roughness&&(n.roughness=e.roughness),void 0!==e.metalness&&(n.metalness=e.metalness),void 0!==e.emissive&&n.emissive.setHex(e.emissive),void 0!==e.specular&&n.specular.setHex(e.specular),void 0!==e.shininess&&(n.shininess=e.shininess),void 0!==e.clearCoat&&(n.clearCoat=e.clearCoat),void 0!==e.clearCoatRoughness&&(n.clearCoatRoughness=e.clearCoatRoughness),void 0!==e.vertexColors&&(n.vertexColors=e.vertexColors),void 0!==e.fog&&(n.fog=e.fog),void 0!==e.flatShading&&(n.flatShading=e.flatShading),void 0!==e.blending&&(n.blending=e.blending),void 0!==e.combine&&(n.combine=e.combine),void 0!==e.side&&(n.side=e.side),void 0!==e.opacity&&(n.opacity=e.opacity),void 0!==e.transparent&&(n.transparent=e.transparent),void 0!==e.alphaTest&&(n.alphaTest=e.alphaTest),void 0!==e.depthTest&&(n.depthTest=e.depthTest),void 0!==e.depthWrite&&(n.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(n.colorWrite=e.colorWrite),void 0!==e.wireframe&&(n.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(n.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(n.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(n.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(n.rotation=e.rotation),1!==e.linewidth&&(n.linewidth=e.linewidth),void 0!==e.dashSize&&(n.dashSize=e.dashSize),void 0!==e.gapSize&&(n.gapSize=e.gapSize),void 0!==e.scale&&(n.scale=e.scale),void 0!==e.polygonOffset&&(n.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(n.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(n.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(n.skinning=e.skinning),void 0!==e.morphTargets&&(n.morphTargets=e.morphTargets),void 0!==e.dithering&&(n.dithering=e.dithering),void 0!==e.visible&&(n.visible=e.visible),void 0!==e.userData&&(n.userData=e.userData),void 0!==e.uniforms)for(var i in e.uniforms){var o=e.uniforms[i];switch(n.uniforms[i]={},o.type){case"t":n.uniforms[i].value=r(o.value);break;case"c":n.uniforms[i].value=(new Color).setHex(o.value);break;case"v2":n.uniforms[i].value=(new Vector2).fromArray(o.value);break;case"v3":n.uniforms[i].value=(new Vector3).fromArray(o.value);break;case"v4":n.uniforms[i].value=(new Vector4).fromArray(o.value);break;case"m3":n.uniforms[i].value=(new Matrix3).fromArray(o.value);case"m4":n.uniforms[i].value=(new Matrix4).fromArray(o.value);break;default:n.uniforms[i].value=o.value}}if(void 0!==e.defines&&(n.defines=e.defines),void 0!==e.vertexShader&&(n.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(n.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(var a in e.extensions)n.extensions[a]=e.extensions[a];if(void 0!==e.shading&&(n.flatShading=1===e.shading),void 0!==e.size&&(n.size=e.size),void 0!==e.sizeAttenuation&&(n.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(n.map=r(e.map)),void 0!==e.alphaMap&&(n.alphaMap=r(e.alphaMap),n.transparent=!0),void 0!==e.bumpMap&&(n.bumpMap=r(e.bumpMap)),void 0!==e.bumpScale&&(n.bumpScale=e.bumpScale),void 0!==e.normalMap&&(n.normalMap=r(e.normalMap)),void 0!==e.normalMapType&&(n.normalMapType=e.normalMapType),void 0!==e.normalScale){var s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),n.normalScale=(new Vector2).fromArray(s)}return void 0!==e.displacementMap&&(n.displacementMap=r(e.displacementMap)),void 0!==e.displacementScale&&(n.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(n.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(n.roughnessMap=r(e.roughnessMap)),void 0!==e.metalnessMap&&(n.metalnessMap=r(e.metalnessMap)),void 0!==e.emissiveMap&&(n.emissiveMap=r(e.emissiveMap)),void 0!==e.emissiveIntensity&&(n.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(n.specularMap=r(e.specularMap)),void 0!==e.envMap&&(n.envMap=r(e.envMap)),void 0!==e.envMapIntensity&&(n.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(n.reflectivity=e.reflectivity),void 0!==e.lightMap&&(n.lightMap=r(e.lightMap)),void 0!==e.lightMapIntensity&&(n.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(n.aoMap=r(e.aoMap)),void 0!==e.aoMapIntensity&&(n.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(n.gradientMap=r(e.gradientMap)),n},setPath:function(e){return this.path=e,this},setTextures:function(e){return this.textures=e,this}}),Loader$1.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=this.handlers,r=0,n=t.length;r<n;r+=2){var i=t[r],o=t[r+1];if(i.test(e))return o}return null}},Object.assign(Loader$1.prototype,{crossOrigin:"anonymous",onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(e,t,r){for(var n=[],i=0;i<e.length;++i)n[i]=this.createMaterial(e[i],t,r);return n},createMaterial:function(){var e={NoBlending:NoBlending,NormalBlending:NormalBlending,AdditiveBlending:AdditiveBlending,SubtractiveBlending:SubtractiveBlending,MultiplyBlending:MultiplyBlending,CustomBlending:CustomBlending},t=new Color,r=new TextureLoader,n=new MaterialLoader;return function(i,o,a){var s={};function l(e,t,n,i,l){var u,c=o+e,h=Loader$1.Handlers.get(c);null!==h?u=h.load(c):(r.setCrossOrigin(a),u=r.load(c)),void 0!==t&&(u.repeat.fromArray(t),1!==t[0]&&(u.wrapS=RepeatWrapping),1!==t[1]&&(u.wrapT=RepeatWrapping)),void 0!==n&&u.offset.fromArray(n),void 0!==i&&("repeat"===i[0]&&(u.wrapS=RepeatWrapping),"mirror"===i[0]&&(u.wrapS=MirroredRepeatWrapping),"repeat"===i[1]&&(u.wrapT=RepeatWrapping),"mirror"===i[1]&&(u.wrapT=MirroredRepeatWrapping)),void 0!==l&&(u.anisotropy=l);var p=_Math.generateUUID();return s[p]=u,p}var u={uuid:_Math.generateUUID(),type:"MeshLambertMaterial"};for(var c in i){var h=i[c];switch(c){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":u.name=h;break;case"blending":u.blending=e[h];break;case"colorAmbient":case"mapAmbient":console.warn("Loader.createMaterial:",c,"is no longer supported.");break;case"colorDiffuse":u.color=t.fromArray(h).getHex();break;case"colorSpecular":u.specular=t.fromArray(h).getHex();break;case"colorEmissive":u.emissive=t.fromArray(h).getHex();break;case"specularCoef":u.shininess=h;break;case"shading":"basic"===h.toLowerCase()&&(u.type="MeshBasicMaterial"),"phong"===h.toLowerCase()&&(u.type="MeshPhongMaterial"),"standard"===h.toLowerCase()&&(u.type="MeshStandardMaterial");break;case"mapDiffuse":u.map=l(h,i.mapDiffuseRepeat,i.mapDiffuseOffset,i.mapDiffuseWrap,i.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":u.emissiveMap=l(h,i.mapEmissiveRepeat,i.mapEmissiveOffset,i.mapEmissiveWrap,i.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":u.lightMap=l(h,i.mapLightRepeat,i.mapLightOffset,i.mapLightWrap,i.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":u.aoMap=l(h,i.mapAORepeat,i.mapAOOffset,i.mapAOWrap,i.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":u.bumpMap=l(h,i.mapBumpRepeat,i.mapBumpOffset,i.mapBumpWrap,i.mapBumpAnisotropy);break;case"mapBumpScale":u.bumpScale=h;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":u.normalMap=l(h,i.mapNormalRepeat,i.mapNormalOffset,i.mapNormalWrap,i.mapNormalAnisotropy);break;case"mapNormalFactor":u.normalScale=h;break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":u.specularMap=l(h,i.mapSpecularRepeat,i.mapSpecularOffset,i.mapSpecularWrap,i.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":u.metalnessMap=l(h,i.mapMetalnessRepeat,i.mapMetalnessOffset,i.mapMetalnessWrap,i.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":u.roughnessMap=l(h,i.mapRoughnessRepeat,i.mapRoughnessOffset,i.mapRoughnessWrap,i.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":u.alphaMap=l(h,i.mapAlphaRepeat,i.mapAlphaOffset,i.mapAlphaWrap,i.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":u.side=BackSide;break;case"doubleSided":u.side=DoubleSide;break;case"transparency":console.warn("Loader.createMaterial: transparency has been renamed to opacity"),u.opacity=h;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":u[c]=h;break;case"vertexColors":!0===h&&(u.vertexColors=VertexColors),"face"===h&&(u.vertexColors=FaceColors);break;default:console.error("Loader.createMaterial: Unsupported",c,h)}}return"MeshBasicMaterial"===u.type&&delete u.emissive,"MeshPhongMaterial"!==u.type&&delete u.specular,u.opacity<1&&(u.transparent=!0),n.setTextures(s),n.parse(u)}}()});var LegacyGLTFLoader=function(){function e(e){this.manager=void 0!==e?e:DefaultLoadingManager}function t(){var e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}},update:function(t,r){for(var n in e){var i=e[n];i.update&&i.update(t,r)}}}}function r(e,t){var r={},n=e.material.uniforms;for(var i in n){var o=n[i];if(o.semantic){var a=o.node,s=e;a&&(s=t[a]),r[i]={semantic:o.semantic,sourceNode:s,targetNode:e,uniform:o}}}this.boundUniforms=r,this._m4=new Matrix4}e.prototype={constructor:e,crossOrigin:"anonymous",load:function(e,t,r,n){var i,o=this;i=void 0!==this.resourcePath?this.resourcePath:void 0!==this.path?this.path:LoaderUtils.extractUrlBase(e);var a=new FileLoader(o.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.load(e,function(e){o.parse(e,i,t)},r,n)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){this.path=e},setResourcePath:function(e){return this.resourcePath=e,this},parse:function(e,t,r){var a,l={};LoaderUtils.decodeText(new Uint8Array(e,0,4))===o.magic?(l[n.KHR_BINARY_GLTF]=new s(e),a=l[n.KHR_BINARY_GLTF].content):a=LoaderUtils.decodeText(new Uint8Array(e));var u=JSON.parse(a);u.extensionsUsed&&u.extensionsUsed.indexOf(n.KHR_MATERIALS_COMMON)>=0&&(l[n.KHR_MATERIALS_COMMON]=new i(u)),new A(u,l,{crossOrigin:this.crossOrigin,manager:this.manager,path:t||this.resourcePath||""}).parse(function(e,t,n,i){r({scene:e,scenes:t,cameras:n,animations:i})})}},e.Shaders={update:function(){console.warn("LegacyGLTFLoader.Shaders has been deprecated, and now updates automatically.")}},r.prototype.update=function(e,t){var r=this.boundUniforms;for(var n in r){var i=r[n];switch(i.semantic){case"MODELVIEW":i.uniform.value.multiplyMatrices(t.matrixWorldInverse,i.sourceNode.matrixWorld);break;case"MODELVIEWINVERSETRANSPOSE":var o=i.uniform.value;this._m4.multiplyMatrices(t.matrixWorldInverse,i.sourceNode.matrixWorld),o.getNormalMatrix(this._m4);break;case"PROJECTION":i.uniform.value.copy(t.projectionMatrix);break;case"JOINTMATRIX":for(var a=i.uniform.value,s=0;s<a.length;s++)a[s].getInverse(i.sourceNode.matrixWorld).multiply(i.targetNode.skeleton.bones[s].matrixWorld).multiply(i.targetNode.skeleton.boneInverses[s]).multiply(i.targetNode.bindMatrix);break;default:console.warn("Unhandled shader semantic: "+i.semantic)}}},e.Animations={update:function(){console.warn("LegacyGLTFLoader.Animation has been deprecated. Use AnimationMixer instead.")}};var n={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_MATERIALS_COMMON:"KHR_materials_common"};function i(e){this.name=n.KHR_MATERIALS_COMMON,this.lights={};var t=(e.extensions&&e.extensions[n.KHR_MATERIALS_COMMON]||{}).lights||{};for(var r in t){var i,o=t[r],a=o[o.type],s=(new Color).fromArray(a.color);switch(o.type){case"directional":(i=new DirectionalLight(s)).position.set(0,0,1);break;case"point":i=new PointLight(s);break;case"spot":(i=new SpotLight(s)).position.set(0,0,1);break;case"ambient":i=new AmbientLight(s)}i&&(this.lights[r]=i)}}var o={magic:"glTF",version:1,contentFormat:0},a=20;function s(e){this.name=n.KHR_BINARY_GLTF;var t=new DataView(e,0,a),r={magic:LoaderUtils.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0),contentLength:t.getUint32(12,!0),contentFormat:t.getUint32(16,!0)};for(var i in o){var s=o[i];if(r[i]!==s)throw new Error('Unsupported glTF-Binary header: Expected "%s" to be "%s".',i,s)}var l=new Uint8Array(e,a,r.contentLength);this.header=r,this.content=LoaderUtils.decodeText(l),this.body=e.slice(a+r.contentLength,r.length)}s.prototype.loadShader=function(e,t){var r=t[e.extensions[n.KHR_BINARY_GLTF].bufferView],i=new Uint8Array(r);return LoaderUtils.decodeText(i)};var l={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,TRIANGLES:4,LINES:1,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,VERTEX_SHADER:35633,FRAGMENT_SHADER:35632},u={5126:Number,35675:Matrix3,35676:Matrix4,35664:Vector2,35665:Vector3,35666:Vector4,35678:Texture},c={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},h={9728:NearestFilter,9729:LinearFilter,9984:NearestMipMapNearestFilter,9985:LinearMipMapNearestFilter,9986:NearestMipMapLinearFilter,9987:LinearMipMapLinearFilter},p={33071:ClampToEdgeWrapping,33648:MirroredRepeatWrapping,10497:RepeatWrapping},f={6406:AlphaFormat,6407:RGBFormat,6408:RGBAFormat,6409:LuminanceFormat,6410:LuminanceAlphaFormat},d={5121:UnsignedByteType,32819:UnsignedShort4444Type,32820:UnsignedShort5551Type,33635:UnsignedShort565Type},m={1028:BackSide,1029:FrontSide},v={512:NeverDepth,513:LessDepth,514:EqualDepth,515:LessEqualDepth,516:GreaterEqualDepth,517:NotEqualDepth,518:GreaterEqualDepth,519:AlwaysDepth},g={32774:AddEquation,32778:SubtractEquation,32779:ReverseSubtractEquation},y={0:ZeroFactor,1:OneFactor,768:SrcColorFactor,769:OneMinusSrcColorFactor,770:SrcAlphaFactor,771:OneMinusSrcAlphaFactor,772:DstAlphaFactor,773:OneMinusDstAlphaFactor,774:DstColorFactor,775:OneMinusDstColorFactor,776:SrcAlphaSaturateFactor},b={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},x={scale:"scale",translation:"position",rotation:"quaternion"},w={LINEAR:InterpolateLinear,STEP:InterpolateDiscrete},S={2884:"CULL_FACE",2929:"DEPTH_TEST",3042:"BLEND",3089:"SCISSOR_TEST",32823:"POLYGON_OFFSET_FILL",32926:"SAMPLE_ALPHA_TO_COVERAGE"};function M(e,t,r){var n;if(!e)return Promise.resolve();var i=[];if("[object Array]"===Object.prototype.toString.call(e)){n=[];for(var o=e.length,a=0;a<o;a++){(l=t.call(r||this,e[a],a))&&(i.push(l),l instanceof Promise?l.then(function(e,t){n[e]=t}.bind(this,a)):n[a]=l)}}else for(var s in n={},e){var l;if(e.hasOwnProperty(s))(l=t.call(r||this,e[s],s))&&(i.push(l),l instanceof Promise?l.then(function(e,t){n[e]=t}.bind(this,s)):n[s]=l)}return Promise.all(i).then(function(){return n})}function _(e,t){return"string"!==typeof e||""===e?"":/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:(t||"")+e}function T(e){this.isDeferredShaderMaterial=!0,this.params=e}function A(e,r,n){this.json=e||{},this.extensions=r||{},this.options=n||{},this.cache=new t}return T.prototype.create=function(){var e=UniformsUtils.clone(this.params.uniforms);for(var t in this.params.uniforms){var r=this.params.uniforms[t];r.value instanceof Texture&&(e[t].value=r.value,e[t].value.needsUpdate=!0),e[t].semantic=r.semantic,e[t].node=r.node}return this.params.uniforms=e,new RawShaderMaterial(this.params)},A.prototype._withDependencies=function(e){for(var t={},r=0;r<e.length;r++){var n=e[r],i="load"+n.charAt(0).toUpperCase()+n.slice(1),o=this.cache.get(n);if(void 0!==o)t[n]=o;else if(this[i]){var a=this[i]();this.cache.add(n,a),t[n]=a}}return M(t,function(e){return e})},A.prototype.parse=function(e){var t=this.json;this.cache.removeAll(),this._withDependencies(["scenes","cameras","animations"]).then(function(r){var n=[];for(var i in r.scenes)n.push(r.scenes[i]);var o=void 0!==t.scene?r.scenes[t.scene]:n[0],a=[];for(var i in r.cameras){var s=r.cameras[i];a.push(s)}var l=[];for(var i in r.animations)l.push(r.animations[i]);e(o,n,a,l)})},A.prototype.loadShaders=function(){var e=this.json,t=this.extensions,r=this.options;return this._withDependencies(["bufferViews"]).then(function(i){return M(e.shaders,function(e){return e.extensions&&e.extensions[n.KHR_BINARY_GLTF]?t[n.KHR_BINARY_GLTF].loadShader(e,i.bufferViews):new Promise(function(t){var n=new FileLoader(r.manager);n.setResponseType("text"),n.load(_(e.uri,r.path),function(e){t(e)})})})})},A.prototype.loadBuffers=function(){var e=this.json,t=this.extensions,r=this.options;return M(e.buffers,function(e,i){return"binary_glTF"===i?t[n.KHR_BINARY_GLTF].body:"arraybuffer"===e.type||void 0===e.type?new Promise(function(t){var n=new FileLoader(r.manager);n.setResponseType("arraybuffer"),n.load(_(e.uri,r.path),function(e){t(e)})}):void console.warn("LegacyGLTFLoader: "+e.type+" buffer type is not supported")})},A.prototype.loadBufferViews=function(){var e=this.json;return this._withDependencies(["buffers"]).then(function(t){return M(e.bufferViews,function(e){var r=t.buffers[e.buffer],n=void 0!==e.byteLength?e.byteLength:0;return r.slice(e.byteOffset,e.byteOffset+n)})})},A.prototype.loadAccessors=function(){var e=this.json;return this._withDependencies(["bufferViews"]).then(function(t){return M(e.accessors,function(e){var r=t.bufferViews[e.bufferView],n=b[e.type],i=c[e.componentType],o=i.BYTES_PER_ELEMENT,a=o*n;if(e.byteStride&&e.byteStride!==a){var s=new i(r);return new InterleavedBufferAttribute(new InterleavedBuffer(s,e.byteStride/o),n,e.byteOffset/o)}return new BufferAttribute(s=new i(r,e.byteOffset,e.count*n),n)})})},A.prototype.loadTextures=function(){var e=this.json,t=(this.extensions,this.options);return this._withDependencies(["bufferViews"]).then(function(r){return M(e.textures,function(i){if(i.source)return new Promise(function(o){var a=e.images[i.source],s=a.uri,l=!1;if(a.extensions&&a.extensions[n.KHR_BINARY_GLTF]){var u=a.extensions[n.KHR_BINARY_GLTF],c=r.bufferViews[u.bufferView],m=new Blob([c],{type:u.mimeType});s=URL.createObjectURL(m),l=!0}var v=Loader$1.Handlers.get(s);null===v&&(v=new TextureLoader(t.manager)),v.setCrossOrigin(t.crossOrigin),v.load(_(s,t.path),function(t){if(l&&URL.revokeObjectURL(s),t.flipY=!1,void 0!==i.name&&(t.name=i.name),t.format=void 0!==i.format?f[i.format]:RGBAFormat,void 0!==i.internalFormat&&t.format!==f[i.internalFormat]&&console.warn("LegacyGLTFLoader: Three.js doesn't support texture internalFormat which is different from texture format. internalFormat will be forced to be the same value as format."),t.type=void 0!==i.type?d[i.type]:UnsignedByteType,i.sampler){var r=e.samplers[i.sampler];t.magFilter=h[r.magFilter]||LinearFilter,t.minFilter=h[r.minFilter]||NearestMipMapLinearFilter,t.wrapS=p[r.wrapS]||RepeatWrapping,t.wrapT=p[r.wrapT]||RepeatWrapping}o(t)},void 0,function(){l&&URL.revokeObjectURL(s),o()})})})})},A.prototype.loadMaterials=function(){var e=this.json;return this._withDependencies(["shaders","textures"]).then(function(t){return M(e.materials,function(r){var i,o,a={},s={};if(r.extensions&&r.extensions[n.KHR_MATERIALS_COMMON]&&(o=r.extensions[n.KHR_MATERIALS_COMMON]),o){var c=["ambient","emission","transparent","transparency","doubleSided"];switch(o.technique){case"BLINN":case"PHONG":i=MeshPhongMaterial,c.push("diffuse","specular","shininess");break;case"LAMBERT":i=MeshLambertMaterial,c.push("diffuse");break;case"CONSTANT":default:i=MeshBasicMaterial}c.forEach(function(e){void 0!==o.values[e]&&(a[e]=o.values[e])}),(o.doubleSided||a.doubleSided)&&(s.side=DoubleSide),(o.transparent||a.transparent)&&(s.transparent=!0,s.opacity=void 0!==a.transparency?a.transparency:1)}else if(void 0===r.technique)i=MeshPhongMaterial,Object.assign(a,r.values);else{i=T;var h=e.techniques[r.technique];s.uniforms={};var p=e.programs[h.program];if(p){s.fragmentShader=t.shaders[p.fragmentShader],s.fragmentShader||(console.warn("ERROR: Missing fragment shader definition:",p.fragmentShader),i=MeshPhongMaterial);var f=t.shaders[p.vertexShader];f||(console.warn("ERROR: Missing vertex shader definition:",p.vertexShader),i=MeshPhongMaterial),s.vertexShader=function(e,t){var r={};for(var n in t.attributes){var i=t.attributes[n],o=(h=t.parameters[i]).type,a=h.semantic;r[n]={type:o,semantic:a}}var s=t.parameters,l=t.attributes,u={};for(var n in r){var c=s[i=l[n]];(a=c.semantic)&&(u[n]=c)}for(var i in u){a=(h=u[i]).semantic;var h,p=new RegExp("\\b"+i+"\\b","g");switch(a){case"POSITION":e=e.replace(p,"position");break;case"NORMAL":e=e.replace(p,"normal");break;case"TEXCOORD_0":case"TEXCOORD0":case"TEXCOORD":e=e.replace(p,"uv");break;case"TEXCOORD_1":e=e.replace(p,"uv2");break;case"COLOR_0":case"COLOR0":case"COLOR":e=e.replace(p,"color");break;case"WEIGHT":e=e.replace(p,"skinWeight");break;case"JOINT":e=e.replace(p,"skinIndex")}}return e}(f,h);var d=h.uniforms;for(var b in d){var x=d[b],w=h.parameters[x],M=w.type;if(!u[M])throw new Error("Unknown shader uniform param type: "+M);var _,A=w.count;void 0!==r.values&&(_=r.values[x]);var C=new u[M],E=w.semantic,L=w.node;switch(M){case l.FLOAT:C=w.value,"transparency"==x&&(s.transparent=!0),void 0!==_&&(C=_);break;case l.FLOAT_VEC2:case l.FLOAT_VEC3:case l.FLOAT_VEC4:case l.FLOAT_MAT3:w&&w.value&&C.fromArray(w.value),_&&C.fromArray(_);break;case l.FLOAT_MAT2:console.warn("FLOAT_MAT2 is not a supported uniform type");break;case l.FLOAT_MAT4:if(A){C=new Array(A);for(var N=0;N<A;N++)C[N]=new u[M];if(w&&w.value){var P=w.value;C.fromArray(P)}_&&C.fromArray(_)}else{if(w&&w.value){var O=w.value;C.fromArray(O)}_&&C.fromArray(_)}break;case l.SAMPLER_2D:C=void 0!==_?t.textures[_]:void 0!==w.value?t.textures[w.value]:null}s.uniforms[b]={value:C,semantic:E,node:L}}for(var R=h.states||{},D=R.enable||[],F=R.functions||{},k=!1,I=!1,B=!1,U=0,V=D.length;U<V;U++){var j=D[U];switch(S[j]){case"CULL_FACE":k=!0;break;case"DEPTH_TEST":I=!0;break;case"BLEND":B=!0;break;case"SCISSOR_TEST":case"POLYGON_OFFSET_FILL":case"SAMPLE_ALPHA_TO_COVERAGE":break;default:throw new Error("Unknown technique.states.enable: "+j)}}s.side=k?void 0!==F.cullFace?m[F.cullFace]:FrontSide:DoubleSide,s.depthTest=I,s.depthFunc=void 0!==F.depthFunc?v[F.depthFunc]:LessDepth,s.depthWrite=void 0===F.depthMask||F.depthMask[0],s.blending=B?CustomBlending:NoBlending,s.transparent=B;var z=F.blendEquationSeparate;void 0!==z?(s.blendEquation=g[z[0]],s.blendEquationAlpha=g[z[1]]):(s.blendEquation=AddEquation,s.blendEquationAlpha=AddEquation);var G=F.blendFuncSeparate;void 0!==G?(s.blendSrc=y[G[0]],s.blendDst=y[G[1]],s.blendSrcAlpha=y[G[2]],s.blendDstAlpha=y[G[3]]):(s.blendSrc=OneFactor,s.blendDst=ZeroFactor,s.blendSrcAlpha=OneFactor,s.blendDstAlpha=ZeroFactor)}}Array.isArray(a.diffuse)?s.color=(new Color).fromArray(a.diffuse):"string"===typeof a.diffuse&&(s.map=t.textures[a.diffuse]),delete s.diffuse,"string"===typeof a.reflective&&(s.envMap=t.textures[a.reflective]),"string"===typeof a.bump&&(s.bumpMap=t.textures[a.bump]),Array.isArray(a.emission)?i===MeshBasicMaterial?s.color=(new Color).fromArray(a.emission):s.emissive=(new Color).fromArray(a.emission):"string"===typeof a.emission&&(i===MeshBasicMaterial?s.map=t.textures[a.emission]:s.emissiveMap=t.textures[a.emission]),Array.isArray(a.specular)?s.specular=(new Color).fromArray(a.specular):"string"===typeof a.specular&&(s.specularMap=t.textures[a.specular]),void 0!==a.shininess&&(s.shininess=a.shininess);var W=new i(s);return void 0!==r.name&&(W.name=r.name),W})})},A.prototype.loadMeshes=function(){var e=this.json;return this._withDependencies(["accessors","materials"]).then(function(t){return M(e.meshes,function(r){var n=new Group;void 0!==r.name&&(n.name=r.name),r.extras&&(n.userData=r.extras);var i=r.primitives||[];for(var o in i){var a=i[o];if(a.mode===l.TRIANGLES||void 0===a.mode){var s=new BufferGeometry,u=a.attributes;for(var c in u){if(!(d=u[c]))return;var h=t.accessors[d];switch(c){case"POSITION":s.addAttribute("position",h);break;case"NORMAL":s.addAttribute("normal",h);break;case"TEXCOORD_0":case"TEXCOORD0":case"TEXCOORD":s.addAttribute("uv",h);break;case"TEXCOORD_1":s.addAttribute("uv2",h);break;case"COLOR_0":case"COLOR0":case"COLOR":s.addAttribute("color",h);break;case"WEIGHT":s.addAttribute("skinWeight",h);break;case"JOINT":s.addAttribute("skinIndex",h);break;default:if(!a.material)break;if(!(v=e.materials[a.material]).technique)break;var p=e.techniques[v.technique].parameters||{};for(var f in p)p[f].semantic===c&&s.addAttribute(f,h)}}a.indices&&s.setIndex(t.accessors[a.indices]),(m=new Mesh(s,v=void 0!==t.materials?t.materials[a.material]:new MeshPhongMaterial({color:0,emissive:8947848,specular:0,shininess:0,transparent:!1,depthTest:!0,side:FrontSide}))).castShadow=!0,m.name="0"===o?n.name:n.name+o,a.extras&&(m.userData=a.extras),n.add(m)}else if(a.mode===l.LINES){s=new BufferGeometry,u=a.attributes;for(var c in u){var d;if(!(d=u[c]))return;h=t.accessors[d];switch(c){case"POSITION":s.addAttribute("position",h);break;case"COLOR_0":case"COLOR0":case"COLOR":s.addAttribute("color",h)}}var m,v=t.materials[a.material];a.indices?(s.setIndex(t.accessors[a.indices]),m=new LineSegments(s,v)):m=new Line(s,v),m.name="0"===o?n.name:n.name+o,a.extras&&(m.userData=a.extras),n.add(m)}else console.warn("Only triangular and line primitives are supported")}return n})})},A.prototype.loadCameras=function(){return M(this.json.cameras,function(e){if("perspective"==e.type&&e.perspective){var t=e.perspective.yfov,r=void 0!==e.perspective.aspectRatio?e.perspective.aspectRatio:1,n=t*r,i=new PerspectiveCamera(_Math.radToDeg(n),r,e.perspective.znear||1,e.perspective.zfar||2e6);return void 0!==e.name&&(i.name=e.name),e.extras&&(i.userData=e.extras),i}if("orthographic"==e.type&&e.orthographic){i=new OrthographicCamera(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,e.orthographic.znear,e.orthographic.zfar);return void 0!==e.name&&(i.name=e.name),e.extras&&(i.userData=e.extras),i}})},A.prototype.loadSkins=function(){var e=this.json;return this._withDependencies(["accessors"]).then(function(t){return M(e.skins,function(e){var r=new Matrix4;return void 0!==e.bindShapeMatrix&&r.fromArray(e.bindShapeMatrix),{bindShapeMatrix:r,jointNames:e.jointNames,inverseBindMatrices:t.accessors[e.inverseBindMatrices]}})})},A.prototype.loadAnimations=function(){var e=this.json;return this._withDependencies(["accessors","nodes"]).then(function(t){return M(e.animations,function(e,r){var n=[];for(var i in e.channels){var o=e.channels[i],a=e.samplers[o.sampler];if(a){var s=o.target,l=s.id,u=void 0!==e.parameters?e.parameters[a.input]:a.input,c=void 0!==e.parameters?e.parameters[a.output]:a.output,h=t.accessors[u],p=t.accessors[c],f=t.nodes[l];if(f){f.updateMatrix(),f.matrixAutoUpdate=!0;var d=x[s.path]===x.rotation?QuaternionKeyframeTrack:VectorKeyframeTrack,m=f.name?f.name:f.uuid,v=void 0!==a.interpolation?w[a.interpolation]:InterpolateLinear;n.push(new d(m+"."+x[s.path],AnimationUtils.arraySlice(h.array,0),AnimationUtils.arraySlice(p.array,0),v))}}}return new AnimationClip(l=void 0!==e.name?e.name:"animation_"+r,void 0,n)})})},A.prototype.loadNodes=function(){var e=this.json,t=this.extensions,r=this;return M(e.nodes,function(e){var t,r=new Matrix4;return e.jointName?((t=new Bone).name=void 0!==e.name?e.name:e.jointName,t.jointName=e.jointName):(t=new Object3D,void 0!==e.name&&(t.name=e.name)),e.extras&&(t.userData=e.extras),void 0!==e.matrix?(r.fromArray(e.matrix),t.applyMatrix(r)):(void 0!==e.translation&&t.position.fromArray(e.translation),void 0!==e.rotation&&t.quaternion.fromArray(e.rotation),void 0!==e.scale&&t.scale.fromArray(e.scale)),t}).then(function(i){return r._withDependencies(["meshes","skins","cameras"]).then(function(r){return M(i,function(o,a){var s=e.nodes[a];if(void 0!==s.meshes)for(var l in s.meshes){var u=s.meshes[l],c=r.meshes[u];if(void 0!==c)for(var h in c.children){var p,f=c.children[h],d=f.material,m=f.geometry,v=f.userData,g=f.name;switch(d.isDeferredShaderMaterial?d=y=d.create():y=d,f.type){case"LineSegments":f=new LineSegments(m,y);break;case"LineLoop":f=new LineLoop(m,y);break;case"Line":f=new Line(m,y);break;default:f=new Mesh(m,y)}if(f.castShadow=!0,f.userData=v,f.name=g,s.skin&&(p=r.skins[s.skin]),p){var y,b=function(e){for(var t=Object.keys(i),r=0,n=t.length;r<n;r++){var o=i[t[r]];if(o.jointName===e)return o}return null},x=m;(y=d).skinning=!0,(f=new SkinnedMesh(x,y)).castShadow=!0,f.userData=v,f.name=g;for(var w=[],S=[],M=0,_=p.jointNames.length;M<_;M++){var T=p.jointNames[M],A=b(T);if(A){w.push(A);var C=p.inverseBindMatrices.array,E=(new Matrix4).fromArray(C,16*M);S.push(E)}else console.warn("WARNING: joint: '"+T+"' could not be found")}f.bind(new Skeleton(w,S),p.bindShapeMatrix);!function t(r,n,o){var a=r[o];if(void 0!==a)for(var s=0,l=a.length;s<l;s++){var u=a[s],c=i[u],h=e.nodes[u];void 0!==c&&!0===c.isBone&&void 0!==h&&(n.add(c),t(h,c,"children"))}}(s,f,"skeletons")}o.add(f)}else console.warn("LegacyGLTFLoader: Couldn't find node \""+u+'".')}if(void 0!==s.camera){var L=r.cameras[s.camera];o.add(L)}if(s.extensions&&s.extensions[n.KHR_MATERIALS_COMMON]&&s.extensions[n.KHR_MATERIALS_COMMON].light){var N=t[n.KHR_MATERIALS_COMMON].lights[s.extensions[n.KHR_MATERIALS_COMMON].light];o.add(N)}return o})})})},A.prototype.loadScenes=function(){var e=this.json;function t(r,n,i){var o=i[r];n.add(o);var a=e.nodes[r];if(a.children)for(var s=a.children,l=0,u=s.length;l<u;l++){t(s[l],o,i)}}return this._withDependencies(["nodes"]).then(function(n){return M(e.scenes,function(e){var i=new Scene;void 0!==e.name&&(i.name=e.name),e.extras&&(i.userData=e.extras);for(var o=e.nodes||[],a=0,s=o.length;a<s;a++){t(o[a],i,n.nodes)}return i.traverse(function(e){e.material&&e.material.isRawShaderMaterial&&(e.gltfShader=new r(e,n.nodes),e.onBeforeRender=function(e,t,r){this.gltfShader.update(t,r)})}),i})})},e}(),LegacyJSONLoader=function(){function e(e){"boolean"===typeof e&&(console.warn("JSONLoader: showStatus parameter has been removed from constructor."),e=void 0),this.manager=void 0!==e?e:DefaultLoadingManager,this.withCredentials=!1}return Object.assign(e.prototype,{crossOrigin:"anonymous",load:function(e,t,r,n){var i=this,o=void 0===this.path?LoaderUtils.extractUrlBase(e):this.path,a=new FileLoader(this.manager);a.setPath(this.path),a.setWithCredentials(this.withCredentials),a.load(e,function(r){var n=JSON.parse(r),a=n.metadata;if(void 0!==a){var s=a.type;if(void 0!==s&&"object"===s.toLowerCase())return void console.error("JSONLoader: "+e+" should be loaded with ObjectLoader instead.")}var l=i.parse(n,o);t(l.geometry,l.materials)},r,n)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(){return function(e,t){void 0!==e.data&&(e=e.data),void 0!==e.scale?e.scale=1/e.scale:e.scale=1;var r=new Geometry;return function(e,t){function r(e,t){return e&1<<t}var n,i,o,a,s,l,u,c,h,p,f,d,m,v,g,y,b,x,w,S,M,_,T,A,C,E=e.faces,L=e.vertices,N=e.normals,P=e.colors,O=e.scale,R=0;if(void 0!==e.uvs){for(n=0;n<e.uvs.length;n++)e.uvs[n].length&&R++;for(n=0;n<R;n++)t.faceVertexUvs[n]=[]}for(a=0,s=L.length;a<s;)(x=new Vector3).x=L[a++]*O,x.y=L[a++]*O,x.z=L[a++]*O,t.vertices.push(x);for(a=0,s=E.length;a<s;)if(f=r(p=E[a++],0),d=r(p,1),m=r(p,3),v=r(p,4),g=r(p,5),y=r(p,6),b=r(p,7),f){if((S=new Face3).a=E[a],S.b=E[a+1],S.c=E[a+3],(M=new Face3).a=E[a+1],M.b=E[a+2],M.c=E[a+3],a+=4,d&&(h=E[a++],S.materialIndex=h,M.materialIndex=h),o=t.faces.length,m)for(n=0;n<R;n++)for(A=e.uvs[n],t.faceVertexUvs[n][o]=[],t.faceVertexUvs[n][o+1]=[],i=0;i<4;i++)C=new Vector2(A[2*(c=E[a++])],A[2*c+1]),2!==i&&t.faceVertexUvs[n][o].push(C),0!==i&&t.faceVertexUvs[n][o+1].push(C);if(v&&(u=3*E[a++],S.normal.set(N[u++],N[u++],N[u]),M.normal.copy(S.normal)),g)for(n=0;n<4;n++)u=3*E[a++],T=new Vector3(N[u++],N[u++],N[u]),2!==n&&S.vertexNormals.push(T),0!==n&&M.vertexNormals.push(T);if(y&&(_=P[l=E[a++]],S.color.setHex(_),M.color.setHex(_)),b)for(n=0;n<4;n++)_=P[l=E[a++]],2!==n&&S.vertexColors.push(new Color(_)),0!==n&&M.vertexColors.push(new Color(_));t.faces.push(S),t.faces.push(M)}else{if((w=new Face3).a=E[a++],w.b=E[a++],w.c=E[a++],d&&(h=E[a++],w.materialIndex=h),o=t.faces.length,m)for(n=0;n<R;n++)for(A=e.uvs[n],t.faceVertexUvs[n][o]=[],i=0;i<3;i++)C=new Vector2(A[2*(c=E[a++])],A[2*c+1]),t.faceVertexUvs[n][o].push(C);if(v&&(u=3*E[a++],w.normal.set(N[u++],N[u++],N[u])),g)for(n=0;n<3;n++)u=3*E[a++],T=new Vector3(N[u++],N[u++],N[u]),w.vertexNormals.push(T);if(y&&(l=E[a++],w.color.setHex(P[l])),b)for(n=0;n<3;n++)l=E[a++],w.vertexColors.push(new Color(P[l]));t.faces.push(w)}}(e,r),function(e,t){var r=void 0!==e.influencesPerVertex?e.influencesPerVertex:2;if(e.skinWeights)for(var n=0,i=e.skinWeights.length;n<i;n+=r){var o=e.skinWeights[n],a=r>1?e.skinWeights[n+1]:0,s=r>2?e.skinWeights[n+2]:0,l=r>3?e.skinWeights[n+3]:0;t.skinWeights.push(new Vector4(o,a,s,l))}if(e.skinIndices)for(n=0,i=e.skinIndices.length;n<i;n+=r){var u=e.skinIndices[n],c=r>1?e.skinIndices[n+1]:0,h=r>2?e.skinIndices[n+2]:0,p=r>3?e.skinIndices[n+3]:0;t.skinIndices.push(new Vector4(u,c,h,p))}t.bones=e.bones,t.bones&&t.bones.length>0&&(t.skinWeights.length!==t.skinIndices.length||t.skinIndices.length!==t.vertices.length)&&console.warn("When skinning, number of vertices ("+t.vertices.length+"), skinIndices ("+t.skinIndices.length+"), and skinWeights ("+t.skinWeights.length+") should match.")}(e,r),function(e,t){var r=e.scale;if(void 0!==e.morphTargets)for(var n=0,i=e.morphTargets.length;n<i;n++){t.morphTargets[n]={},t.morphTargets[n].name=e.morphTargets[n].name,t.morphTargets[n].vertices=[];for(var o=t.morphTargets[n].vertices,a=e.morphTargets[n].vertices,s=0,l=a.length;s<l;s+=3){var u=new Vector3;u.x=a[s]*r,u.y=a[s+1]*r,u.z=a[s+2]*r,o.push(u)}}if(void 0!==e.morphColors&&e.morphColors.length>0){console.warn('JSONLoader: "morphColors" no longer supported. Using them as face colors.');var c=t.faces,h=e.morphColors[0].colors;for(n=0,i=c.length;n<i;n++)c[n].color.fromArray(h,3*n)}}(e,r),function(e,t){var r=[],n=[];void 0!==e.animation&&n.push(e.animation),void 0!==e.animations&&(e.animations.length?n=n.concat(e.animations):n.push(e.animations));for(var i=0;i<n.length;i++){var o=AnimationClip.parseAnimation(n[i],t.bones);o&&r.push(o)}if(t.morphTargets){var a=AnimationClip.CreateClipsFromMorphTargetSequences(t.morphTargets,10);r=r.concat(a)}r.length>0&&(t.animations=r)}(e,r),r.computeFaceNormals(),r.computeBoundingSphere(),void 0===e.materials||0===e.materials.length?{geometry:r}:{geometry:r,materials:Loader$1.prototype.initMaterials(e.materials,this.resourcePath||t,this.crossOrigin)}}}()}),e}(),DRACOLoader$1=function(e){this.timeLoaded=0,this.manager=e||DefaultLoadingManager,this.materials=null,this.verbosity=0,this.attributeOptions={},this.drawMode=TrianglesDrawMode,this.nativeAttributeMap={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"}};function WebGLRenderTargetCube(e,t,r){WebGLRenderTarget.call(this,e,t,r)}function CubeCamera(e,t,r,n){Object3D.call(this),this.type="CubeCamera";var i=new PerspectiveCamera(90,1,e,t);i.up.set(0,-1,0),i.lookAt(new Vector3(1,0,0)),this.add(i);var o=new PerspectiveCamera(90,1,e,t);o.up.set(0,-1,0),o.lookAt(new Vector3(-1,0,0)),this.add(o);var a=new PerspectiveCamera(90,1,e,t);a.up.set(0,0,1),a.lookAt(new Vector3(0,1,0)),this.add(a);var s=new PerspectiveCamera(90,1,e,t);s.up.set(0,0,-1),s.lookAt(new Vector3(0,-1,0)),this.add(s);var l=new PerspectiveCamera(90,1,e,t);l.up.set(0,-1,0),l.lookAt(new Vector3(0,0,1)),this.add(l);var u=new PerspectiveCamera(90,1,e,t);u.up.set(0,-1,0),u.lookAt(new Vector3(0,0,-1)),this.add(u),n=n||{format:RGBFormat,magFilter:LinearFilter,minFilter:LinearFilter},this.renderTarget=new WebGLRenderTargetCube(r,r,n),this.renderTarget.texture.name="CubeCamera",this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var r=e.getRenderTarget(),n=this.renderTarget,c=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,i),e.setRenderTarget(n,1),e.render(t,o),e.setRenderTarget(n,2),e.render(t,a),e.setRenderTarget(n,3),e.render(t,s),e.setRenderTarget(n,4),e.render(t,l),n.texture.generateMipmaps=c,e.setRenderTarget(n,5),e.render(t,u),e.setRenderTarget(r)},this.clear=function(e,t,r,n){for(var i=e.getRenderTarget(),o=this.renderTarget,a=0;a<6;a++)e.setRenderTarget(o,a),e.clear(t,r,n);e.setRenderTarget(i)}}DRACOLoader$1.prototype={constructor:DRACOLoader$1,load:function(e,t,r,n){var i=this,o=new FileLoader(i.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.load(e,function(e){i.decodeDracoFile(e,t)},r,n)},setPath:function(e){return this.path=e,this},setVerbosity:function(e){return this.verbosity=e,this},setDrawMode:function(e){return this.drawMode=e,this},setSkipDequantization:function(e,t){var r=!0;return"undefined"!==typeof t&&(r=t),this.getAttributeOptions(e).skipDequantization=r,this},decodeDracoFile:function(e,t,r,n){var i=this;DRACOLoader$1.getDecoderModule().then(function(o){i.decodeDracoFileInternal(e,o.decoder,t,r,n)})},decodeDracoFileInternal:function(e,t,r,n,i){var o=new t.DecoderBuffer;o.Init(new Int8Array(e),e.byteLength);var a=new t.Decoder,s=a.GetEncodedGeometryType(o);if(s==t.TRIANGULAR_MESH)this.verbosity>0&&console.log("Loaded a mesh.");else{if(s!=t.POINT_CLOUD){var l="DRACOLoader: Unknown geometry type.";throw console.error(l),new Error(l)}this.verbosity>0&&console.log("Loaded a point cloud.")}r(this.convertDracoGeometryTo3JS(t,a,s,o,n,i))},addAttributeToGeometry:function(e,t,r,n,i,o,a,s){if(0===o.ptr){var l="DRACOLoader: No attribute "+n;throw console.error(l),new Error(l)}var u,c,h=o.num_components(),p=r.num_points()*h;switch(i){case Float32Array:u=new e.DracoFloat32Array,t.GetAttributeFloatForAllPoints(r,o,u),s[n]=new Float32Array(p),c=Float32BufferAttribute;break;case Int8Array:u=new e.DracoInt8Array,t.GetAttributeInt8ForAllPoints(r,o,u),s[n]=new Int8Array(p),c=Int8BufferAttribute;break;case Int16Array:u=new e.DracoInt16Array,t.GetAttributeInt16ForAllPoints(r,o,u),s[n]=new Int16Array(p),c=Int16BufferAttribute;break;case Int32Array:u=new e.DracoInt32Array,t.GetAttributeInt32ForAllPoints(r,o,u),s[n]=new Int32Array(p),c=Int32BufferAttribute;break;case Uint8Array:u=new e.DracoUInt8Array,t.GetAttributeUInt8ForAllPoints(r,o,u),s[n]=new Uint8Array(p),c=Uint8BufferAttribute;break;case Uint16Array:u=new e.DracoUInt16Array,t.GetAttributeUInt16ForAllPoints(r,o,u),s[n]=new Uint16Array(p),c=Uint16BufferAttribute;break;case Uint32Array:u=new e.DracoUInt32Array,t.GetAttributeUInt32ForAllPoints(r,o,u),s[n]=new Uint32Array(p),c=Uint32BufferAttribute;break;default:l="DRACOLoader: Unexpected attribute type.";throw console.error(l),new Error(l)}for(var f=0;f<p;f++)s[n][f]=u.GetValue(f);a.addAttribute(n,new c(s[n],h)),e.destroy(u)},convertDracoGeometryTo3JS:function(e,t,r,n,i,o){var a,s;!0===this.getAttributeOptions("position").skipDequantization&&t.SkipAttributeTransform(e.POSITION);var l=performance.now();if(r===e.TRIANGULAR_MESH?(a=new e.Mesh,s=t.DecodeBufferToMesh(n,a)):(a=new e.PointCloud,s=t.DecodeBufferToPointCloud(n,a)),!s.ok()||0==a.ptr){var u="DRACOLoader: Decoding failed: ";throw u+=s.error_msg(),console.error(u),e.destroy(t),e.destroy(a),new Error(u)}var c,h=performance.now();e.destroy(n),r==e.TRIANGULAR_MESH?(c=a.num_faces(),this.verbosity>0&&console.log("Number of faces loaded: "+c.toString())):c=0;var p=a.num_points(),f=a.num_attributes();this.verbosity>0&&(console.log("Number of points loaded: "+p.toString()),console.log("Number of attributes loaded: "+f.toString()));var d=t.GetAttributeId(a,e.POSITION);if(-1==d){u="DRACOLoader: No position attribute found.";throw console.error(u),e.destroy(t),e.destroy(a),new Error(u)}var m=t.GetAttribute(a,d),v={},g=new BufferGeometry;if(i)for(var y in i){var b=o[y],x=i[y],w=t.GetAttributeByUniqueId(a,x);this.addAttributeToGeometry(e,t,a,y,b,w,g,v)}else for(var y in this.nativeAttributeMap){var S=t.GetAttributeId(a,e[this.nativeAttributeMap[y]]);if(-1!==S){this.verbosity>0&&console.log("Loaded "+y+" attribute.");w=t.GetAttribute(a,S);this.addAttributeToGeometry(e,t,a,y,Float32Array,w,g,v)}}if(r==e.TRIANGULAR_MESH)if(this.drawMode===TriangleStripDrawMode){var M=new e.DracoInt32Array;t.GetTriangleStripsFromMesh(a,M);v.indices=new Uint32Array(M.size());for(var _=0;_<M.size();++_)v.indices[_]=M.GetValue(_);e.destroy(M)}else{var T=3*c;v.indices=new Uint32Array(T);var A=new e.DracoInt32Array;for(_=0;_<c;++_){t.GetFaceFromMesh(a,_,A);var C=3*_;v.indices[C]=A.GetValue(0),v.indices[C+1]=A.GetValue(1),v.indices[C+2]=A.GetValue(2)}e.destroy(A)}g.drawMode=this.drawMode,r==e.TRIANGULAR_MESH&&g.setIndex(new(v.indices.length>65535?Uint32BufferAttribute:Uint16BufferAttribute)(v.indices,1));var E=new e.AttributeQuantizationTransform;if(E.InitFromAttribute(m)){g.attributes.position.isQuantized=!0,g.attributes.position.maxRange=E.range(),g.attributes.position.numQuantizationBits=E.quantization_bits(),g.attributes.position.minValues=new Float32Array(3);for(_=0;_<3;++_)g.attributes.position.minValues[_]=E.min_value(_)}return e.destroy(E),e.destroy(t),e.destroy(a),this.decode_time=h-l,this.import_time=performance.now()-h,this.verbosity>0&&(console.log("Decode time: "+this.decode_time),console.log("Import time: "+this.import_time)),g},isVersionSupported:function(e,t){DRACOLoader$1.getDecoderModule().then(function(r){t(r.decoder.isVersionSupported(e))})},getAttributeOptions:function(e){return"undefined"===typeof this.attributeOptions[e]&&(this.attributeOptions[e]={}),this.attributeOptions[e]}},DRACOLoader$1.decoderPath="./",DRACOLoader$1.decoderConfig={},DRACOLoader$1.decoderModulePromise=null,DRACOLoader$1.setDecoderPath=function(e){DRACOLoader$1.decoderPath=e},DRACOLoader$1.setDecoderConfig=function(e){var t=DRACOLoader$1.decoderConfig.wasmBinary;DRACOLoader$1.decoderConfig=e||{},DRACOLoader$1.releaseDecoderModule(),t&&(DRACOLoader$1.decoderConfig.wasmBinary=t)},DRACOLoader$1.releaseDecoderModule=function(){DRACOLoader$1.decoderModulePromise=null},DRACOLoader$1.getDecoderModule=function(){var e=this,t=DRACOLoader$1.decoderPath,r=DRACOLoader$1.decoderConfig,n=DRACOLoader$1.decoderModulePromise;return n||("undefined"!==typeof DracoDecoderModule?n=Promise.resolve():"object"!==typeof WebAssembly||"js"===r.type?n=DRACOLoader$1._loadScript(t+"draco_decoder.js"):(r.wasmBinaryFile=t+"draco_decoder.wasm",n=DRACOLoader$1._loadScript(t+"draco_wasm_wrapper.js").then(function(){return DRACOLoader$1._loadArrayBuffer(r.wasmBinaryFile)}).then(function(e){r.wasmBinary=e})),n=n.then(function(){return new Promise(function(t){r.onModuleLoaded=function(r){e.timeLoaded=performance.now(),t({decoder:r})},DracoDecoderModule(r)})}),DRACOLoader$1.decoderModulePromise=n,n)},DRACOLoader$1._loadScript=function(e){var t=document.getElementById("decoder_script");null!==t&&t.parentNode.removeChild(t);var r=document.getElementsByTagName("head")[0],n=document.createElement("script");return n.id="decoder_script",n.type="text/javascript",n.src=e,new Promise(function(e){n.onload=e,r.appendChild(n)})},DRACOLoader$1._loadArrayBuffer=function(e){var t=new FileLoader;return t.setResponseType("arraybuffer"),new Promise(function(r,n){t.load(e,r,void 0,n)})},WebGLRenderTargetCube.prototype=Object.create(WebGLRenderTarget.prototype),WebGLRenderTargetCube.prototype.constructor=WebGLRenderTargetCube,WebGLRenderTargetCube.prototype.isWebGLRenderTargetCube=!0,CubeCamera.prototype=Object.create(Object3D.prototype),CubeCamera.prototype.constructor=CubeCamera;var CubemapGenerator=function(e){this.renderer=e};CubemapGenerator.prototype.fromEquirectangular=function(e,t){t=t||{};var r=new Scene,n={tEquirect:{value:null}},i="\n\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t//include <common>\n\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t#include <begin_vertex>\n\t\t\t\t#include <project_vertex>\n\n\t\t\t}\n\t\t\t",o="\n\t\t\tuniform sampler2D tEquirect;\n\n\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t//include <common>\n\t\t\t#define RECIPROCAL_PI 0.31830988618\n\t\t\t#define RECIPROCAL_PI2 0.15915494\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\tvec2 sampleUV;\n\n\t\t\t\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\n\t\t\t\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\n\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t}\n\t\t\t",a=new ShaderMaterial({type:"CubemapFromEquirect",uniforms:UniformsUtils.clone(n),vertexShader:i,fragmentShader:o,side:BackSide,blending:NoBlending});a.uniforms.tEquirect.value=e;var s=new Mesh(new BoxBufferGeometry(5,5,5),a);r.add(s);var l=new CubeCamera(1,10,t.resolution||512,{type:e.type,format:e.format,encoding:e.encoding,generateMipmaps:void 0!==t.generateMipmaps?t.generateMipmaps:e.generateMipmaps,minFilter:void 0!==t.minFilter?t.minFilter:e.minFilter,magFilter:void 0!==t.magFilter?t.magFilter:e.magFilter});return l.update(this.renderer,r),s.geometry.dispose(),s.material.dispose(),l.renderTarget};var EquirectangularToCubeGenerator=function(){var e=new PerspectiveCamera(90,1,.1,10),t=new Scene,r=new Mesh(new BoxBufferGeometry(1,1,1),function(){var e=new ShaderMaterial({uniforms:{equirectangularMap:{value:null}},vertexShader:"varying vec3 localPosition;\n        \n        void main() {\n          localPosition = position;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"#include <common>\n        varying vec3 localPosition;\n        uniform sampler2D equirectangularMap;\n        \n        vec2 EquirectangularSampleUV(vec3 v) {\n          vec2 uv = vec2(atan(v.z, v.x), asin(v.y));\n          uv *= vec2(0.1591, 0.3183); // inverse atan\n          uv += 0.5;\n          return uv;\n        }\n        \n        void main() {\n          vec2 uv = EquirectangularSampleUV(normalize(localPosition));\n          gl_FragColor = texture2D(equirectangularMap, uv);\n        }",blending:NoBlending});return e.type="EquirectangularToCubeGenerator",e}());r.material.side=BackSide,t.add(r);var n=function(e,t){t=t||{},this.sourceTexture=e,this.resolution=t.resolution||512,this.views=[{t:[1,0,0],u:[0,-1,0]},{t:[-1,0,0],u:[0,-1,0]},{t:[0,1,0],u:[0,0,1]},{t:[0,-1,0],u:[0,0,-1]},{t:[0,0,1],u:[0,-1,0]},{t:[0,0,-1],u:[0,-1,0]}];var r={format:t.format||this.sourceTexture.format,magFilter:this.sourceTexture.magFilter,minFilter:this.sourceTexture.minFilter,type:t.type||this.sourceTexture.type,generateMipmaps:this.sourceTexture.generateMipmaps,anisotropy:this.sourceTexture.anisotropy,encoding:this.sourceTexture.encoding};this.renderTarget=new WebGLRenderTargetCube(this.resolution,this.resolution,r)};return n.prototype={constructor:n,update:function(n){var i=n.getRenderTarget();r.material.uniforms.equirectangularMap.value=this.sourceTexture;for(var o=0;o<6;o++){var a=this.views[o];e.position.set(0,0,0),e.up.set(a.u[0],a.u[1],a.u[2]),e.lookAt(a.t[0],a.t[1],a.t[2]),n.setRenderTarget(this.renderTarget,o),n.clear(),n.render(t,e)}return n.setRenderTarget(i),this.renderTarget.texture},dispose:function(){this.renderTarget.dispose()}},n}();function DataTextureLoader(e){this.manager=void 0!==e?e:DefaultLoadingManager,this._parser=null}Object.assign(DataTextureLoader.prototype,{load:function(e,t,r,n){var i=this,o=new DataTexture,a=new FileLoader(this.manager);return a.setResponseType("arraybuffer"),a.setPath(this.path),a.load(e,function(e){var r=i._parser(e);r&&(void 0!==r.image?o.image=r.image:void 0!==r.data&&(o.image.width=r.width,o.image.height=r.height,o.image.data=r.data),o.wrapS=void 0!==r.wrapS?r.wrapS:ClampToEdgeWrapping,o.wrapT=void 0!==r.wrapT?r.wrapT:ClampToEdgeWrapping,o.magFilter=void 0!==r.magFilter?r.magFilter:LinearFilter,o.minFilter=void 0!==r.minFilter?r.minFilter:LinearMipMapLinearFilter,o.anisotropy=void 0!==r.anisotropy?r.anisotropy:1,void 0!==r.format&&(o.format=r.format),void 0!==r.type&&(o.type=r.type),void 0!==r.mipmaps&&(o.mipmaps=r.mipmaps),1===r.mipmapCount&&(o.minFilter=LinearFilter),o.needsUpdate=!0,t&&t(o,r))},r,n),o},setPath:function(e){return this.path=e,this}});var EXRLoader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager};EXRLoader.prototype=Object.create(DataTextureLoader.prototype),EXRLoader.prototype._parser=function(e){var t=65536,r=t>>3,n=14,i=65537,o=1<<n,a=o-1,s=59,l=63,u=2+l-s,c=8,h=4,p=4,f=2,d=1;var m={l:0,c:0,lc:0};function v(e,t,r,n,i){for(;r<e;)t=t<<8|D(n,i),r+=8;r-=e,m.l=t>>r&(1<<e)-1,m.c=t,m.lc=r}var g=new Array(59);function y(e,t,r,n,o,a,c){for(var h=r,p=0,f=0;o<=a;o++){if(h.value-r.value>n)return!1;v(6,p,f,e,h);var d=m.l;if(p=m.c,f=m.lc,c[o]=d,d==l){if(h.value-r.value>n)throw"Something wrong with hufUnpackEncTable";v(8,p,f,e,h);var y=m.l+u;if(p=m.c,f=m.lc,o+y>a+1)throw"Something wrong with hufUnpackEncTable";for(;y--;)c[o++]=0;o--}else if(d>=s){if(o+(y=d-s+2)>a+1)throw"Something wrong with hufUnpackEncTable";for(;y--;)c[o++]=0;o--}}!function(e){for(var t=0;t<=58;++t)g[t]=0;for(t=0;t<i;++t)g[e[t]]+=1;var r=0;for(t=58;t>0;--t){var n=r+g[t]>>1;g[t]=r,r=n}for(t=0;t<i;++t){var o=e[t];o>0&&(e[t]=o|g[o]++<<6)}}(c)}function b(e){return 63&e}function x(e){return e>>6}var w={c:0,lc:0};function S(e,t,r,n){e=e<<8|D(r,n),t+=8,w.c=e,w.lc=t}var M={c:0,lc:0};function _(e,t,r,n,i,o,a,s,l,u){if(e==t){n<8&&(S(r,n,i,a),r=w.c,n=w.lc);var c=r>>(n-=8);c=new Uint8Array([c])[0];if(l.value+c>u)return!1;for(var h=s[l.value-1];c-- >0;)s[l.value++]=h}else{if(!(l.value<u))return!1;s[l.value++]=e}M.c=r,M.lc=n}function T(e){var t=function(e){return 65535&e}(e);return t>32767?t-65536:t}var A={a:0,b:0};function C(e,t){var r=T(e),n=T(t),i=r+(1&n)+(n>>1),o=i,a=i-n;A.a=o,A.b=a}function E(e,t,r,n,i,o,a){for(var s,l=r>i?i:r,u=1;u<=l;)u<<=1;for(s=u>>=1,u>>=1;u>=1;){for(var c,h,p,f,d=0,m=d+o*(i-s),v=o*u,g=o*s,y=n*u,b=n*s;d<=m;d+=g){for(var x=d,w=d+n*(r-s);x<=w;x+=b){var S=x+y,M=(_=x+v)+y;C(t[x+e],t[_+e]),c=A.a,p=A.b,C(t[S+e],t[M+e]),h=A.a,f=A.b,C(c,h),t[x+e]=A.a,t[S+e]=A.b,C(p,f),t[_+e]=A.a,t[M+e]=A.b}if(r&u){var _=x+v;C(t[x+e],t[_+e]),c=A.a,t[_+e]=A.b,t[x+e]=c}}if(i&u)for(x=d,w=d+n*(r-s);x<=w;x+=b){S=x+y;C(t[x+e],t[S+e]),c=A.a,t[S+e]=A.b,t[x+e]=c}s=u,u>>=1}return d}function L(e,t,r,s,l,u,c){var h=r.value,p=R(t,r),f=R(t,r);r.value+=4;var d=R(t,r);if(r.value+=4,p<0||p>=i||f<0||f>=i)throw"Something wrong with HUF_ENCSIZE";var m=new Array(i),v=new Array(o);if(function(e){for(var t=0;t<o;t++)e[t]={},e[t].len=0,e[t].lit=0,e[t].p=null}(v),y(e,0,r,s-(r.value-h),p,f,m),d>8*(s-(r.value-h)))throw"Something wrong with hufUncompress";!function(e,t,r,i){for(;t<=r;t++){var o=x(e[t]),a=b(e[t]);if(o>>a)throw"Invalid table entry";if(a>n){if((c=i[o>>a-n]).len)throw"Invalid table entry";if(c.lit++,c.p){var s=c.p;c.p=new Array(c.lit);for(var l=0;l<c.lit-1;++l)c.p[l]=s[l]}else c.p=new Array(1);c.p[c.lit-1]=t}else if(a){var u=0;for(l=1<<n-a;l>0;l--){var c;if((c=i[(o<<n-a)+u]).len||c.p)throw"Invalid table entry";c.len=a,c.lit=t,u++}}}}(m,p,f,v),function(e,t,r,i,o,s,l,u,c,h){for(var p=0,f=0,d=u,m=Math.trunc(o.value+(s+7)/8);o.value<m;)for(S(p,f,r,o),p=w.c,f=w.lc;f>=n;)if((T=t[p>>f-n&a]).len)f-=T.len,_(T.lit,l,p,f,r,0,o,c,h,d),p=M.c,f=M.lc;else{if(!T.p)throw"hufDecode issues";var v;for(v=0;v<T.lit;v++){for(var g=b(e[T.p[v]]);f<g&&o.value<m;)S(p,f,r,o),p=w.c,f=w.lc;if(f>=g&&x(e[T.p[v]])==(p>>f-g&(1<<g)-1)){f-=g,_(T.p[v],l,p,f,r,0,o,c,h,d),p=M.c,f=M.lc;break}}if(v==T.lit)throw"hufDecode issues"}var y=8-s&7;for(p>>=y,f-=y;f>0;){var T;if(!(T=t[p<<n-f&a]).len)throw"hufDecode issues";f-=T.len,_(T.lit,l,p,f,r,0,o,c,h,d),p=M.c,f=M.lc}}(m,v,e,0,r,d,f,c,l,u)}function N(e,n,i,o,a,s,l,u,c,h){var p=new Uint8Array(r),f=B(o,a),d=B(o,a);if(d>=r)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(f<=d)for(var m=0;m<d-f+1;m++)p[m+f]=F(o,a);var v=new Uint16Array(t);!function(e,r){for(var n=0,i=0;i<t;++i)(0==i||e[i>>3]&1<<(7&i))&&(r[n++]=i);for(var o=n-1;n<t;)r[n++]=0}(p,v);L(i,o,a,R(o,a),e,n,s);var g=new Array(l),y=0;for(m=0;m<l;m++){u[m];g[m]={},g[m].start=y,g[m].end=g[m].start,g[m].nx=c,g[m].ny=h,g[m].size=1,y+=g[m].nx*g[m].ny*g[m].size}var b=0;for(m=0;m<l;m++)for(var x=0;x<g[m].size;++x)b+=E(x+b,e,g[m].nx,g[m].size,g[m].ny,g[m].nx*g[m].size);return function(e,t,r){for(var n=0;n<r;++n)t[n]=e[t[n]]}(v,e,y),!0}function P(e,t){for(var r=new Uint8Array(e),n=0;0!=r[t.value+n];)n+=1;var i=(new TextDecoder).decode(r.slice(t.value,t.value+n));return t.value=t.value+n+1,i}function O(e,t){var r=e.getUint32(0,!0);return t.value=t.value+c,r}function R(e,t){var r=e.getUint32(t.value,!0);return t.value=t.value+p,r}function D(e,t){var r=e[t.value];return t.value=t.value+d,r}function F(e,t){var r=e.getUint8(t.value);return t.value=t.value+d,r}function k(e,t){var r=e.getFloat32(t.value,!0);return t.value+=h,r}function I(e){var t=(31744&e)>>10,r=1023&e;return(e>>15?-1:1)*(t?31===t?r?NaN:1/0:Math.pow(2,t-15)*(1+r/1024):r/1024*6103515625e-14)}function B(e,t){var r=e.getUint16(t.value,!0);return t.value+=f,r}function U(e,t){return I(B(e,t))}function V(e,t,r,n,i){if("string"===n||"iccProfile"===n)return function(e,t,r){var n=(new TextDecoder).decode(new Uint8Array(e).slice(t.value,t.value+r));return t.value=t.value+r,n}(t,r,i);if("chlist"===n)return function(e,t,r,n){for(var i=r.value,o=[];r.value<i+n-1;){var a=P(t,r),s=R(e,r),l=F(e,r);r.value+=3;var u=R(e,r),c=R(e,r);o.push({name:a,pixelType:s,pLinear:l,xSampling:u,ySampling:c})}return r.value+=1,o}(e,t,r,i);if("chromaticities"===n)return function(e,t){return{redX:k(e,t),redY:k(e,t),greenX:k(e,t),greenY:k(e,t),blueX:k(e,t),blueY:k(e,t),whiteX:k(e,t),whiteY:k(e,t)}}(e,r);if("compression"===n)return function(e,t){return["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"][F(e,t)]}(e,r);if("box2i"===n)return function(e,t){return{xMin:R(e,t),yMin:R(e,t),xMax:R(e,t),yMax:R(e,t)}}(e,r);if("lineOrder"===n)return function(e,t){return["INCREASING_Y"][F(e,t)]}(e,r);if("float"===n)return k(e,r);if("v2f"===n)return function(e,t){return[k(e,t),k(e,t)]}(e,r);if("int"===n)return R(e,r);throw"Cannot parse value for unsupported type: "+n}for(var j=new DataView(e),z=new Uint8Array(e),G={},W=(j.getUint32(0,!0),j.getUint8(4,!0),j.getUint8(5,!0),{value:8}),H=!0;H;){var X=P(e,W);if(0==X)H=!1;else{var q=V(j,e,W,P(e,W),R(j,W));G[X]=q}}var Y=G.dataWindow.yMax+1,K=1;"PIZ_COMPRESSION"===G.compression&&(K=32);for(var Q=Y/K,J=0;J<Q;J++)O(j,W);var Z=G.dataWindow.xMax-G.dataWindow.xMin+1,$=G.dataWindow.yMax-G.dataWindow.yMin+1,ee=G.channels.length,te=new Float32Array(Z*$*ee),re={R:0,G:1,B:2,A:3};if("NO_COMPRESSION"===G.compression)for(var ne=0;ne<$;ne++)for(var ie=R(j,W),oe=(R(j,W),0);oe<G.channels.length;oe++){var ae=re[G.channels[oe].name];if(1!==G.channels[oe].pixelType)throw"EXRLoader._parser: unsupported pixelType "+G.channels[oe].pixelType+". Only pixelType is 1 (HALF) is supported.";for(var se=0;se<Z;se++){var le=U(j,W);te[Z*ee*($-ie)+se*ee+ae]=le}}else{if("PIZ_COMPRESSION"!==G.compression)throw"EXRLoader._parser: "+G.compression+" is unsupported";for(var ue=0;ue<$/K;ue++){R(j,W),R(j,W);var ce=Z*K*(2*G.channels.length),he=new Uint16Array(ce);N(he,{value:0},z,j,W,ce,ee,G.channels,Z,K);for(var pe=0;pe<K;pe++)for(oe=0;oe<G.channels.length;oe++){ae=re[G.channels[oe].name];if(1!==G.channels[oe].pixelType)throw"EXRLoader._parser: unsupported pixelType "+G.channels[oe].pixelType+". Only pixelType is 1 (HALF) is supported.";for(se=0;se<Z;se++){le=I(he[oe*(K*Z)+pe*Z+se]);te[Z*ee*($-(pe+ue*K))+se*ee+ae]=le}}}}return{header:G,width:Z,height:$,data:te,format:4==G.channels.length?RGBAFormat:RGBFormat,type:FloatType}};var FBXLoader=function(){var e,t,r;function n(e){this.manager=void 0!==e?e:DefaultLoadingManager}function i(e){this.textureLoader=e}function o(){}function a(){}function s(){}function l(){}function u(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t}function c(){}function h(e){var t=e.match(/FBXVersion: (\d+)/);if(t)return parseInt(t[1]);throw new Error("FBXLoader: Cannot find the version number for the file given.")}function p(e){return e/46186158e3}n.prototype={constructor:n,crossOrigin:"anonymous",load:function(e,t,r,n){var i=this,o=void 0===i.path?LoaderUtils.extractUrlBase(e):i.path,a=new FileLoader(this.manager);a.setPath(i.path),a.setResponseType("arraybuffer"),a.load(e,function(r){try{t(i.parse(r,o))}catch(a){setTimeout(function(){n&&n(a),i.manager.itemError(e)},0)}},r,n)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(t,r){if(function(e){var t="Kaydara FBX Binary  \0";return e.byteLength>=t.length&&t===x(e,0,t.length)}(t))e=(new l).parse(t);else{var n=x(t);if(!function(e){var t=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],r=0;function n(t){var n=e[t-1];return e=e.slice(r+t),r++,n}for(var i=0;i<t.length;++i){var o=n(1);if(o===t[i])return!1}return!0}(n))throw new Error("FBXLoader: Unknown format.");if(h(n)<7e3)throw new Error("FBXLoader: FBX version not supported, FileVersion: "+h(n));e=(new s).parse(n)}return new i(new TextureLoader(this.manager).setPath(this.resourcePath||r).setCrossOrigin(this.crossOrigin)).parse(e)}},i.prototype={constructor:i,parse:function(){t=this.parseConnections();var e=this.parseImages(),n=this.parseTextures(e),i=this.parseMaterials(n),a=this.parseDeformers(),s=(new o).parse(a);return this.parseScene(a,s,i),r},parseConnections:function(){var t=new Map;"Connections"in e&&e.Connections.connections.forEach(function(e){var r=e[0],n=e[1],i=e[2];t.has(r)||t.set(r,{parents:[],children:[]});var o={ID:n,relationship:i};t.get(r).parents.push(o),t.has(n)||t.set(n,{parents:[],children:[]});var a={ID:r,relationship:i};t.get(n).children.push(a)});return t},parseImages:function(){var t={},r={};if("Video"in e.Objects){var n=e.Objects.Video;for(var i in n){var o=n[i];if(t[u=parseInt(i)]=o.RelativeFilename||o.Filename,"Content"in o){var a=o.Content instanceof ArrayBuffer&&o.Content.byteLength>0,s="string"===typeof o.Content&&""!==o.Content;if(a||s){var l=this.parseImage(n[i]);r[o.RelativeFilename||o.Filename]=l}}}}for(var u in t){var c=t[u];void 0!==r[c]?t[u]=r[c]:t[u]=t[u].split("\\").pop()}return t},parseImage:function(e){var t,r=e.Content,n=e.RelativeFilename||e.Filename,i=n.slice(n.lastIndexOf(".")+1).toLowerCase();switch(i){case"bmp":t="image/bmp";break;case"jpg":case"jpeg":t="image/jpeg";break;case"png":t="image/png";break;case"tif":t="image/tiff";break;case"tga":if("function"!==typeof TGALoader)return void console.warn("FBXLoader: TGALoader is required to load TGA textures");if(null===Loader.Handlers.get(".tga")){var o=new TGALoader;o.setPath(this.textureLoader.path),Loader.Handlers.add(/\.tga$/i,o)}t="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+i+'" is not supported.')}if("string"===typeof r)return"data:"+t+";base64,"+r;var a=new Uint8Array(r);return window.URL.createObjectURL(new Blob([a],{type:t}))},parseTextures:function(t){var r=new Map;if("Texture"in e.Objects){var n=e.Objects.Texture;for(var i in n){var o=this.parseTexture(n[i],t);r.set(parseInt(i),o)}}return r},parseTexture:function(e,t){var r=this.loadTexture(e,t);r.ID=e.id,r.name=e.attrName;var n=e.WrapModeU,i=e.WrapModeV,o=void 0!==n?n.value:0,a=void 0!==i?i.value:0;if(r.wrapS=0===o?RepeatWrapping:ClampToEdgeWrapping,r.wrapT=0===a?RepeatWrapping:ClampToEdgeWrapping,"Scaling"in e){var s=e.Scaling.value;r.repeat.x=s[0],r.repeat.y=s[1]}return r},loadTexture:function(e,r){var n,i,o=this.textureLoader.path,a=t.get(e.id).children;void 0!==a&&a.length>0&&void 0!==r[a[0].ID]&&(0!==(n=r[a[0].ID]).indexOf("blob:")&&0!==n.indexOf("data:")||this.textureLoader.setPath(void 0));var s=e.FileName.slice(-3).toLowerCase();if("tga"===s){var l=Loader.Handlers.get(".tga");null===l?(console.warn("FBXLoader: TGALoader not found, creating empty placeholder texture for",n),i=new Texture):i=l.load(n)}else"psd"===s?(console.warn("FBXLoader: PSD textures are not supported, creating empty placeholder texture for",n),i=new Texture):i=this.textureLoader.load(n);return this.textureLoader.setPath(o),i},parseMaterials:function(t){var r=new Map;if("Material"in e.Objects){var n=e.Objects.Material;for(var i in n){var o=this.parseMaterial(n[i],t);null!==o&&r.set(parseInt(i),o)}}return r},parseMaterial:function(e,r){var n=e.id,i=e.attrName,o=e.ShadingModel;if("object"===typeof o&&(o=o.value),!t.has(n))return null;var a,s=this.parseParameters(e,r,n);switch(o.toLowerCase()){case"phong":a=new MeshPhongMaterial;break;case"lambert":a=new MeshLambertMaterial;break;default:console.warn('FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',o),a=new MeshPhongMaterial}return a.setValues(s),a.name=i,a},parseParameters:function(e,r,n){var i={};e.BumpFactor&&(i.bumpScale=e.BumpFactor.value),e.Diffuse?i.color=(new Color).fromArray(e.Diffuse.value):e.DiffuseColor&&"Color"===e.DiffuseColor.type&&(i.color=(new Color).fromArray(e.DiffuseColor.value)),e.DisplacementFactor&&(i.displacementScale=e.DisplacementFactor.value),e.Emissive?i.emissive=(new Color).fromArray(e.Emissive.value):e.EmissiveColor&&"Color"===e.EmissiveColor.type&&(i.emissive=(new Color).fromArray(e.EmissiveColor.value)),e.EmissiveFactor&&(i.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(i.opacity=parseFloat(e.Opacity.value)),i.opacity<1&&(i.transparent=!0),e.ReflectionFactor&&(i.reflectivity=e.ReflectionFactor.value),e.Shininess&&(i.shininess=e.Shininess.value),e.Specular?i.specular=(new Color).fromArray(e.Specular.value):e.SpecularColor&&"Color"===e.SpecularColor.type&&(i.specular=(new Color).fromArray(e.SpecularColor.value));var o=this;return t.get(n).children.forEach(function(e){var t=e.relationship;switch(t){case"Bump":i.bumpMap=o.getTexture(r,e.ID);break;case"Maya|TEX_ao_map":i.aoMap=o.getTexture(r,e.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":i.map=o.getTexture(r,e.ID);break;case"DisplacementColor":i.displacementMap=o.getTexture(r,e.ID);break;case"EmissiveColor":i.emissiveMap=o.getTexture(r,e.ID);break;case"NormalMap":case"Maya|TEX_normal_map":i.normalMap=o.getTexture(r,e.ID);break;case"ReflectionColor":i.envMap=o.getTexture(r,e.ID),i.envMap.mapping=EquirectangularReflectionMapping;break;case"SpecularColor":i.specularMap=o.getTexture(r,e.ID);break;case"TransparentColor":i.alphaMap=o.getTexture(r,e.ID),i.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("FBXLoader: %s map is not supported in three.js, skipping texture.",t)}}),i},getTexture:function(r,n){return"LayeredTexture"in e.Objects&&n in e.Objects.LayeredTexture&&(console.warn("FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),n=t.get(n).children[0].ID),r.get(n)},parseDeformers:function(){var r={},n={};if("Deformer"in e.Objects){var i=e.Objects.Deformer;for(var o in i){var a=i[o],s=t.get(parseInt(o));if("Skin"===a.attrType){var l=this.parseSkeleton(s,i);l.ID=o,s.parents.length>1&&console.warn("FBXLoader: skeleton attached to more than one geometry is not supported."),l.geometryID=s.parents[0].ID,r[o]=l}else if("BlendShape"===a.attrType){var u={id:o};u.rawTargets=this.parseMorphTargets(s,i),u.id=o,s.parents.length>1&&console.warn("FBXLoader: morph target attached to more than one geometry is not supported."),n[o]=u}}}return{skeletons:r,morphTargets:n}},parseSkeleton:function(e,t){var r=[];return e.children.forEach(function(e){var n=t[e.ID];if("Cluster"===n.attrType){var i={ID:e.ID,indices:[],weights:[],transformLink:(new Matrix4).fromArray(n.TransformLink.a)};"Indexes"in n&&(i.indices=n.Indexes.a,i.weights=n.Weights.a),r.push(i)}}),{rawBones:r,bones:[]}},parseMorphTargets:function(e,r){for(var n=[],i=0;i<e.children.length;i++){var o=e.children[i],a=r[o.ID],s={name:a.attrName,initialWeight:a.DeformPercent,id:a.id,fullWeights:a.FullWeights.a};if("BlendShapeChannel"!==a.attrType)return;s.geoID=t.get(parseInt(o.ID)).children.filter(function(e){return void 0===e.relationship})[0].ID,n.push(s)}return n},parseScene:function(n,i,o){r=new Group;var s=this.parseModels(n.skeletons,i,o),l=e.Objects.Model,u=this;s.forEach(function(e){var n=l[e.ID];u.setLookAtProperties(e,n),t.get(e.ID).parents.forEach(function(t){var r=s.get(t.ID);void 0!==r&&r.add(e)}),null===e.parent&&r.add(e)}),this.bindSkeleton(n.skeletons,i,s),this.createAmbientLight(),this.setupMorphMaterials(),r.traverse(function(e){if(e.userData.transformData){e.parent&&(e.userData.transformData.parentMatrixWorld=e.parent.matrix);var t=g(e.userData.transformData);e.applyMatrix(t)}});var c=(new a).parse();1===r.children.length&&r.children[0].isGroup&&(r.children[0].animations=c,r=r.children[0]),r.animations=c},parseModels:function(r,n,i){var o=new Map,a=e.Objects.Model;for(var s in a){var l=parseInt(s),u=a[s],c=t.get(l),h=this.buildSkeleton(c,r,l,u.attrName);if(!h){switch(u.attrType){case"Camera":h=this.createCamera(c);break;case"Light":h=this.createLight(c);break;case"Mesh":h=this.createMesh(c,n,i);break;case"NurbsCurve":h=this.createCurve(c,n);break;case"LimbNode":case"Root":h=new Bone;break;case"Null":default:h=new Group}h.name=PropertyBinding.sanitizeNodeName(u.attrName),h.ID=l}this.getTransformData(h,u),o.set(l,h)}return o},buildSkeleton:function(e,t,r,n){var i=null;return e.parents.forEach(function(e){for(var o in t){var a=t[o];a.rawBones.forEach(function(t,o){if(t.ID===e.ID){var s=i;(i=new Bone).matrixWorld.copy(t.transformLink),i.name=PropertyBinding.sanitizeNodeName(n),i.ID=r,a.bones[o]=i,null!==s&&i.add(s)}})}}),i},createCamera:function(t){var r,n;if(t.children.forEach(function(t){var r=e.Objects.NodeAttribute[t.ID];void 0!==r&&(n=r)}),void 0===n)r=new Object3D;else{var i=0;void 0!==n.CameraProjectionType&&1===n.CameraProjectionType.value&&(i=1);var o=1;void 0!==n.NearPlane&&(o=n.NearPlane.value/1e3);var a=1e3;void 0!==n.FarPlane&&(a=n.FarPlane.value/1e3);var s=window.innerWidth,l=window.innerHeight;void 0!==n.AspectWidth&&void 0!==n.AspectHeight&&(s=n.AspectWidth.value,l=n.AspectHeight.value);var u=s/l,c=45;void 0!==n.FieldOfView&&(c=n.FieldOfView.value);var h=n.FocalLength?n.FocalLength.value:null;switch(i){case 0:r=new PerspectiveCamera(c,u,o,a),null!==h&&r.setFocalLength(h);break;case 1:r=new OrthographicCamera(-s/2,s/2,l/2,-l/2,o,a);break;default:console.warn("FBXLoader: Unknown camera type "+i+"."),r=new Object3D}}return r},createLight:function(t){var r,n;if(t.children.forEach(function(t){var r=e.Objects.NodeAttribute[t.ID];void 0!==r&&(n=r)}),void 0===n)r=new Object3D;else{var i;i=void 0===n.LightType?0:n.LightType.value;var o=16777215;void 0!==n.Color&&(o=(new Color).fromArray(n.Color.value));var a=void 0===n.Intensity?1:n.Intensity.value/100;void 0!==n.CastLightOnObject&&0===n.CastLightOnObject.value&&(a=0);var s=0;void 0!==n.FarAttenuationEnd&&(s=void 0!==n.EnableFarAttenuation&&0===n.EnableFarAttenuation.value?0:n.FarAttenuationEnd.value);switch(i){case 0:r=new PointLight(o,a,s,1);break;case 1:r=new DirectionalLight(o,a);break;case 2:var l=Math.PI/3;void 0!==n.InnerAngle&&(l=_Math.degToRad(n.InnerAngle.value));var u=0;void 0!==n.OuterAngle&&(u=_Math.degToRad(n.OuterAngle.value),u=Math.max(u,1)),r=new SpotLight(o,a,s,l,u,1);break;default:console.warn("FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a PointLight."),r=new PointLight(o,a)}void 0!==n.CastShadows&&1===n.CastShadows.value&&(r.castShadow=!0)}return r},createMesh:function(e,t,r){var n,i=null,o=null,a=[];return e.children.forEach(function(e){t.has(e.ID)&&(i=t.get(e.ID)),r.has(e.ID)&&a.push(r.get(e.ID))}),a.length>1?o=a:a.length>0?o=a[0]:(o=new MeshPhongMaterial({color:13421772}),a.push(o)),"color"in i.attributes&&a.forEach(function(e){e.vertexColors=VertexColors}),i.FBX_Deformer?(a.forEach(function(e){e.skinning=!0}),(n=new SkinnedMesh(i,o)).normalizeSkinWeights()):n=new Mesh(i,o),n},createCurve:function(e,t){return new Line(e.children.reduce(function(e,r){return t.has(r.ID)&&(e=t.get(r.ID)),e},null),new LineBasicMaterial({color:3342591,linewidth:1}))},getTransformData:function(e,t){var r={};"InheritType"in t&&(r.inheritType=parseInt(t.InheritType.value)),r.eulerOrder="RotationOrder"in t?y(t.RotationOrder.value):"ZYX","Lcl_Translation"in t&&(r.translation=t.Lcl_Translation.value),"PreRotation"in t&&(r.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(r.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(r.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(r.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(r.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(r.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(r.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(r.rotationPivot=t.RotationPivot.value),e.userData.transformData=r},setLookAtProperties:function(n,i){"LookAtProperty"in i&&t.get(n.ID).children.forEach(function(t){if("LookAtProperty"===t.relationship){var i=e.Objects.Model[t.ID];if("Lcl_Translation"in i){var o=i.Lcl_Translation.value;void 0!==n.target?(n.target.position.fromArray(o),r.add(n.target)):n.lookAt((new Vector3).fromArray(o))}}})},bindSkeleton:function(e,r,n){var i=this.parsePoseNodes();for(var o in e){var a=e[o];t.get(parseInt(a.ID)).parents.forEach(function(e){if(r.has(e.ID)){var o=e.ID;t.get(o).parents.forEach(function(e){n.has(e.ID)&&n.get(e.ID).bind(new Skeleton(a.bones),i[e.ID])})}})}},parsePoseNodes:function(){var t={};if("Pose"in e.Objects){var r=e.Objects.Pose;for(var n in r)if("BindPose"===r[n].attrType){var i=r[n].PoseNode;Array.isArray(i)?i.forEach(function(e){t[e.Node]=(new Matrix4).fromArray(e.Matrix.a)}):t[i.Node]=(new Matrix4).fromArray(i.Matrix.a)}}return t},createAmbientLight:function(){if("GlobalSettings"in e&&"AmbientColor"in e.GlobalSettings){var t=e.GlobalSettings.AmbientColor.value,n=t[0],i=t[1],o=t[2];if(0!==n||0!==i||0!==o){var a=new Color(n,i,o);r.add(new AmbientLight(a,1))}}},setupMorphMaterials:function(){var e=this;r.traverse(function(t){t.isMesh&&t.geometry.morphAttributes.position&&t.geometry.morphAttributes.position.length&&(Array.isArray(t.material)?t.material.forEach(function(r,n){e.setupMorphMaterial(t,r,n)}):e.setupMorphMaterial(t,t.material))})},setupMorphMaterial:function(e,t,n){var i=e.uuid,o=t.uuid,a=!1;if(r.traverse(function(e){e.isMesh&&(Array.isArray(e.material)?e.material.forEach(function(t){t.uuid===o&&e.uuid!==i&&(a=!0)}):e.material.uuid===o&&e.uuid!==i&&(a=!0))}),!0===a){var s=t.clone();s.morphTargets=!0,void 0===n?e.material=s:e.material[n]=s}else t.morphTargets=!0}},o.prototype={constructor:o,parse:function(r){var n=new Map;if("Geometry"in e.Objects){var i=e.Objects.Geometry;for(var o in i){var a=t.get(parseInt(o)),s=this.parseGeometry(a,i[o],r);n.set(parseInt(o),s)}}return n},parseGeometry:function(e,t,r){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,r);case"NurbsCurve":return this.parseNurbsGeometry(t)}},parseMeshGeometry:function(t,r,n){var i=n.skeletons,o=n.morphTargets,a=t.parents.map(function(t){return e.Objects.Model[t.ID]});if(0!==a.length){var s=t.children.reduce(function(e,t){return void 0!==i[t.ID]&&(e=i[t.ID]),e},null),l=t.children.reduce(function(e,t){return void 0!==o[t.ID]&&(e=o[t.ID]),e},null),u=a[0],c={};"RotationOrder"in u&&(c.eulerOrder=y(u.RotationOrder.value)),"InheritType"in u&&(c.inheritType=parseInt(u.InheritType.value)),"GeometricTranslation"in u&&(c.translation=u.GeometricTranslation.value),"GeometricRotation"in u&&(c.rotation=u.GeometricRotation.value),"GeometricScaling"in u&&(c.scale=u.GeometricScaling.value);var h=g(c);return this.genGeometry(r,s,l,h)}},genGeometry:function(e,t,r,n){var i=new BufferGeometry;e.attrName&&(i.name=e.attrName);var o=this.parseGeoNode(e,t),a=this.genBuffers(o),s=new Float32BufferAttribute(a.vertex,3);if(n.applyToBufferAttribute(s),i.addAttribute("position",s),a.colors.length>0&&i.addAttribute("color",new Float32BufferAttribute(a.colors,3)),t&&(i.addAttribute("skinIndex",new Uint16BufferAttribute(a.weightsIndices,4)),i.addAttribute("skinWeight",new Float32BufferAttribute(a.vertexWeights,4)),i.FBX_Deformer=t),a.normal.length>0){var l=new Float32BufferAttribute(a.normal,3);(new Matrix3).getNormalMatrix(n).applyToBufferAttribute(l),i.addAttribute("normal",l)}if(a.uvs.forEach(function(e,t){var r="uv"+(t+1).toString();0===t&&(r="uv"),i.addAttribute(r,new Float32BufferAttribute(a.uvs[t],2))}),o.material&&"AllSame"!==o.material.mappingType){var u=a.materialIndex[0],c=0;if(a.materialIndex.forEach(function(e,t){e!==u&&(i.addGroup(c,t-c,u),u=e,c=t)}),i.groups.length>0){var h=i.groups[i.groups.length-1],p=h.start+h.count;p!==a.materialIndex.length&&i.addGroup(p,a.materialIndex.length-p,u)}0===i.groups.length&&i.addGroup(0,a.materialIndex.length,a.materialIndex[0])}return this.addMorphTargets(i,e,r,n),i},parseGeoNode:function(e,t){var r={};if(r.vertexPositions=void 0!==e.Vertices?e.Vertices.a:[],r.vertexIndices=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(r.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(r.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(r.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){r.uv=[];for(var n=0;e.LayerElementUV[n];)r.uv.push(this.parseUVs(e.LayerElementUV[n])),n++}return r.weightTable={},null!==t&&(r.skeleton=t,t.rawBones.forEach(function(e,t){e.indices.forEach(function(n,i){void 0===r.weightTable[n]&&(r.weightTable[n]=[]),r.weightTable[n].push({id:t,weight:e.weights[i]})})})),r},genBuffers:function(e){var t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},r=0,n=0,i=!1,o=[],a=[],s=[],l=[],u=[],c=[],h=this;return e.vertexIndices.forEach(function(p,f){var m=!1;p<0&&(p^=-1,m=!0);var v=[],g=[];if(o.push(3*p,3*p+1,3*p+2),e.color){var y=d(f,r,p,e.color);s.push(y[0],y[1],y[2])}if(e.skeleton){if(void 0!==e.weightTable[p]&&e.weightTable[p].forEach(function(e){g.push(e.weight),v.push(e.id)}),g.length>4){i||(console.warn("FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),i=!0);var b=[0,0,0,0],x=[0,0,0,0];g.forEach(function(e,t){var r=e,n=v[t];x.forEach(function(e,t,i){if(r>e){i[t]=r,r=e;var o=b[t];b[t]=n,n=o}})}),v=b,g=x}for(;g.length<4;)g.push(0),v.push(0);for(var w=0;w<4;++w)u.push(g[w]),c.push(v[w])}if(e.normal){y=d(f,r,p,e.normal);a.push(y[0],y[1],y[2])}if(e.material&&"AllSame"!==e.material.mappingType)var S=d(f,r,p,e.material)[0];e.uv&&e.uv.forEach(function(e,t){var n=d(f,r,p,e);void 0===l[t]&&(l[t]=[]),l[t].push(n[0]),l[t].push(n[1])}),n++,m&&(h.genFace(t,e,o,S,a,s,l,u,c,n),r++,n=0,o=[],a=[],s=[],l=[],u=[],c=[])}),t},genFace:function(e,t,r,n,i,o,a,s,l,u){for(var c=2;c<u;c++)e.vertex.push(t.vertexPositions[r[0]]),e.vertex.push(t.vertexPositions[r[1]]),e.vertex.push(t.vertexPositions[r[2]]),e.vertex.push(t.vertexPositions[r[3*(c-1)]]),e.vertex.push(t.vertexPositions[r[3*(c-1)+1]]),e.vertex.push(t.vertexPositions[r[3*(c-1)+2]]),e.vertex.push(t.vertexPositions[r[3*c]]),e.vertex.push(t.vertexPositions[r[3*c+1]]),e.vertex.push(t.vertexPositions[r[3*c+2]]),t.skeleton&&(e.vertexWeights.push(s[0]),e.vertexWeights.push(s[1]),e.vertexWeights.push(s[2]),e.vertexWeights.push(s[3]),e.vertexWeights.push(s[4*(c-1)]),e.vertexWeights.push(s[4*(c-1)+1]),e.vertexWeights.push(s[4*(c-1)+2]),e.vertexWeights.push(s[4*(c-1)+3]),e.vertexWeights.push(s[4*c]),e.vertexWeights.push(s[4*c+1]),e.vertexWeights.push(s[4*c+2]),e.vertexWeights.push(s[4*c+3]),e.weightsIndices.push(l[0]),e.weightsIndices.push(l[1]),e.weightsIndices.push(l[2]),e.weightsIndices.push(l[3]),e.weightsIndices.push(l[4*(c-1)]),e.weightsIndices.push(l[4*(c-1)+1]),e.weightsIndices.push(l[4*(c-1)+2]),e.weightsIndices.push(l[4*(c-1)+3]),e.weightsIndices.push(l[4*c]),e.weightsIndices.push(l[4*c+1]),e.weightsIndices.push(l[4*c+2]),e.weightsIndices.push(l[4*c+3])),t.color&&(e.colors.push(o[0]),e.colors.push(o[1]),e.colors.push(o[2]),e.colors.push(o[3*(c-1)]),e.colors.push(o[3*(c-1)+1]),e.colors.push(o[3*(c-1)+2]),e.colors.push(o[3*c]),e.colors.push(o[3*c+1]),e.colors.push(o[3*c+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(n),e.materialIndex.push(n),e.materialIndex.push(n)),t.normal&&(e.normal.push(i[0]),e.normal.push(i[1]),e.normal.push(i[2]),e.normal.push(i[3*(c-1)]),e.normal.push(i[3*(c-1)+1]),e.normal.push(i[3*(c-1)+2]),e.normal.push(i[3*c]),e.normal.push(i[3*c+1]),e.normal.push(i[3*c+2])),t.uv&&t.uv.forEach(function(t,r){void 0===e.uvs[r]&&(e.uvs[r]=[]),e.uvs[r].push(a[r][0]),e.uvs[r].push(a[r][1]),e.uvs[r].push(a[r][2*(c-1)]),e.uvs[r].push(a[r][2*(c-1)+1]),e.uvs[r].push(a[r][2*c]),e.uvs[r].push(a[r][2*c+1])})},addMorphTargets:function(t,r,n,i){if(null!==n){t.morphAttributes.position=[];var o=this;n.rawTargets.forEach(function(n){var a=e.Objects.Geometry[n.geoID];void 0!==a&&o.genMorphGeometry(t,r,a,i,n.name)})}},genMorphGeometry:function(e,t,r,n,i){var o=new BufferGeometry;r.attrName&&(o.name=r.attrName);for(var a=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],s=void 0!==t.Vertices?t.Vertices.a.slice():[],l=void 0!==r.Vertices?r.Vertices.a:[],u=void 0!==r.Indexes?r.Indexes.a:[],c=0;c<u.length;c++){var h=3*u[c];s[h]+=l[3*c],s[h+1]+=l[3*c+1],s[h+2]+=l[3*c+2]}var p={vertexIndices:a,vertexPositions:s},f=new Float32BufferAttribute(this.genBuffers(p).vertex,3);f.name=i||r.attrName,n.applyToBufferAttribute(f),e.morphAttributes.position.push(f)},parseNormals:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,n=e.Normals.a,i=[];return"IndexToDirect"===r&&("NormalIndex"in e?i=e.NormalIndex.a:"NormalsIndex"in e&&(i=e.NormalsIndex.a)),{dataSize:3,buffer:n,indices:i,mappingType:t,referenceType:r}},parseUVs:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,n=e.UV.a,i=[];return"IndexToDirect"===r&&(i=e.UVIndex.a),{dataSize:2,buffer:n,indices:i,mappingType:t,referenceType:r}},parseVertexColors:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,n=e.Colors.a,i=[];return"IndexToDirect"===r&&(i=e.ColorIndex.a),{dataSize:4,buffer:n,indices:i,mappingType:t,referenceType:r}},parseMaterialIndices:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:r};for(var n=e.Materials.a,i=[],o=0;o<n.length;++o)i.push(o);return{dataSize:1,buffer:n,indices:i,mappingType:t,referenceType:r}},parseNurbsGeometry:function(e){if(void 0===NURBSCurve)return console.error("FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new BufferGeometry;var t=parseInt(e.Order);if(isNaN(t))return console.error("FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new BufferGeometry;for(var r,n,i=t-1,o=e.KnotVector.a,a=[],s=e.Points.a,l=0,u=s.length;l<u;l+=4)a.push((new Vector4).fromArray(s,l));if("Closed"===e.Form)a.push(a[0]);else if("Periodic"===e.Form){r=i,n=o.length-1-r;for(l=0;l<i;++l)a.push(a[l])}var c=new NURBSCurve(i,o,a,r,n).getPoints(7*a.length),h=new Float32Array(3*c.length);c.forEach(function(e,t){e.toArray(h,3*t)});var p=new BufferGeometry;return p.addAttribute("position",new BufferAttribute(h,3)),p}},a.prototype={constructor:a,parse:function(){var e=[],t=this.parseClips();if(void 0!==t)for(var r in t){var n=t[r],i=this.addClip(n);e.push(i)}return e},parseClips:function(){if(void 0!==e.Objects.AnimationCurve){var t=this.parseAnimationCurveNodes();this.parseAnimationCurves(t);var r=this.parseAnimationLayers(t);return this.parseAnimStacks(r)}},parseAnimationCurveNodes:function(){var t=e.Objects.AnimationCurveNode,r=new Map;for(var n in t){var i=t[n];if(null!==i.attrName.match(/S|R|T|DeformPercent/)){var o={id:i.id,attr:i.attrName,curves:{}};r.set(o.id,o)}}return r},parseAnimationCurves:function(r){var n=e.Objects.AnimationCurve;for(var i in n){var o={id:n[i].id,times:n[i].KeyTime.a.map(p),values:n[i].KeyValueFloat.a},a=t.get(o.id);if(void 0!==a){var s=a.parents[0].ID,l=a.parents[0].relationship;l.match(/X/)?r.get(s).curves.x=o:l.match(/Y/)?r.get(s).curves.y=o:l.match(/Z/)?r.get(s).curves.z=o:l.match(/d|DeformPercent/)&&r.has(s)&&(r.get(s).curves.morph=o)}}},parseAnimationLayers:function(n){var i=e.Objects.AnimationLayer,o=new Map;for(var a in i){var s=[],l=t.get(parseInt(a));if(void 0!==l)l.children.forEach(function(i,o){if(n.has(i.ID)){var a=n.get(i.ID);if(void 0!==a.curves.x||void 0!==a.curves.y||void 0!==a.curves.z){if(void 0===s[o])if(void 0!==(f=t.get(i.ID).parents.filter(function(e){return void 0!==e.relationship})[0].ID)){var l=e.Objects.Model[f.toString()],u={modelName:PropertyBinding.sanitizeNodeName(l.attrName),ID:l.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};r.traverse(function(e){e.ID===l.id&&(u.transform=e.matrix,e.userData.transformData&&(u.eulerOrder=e.userData.transformData.eulerOrder))}),u.transform||(u.transform=new Matrix4),"PreRotation"in l&&(u.preRotation=l.PreRotation.value),"PostRotation"in l&&(u.postRotation=l.PostRotation.value),s[o]=u}s[o]&&(s[o][a.attr]=a)}else if(void 0!==a.curves.morph){if(void 0===s[o]){var c=t.get(i.ID).parents.filter(function(e){return void 0!==e.relationship})[0].ID,h=t.get(c).parents[0].ID,p=t.get(h).parents[0].ID,f=t.get(p).parents[0].ID;l=e.Objects.Model[f],u={modelName:PropertyBinding.sanitizeNodeName(l.attrName),morphName:e.Objects.Deformer[c].attrName};s[o]=u}s[o][a.attr]=a}}}),o.set(parseInt(a),s)}return o},parseAnimStacks:function(r){var n=e.Objects.AnimationStack,i={};for(var o in n){var a=t.get(parseInt(o)).children;a.length>1&&console.warn("FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");var s=r.get(a[0].ID);i[o]={name:n[o].attrName,layer:s}}return i},addClip:function(e){var t=[],r=this;return e.layer.forEach(function(e){t=t.concat(r.generateTracks(e))}),new AnimationClip(e.name,-1,t)},generateTracks:function(e){var t=[],r=new Vector3,n=new Quaternion,i=new Vector3;if(e.transform&&e.transform.decompose(r,n,i),r=r.toArray(),n=(new Euler).setFromQuaternion(n,e.eulerOrder).toArray(),i=i.toArray(),void 0!==e.T&&Object.keys(e.T.curves).length>0){var o=this.generateVectorTrack(e.modelName,e.T.curves,r,"position");void 0!==o&&t.push(o)}if(void 0!==e.R&&Object.keys(e.R.curves).length>0){var a=this.generateRotationTrack(e.modelName,e.R.curves,n,e.preRotation,e.postRotation,e.eulerOrder);void 0!==a&&t.push(a)}if(void 0!==e.S&&Object.keys(e.S.curves).length>0){var s=this.generateVectorTrack(e.modelName,e.S.curves,i,"scale");void 0!==s&&t.push(s)}if(void 0!==e.DeformPercent){var l=this.generateMorphTrack(e);void 0!==l&&t.push(l)}return t},generateVectorTrack:function(e,t,r,n){var i=this.getTimesForAllAxes(t);return new VectorKeyframeTrack(e+"."+n,i,this.getKeyframeTrackValues(i,t,r))},generateRotationTrack:function(e,t,r,n,i,o){void 0!==t.x&&(this.interpolateRotations(t.x),t.x.values=t.x.values.map(_Math.degToRad)),void 0!==t.y&&(this.interpolateRotations(t.y),t.y.values=t.y.values.map(_Math.degToRad)),void 0!==t.z&&(this.interpolateRotations(t.z),t.z.values=t.z.values.map(_Math.degToRad));var a=this.getTimesForAllAxes(t),s=this.getKeyframeTrackValues(a,t,r);void 0!==n&&((n=n.map(_Math.degToRad)).push(o),n=(new Euler).fromArray(n),n=(new Quaternion).setFromEuler(n)),void 0!==i&&((i=i.map(_Math.degToRad)).push(o),i=(new Euler).fromArray(i),i=(new Quaternion).setFromEuler(i).inverse());for(var l=new Quaternion,u=new Euler,c=[],h=0;h<s.length;h+=3)u.set(s[h],s[h+1],s[h+2],o),l.setFromEuler(u),void 0!==n&&l.premultiply(n),void 0!==i&&l.multiply(i),l.toArray(c,h/3*4);return new QuaternionKeyframeTrack(e+".quaternion",a,c)},generateMorphTrack:function(e){var t=e.DeformPercent.curves.morph,n=t.values.map(function(e){return e/100}),i=r.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new NumberKeyframeTrack(e.modelName+".morphTargetInfluences["+i+"]",t.times,n)},getTimesForAllAxes:function(e){var t=[];return void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),t=t.sort(function(e,t){return e-t}).filter(function(e,t,r){return r.indexOf(e)==t})},getKeyframeTrackValues:function(e,t,r){var n=r,i=[],o=-1,a=-1,s=-1;return e.forEach(function(e){if(t.x&&(o=t.x.times.indexOf(e)),t.y&&(a=t.y.times.indexOf(e)),t.z&&(s=t.z.times.indexOf(e)),-1!==o){var r=t.x.values[o];i.push(r),n[0]=r}else i.push(n[0]);if(-1!==a){var l=t.y.values[a];i.push(l),n[1]=l}else i.push(n[1]);if(-1!==s){var u=t.z.values[s];i.push(u),n[2]=u}else i.push(n[2])}),i},interpolateRotations:function(e){for(var t=1;t<e.values.length;t++){var r=e.values[t-1],n=e.values[t]-r,i=Math.abs(n);if(i>=180){for(var o=i/180,a=n/o,s=r+a,l=e.times[t-1],u=(e.times[t]-l)/o,c=l+u,h=[],p=[];c<e.times[t];)h.push(c),c+=u,p.push(s),s+=a;e.times=w(e.times,t,h),e.values=w(e.values,t,p)}}}},s.prototype={constructor:s,getPrevNode:function(){return this.nodeStack[this.currentIndent-2]},getCurrentNode:function(){return this.nodeStack[this.currentIndent-1]},getCurrentProp:function(){return this.currentProp},pushStack:function(e){this.nodeStack.push(e),this.currentIndent+=1},popStack:function(){this.nodeStack.pop(),this.currentIndent-=1},setCurrentProp:function(e,t){this.currentProp=e,this.currentPropName=t},parse:function(e){this.currentIndent=0,this.allNodes=new c,this.nodeStack=[],this.currentProp=[],this.currentPropName="";var t=this,r=e.split(/[\r\n]+/);return r.forEach(function(e,n){var i=e.match(/^[\s\t]*;/),o=e.match(/^[\s\t]*$/);if(!i&&!o){var a=e.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),s=e.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),l=e.match("^\\t{"+(t.currentIndent-1)+"}}");a?t.parseNodeBegin(e,a):s?t.parseNodeProperty(e,s,r[++n]):l?t.popStack():e.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(e)}}),this.allNodes},parseNodeBegin:function(e,t){var r=t[1].trim().replace(/^"/,"").replace(/"$/,""),n=t[2].split(",").map(function(e){return e.trim().replace(/^"/,"").replace(/"$/,"")}),i={name:r},o=this.parseNodeAttr(n),a=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(r,i):r in a?("PoseNode"===r?a.PoseNode.push(i):void 0!==a[r].id&&(a[r]={},a[r][a[r].id]=a[r]),""!==o.id&&(a[r][o.id]=i)):"number"===typeof o.id?(a[r]={},a[r][o.id]=i):"Properties70"!==r&&(a[r]="PoseNode"===r?[i]:i),"number"===typeof o.id&&(i.id=o.id),""!==o.name&&(i.attrName=o.name),""!==o.type&&(i.attrType=o.type),this.pushStack(i)},parseNodeAttr:function(e){var t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));var r="",n="";return e.length>1&&(r=e[1].replace(/^(\w+)::/,""),n=e[2]),{id:t,name:r,type:n}},parseNodeProperty:function(e,t,r){var n=t[1].replace(/^"/,"").replace(/"$/,"").trim(),i=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===n&&","===i&&(i=r.replace(/"/g,"").replace(/,$/,"").trim());var o=this.getCurrentNode();if("Properties70"!==o.name){if("C"===n){var a=i.split(",").slice(1),s=parseInt(a[0]),l=parseInt(a[1]),u=i.split(",").slice(3);n="connections",function(e,t){for(var r=0,n=e.length,i=t.length;r<i;r++,n++)e[n]=t[r]}(i=[s,l],u=u.map(function(e){return e.trim().replace(/^"/,"")})),void 0===o[n]&&(o[n]=[])}"Node"===n&&(o.id=i),n in o&&Array.isArray(o[n])?o[n].push(i):"a"!==n?o[n]=i:o.a=i,this.setCurrentProp(o,n),"a"===n&&","!==i.slice(-1)&&(o.a=b(i))}else this.parseNodeSpecialProperty(e,n,i)},parseNodePropertyContinued:function(e){var t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=b(t.a))},parseNodeSpecialProperty:function(e,t,r){var n=r.split('",').map(function(e){return e.trim().replace(/^\"/,"").replace(/\s/,"_")}),i=n[0],o=n[1],a=n[2],s=n[3],l=n[4];switch(o){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":l=parseFloat(l);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":l=b(l)}this.getPrevNode()[i]={type:o,type2:a,flag:s,value:l},this.setCurrentProp(this.getPrevNode(),i)}},l.prototype={constructor:l,parse:function(e){var t=new u(e);t.skip(23);var r=t.getUint32();console.log("FBXLoader: FBX binary version: "+r);for(var n=new c;!this.endOfContent(t);){var i=this.parseNode(t,r);null!==i&&n.add(i.name,i)}return n},endOfContent:function(e){return e.size()%16===0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()},parseNode:function(e,t){var r={},n=t>=7500?e.getUint64():e.getUint32(),i=t>=7500?e.getUint64():e.getUint32(),o=(t>=7500?e.getUint64():e.getUint32(),e.getUint8()),a=e.getString(o);if(0===n)return null;for(var s=[],l=0;l<i;l++)s.push(this.parseProperty(e));var u=s.length>0?s[0]:"",c=s.length>1?s[1]:"",h=s.length>2?s[2]:"";for(r.singleProperty=1===i&&e.getOffset()===n;n>e.getOffset();){var p=this.parseNode(e,t);null!==p&&this.parseSubNode(a,r,p)}return r.propertyList=s,"number"===typeof u&&(r.id=u),""!==c&&(r.attrName=c),""!==h&&(r.attrType=h),""!==a&&(r.name=a),r},parseSubNode:function(e,t,r){if(!0===r.singleProperty){var n=r.propertyList[0];Array.isArray(n)?(t[r.name]=r,r.a=n):t[r.name]=n}else if("Connections"===e&&"C"===r.name){var i=[];r.propertyList.forEach(function(e,t){0!==t&&i.push(e)}),void 0===t.connections&&(t.connections=[]),t.connections.push(i)}else if("Properties70"===r.name){Object.keys(r).forEach(function(e){t[e]=r[e]})}else if("Properties70"===e&&"P"===r.name){var o,a=r.propertyList[0],s=r.propertyList[1],l=r.propertyList[2],u=r.propertyList[3];0===a.indexOf("Lcl ")&&(a=a.replace("Lcl ","Lcl_")),0===s.indexOf("Lcl ")&&(s=s.replace("Lcl ","Lcl_")),o="Color"===s||"ColorRGB"===s||"Vector"===s||"Vector3D"===s||0===s.indexOf("Lcl_")?[r.propertyList[4],r.propertyList[5],r.propertyList[6]]:r.propertyList[4],t[a]={type:s,type2:l,flag:u,value:o}}else void 0===t[r.name]?"number"===typeof r.id?(t[r.name]={},t[r.name][r.id]=r):t[r.name]=r:"PoseNode"===r.name?(Array.isArray(t[r.name])||(t[r.name]=[t[r.name]]),t[r.name].push(r)):void 0===t[r.name][r.id]&&(t[r.name][r.id]=r)},parseProperty:function(e){var t=e.getString(1);switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":var r=e.getUint32();return e.getArrayBuffer(r);case"S":r=e.getUint32();return e.getString(r);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var n=e.getUint32(),i=e.getUint32(),o=e.getUint32();if(0===i)switch(t){case"b":case"c":return e.getBooleanArray(n);case"d":return e.getFloat64Array(n);case"f":return e.getFloat32Array(n);case"i":return e.getInt32Array(n);case"l":return e.getInt64Array(n)}"undefined"===typeof Zlib&&console.error("FBXLoader: External library Inflate.min.js required, obtain or import from https://github.com/imaya/zlib.js");var a=new u(new Zlib.Inflate(new Uint8Array(e.getArrayBuffer(o))).decompress().buffer);switch(t){case"b":case"c":return a.getBooleanArray(n);case"d":return a.getFloat64Array(n);case"f":return a.getFloat32Array(n);case"i":return a.getInt32Array(n);case"l":return a.getInt64Array(n)}default:throw new Error("FBXLoader: Unknown property type "+t)}}},u.prototype={constructor:u,getOffset:function(){return this.offset},size:function(){return this.dv.buffer.byteLength},skip:function(e){this.offset+=e},getBoolean:function(){return 1===(1&this.getUint8())},getBooleanArray:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getBoolean());return t},getUint8:function(){var e=this.dv.getUint8(this.offset);return this.offset+=1,e},getInt16:function(){var e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e},getInt32:function(){var e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e},getInt32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt32());return t},getUint32:function(){var e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e},getInt64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,4294967295===(e=4294967295&~e)&&(t=t+1&4294967295),-(4294967296*t+(e=e+1&4294967295))):4294967296*t+e},getInt64Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt64());return t},getUint64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e},getFloat32:function(){var e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e},getFloat32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat32());return t},getFloat64:function(){var e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e},getFloat64Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat64());return t},getArrayBuffer:function(e){var t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t},getString:function(e){for(var t=[],r=0;r<e;r++)t[r]=this.getUint8();var n=t.indexOf(0);return n>=0&&(t=t.slice(0,n)),LoaderUtils.decodeText(new Uint8Array(t))}},c.prototype={constructor:c,add:function(e,t){this[e]=t}};var f=[];function d(e,t,r,n){var i;switch(n.mappingType){case"ByPolygonVertex":i=e;break;case"ByPolygon":i=t;break;case"ByVertice":i=r;break;case"AllSame":i=n.indices[0];break;default:console.warn("FBXLoader: unknown attribute mapping type "+n.mappingType)}"IndexToDirect"===n.referenceType&&(i=n.indices[i]);var o=i*n.dataSize,a=o+n.dataSize;return function(e,t,r,n){for(var i=r,o=0;i<n;i++,o++)e[o]=t[i];return e}(f,n.buffer,o,a)}var m=new Euler,v=new Vector3;function g(e){var t,r=new Matrix4,n=new Matrix4,i=new Matrix4,o=new Matrix4,a=new Matrix4,s=new Matrix4,l=new Matrix4,u=new Matrix4,c=new Matrix4,h=new Matrix4,p=new Matrix4,f=e.inheritType?e.inheritType:0;(e.translation&&r.setPosition(v.fromArray(e.translation)),e.preRotation)&&((t=e.preRotation.map(_Math.degToRad)).push(e.eulerOrder),n.makeRotationFromEuler(m.fromArray(t)));e.rotation&&((t=e.rotation.map(_Math.degToRad)).push(e.eulerOrder),i.makeRotationFromEuler(m.fromArray(t)));e.postRotation&&((t=e.postRotation.map(_Math.degToRad)).push(e.eulerOrder),o.makeRotationFromEuler(m.fromArray(t)));e.scale&&a.scale(v.fromArray(e.scale)),e.scalingOffset&&l.setPosition(v.fromArray(e.scalingOffset)),e.scalingPivot&&s.setPosition(v.fromArray(e.scalingPivot)),e.rotationOffset&&u.setPosition(v.fromArray(e.rotationOffset)),e.rotationPivot&&c.setPosition(v.fromArray(e.rotationPivot)),e.parentMatrixWorld&&(h=e.parentMatrixWorld);var d=n.multiply(i).multiply(o),g=new Matrix4;h.extractRotation(g);var y,b,x,w,S=new Matrix4;if(S.copyPosition(h),x=S.getInverse(S).multiply(h),b=g.getInverse(g).multiply(x),y=a,0===f)w=g.multiply(d).multiply(b).multiply(y);else if(1===f)w=g.multiply(b).multiply(d).multiply(y);else{var M=(new Matrix4).copy(a),_=b.multiply(M.getInverse(M));w=g.multiply(d).multiply(_).multiply(y)}var T=r.multiply(u).multiply(c).multiply(n).multiply(i).multiply(o).multiply(c.getInverse(c)).multiply(l).multiply(s).multiply(a).multiply(s.getInverse(s)),A=(new Matrix4).copyPosition(T),C=h.multiply(A);return p.copyPosition(C),T=p.multiply(w)}function y(e){var t=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===(e=e||0)?(console.warn("FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),t[0]):t[e]}function b(e){return e.split(",").map(function(e){return parseFloat(e)})}function x(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=e.byteLength),LoaderUtils.decodeText(new Uint8Array(e,t,r))}function w(e,t,r){return e.slice(0,t).concat(r).concat(e.slice(t))}return n}(),GCodeLoader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager,this.splitLayer=!1};GCodeLoader.prototype.load=function(e,t,r,n){var i=this,o=new FileLoader(i.manager);o.setPath(i.path),o.load(e,function(e){t(i.parse(e))},r,n)},GCodeLoader.prototype.setPath=function(e){return this.path=e,this},GCodeLoader.prototype.parse=function(e){var t={x:0,y:0,z:0,e:0,f:0,extruding:!1,relative:!1},r=[],n=void 0,i=new LineBasicMaterial({color:16711680});i.name="path";var o=new LineBasicMaterial({color:65280});function a(e){n={vertex:[],pathVertex:[],z:e.z},r.push(n)}function s(e,r){return t.relative?r:r-e}function l(e,r){return t.relative?e+r:r}o.name="extruded";for(var u,c,h=e.replace(/;.+/g,"").split("\n"),p=0;p<h.length;p++){var f=h[p].split(" "),d=f[0].toUpperCase(),m={};if(f.splice(1).forEach(function(e){if(void 0!==e[0]){var t=e[0].toLowerCase(),r=parseFloat(e.substring(1));m[t]=r}}),"G0"===d||"G1"===d){var v={x:void 0!==m.x?l(t.x,m.x):t.x,y:void 0!==m.y?l(t.y,m.y):t.y,z:void 0!==m.z?l(t.z,m.z):t.z,e:void 0!==m.e?l(t.e,m.e):t.e,f:void 0!==m.f?l(t.f,m.f):t.f};s(t.e,v.e)>0&&(v.extruding=s(t.e,v.e)>0,void 0!=n&&v.z==n.z||a(v)),u=t,c=v,void 0===n&&a(u),v.extruding?(n.vertex.push(u.x,u.y,u.z),n.vertex.push(c.x,c.y,c.z)):(n.pathVertex.push(u.x,u.y,u.z),n.pathVertex.push(c.x,c.y,c.z)),t=v}else if("G2"===d||"G3"===d)console.warn("GCodeLoader: Arc command not supported");else if("G90"===d)t.relative=!1;else if("G91"===d)t.relative=!0;else if("G92"===d){(v=t).x=void 0!==m.x?m.x:v.x,v.y=void 0!==m.y?m.y:v.y,v.z=void 0!==m.z?m.z:v.z,v.e=void 0!==m.e?m.e:v.e,t=v}else console.warn("GCodeLoader: Command not supported:"+d)}function g(e,t){var r=new BufferGeometry;r.addAttribute("position",new Float32BufferAttribute(e,3));var n=new LineSegments(r,t?o:i);n.name="layer"+p,y.add(n)}var y=new Group;if(y.name="gcode",this.splitLayer)for(p=0;p<r.length;p++){g((w=r[p]).vertex,!0),g(w.pathVertex,!1)}else{var b=[],x=[];for(p=0;p<r.length;p++){var w=r[p];b=b.concat(w.vertex),x=x.concat(w.pathVertex)}g(b,!0),g(x,!1)}return y.quaternion.setFromEuler(new Euler(-Math.PI/2,0,0)),y};var BufferGeometryUtils={computeTangents:function(e){var t=e.index,r=e.attributes;if(null!==t&&void 0!==r.position&&void 0!==r.normal&&void 0!==r.uv){var n=t.array,i=r.position.array,o=r.normal.array,a=r.uv.array,s=i.length/3;void 0===r.tangent&&e.addAttribute("tangent",new BufferAttribute(new Float32Array(4*s),4));for(var l=r.tangent.array,u=[],c=[],h=0;h<s;h++)u[h]=new Vector3,c[h]=new Vector3;var p=new Vector3,f=new Vector3,d=new Vector3,m=new Vector2,v=new Vector2,g=new Vector2,y=new Vector3,b=new Vector3,x=e.groups;0===x.length&&(x=[{start:0,count:n.length}]);h=0;for(var w=x.length;h<w;++h)for(var S=O=(P=x[h]).start,M=O+P.count;S<M;S+=3)R(n[S+0],n[S+1],n[S+2]);var _,T,A,C=new Vector3,E=new Vector3,L=new Vector3,N=new Vector3;for(h=0,w=x.length;h<w;++h){var P,O;for(S=O=(P=x[h]).start,M=O+P.count;S<M;S+=3)D(n[S+0]),D(n[S+1]),D(n[S+2])}}else console.warn("BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");function R(e,t,r){p.fromArray(i,3*e),f.fromArray(i,3*t),d.fromArray(i,3*r),m.fromArray(a,2*e),v.fromArray(a,2*t),g.fromArray(a,2*r);var n=f.x-p.x,o=d.x-p.x,s=f.y-p.y,l=d.y-p.y,h=f.z-p.z,x=d.z-p.z,w=v.x-m.x,S=g.x-m.x,M=v.y-m.y,_=g.y-m.y,T=1/(w*_-S*M);y.set((_*n-M*o)*T,(_*s-M*l)*T,(_*h-M*x)*T),b.set((w*o-S*n)*T,(w*l-S*s)*T,(w*x-S*h)*T),u[e].add(y),u[t].add(y),u[r].add(y),c[e].add(b),c[t].add(b),c[r].add(b)}function D(e){L.fromArray(o,3*e),N.copy(L),T=u[e],C.copy(T),C.sub(L.multiplyScalar(L.dot(T))).normalize(),E.crossVectors(N,T),A=E.dot(c[e]),_=A<0?-1:1,l[4*e]=C.x,l[4*e+1]=C.y,l[4*e+2]=C.z,l[4*e+3]=_}},mergeBufferGeometries:function(e,t){for(var r=null!==e[0].index,n=new Set(Object.keys(e[0].attributes)),i=new Set(Object.keys(e[0].morphAttributes)),o={},a={},s=new BufferGeometry,l=0,u=0;u<e.length;++u){var c=e[u];if(r!==(null!==c.index))return null;for(var h in c.attributes){if(!n.has(h))return null;void 0===o[h]&&(o[h]=[]),o[h].push(c.attributes[h])}for(var h in c.morphAttributes){if(!i.has(h))return null;void 0===a[h]&&(a[h]=[]),a[h].push(c.morphAttributes[h])}if(s.userData.mergedUserData=s.userData.mergedUserData||[],s.userData.mergedUserData.push(c.userData),t){var p;if(r)p=c.index.count;else{if(void 0===c.attributes.position)return null;p=c.attributes.position.count}s.addGroup(l,p,u),l+=p}}if(r){var f=0,d=[];for(u=0;u<e.length;++u){for(var m=e[u].index,v=0;v<m.count;++v)d.push(m.getX(v)+f);f+=e[u].attributes.position.count}s.setIndex(d)}for(var h in o){var g=this.mergeBufferAttributes(o[h]);if(!g)return null;s.addAttribute(h,g)}for(var h in a){var y=a[h][0].length;if(0===y)break;s.morphAttributes=s.morphAttributes||{},s.morphAttributes[h]=[];for(u=0;u<y;++u){var b=[];for(v=0;v<a[h].length;++v)b.push(a[h][v][u]);var x=this.mergeBufferAttributes(b);if(!x)return null;s.morphAttributes[h].push(x)}}return s},mergeBufferAttributes:function(e){for(var t,r,n,i=0,o=0;o<e.length;++o){var a=e[o];if(a.isInterleavedBufferAttribute)return null;if(void 0===t&&(t=a.array.constructor),t!==a.array.constructor)return null;if(void 0===r&&(r=a.itemSize),r!==a.itemSize)return null;if(void 0===n&&(n=a.normalized),n!==a.normalized)return null;i+=a.array.length}var s=new t(i),l=0;for(o=0;o<e.length;++o)s.set(e[o].array,l),l+=e[o].array.length;return new BufferAttribute(s,r,n)},interleaveAttributes:function(e){for(var t,r=0,n=0,i=0,o=e.length;i<o;++i){var a=e[i];if(void 0===t&&(t=a.array.constructor),t!==a.array.constructor)return console.warn("AttributeBuffers of different types cannot be interleaved"),null;r+=a.array.length,n+=a.itemSize}var s=new InterleavedBuffer(new t(r),n),l=0,u=[],c=["getX","getY","getZ","getW"],h=["setX","setY","setZ","setW"],p=0;for(o=e.length;p<o;p++){var f=(a=e[p]).itemSize,d=a.count,m=new InterleavedBufferAttribute(s,f,l,a.normalized);u.push(m),l+=f;for(var v=0;v<d;v++)for(var g=0;g<f;g++)m[h[g]](v,a[c[g]](v))}return u},estimateBytesUsed:function(e){var t=0;for(var r in e.attributes){var n=e.getAttribute(r);t+=n.count*n.itemSize*n.array.BYTES_PER_ELEMENT}var i=e.getIndex();return t+=i?i.count*i.itemSize*i.array.BYTES_PER_ELEMENT:0},mergeVertices:function(e,t){void 0===t&&(t=1e-4),t=Math.max(t,Number.EPSILON);for(var r={},n=e.getIndex(),i=e.getAttribute("position"),o=n?n.count:i.count,a=0,s=Object.keys(e.attributes),l={},u={},c=[],h=["getX","getY","getZ","getW"],p=0,f=s.length;p<f;p++){l[w=s[p]]=[],(T=e.morphAttributes[w])&&(u[w]=new Array(T.length).fill().map(function(){return[]}))}for(var d=Math.log10(1/t),m=Math.pow(10,d),v=0;v<o;v++){for(var g=n?n.getX(v):v,y="",b=0,x=s.length;b<x;b++)for(var w=s[b],S=(_=e.getAttribute(w)).itemSize,M=0;M<S;M++)y+=~~(_[h[M]](g)*m)+",";if(y in r)c.push(r[y]);else{for(b=0,x=s.length;b<x;b++){w=s[b];var _=e.getAttribute(w),T=e.morphAttributes[w],A=(S=_.itemSize,l[w]),C=u[w];for(M=0;M<S;M++){var E=h[M];if(A.push(_[E](g)),T)for(var L=0,N=T.length;L<N;L++)C[L].push(T[L][E](g))}}r[y]=a,c.push(a),a++}}var P=e.clone();for(v=0,x=s.length;v<x;v++){w=s[v];var O=e.getAttribute(w),R=new O.array.constructor(l[w]);if(O.isInterleavedBufferAttribute?_=new BufferAttribute(R,O.itemSize,O.itemSize):(_=e.getAttribute(w).clone()).setArray(R),P.addAttribute(w,_),w in u)for(b=0;b<u[w].length;b++){var D=e.morphAttributes[w][b].clone();D.setArray(new D.array.constructor(u[w][b])),P.morphAttributes[w][b]=D}}var F=Uint8Array;c.length>=Math.pow(2,8)&&(F=Uint16Array),c.length>=Math.pow(2,16)&&(F=Uint32Array);var k=new F(c);c=null;return null===n?c=new BufferAttribute(k,1):(c=e.getIndex().clone()).setArray(k),P.setIndex(c),P}},GLTFLoader=function(){function e(e){this.manager=void 0!==e?e:DefaultLoadingManager,this.dracoLoader=null}function t(){var e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}e.prototype={constructor:e,crossOrigin:"anonymous",load:function(e,t,r,n){var i,o=this;i=void 0!==this.resourcePath?this.resourcePath:void 0!==this.path?this.path:LoaderUtils.extractUrlBase(e),o.manager.itemStart(e);var a=function(t){n?n(t):console.error(t),o.manager.itemError(e),o.manager.itemEnd(e)},s=new FileLoader(o.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.load(e,function(r){try{o.parse(r,i,function(r){t(r),o.manager.itemEnd(e)},a)}catch(n){a(n)}},r,a)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setDRACOLoader:function(e){return this.dracoLoader=e,this},parse:function(e,t,s,l){var f,d={};if("string"===typeof e)f=e;else if(LoaderUtils.decodeText(new Uint8Array(e,0,4))===a){try{d[r.KHR_BINARY_GLTF]=new u(e)}catch(x){return void(l&&l(x))}f=d[r.KHR_BINARY_GLTF].content}else f=LoaderUtils.decodeText(new Uint8Array(e));var m=JSON.parse(f);if(void 0===m.asset||m.asset.version[0]<2)l&&l(new Error("GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead."));else{if(m.extensionsUsed)for(var v=0;v<m.extensionsUsed.length;++v){var g=m.extensionsUsed[v],y=m.extensionsRequired||[];switch(g){case r.KHR_LIGHTS_PUNCTUAL:d[g]=new i(m);break;case r.KHR_MATERIALS_UNLIT:d[g]=new o(m);break;case r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:d[g]=new p(m);break;case r.KHR_DRACO_MESH_COMPRESSION:d[g]=new c(m,this.dracoLoader);break;case r.MSFT_TEXTURE_DDS:d[r.MSFT_TEXTURE_DDS]=new n;break;case r.KHR_TEXTURE_TRANSFORM:d[r.KHR_TEXTURE_TRANSFORM]=new h(m);break;default:y.indexOf(g)>=0&&console.warn('GLTFLoader: Unknown extension "'+g+'".')}}var b=new V(m,d,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager});b.parse(function(e,t,r,n,i){var o={scene:e,scenes:t,cameras:r,animations:n,asset:i.asset,parser:b,userData:{}};R(d,o,i),s(o)},l)}}};var r={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function n(){if(!DDSLoader)throw new Error("GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=r.MSFT_TEXTURE_DDS,this.ddsLoader=new DDSLoader}function i(e){this.name=r.KHR_LIGHTS_PUNCTUAL;var t=e.extensions&&e.extensions[r.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=t.lights||[]}function o(e){this.name=r.KHR_MATERIALS_UNLIT}i.prototype.loadLight=function(e){var t,r=this.lightDefs[e],n=new Color(16777215);void 0!==r.color&&n.fromArray(r.color);var i=void 0!==r.range?r.range:0;switch(r.type){case"directional":(t=new DirectionalLight(n)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new PointLight(n)).distance=i;break;case"spot":(t=new SpotLight(n)).distance=i,r.spot=r.spot||{},r.spot.innerConeAngle=void 0!==r.spot.innerConeAngle?r.spot.innerConeAngle:0,r.spot.outerConeAngle=void 0!==r.spot.outerConeAngle?r.spot.outerConeAngle:Math.PI/4,t.angle=r.spot.outerConeAngle,t.penumbra=1-r.spot.innerConeAngle/r.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw new Error('GLTFLoader: Unexpected light type, "'+r.type+'".')}return t.position.set(0,0,0),t.decay=2,void 0!==r.intensity&&(t.intensity=r.intensity),t.name=r.name||"light_"+e,Promise.resolve(t)},o.prototype.getMaterialType=function(e){return MeshBasicMaterial},o.prototype.extendParams=function(e,t,r){var n=[];e.color=new Color(1,1,1),e.opacity=1;var i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){var o=i.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==i.baseColorTexture&&n.push(r.assignTexture(e,"map",i.baseColorTexture))}return Promise.all(n)};var a="glTF",s=12,l={JSON:1313821514,BIN:5130562};function u(e){this.name=r.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,s);if(this.header={magic:LoaderUtils.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==a)throw new Error("GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.");for(var n=new DataView(e,s),i=0;i<n.byteLength;){var o=n.getUint32(i,!0);i+=4;var u=n.getUint32(i,!0);if(i+=4,u===l.JSON){var c=new Uint8Array(e,s+i,o);this.content=LoaderUtils.decodeText(c)}else if(u===l.BIN){var h=s+i;this.body=e.slice(h,h+o)}i+=o}if(null===this.content)throw new Error("GLTFLoader: JSON content not found.")}function c(e,t){if(!t)throw new Error("GLTFLoader: No DRACOLoader instance provided.");this.name=r.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,DRACOLoader.getDecoderModule()}function h(e){this.name=r.KHR_TEXTURE_TRANSFORM}function p(){return{name:r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return ShaderMaterial},extendParams:function(e,t,r){var n=t.extensions[this.name],i=ShaderLib.standard,o=UniformsUtils.clone(i.uniforms),a=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),s=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),l=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),u=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),c=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),h=i.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",a).replace("#include <metalnessmap_pars_fragment>",s).replace("#include <roughnessmap_fragment>",l).replace("#include <metalnessmap_fragment>",u).replace("#include <lights_physical_fragment>",c);delete o.roughness,delete o.metalness,delete o.roughnessMap,delete o.metalnessMap,o.specular={value:(new Color).setHex(1118481)},o.glossiness={value:.5},o.specularMap={value:null},o.glossinessMap={value:null},e.vertexShader=i.vertexShader,e.fragmentShader=h,e.uniforms=o,e.defines={STANDARD:""},e.color=new Color(1,1,1),e.opacity=1;var p=[];if(Array.isArray(n.diffuseFactor)){var f=n.diffuseFactor;e.color.fromArray(f),e.opacity=f[3]}if(void 0!==n.diffuseTexture&&p.push(r.assignTexture(e,"map",n.diffuseTexture)),e.emissive=new Color(0,0,0),e.glossiness=void 0!==n.glossinessFactor?n.glossinessFactor:1,e.specular=new Color(1,1,1),Array.isArray(n.specularFactor)&&e.specular.fromArray(n.specularFactor),void 0!==n.specularGlossinessTexture){var d=n.specularGlossinessTexture;p.push(r.assignTexture(e,"glossinessMap",d)),p.push(r.assignTexture(e,"specularMap",d))}return Promise.all(p)},createMaterial:function(e){var t=new ShaderMaterial({defines:e.defines,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,fog:!0,lights:!0,opacity:e.opacity,transparent:e.transparent});return t.isGLTFSpecularGlossinessMaterial=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t.extensions.derivatives=!0,t},cloneMaterial:function(e){var t=e.clone();t.isGLTFSpecularGlossinessMaterial=!0;for(var r=this.specularGlossinessParams,n=0,i=r.length;n<i;n++)t[r[n]]=e[r[n]];return t},refreshUniforms:function(e,t,r,n,i,o){if(!0===i.isGLTFSpecularGlossinessMaterial){var a,s=i.uniforms,l=i.defines;s.opacity.value=i.opacity,s.diffuse.value.copy(i.color),s.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),s.map.value=i.map,s.specularMap.value=i.specularMap,s.alphaMap.value=i.alphaMap,s.lightMap.value=i.lightMap,s.lightMapIntensity.value=i.lightMapIntensity,s.aoMap.value=i.aoMap,s.aoMapIntensity.value=i.aoMapIntensity,i.map?a=i.map:i.specularMap?a=i.specularMap:i.displacementMap?a=i.displacementMap:i.normalMap?a=i.normalMap:i.bumpMap?a=i.bumpMap:i.glossinessMap?a=i.glossinessMap:i.alphaMap?a=i.alphaMap:i.emissiveMap&&(a=i.emissiveMap),void 0!==a&&(a.isWebGLRenderTarget&&(a=a.texture),!0===a.matrixAutoUpdate&&a.updateMatrix(),s.uvTransform.value.copy(a.matrix)),i.envMap&&(s.envMap.value=i.envMap,s.envMapIntensity.value=i.envMapIntensity,s.flipEnvMap.value=i.envMap.isCubeTexture?-1:1,s.reflectivity.value=i.reflectivity,s.refractionRatio.value=i.refractionRatio,s.maxMipLevel.value=e.properties.get(i.envMap).__maxMipLevel),s.specular.value.copy(i.specular),s.glossiness.value=i.glossiness,s.glossinessMap.value=i.glossinessMap,s.emissiveMap.value=i.emissiveMap,s.bumpMap.value=i.bumpMap,s.normalMap.value=i.normalMap,s.displacementMap.value=i.displacementMap,s.displacementScale.value=i.displacementScale,s.displacementBias.value=i.displacementBias,null!==s.glossinessMap.value&&void 0===l.USE_GLOSSINESSMAP&&(l.USE_GLOSSINESSMAP="",l.USE_ROUGHNESSMAP=""),null===s.glossinessMap.value&&void 0!==l.USE_GLOSSINESSMAP&&(delete l.USE_GLOSSINESSMAP,delete l.USE_ROUGHNESSMAP)}}}}function f(e,t,r,n){Interpolant.call(this,e,t,r,n)}c.prototype.decodePrimitive=function(e,t){var r=this.json,n=this.dracoLoader,i=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},s={},l={};for(var u in o)u in T&&(a[T[u]]=o[u]);for(u in e.attributes)if(void 0!==T[u]&&void 0!==o[u]){var c=r.accessors[e.attributes[u]],h=w[c.componentType];l[T[u]]=h,s[T[u]]=!0===c.normalized}return t.getDependency("bufferView",i).then(function(e){return new Promise(function(t){n.decodeDracoFile(e,function(e){for(var r in e.attributes){var n=e.attributes[r],i=s[r];void 0!==i&&(n.normalized=i)}t(e)},a,l)})})},h.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},f.prototype=Object.create(Interpolant.prototype),f.prototype.constructor=f,f.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=e*n*3+n,o=0;o!==n;o++)t[o]=r[i+o];return t},f.prototype.beforeStart_=f.prototype.copySampleValue_,f.prototype.afterEnd_=f.prototype.copySampleValue_,f.prototype.interpolate_=function(e,t,r,n){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=2*a,l=3*a,u=n-t,c=(r-t)/u,h=c*c,p=h*c,f=e*l,d=f-l,m=-2*p+3*h,v=p-h,g=1-m,y=v-h+c,b=0;b!==a;b++){var x=o[d+b+a],w=o[d+b+s]*u,S=o[f+b+a],M=o[f+b]*u;i[b]=g*x+y*w+m*S+v*M}return i};var d=0,m=1,v=2,g=3,y=4,b=5,x=6,w={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},S={9728:NearestFilter,9729:LinearFilter,9984:NearestMipMapNearestFilter,9985:LinearMipMapNearestFilter,9986:NearestMipMapLinearFilter,9987:LinearMipMapLinearFilter},M={33071:ClampToEdgeWrapping,33648:MirroredRepeatWrapping,10497:RepeatWrapping},_={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},T={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},A={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},C={CUBICSPLINE:InterpolateSmooth,LINEAR:InterpolateLinear,STEP:InterpolateDiscrete},E="OPAQUE",L="MASK",N="BLEND",P={"image/png":RGBAFormat,"image/jpeg":RGBFormat};function O(e,t){return"string"!==typeof e||""===e?"":/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:t+e}function R(e,t,r){for(var n in r.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=r.extensions[n])}function D(e,t){void 0!==t.extras&&("object"===typeof t.extras?e.userData=t.extras:console.warn("GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function F(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var r=0,n=t.weights.length;r<n;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){var i=t.extras.targetNames;if(e.morphTargetInfluences.length===i.length){e.morphTargetDictionary={};for(r=0,n=i.length;r<n;r++)e.morphTargetDictionary[i[r]]=r}else console.warn("GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function k(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var r in e)if(e[r]!==t[r])return!1;return!0}function I(e){var t=e.extensions&&e.extensions[r.KHR_DRACO_MESH_COMPRESSION];return t?"draco:"+t.bufferView+":"+t.indices+":"+B(t.attributes):e.indices+":"+B(e.attributes)+":"+e.mode}function B(e){for(var t="",r=Object.keys(e).sort(),n=0,i=r.length;n<i;n++)t+=r[n]+":"+e[r[n]]+";";return t}function U(e){if(e.isInterleavedBufferAttribute){for(var t=e.count,r=e.itemSize,n=e.array.slice(0,t*r),i=0,o=0;i<t;++i)n[o++]=e.getX(i),r>=2&&(n[o++]=e.getY(i)),r>=3&&(n[o++]=e.getZ(i)),r>=4&&(n[o++]=e.getW(i));return new BufferAttribute(n,r,e.normalized)}return e.clone()}function V(e,r,n){this.json=e||{},this.extensions=r||{},this.options=n||{},this.cache=new t,this.primitiveCache={},this.multiplePrimitivesCache={},this.multiPassGeometryCache={},this.textureLoader=new TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer")}function j(e,t,r){var n=t.attributes,i=[];function o(t,n){return r.getDependency("accessor",t).then(function(t){e.addAttribute(n,t)})}for(var a in n){var s=T[a];s&&(s in e.attributes||i.push(o(n[a],s)))}if(void 0!==t.indices&&!e.index){var l=r.getDependency("accessor",t.indices).then(function(t){e.setIndex(t)});i.push(l)}return D(e,t),Promise.all(i).then(function(){return void 0!==t.targets?function(e,t,r){for(var n=!1,i=!1,o=0,a=t.length;o<a&&(void 0!==(u=t[o]).POSITION&&(n=!0),void 0!==u.NORMAL&&(i=!0),!n||!i);o++);if(!n&&!i)return Promise.resolve(e);var s=[],l=[];for(o=0,a=t.length;o<a;o++){var u=t[o];if(n){var c=void 0!==u.POSITION?r.getDependency("accessor",u.POSITION).then(function(e){return U(e)}):e.attributes.position;s.push(c)}i&&(c=void 0!==u.NORMAL?r.getDependency("accessor",u.NORMAL).then(function(e){return U(e)}):e.attributes.normal,l.push(c))}return Promise.all([Promise.all(s),Promise.all(l)]).then(function(r){for(var o=r[0],a=r[1],s=0,l=t.length;s<l;s++){var u=t[s],c="morphTarget"+s;if(n&&void 0!==u.POSITION){var h=o[s];h.name=c;for(var p=e.attributes.position,f=0,d=h.count;f<d;f++)h.setXYZ(f,h.getX(f)+p.getX(f),h.getY(f)+p.getY(f),h.getZ(f)+p.getZ(f))}if(i&&void 0!==u.NORMAL){var m=a[s];m.name=c;var v=e.attributes.normal;for(f=0,d=m.count;f<d;f++)m.setXYZ(f,m.getX(f)+v.getX(f),m.getY(f)+v.getY(f),m.getZ(f)+v.getZ(f))}}return n&&(e.morphAttributes.position=o),i&&(e.morphAttributes.normal=a),e})}(e,t.targets,r):e})}return V.prototype.parse=function(e,t){var r=this.json;this.cache.removeAll(),this.markDefs(),this.getMultiDependencies(["scene","animation","camera"]).then(function(t){var n=t.scenes||[],i=n[r.scene||0],o=t.animations||[],a=t.cameras||[];e(i,n,a,o,r)}).catch(t)},V.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[],n={},i={},o=0,a=t.length;o<a;o++)for(var s=t[o].joints,l=0,u=s.length;l<u;l++)e[s[l]].isBone=!0;for(var c=0,h=e.length;c<h;c++){var p=e[c];void 0!==p.mesh&&(void 0===n[p.mesh]&&(n[p.mesh]=i[p.mesh]=0),n[p.mesh]++,void 0!==p.skin&&(r[p.mesh].isSkinnedMesh=!0))}this.json.meshReferences=n,this.json.meshUses=i},V.prototype.getDependency=function(e,t){var n=e+":"+t,i=this.cache.get(n);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this.loadNode(t);break;case"mesh":i=this.loadMesh(t);break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this.loadBufferView(t);break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this.loadMaterial(t);break;case"texture":i=this.loadTexture(t);break;case"skin":i=this.loadSkin(t);break;case"animation":i=this.loadAnimation(t);break;case"camera":i=this.loadCamera(t);break;case"light":i=this.extensions[r.KHR_LIGHTS_PUNCTUAL].loadLight(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,i)}return i},V.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var r=this,n=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(n.map(function(t,n){return r.getDependency(e,n)})),this.cache.add(e,t)}return t},V.prototype.getMultiDependencies=function(e){for(var t={},r=[],n=0,i=e.length;n<i;n++){var o=e[n],a=this.getDependencies(o);a=a.then(function(e,r){t[e]=r}.bind(this,o+("mesh"===o?"es":"s"))),r.push(a)}return Promise.all(r).then(function(){return t})},V.prototype.loadBuffer=function(e){var t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[r.KHR_BINARY_GLTF].body);var i=this.options;return new Promise(function(e,r){n.load(O(t.uri,i.path),e,void 0,function(){r(new Error('GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})},V.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){var r=t.byteLength||0,n=t.byteOffset||0;return e.slice(n,n+r)})},V.prototype.loadAccessor=function(e){var t=this,r=this.json,n=this.json.accessors[e];if(void 0===n.bufferView&&void 0===n.sparse)return Promise.resolve(null);var i=[];return void 0!==n.bufferView?i.push(this.getDependency("bufferView",n.bufferView)):i.push(null),void 0!==n.sparse&&(i.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(i).then(function(e){var i,o=e[0],a=_[n.type],s=w[n.componentType],l=s.BYTES_PER_ELEMENT,u=l*a,c=n.byteOffset||0,h=void 0!==n.bufferView?r.bufferViews[n.bufferView].byteStride:void 0,p=!0===n.normalized;if(h&&h!==u){var f="InterleavedBuffer:"+n.bufferView+":"+n.componentType,d=t.cache.get(f);d||(d=new InterleavedBuffer(new s(o),h/l),t.cache.add(f,d)),i=new InterleavedBufferAttribute(d,a,c/l,p)}else i=new BufferAttribute(null===o?new s(n.count*a):new s(o,c,n.count*a),a,p);if(void 0!==n.sparse){var m=_.SCALAR,v=w[n.sparse.indices.componentType],g=n.sparse.indices.byteOffset||0,y=n.sparse.values.byteOffset||0,b=new v(e[1],g,n.sparse.count*m),x=new s(e[2],y,n.sparse.count*a);null!==o&&i.setArray(i.array.slice());for(var S=0,M=b.length;S<M;S++){var T=b[S];if(i.setX(T,x[S*a]),a>=2&&i.setY(T,x[S*a+1]),a>=3&&i.setZ(T,x[S*a+2]),a>=4&&i.setW(T,x[S*a+3]),a>=5)throw new Error("GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return i})},V.prototype.loadTexture=function(e){var t,n=this,i=this.json,o=this.options,a=this.textureLoader,s=window.URL||window.webkitURL,l=i.textures[e],u=l.extensions||{},c=(t=u[r.MSFT_TEXTURE_DDS]?i.images[u[r.MSFT_TEXTURE_DDS].source]:i.images[l.source]).uri,h=!1;return void 0!==t.bufferView&&(c=n.getDependency("bufferView",t.bufferView).then(function(e){h=!0;var r=new Blob([e],{type:t.mimeType});return c=s.createObjectURL(r)})),Promise.resolve(c).then(function(e){var t=Loader$1.Handlers.get(e);return t||(t=u[r.MSFT_TEXTURE_DDS]?n.extensions[r.MSFT_TEXTURE_DDS].ddsLoader:a),new Promise(function(r,n){t.load(O(e,o.path),r,void 0,n)})}).then(function(e){!0===h&&s.revokeObjectURL(c),e.flipY=!1,void 0!==l.name&&(e.name=l.name),t.mimeType in P&&(e.format=P[t.mimeType]);var r=(i.samplers||{})[l.sampler]||{};return e.magFilter=S[r.magFilter]||LinearFilter,e.minFilter=S[r.minFilter]||LinearMipMapLinearFilter,e.wrapS=M[r.wrapS]||RepeatWrapping,e.wrapT=M[r.wrapT]||RepeatWrapping,e})},V.prototype.assignTexture=function(e,t,n){var i=this;return this.getDependency("texture",n.index).then(function(o){switch(t){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":o.format=RGBFormat}if(i.extensions[r.KHR_TEXTURE_TRANSFORM]){var a=void 0!==n.extensions?n.extensions[r.KHR_TEXTURE_TRANSFORM]:void 0;a&&(o=i.extensions[r.KHR_TEXTURE_TRANSFORM].extendTexture(o,a))}e[t]=o})},V.prototype.loadMaterial=function(e){var t,n=this.json,i=this.extensions,o=n.materials[e],a={},s=o.extensions||{},l=[];if(s[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var u=i[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=u.getMaterialType(o),l.push(u.extendParams(a,o,this))}else if(s[r.KHR_MATERIALS_UNLIT]){var c=i[r.KHR_MATERIALS_UNLIT];t=c.getMaterialType(o),l.push(c.extendParams(a,o,this))}else{t=MeshStandardMaterial;var h=o.pbrMetallicRoughness||{};if(a.color=new Color(1,1,1),a.opacity=1,Array.isArray(h.baseColorFactor)){var p=h.baseColorFactor;a.color.fromArray(p),a.opacity=p[3]}void 0!==h.baseColorTexture&&l.push(this.assignTexture(a,"map",h.baseColorTexture)),a.metalness=void 0!==h.metallicFactor?h.metallicFactor:1,a.roughness=void 0!==h.roughnessFactor?h.roughnessFactor:1,void 0!==h.metallicRoughnessTexture&&(l.push(this.assignTexture(a,"metalnessMap",h.metallicRoughnessTexture)),l.push(this.assignTexture(a,"roughnessMap",h.metallicRoughnessTexture)))}!0===o.doubleSided&&(a.side=DoubleSide);var f=o.alphaMode||E;return f===N?a.transparent=!0:(a.transparent=!1,f===L&&(a.alphaTest=void 0!==o.alphaCutoff?o.alphaCutoff:.5)),void 0!==o.normalTexture&&t!==MeshBasicMaterial&&(l.push(this.assignTexture(a,"normalMap",o.normalTexture)),a.normalScale=new Vector2(1,1),void 0!==o.normalTexture.scale&&a.normalScale.set(o.normalTexture.scale,o.normalTexture.scale)),void 0!==o.occlusionTexture&&t!==MeshBasicMaterial&&(l.push(this.assignTexture(a,"aoMap",o.occlusionTexture)),void 0!==o.occlusionTexture.strength&&(a.aoMapIntensity=o.occlusionTexture.strength)),void 0!==o.emissiveFactor&&t!==MeshBasicMaterial&&(a.emissive=(new Color).fromArray(o.emissiveFactor)),void 0!==o.emissiveTexture&&t!==MeshBasicMaterial&&l.push(this.assignTexture(a,"emissiveMap",o.emissiveTexture)),Promise.all(l).then(function(){var e;return e=t===ShaderMaterial?i[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(a):new t(a),void 0!==o.name&&(e.name=o.name),e.map&&(e.map.encoding=sRGBEncoding),e.emissiveMap&&(e.emissiveMap.encoding=sRGBEncoding),e.specularMap&&(e.specularMap.encoding=sRGBEncoding),D(e,o),o.extensions&&R(i,e,o),e})},V.prototype.loadGeometries=function(e){var t,n=this,i=this.extensions,o=this.primitiveCache,a=function(e){if(e.length<2)return!1;var t=e[0],n=t.targets||[];if(void 0===t.indices)return!1;for(var i=1,o=e.length;i<o;i++){var a=e[i];if(t.mode!==a.mode)return!1;if(void 0===a.indices)return!1;if(a.extensions&&a.extensions[r.KHR_DRACO_MESH_COMPRESSION])return!1;if(!k(t.attributes,a.attributes))return!1;var s=a.targets||[];if(n.length!==s.length)return!1;for(var l=0,u=n.length;l<u;l++)if(!k(n[l],s[l]))return!1}return!0}(e);function s(e){return i[r.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,n).then(function(t){return j(t,e,n)})}a&&(t=e,e=[e[0]]);for(var l=[],u=0,c=e.length;u<c;u++){var h,p=e[u],f=I(p),d=o[f];if(d)l.push(d.promise);else h=p.extensions&&p.extensions[r.KHR_DRACO_MESH_COMPRESSION]?s(p):j(new BufferGeometry,p,n),o[f]={primitive:p,promise:h},l.push(h)}return Promise.all(l).then(function(r){if(a){var i=r[0],o=n.multiPassGeometryCache,s=function(e,t){for(var r=e.uuid,n=0,i=t.length;n<i;n++)r+=n+I(t[n]);return r}(i,t);if(null!==(f=o[s]))return[f.geometry];var l=new BufferGeometry;for(var u in l.name=i.name,l.userData=i.userData,i.attributes)l.addAttribute(u,i.attributes[u]);for(var u in i.morphAttributes)l.morphAttributes[u]=i.morphAttributes[u];for(var c=[],h=0,p=t.length;h<p;h++)c.push(n.getDependency("accessor",t[h].indices));return Promise.all(c).then(function(e){for(var r=[],n=0,a=0,u=t.length;a<u;a++){for(var c=e[a],h=0,p=c.count;h<p;h++)r.push(c.array[h]);l.addGroup(n,c.count,a),n+=c.count}return l.setIndex(r),o[s]={geometry:l,baseGeometry:i,primitives:t},[l]})}if(r.length>1&&void 0!==BufferGeometryUtils){for(h=1,p=e.length;h<p;h++)if(e[0].mode!==e[h].mode)return r;var f;o=n.multiplePrimitivesCache,s=function(e){for(var t="",r=0,n=e.length;r<n;r++)t+=":"+e[r].uuid;return t}(r);if(f=o[s]){if(null!==f.geometry)return[f.geometry]}else{l=BufferGeometryUtils.mergeBufferGeometries(r,!0);if(o[s]={geometry:l,baseGeometries:r},null!==l)return[l]}}return r})},V.prototype.loadMesh=function(e){for(var t=this,n=this.json,i=this.extensions,o=n.meshes[e],a=o.primitives,s=[],l=0,u=a.length;l<u;l++){var c=void 0===a[l].material?new MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:FrontSide}):this.getDependency("material",a[l].material);s.push(c)}return Promise.all(s).then(function(n){return t.loadGeometries(a).then(function(s){for(var l=1===s.length&&s[0].groups.length>0,u=[],c=0,h=s.length;c<h;c++){var p,f=s[c],w=a[c],S=l?n:n[c];if(w.mode===y||w.mode===b||w.mode===x||void 0===w.mode)!0===(p=!0===o.isSkinnedMesh?new SkinnedMesh(f,S):new Mesh(f,S)).isSkinnedMesh&&p.normalizeSkinWeights(),w.mode===b?p.drawMode=TriangleStripDrawMode:w.mode===x&&(p.drawMode=TriangleFanDrawMode);else if(w.mode===m)p=new LineSegments(f,S);else if(w.mode===g)p=new Line(f,S);else if(w.mode===v)p=new LineLoop(f,S);else{if(w.mode!==d)throw new Error("GLTFLoader: Primitive mode unsupported: "+w.mode);p=new Points(f,S)}Object.keys(p.geometry.morphAttributes).length>0&&F(p,o),p.name=o.name||"mesh_"+e,s.length>1&&(p.name+="_"+c),D(p,o),u.push(p);for(var M=l?p.material:[p.material],_=void 0!==f.attributes.tangent,T=void 0!==f.attributes.color,A=void 0===f.attributes.normal,C=!0===p.isSkinnedMesh,E=Object.keys(f.morphAttributes).length>0,L=E&&void 0!==f.morphAttributes.normal,N=0,P=M.length;N<P;N++){S=M[N];if(p.isPoints){var O="PointsMaterial:"+S.uuid,R=t.cache.get(O);R||(R=new PointsMaterial,Material$1.prototype.copy.call(R,S),R.color.copy(S.color),R.map=S.map,R.lights=!1,t.cache.add(O,R)),S=R}else if(p.isLine){O="LineBasicMaterial:"+S.uuid;var k=t.cache.get(O);k||(k=new LineBasicMaterial,Material$1.prototype.copy.call(k,S),k.color.copy(S.color),k.lights=!1,t.cache.add(O,k)),S=k}if(_||T||A||C||E){O="ClonedMaterial:"+S.uuid+":";S.isGLTFSpecularGlossinessMaterial&&(O+="specular-glossiness:"),C&&(O+="skinning:"),_&&(O+="vertex-tangents:"),T&&(O+="vertex-colors:"),A&&(O+="flat-shading:"),E&&(O+="morph-targets:"),L&&(O+="morph-normals:");var I=t.cache.get(O);I||(I=S.isGLTFSpecularGlossinessMaterial?i[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].cloneMaterial(S):S.clone(),C&&(I.skinning=!0),_&&(I.vertexTangents=!0),T&&(I.vertexColors=VertexColors),A&&(I.flatShading=!0),E&&(I.morphTargets=!0),L&&(I.morphNormals=!0),t.cache.add(O,I)),S=I}M[N]=S,S.aoMap&&void 0===f.attributes.uv2&&void 0!==f.attributes.uv&&(console.log("GLTFLoader: Duplicating UVs to support aoMap."),f.addAttribute("uv2",new BufferAttribute(f.attributes.uv.array,2))),S.isGLTFSpecularGlossinessMaterial&&(p.onBeforeRender=i[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms)}p.material=l?M:M[0]}if(1===u.length)return u[0];var B=new Group;for(c=0,h=u.length;c<h;c++)B.add(u[c]);return B})})},V.prototype.loadCamera=function(e){var t,r=this.json.cameras[e],n=r[r.type];if(n)return"perspective"===r.type?t=new PerspectiveCamera(_Math.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===r.type&&(t=new OrthographicCamera(n.xmag/-2,n.xmag/2,n.ymag/2,n.ymag/-2,n.znear,n.zfar)),void 0!==r.name&&(t.name=r.name),D(t,r),Promise.resolve(t);console.warn("GLTFLoader: Missing camera parameters.")},V.prototype.loadSkin=function(e){var t=this.json.skins[e],r={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(r):this.getDependency("accessor",t.inverseBindMatrices).then(function(e){return r.inverseBindMatrices=e,r})},V.prototype.loadAnimation=function(e){for(var t=this.json.animations[e],r=[],n=[],i=[],o=[],a=[],s=0,l=t.channels.length;s<l;s++){var u=t.channels[s],c=t.samplers[u.sampler],h=u.target,p=void 0!==h.node?h.node:h.id,d=void 0!==t.parameters?t.parameters[c.input]:c.input,m=void 0!==t.parameters?t.parameters[c.output]:c.output;r.push(this.getDependency("node",p)),n.push(this.getDependency("accessor",d)),i.push(this.getDependency("accessor",m)),o.push(c),a.push(h)}return Promise.all([Promise.all(r),Promise.all(n),Promise.all(i),Promise.all(o),Promise.all(a)]).then(function(r){for(var n=r[0],i=r[1],o=r[2],a=r[3],s=r[4],l=[],u=0,c=n.length;u<c;u++){var h=n[u],p=i[u],d=o[u],m=a[u],v=s[u];if(void 0!==h){var g;switch(h.updateMatrix(),h.matrixAutoUpdate=!0,A[v.path]){case A.weights:g=NumberKeyframeTrack;break;case A.rotation:g=QuaternionKeyframeTrack;break;case A.position:case A.scale:default:g=VectorKeyframeTrack}var y=h.name?h.name:h.uuid,b=void 0!==m.interpolation?C[m.interpolation]:InterpolateLinear,x=[];A[v.path]===A.weights?h.traverse(function(e){!0===e.isMesh&&e.morphTargetInfluences&&x.push(e.name?e.name:e.uuid)}):x.push(y);for(var w=0,S=x.length;w<S;w++){var M=new g(x[w]+"."+A[v.path],AnimationUtils.arraySlice(p.array,0),AnimationUtils.arraySlice(d.array,0),b);"CUBICSPLINE"===m.interpolation&&(M.createInterpolant=function(e){return new f(this.times,this.values,this.getValueSize()/3,e)},M.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),l.push(M)}}}return new AnimationClip(void 0!==t.name?t.name:"animation_"+e,void 0,l)})},V.prototype.loadNode=function(e){var t=this.json,n=this.extensions,i=this,o=t.meshReferences,a=t.meshUses,s=t.nodes[e];return(!0===s.isBone?Promise.resolve(new Bone):void 0!==s.mesh?i.getDependency("mesh",s.mesh).then(function(e){var t;if(o[s.mesh]>1){var r=a[s.mesh]++;(t=e.clone()).name+="_instance_"+r,t.onBeforeRender=e.onBeforeRender;for(var n=0,i=t.children.length;n<i;n++)t.children[n].name+="_instance_"+r,t.children[n].onBeforeRender=e.children[n].onBeforeRender}else t=e;return void 0!==s.weights&&t.traverse(function(e){if(e.isMesh)for(var t=0,r=s.weights.length;t<r;t++)e.morphTargetInfluences[t]=s.weights[t]}),t}):void 0!==s.camera?i.getDependency("camera",s.camera):s.extensions&&s.extensions[r.KHR_LIGHTS_PUNCTUAL]&&void 0!==s.extensions[r.KHR_LIGHTS_PUNCTUAL].light?i.getDependency("light",s.extensions[r.KHR_LIGHTS_PUNCTUAL].light):Promise.resolve(new Object3D)).then(function(e){if(void 0!==s.name&&(e.name=PropertyBinding.sanitizeNodeName(s.name)),D(e,s),s.extensions&&R(n,e,s),void 0!==s.matrix){var t=new Matrix4;t.fromArray(s.matrix),e.applyMatrix(t)}else void 0!==s.translation&&e.position.fromArray(s.translation),void 0!==s.rotation&&e.quaternion.fromArray(s.rotation),void 0!==s.scale&&e.scale.fromArray(s.scale);return e})},V.prototype.loadScene=function(){function e(t,r,n,i){var o=n.nodes[t];return i.getDependency("node",t).then(function(e){return void 0===o.skin?e:i.getDependency("skin",o.skin).then(function(e){for(var r=[],n=0,o=(t=e).joints.length;n<o;n++)r.push(i.getDependency("node",t.joints[n]));return Promise.all(r)}).then(function(r){for(var n=!0===e.isGroup?e.children:[e],i=0,o=n.length;i<o;i++){for(var a=n[i],s=[],l=[],u=0,c=r.length;u<c;u++){var h=r[u];if(h){s.push(h);var p=new Matrix4;void 0!==t.inverseBindMatrices&&p.fromArray(t.inverseBindMatrices.array,16*u),l.push(p)}else console.warn('GLTFLoader: Joint "%s" could not be found.',t.joints[u])}a.bind(new Skeleton(s,l),a.matrixWorld)}return e});var t}).then(function(t){r.add(t);var a=[];if(o.children)for(var s=o.children,l=0,u=s.length;l<u;l++){var c=s[l];a.push(e(c,t,n,i))}return Promise.all(a)})}return function(t){var r=this.json,n=this.extensions,i=this.json.scenes[t],o=new Scene;void 0!==i.name&&(o.name=i.name),D(o,i),i.extensions&&R(n,o,i);for(var a=i.nodes||[],s=[],l=0,u=a.length;l<u;l++)s.push(e(a[l],o,r,this));return Promise.all(s).then(function(){return o})}}(),e}(),RGBELoader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager,this.type=UnsignedByteType};RGBELoader.prototype=Object.create(DataTextureLoader.prototype),RGBELoader.prototype._parser=function(e){var t=function(e,t){switch(e){case 1:console.error("RGBELoader Read Error: "+(t||""));break;case 2:console.error("RGBELoader Write Error: "+(t||""));break;case 3:console.error("RGBELoader Bad File Format: "+(t||""));break;default:case 4:console.error("RGBELoader: Error: "+(t||""))}return-1},r=function(e,t,r){t=t||1024;for(var n=e.pos,i=-1,o=0,a="",s=String.fromCharCode.apply(null,new Uint16Array(e.subarray(n,n+128)));0>(i=s.indexOf("\n"))&&o<t&&n<e.byteLength;)a+=s,o+=s.length,n+=128,s+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(n,n+128)));return-1<i&&(!1!==r&&(e.pos+=o+i+1),a+s.slice(0,i))},n=new Uint8Array(e);n.pos=0;var i=function(e){var n,i,o=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,a=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*FORMAT=(\S+)\s*$/,l=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,u={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(e.pos>=e.byteLength||!(n=r(e)))return t(1,"no header found");if(!(i=n.match(/^#\?(\S+)$/)))return t(3,"bad initial token");for(u.valid|=1,u.programtype=i[1],u.string+=n+"\n";!1!==(n=r(e));)if(u.string+=n+"\n","#"!==n.charAt(0)){if((i=n.match(o))&&(u.gamma=parseFloat(i[1],10)),(i=n.match(a))&&(u.exposure=parseFloat(i[1],10)),(i=n.match(s))&&(u.valid|=2,u.format=i[1]),(i=n.match(l))&&(u.valid|=4,u.height=parseInt(i[1],10),u.width=parseInt(i[2],10)),2&u.valid&&4&u.valid)break}else u.comments+=n+"\n";return 2&u.valid?4&u.valid?u:t(3,"missing image size specifier"):t(3,"missing format specifier")}(n);if(-1!==i){var o=i.width,a=i.height,s=function(e,r,n){var i,o,a,s,l,u,c,h,p,f,d,m,v,g=r,y=n;if(g<8||g>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);if(g!==(e[2]<<8|e[3]))return t(3,"wrong scanline width");if(!(i=new Uint8Array(4*r*n))||!i.length)return t(4,"unable to allocate buffer space");for(o=0,a=0,h=4*g,v=new Uint8Array(4),u=new Uint8Array(h);y>0&&a<e.byteLength;){if(a+4>e.byteLength)return t(1);if(v[0]=e[a++],v[1]=e[a++],v[2]=e[a++],v[3]=e[a++],2!=v[0]||2!=v[1]||(v[2]<<8|v[3])!=g)return t(3,"bad rgbe scanline format");for(c=0;c<h&&a<e.byteLength;){if((m=(s=e[a++])>128)&&(s-=128),0===s||c+s>h)return t(3,"bad scanline data");if(m)for(l=e[a++],p=0;p<s;p++)u[c++]=l;else u.set(e.subarray(a,a+s),c),c+=s,a+=s}for(f=g,p=0;p<f;p++)d=0,i[o]=u[p+d],d+=g,i[o+1]=u[p+d],d+=g,i[o+2]=u[p+d],d+=g,i[o+3]=u[p+d],o+=4;y--}return i}(n.subarray(n.pos),o,a);if(-1!==s){if(this.type===UnsignedByteType)var l=s,u=RGBEFormat,c=UnsignedByteType;else if(this.type===FloatType){for(var h=function(e,t,r,n){var i=e[t+3],o=Math.pow(2,i-128)/255;r[n+0]=e[t+0]*o,r[n+1]=e[t+1]*o,r[n+2]=e[t+2]*o},p=s.length/4*3,f=new Float32Array(p),d=0;d<p;d++)h(s,4*d,f,3*d);l=f,u=RGBFormat,c=FloatType}else console.error("RGBELoader: unsupported type: ",this.type);return{width:o,height:a,data:l,header:i.string,gamma:i.gamma,exposure:i.exposure,format:u,type:c}}}return null};var HDRLoader=RGBELoader;function CubeTexture(e,t,r,n,i,o,a,s,l,u){e=void 0!==e?e:[],t=void 0!==t?t:CubeReflectionMapping,a=void 0!==a?a:RGBFormat,Texture.call(this,e,t,r,n,i,o,a,s,l,u),this.flipY=!1}RGBELoader.prototype.setType=function(e){return this.type=e,this},CubeTexture.prototype=Object.create(Texture.prototype),CubeTexture.prototype.constructor=CubeTexture,CubeTexture.prototype.isCubeTexture=!0,Object.defineProperty(CubeTexture.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}});var HDRCubeTextureLoader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager,this.hdrLoader=new RGBELoader};HDRCubeTextureLoader.prototype.load=function(e,t,r,n,i){var o=function(e,t,r,n){var i=e[t+3],o=Math.pow(2,i-128)/255;r[n+0]=e[t+0]*o,r[n+1]=e[t+1]*o,r[n+2]=e[t+2]*o},a=function(){var e=new Float32Array(1),t=new Int32Array(e.buffer);function r(r){e[0]=r;var n=t[0],i=n>>16&32768,o=n>>12&2047,a=n>>23&255;return a<103?i:a>142?(i|=31744,i|=(255==a?0:1)&&8388607&n):a<113?i|=((o|=2048)>>114-a)+(o>>113-a&1):(i|=a-112<<10|o>>1,i+=1&o)}return function(e,t,n,i){var o=e[t+3],a=Math.pow(2,o-128)/255;n[i+0]=r(e[t+0]*a),n[i+1]=r(e[t+1]*a),n[i+2]=r(e[t+2]*a)}}(),s=new CubeTexture;s.type=e,s.encoding=e===UnsignedByteType?RGBEEncoding:LinearEncoding,s.format=e===UnsignedByteType?RGBAFormat:RGBFormat,s.minFilter=s.encoding===RGBEEncoding?NearestFilter:LinearFilter,s.magFilter=s.encoding===RGBEEncoding?NearestFilter:LinearFilter,s.generateMipmaps=s.encoding!==RGBEEncoding,s.anisotropy=0;var l=this,u=0;function c(r,n,i,c){var h=new FileLoader(l.manager);h.setPath(l.path),h.setResponseType("arraybuffer"),h.load(t[r],function(t){u++;var i=l.hdrLoader._parser(t);if(i){if(e===FloatType){for(var c=i.data.length/4*3,h=new Float32Array(c),p=0;p<c;p++)o(i.data,4*p,h,3*p);i.data=h}else if(e===HalfFloatType){c=i.data.length/4*3;var f=new Uint16Array(c);for(p=0;p<c;p++)a(i.data,4*p,f,3*p);i.data=f}if(void 0!==i.image)s[r].images=i.image;else if(void 0!==i.data){var d=new DataTexture(i.data,i.width,i.height);d.format=s.format,d.type=s.type,d.encoding=s.encoding,d.minFilter=s.minFilter,d.magFilter=s.magFilter,d.generateMipmaps=s.generateMipmaps,s.images[r]=d}6===u&&(s.needsUpdate=!0,n&&n(s))}},i,c)}for(var h=0;h<t.length;h++)c(h,r,n,i);return s},HDRCubeTextureLoader.prototype.setPath=function(e){return this.path=e,this};var KMZLoader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager};KMZLoader.prototype={constructor:KMZLoader,load:function(e,t,r,n){var i=this,o=new FileLoader(i.manager);o.setPath(i.path),o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){var t=new LoadingManager;t.setURLModifier(function(e){var t=function(e){for(var t in r.files)if(t.substr(-e.length)===e)return r.files[t]}(e);if(t){console.log("Loading",e);var n=new Blob([t.asArrayBuffer()],{type:"application/octet-stream"});return URL.createObjectURL(n)}return e});var r=new JSZip(e);if(r.files["doc.kml"]){var n=(new DOMParser).parseFromString(r.files["doc.kml"].asText(),"application/xml").querySelector("Placemark Model Link href");if(n)return new ColladaLoader(t).parse(r.files[n.textContent].asText())}else for(var i in console.warn("KMZLoader: Missing doc.kml file."),r.files){if("dae"===i.split(".").pop().toLowerCase())return new ColladaLoader(t).parse(r.files[i].asText())}return console.error("KMZLoader: Couldn't find .dae file."),{scene:new Group}}};var KTXLoader=function e(t){CompressedTextureLoader.call(this,t),this._parser=e.parse};KTXLoader.prototype=Object.create(CompressedTextureLoader.prototype),KTXLoader.prototype.constructor=KTXLoader,KTXLoader.parse=function(e,t){var r=new KhronosTextureContainer(e,1);return{mipmaps:r.mipmaps(t),width:r.pixelWidth,height:r.pixelHeight,format:r.glInternalFormat,isCubemap:6===r.numberOfFaces,mipmapCount:r.numberOfMipmapLevels}};var KhronosTextureContainer=function(){function e(t,r,n,i){this.arrayBuffer=t;var o=new Uint8Array(this.arrayBuffer,0,12);if(171===o[0]&&75===o[1]&&84===o[2]&&88===o[3]&&32===o[4]&&49===o[5]&&49===o[6]&&187===o[7]&&13===o[8]&&10===o[9]&&26===o[10]&&10===o[11]){var a=Uint32Array.BYTES_PER_ELEMENT,s=new DataView(this.arrayBuffer,12,13*a),l=67305985===s.getUint32(0,!0);this.glType=s.getUint32(1*a,l),this.glTypeSize=s.getUint32(2*a,l),this.glFormat=s.getUint32(3*a,l),this.glInternalFormat=s.getUint32(4*a,l),this.glBaseInternalFormat=s.getUint32(5*a,l),this.pixelWidth=s.getUint32(6*a,l),this.pixelHeight=s.getUint32(7*a,l),this.pixelDepth=s.getUint32(8*a,l),this.numberOfArrayElements=s.getUint32(9*a,l),this.numberOfFaces=s.getUint32(10*a,l),this.numberOfMipmapLevels=s.getUint32(11*a,l),this.bytesOfKeyValueData=s.getUint32(12*a,l),0===this.glType?(this.numberOfMipmapLevels=Math.max(1,this.numberOfMipmapLevels),0!==this.pixelHeight&&0===this.pixelDepth?0===this.numberOfArrayElements?this.numberOfFaces===r?this.loadType=e.COMPRESSED_2D:console.warn("number of faces expected"+r+", but found "+this.numberOfFaces):console.warn("texture arrays not currently supported"):console.warn("only 2D textures currently supported")):console.warn("only compressed formats currently supported")}else console.error("texture missing KTX identifier")}return e.prototype.mipmaps=function(t){for(var r=[],n=e.HEADER_LEN+this.bytesOfKeyValueData,i=this.pixelWidth,o=this.pixelHeight,a=t?this.numberOfMipmapLevels:1,s=0;s<a;s++){for(var l=new Int32Array(this.arrayBuffer,n,1)[0],u=0;u<this.numberOfFaces;u++){var c=new Uint8Array(this.arrayBuffer,n+4,l);r.push({data:c,width:i,height:o}),n+=l+4,n+=3-(l+3)%4}i=Math.max(1,.5*i),o=Math.max(1,.5*o)}return r},e.HEADER_LEN=64,e.COMPRESSED_2D=0,e.COMPRESSED_3D=1,e.TEX_2D=2,e.TEX_3D=3,e}(),LDrawLoader=function(){function e(e,t){this.line=e,this.lineLength=e.length,this.currentCharIndex=0,this.currentChar=" ",this.lineNumber=t}function t(e,t){return e.colourCode===t.colourCode?0:e.colourCode<t.colourCode?-1:1}function r(e,r){e.sort(t);var n=[],i=[],o=new BufferGeometry;o.clearGroups();for(var a=null,s=0,l=0,u=0,c=e.length;u<c;u++){var h=e[u],p=h.v0,f=h.v1;n.push(p.x,p.y,p.z,f.x,f.y,f.z),3===r&&n.push(h.v2.x,h.v2.y,h.v2.z),a!==h.material?(null!==a&&o.addGroup(s,l,i.length-1),i.push(h.material),a=h.material,s=u*r,l=r):l+=r}l>0&&o.addGroup(s,1/0,i.length-1),o.addAttribute("position",new Float32BufferAttribute(n,3));var d=null;return 2===r?d=new LineSegments(o,i):3===r&&(o.computeVertexNormals(),d=new Mesh(o,i)),d}function n(t){this.manager=void 0!==t?t:DefaultLoadingManager,this.parseScopesStack=null,this.path="",this.materials=[],this.subobjectCache={},this.fileMap=null,this.setMaterials([this.parseColourMetaDirective(new e("Main_Colour CODE 16 VALUE #FF8080 EDGE #333333")),this.parseColourMetaDirective(new e("Edge_Colour CODE 24 VALUE #A0A0A0 EDGE #333333"))]),this.separateObjects=!1,this.currentGroupObject=null,this.currentTriangles=null,this.currentLineSegments=null}return e.prototype={constructor:e,seekNonSpace:function(){for(;this.currentCharIndex<this.lineLength;){if(this.currentChar=this.line.charAt(this.currentCharIndex)," "!==this.currentChar&&"\t"!==this.currentChar)return;this.currentCharIndex++}},getToken:function(){for(var e=this.currentCharIndex++;this.currentCharIndex<this.lineLength&&(this.currentChar=this.line.charAt(this.currentCharIndex)," "!==this.currentChar&&"\t"!==this.currentChar);)this.currentCharIndex++;var t=this.currentCharIndex;return this.seekNonSpace(),this.line.substring(e,t)},getRemainingString:function(){return this.line.substring(this.currentCharIndex,this.lineLength)},isAtTheEnd:function(){return this.currentCharIndex>=this.lineLength},setToEnd:function(){this.currentCharIndex=this.lineLength},getLineNumberString:function(){return this.lineNumber>=0?" at line "+this.lineNumber:""}},n.FINISH_TYPE_DEFAULT=0,n.FINISH_TYPE_CHROME=1,n.FINISH_TYPE_PEARLESCENT=2,n.FINISH_TYPE_RUBBER=3,n.FINISH_TYPE_MATTE_METALLIC=4,n.FINISH_TYPE_METAL=5,n.FILE_LOCATION_AS_IS=0,n.FILE_LOCATION_TRY_PARTS=1,n.FILE_LOCATION_TRY_P=2,n.FILE_LOCATION_TRY_MODELS=3,n.FILE_LOCATION_TRY_RELATIVE=4,n.FILE_LOCATION_TRY_ABSOLUTE=5,n.FILE_LOCATION_NOT_FOUND=6,n.prototype={constructor:n,load:function(e,t,i,o){this.fileMap||(this.fileMap={});var a=this,s=new FileLoader(this.manager);s.setPath(this.path),s.load(e,function(i){!function t(i,o){var s=a.newParseScopeLevel();s.url=e;var l=a.getParentParseScope();var u=l.currentFileName;void 0===a.subobjectCache[u]&&(a.subobjectCache[u]=i);var c=a.parse(i);s.subobjects=c.userData.subobjects;s.numSubobjects=s.subobjects.length;s.subobjectIndex=0;if(s.numSubobjects>0){var h=f(s.subobjects[0],!0);if(h){for(;h&&s.subobjectIndex<s.numSubobjects-1;)h=f(s.subobjects[++s.subobjectIndex],!0);h&&p()}}else p();return c;function p(){a.separateObjects||l.isFromParse||(a.currentLineSegments.length>0&&c.add(r(a.currentLineSegments,2)),a.currentTriangles.length>0&&c.add(r(a.currentTriangles,3))),a.removeScopeLevel(),o&&o(c)}function f(r,i){s.mainColourCode=r.material.userData.code,s.mainEdgeColourCode=r.material.userData.edgeMaterial.userData.code,s.currentFileName=r.originalFileName,a.separateObjects||s.currentMatrix.multiplyMatrices(l.currentMatrix,r.matrix);var u=a.subobjectCache[r.originalFileName];if(u){var h=t(u,i?void 0:d);return i?(m(r,h),h):void 0}var p=r.fileName,g=n.FILE_LOCATION_NOT_FOUND;switch(r.locationState){case n.FILE_LOCATION_AS_IS:g=r.locationState+1;break;case n.FILE_LOCATION_TRY_PARTS:p="parts/"+p,g=r.locationState+1;break;case n.FILE_LOCATION_TRY_P:p="p/"+p,g=r.locationState+1;break;case n.FILE_LOCATION_TRY_MODELS:p="models/"+p,g=r.locationState+1;break;case n.FILE_LOCATION_TRY_RELATIVE:p=e.substring(0,e.lastIndexOf("/")+1)+p,g=r.locationState+1;break;case n.FILE_LOCATION_TRY_ABSOLUTE:r.triedLowerCase?g=n.FILE_LOCATION_NOT_FOUND:(r.fileName=r.fileName.toLowerCase(),p=r.fileName,r.triedLowerCase=!0,g=n.FILE_LOCATION_AS_IS);break;case n.FILE_LOCATION_NOT_FOUND:return console.warn('LDrawLoader: Subobject "'+r.originalFileName+'" could not be found.'),s.subobjectIndex++,void(s.subobjectIndex>=s.numSubobjects?(a.removeScopeLevel(),o(c)):f(s.subobjects[s.subobjectIndex]))}r.locationState=g,r.url=p,a.load(p,d,void 0,v)}function d(e){var t=s.subobjects[s.subobjectIndex];null!==e?(m(t,e),s.subobjectIndex++,s.subobjectIndex<s.numSubobjects?f(s.subobjects[s.subobjectIndex]):p()):f(t)}function m(e,t){a.separateObjects&&(t.name=e.fileName,c.add(t),t.matrix.copy(e.matrix),t.matrixAutoUpdate=!1),a.fileMap[e.originalFileName]=e.url}function v(e){f(s.subobjects[s.subobjectIndex])}}(i,t)},i,o)},setPath:function(e){return this.path=e,this},setMaterials:function(e){return this.parseScopesStack=[],this.newParseScopeLevel(e),this.getCurrentParseScope().isFromParse=!1,this.materials=e,this.currentGroupObject=null,this},setFileMap:function(e){return this.fileMap=e,this},newParseScopeLevel:function(e){var t={};if(e)for(var r=0,n=e.length;r<n;r++){var i=e[r];t[i.userData.code]=i}var o=this.getCurrentParseScope(),a=(this.getParentParseScope(),{lib:t,url:null,subobjects:null,numSubobjects:0,subobjectIndex:0,currentFileName:null,mainColourCode:o?o.mainColourCode:"16",mainEdgeColourCode:o?o.mainEdgeColourCode:"24",currentMatrix:new Matrix4,isFromParse:!0});return this.parseScopesStack.push(a),a},removeScopeLevel:function(){return this.parseScopesStack.pop(),this},addMaterial:function(e){var t=this.getCurrentParseScope().lib;return t[e.userData.code]||this.materials.push(e),t[e.userData.code]=e,this},getMaterial:function(t){if(t.startsWith("0x2")){var r=t.substring(3);return this.parseColourMetaDirective(new e("Direct_Color_"+r+" CODE -1 VALUE #"+r+" EDGE #"+r))}for(var n=this.parseScopesStack.length-1;n>=0;n--){var i=this.parseScopesStack[n].lib[t];if(i)return i}return null},getParentParseScope:function(){return this.parseScopesStack.length>1?this.parseScopesStack[this.parseScopesStack.length-2]:null},getCurrentParseScope:function(){return this.parseScopesStack.length>0?this.parseScopesStack[this.parseScopesStack.length-1]:null},parseColourMetaDirective:function(e){var t=null,r=16711935,i=16711935,o=1,a=!1,s=0,l=n.FINISH_TYPE_DEFAULT,u=!0,c=null,h=e.getToken();if(!h)throw'LDrawLoader: Material name was expected after "!COLOUR tag'+e.getLineNumberString()+".";for(var p=null;p=e.getToken();)switch(p.toUpperCase()){case"CODE":t=e.getToken();break;case"VALUE":if((r=e.getToken()).startsWith("0x"))r="#"+r.substring(2);else if(!r.startsWith("#"))throw"LDrawLoader: Invalid colour while parsing material"+e.getLineNumberString()+".";break;case"EDGE":if((i=e.getToken()).startsWith("0x"))i="#"+i.substring(2);else if(!i.startsWith("#")){if(!(c=this.getMaterial(i)))throw"LDrawLoader: Invalid edge colour while parsing material"+e.getLineNumberString()+".";c=c.userData.edgeMaterial}break;case"ALPHA":if(o=parseInt(e.getToken()),isNaN(o))throw"LDrawLoader: Invalid alpha value in material definition"+e.getLineNumberString()+".";(o=Math.max(0,Math.min(1,o/255)))<1&&(a=!0);break;case"LUMINANCE":if(s=parseInt(e.getToken()),isNaN(s))throw"LDrawLoader: Invalid luminance value in material definition"+e.getLineNumberString()+".";s=Math.max(0,Math.min(1,s/255));break;case"CHROME":l=n.FINISH_TYPE_CHROME;break;case"PEARLESCENT":l=n.FINISH_TYPE_PEARLESCENT;break;case"RUBBER":l=n.FINISH_TYPE_RUBBER;break;case"MATTE_METALLIC":l=n.FINISH_TYPE_MATTE_METALLIC;break;case"METAL":l=n.FINISH_TYPE_METAL;break;case"MATERIAL":e.setToEnd();break;default:throw'LDrawLoader: Unknown token "'+p+'" while parsing material'+e.getLineNumberString()+"."}var f=null;switch(l){case n.FINISH_TYPE_DEFAULT:case n.FINISH_TYPE_PEARLESCENT:var d=new Color(r),m=35,v=d.getHSL({h:0,s:0,l:0});l===n.FINISH_TYPE_DEFAULT?v.l=Math.min(1,v.l+.12*(1-v.l)):(v.h=(v.h+.5)%1,v.l=Math.min(1,v.l+.7*(1-v.l)),m=10),d.setHSL(v.h,v.s,v.l),f=new MeshPhongMaterial({color:r,specular:d,shininess:m,reflectivity:.3});break;case n.FINISH_TYPE_CHROME:f=new MeshStandardMaterial({color:r,roughness:0,metalness:1});break;case n.FINISH_TYPE_RUBBER:f=new MeshLambertMaterial({color:r}),u=!1;break;case n.FINISH_TYPE_MATTE_METALLIC:f=new MeshStandardMaterial({color:r,roughness:.8,metalness:.4});break;case n.FINISH_TYPE_METAL:f=new MeshStandardMaterial({color:r,roughness:.2,metalness:.85})}return f.side=DoubleSide,f.transparent=a,f.opacity=o,f.userData.canHaveEnvMap=u,0!==s&&f.emissive.set(f.color).multiplyScalar(s),c||((c=new LineBasicMaterial({color:i})).userData.code=t,c.name=h+" - Edge",c.userData.canHaveEnvMap=!1),f.userData.code=t,f.name=h,f.userData.edgeMaterial=c,f},parse:function(t){var i,o,a=this.getParentParseScope(),s=a.mainColourCode,l=a.mainEdgeColourCode;a.url,this.getCurrentParseScope();this.separateObjects?(i=[],o=[]):(null===this.currentGroupObject&&(this.currentGroupObject=new Group,this.currentTriangles=[],this.currentLineSegments=[]),i=this.currentTriangles,o=this.currentLineSegments);var u=[],c=null,h=null;-1!==t.indexOf("\r\n")&&(t=t.replace(/\r\n/g,"\n"));var p=t.split("\n"),f=p.length,d=0,m=!1,v=null,g=null,y=this;function b(e,t){var r=e.getToken();t||"16"!==r||(r=s),t&&"24"===r&&(r=l);var n=y.getMaterial(r);if(!n)throw'LDrawLoader: Unknown colour code "'+r+'" is used'+e.getLineNumberString()+" but it was not defined previously.";return n}function x(e){var t=new Vector3(parseFloat(e.getToken()),parseFloat(e.getToken()),parseFloat(e.getToken()));return y.separateObjects||t.applyMatrix4(a.currentMatrix),t}for(d=0;d<f;d++){var w=p[d];if(0!==w.length)if(m)w.startsWith("0 FILE ")?(this.subobjectCache[v]=g,v=w.substring(7),g=""):g+=w+"\n";else{var S=new e(w,d+1);if(S.seekNonSpace(),!S.isAtTheEnd()){var M=S.getToken();switch(M){case"0":var _=S.getToken();if(_)switch(_){case"!COLOUR":(A=this.parseColourMetaDirective(S))?this.addMaterial(A):console.warn("LDrawLoader: Error parsing material"+S.getLineNumberString());break;case"!CATEGORY":c=S.getToken();break;case"!KEYWORDS":var T=S.getRemainingString().split(",");T.length>0&&(h||(h=[]),T.forEach(function(e){h.push(e.trim())}));break;case"FILE":d>0&&(m=!0,v=S.getRemainingString(),g="")}break;case"1":var A=b(S),C=parseFloat(S.getToken()),E=parseFloat(S.getToken()),L=parseFloat(S.getToken()),N=parseFloat(S.getToken()),P=parseFloat(S.getToken()),O=parseFloat(S.getToken()),R=parseFloat(S.getToken()),D=parseFloat(S.getToken()),F=parseFloat(S.getToken()),k=parseFloat(S.getToken()),I=parseFloat(S.getToken()),B=parseFloat(S.getToken()),U=(new Matrix4).set(N,P,O,C,R,D,F,E,k,I,B,L,0,0,0,1),V=S.getRemainingString().trim().replace("\\","/");y.fileMap[V]?V=y.fileMap[V]:V.startsWith("s/")?V="parts/"+V:V.startsWith("48/")&&(V="p/"+V),u.push({material:A,matrix:U,fileName:V,originalFileName:V,locationState:n.FILE_LOCATION_AS_IS,url:null,triedLowerCase:!1});break;case"2":A=b(S,!0);o.push({material:A.userData.edgeMaterial,colourCode:A.userData.code,v0:x(S),v1:x(S)});break;case"3":A=b(S);i.push({material:A,colourCode:A.userData.code,v0:x(S),v1:x(S),v2:x(S)});break;case"4":A=b(S);var j=x(S),z=x(S),G=x(S),W=x(S);i.push({material:A,colourCode:A.userData.code,v0:j,v1:z,v2:G}),i.push({material:A,colourCode:A.userData.code,v0:j,v1:G,v2:W});break;case"5":break;default:throw'LDrawLoader: Unknown line type "'+M+'"'+S.getLineNumberString()+"."}}}}m&&(this.subobjectCache[v]=g);var H=null;return this.separateObjects?(H=new Group,o.length>0&&H.add(r(o,2)),i.length>0&&H.add(r(i,3))):H=this.currentGroupObject,H.userData.category=c,H.userData.keywords=h,H.userData.subobjects=u,H}},n}(),LoaderSupport={Validator:{isValid:function(e){return null!==e&&void 0!==e},verifyInput:function(e,t){return null===e||void 0===e?t:e}},Callbacks:function(){this.onProgress=null,this.onReportError=null,this.onMeshAlter=null,this.onLoad=null,this.onLoadMaterials=null}};LoaderSupport.Callbacks.prototype={constructor:LoaderSupport.Callbacks,setCallbackOnProgress:function(e){this.onProgress=LoaderSupport.Validator.verifyInput(e,this.onProgress)},setCallbackOnReportError:function(e){this.onReportError=LoaderSupport.Validator.verifyInput(e,this.onReportError)},setCallbackOnMeshAlter:function(e){this.onMeshAlter=LoaderSupport.Validator.verifyInput(e,this.onMeshAlter)},setCallbackOnLoad:function(e){this.onLoad=LoaderSupport.Validator.verifyInput(e,this.onLoad)},setCallbackOnLoadMaterials:function(e){this.onLoadMaterials=LoaderSupport.Validator.verifyInput(e,this.onLoadMaterials)}},LoaderSupport.LoadedMeshUserOverride=function(e,t){this.disregardMesh=!0===e,this.alteredMesh=!0===t,this.meshes=[]},LoaderSupport.LoadedMeshUserOverride.prototype={constructor:LoaderSupport.LoadedMeshUserOverride,addMesh:function(e){this.meshes.push(e),this.alteredMesh=!0},isDisregardMesh:function(){return this.disregardMesh},providesAlteredMeshes:function(){return this.alteredMesh}},LoaderSupport.ResourceDescriptor=function(e,t){var r=e.split("/");this.path,this.resourcePath,this.name=e,this.url=e,r.length>=2&&(this.path=LoaderSupport.Validator.verifyInput(r.slice(0,r.length-1).join("/")+"/",this.path),this.name=r[r.length-1],this.url=e),this.name=LoaderSupport.Validator.verifyInput(this.name,"Unnamed_Resource"),this.extension=LoaderSupport.Validator.verifyInput(t,"default"),this.extension=this.extension.trim(),this.content=null},LoaderSupport.ResourceDescriptor.prototype={constructor:LoaderSupport.ResourceDescriptor,setContent:function(e){this.content=LoaderSupport.Validator.verifyInput(e,null)},setResourcePath:function(e){this.resourcePath=LoaderSupport.Validator.verifyInput(e,this.resourcePath)}},LoaderSupport.PrepData=function(e){this.logging={enabled:!0,debug:!1},this.modelName=LoaderSupport.Validator.verifyInput(e,""),this.resources=[],this.callbacks=new LoaderSupport.Callbacks},LoaderSupport.PrepData.prototype={constructor:LoaderSupport.PrepData,setLogging:function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t},getCallbacks:function(){return this.callbacks},addResource:function(e){this.resources.push(e)},clone:function(){var e,t,r=new LoaderSupport.PrepData(this.modelName);for(e in r.logging.enabled=this.logging.enabled,r.logging.debug=this.logging.debug,r.resources=this.resources,r.callbacks=this.callbacks,this)t=this[e],r.hasOwnProperty(e)||"function"===typeof this[e]||(r[e]=t);return r},checkResourceDescriptorFiles:function(e,t){var r,n,i,o,a={};for(var s in e)if(r=e[s],o=!1,LoaderSupport.Validator.isValid(r.name))if(LoaderSupport.Validator.isValid(r.content)){for(i=0;i<t.length&&!o;i++)if(n=t[i],r.extension.toLowerCase()===n.ext.toLowerCase())if(n.ignore)o=!0;else if("ArrayBuffer"===n.type){if(!(r.content instanceof ArrayBuffer||r.content instanceof Uint8Array))throw"Provided content is not of type ArrayBuffer! Aborting...";a[n.ext]=r,o=!0}else if("String"===n.type){if(!("string"===typeof r.content||r.content instanceof String))throw"Provided  content is not of type String! Aborting...";a[n.ext]=r,o=!0}if(!o)throw'Unidentified resource "'+r.name+'": '+r.url}else{if(!("string"===typeof r.name||r.name instanceof String))throw"Provided file is not properly defined! Aborting...";for(i=0;i<t.length&&!o;i++)n=t[i],r.extension.toLowerCase()===n.ext.toLowerCase()&&(n.ignore||(a[n.ext]=r),o=!0);if(!o)throw'Unidentified resource "'+r.name+'": '+r.url}return a}},LoaderSupport.MeshBuilder=function(){console.info("Using LoaderSupport.MeshBuilder version: "+LoaderSupport.MeshBuilder.LOADER_MESH_BUILDER_VERSION),this.validator=LoaderSupport.Validator,this.logging={enabled:!0,debug:!1},this.callbacks=new LoaderSupport.Callbacks,this.materials=[]},LoaderSupport.MeshBuilder.LOADER_MESH_BUILDER_VERSION="1.3.0",LoaderSupport.MeshBuilder.prototype={constructor:LoaderSupport.MeshBuilder,setLogging:function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t},init:function(){var e=new MeshStandardMaterial({color:14479871});e.name="defaultMaterial";var t=new MeshStandardMaterial({color:14479871});t.name="defaultVertexColorMaterial",t.vertexColors=VertexColors;var r=new LineBasicMaterial;r.name="defaultLineMaterial";var n=new PointsMaterial({size:1});n.name="defaultPointMaterial";var i={};i[e.name]=e,i[t.name]=t,i[r.name]=r,i[n.name]=n,this.updateMaterials({cmd:"materialData",materials:{materialCloneInstructions:null,serializedMaterials:null,runtimeMaterials:i}})},setMaterials:function(e){var t={cmd:"materialData",materials:{materialCloneInstructions:null,serializedMaterials:null,runtimeMaterials:this.validator.isValid(this.callbacks.onLoadMaterials)?this.callbacks.onLoadMaterials(e):e}};this.updateMaterials(t)},_setCallbacks:function(e){this.validator.isValid(e.onProgress)&&this.callbacks.setCallbackOnProgress(e.onProgress),this.validator.isValid(e.onReportError)&&this.callbacks.setCallbackOnReportError(e.onReportError),this.validator.isValid(e.onMeshAlter)&&this.callbacks.setCallbackOnMeshAlter(e.onMeshAlter),this.validator.isValid(e.onLoad)&&this.callbacks.setCallbackOnLoad(e.onLoad),this.validator.isValid(e.onLoadMaterials)&&this.callbacks.setCallbackOnLoadMaterials(e.onLoadMaterials)},processPayload:function(e){return"meshData"===e.cmd?this.buildMeshes(e):"materialData"===e.cmd?(this.updateMaterials(e),null):void 0},buildMeshes:function(e){var t,r,n,i=e.params.meshName,o=new BufferGeometry;o.addAttribute("position",new BufferAttribute(new Float32Array(e.buffers.vertices),3)),this.validator.isValid(e.buffers.indices)&&o.setIndex(new BufferAttribute(new Uint32Array(e.buffers.indices),1)),this.validator.isValid(e.buffers.colors)&&o.addAttribute("color",new BufferAttribute(new Float32Array(e.buffers.colors),3)),this.validator.isValid(e.buffers.normals)?o.addAttribute("normal",new BufferAttribute(new Float32Array(e.buffers.normals),3)):o.computeVertexNormals(),this.validator.isValid(e.buffers.uvs)&&o.addAttribute("uv",new BufferAttribute(new Float32Array(e.buffers.uvs),2));var a=e.materials.materialNames,s=e.materials.multiMaterial,l=[];for(n in a)r=a[n],t=this.materials[r],s&&l.push(t);if(s){t=l;var u,c=e.materials.materialGroups;for(n in c)u=c[n],o.addGroup(u.start,u.count,u.index)}var h,p,f,d=[],m=this.callbacks.onMeshAlter,v=!0,g=this.validator.verifyInput(e.geometryType,0);if(this.validator.isValid(m)&&(p=m({detail:{meshName:i,bufferGeometry:o,material:t,geometryType:g}}),this.validator.isValid(p)))if(p.isDisregardMesh())v=!1;else if(p.providesAlteredMeshes()){for(var y in p.meshes)d.push(p.meshes[y]);v=!1}if(v&&(e.computeBoundingSphere&&o.computeBoundingSphere(),(h=0===g?new Mesh(o,t):1===g?new LineSegments(o,t):new Points(o,t)).name=i,d.push(h)),this.validator.isValid(d)&&d.length>0){var b=[];for(var y in d)h=d[y],b[y]=h.name;f="Adding mesh(es) ("+b.length+": "+b+") from input mesh: "+i,f+=" ("+(100*e.progress.numericalValue).toFixed(2)+"%)"}else f="Not adding mesh: "+i,f+=" ("+(100*e.progress.numericalValue).toFixed(2)+"%)";var x=this.callbacks.onProgress;this.validator.isValid(x)&&x(new CustomEvent("MeshBuilderEvent",{detail:{type:"progress",modelName:e.params.meshName,text:f,numericalValue:e.progress.numericalValue}}));return d},updateMaterials:function(e){var t,r,n=e.materials.materialCloneInstructions;if(this.validator.isValid(n)){var i=n.materialNameOrg,o=this.materials[i];if(this.validator.isValid(i)){t=o.clone(),r=n.materialName,t.name=r;var a=n.materialProperties;for(var s in a)t.hasOwnProperty(s)&&a.hasOwnProperty(s)&&(t[s]=a[s]);this.materials[r]=t}else console.warn('Requested material "'+i+'" is not available!')}var l=e.materials.serializedMaterials;if(this.validator.isValid(l)&&Object.keys(l).length>0){var u,c=new MaterialLoader;for(r in l)u=l[r],this.validator.isValid(u)&&(t=c.parse(u),this.logging.enabled&&console.info('De-serialized material with name "'+r+'" will be added.'),this.materials[r]=t)}if(l=e.materials.runtimeMaterials,this.validator.isValid(l)&&Object.keys(l).length>0)for(r in l)t=l[r],this.logging.enabled&&console.info('Material with name "'+r+'" will be added.'),this.materials[r]=t},getMaterialsJSON:function(){var e,t={};for(var r in this.materials)e=this.materials[r],t[r]=e.toJSON();return t},getMaterials:function(){return this.materials}},LoaderSupport.WorkerSupport=function(){console.info("Using LoaderSupport.WorkerSupport version: "+LoaderSupport.WorkerSupport.WORKER_SUPPORT_VERSION),this.logging={enabled:!0,debug:!1},this.loaderWorker="undefined"!==typeof window?new LoaderSupport.WorkerSupport.LoaderWorker:new LoaderSupport.WorkerSupport.NodeLoaderWorker},LoaderSupport.WorkerSupport.WORKER_SUPPORT_VERSION="2.3.0",LoaderSupport.WorkerSupport.prototype={constructor:LoaderSupport.WorkerSupport,setLogging:function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t,this.loaderWorker.setLogging(this.logging.enabled,this.logging.debug)},setForceWorkerDataCopy:function(e){this.loaderWorker.setForceCopy(e)},validate:function(e,t,r,n,i){if(!LoaderSupport.Validator.isValid(this.loaderWorker.worker)){this.logging.enabled&&(console.info("WorkerSupport: Building worker code..."),console.time("buildWebWorkerCode")),LoaderSupport.Validator.isValid(i)?this.logging.enabled&&console.info('WorkerSupport: Using "'+i.runnerName+'" as Runner class for worker.'):"undefined"!==typeof window?(i=LoaderSupport.WorkerRunnerRefImpl,this.logging.enabled&&console.info('WorkerSupport: Using DEFAULT "LoaderSupport.WorkerRunnerRefImpl" as Runner class for worker.')):(i=LoaderSupport.NodeWorkerRunnerRefImpl,this.logging.enabled&&console.info('WorkerSupport: Using DEFAULT "LoaderSupport.NodeWorkerRunnerRefImpl" as Runner class for worker.'));var o=e(LoaderSupport.WorkerSupport.CodeSerializer);o+="var Parser = "+t+";\n\n",o+=LoaderSupport.WorkerSupport.CodeSerializer.serializeClass(i.runnerName,i),o+="new "+i.runnerName+"();\n\n";var a=this;if(LoaderSupport.Validator.isValid(r)&&r.length>0){var s="";!function e(t,r){if(0===r.length)a.loaderWorker.initWorker(s+o,i.runnerName),a.logging.enabled&&console.timeEnd("buildWebWorkerCode");else{var n=new FileLoader;n.setPath(t),n.setResponseType("text"),n.load(r[0],function(n){s+=n,e(t,r)}),r.shift()}}(n,r)}else this.loaderWorker.initWorker(o,i.runnerName),this.logging.enabled&&console.timeEnd("buildWebWorkerCode")}},setCallbacks:function(e,t){this.loaderWorker.setCallbacks(e,t)},run:function(e){this.loaderWorker.run(e)},setTerminateRequested:function(e){this.loaderWorker.setTerminateRequested(e)}},LoaderSupport.WorkerSupport.LoaderWorker=function(){this._reset()},LoaderSupport.WorkerSupport.LoaderWorker.prototype={constructor:LoaderSupport.WorkerSupport.LoaderWorker,_reset:function(){this.logging={enabled:!0,debug:!1},this.worker=null,this.runnerImplName=null,this.callbacks={meshBuilder:null,onLoad:null},this.terminateRequested=!1,this.queuedMessage=null,this.started=!1,this.forceCopy=!1},checkSupport:function(){return void 0===window.Worker?"This browser does not support web workers!":void 0===window.Blob?"This browser does not support Blob!":"function"!==typeof window.URL.createObjectURL?"This browser does not support Object creation from URL!":void 0},setLogging:function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t},setForceCopy:function(e){this.forceCopy=!0===e},initWorker:function(e,t){var r=this.checkSupport();if(r)throw r;this.runnerImplName=t;var n=new Blob([e],{type:"application/javascript"});this.worker=new Worker(window.URL.createObjectURL(n)),this.worker.onmessage=this._receiveWorkerMessage,this.worker.runtimeRef=this,this._postMessage()},_receiveWorkerMessage:function(e){var t=e.data;switch(t.cmd){case"meshData":case"materialData":case"imageData":this.runtimeRef.callbacks.meshBuilder(t);break;case"complete":this.runtimeRef.queuedMessage=null,this.started=!1,this.runtimeRef.callbacks.onLoad(t.msg),this.runtimeRef.terminateRequested&&(this.runtimeRef.logging.enabled&&console.info("WorkerSupport ["+this.runtimeRef.runnerImplName+"]: Run is complete. Terminating application on request!"),this.runtimeRef._terminate());break;case"error":console.error("WorkerSupport ["+this.runtimeRef.runnerImplName+"]: Reported error: "+t.msg),this.runtimeRef.queuedMessage=null,this.started=!1,this.runtimeRef.callbacks.onLoad(t.msg),this.runtimeRef.terminateRequested&&(this.runtimeRef.logging.enabled&&console.info("WorkerSupport ["+this.runtimeRef.runnerImplName+"]: Run reported error. Terminating application on request!"),this.runtimeRef._terminate());break;default:console.error("WorkerSupport ["+this.runtimeRef.runnerImplName+"]: Received unknown command: "+t.cmd)}},setCallbacks:function(e,t){this.callbacks.meshBuilder=LoaderSupport.Validator.verifyInput(e,this.callbacks.meshBuilder),this.callbacks.onLoad=LoaderSupport.Validator.verifyInput(t,this.callbacks.onLoad)},run:function(e){if(LoaderSupport.Validator.isValid(this.queuedMessage))console.warn("Already processing message. Rejecting new run instruction");else{if(this.queuedMessage=e,this.started=!0,!LoaderSupport.Validator.isValid(this.callbacks.meshBuilder))throw'Unable to run as no "MeshBuilder" callback is set.';if(!LoaderSupport.Validator.isValid(this.callbacks.onLoad))throw'Unable to run as no "onLoad" callback is set.';"run"!==e.cmd&&(e.cmd="run"),LoaderSupport.Validator.isValid(e.logging)?(e.logging.enabled=!0===e.logging.enabled,e.logging.debug=!0===e.logging.debug):e.logging={enabled:!0,debug:!1},this._postMessage()}},_postMessage:function(){var e;LoaderSupport.Validator.isValid(this.queuedMessage)&&LoaderSupport.Validator.isValid(this.worker)&&(this.queuedMessage.data.input instanceof ArrayBuffer?(e=this.forceCopy?this.queuedMessage.data.input.slice(0):this.queuedMessage.data.input,this.worker.postMessage(this.queuedMessage,[e])):this.worker.postMessage(this.queuedMessage))},setTerminateRequested:function(e){this.terminateRequested=!0===e,this.terminateRequested&&LoaderSupport.Validator.isValid(this.worker)&&!LoaderSupport.Validator.isValid(this.queuedMessage)&&this.started&&(this.logging.enabled&&console.info("Worker is terminated immediately as it is not running!"),this._terminate())},_terminate:function(){this.worker.terminate(),this._reset()}},LoaderSupport.WorkerSupport.CodeSerializer={serializeObject:function(e,t){var r,n=e+" = {\n\n";for(var i in t)"string"===typeof(r=t[i])||r instanceof String?n+="\t"+i+': "'+(r=(r=r.replace("\n","\\n")).replace("\r","\\r"))+'",\n':r instanceof Array?n+="\t"+i+": ["+r+"],\n":n+="object"===typeof r?"\t"+i+": {},\n":"\t"+i+": "+r+",\n";return n+="}\n\n"},serializeClass:function(e,t,r,n,i,o,a){var s,l,u,c,h,p=[],f=[],d=[],m=null!==n&&void 0!==n;for(var v in Array.isArray(i)||(i=[]),Array.isArray(o)||(o=null),Array.isArray(a)||(a=[]),t.prototype)s=(l=t.prototype[v]).toString(),"constructor"===v?u=e+" = "+s+";\n\n":"function"===typeof l&&i.indexOf(v)<0&&(null===o||o.indexOf(v)>=0)&&((h=a[v])&&h.fullName===e+".prototype."+v&&(s=h.code),m?p.push(e+".prototype."+v+" = "+s+";\n\n"):p.push("\t"+v+": "+s+",\n\n"));for(var v in t)"function"===typeof(l=t[v])?i.indexOf(v)<0&&(null===o||o.indexOf(v)>=0)&&(s=(h=a[v])&&h.fullName===e+"."+v?h.code:l.toString(),d.push(e+"."+v+" = "+s+";\n\n")):(s="string"===typeof l||l instanceof String?'"'+l.toString()+'"':"object"===typeof l?"{}":l,f.push(e+"."+v+" = "+s+";\n"));void 0!==u&&null!==u||"function"!==typeof t.prototype.constructor||(u=e+" = "+t.prototype.constructor.toString().replace(r,""));var g=u+"\n\n";for(m&&(g+=e+".prototype = Object.create( "+n+".prototype );\n"),g+=e+".prototype.constructor = "+e+";\n",g+="\n\n",c=0;c<f.length;c++)g+=f[c];for(g+="\n\n",c=0;c<d.length;c++)g+=d[c];if(g+="\n\n",m)for(c=0;c<p.length;c++)g+=p[c];else{for(g+=e+".prototype = {\n\n",c=0;c<p.length;c++)g+=p[c];g+="\n};"}return g+="\n\n"}},LoaderSupport.WorkerRunnerRefImpl=function(){this.getParentScope().addEventListener("message",function(e){this.processMessage(e.data)}.bind(this))},LoaderSupport.WorkerRunnerRefImpl.runnerName="LoaderSupport.WorkerRunnerRefImpl",LoaderSupport.WorkerRunnerRefImpl.prototype={constructor:LoaderSupport.WorkerRunnerRefImpl,getParentScope:function(){return self},applyProperties:function(e,t){var r,n,i;for(r in t)n="set"+r.substring(0,1).toLocaleUpperCase()+r.substring(1),i=t[r],"function"===typeof e[n]?e[n](i):e.hasOwnProperty(r)&&(e[r]=i)},processMessage:function(e){if("run"===e.cmd){var t=this.getParentScope(),r={callbackMeshBuilder:function(e){t.postMessage(e)},callbackProgress:function(t){e.logging.enabled&&e.logging.debug&&console.debug("WorkerRunner: progress: "+t)}},n=new Parser;"function"===typeof n.setLogging&&n.setLogging(e.logging.enabled,e.logging.debug),this.applyProperties(n,e.params),this.applyProperties(n,e.materials),this.applyProperties(n,r),n.workerScope=t,n.parse(e.data.input,e.data.options),e.logging.enabled&&console.log("WorkerRunner: Run complete!"),r.callbackMeshBuilder({cmd:"complete",msg:"WorkerRunner completed run."})}else console.error("WorkerRunner: Received unknown command: "+e.cmd)}},LoaderSupport.NodeWorkerRunnerRefImpl=function(){this.runnerName="LoaderSupport.NodeWorkerRunnerRefImpl",this.getParentScope().onmessage=this.processMessage.bind(this)},LoaderSupport.NodeWorkerRunnerRefImpl.prototype=Object.create(LoaderSupport.WorkerRunnerRefImpl.prototype),LoaderSupport.NodeWorkerRunnerRefImpl.prototype.constructor=LoaderSupport.NodeWorkerRunnerRefImpl,LoaderSupport.NodeWorkerRunnerRefImpl.runnerName="LoaderSupport.NodeWorkerRunnerRefImpl",LoaderSupport.NodeWorkerRunnerRefImpl.prototype={getParentScope:function getParentScope(){var _require=eval("require");return _require("worker_threads").parentPort}},LoaderSupport.WorkerSupport.NodeLoaderWorker=function(){LoaderSupport.WorkerSupport.LoaderWorker.call(this)},LoaderSupport.WorkerSupport.NodeLoaderWorker.prototype=Object.create(LoaderSupport.WorkerSupport.LoaderWorker.prototype),LoaderSupport.WorkerSupport.NodeLoaderWorker.prototype.constructor=LoaderSupport.WorkerSupport.NodeLoaderWorker,LoaderSupport.WorkerSupport.NodeLoaderWorker.checkSupport=function(){try{var _require=eval("require");_require.resolve("worker_threads")}catch(e){return"This version of Node does not support web workers!"}},LoaderSupport.WorkerSupport.NodeLoaderWorker.prototype.initWorker=function(code,runnerImplName){var supportError=this.checkSupport();if(supportError)throw supportError;this.runnerImplName=runnerImplName;var _require=eval("require"),Worker=_require("worker_threads").Worker;this.worker=new Worker(code,{eval:!0}),this.worker.onmessage=this._receiveWorkerMessage,this.worker.runtimeRef=this,this._postMessage()},LoaderSupport.WorkerDirector=function(e){if(console.info("Using LoaderSupport.WorkerDirector version: "+LoaderSupport.WorkerDirector.LOADER_WORKER_DIRECTOR_VERSION),this.logging={enabled:!0,debug:!1},this.maxQueueSize=LoaderSupport.WorkerDirector.MAX_QUEUE_SIZE,this.maxWebWorkers=LoaderSupport.WorkerDirector.MAX_WEB_WORKER,this.crossOrigin=null,!LoaderSupport.Validator.isValid(e))throw"Provided invalid classDef: "+e;this.workerDescription={classDef:e,globalCallbacks:{},workerSupports:{},forceWorkerDataCopy:!0},this.objectsCompleted=0,this.instructionQueue=[],this.instructionQueuePointer=0,this.callbackOnFinishedProcessing=null},LoaderSupport.WorkerDirector.LOADER_WORKER_DIRECTOR_VERSION="2.3.0",LoaderSupport.WorkerDirector.MAX_WEB_WORKER=16,LoaderSupport.WorkerDirector.MAX_QUEUE_SIZE=2048,LoaderSupport.WorkerDirector.prototype={constructor:LoaderSupport.WorkerDirector,setLogging:function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t},getMaxQueueSize:function(){return this.maxQueueSize},getMaxWebWorkers:function(){return this.maxWebWorkers},setCrossOrigin:function(e){this.crossOrigin=e},setForceWorkerDataCopy:function(e){this.workerDescription.forceWorkerDataCopy=!0===e},prepareWorkers:function(e,t,r){LoaderSupport.Validator.isValid(e)&&(this.workerDescription.globalCallbacks=e),this.maxQueueSize=Math.min(t,LoaderSupport.WorkerDirector.MAX_QUEUE_SIZE),this.maxWebWorkers=Math.min(r,LoaderSupport.WorkerDirector.MAX_WEB_WORKER),this.maxWebWorkers=Math.min(this.maxWebWorkers,this.maxQueueSize),this.objectsCompleted=0,this.instructionQueue=[],this.instructionQueuePointer=0;for(var n=0;n<this.maxWebWorkers;n++){var i=new LoaderSupport.WorkerSupport;i.setLogging(this.logging.enabled,this.logging.debug),i.setForceWorkerDataCopy(this.workerDescription.forceWorkerDataCopy),this.workerDescription.workerSupports[n]={instanceNo:n,inUse:!1,terminateRequested:!1,workerSupport:i,loader:null}}},enqueueForRun:function(e){this.instructionQueue.length<this.maxQueueSize&&this.instructionQueue.push(e)},isRunning:function(){var e=Object.keys(this.workerDescription.workerSupports);return this.instructionQueue.length>0&&this.instructionQueuePointer<this.instructionQueue.length||e.length>0},processQueue:function(){var e,t;for(var r in this.workerDescription.workerSupports)(t=this.workerDescription.workerSupports[r]).inUse||(this.instructionQueuePointer<this.instructionQueue.length?(e=this.instructionQueue[this.instructionQueuePointer],this._kickWorkerRun(e,t),this.instructionQueuePointer++):this._deregister(t));this.isRunning()||null===this.callbackOnFinishedProcessing||(this.callbackOnFinishedProcessing(),this.callbackOnFinishedProcessing=null)},_kickWorkerRun:function(e,t){t.inUse=!0,t.workerSupport.setTerminateRequested(t.terminateRequested),this.logging.enabled&&console.info("\nAssigning next item from queue to worker (queue length: "+this.instructionQueue.length+")\n\n");var r=LoaderSupport.Validator,n=this,i=e.getCallbacks(),o=this.workerDescription.globalCallbacks;t.loader=this._buildLoader(t.instanceNo);var a=new LoaderSupport.Callbacks;a.setCallbackOnLoad(function(e){r.isValid(o.onLoad)&&o.onLoad(e),r.isValid(i.onLoad)&&i.onLoad(e),n.objectsCompleted++,t.inUse=!1,n.processQueue()}),a.setCallbackOnProgress(function(e){r.isValid(o.onProgress)&&o.onProgress(e),r.isValid(i.onProgress)&&i.onProgress(e)}),a.setCallbackOnReportError(function(e){var a=!0;r.isValid(o.onReportError)&&(a=o.onReportError(t,e)),r.isValid(i.onReportError)&&(a=i.onReportError(t,e)),r.isValid(o.onReportError)||r.isValid(i.onReportError)||(console.error("Loader reported an error: "),console.error(e)),a&&(t.inUse=!1,n.processQueue())}),a.setCallbackOnMeshAlter(function(e,t){return r.isValid(o.onMeshAlter)&&(t=o.onMeshAlter(e,t)),r.isValid(i.onMeshAlter)&&(t=o.onMeshAlter(e,t)),t}),a.setCallbackOnLoadMaterials(function(e){return r.isValid(o.onLoadMaterials)&&(e=o.onLoadMaterials(e)),r.isValid(i.onLoadMaterials)&&(e=i.onLoadMaterials(e)),e}),e.callbacks=a,t.loader.run(e,t.workerSupport)},_buildLoader:function(e){var t=this.workerDescription.classDef,r=Object.create(t.prototype);if(t.call(r,DefaultLoadingManager),!r.hasOwnProperty("instanceNo"))throw t.name+' has no property "instanceNo".';if(r.instanceNo=e,!r.hasOwnProperty("workerSupport"))throw t.name+' has no property "workerSupport".';if("function"!==typeof r.run)throw t.name+' has no function "run".';return r.hasOwnProperty("callbacks")&&LoaderSupport.Validator.isValid(r.callbacks)||(console.warn(t.name+' has an invalid property "callbacks". Will change to "LoaderSupport.Callbacks"'),r.callbacks=new LoaderSupport.Callbacks),r},_deregister:function(e){if(LoaderSupport.Validator.isValid(e)){e.workerSupport.setTerminateRequested(!0),this.logging.enabled&&console.info("Requested termination of worker #"+e.instanceNo+".");var t=e.loader.callbacks;LoaderSupport.Validator.isValid(t.onProgress)&&t.onProgress({detail:{text:""}}),delete this.workerDescription.workerSupports[e.instanceNo]}},tearDown:function(e){for(var t in this.logging.enabled&&console.info("WorkerDirector received the deregister call. Terminating all workers!"),this.instructionQueuePointer=this.instructionQueue.length,this.callbackOnFinishedProcessing=LoaderSupport.Validator.verifyInput(e,null),this.workerDescription.workerSupports)this.workerDescription.workerSupports[t].terminateRequested=!0}};var MD2Loader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager};MD2Loader.prototype={constructor:MD2Loader,load:function(e,t,r,n){var i=this,o=new FileLoader(i.manager);o.setPath(i.path),o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,n)},setPath:function(e){return this.path=e,this},parse:function(){var e=[[-.525731,0,.850651],[-.442863,.238856,.864188],[-.295242,0,.955423],[-.309017,.5,.809017],[-.16246,.262866,.951056],[0,0,1],[0,.850651,.525731],[-.147621,.716567,.681718],[.147621,.716567,.681718],[0,.525731,.850651],[.309017,.5,.809017],[.525731,0,.850651],[.295242,0,.955423],[.442863,.238856,.864188],[.16246,.262866,.951056],[-.681718,.147621,.716567],[-.809017,.309017,.5],[-.587785,.425325,.688191],[-.850651,.525731,0],[-.864188,.442863,.238856],[-.716567,.681718,.147621],[-.688191,.587785,.425325],[-.5,.809017,.309017],[-.238856,.864188,.442863],[-.425325,.688191,.587785],[-.716567,.681718,-.147621],[-.5,.809017,-.309017],[-.525731,.850651,0],[0,.850651,-.525731],[-.238856,.864188,-.442863],[0,.955423,-.295242],[-.262866,.951056,-.16246],[0,1,0],[0,.955423,.295242],[-.262866,.951056,.16246],[.238856,.864188,.442863],[.262866,.951056,.16246],[.5,.809017,.309017],[.238856,.864188,-.442863],[.262866,.951056,-.16246],[.5,.809017,-.309017],[.850651,.525731,0],[.716567,.681718,.147621],[.716567,.681718,-.147621],[.525731,.850651,0],[.425325,.688191,.587785],[.864188,.442863,.238856],[.688191,.587785,.425325],[.809017,.309017,.5],[.681718,.147621,.716567],[.587785,.425325,.688191],[.955423,.295242,0],[1,0,0],[.951056,.16246,.262866],[.850651,-.525731,0],[.955423,-.295242,0],[.864188,-.442863,.238856],[.951056,-.16246,.262866],[.809017,-.309017,.5],[.681718,-.147621,.716567],[.850651,0,.525731],[.864188,.442863,-.238856],[.809017,.309017,-.5],[.951056,.16246,-.262866],[.525731,0,-.850651],[.681718,.147621,-.716567],[.681718,-.147621,-.716567],[.850651,0,-.525731],[.809017,-.309017,-.5],[.864188,-.442863,-.238856],[.951056,-.16246,-.262866],[.147621,.716567,-.681718],[.309017,.5,-.809017],[.425325,.688191,-.587785],[.442863,.238856,-.864188],[.587785,.425325,-.688191],[.688191,.587785,-.425325],[-.147621,.716567,-.681718],[-.309017,.5,-.809017],[0,.525731,-.850651],[-.525731,0,-.850651],[-.442863,.238856,-.864188],[-.295242,0,-.955423],[-.16246,.262866,-.951056],[0,0,-1],[.295242,0,-.955423],[.16246,.262866,-.951056],[-.442863,-.238856,-.864188],[-.309017,-.5,-.809017],[-.16246,-.262866,-.951056],[0,-.850651,-.525731],[-.147621,-.716567,-.681718],[.147621,-.716567,-.681718],[0,-.525731,-.850651],[.309017,-.5,-.809017],[.442863,-.238856,-.864188],[.16246,-.262866,-.951056],[.238856,-.864188,-.442863],[.5,-.809017,-.309017],[.425325,-.688191,-.587785],[.716567,-.681718,-.147621],[.688191,-.587785,-.425325],[.587785,-.425325,-.688191],[0,-.955423,-.295242],[0,-1,0],[.262866,-.951056,-.16246],[0,-.850651,.525731],[0,-.955423,.295242],[.238856,-.864188,.442863],[.262866,-.951056,.16246],[.5,-.809017,.309017],[.716567,-.681718,.147621],[.525731,-.850651,0],[-.238856,-.864188,-.442863],[-.5,-.809017,-.309017],[-.262866,-.951056,-.16246],[-.850651,-.525731,0],[-.716567,-.681718,-.147621],[-.716567,-.681718,.147621],[-.525731,-.850651,0],[-.5,-.809017,.309017],[-.238856,-.864188,.442863],[-.262866,-.951056,.16246],[-.864188,-.442863,.238856],[-.809017,-.309017,.5],[-.688191,-.587785,.425325],[-.681718,-.147621,.716567],[-.442863,-.238856,.864188],[-.587785,-.425325,.688191],[-.309017,-.5,.809017],[-.147621,-.716567,.681718],[-.425325,-.688191,.587785],[-.16246,-.262866,.951056],[.442863,-.238856,.864188],[.16246,-.262866,.951056],[.309017,-.5,.809017],[.147621,-.716567,.681718],[0,-.525731,.850651],[.425325,-.688191,.587785],[.587785,-.425325,.688191],[.688191,-.587785,.425325],[-.955423,.295242,0],[-.951056,.16246,.262866],[-1,0,0],[-.850651,0,.525731],[-.955423,-.295242,0],[-.951056,-.16246,.262866],[-.864188,.442863,-.238856],[-.951056,.16246,-.262866],[-.809017,.309017,-.5],[-.864188,-.442863,-.238856],[-.951056,-.16246,-.262866],[-.809017,-.309017,-.5],[-.681718,.147621,-.716567],[-.681718,-.147621,-.716567],[-.850651,0,-.525731],[-.688191,.587785,-.425325],[-.587785,.425325,-.688191],[-.425325,.688191,-.587785],[-.425325,-.688191,-.587785],[-.587785,-.425325,-.688191],[-.688191,-.587785,-.425325]];return function(t){console.time("MD2Loader");for(var r=new DataView(t),n={},i=["ident","version","skinwidth","skinheight","framesize","num_skins","num_vertices","num_st","num_tris","num_glcmds","num_frames","offset_skins","offset_st","offset_tris","offset_frames","offset_glcmds","offset_end"],o=0;o<i.length;o++)n[i[o]]=r.getInt32(4*o,!0);if(844121161===n.ident&&8===n.version){if(n.offset_end===r.byteLength){for(var a=new BufferGeometry,s=[],l=n.offset_st,u=(o=0,n.num_st);o<u;o++){var c=r.getInt16(l+0,!0),h=r.getInt16(l+2,!0);s.push(c/n.skinwidth,1-h/n.skinheight),l+=4}l=n.offset_tris;var p=[],f=[];for(o=0,u=n.num_tris;o<u;o++)p.push(r.getUint16(l+0,!0),r.getUint16(l+2,!0),r.getUint16(l+4,!0)),f.push(r.getUint16(l+6,!0),r.getUint16(l+8,!0),r.getUint16(l+10,!0)),l+=12;var d=new Vector3,m=new Vector3,v=[],g=[];l=n.offset_frames;for(o=0,u=n.num_frames;o<u;o++){m.set(r.getFloat32(l+0,!0),r.getFloat32(l+4,!0),r.getFloat32(l+8,!0)),d.set(r.getFloat32(l+12,!0),r.getFloat32(l+16,!0),r.getFloat32(l+20,!0)),l+=24;for(var y=0;y<16;y++){var b=r.getUint8(l+y,!0);if(0===b)break;v[y]=b}var x={name:String.fromCharCode.apply(null,v),vertices:[],normals:[]};l+=16;for(y=0;y<n.num_vertices;y++){var w=r.getUint8(l++,!0),S=r.getUint8(l++,!0),M=r.getUint8(l++,!0),_=e[r.getUint8(l++,!0)];w=w*m.x+d.x,S=S*m.y+d.y,M=M*m.z+d.z,x.vertices.push(w,M,S),x.normals.push(_[0],_[2],_[1])}g.push(x)}var T=[],A=[],C=[],E=g[0].vertices,L=g[0].normals;for(o=0,u=p.length;o<u;o++){w=E[I=3*p[o]],S=E[I+1],M=E[I+2];T.push(w,S,M);var N=L[I],P=L[I+1],O=L[I+2];A.push(N,P,O);c=s[I=2*f[o]],h=s[I+1];C.push(c,h)}a.addAttribute("position",new Float32BufferAttribute(T,3)),a.addAttribute("normal",new Float32BufferAttribute(A,3)),a.addAttribute("uv",new Float32BufferAttribute(C,2));var R=[],D=[];for(o=0,u=g.length;o<u;o++){var F=(x=g[o]).name;if(x.vertices.length>0){T=[],y=0;for(var k=p.length;y<k;y++){var I=3*p[y];w=x.vertices[I],S=x.vertices[I+1],M=x.vertices[I+2];T.push(w,S,M)}var B=new Float32BufferAttribute(T,3);B.name=F,R.push(B)}if(x.normals.length>0){for(A=[],y=0,k=p.length;y<k;y++){I=3*p[y],N=x.normals[I],P=x.normals[I+1],O=x.normals[I+2];A.push(N,P,O)}var U=new Float32BufferAttribute(A,3);U.name=F,D.push(U)}}return a.morphAttributes.position=R,a.morphAttributes.normal=D,a.animations=AnimationClip.CreateClipsFromMorphTargetSequences(g,10),console.timeEnd("MD2Loader"),a}console.error("Corrupted MD2 file")}else console.error("Not a valid MD2 file")}}()};var MMDLoader=function(){function e(e){this.manager=void 0!==e?e:DefaultLoadingManager,this.loader=new FileLoader(this.manager),this.parser=null,this.meshBuilder=new r(this.manager),this.animationBuilder=new o}e.prototype={constructor:e,crossOrigin:"anonymous",setCrossOrigin:function(e){return this.crossOrigin=e,this},setAnimationPath:function(e){return this.animationPath=e,this},setPath:function(e){return this.path=e,this},setResoucePath:function(e){return this.resourcePath=e,this},load:function(e,t,r,n){var i,o=this.meshBuilder.setCrossOrigin(this.crossOrigin);i=void 0!==this.resourcePath?this.resourcePath:void 0!==this.path?this.path:LoaderUtils.extractUrlBase(e);var a=this._extractExtension(e).toLowerCase();"pmd"===a||"pmx"===a?this["pmd"===a?"loadPMD":"loadPMX"](e,function(e){t(o.build(e,i,r,n))},r,n):n&&n(new Error("MMDLoader: Unknown model file extension ."+a+"."))},loadAnimation:function(e,t,r,n,i){var o=this.animationBuilder;this.loadVMD(e,function(e){r(t.isCamera?o.buildCameraAnimation(e):o.build(e,t))},n,i)},loadWithAnimation:function(e,t,r,n,i){var o=this;this.load(e,function(e){o.loadAnimation(t,e,function(t){r({mesh:e,animation:t})},n,i)},n,i)},loadPMD:function(e,t,r,n){var i=this._getParser();this.loader.setMimeType(void 0).setPath(this.path).setResponseType("arraybuffer").load(e,function(e){t(i.parsePmd(e,!0))},r,n)},loadPMX:function(e,t,r,n){var i=this._getParser();this.loader.setMimeType(void 0).setPath(this.path).setResponseType("arraybuffer").load(e,function(e){t(i.parsePmx(e,!0))},r,n)},loadVMD:function(e,t,r,n){var i=Array.isArray(e)?e:[e],o=[],a=i.length,s=this._getParser();this.loader.setMimeType(void 0).setPath(this.animationPath).setResponseType("arraybuffer");for(var l=0,u=i.length;l<u;l++)this.loader.load(i[l],function(e){o.push(s.parseVmd(e,!0)),o.length===a&&t(s.mergeVmds(o))},r,n)},loadVPD:function(e,t,r,n,i){var o=this._getParser();this.loader.setMimeType(t?void 0:"text/plain; charset=shift_jis").setPath(this.animationPath).setResponseType("text").load(e,function(e){r(o.parseVpd(e,!0))},n,i)},_extractExtension:function(e){var t=e.lastIndexOf(".");return t<0?"":e.slice(t+1)},_getParser:function(){if(null===this.parser){if("undefined"===typeof MMDParser)throw new Error("MMDLoader: Import MMDParser https://github.com/takahirox/mmd-parser");this.parser=new MMDParser.Parser}return this.parser}};var t=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAN0lEQVRYR+3WQREAMBACsZ5/bWiiMvgEBTt5cW37hjsBBAgQIECAwFwgyfYPCCBAgAABAgTWAh8aBHZBl14e8wAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAOUlEQVRYR+3WMREAMAwDsYY/yoDI7MLwIiP40+RJklfcCCBAgAABAgTqArfb/QMCCBAgQIAAgbbAB3z/e0F3js2cAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAN0lEQVRYR+3WQREAMBACsZ5/B5ilMvgEBTt5cW37hjsBBAgQIECAwFwgyfYPCCBAgAABAgTWAh81dWyx0gFwKAAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAOklEQVRYR+3WoREAMAwDsWb/UQtCy9wxTOQJ/oQ8SXKKGwEECBAgQIBAXeDt7f4BAQQIECBAgEBb4AOz8Hzx7WLY4wAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABPUlEQVRYR+1XwW7CMAy1+f9fZOMysSEOEweEOPRNdm3HbdOyIhAcklPrOs/PLy9RygBALxzcCDQFmgJNgaZAU6Ap0BR4PwX8gsRMVLssMRH5HcpzJEaWL7EVg9F1IHRlyqQohgVr4FGUlUcMJSjcUlDw0zvjeun70cLWmneoyf7NgBTQSniBTQQSuJAZsOnnaczjIMb5hCiuHKxokCrJfVnrctyZL0PkJAJe1HMil4nxeyi3Ypfn1kX51jpPvo/JeCNC4PhVdHdJw2XjBR8brF8PEIhNVn12AgP7uHsTBguBn53MUZCqv7Lp07Pn5k1Ro+uWmUNn7D+M57rtk7aG0Vo73xyF/fbFf0bPJjDXngnGocDTdFhygZjwUQrMNrDcmZlQT50VJ/g/UwNyHpu778+yW+/ksOz/BFo54P4AsUXMfRq7XWsAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACMElEQVRYR+2Xv4pTQRTGf2dubhLdICiii2KnYKHVolhauKWPoGAnNr6BD6CvIVaihYuI2i1ia0BY0MZGRHQXjZj/mSPnnskfNWiWZUlzJ5k7M2cm833nO5Mziej2DWWJRUoCpQKlAntSQCqgw39/iUWAGmh37jrRnVsKlgpiqmkoGVABA7E57fvY+pJDdgKqF6HzFCSADkDq+F6AHABtQ+UMVE5D7zXod7fFNhTEckTbj5XQgHzNN+5tQvc5NG7C6BNkp6D3EmpXHDR+dQAjFLchW3VS9rlw3JBh+B7ys5Cf9z0GW1C/7P32AyBAOAz1q4jGliIH3YPuBnSfQX4OGreTIgEYQb/pBDtPnEQ4CivXYPAWBk13oHrB54yA9QuSn2H4AcKRpEILDt0BUzj+RLR1V5EqjD66NPRBVpLcQwjHoHYJOhsQv6U4mnzmrIXJCFr4LDwm/xBUoboG9XX4cc9VKdYoSA2yk5NQLJaKDUjTBoveG3Z2TElTxwjNK4M3LEZgUdDdruvcXzKBpStgp2NPiWi3ks9ZXxIoFVi+AvHLdc9TqtjL3/aYjpPlrzOcEnK62Szhimdd7xX232zFDTgtxezOu3WNMRLjiKgjtOhHVMd1loynVHvOgjuIIJMaELEqhJAV/RCSLbWTcfPFakFgFlALTRRvx+ok6Hlp/Q+v3fmx90bMyUzaEAhmM3KvHlXTL5DxnbGf/1M8RNNACLL5MNtPxP/mypJAqcDSFfgFhpYqWUzhTEAAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII="];function r(e){this.geometryBuilder=new n,this.materialBuilder=new i(e)}function n(){}function i(e){this.manager=e,this.textureLoader=new TextureLoader(this.manager),this.tgaLoader=null}function o(){}function a(e,t,r,n,i){Interpolant.call(this,e,t,r,n),this.interpolationParams=i}return r.prototype={constructor:r,crossOrigin:"anonymous",setCrossOrigin:function(e){return this.crossOrigin=e,this},build:function(e,t,r,n){var i=this.geometryBuilder.build(e),o=new SkinnedMesh(i,this.materialBuilder.setCrossOrigin(this.crossOrigin).setResourcePath(t).build(e,i,r,n)),a=new Skeleton(function(e){var t,r,n,i,o=e.geometry,a=[];if(o&&void 0!==o.bones){for(n=0,i=o.bones.length;n<i;n++)r=o.bones[n],t=new Bone,a.push(t),t.name=r.name,t.position.fromArray(r.pos),t.quaternion.fromArray(r.rotq),void 0!==r.scl&&t.scale.fromArray(r.scl);for(n=0,i=o.bones.length;n<i;n++)-1!==(r=o.bones[n]).parent&&null!==r.parent&&void 0!==a[r.parent]?a[r.parent].add(a[n]):e.add(a[n])}return e.updateMatrixWorld(!0),a}(o));return o.bind(a),o}},n.prototype={constructor:n,build:function(e){for(var t=[],r=[],n=[],i=[],o=[],a=[],s=[],l=[],u=[],c=[],h=[],p=[],f=[],d=[],m=0,v={},g=0;g<e.metadata.vertexCount;g++){for(var y=e.vertices[g],b=0,x=y.position.length;b<x;b++)t.push(y.position[b]);for(b=0,x=y.normal.length;b<x;b++)n.push(y.normal[b]);for(b=0,x=y.uv.length;b<x;b++)r.push(y.uv[b]);for(b=0;b<4;b++)s.push(y.skinIndices.length-1>=b?y.skinIndices[b]:0);for(b=0;b<4;b++)l.push(y.skinWeights.length-1>=b?y.skinWeights[b]:0)}for(g=0;g<e.metadata.faceCount;g++){var w=e.faces[g];for(b=0,x=w.indices.length;b<x;b++)i.push(w.indices[b])}for(g=0;g<e.metadata.materialCount;g++){var S=e.materials[g];o.push({offset:3*m,count:3*S.faceCount}),m+=S.faceCount}for(g=0;g<e.metadata.rigidBodyCount;g++){var M=e.rigidBodies[g],_=v[M.boneIndex];_=void 0===_?M.type:Math.max(M.type,_),v[M.boneIndex]=_}for(g=0;g<e.metadata.boneCount;g++){-1!==(z={parent:(O=e.bones[g]).parentIndex,name:O.name,pos:O.position.slice(0,3),rotq:[0,0,0,1],scl:[1,1,1],rigidBodyType:void 0!==v[g]?v[g]:-1}).parent&&(z.pos[0]-=e.bones[z.parent].position[0],z.pos[1]-=e.bones[z.parent].position[1],z.pos[2]-=e.bones[z.parent].position[2]),a.push(z)}if("pmd"===e.metadata.format)for(g=0;g<e.metadata.ikCount;g++){var T={target:(A=e.iks[g]).target,effector:A.effector,iteration:A.iteration,maxAngle:4*A.maxAngle,links:[]};for(b=0,x=A.links.length;b<x;b++){(C={}).index=A.links[b].index,C.enabled=!0,e.bones[C.index].name.indexOf("\u3072\u3056")>=0&&(C.limitation=new Vector3(1,0,0)),T.links.push(C)}h.push(T)}else for(g=0;g<e.metadata.boneCount;g++){var A;if(void 0!==(A=e.bones[g].ik)){for(T={target:g,effector:A.effector,iteration:A.iteration,maxAngle:A.maxAngle,links:[]},b=0,x=A.links.length;b<x;b++){var C;if((C={}).index=A.links[b].index,C.enabled=!0,1===A.links[b].angleLimitation){var E=A.links[b].lowerLimitationAngle,L=A.links[b].upperLimitationAngle,N=-L[0],P=-L[1];L[0]=-E[0],L[1]=-E[1],E[0]=N,E[1]=P,C.rotationMin=(new Vector3).fromArray(E),C.rotationMax=(new Vector3).fromArray(L)}T.links.push(C)}h.push(T)}}if("pmx"===e.metadata.format){for(g=0;g<e.metadata.boneCount;g++){var O,R=(O=e.bones[g]).grant;if(void 0!==R){T={index:g,parentIndex:R.parentIndex,ratio:R.ratio,isLocal:R.isLocal,affectRotation:R.affectRotation,affectPosition:R.affectPosition,transformationClass:O.transformationClass};p.push(T)}}p.sort(function(e,t){return e.transformationClass-t.transformationClass})}function D(t,r,n){for(var i=0;i<r.elementCount;i++){var o,a=r.elements[i];o="pmd"===e.metadata.format?e.morphs[0].elements[a.index].index:a.index,t.array[3*o+0]+=a.position[0]*n,t.array[3*o+1]+=a.position[1]*n,t.array[3*o+2]+=a.position[2]*n}}for(g=0;g<e.metadata.morphCount;g++){var F=e.morphs[g],k={name:F.name},I=new Float32BufferAttribute(3*e.metadata.vertexCount,3);I.name=F.name;for(b=0;b<3*e.metadata.vertexCount;b++)I.array[b]=t[b];if("pmd"===e.metadata.format)0!==g&&D(I,F,1);else if(0===F.type)for(b=0;b<F.elementCount;b++){var B=e.morphs[F.elements[b].index],U=F.elements[b].ratio;1===B.type&&D(I,B,U)}else 1===F.type?D(I,F,1):2===F.type||3===F.type||4===F.type||5===F.type||6===F.type||7===F.type||F.type;u.push(k),c.push(I)}for(g=0;g<e.metadata.rigidBodyCount;g++){var V=e.rigidBodies[g];k={};for(var j in V)k[j]=V[j];if("pmx"===e.metadata.format&&-1!==k.boneIndex){var z=e.bones[k.boneIndex];k.position[0]-=z.position[0],k.position[1]-=z.position[1],k.position[2]-=z.position[2]}f.push(k)}for(g=0;g<e.metadata.constraintCount;g++){var G=e.constraints[g];k={};for(var j in G)k[j]=G[j];var W=f[k.rigidBodyIndex1],H=f[k.rigidBodyIndex2];0!==W.type&&2===H.type&&-1!==W.boneIndex&&-1!==H.boneIndex&&e.bones[H.boneIndex].parentIndex===W.boneIndex&&(H.type=1),d.push(k)}var X=new BufferGeometry;X.addAttribute("position",new Float32BufferAttribute(t,3)),X.addAttribute("normal",new Float32BufferAttribute(n,3)),X.addAttribute("uv",new Float32BufferAttribute(r,2)),X.addAttribute("skinIndex",new Uint16BufferAttribute(s,4)),X.addAttribute("skinWeight",new Float32BufferAttribute(l,4)),X.setIndex(i);g=0;for(var q=o.length;g<q;g++)X.addGroup(o[g].offset,o[g].count,g);return X.bones=a,X.morphTargets=u,X.morphAttributes.position=c,X.userData.MMD={bones:a,iks:h,grants:p,rigidBodies:f,constraints:d,format:e.metadata.format},X.computeBoundingSphere(),X}},i.prototype={constructor:i,crossOrigin:"anonymous",resourcePath:void 0,setCrossOrigin:function(e){return this.crossOrigin=e,this},setResourcePath:function(e){return this.resourcePath=e,this},build:function(e,t,r,n){var i=[],o={};this.textureLoader.setCrossOrigin(this.crossOrigin);for(var a=0;a<e.metadata.materialCount;a++){var s=e.materials[a],l={userData:{}};if(void 0!==s.name&&(l.name=s.name),l.color=(new Color).fromArray(s.diffuse),l.opacity=s.diffuse[3],l.specular=(new Color).fromArray(s.specular),l.emissive=(new Color).fromArray(s.ambient),l.shininess=Math.max(s.shininess,1e-4),l.transparent=1!==l.opacity,l.skinning=t.bones.length>0,l.morphTargets=t.morphTargets.length>0,l.lights=!0,l.fog=!0,l.blending=CustomBlending,l.blendSrc=SrcAlphaFactor,l.blendDst=OneMinusSrcAlphaFactor,l.blendSrcAlpha=SrcAlphaFactor,l.blendDstAlpha=DstAlphaFactor,"pmx"===e.metadata.format&&1===(1&s.flag)?l.side=DoubleSide:l.side=1===l.opacity?FrontSide:DoubleSide,"pmd"===e.metadata.format){if(s.fileName){var u=s.fileName.split("*");if(l.map=this._loadTexture(u[0],o),u.length>1){var c=u[1].slice(-4).toLowerCase();l.envMap=this._loadTexture(u[1],o,{sphericalReflectionMapping:!0}),l.combine=".sph"===c?MultiplyOperation:AddOperation}}var h=-1===s.toonIndex?"toon00.bmp":e.toonTextures[s.toonIndex].fileName;l.gradientMap=this._loadTexture(h,o,{isToonTexture:!0,isDefaultToonTexture:this._isDefaultToonTexture(h)}),l.userData.outlineParameters={thickness:1===s.edgeFlag?.003:0,color:[0,0,0],alpha:1,visible:1===s.edgeFlag}}else{var p;-1!==s.textureIndex&&(l.map=this._loadTexture(e.textures[s.textureIndex],o)),-1===s.envTextureIndex||1!==s.envFlag&&2!=s.envFlag||(l.envMap=this._loadTexture(e.textures[s.envTextureIndex],o,{sphericalReflectionMapping:!0}),l.combine=1===s.envFlag?MultiplyOperation:AddOperation),-1===s.toonIndex||0!==s.toonFlag?(h="toon"+("0"+(s.toonIndex+1)).slice(-2)+".bmp",p=!0):(h=e.textures[s.toonIndex],p=!1),l.gradientMap=this._loadTexture(h,o,{isToonTexture:!0,isDefaultToonTexture:p}),l.userData.outlineParameters={thickness:s.edgeSize/300,color:s.edgeColor.slice(0,3),alpha:s.edgeColor[3],visible:0!==(16&s.flag)&&s.edgeSize>0}}void 0!==l.map&&(l.transparent||this._checkImageTransparency(l.map,t,a),l.emissive.multiplyScalar(.2)),i.push(new MeshToonMaterial(l))}if("pmx"===e.metadata.format)for(var f=function(e,t){for(var r=0,n=e.length;r<n;r++){var i=e[r];if(-1!==i.index){var o=t[i.index];o.opacity!==i.diffuse[3]&&(o.transparent=!0)}}},d=(a=0,e.morphs.length);a<d;a++){var m=e.morphs[a],v=m.elements;if(0===m.type)for(var g=0,y=v.length;g<y;g++){var b=e.morphs[v[g].index];8===b.type&&f(b.elements,i)}else 8===m.type&&f(v,i)}return i},_getTGALoader:function(){if(null===this.tgaLoader){if(void 0===TGALoader)throw new Error("MMDLoader: Import TGALoader");this.tgaLoader=new TGALoader(this.manager)}return this.tgaLoader},_isDefaultToonTexture:function(e){return 10===e.length&&/toon(10|0[0-9])\.bmp/.test(e)},_loadTexture:function(e,r,n,i,o){var a,s=this;if(!0===(n=n||{}).isDefaultToonTexture){var l;try{l=parseInt(e.match("toon([0-9]{2}).bmp$")[1])}catch(h){console.warn("MMDLoader: "+e+" seems like a not right default texture path. Using toon00.bmp instead."),l=0}a=t[l]}else a=this.resourcePath+e;if(void 0!==r[a])return r[a];var u=Loader.Handlers.get(a);null===u&&(u=".tga"===e.slice(-4).toLowerCase()?this._getTGALoader():this.textureLoader);var c=u.load(a,function(e){!0===n.isToonTexture&&(e.image=s._getRotatedImage(e.image)),e.flipY=!1,e.wrapS=RepeatWrapping,e.wrapT=RepeatWrapping;for(var t=0;t<c.readyCallbacks.length;t++)c.readyCallbacks[t](c);delete c.readyCallbacks},i,o);return!0===n.sphericalReflectionMapping&&(c.mapping=SphericalReflectionMapping),c.readyCallbacks=[],r[a]=c,c},_getRotatedImage:function(e){var t=document.createElement("canvas"),r=t.getContext("2d"),n=e.width,i=e.height;return t.width=n,t.height=i,r.clearRect(0,0,n,i),r.translate(n/2,i/2),r.rotate(.5*Math.PI),r.translate(-n/2,-i/2),r.drawImage(e,0,0),r.getImageData(0,0,n,i)},_checkImageTransparency:function(e,t,r){e.readyCallbacks.push(function(n){function i(e,t){var r=e.width,n=e.height,i=Math.round(t.x*r)%r,o=Math.round(t.y*n)%n;i<0&&(i+=r),o<0&&(o+=n);var a=o*r+i;return e.data[4*a+3]}var o=void 0!==n.image.data?n.image:function(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var r=t.getContext("2d");return r.drawImage(e,0,0),r.getImageData(0,0,t.width,t.height)}(n.image),a=t.groups[r];(function(e,t,r){var n=e.width,o=e.height;if(e.data.length/(n*o)!==4)return!1;for(var a=0;a<r.length;a+=3){for(var s={x:0,y:0},l=0;l<3;l++){var u=r[3*a+l],c={x:t[2*u+0],y:t[2*u+1]};if(i(e,c)<253)return!0;s.x+=c.x,s.y+=c.y}if(s.x/=3,s.y/=3,i(e,s)<253)return!0}return!1})(o,t.attributes.uv.array,t.index.array.slice(a.start,a.start+a.count))&&(e.transparent=!0)})}},o.prototype={constructor:o,build:function(e,t){for(var r=this.buildSkeletalAnimation(e,t).tracks,n=this.buildMorphAnimation(e,t).tracks,i=0,o=n.length;i<o;i++)r.push(n[i]);return new AnimationClip("",-1,r)},buildSkeletalAnimation:function(e,t){function r(e,t,r){e.push(t[r+0]/127),e.push(t[r+8]/127),e.push(t[r+4]/127),e.push(t[r+12]/127)}for(var n=[],i={},o=t.skeleton.bones,a={},s=0,l=o.length;s<l;s++)a[o[s].name]=!0;for(s=0;s<e.metadata.motionCount;s++){var u=e.motions[s],c=u.boneName;void 0!==a[c]&&(i[c]=i[c]||[],i[c].push(u))}for(var h in i){var p=i[h];p.sort(function(e,t){return e.frameNum-t.frameNum});var f=[],d=[],m=[],v=[],g=[],y=t.skeleton.getBoneByName(h).position.toArray();for(s=0,l=p.length;s<l;s++){var b=p[s].frameNum/30,x=p[s].position,w=p[s].rotation,S=p[s].interpolation;f.push(b);for(var M=0;M<3;M++)d.push(y[M]+x[M]);for(M=0;M<4;M++)m.push(w[M]);for(M=0;M<3;M++)r(v,S,M);r(g,S,3)}var _=".bones["+h+"]";n.push(this._createTrack(_+".position",VectorKeyframeTrack,f,d,v)),n.push(this._createTrack(_+".quaternion",QuaternionKeyframeTrack,f,m,g))}return new AnimationClip("",-1,n)},buildMorphAnimation:function(e,t){for(var r=[],n={},i=t.morphTargetDictionary,o=0;o<e.metadata.morphCount;o++){var a=e.morphs[o],s=a.morphName;void 0!==i[s]&&(n[s]=n[s]||[],n[s].push(a))}for(var l in n){var u=n[l];u.sort(function(e,t){return e.frameNum-t.frameNum});for(var c=[],h=[],p=(o=0,u.length);o<p;o++)c.push(u[o].frameNum/30),h.push(u[o].weight);r.push(new NumberKeyframeTrack(".morphTargetInfluences["+i[l]+"]",c,h))}return new AnimationClip("",-1,r)},buildCameraAnimation:function(e){function t(e,t){e.push(t.x),e.push(t.y),e.push(t.z)}function r(e,t,r){e.push(t[4*r+0]/127),e.push(t[4*r+1]/127),e.push(t[4*r+2]/127),e.push(t[4*r+3]/127)}var n=[],i=void 0===e.cameras?[]:e.cameras.slice();i.sort(function(e,t){return e.frameNum-t.frameNum});for(var o,a,s=[],l=[],u=[],c=[],h=[],p=[],f=[],d=[],m=[],v=new Quaternion,g=new Euler,y=new Vector3,b=new Vector3,x=0,w=i.length;x<w;x++){var S=i[x],M=S.frameNum/30,_=S.position,T=S.rotation,A=S.distance,C=S.fov,E=S.interpolation;s.push(M),y.set(0,0,-A),b.set(_[0],_[1],_[2]),g.set(-T[0],-T[1],-T[2]),v.setFromEuler(g),y.add(b),y.applyQuaternion(v),t(l,b),(o=u).push((a=v).x),o.push(a.y),o.push(a.z),o.push(a.w),t(c,y),h.push(C);for(var L=0;L<3;L++)r(p,E,L);r(f,E,3);for(L=0;L<3;L++)r(d,E,4);r(m,E,5)}return(n=[]).push(this._createTrack("target.position",VectorKeyframeTrack,s,l,p)),n.push(this._createTrack(".quaternion",QuaternionKeyframeTrack,s,u,f)),n.push(this._createTrack(".position",VectorKeyframeTrack,s,c,d)),n.push(this._createTrack(".fov",NumberKeyframeTrack,s,h,m)),new AnimationClip("",-1,n)},_createTrack:function(e,t,r,n,i){if(r.length>2){r=r.slice(),n=n.slice(),i=i.slice();for(var o=n.length/r.length,s=i.length/r.length,l=1,u=2,c=r.length;u<c;u++){for(var h=0;h<o;h++)if(n[l*o+h]!==n[(l-1)*o+h]||n[l*o+h]!==n[u*o+h]){l++;break}if(u>l){r[l]=r[u];for(h=0;h<o;h++)n[l*o+h]=n[u*o+h];for(h=0;h<s;h++)i[l*s+h]=i[u*s+h]}}r.length=l+1,n.length=(l+1)*o,i.length=(l+1)*s}var p=new t(e,r,n);return p.createInterpolant=function(e){return new a(this.times,this.values,this.getValueSize(),e,new Float32Array(i))},p}},a.prototype=Object.assign(Object.create(Interpolant.prototype),{constructor:a,interpolate_:function(e,t,r,n){var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=this.interpolationParams,l=e*a,u=l-a,c=n-t<.05?0:(r-t)/(n-t);if(4===a){var h=s[4*e+0],p=s[4*e+1],f=s[4*e+2],d=s[4*e+3],m=this._calculate(h,p,f,d,c);Quaternion.slerpFlat(i,0,o,u,o,l,m)}else if(3===a)for(var v=0;v!==a;++v){h=s[12*e+4*v+0],p=s[12*e+4*v+1],f=s[12*e+4*v+2],d=s[12*e+4*v+3],m=this._calculate(h,p,f,d,c);i[v]=o[u+v]*(1-m)+o[l+v]*m}else{h=s[4*e+0],p=s[4*e+1],f=s[4*e+2],d=s[4*e+3],m=this._calculate(h,p,f,d,c);i[0]=o[u]*(1-m)+o[l]*m}return i},_calculate:function(e,t,r,n,i){for(var o,a,s,l=.5,u=l,c=1-u,h=Math,p=0;p<15;p++){var f=(o=3*c*c*u)*e+(a=3*c*u*u)*t+(s=u*u*u)-i;if(h.abs(f)<1e-5)break;l/=2,c=1-(u+=f<0?l:-l)}return o*r+a*n+s}}),e}(),MTLLoader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager};MTLLoader.prototype={constructor:MTLLoader,load:function(e,t,r,n){var i=this,o=void 0===this.path?LoaderUtils.extractUrlBase(e):this.path,a=new FileLoader(this.manager);a.setPath(this.path),a.load(e,function(e){t(i.parse(e,o))},r,n)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setTexturePath:function(e){return console.warn("MTLLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setMaterialOptions:function(e){return this.materialOptions=e,this},parse:function(e,t){for(var r=e.split("\n"),n={},i=/\s+/,o={},a=0;a<r.length;a++){var s=r[a];if(0!==(s=s.trim()).length&&"#"!==s.charAt(0)){var l=s.indexOf(" "),u=l>=0?s.substring(0,l):s;u=u.toLowerCase();var c=l>=0?s.substring(l+1):"";if(c=c.trim(),"newmtl"===u)n={name:c},o[c]=n;else if("ka"===u||"kd"===u||"ks"===u||"ke"===u){var h=c.split(i,3);n[u]=[parseFloat(h[0]),parseFloat(h[1]),parseFloat(h[2])]}else n[u]=c}}var p=new MTLLoader.MaterialCreator(this.resourcePath||t,this.materialOptions);return p.setCrossOrigin(this.crossOrigin),p.setManager(this.manager),p.setMaterials(o),p}},MTLLoader.MaterialCreator=function(e,t){this.baseUrl=e||"",this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:RepeatWrapping},MTLLoader.MaterialCreator.prototype={constructor:MTLLoader.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(e){return this.crossOrigin=e,this},setManager:function(e){this.manager=e},setMaterials:function(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(e){if(!this.options)return e;var t={};for(var r in e){var n=e[r],i={};for(var o in t[r]=i,n){var a=!0,s=n[o],l=o.toLowerCase();switch(l){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(s=[s[0]/255,s[1]/255,s[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===s[0]&&0===s[1]&&0===s[2]&&(a=!1)}a&&(i[l]=s)}}return t},preload:function(){for(var e in this.materialsInfo)this.create(e)},getIndex:function(e){return this.nameLookup[e]},getAsArray:function(){var e=0;for(var t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray},create:function(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]},createMaterial_:function(e){var t=this,r=this.materialsInfo[e],n={name:e,side:this.side};function i(e,r){if(!n[e]){var i,o,a=t.getTextureParams(r,n),s=t.loadTexture((i=t.baseUrl,"string"!==typeof(o=a.url)||""===o?"":/^https?:\/\//i.test(o)?o:i+o));s.repeat.copy(a.scale),s.offset.copy(a.offset),s.wrapS=t.wrap,s.wrapT=t.wrap,n[e]=s}}for(var o in r){var a,s=r[o];if(""!==s)switch(o.toLowerCase()){case"kd":n.color=(new Color).fromArray(s);break;case"ks":n.specular=(new Color).fromArray(s);break;case"ke":n.emissive=(new Color).fromArray(s);break;case"map_kd":i("map",s);break;case"map_ks":i("specularMap",s);break;case"map_ke":i("emissiveMap",s);break;case"norm":i("normalMap",s);break;case"map_bump":case"bump":i("bumpMap",s);break;case"map_d":i("alphaMap",s),n.transparent=!0;break;case"ns":n.shininess=parseFloat(s);break;case"d":(a=parseFloat(s))<1&&(n.opacity=a,n.transparent=!0);break;case"tr":a=parseFloat(s),this.options&&this.options.invertTrProperty&&(a=1-a),a>0&&(n.opacity=1-a,n.transparent=!0)}}return this.materials[e]=new MeshPhongMaterial(n),this.materials[e]},getTextureParams:function(e,t){var r,n={scale:new Vector2(1,1),offset:new Vector2(0,0)},i=e.split(/\s+/);return(r=i.indexOf("-bm"))>=0&&(t.bumpScale=parseFloat(i[r+1]),i.splice(r,2)),(r=i.indexOf("-s"))>=0&&(n.scale.set(parseFloat(i[r+1]),parseFloat(i[r+2])),i.splice(r,4)),(r=i.indexOf("-o"))>=0&&(n.offset.set(parseFloat(i[r+1]),parseFloat(i[r+2])),i.splice(r,4)),n.url=i.join(" ").trim(),n},loadTexture:function(e,t,r,n,i){var o,a=Loader$1.Handlers.get(e),s=void 0!==this.manager?this.manager:DefaultLoadingManager;return null===a&&(a=new TextureLoader(s)),a.setCrossOrigin&&a.setCrossOrigin(this.crossOrigin),o=a.load(e,r,n,i),void 0!==t&&(o.mapping=t),o}};var NodeMaterialLoader=function(e,t){this.manager=void 0!==e?e:DefaultLoadingManager,this.nodes={},this.materials={},this.passes={},this.names={},this.library=t||{}};Object.assign(NodeMaterialLoader.prototype,{load:function(e,t,r,n){var i=this,o=new FileLoader(i.manager);return o.setPath(i.path),o.load(e,function(e){t(i.parse(JSON.parse(e)))},r,n),this},setPath:function(e){return this.path=e,this},getObjectByName:function(e){return this.names[e]},getObjectById:function(e){return this.library[e]||this.nodes[e]||this.materials[e]||this.passes[e]||this.names[e]},getNode:function(e){var t=this.getObjectById(e);return t||console.warn('Node "'+e+'" not found.'),t},resolve:function(e){switch(typeof e){case"boolean":case"number":return e;case"string":return/^\w{8}-\w{4}-\w{4}-\w{4}-\w{12}$/i.test(e)||this.library[e]?this.getNode(e):e;default:if(Array.isArray(e))for(var t=0;t<e.length;t++)e[t]=this.resolve(e[t]);else for(var r in e)"uuid"!==r&&(e[r]=this.resolve(e[r]))}return e},declare:function(e){var t,r,n;for(t in e.nodes)r=e.nodes[t],n=new THREE[r.nodeType+"Node"],r.name&&(n.name=r.name,this.names[n.name]=n),this.nodes[t]=n;for(t in e.materials)r=e.materials[t],n=new THREE[r.type],r.name&&(n.name=r.name,this.names[n.name]=n),this.materials[t]=n;for(t in e.passes)r=e.passes[t],n=new THREE[r.type],r.name&&(n.name=r.name,this.names[n.name]=n),this.passes[t]=n;return e.material&&(this.material=this.materials[e.material]),e.pass&&(this.pass=this.passes[e.pass]),e},parse:function(e){var t;for(t in(e=this.resolve(this.declare(e))).nodes)this.nodes[t].copy(e.nodes[t]);for(t in e.materials)this.materials[t].copy(e.materials[t]);for(t in e.passes)this.passes[t].copy(e.passes[t]);return this.material||this.pass||this}});var OBJLoader=function(){var e=/^[og]\s*(.+)?/,t=/^mtllib /,r=/^usemtl /;function n(){var e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);var r=this.object&&"function"===typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(e,t){var r=this._finalize(!1);r&&(r.inherited||r.groupCount<=0)&&this.materials.splice(r.index,1);var n={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&t.length>0?t[t.length-1]:"",smooth:void 0!==r?r.smooth:this.smooth,groupStart:void 0!==r?r.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){var t={index:"number"===typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return t.clone=this.clone.bind(t),t}};return this.materials.push(n),n},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(e){var t=this.currentMaterial();if(t&&-1===t.groupEnd&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e&&this.materials.length>1)for(var r=this.materials.length-1;r>=0;r--)this.materials[r].groupCount<=0&&this.materials.splice(r,1);return e&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),t}},r&&r.name&&"function"===typeof r.clone){var n=r.clone(0);n.inherited=!0,this.object.materials.push(n)}this.objects.push(this.object)},finalize:function(){this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){var r=parseInt(e,10);return 3*(r>=0?r-1:r+t/3)},parseNormalIndex:function(e,t){var r=parseInt(e,10);return 3*(r>=0?r-1:r+t/3)},parseUVIndex:function(e,t){var r=parseInt(e,10);return 2*(r>=0?r-1:r+t/2)},addVertex:function(e,t,r){var n=this.vertices,i=this.object.geometry.vertices;i.push(n[e+0],n[e+1],n[e+2]),i.push(n[t+0],n[t+1],n[t+2]),i.push(n[r+0],n[r+1],n[r+2])},addVertexPoint:function(e){var t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){var t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,r){var n=this.normals,i=this.object.geometry.normals;i.push(n[e+0],n[e+1],n[e+2]),i.push(n[t+0],n[t+1],n[t+2]),i.push(n[r+0],n[r+1],n[r+2])},addColor:function(e,t,r){var n=this.colors,i=this.object.geometry.colors;i.push(n[e+0],n[e+1],n[e+2]),i.push(n[t+0],n[t+1],n[t+2]),i.push(n[r+0],n[r+1],n[r+2])},addUV:function(e,t,r){var n=this.uvs,i=this.object.geometry.uvs;i.push(n[e+0],n[e+1]),i.push(n[t+0],n[t+1]),i.push(n[r+0],n[r+1])},addUVLine:function(e){var t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,r,n,i,o,a,s,l){var u=this.vertices.length,c=this.parseVertexIndex(e,u),h=this.parseVertexIndex(t,u),p=this.parseVertexIndex(r,u);if(this.addVertex(c,h,p),void 0!==n&&""!==n){var f=this.uvs.length;c=this.parseUVIndex(n,f),h=this.parseUVIndex(i,f),p=this.parseUVIndex(o,f),this.addUV(c,h,p)}if(void 0!==a&&""!==a){var d=this.normals.length;c=this.parseNormalIndex(a,d),h=a===s?c:this.parseNormalIndex(s,d),p=a===l?c:this.parseNormalIndex(l,d),this.addNormal(c,h,p)}this.colors.length>0&&this.addColor(c,h,p)},addPointGeometry:function(e){this.object.geometry.type="Points";for(var t=this.vertices.length,r=0,n=e.length;r<n;r++)this.addVertexPoint(this.parseVertexIndex(e[r],t))},addLineGeometry:function(e,t){this.object.geometry.type="Line";for(var r=this.vertices.length,n=this.uvs.length,i=0,o=e.length;i<o;i++)this.addVertexLine(this.parseVertexIndex(e[i],r));var a=0;for(o=t.length;a<o;a++)this.addUVLine(this.parseUVIndex(t[a],n))}};return e.startObject("",!1),e}function i(e){this.manager=void 0!==e?e:DefaultLoadingManager,this.materials=null}return i.prototype={constructor:i,load:function(e,t,r,n){var i=this,o=new FileLoader(i.manager);o.setPath(this.path),o.load(e,function(e){t(i.parse(e))},r,n)},setPath:function(e){return this.path=e,this},setMaterials:function(e){return this.materials=e,this},parse:function(i){console.time("OBJLoader");var o=new n;-1!==i.indexOf("\r\n")&&(i=i.replace(/\r\n/g,"\n")),-1!==i.indexOf("\\\n")&&(i=i.replace(/\\\n/g,""));for(var a=i.split("\n"),s="",l="",u=[],c="function"===typeof"".trimLeft,h=0,p=a.length;h<p;h++)if(s=a[h],0!==(s=c?s.trimLeft():s.trim()).length&&"#"!==(l=s.charAt(0)))if("v"===l){var f=s.split(/\s+/);switch(f[0]){case"v":o.vertices.push(parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3])),8===f.length&&o.colors.push(parseFloat(f[4]),parseFloat(f[5]),parseFloat(f[6]));break;case"vn":o.normals.push(parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3]));break;case"vt":o.uvs.push(parseFloat(f[1]),parseFloat(f[2]))}}else if("f"===l){for(var d=s.substr(1).trim().split(/\s+/),m=[],v=0,g=d.length;v<g;v++){var y=d[v];if(y.length>0){var b=y.split("/");m.push(b)}}var x=m[0];for(v=1,g=m.length-1;v<g;v++){var w=m[v],S=m[v+1];o.addFace(x[0],w[0],S[0],x[1],w[1],S[1],x[2],w[2],S[2])}}else if("l"===l){var M=s.substring(1).trim().split(" "),_=[],T=[];if(-1===s.indexOf("/"))_=M;else for(var A=0,C=M.length;A<C;A++){var E=M[A].split("/");""!==E[0]&&_.push(E[0]),""!==E[1]&&T.push(E[1])}o.addLineGeometry(_,T)}else if("p"===l){var L=s.substr(1).trim().split(" ");o.addPointGeometry(L)}else if(null!==(u=e.exec(s))){var N=(" "+u[0].substr(1).trim()).substr(1);o.startObject(N)}else if(r.test(s))o.object.startMaterial(s.substring(7).trim(),o.materialLibraries);else if(t.test(s))o.materialLibraries.push(s.substring(7).trim());else{if("s"!==l){if("\0"===s)continue;throw new Error('OBJLoader: Unexpected line: "'+s+'"')}if((u=s.split(" ")).length>1){var P=u[1].trim().toLowerCase();o.object.smooth="0"!==P&&"off"!==P}else o.object.smooth=!0;(H=o.object.currentMaterial())&&(H.smooth=o.object.smooth)}o.finalize();var O=new Group;O.materialLibraries=[].concat(o.materialLibraries);for(h=0,p=o.objects.length;h<p;h++){var R=o.objects[h],D=R.geometry,F=R.materials,k="Line"===D.type,I="Points"===D.type,B=!1;if(0!==D.vertices.length){var U=new BufferGeometry;U.addAttribute("position",new Float32BufferAttribute(D.vertices,3)),D.normals.length>0?U.addAttribute("normal",new Float32BufferAttribute(D.normals,3)):U.computeVertexNormals(),D.colors.length>0&&(B=!0,U.addAttribute("color",new Float32BufferAttribute(D.colors,3))),D.uvs.length>0&&U.addAttribute("uv",new Float32BufferAttribute(D.uvs,2));for(var V,j=[],z=0,G=F.length;z<G;z++){var W=F[z],H=void 0;if(null!==this.materials)if(H=this.materials.create(W.name),!k||!H||H instanceof LineBasicMaterial){if(I&&H&&!(H instanceof PointsMaterial)){var X=new PointsMaterial({size:10,sizeAttenuation:!1});Material.prototype.copy.call(X,H),X.color.copy(H.color),X.map=H.map,X.lights=!1,H=X}}else{var q=new LineBasicMaterial;Material.prototype.copy.call(q,H),q.color.copy(H.color),q.lights=!1,H=q}H||((H=k?new LineBasicMaterial:I?new PointsMaterial({size:1,sizeAttenuation:!1}):new MeshPhongMaterial).name=W.name),H.flatShading=!W.smooth,H.vertexColors=B?VertexColors:NoColors,j.push(H)}if(j.length>1){for(z=0,G=F.length;z<G;z++){W=F[z];U.addGroup(W.groupStart,W.groupCount,z)}V=k?new LineSegments(U,j):I?new Points(U,j):new Mesh(U,j)}else V=k?new LineSegments(U,j[0]):I?new Points(U,j[0]):new Mesh(U,j[0]);V.name=R.name,O.add(V)}}return console.timeEnd("OBJLoader"),O}},i}();void 0===LoaderSupport&&console.error('"LoaderSupport" is not available. "OBJLoader2" requires it. Please include "LoaderSupport.js" in your HTML.');var OBJLoader2=function e(t){console.info("Using OBJLoader2 version: "+e.OBJLOADER2_VERSION),this.manager=LoaderSupport.Validator.verifyInput(t,DefaultLoadingManager),this.logging={enabled:!0,debug:!1},this.modelName="",this.instanceNo=0,this.path,this.resourcePath,this.useIndices=!1,this.disregardNormals=!1,this.materialPerSmoothingGroup=!1,this.useOAsMesh=!1,this.loaderRootNode=new Group,this.meshBuilder=new LoaderSupport.MeshBuilder,this.callbacks=new LoaderSupport.Callbacks,this.workerSupport=new LoaderSupport.WorkerSupport,this.terminateWorkerOnLoad=!0};OBJLoader2.OBJLOADER2_VERSION="2.5.0",OBJLoader2.prototype={constructor:OBJLoader2,setLogging:function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t,this.meshBuilder.setLogging(this.logging.enabled,this.logging.debug)},setModelName:function(e){this.modelName=LoaderSupport.Validator.verifyInput(e,this.modelName)},setPath:function(e){this.path=LoaderSupport.Validator.verifyInput(e,this.path)},setResourcePath:function(e){this.resourcePath=LoaderSupport.Validator.verifyInput(e,this.resourcePath)},setStreamMeshesTo:function(e){this.loaderRootNode=LoaderSupport.Validator.verifyInput(e,this.loaderRootNode)},setMaterials:function(e){this.meshBuilder.setMaterials(e)},setUseIndices:function(e){this.useIndices=!0===e},setDisregardNormals:function(e){this.disregardNormals=!0===e},setMaterialPerSmoothingGroup:function(e){this.materialPerSmoothingGroup=!0===e},setUseOAsMesh:function(e){this.useOAsMesh=!0===e},_setCallbacks:function(e){LoaderSupport.Validator.isValid(e.onProgress)&&this.callbacks.setCallbackOnProgress(e.onProgress),LoaderSupport.Validator.isValid(e.onReportError)&&this.callbacks.setCallbackOnReportError(e.onReportError),LoaderSupport.Validator.isValid(e.onMeshAlter)&&this.callbacks.setCallbackOnMeshAlter(e.onMeshAlter),LoaderSupport.Validator.isValid(e.onLoad)&&this.callbacks.setCallbackOnLoad(e.onLoad),LoaderSupport.Validator.isValid(e.onLoadMaterials)&&this.callbacks.setCallbackOnLoadMaterials(e.onLoadMaterials),this.meshBuilder._setCallbacks(this.callbacks)},onProgress:function(e,t,r){var n=LoaderSupport.Validator.isValid(t)?t:"",i={detail:{type:e,modelName:this.modelName,instanceNo:this.instanceNo,text:n,numericalValue:r}};LoaderSupport.Validator.isValid(this.callbacks.onProgress)&&this.callbacks.onProgress(i),this.logging.enabled&&this.logging.debug&&console.debug(n)},_onError:function(e){var t="Error occurred while downloading!";e.currentTarget&&null!==e.currentTarget.statusText&&(t+="\nurl: "+e.currentTarget.responseURL+"\nstatus: "+e.currentTarget.statusText),this.onProgress("error",t,-1),this._throwError(t)},_throwError:function(e){if(!LoaderSupport.Validator.isValid(this.callbacks.onReportError))throw e;this.callbacks.onReportError(e)},load:function(e,t,r,n,i,o){var a=new LoaderSupport.ResourceDescriptor(e,"OBJ");this._loadObj(a,t,r,n,i,o)},_loadObj:function(e,t,r,n,i,o){var a=this;LoaderSupport.Validator.isValid(n)||(n=function(e){a._onError(e)}),LoaderSupport.Validator.isValid(e)||n("An invalid ResourceDescriptor was provided. Unable to continue!");var s=function(r){if(e.content=r,o)a.parseAsync(r,t);else{var n=new LoaderSupport.Callbacks;n.setCallbackOnMeshAlter(i),a._setCallbacks(n),t({detail:{loaderRootNode:a.parse(r),modelName:a.modelName,instanceNo:a.instanceNo}})}};if(this.setPath(e.path),this.setResourcePath(e.resourcePath),!LoaderSupport.Validator.isValid(e.url)||LoaderSupport.Validator.isValid(e.content))s(LoaderSupport.Validator.isValid(e.content)?e.content:null);else{if(!LoaderSupport.Validator.isValid(r)){var l=0,u=0;r=function(t){if(t.lengthComputable&&(u=t.loaded/t.total)>l){l=u;var r='Download of "'+e.url+'": '+(100*u).toFixed(2)+"%";a.onProgress("progressLoad",r,u)}}}var c=new FileLoader(this.manager);c.setPath(this.path||this.resourcePath),c.setResponseType("arraybuffer"),c.load(e.name,s,r,n)}},run:function(e,t){this._applyPrepData(e);var r=e.checkResourceDescriptorFiles(e.resources,[{ext:"obj",type:"ArrayBuffer",ignore:!1},{ext:"mtl",type:"String",ignore:!1},{ext:"zip",type:"String",ignore:!0}]);LoaderSupport.Validator.isValid(t)&&(this.terminateWorkerOnLoad=!1,this.workerSupport=t,this.logging.enabled=this.workerSupport.logging.enabled,this.logging.debug=this.workerSupport.logging.debug);var n=this;this._loadMtl(r.mtl,function(t){null!==t&&n.meshBuilder.setMaterials(t),n._loadObj(r.obj,n.callbacks.onLoad,null,null,n.callbacks.onMeshAlter,e.useAsync)},null,null,e.crossOrigin,e.materialOptions)},_applyPrepData:function(e){LoaderSupport.Validator.isValid(e)&&(this.setLogging(e.logging.enabled,e.logging.debug),this.setModelName(e.modelName),this.setStreamMeshesTo(e.streamMeshesTo),this.meshBuilder.setMaterials(e.materials),this.setUseIndices(e.useIndices),this.setDisregardNormals(e.disregardNormals),this.setMaterialPerSmoothingGroup(e.materialPerSmoothingGroup),this.setUseOAsMesh(e.useOAsMesh),this._setCallbacks(e.getCallbacks()))},parse:function(e){if(!LoaderSupport.Validator.isValid(e))return console.warn("Provided content is not a valid ArrayBuffer or String."),this.loaderRootNode;this.logging.enabled&&console.time("OBJLoader2 parse: "+this.modelName),this.meshBuilder.init();var t=new OBJLoader2.Parser;t.setLogging(this.logging.enabled,this.logging.debug),t.setMaterialPerSmoothingGroup(this.materialPerSmoothingGroup),t.setUseOAsMesh(this.useOAsMesh),t.setUseIndices(this.useIndices),t.setDisregardNormals(this.disregardNormals),t.setMaterials(this.meshBuilder.getMaterials());var r=this;t.setCallbackMeshBuilder(function(e){var t,n=r.meshBuilder.processPayload(e);for(var i in n)t=n[i],r.loaderRootNode.add(t)});return t.setCallbackProgress(function(e,t){r.onProgress("progressParse",e,t)}),e instanceof ArrayBuffer||e instanceof Uint8Array?(this.logging.enabled&&console.info("Parsing arrayBuffer..."),t.parse(e)):"string"===typeof e||e instanceof String?(this.logging.enabled&&console.info("Parsing text..."),t.parseText(e)):this._throwError("Provided content was neither of type String nor Uint8Array! Aborting..."),this.logging.enabled&&console.timeEnd("OBJLoader2 parse: "+this.modelName),this.loaderRootNode},parseAsync:function(e,t){var r=this,n=!1,i=function(){t({detail:{loaderRootNode:r.loaderRootNode,modelName:r.modelName,instanceNo:r.instanceNo}}),n&&r.logging.enabled&&console.timeEnd("OBJLoader2 parseAsync: "+r.modelName)};LoaderSupport.Validator.isValid(e)?n=!0:(console.warn("Provided content is not a valid ArrayBuffer."),i()),n&&this.logging.enabled&&console.time("OBJLoader2 parseAsync: "+this.modelName),this.meshBuilder.init();this.workerSupport.validate(function(e){var t="";return t+="\n\n",t+="THREE = { LoaderSupport: {}, OBJLoader2: {} };\n\n",t+=e.serializeObject("LoaderSupport.Validator",LoaderSupport.Validator),t+=e.serializeClass("OBJLoader2.Parser",OBJLoader2.Parser)},"OBJLoader2.Parser"),this.workerSupport.setCallbacks(function(e){var t,n=r.meshBuilder.processPayload(e);for(var i in n)t=n[i],r.loaderRootNode.add(t)},i),r.terminateWorkerOnLoad&&this.workerSupport.setTerminateRequested(!0);var o={},a=this.meshBuilder.getMaterials();for(var s in a)o[s]=s;this.workerSupport.run({params:{useAsync:!0,materialPerSmoothingGroup:this.materialPerSmoothingGroup,useOAsMesh:this.useOAsMesh,useIndices:this.useIndices,disregardNormals:this.disregardNormals},logging:{enabled:this.logging.enabled,debug:this.logging.debug},materials:{materials:o},data:{input:e,options:null}})},loadMtl:function(e,t,r,n,i,o,a){var s=new LoaderSupport.ResourceDescriptor(e,"MTL");s.setContent(t),this._loadMtl(s,r,n,i,o,a)},_loadMtl:function(e,t,r,n,i,o){void 0===MTLLoader&&console.error('"MTLLoader" is not available. "OBJLoader2" requires it for loading MTL files.'),LoaderSupport.Validator.isValid(e)&&this.logging.enabled&&console.time("Loading MTL: "+e.name);var a=[],s=this,l=function(r){var n=[];if(LoaderSupport.Validator.isValid(r))for(var i in r.preload(),n=r.materials)n.hasOwnProperty(i)&&(a[i]=n[i]);LoaderSupport.Validator.isValid(e)&&s.logging.enabled&&console.timeEnd("Loading MTL: "+e.name),t(a,r)};if(LoaderSupport.Validator.isValid(e)&&(LoaderSupport.Validator.isValid(e.content)||LoaderSupport.Validator.isValid(e.url))){var u=new MTLLoader(this.manager);i=LoaderSupport.Validator.verifyInput(i,"anonymous"),u.setCrossOrigin(i),u.setResourcePath(e.resourcePath||e.path),LoaderSupport.Validator.isValid(o)&&u.setMaterialOptions(o);var c=function(e){var t=e;"string"===typeof e||e instanceof String||(e.length>0||e.byteLength>0?t=LoaderUtils.decodeText(e):this._throwError("Unable to parse mtl as it it seems to be neither a String, an Array or an ArrayBuffer!")),l(u.parse(t))};if(LoaderSupport.Validator.isValid(e.content))c(e.content);else if(LoaderSupport.Validator.isValid(e.url)){var h=new FileLoader(this.manager);if(LoaderSupport.Validator.isValid(n)||(n=function(e){s._onError(e)}),!LoaderSupport.Validator.isValid(r)){var p=0,f=0;r=function(t){if(t.lengthComputable&&(f=t.loaded/t.total)>p){p=f;var r='Download of "'+e.url+'": '+(100*f).toFixed(2)+"%";s.onProgress("progressLoad",r,f)}}}h.load(e.url,c,r,n)}}else l()}},OBJLoader2.Parser=function(){this.callbackProgress=null,this.callbackMeshBuilder=null,this.contentRef=null,this.legacyMode=!1,this.materials={},this.useAsync=!1,this.materialPerSmoothingGroup=!1,this.useOAsMesh=!1,this.useIndices=!1,this.disregardNormals=!1,this.vertices=[],this.colors=[],this.normals=[],this.uvs=[],this.rawMesh={objectName:"",groupName:"",activeMtlName:"",mtllibName:"",faceType:-1,subGroups:[],subGroupInUse:null,smoothingGroup:{splitMaterials:!1,normalized:-1,real:-1},counts:{doubleIndicesCount:0,faceCount:0,mtlCount:0,smoothingGroupCount:0}},this.inputObjectCount=1,this.outputObjectCount=1,this.globalCounts={vertices:0,faces:0,doubleIndicesCount:0,lineByte:0,currentByte:0,totalBytes:0},this.logging={enabled:!0,debug:!1}},OBJLoader2.Parser.prototype={constructor:OBJLoader2.Parser,resetRawMesh:function(){this.rawMesh.subGroups=[],this.rawMesh.subGroupInUse=null,this.rawMesh.smoothingGroup.normalized=-1,this.rawMesh.smoothingGroup.real=-1,this.pushSmoothingGroup(1),this.rawMesh.counts.doubleIndicesCount=0,this.rawMesh.counts.faceCount=0,this.rawMesh.counts.mtlCount=0,this.rawMesh.counts.smoothingGroupCount=0},setUseAsync:function(e){this.useAsync=e},setMaterialPerSmoothingGroup:function(e){this.materialPerSmoothingGroup=e},setUseOAsMesh:function(e){this.useOAsMesh=e},setUseIndices:function(e){this.useIndices=e},setDisregardNormals:function(e){this.disregardNormals=e},setMaterials:function(e){this.materials=LoaderSupport.Validator.verifyInput(e,this.materials),this.materials=LoaderSupport.Validator.verifyInput(this.materials,{})},setCallbackMeshBuilder:function(e){LoaderSupport.Validator.isValid(e)||this._throwError('Unable to run as no "MeshBuilder" callback is set.'),this.callbackMeshBuilder=e},setCallbackProgress:function(e){this.callbackProgress=e},setLogging:function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t},configure:function(){if(this.pushSmoothingGroup(1),this.logging.enabled){var e=Object.keys(this.materials),t="OBJLoader2.Parser configuration:"+(e.length>0?"\n\tmaterialNames:\n\t\t- "+e.join("\n\t\t- "):"\n\tmaterialNames: None")+"\n\tuseAsync: "+this.useAsync+"\n\tmaterialPerSmoothingGroup: "+this.materialPerSmoothingGroup+"\n\tuseOAsMesh: "+this.useOAsMesh+"\n\tuseIndices: "+this.useIndices+"\n\tdisregardNormals: "+this.disregardNormals+"\n\tcallbackMeshBuilderName: "+this.callbackMeshBuilder.name+"\n\tcallbackProgressName: "+this.callbackProgress.name;console.info(t)}},parse:function(e){this.logging.enabled&&console.time("OBJLoader2.Parser.parse"),this.configure();var t=new Uint8Array(e);this.contentRef=t;var r=t.byteLength;this.globalCounts.totalBytes=r;for(var n,i=new Array(128),o="",a=0,s=0,l=0;l<r;l++)switch(n=t[l]){case 32:o.length>0&&(i[a++]=o),o="";break;case 47:o.length>0&&(i[a++]=o),s++,o="";break;case 10:o.length>0&&(i[a++]=o),o="",this.globalCounts.lineByte=this.globalCounts.currentByte,this.globalCounts.currentByte=l,this.processLine(i,a,s),a=0,s=0;break;case 13:break;default:o+=String.fromCharCode(n)}this.finalizeParsing(),this.logging.enabled&&console.timeEnd("OBJLoader2.Parser.parse")},parseText:function(e){this.logging.enabled&&console.time("OBJLoader2.Parser.parseText"),this.configure(),this.legacyMode=!0,this.contentRef=e;var t=e.length;this.globalCounts.totalBytes=t;for(var r,n=new Array(128),i="",o=0,a=0,s=0;s<t;s++)switch(r=e[s]){case" ":i.length>0&&(n[o++]=i),i="";break;case"/":i.length>0&&(n[o++]=i),a++,i="";break;case"\n":i.length>0&&(n[o++]=i),i="",this.globalCounts.lineByte=this.globalCounts.currentByte,this.globalCounts.currentByte=s,this.processLine(n,o,a),o=0,a=0;break;case"\r":break;default:i+=r}this.finalizeParsing(),this.logging.enabled&&console.timeEnd("OBJLoader2.Parser.parseText")},processLine:function(e,t,r){if(!(t<1)){var n,i,o,a,s=function(e,t,r,n){var i="";if(n>r){var o;if(t)for(o=r;o<n;o++)i+=e[o];else for(o=r;o<n;o++)i+=String.fromCharCode(e[o]);i=i.trim()}return i};switch(a=e[0]){case"v":this.vertices.push(parseFloat(e[1])),this.vertices.push(parseFloat(e[2])),this.vertices.push(parseFloat(e[3])),t>4&&(this.colors.push(parseFloat(e[4])),this.colors.push(parseFloat(e[5])),this.colors.push(parseFloat(e[6])));break;case"vt":this.uvs.push(parseFloat(e[1])),this.uvs.push(parseFloat(e[2]));break;case"vn":this.normals.push(parseFloat(e[1])),this.normals.push(parseFloat(e[2])),this.normals.push(parseFloat(e[3]));break;case"f":if(n=t-1,0===r)for(this.checkFaceType(0),o=2,i=n;o<i;o++)this.buildFace(e[1]),this.buildFace(e[o]),this.buildFace(e[o+1]);else if(n===2*r)for(this.checkFaceType(1),o=3,i=n-2;o<i;o+=2)this.buildFace(e[1],e[2]),this.buildFace(e[o],e[o+1]),this.buildFace(e[o+2],e[o+3]);else if(2*n===3*r)for(this.checkFaceType(2),o=4,i=n-3;o<i;o+=3)this.buildFace(e[1],e[2],e[3]),this.buildFace(e[o],e[o+1],e[o+2]),this.buildFace(e[o+3],e[o+4],e[o+5]);else for(this.checkFaceType(3),o=3,i=n-2;o<i;o+=2)this.buildFace(e[1],void 0,e[2]),this.buildFace(e[o],void 0,e[o+1]),this.buildFace(e[o+2],void 0,e[o+3]);break;case"l":case"p":if((n=t-1)===2*r)for(this.checkFaceType(4),o=1,i=n+1;o<i;o+=2)this.buildFace(e[o],e[o+1]);else for(this.checkFaceType("l"===a?5:6),o=1,i=n+1;o<i;o++)this.buildFace(e[o]);break;case"s":this.pushSmoothingGroup(e[1]);break;case"g":this.processCompletedMesh(),this.rawMesh.groupName=s(this.contentRef,this.legacyMode,this.globalCounts.lineByte+2,this.globalCounts.currentByte);break;case"o":this.useOAsMesh&&this.processCompletedMesh(),this.rawMesh.objectName=s(this.contentRef,this.legacyMode,this.globalCounts.lineByte+2,this.globalCounts.currentByte);break;case"mtllib":this.rawMesh.mtllibName=s(this.contentRef,this.legacyMode,this.globalCounts.lineByte+7,this.globalCounts.currentByte);break;case"usemtl":var l=s(this.contentRef,this.legacyMode,this.globalCounts.lineByte+7,this.globalCounts.currentByte);""!==l&&this.rawMesh.activeMtlName!==l&&(this.rawMesh.activeMtlName=l,this.rawMesh.counts.mtlCount++,this.checkSubGroup())}}},pushSmoothingGroup:function(e){var t=parseInt(e);isNaN(t)&&(t="off"===e?0:1);var r=this.rawMesh.smoothingGroup.normalized;this.rawMesh.smoothingGroup.normalized=this.rawMesh.smoothingGroup.splitMaterials?t:0===t?0:1,this.rawMesh.smoothingGroup.real=t,r!==t&&(this.rawMesh.counts.smoothingGroupCount++,this.checkSubGroup())},checkFaceType:function(e){this.rawMesh.faceType!==e&&(this.processCompletedMesh(),this.rawMesh.faceType=e,this.checkSubGroup())},checkSubGroup:function(){var e=this.rawMesh.activeMtlName+"|"+this.rawMesh.smoothingGroup.normalized;this.rawMesh.subGroupInUse=this.rawMesh.subGroups[e],LoaderSupport.Validator.isValid(this.rawMesh.subGroupInUse)||(this.rawMesh.subGroupInUse={index:e,objectName:this.rawMesh.objectName,groupName:this.rawMesh.groupName,materialName:this.rawMesh.activeMtlName,smoothingGroup:this.rawMesh.smoothingGroup.normalized,vertices:[],indexMappingsCount:0,indexMappings:[],indices:[],colors:[],uvs:[],normals:[]},this.rawMesh.subGroups[e]=this.rawMesh.subGroupInUse)},buildFace:function(e,t,r){this.disregardNormals&&(r=void 0);var n=this,i=function(){var i=parseInt(e),o=3*(i>0?i-1:i+n.vertices.length/3),a=n.colors.length>0?o:null,s=n.rawMesh.subGroupInUse.vertices;if(s.push(n.vertices[o++]),s.push(n.vertices[o++]),s.push(n.vertices[o]),null!==a){var l=n.rawMesh.subGroupInUse.colors;l.push(n.colors[a++]),l.push(n.colors[a++]),l.push(n.colors[a])}if(t){var u=parseInt(t),c=2*(u>0?u-1:u+n.uvs.length/2),h=n.rawMesh.subGroupInUse.uvs;h.push(n.uvs[c++]),h.push(n.uvs[c])}if(r){var p=parseInt(r),f=3*(p>0?p-1:p+n.normals.length/3),d=n.rawMesh.subGroupInUse.normals;d.push(n.normals[f++]),d.push(n.normals[f++]),d.push(n.normals[f])}};if(this.useIndices){var o=e+(t?"_"+t:"_n")+(r?"_"+r:"_n"),a=this.rawMesh.subGroupInUse.indexMappings[o];LoaderSupport.Validator.isValid(a)?this.rawMesh.counts.doubleIndicesCount++:(a=this.rawMesh.subGroupInUse.vertices.length/3,i(),this.rawMesh.subGroupInUse.indexMappings[o]=a,this.rawMesh.subGroupInUse.indexMappingsCount++),this.rawMesh.subGroupInUse.indices.push(a)}else i();this.rawMesh.counts.faceCount++},createRawMeshReport:function(e){return"Input Object number: "+e+"\n\tObject name: "+this.rawMesh.objectName+"\n\tGroup name: "+this.rawMesh.groupName+"\n\tMtllib name: "+this.rawMesh.mtllibName+"\n\tVertex count: "+this.vertices.length/3+"\n\tNormal count: "+this.normals.length/3+"\n\tUV count: "+this.uvs.length/2+"\n\tSmoothingGroup count: "+this.rawMesh.counts.smoothingGroupCount+"\n\tMaterial count: "+this.rawMesh.counts.mtlCount+"\n\tReal MeshOutputGroup count: "+this.rawMesh.subGroups.length},finalizeRawMesh:function(){var e,t,r=[],n=0,i=0,o=0,a=0,s=0,l=0;for(var u in this.rawMesh.subGroups)if((e=this.rawMesh.subGroups[u]).vertices.length>0){if((t=e.indices).length>0&&i>0)for(var c in t)t[c]=t[c]+i;r.push(e),n+=e.vertices.length,i+=e.indexMappingsCount,o+=e.indices.length,a+=e.colors.length,l+=e.uvs.length,s+=e.normals.length}var h=null;return r.length>0&&(h={name:""!==this.rawMesh.groupName?this.rawMesh.groupName:this.rawMesh.objectName,subGroups:r,absoluteVertexCount:n,absoluteIndexCount:o,absoluteColorCount:a,absoluteNormalCount:s,absoluteUvCount:l,faceCount:this.rawMesh.counts.faceCount,doubleIndicesCount:this.rawMesh.counts.doubleIndicesCount}),h},processCompletedMesh:function(){var e=this.finalizeRawMesh();if(LoaderSupport.Validator.isValid(e)){this.colors.length>0&&this.colors.length!==this.vertices.length&&this._throwError("Vertex Colors were detected, but vertex count and color count do not match!"),this.logging.enabled&&this.logging.debug&&console.debug(this.createRawMeshReport(this.inputObjectCount)),this.inputObjectCount++,this.buildMesh(e);var t=this.globalCounts.currentByte/this.globalCounts.totalBytes;return this.callbackProgress("Completed [o: "+this.rawMesh.objectName+" g:"+this.rawMesh.groupName+"] Total progress: "+(100*t).toFixed(2)+"%",t),this.resetRawMesh(),!0}return!1},buildMesh:function(e){var t=e.subGroups,r=new Float32Array(e.absoluteVertexCount);this.globalCounts.vertices+=e.absoluteVertexCount/3,this.globalCounts.faces+=e.faceCount,this.globalCounts.doubleIndicesCount+=e.doubleIndicesCount;var n,i,o,a,s,l,u,c=e.absoluteIndexCount>0?new Uint32Array(e.absoluteIndexCount):null,h=e.absoluteColorCount>0?new Float32Array(e.absoluteColorCount):null,p=e.absoluteNormalCount>0?new Float32Array(e.absoluteNormalCount):null,f=e.absoluteUvCount>0?new Float32Array(e.absoluteUvCount):null,d=LoaderSupport.Validator.isValid(h),m=[],v=t.length>1,g=0,y=[],b=[],x=0,w=0,S=0,M=0,_=0,T=0,A=0;for(var C in t)if(t.hasOwnProperty(C)){if(u=(n=t[C]).materialName,l=this.rawMesh.faceType<4?u+(d?"_vertexColor":"")+(0===n.smoothingGroup?"_flat":""):6===this.rawMesh.faceType?"defaultPointMaterial":"defaultLineMaterial",a=this.materials[u],s=this.materials[l],!LoaderSupport.Validator.isValid(a)&&!LoaderSupport.Validator.isValid(s)){var E=d?"defaultVertexColorMaterial":"defaultMaterial";a=this.materials[E],this.logging.enabled&&console.warn('object_group "'+n.objectName+"_"+n.groupName+'" was defined with unresolvable material "'+u+'"! Assigning "'+E+'".'),(u=E)===l&&(s=a,l=E)}if(!LoaderSupport.Validator.isValid(s)){var L={materialNameOrg:u,materialName:l,materialProperties:{vertexColors:d?2:0,flatShading:0===n.smoothingGroup}},N={cmd:"materialData",materials:{materialCloneInstructions:L}};this.callbackMeshBuilder(N),this.useAsync&&(this.materials[l]=L)}if(v?((i=y[l])||(i=g,y[l]=g,m.push(l),g++),o={start:T,count:A=this.useIndices?n.indices.length:n.vertices.length/3,index:i},b.push(o),T+=A):m.push(l),r.set(n.vertices,x),x+=n.vertices.length,c&&(c.set(n.indices,w),w+=n.indices.length),h&&(h.set(n.colors,S),S+=n.colors.length),p&&(p.set(n.normals,M),M+=n.normals.length),f&&(f.set(n.uvs,_),_+=n.uvs.length),this.logging.enabled&&this.logging.debug){var P=LoaderSupport.Validator.isValid(i)?"\n\t\tmaterialIndex: "+i:"",O="\tOutput Object no.: "+this.outputObjectCount+"\n\t\tgroupName: "+n.groupName+"\n\t\tIndex: "+n.index+"\n\t\tfaceType: "+this.rawMesh.faceType+"\n\t\tmaterialName: "+n.materialName+"\n\t\tsmoothingGroup: "+n.smoothingGroup+P+"\n\t\tobjectName: "+n.objectName+"\n\t\t#vertices: "+n.vertices.length/3+"\n\t\t#indices: "+n.indices.length+"\n\t\t#colors: "+n.colors.length/3+"\n\t\t#uvs: "+n.uvs.length/2+"\n\t\t#normals: "+n.normals.length/3;console.debug(O)}}this.outputObjectCount++,this.callbackMeshBuilder({cmd:"meshData",progress:{numericalValue:this.globalCounts.currentByte/this.globalCounts.totalBytes},params:{meshName:e.name},materials:{multiMaterial:v,materialNames:m,materialGroups:b},buffers:{vertices:r,indices:c,colors:h,normals:p,uvs:f},geometryType:this.rawMesh.faceType<4?0:6===this.rawMesh.faceType?2:1},[r.buffer],LoaderSupport.Validator.isValid(c)?[c.buffer]:null,LoaderSupport.Validator.isValid(h)?[h.buffer]:null,LoaderSupport.Validator.isValid(p)?[p.buffer]:null,LoaderSupport.Validator.isValid(f)?[f.buffer]:null)},finalizeParsing:function(){if(this.logging.enabled&&console.info("Global output object count: "+this.outputObjectCount),this.processCompletedMesh()&&this.logging.enabled){var e="Overall counts: \n\tVertices: "+this.globalCounts.vertices+"\n\tFaces: "+this.globalCounts.faces+"\n\tMultiple definitions: "+this.globalCounts.doubleIndicesCount;console.info(e)}}};var PCDLoader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager,this.littleEndian=!0};PCDLoader.prototype={constructor:PCDLoader,load:function(e,t,r,n){var i=this,o=new FileLoader(i.manager);o.setPath(i.path),o.setResponseType("arraybuffer"),o.load(e,function(r){try{t(i.parse(r,e))}catch(o){if(!n)throw o;n(o)}},r,n)},setPath:function(e){return this.path=e,this},parse:function(e,t){var r=LoaderUtils.decodeText(e),n=function(e){var t={},r=e.search(/[\r\n]DATA\s(\S*)\s/i),n=/[\r\n]DATA\s(\S*)\s/i.exec(e.substr(r-1));if(t.data=n[1],t.headerLen=n[0].length+r,t.str=e.substr(0,t.headerLen),t.str=t.str.replace(/\#.*/gi,""),t.version=/VERSION (.*)/i.exec(t.str),t.fields=/FIELDS (.*)/i.exec(t.str),t.size=/SIZE (.*)/i.exec(t.str),t.type=/TYPE (.*)/i.exec(t.str),t.count=/COUNT (.*)/i.exec(t.str),t.width=/WIDTH (.*)/i.exec(t.str),t.height=/HEIGHT (.*)/i.exec(t.str),t.viewpoint=/VIEWPOINT (.*)/i.exec(t.str),t.points=/POINTS (.*)/i.exec(t.str),null!==t.version&&(t.version=parseFloat(t.version[1])),null!==t.fields&&(t.fields=t.fields[1].split(" ")),null!==t.type&&(t.type=t.type[1].split(" ")),null!==t.width&&(t.width=parseInt(t.width[1])),null!==t.height&&(t.height=parseInt(t.height[1])),null!==t.viewpoint&&(t.viewpoint=t.viewpoint[1]),null!==t.points&&(t.points=parseInt(t.points[1],10)),null===t.points&&(t.points=t.width*t.height),null!==t.size&&(t.size=t.size[1].split(" ").map(function(e){return parseInt(e,10)})),null!==t.count)t.count=t.count[1].split(" ").map(function(e){return parseInt(e,10)});else{t.count=[];for(var i=0,o=t.fields.length;i<o;i++)t.count.push(1)}t.offset={};var a=0;for(i=0,o=t.fields.length;i<o;i++)"ascii"===t.data?t.offset[t.fields[i]]=i:(t.offset[t.fields[i]]=a,a+=t.size[i]);return t.rowSize=a,t}(r),i=[],o=[],a=[];if("ascii"===n.data)for(var s=n.offset,l=r.substr(n.headerLen).split("\n"),u=0,c=l.length;u<c;u++)if(""!==l[u]){var h=l[u].split(" ");if(void 0!==s.x&&(i.push(parseFloat(h[s.x])),i.push(parseFloat(h[s.y])),i.push(parseFloat(h[s.z]))),void 0!==s.rgb){var p=parseFloat(h[s.rgb]),f=p>>16&255,d=p>>8&255,m=p>>0&255;a.push(f/255,d/255,m/255)}void 0!==s.normal_x&&(o.push(parseFloat(h[s.normal_x])),o.push(parseFloat(h[s.normal_y])),o.push(parseFloat(h[s.normal_z])))}if("binary_compressed"!==n.data){if("binary"===n.data)for(var v=new DataView(e,n.headerLen),g=(s=n.offset,u=0,0);u<n.points;u++,g+=n.rowSize)void 0!==s.x&&(i.push(v.getFloat32(g+s.x,this.littleEndian)),i.push(v.getFloat32(g+s.y,this.littleEndian)),i.push(v.getFloat32(g+s.z,this.littleEndian))),void 0!==s.rgb&&(a.push(v.getUint8(g+s.rgb+2)/255),a.push(v.getUint8(g+s.rgb+1)/255),a.push(v.getUint8(g+s.rgb+0)/255)),void 0!==s.normal_x&&(o.push(v.getFloat32(g+s.normal_x,this.littleEndian)),o.push(v.getFloat32(g+s.normal_y,this.littleEndian)),o.push(v.getFloat32(g+s.normal_z,this.littleEndian)));var y=new BufferGeometry;i.length>0&&y.addAttribute("position",new Float32BufferAttribute(i,3)),o.length>0&&y.addAttribute("normal",new Float32BufferAttribute(o,3)),a.length>0&&y.addAttribute("color",new Float32BufferAttribute(a,3)),y.computeBoundingSphere();var b=new PointsMaterial({size:.005});a.length>0?b.vertexColors=VertexColors:b.color.setHex(16777215*Math.random());var x=new Points(y,b),w=t.split("").reverse().join("");return w=(w=/([^\/]*)/.exec(w))[1].split("").reverse().join(""),x.name=w,x}console.error("PCDLoader: binary_compressed files are not supported")}};var PDBLoader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager};PDBLoader.prototype={constructor:PDBLoader,load:function(e,t,r,n){var i=this,o=new FileLoader(i.manager);o.setPath(i.path),o.load(e,function(e){t(i.parse(e))},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){function t(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function r(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}function n(e,t){var r,n,i=parseInt(f[d].substr(e,t));if(i){var o=(r=v,n=i,"s"+Math.min(r,n)+"e"+Math.max(r,n));void 0===p[o]&&(h.push([v-1,i-1,1]),p[o]=h.length-1)}}for(var i,o,a,s,l,u={h:[255,255,255],he:[217,255,255],li:[204,128,255],be:[194,255,0],b:[255,181,181],c:[144,144,144],n:[48,80,248],o:[255,13,13],f:[144,224,80],ne:[179,227,245],na:[171,92,242],mg:[138,255,0],al:[191,166,166],si:[240,200,160],p:[255,128,0],s:[255,255,48],cl:[31,240,31],ar:[128,209,227],k:[143,64,212],ca:[61,255,0],sc:[230,230,230],ti:[191,194,199],v:[166,166,171],cr:[138,153,199],mn:[156,122,199],fe:[224,102,51],co:[240,144,160],ni:[80,208,80],cu:[200,128,51],zn:[125,128,176],ga:[194,143,143],ge:[102,143,143],as:[189,128,227],se:[255,161,0],br:[166,41,41],kr:[92,184,209],rb:[112,46,176],sr:[0,255,0],y:[148,255,255],zr:[148,224,224],nb:[115,194,201],mo:[84,181,181],tc:[59,158,158],ru:[36,143,143],rh:[10,125,140],pd:[0,105,133],ag:[192,192,192],cd:[255,217,143],in:[166,117,115],sn:[102,128,128],sb:[158,99,181],te:[212,122,0],i:[148,0,148],xe:[66,158,176],cs:[87,23,143],ba:[0,201,0],la:[112,212,255],ce:[255,255,199],pr:[217,255,199],nd:[199,255,199],pm:[163,255,199],sm:[143,255,199],eu:[97,255,199],gd:[69,255,199],tb:[48,255,199],dy:[31,255,199],ho:[0,255,156],er:[0,230,117],tm:[0,212,82],yb:[0,191,56],lu:[0,171,36],hf:[77,194,255],ta:[77,166,255],w:[33,148,214],re:[38,125,171],os:[38,102,150],ir:[23,84,135],pt:[208,208,224],au:[255,209,35],hg:[184,184,208],tl:[166,84,77],pb:[87,89,97],bi:[158,79,181],po:[171,92,0],at:[117,79,69],rn:[66,130,150],fr:[66,0,102],ra:[0,125,0],ac:[112,171,250],th:[0,186,255],pa:[0,161,255],u:[0,143,255],np:[0,128,255],pu:[0,107,255],am:[84,92,242],cm:[120,92,227],bk:[138,79,227],cf:[161,54,212],es:[179,31,212],fm:[179,31,186],md:[179,13,166],no:[189,13,135],lr:[199,0,102],rf:[204,0,89],db:[209,0,79],sg:[217,0,69],bh:[224,0,56],hs:[230,0,46],mt:[235,0,38],ds:[235,0,38],rg:[235,0,38],cn:[235,0,38],uut:[235,0,38],uuq:[235,0,38],uup:[235,0,38],uuh:[235,0,38],uus:[235,0,38],uuo:[235,0,38]},c=[],h=[],p={},f=e.split("\n"),d=0,m=f.length;d<m;d++)if("ATOM"===f[d].substr(0,4)||"HETATM"===f[d].substr(0,6))i=parseFloat(f[d].substr(30,7)),o=parseFloat(f[d].substr(38,7)),a=parseFloat(f[d].substr(46,7)),s=parseInt(f[d].substr(6,5))-1,""===(l=t(f[d].substr(76,2)).toLowerCase())&&(l=t(f[d].substr(12,2)).toLowerCase()),c[s]=[i,o,a,u[l],r(l)];else if("CONECT"===f[d].substr(0,6)){var v=parseInt(f[d].substr(6,5));n(11,5),n(16,5),n(21,5),n(26,5)}return function(){var e,t,r={geometryAtoms:new BufferGeometry,geometryBonds:new BufferGeometry,json:{atoms:c,bonds:h}},n=r.geometryAtoms,i=r.geometryBonds,o=[],a=[],s=[];for(e=0,t=c.length;e<t;e++){var l=c[e],u=l[0],p=l[1],f=l[2];o.push(u,p,f);var d=l[3][0]/255,m=l[3][1]/255,v=l[3][2]/255;a.push(d,m,v)}for(e=0,t=h.length;e<t;e++){var g=h[e],y=g[0],b=g[1];s.push(o[3*y+0]),s.push(o[3*y+1]),s.push(o[3*y+2]),s.push(o[3*b+0]),s.push(o[3*b+1]),s.push(o[3*b+2])}return n.addAttribute("position",new Float32BufferAttribute(o,3)),n.addAttribute("color",new Float32BufferAttribute(a,3)),i.addAttribute("position",new Float32BufferAttribute(s,3)),r}()}};var PlayCanvasLoader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager};PlayCanvasLoader.prototype={constructor:PlayCanvasLoader,load:function(e,t,r,n){var i=this,o=new FileLoader(i.manager);o.setPath(i.path),o.load(e,function(e){t(i.parse(JSON.parse(e)))},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){function t(e){var t={};for(var r in e){var n,i=e[r],o=i.type,a=i.components;switch(o){case"float32":n=new Float32BufferAttribute(i.data,a);break;case"uint8":n=new Uint8BufferAttribute(i.data,a);break;case"uint16":n=new Uint16BufferAttribute(i.data,a);break;default:console.log('PlayCanvasLoader: Array type "%s" not yet supported.',o)}t[r]=n}e._attributes=t}function r(e){var t=new BufferGeometry;t.setIndex(e.indices);var r=o.vertices[e.vertices]._attributes;for(var n in r){var i=r[n];"texCoord0"===n&&(n="uv"),t.addAttribute(n,i)}e._geometry=t}function n(e){var t=o.nodes[e.node],r=o.meshes[e.mesh];void 0===t._geometries&&(t._geometries=[]),t._geometries.push(r._geometry)}function i(e){var t=new Group,r=e._geometries;if(void 0!==r)for(var n=new MeshPhongMaterial,i=0,o=r.length;i<o;i++){var a=r[i];t.add(new Mesh(a,n))}for(i=0,o=e.rotation.length;i<o;i++)e.rotation[i]*=Math.PI/180;t.name=e.name,t.position.fromArray(e.position),t.quaternion.setFromEuler((new Euler).fromArray(e.rotation)),t.scale.fromArray(e.scale),e._object=t}for(var o=e.model,a=0,s=o.vertices.length;a<s;a++)t(o.vertices[a]);for(a=0,s=o.meshes.length;a<s;a++)r(o.meshes[a]);for(a=0,s=o.meshInstances.length;a<s;a++)n(o.meshInstances[a]);for(a=0,s=o.nodes.length;a<s;a++)i(o.nodes[a]);for(a=0,s=o.parents.length;a<s;a++){var l=o.parents[a];-1!==l&&o.nodes[l]._object.add(o.nodes[a]._object)}return o.nodes[0]._object}};var PLYLoader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager,this.propertyNameMapping={}};PLYLoader.prototype={constructor:PLYLoader,load:function(e,t,r,n){var i=this,o=new FileLoader(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,n)},setPath:function(e){return this.path=e,this},setPropertyNameMapping:function(e){this.propertyNameMapping=e},parse:function(e){function t(e){var t="",r=0,n=/ply([\s\S]*)end_header\r?\n/.exec(e);null!==n&&(t=n[1],r=n[0].length);var i,o,a,s={comments:[],elements:[],headerLength:r},l=t.split("\n");function u(e,t){var r={type:e[0]};return"list"===r.type?(r.name=e[3],r.countType=e[1],r.itemType=e[2]):r.name=e[1],r.name in t&&(r.name=t[r.name]),r}for(var h=0;h<l.length;h++){var p=l[h];if(""!==(p=p.trim()))switch(o=(a=p.split(/\s+/)).shift(),p=a.join(" "),o){case"format":s.format=a[0],s.version=a[1];break;case"comment":s.comments.push(p);break;case"element":void 0!==i&&s.elements.push(i),(i={}).name=a[0],i.count=parseInt(a[1]),i.properties=[];break;case"property":i.properties.push(u(a,c.propertyNameMapping));break;default:console.log("unhandled",o,a)}}return void 0!==i&&s.elements.push(i),s}function r(e,t){switch(t){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(e);case"float":case"double":case"float32":case"float64":return parseFloat(e)}}function n(e,t){for(var n=t.split(/\s+/),i={},o=0;o<e.length;o++)if("list"===e[o].type){for(var a=[],s=r(n.shift(),e[o].countType),l=0;l<s;l++)a.push(r(n.shift(),e[o].itemType));i[e[o].name]=a}else i[e[o].name]=r(n.shift(),e[o].type);return i}function i(e,t){var r,i={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},s="";null!==(r=/end_header\s([\s\S]*)$/.exec(e))&&(s=r[1]);for(var l=s.split("\n"),u=0,c=0,h=0;h<l.length;h++){var p=l[h];if(""!==(p=p.trim())){c>=t.elements[u].count&&(u++,c=0);var f=n(t.elements[u].properties,p);a(i,t.elements[u].name,f),c++}}return o(i)}function o(e){var t=new BufferGeometry;return e.indices.length>0&&t.setIndex(e.indices),t.addAttribute("position",new Float32BufferAttribute(e.vertices,3)),e.normals.length>0&&t.addAttribute("normal",new Float32BufferAttribute(e.normals,3)),e.uvs.length>0&&t.addAttribute("uv",new Float32BufferAttribute(e.uvs,2)),e.colors.length>0&&t.addAttribute("color",new Float32BufferAttribute(e.colors,3)),e.faceVertexUvs.length>0&&(t=t.toNonIndexed()).addAttribute("uv",new Float32BufferAttribute(e.faceVertexUvs,2)),t.computeBoundingSphere(),t}function a(e,t,r){if("vertex"===t)e.vertices.push(r.x,r.y,r.z),"nx"in r&&"ny"in r&&"nz"in r&&e.normals.push(r.nx,r.ny,r.nz),"s"in r&&"t"in r&&e.uvs.push(r.s,r.t),"red"in r&&"green"in r&&"blue"in r&&e.colors.push(r.red/255,r.green/255,r.blue/255);else if("face"===t){var n=r.vertex_indices||r.vertex_index,i=r.texcoord;3===n.length?(e.indices.push(n[0],n[1],n[2]),i&&6===i.length&&(e.faceVertexUvs.push(i[0],i[1]),e.faceVertexUvs.push(i[2],i[3]),e.faceVertexUvs.push(i[4],i[5]))):4===n.length&&(e.indices.push(n[0],n[1],n[3]),e.indices.push(n[1],n[2],n[3]))}}function s(e,t,r,n){switch(r){case"int8":case"char":return[e.getInt8(t),1];case"uint8":case"uchar":return[e.getUint8(t),1];case"int16":case"short":return[e.getInt16(t,n),2];case"uint16":case"ushort":return[e.getUint16(t,n),2];case"int32":case"int":return[e.getInt32(t,n),4];case"uint32":case"uint":return[e.getUint32(t,n),4];case"float32":case"float":return[e.getFloat32(t,n),4];case"float64":case"double":return[e.getFloat64(t,n),8]}}function l(e,t,r,n){for(var i,o={},a=0,l=0;l<r.length;l++)if("list"===r[l].type){var u=[],c=(i=s(e,t+a,r[l].countType,n))[0];a+=i[1];for(var h=0;h<c;h++)i=s(e,t+a,r[l].itemType,n),u.push(i[0]),a+=i[1];o[r[l].name]=u}else i=s(e,t+a,r[l].type,n),o[r[l].name]=i[0],a+=i[1];return[o,a]}var u,c=this;if(e instanceof ArrayBuffer){var h=LoaderUtils.decodeText(new Uint8Array(e)),p=t(h);u="ascii"===p.format?i(h,p):function(e,t){for(var r,n={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},i="binary_little_endian"===t.format,s=new DataView(e,t.headerLength),u=0,c=0;c<t.elements.length;c++)for(var h=0;h<t.elements[c].count;h++){u+=(r=l(s,u,t.elements[c].properties,i))[1];var p=r[0];a(n,t.elements[c].name,p)}return o(n)}(e,p)}else u=i(e,t(e));return u}};var bigEndianPlatform=null;function isBigEndianPlatform(){if(null===bigEndianPlatform){var e=new ArrayBuffer(2),t=new Uint8Array(e),r=new Uint16Array(e);t[0]=170,t[1]=187,bigEndianPlatform=43707===r[0]}return bigEndianPlatform}var InvertedEncodingTypes=[null,Float32Array,null,Int8Array,Int16Array,null,Int32Array,Uint8Array,Uint16Array,null,Uint32Array],getMethods={Uint16Array:"getUint16",Uint32Array:"getUint32",Int16Array:"getInt16",Int32Array:"getInt32",Float32Array:"getFloat32",Float64Array:"getFloat64"};function copyFromBuffer(e,t,r,n,i){var o,a=t.BYTES_PER_ELEMENT;if(i===isBigEndianPlatform()||1===a)o=new t(e,r,n);else{var s=new DataView(e,r,n*a),l=getMethods[t.name],u=!i,c=0;for(o=new t(n);c<n;c++)o[c]=s[l](c*a,u)}return o}function decodePrwm(e){var t=new Uint8Array(e),r=t[0],n=t[1],i=!!(n>>7&1),o=n>>6&1,a=1===(n>>5&1),s=31&n,l=0,u=0;if(a?(l=(t[2]<<16)+(t[3]<<8)+t[4],u=(t[5]<<16)+(t[6]<<8)+t[7]):(l=t[2]+(t[3]<<8)+(t[4]<<16),u=t[5]+(t[6]<<8)+(t[7]<<16)),0===r)throw new Error("PRWM decoder: Invalid format version: 0");if(1!==r)throw new Error("PRWM decoder: Unsupported format version: "+r);if(!i){if(0!==o)throw new Error("PRWM decoder: Indices type must be set to 0 for non-indexed geometries");if(0!==u)throw new Error("PRWM decoder: Number of indices must be set to 0 for non-indexed geometries")}var c,h,p,f,d,m,v,g,y=8,b={};for(g=0;g<s;g++){for(c="";y<t.length&&(h=t[y],y++,0!==h);)c+=String.fromCharCode(h);p=(n=t[y])>>7&1,f=1+(n>>4&3),y++,m=copyFromBuffer(e,d=InvertedEncodingTypes[15&n],y=4*Math.ceil(y/4),f*l,a),y+=d.BYTES_PER_ELEMENT*f*l,b[c]={type:p,cardinality:f,values:m}}return y=4*Math.ceil(y/4),v=null,i&&(v=copyFromBuffer(e,1===o?Uint32Array:Uint16Array,y,u,a)),{version:r,attributes:b,indices:v}}var PRWMLoader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager};PRWMLoader.prototype={constructor:PRWMLoader,load:function(e,t,r,n){var i=this,o=new FileLoader(i.manager);o.setPath(i.path),o.setResponseType("arraybuffer"),e=e.replace(/\*/g,isBigEndianPlatform()?"be":"le"),o.load(e,function(e){t(i.parse(e))},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){console.time("PRWMLoader");var t,r,n=decodePrwm(e),i=Object.keys(n.attributes),o=new BufferGeometry;for(r=0;r<i.length;r++)t=n.attributes[i[r]],o.addAttribute(i[r],new BufferAttribute(t.values,t.cardinality,t.normalized));return null!==n.indices&&o.setIndex(new BufferAttribute(n.indices,1)),console.timeEnd("PRWMLoader"),o}},PRWMLoader.isBigEndianPlatform=function(){return isBigEndianPlatform()};var PVRLoader=function e(t){CompressedTextureLoader.call(this,t),this._parser=e.parse};PVRLoader.prototype=Object.create(CompressedTextureLoader.prototype),PVRLoader.prototype.constructor=PVRLoader,PVRLoader.parse=function(e,t){var r=new Uint32Array(e,0,13),n={buffer:e,header:r,loadMipmaps:t};return 55727696===r[0]?PVRLoader._parseV3(n):559044176===r[11]?PVRLoader._parseV2(n):void console.error("PVRLoader: Unknown PVR format.")},PVRLoader._parseV3=function(e){var t,r,n=e.header,i=n[12],o=n[2],a=n[6],s=n[7],l=n[10],u=n[11];switch(o){case 0:t=2,r=RGB_PVRTC_2BPPV1_Format;break;case 1:t=2,r=RGBA_PVRTC_2BPPV1_Format;break;case 2:t=4,r=RGB_PVRTC_4BPPV1_Format;break;case 3:t=4,r=RGBA_PVRTC_4BPPV1_Format;break;default:console.error("PVRLoader: Unsupported PVR format:",o)}return e.dataPtr=52+i,e.bpp=t,e.format=r,e.width=s,e.height=a,e.numSurfaces=l,e.numMipmaps=u,e.isCubemap=6===l,PVRLoader._extract(e)},PVRLoader._parseV2=function(e){var t,r,n=e.header,i=n[0],o=n[1],a=n[2],s=n[3],l=n[4],u=n[10],c=n[12],h=255&l,p=u>0;return 25===h?(r=p?RGBA_PVRTC_4BPPV1_Format:RGB_PVRTC_4BPPV1_Format,t=4):24===h?(r=p?RGBA_PVRTC_2BPPV1_Format:RGB_PVRTC_2BPPV1_Format,t=2):console.error("PVRLoader: Unknown PVR format:",h),e.dataPtr=i,e.bpp=t,e.format=r,e.width=a,e.height=o,e.numSurfaces=c,e.numMipmaps=s+1,e.isCubemap=6===c,PVRLoader._extract(e)},PVRLoader._extract=function(e){var t,r={mipmaps:[],width:e.width,height:e.height,format:e.format,mipmapCount:e.numMipmaps,isCubemap:e.isCubemap},n=e.buffer,i=e.dataPtr,o=e.bpp,a=e.numSurfaces,s=0,l=0,u=0,c=0,h=0;2===o?(l=8,u=4):(l=4,u=4),t=l*u*o/8,r.mipmaps.length=e.numMipmaps*a;for(var p=0;p<e.numMipmaps;){var f=e.width>>p,d=e.height>>p;(c=f/l)<2&&(c=2),(h=d/u)<2&&(h=2),s=c*h*t;for(var m=0;m<a;m++){var v={data:new Uint8Array(n,i,s),width:f,height:d};r.mipmaps[m*e.numMipmaps+p]=v,i+=s}p++}return r};var STLLoader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager};function EllipseCurve(e,t,r,n,i,o,a,s){Curve.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=r||1,this.yRadius=n||1,this.aStartAngle=i||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function ArcCurve(e,t,r,n,i,o){EllipseCurve.call(this,e,t,r,r,n,i,o),this.type="ArcCurve"}function CubicPoly(){var e=0,t=0,r=0,n=0;function i(i,o,a,s){e=i,t=a,r=-3*i+3*o-2*a-s,n=2*i-2*o+a+s}return{initCatmullRom:function(e,t,r,n,o){i(t,r,o*(r-e),o*(n-t))},initNonuniformCatmullRom:function(e,t,r,n,o,a,s){var l=(t-e)/o-(r-e)/(o+a)+(r-t)/a,u=(r-t)/a-(n-t)/(a+s)+(n-r)/s;i(t,r,l*=a,u*=a)},calc:function(i){var o=i*i;return e+t*i+r*o+n*(o*i)}}}STLLoader.prototype={constructor:STLLoader,load:function(e,t,r,n){var i=this,o=new FileLoader(i.manager);o.setPath(i.path),o.setResponseType("arraybuffer"),o.load(e,function(e){try{t(i.parse(e))}catch(r){n&&n(r)}},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){function t(e,t,r){for(var n=0,i=e.length;n<i;n++)if(e[n]!==t.getUint8(r+n,!1))return!1;return!0}var r,n=function(e){if("string"===typeof e){for(var t=new Uint8Array(e.length),r=0;r<e.length;r++)t[r]=255&e.charCodeAt(r);return t.buffer||t}return e}(e);return function(e){var r;if(84+50*(r=new DataView(e)).getUint32(80,!0)===r.byteLength)return!0;for(var n=[115,111,108,105,100],i=0;i<5;i++)if(t(n,r,i))return!1;return!0}(n)?function(e){for(var t,r,n,i,o,a,s,l,u=new DataView(e),c=u.getUint32(80,!0),h=!1,p=0;p<70;p++)1129270351==u.getUint32(p,!1)&&82==u.getUint8(p+4)&&61==u.getUint8(p+5)&&(h=!0,i=[],o=u.getUint8(p+6)/255,a=u.getUint8(p+7)/255,s=u.getUint8(p+8)/255,l=u.getUint8(p+9)/255);for(var f=new BufferGeometry,d=[],m=[],v=0;v<c;v++){var g=84+50*v,y=u.getFloat32(g,!0),b=u.getFloat32(g+4,!0),x=u.getFloat32(g+8,!0);if(h){var w=u.getUint16(g+48,!0);0===(32768&w)?(t=(31&w)/31,r=(w>>5&31)/31,n=(w>>10&31)/31):(t=o,r=a,n=s)}for(var S=1;S<=3;S++){var M=g+12*S;d.push(u.getFloat32(M,!0)),d.push(u.getFloat32(M+4,!0)),d.push(u.getFloat32(M+8,!0)),m.push(y,b,x),h&&i.push(t,r,n)}}return f.addAttribute("position",new BufferAttribute(new Float32Array(d),3)),f.addAttribute("normal",new BufferAttribute(new Float32Array(m),3)),h&&(f.addAttribute("color",new BufferAttribute(new Float32Array(i),3)),f.hasColors=!0,f.alpha=l),f}(n):function(e){for(var t,r=new BufferGeometry,n=/facet([\s\S]*?)endfacet/g,i=0,o=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,a=new RegExp("vertex"+o+o+o,"g"),s=new RegExp("normal"+o+o+o,"g"),l=[],u=[],c=new Vector3;null!==(t=n.exec(e));){for(var h=0,p=0,f=t[0];null!==(t=s.exec(f));)c.x=parseFloat(t[1]),c.y=parseFloat(t[2]),c.z=parseFloat(t[3]),p++;for(;null!==(t=a.exec(f));)l.push(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])),u.push(c.x,c.y,c.z),h++;1!==p&&console.error("STLLoader: Something isn't right with the normal of face number "+i),3!==h&&console.error("STLLoader: Something isn't right with the vertices of face number "+i),i++}return r.addAttribute("position",new Float32BufferAttribute(l,3)),r.addAttribute("normal",new Float32BufferAttribute(u,3)),r}("string"!==typeof(r=e)?LoaderUtils.decodeText(new Uint8Array(r)):r)}},EllipseCurve.prototype=Object.create(Curve.prototype),EllipseCurve.prototype.constructor=EllipseCurve,EllipseCurve.prototype.isEllipseCurve=!0,EllipseCurve.prototype.getPoint=function(e,t){for(var r=t||new Vector2,n=2*Math.PI,i=this.aEndAngle-this.aStartAngle,o=Math.abs(i)<Number.EPSILON;i<0;)i+=n;for(;i>n;)i-=n;i<Number.EPSILON&&(i=o?0:n),!0!==this.aClockwise||o||(i===n?i=-n:i-=n);var a=this.aStartAngle+e*i,s=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){var u=Math.cos(this.aRotation),c=Math.sin(this.aRotation),h=s-this.aX,p=l-this.aY;s=h*u-p*c+this.aX,l=h*c+p*u+this.aY}return r.set(s,l)},EllipseCurve.prototype.copy=function(e){return Curve.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},EllipseCurve.prototype.toJSON=function(){var e=Curve.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},EllipseCurve.prototype.fromJSON=function(e){return Curve.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},ArcCurve.prototype=Object.create(EllipseCurve.prototype),ArcCurve.prototype.constructor=ArcCurve,ArcCurve.prototype.isArcCurve=!0;var tmp=new Vector3,px=new CubicPoly,py=new CubicPoly,pz=new CubicPoly;function CatmullRomCurve3(e,t,r,n){Curve.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=r||"centripetal",this.tension=n||.5}function CatmullRom(e,t,r,n,i){var o=.5*(n-t),a=.5*(i-r),s=e*e;return(2*r-2*n+o+a)*(e*s)+(-3*r+3*n-2*o-a)*s+o*e+r}function QuadraticBezierP0(e,t){var r=1-e;return r*r*t}function QuadraticBezierP1(e,t){return 2*(1-e)*e*t}function QuadraticBezierP2(e,t){return e*e*t}function QuadraticBezier(e,t,r,n){return QuadraticBezierP0(e,t)+QuadraticBezierP1(e,r)+QuadraticBezierP2(e,n)}function CubicBezierP0(e,t){var r=1-e;return r*r*r*t}function CubicBezierP1(e,t){var r=1-e;return 3*r*r*e*t}function CubicBezierP2(e,t){return 3*(1-e)*e*e*t}function CubicBezierP3(e,t){return e*e*e*t}function CubicBezier(e,t,r,n,i){return CubicBezierP0(e,t)+CubicBezierP1(e,r)+CubicBezierP2(e,n)+CubicBezierP3(e,i)}function CubicBezierCurve(e,t,r,n){Curve.call(this),this.type="CubicBezierCurve",this.v0=e||new Vector2,this.v1=t||new Vector2,this.v2=r||new Vector2,this.v3=n||new Vector2}function CubicBezierCurve3(e,t,r,n){Curve.call(this),this.type="CubicBezierCurve3",this.v0=e||new Vector3,this.v1=t||new Vector3,this.v2=r||new Vector3,this.v3=n||new Vector3}function LineCurve(e,t){Curve.call(this),this.type="LineCurve",this.v1=e||new Vector2,this.v2=t||new Vector2}function LineCurve3(e,t){Curve.call(this),this.type="LineCurve3",this.v1=e||new Vector3,this.v2=t||new Vector3}function QuadraticBezierCurve(e,t,r){Curve.call(this),this.type="QuadraticBezierCurve",this.v0=e||new Vector2,this.v1=t||new Vector2,this.v2=r||new Vector2}function QuadraticBezierCurve3(e,t,r){Curve.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new Vector3,this.v1=t||new Vector3,this.v2=r||new Vector3}function SplineCurve(e){Curve.call(this),this.type="SplineCurve",this.points=e||[]}CatmullRomCurve3.prototype=Object.create(Curve.prototype),CatmullRomCurve3.prototype.constructor=CatmullRomCurve3,CatmullRomCurve3.prototype.isCatmullRomCurve3=!0,CatmullRomCurve3.prototype.getPoint=function(e,t){var r,n,i,o,a=t||new Vector3,s=this.points,l=s.length,u=(l-(this.closed?0:1))*e,c=Math.floor(u),h=u-c;if(this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/l)+1)*l:0===h&&c===l-1&&(c=l-2,h=1),this.closed||c>0?r=s[(c-1)%l]:(tmp.subVectors(s[0],s[1]).add(s[0]),r=tmp),n=s[c%l],i=s[(c+1)%l],this.closed||c+2<l?o=s[(c+2)%l]:(tmp.subVectors(s[l-1],s[l-2]).add(s[l-1]),o=tmp),"centripetal"===this.curveType||"chordal"===this.curveType){var p="chordal"===this.curveType?.5:.25,f=Math.pow(r.distanceToSquared(n),p),d=Math.pow(n.distanceToSquared(i),p),m=Math.pow(i.distanceToSquared(o),p);d<1e-4&&(d=1),f<1e-4&&(f=d),m<1e-4&&(m=d),px.initNonuniformCatmullRom(r.x,n.x,i.x,o.x,f,d,m),py.initNonuniformCatmullRom(r.y,n.y,i.y,o.y,f,d,m),pz.initNonuniformCatmullRom(r.z,n.z,i.z,o.z,f,d,m)}else"catmullrom"===this.curveType&&(px.initCatmullRom(r.x,n.x,i.x,o.x,this.tension),py.initCatmullRom(r.y,n.y,i.y,o.y,this.tension),pz.initCatmullRom(r.z,n.z,i.z,o.z,this.tension));return a.set(px.calc(h),py.calc(h),pz.calc(h)),a},CatmullRomCurve3.prototype.copy=function(e){Curve.prototype.copy.call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},CatmullRomCurve3.prototype.toJSON=function(){var e=Curve.prototype.toJSON.call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},CatmullRomCurve3.prototype.fromJSON=function(e){Curve.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var n=e.points[t];this.points.push((new Vector3).fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},CubicBezierCurve.prototype=Object.create(Curve.prototype),CubicBezierCurve.prototype.constructor=CubicBezierCurve,CubicBezierCurve.prototype.isCubicBezierCurve=!0,CubicBezierCurve.prototype.getPoint=function(e,t){var r=t||new Vector2,n=this.v0,i=this.v1,o=this.v2,a=this.v3;return r.set(CubicBezier(e,n.x,i.x,o.x,a.x),CubicBezier(e,n.y,i.y,o.y,a.y)),r},CubicBezierCurve.prototype.copy=function(e){return Curve.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},CubicBezierCurve.prototype.toJSON=function(){var e=Curve.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},CubicBezierCurve.prototype.fromJSON=function(e){return Curve.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},CubicBezierCurve3.prototype=Object.create(Curve.prototype),CubicBezierCurve3.prototype.constructor=CubicBezierCurve3,CubicBezierCurve3.prototype.isCubicBezierCurve3=!0,CubicBezierCurve3.prototype.getPoint=function(e,t){var r=t||new Vector3,n=this.v0,i=this.v1,o=this.v2,a=this.v3;return r.set(CubicBezier(e,n.x,i.x,o.x,a.x),CubicBezier(e,n.y,i.y,o.y,a.y),CubicBezier(e,n.z,i.z,o.z,a.z)),r},CubicBezierCurve3.prototype.copy=function(e){return Curve.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},CubicBezierCurve3.prototype.toJSON=function(){var e=Curve.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},CubicBezierCurve3.prototype.fromJSON=function(e){return Curve.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},LineCurve.prototype=Object.create(Curve.prototype),LineCurve.prototype.constructor=LineCurve,LineCurve.prototype.isLineCurve=!0,LineCurve.prototype.getPoint=function(e,t){var r=t||new Vector2;return 1===e?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r},LineCurve.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},LineCurve.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},LineCurve.prototype.copy=function(e){return Curve.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},LineCurve.prototype.toJSON=function(){var e=Curve.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},LineCurve.prototype.fromJSON=function(e){return Curve.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},LineCurve3.prototype=Object.create(Curve.prototype),LineCurve3.prototype.constructor=LineCurve3,LineCurve3.prototype.isLineCurve3=!0,LineCurve3.prototype.getPoint=function(e,t){var r=t||new Vector3;return 1===e?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r},LineCurve3.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},LineCurve3.prototype.copy=function(e){return Curve.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},LineCurve3.prototype.toJSON=function(){var e=Curve.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},LineCurve3.prototype.fromJSON=function(e){return Curve.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},QuadraticBezierCurve.prototype=Object.create(Curve.prototype),QuadraticBezierCurve.prototype.constructor=QuadraticBezierCurve,QuadraticBezierCurve.prototype.isQuadraticBezierCurve=!0,QuadraticBezierCurve.prototype.getPoint=function(e,t){var r=t||new Vector2,n=this.v0,i=this.v1,o=this.v2;return r.set(QuadraticBezier(e,n.x,i.x,o.x),QuadraticBezier(e,n.y,i.y,o.y)),r},QuadraticBezierCurve.prototype.copy=function(e){return Curve.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},QuadraticBezierCurve.prototype.toJSON=function(){var e=Curve.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},QuadraticBezierCurve.prototype.fromJSON=function(e){return Curve.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},QuadraticBezierCurve3.prototype=Object.create(Curve.prototype),QuadraticBezierCurve3.prototype.constructor=QuadraticBezierCurve3,QuadraticBezierCurve3.prototype.isQuadraticBezierCurve3=!0,QuadraticBezierCurve3.prototype.getPoint=function(e,t){var r=t||new Vector3,n=this.v0,i=this.v1,o=this.v2;return r.set(QuadraticBezier(e,n.x,i.x,o.x),QuadraticBezier(e,n.y,i.y,o.y),QuadraticBezier(e,n.z,i.z,o.z)),r},QuadraticBezierCurve3.prototype.copy=function(e){return Curve.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},QuadraticBezierCurve3.prototype.toJSON=function(){var e=Curve.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},QuadraticBezierCurve3.prototype.fromJSON=function(e){return Curve.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},SplineCurve.prototype=Object.create(Curve.prototype),SplineCurve.prototype.constructor=SplineCurve,SplineCurve.prototype.isSplineCurve=!0,SplineCurve.prototype.getPoint=function(e,t){var r=t||new Vector2,n=this.points,i=(n.length-1)*e,o=Math.floor(i),a=i-o,s=n[0===o?o:o-1],l=n[o],u=n[o>n.length-2?n.length-1:o+1],c=n[o>n.length-3?n.length-1:o+2];return r.set(CatmullRom(a,s.x,l.x,u.x,c.x),CatmullRom(a,s.y,l.y,u.y,c.y)),r},SplineCurve.prototype.copy=function(e){Curve.prototype.copy.call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var n=e.points[t];this.points.push(n.clone())}return this},SplineCurve.prototype.toJSON=function(){var e=Curve.prototype.toJSON.call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var n=this.points[t];e.points.push(n.toArray())}return e},SplineCurve.prototype.fromJSON=function(e){Curve.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var n=e.points[t];this.points.push((new Vector2).fromArray(n))}return this};var Curves$1={ArcCurve:ArcCurve,CatmullRomCurve3:CatmullRomCurve3,CubicBezierCurve:CubicBezierCurve,CubicBezierCurve3:CubicBezierCurve3,EllipseCurve:EllipseCurve,LineCurve:LineCurve,LineCurve3:LineCurve3,QuadraticBezierCurve:QuadraticBezierCurve,QuadraticBezierCurve3:QuadraticBezierCurve3,SplineCurve:SplineCurve};function CurvePath(){Curve.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Path(e){CurvePath.call(this),this.type="Path",this.currentPoint=new Vector2,e&&this.setFromPoints(e)}function Shape(e){Path.call(this,e),this.uuid=_Math.generateUUID(),this.type="Shape",this.holes=[]}CurvePath.prototype=Object.assign(Object.create(Curve.prototype),{constructor:CurvePath,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Curves$1.LineCurve(t,e))},getPoint:function(e){for(var t=e*this.getLength(),r=this.getCurveLengths(),n=0;n<r.length;){if(r[n]>=t){var i=r[n]-t,o=this.curves[n],a=o.getLength(),s=0===a?0:1-i/a;return o.getPointAt(s)}n++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,r=0,n=this.curves.length;r<n;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,r=[],n=0,i=this.curves;n<i.length;n++)for(var o=i[n],a=o&&o.isEllipseCurve?2*e:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?e*o.points.length:e,s=o.getPoints(a),l=0;l<s.length;l++){var u=s[l];t&&t.equals(u)||(r.push(u),t=u)}return this.autoClose&&r.length>1&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r},copy:function(e){Curve.prototype.copy.call(this,e),this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=Curve.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,r=this.curves.length;t<r;t++){var n=this.curves[t];e.curves.push(n.toJSON())}return e},fromJSON:function(e){Curve.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var n=e.curves[t];this.curves.push((new Curves$1[n.type]).fromJSON(n))}return this}}),Path.prototype=Object.assign(Object.create(CurvePath.prototype),{constructor:Path,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var r=new LineCurve(this.currentPoint.clone(),new Vector2(e,t));this.curves.push(r),this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,r,n){var i=new QuadraticBezierCurve(this.currentPoint.clone(),new Vector2(e,t),new Vector2(r,n));this.curves.push(i),this.currentPoint.set(r,n)},bezierCurveTo:function(e,t,r,n,i,o){var a=new CubicBezierCurve(this.currentPoint.clone(),new Vector2(e,t),new Vector2(r,n),new Vector2(i,o));this.curves.push(a),this.currentPoint.set(i,o)},splineThru:function(e){var t=new SplineCurve([this.currentPoint.clone()].concat(e));this.curves.push(t),this.currentPoint.copy(e[e.length-1])},arc:function(e,t,r,n,i,o){var a=this.currentPoint.x,s=this.currentPoint.y;this.absarc(e+a,t+s,r,n,i,o)},absarc:function(e,t,r,n,i,o){this.absellipse(e,t,r,r,n,i,o)},ellipse:function(e,t,r,n,i,o,a,s){var l=this.currentPoint.x,u=this.currentPoint.y;this.absellipse(e+l,t+u,r,n,i,o,a,s)},absellipse:function(e,t,r,n,i,o,a,s){var l=new EllipseCurve(e,t,r,n,i,o,a,s);if(this.curves.length>0){var u=l.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(l);var c=l.getPoint(1);this.currentPoint.copy(c)},copy:function(e){return CurvePath.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=CurvePath.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return CurvePath.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),Shape.prototype=Object.assign(Object.create(Path.prototype),{constructor:Shape,getPointsHoles:function(e){for(var t=[],r=0,n=this.holes.length;r<n;r++)t[r]=this.holes[r].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){Path.prototype.copy.call(this,e),this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var n=e.holes[t];this.holes.push(n.clone())}return this},toJSON:function(){var e=Path.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,r=this.holes.length;t<r;t++){var n=this.holes[t];e.holes.push(n.toJSON())}return e},fromJSON:function(e){Path.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var n=e.holes[t];this.holes.push((new Path).fromJSON(n))}return this}});var Earcut={triangulate:function(e,t,r){r=r||2;var n,i,o,a,s,l,u,c=t&&t.length,h=c?t[0]*r:e.length,p=linkedList(e,0,h,r,!0),f=[];if(!p)return f;if(c&&(p=eliminateHoles(e,t,p,r)),e.length>80*r){n=o=e[0],i=a=e[1];for(var d=r;d<h;d+=r)(s=e[d])<n&&(n=s),(l=e[d+1])<i&&(i=l),s>o&&(o=s),l>a&&(a=l);u=0!==(u=Math.max(o-n,a-i))?1/u:0}return earcutLinked(p,f,r,n,i,u),f}};function linkedList(e,t,r,n,i){var o,a;if(i===signedArea(e,t,r,n)>0)for(o=t;o<r;o+=n)a=insertNode(o,e[o],e[o+1],a);else for(o=r-n;o>=t;o-=n)a=insertNode(o,e[o],e[o+1],a);return a&&equals(a,a.next)&&(removeNode(a),a=a.next),a}function filterPoints(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!equals(n,n.next)&&0!==area(n.prev,n,n.next))n=n.next;else{if(removeNode(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function earcutLinked(e,t,r,n,i,o,a){if(e){!a&&o&&indexCurve(e,n,i,o);for(var s,l,u=e;e.prev!==e.next;)if(s=e.prev,l=e.next,o?isEarHashed(e,n,i,o):isEar(e))t.push(s.i/r),t.push(e.i/r),t.push(l.i/r),removeNode(e),e=l.next,u=l.next;else if((e=l)===u){a?1===a?earcutLinked(e=cureLocalIntersections(e,t,r),t,r,n,i,o,2):2===a&&splitEarcut(e,t,r,n,i,o):earcutLinked(filterPoints(e),t,r,n,i,o,1);break}}}function isEar(e){var t=e.prev,r=e,n=e.next;if(area(t,r,n)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(pointInTriangle(t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y)&&area(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function isEarHashed(e,t,r,n){var i=e.prev,o=e,a=e.next;if(area(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,l=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,u=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,c=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,h=zOrder(s,l,t,r,n),p=zOrder(u,c,t,r,n),f=e.nextZ;f&&f.z<=p;){if(f!==e.prev&&f!==e.next&&pointInTriangle(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&area(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(f=e.prevZ;f&&f.z>=h;){if(f!==e.prev&&f!==e.next&&pointInTriangle(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&area(f.prev,f,f.next)>=0)return!1;f=f.prevZ}return!0}function cureLocalIntersections(e,t,r){var n=e;do{var i=n.prev,o=n.next.next;!equals(i,o)&&intersects(i,n,n.next,o)&&locallyInside(i,o)&&locallyInside(o,i)&&(t.push(i.i/r),t.push(n.i/r),t.push(o.i/r),removeNode(n),removeNode(n.next),n=e=o),n=n.next}while(n!==e);return n}function splitEarcut(e,t,r,n,i,o){var a=e;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&isValidDiagonal(a,s)){var l=splitPolygon(a,s);return a=filterPoints(a,a.next),l=filterPoints(l,l.next),earcutLinked(a,t,r,n,i,o),void earcutLinked(l,t,r,n,i,o)}s=s.next}a=a.next}while(a!==e)}function eliminateHoles(e,t,r,n){var i,o,a,s=[];for(i=0,o=t.length;i<o;i++)(a=linkedList(e,t[i]*n,i<o-1?t[i+1]*n:e.length,n,!1))===a.next&&(a.steiner=!0),s.push(getLeftmost(a));for(s.sort(compareX),i=0;i<s.length;i++)eliminateHole(s[i],r),r=filterPoints(r,r.next);return r}function compareX(e,t){return e.x-t.x}function eliminateHole(e,t){if(t=findHoleBridge(e,t)){var r=splitPolygon(t,e);filterPoints(r,r.next)}}function findHoleBridge(e,t){var r,n=t,i=e.x,o=e.y,a=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var s=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>a){if(a=s,s===i){if(o===n.y)return n;if(o===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(i===a)return r.prev;var l,u=r,c=r.x,h=r.y,p=1/0;for(n=r.next;n!==u;)i>=n.x&&n.x>=c&&i!==n.x&&pointInTriangle(o<h?i:a,o,c,h,o<h?a:i,o,n.x,n.y)&&((l=Math.abs(o-n.y)/(i-n.x))<p||l===p&&n.x>r.x)&&locallyInside(n,e)&&(r=n,p=l),n=n.next;return r}function indexCurve(e,t,r,n){var i=e;do{null===i.z&&(i.z=zOrder(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,sortLinked(i)}function sortLinked(e){var t,r,n,i,o,a,s,l,u=1;do{for(r=e,e=null,o=null,a=0;r;){for(a++,n=r,s=0,t=0;t<u&&(s++,n=n.nextZ);t++);for(l=u;s>0||l>0&&n;)0!==s&&(0===l||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,l--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;r=n}o.nextZ=null,u*=2}while(a>1);return e}function zOrder(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function getLeftmost(e){var t=e,r=e;do{t.x<r.x&&(r=t),t=t.next}while(t!==e);return r}function pointInTriangle(e,t,r,n,i,o,a,s){return(i-a)*(t-s)-(e-a)*(o-s)>=0&&(e-a)*(n-s)-(r-a)*(t-s)>=0&&(r-a)*(o-s)-(i-a)*(n-s)>=0}function isValidDiagonal(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!intersectsPolygon(e,t)&&locallyInside(e,t)&&locallyInside(t,e)&&middleInside(e,t)}function area(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function equals(e,t){return e.x===t.x&&e.y===t.y}function intersects(e,t,r,n){return!!(equals(e,t)&&equals(r,n)||equals(e,n)&&equals(r,t))||area(e,t,r)>0!==area(e,t,n)>0&&area(r,n,e)>0!==area(r,n,t)>0}function intersectsPolygon(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&intersects(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function locallyInside(e,t){return area(e.prev,e,e.next)<0?area(e,t,e.next)>=0&&area(e,e.prev,t)>=0:area(e,t,e.prev)<0||area(e,e.next,t)<0}function middleInside(e,t){var r=e,n=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{r.y>o!==r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}function splitPolygon(e,t){var r=new Node(e.i,e.x,e.y),n=new Node(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function insertNode(e,t,r,n){var i=new Node(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function removeNode(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Node(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(e,t,r,n){for(var i=0,o=t,a=r-n;o<r;o+=n)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}var ShapeUtils={area:function(e){for(var t=e.length,r=0,n=t-1,i=0;i<t;n=i++)r+=e[n].x*e[i].y-e[i].x*e[n].y;return.5*r},isClockWise:function(e){return ShapeUtils.area(e)<0},triangulateShape:function(e,t){var r=[],n=[],i=[];removeDupEndPts(e),addContour(r,e);var o=e.length;t.forEach(removeDupEndPts);for(var a=0;a<t.length;a++)n.push(o),o+=t[a].length,addContour(r,t[a]);var s=Earcut.triangulate(r,n);for(a=0;a<s.length;a+=3)i.push(s.slice(a,a+3));return i}};function removeDupEndPts(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function addContour(e,t){for(var r=0;r<t.length;r++)e.push(t[r].x),e.push(t[r].y)}function ShapePath(){this.type="ShapePath",this.color=new Color,this.subPaths=[],this.currentPath=null}Object.assign(ShapePath.prototype,{moveTo:function(e,t){this.currentPath=new Path,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,r,n){this.currentPath.quadraticCurveTo(e,t,r,n)},bezierCurveTo:function(e,t,r,n,i,o){this.currentPath.bezierCurveTo(e,t,r,n,i,o)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(e,t){function r(e){for(var t=[],r=0,n=e.length;r<n;r++){var i=e[r],o=new Shape;o.curves=i.curves,t.push(o)}return t}function n(e,t){for(var r=t.length,n=!1,i=r-1,o=0;o<r;i=o++){var a=t[i],s=t[o],l=s.x-a.x,u=s.y-a.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(a=t[o],l=-l,s=t[i],u=-u),e.y<a.y||e.y>s.y)continue;if(e.y===a.y){if(e.x===a.x)return!0}else{var c=u*(e.x-a.x)-l*(e.y-a.y);if(0===c)return!0;if(c<0)continue;n=!n}}else{if(e.y!==a.y)continue;if(s.x<=e.x&&e.x<=a.x||a.x<=e.x&&e.x<=s.x)return!0}}return n}var i=ShapeUtils.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===t)return r(o);var a,s,l,u=[];if(1===o.length)return s=o[0],(l=new Shape).curves=s.curves,u.push(l),u;var c=!i(o[0].getPoints());c=e?!c:c;var h,p,f=[],d=[],m=[],v=0;d[v]=void 0,m[v]=[];for(var g=0,y=o.length;g<y;g++)a=i(h=(s=o[g]).getPoints()),(a=e?!a:a)?(!c&&d[v]&&v++,d[v]={s:new Shape,p:h},d[v].s.curves=s.curves,c&&v++,m[v]=[]):m[v].push({h:s,p:h[0]});if(!d[0])return r(o);if(d.length>1){for(var b=!1,x=[],w=0,S=d.length;w<S;w++)f[w]=[];for(w=0,S=d.length;w<S;w++)for(var M=m[w],_=0;_<M.length;_++){for(var T=M[_],A=!0,C=0;C<d.length;C++)n(T.p,d[C].p)&&(w!==C&&x.push({froms:w,tos:C,hole:_}),A?(A=!1,f[C].push(T)):b=!0);A&&f[w].push(T)}x.length>0&&(b||(m=f))}g=0;for(var E=d.length;g<E;g++){l=d[g].s,u.push(l);for(var L=0,N=(p=m[g]).length;L<N;L++)l.holes.push(p[L].h)}return u}});var SVGLoader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager};SVGLoader.prototype={constructor:SVGLoader,load:function(e,t,r,n){var i=this,o=new FileLoader(i.manager);o.setPath(i.path),o.load(e,function(e){t(i.parse(e))},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){function t(e,t,n,i,o,a,s,l){i=i*Math.PI/180,t=Math.abs(t),n=Math.abs(n);var u=(s.x-l.x)/2,c=(s.y-l.y)/2,h=Math.cos(i)*u+Math.sin(i)*c,p=-Math.sin(i)*u+Math.cos(i)*c,f=t*t,d=n*n,m=h*h,v=p*p,g=m/f+v/d;if(g>1){var y=Math.sqrt(g);f=(t*=y)*t,d=(n*=y)*n}var b=f*v+d*m,x=(f*d-b)/b,w=Math.sqrt(Math.max(0,x));o===a&&(w=-w);var S=w*t*p/n,M=-w*n*h/t,_=Math.cos(i)*S-Math.sin(i)*M+(s.x+l.x)/2,T=Math.sin(i)*S+Math.cos(i)*M+(s.y+l.y)/2,A=r(1,0,(h-S)/t,(p-M)/n),C=r((h-S)/t,(p-M)/n,(-h-S)/t,(-p-M)/n)%(2*Math.PI);e.currentPath.absellipse(_,T,t,n,A,A+C,0===a,i)}function r(e,t,r,n){var i=e*r+t*n,o=Math.sqrt(e*e+t*t)*Math.sqrt(r*r+n*n),a=Math.acos(Math.max(-1,Math.min(1,i/o)));return e*n-t*r<0&&(a=-a),a}function n(e,t){return t=Object.assign({},t),e.hasAttribute("fill")&&(t.fill=e.getAttribute("fill")),""!==e.style.fill&&(t.fill=e.style.fill),t}function i(e){return"none"!==e.fill&&"transparent"!==e.fill}function o(e,t){return e-(t-e)}function a(e){for(var t=e.split(/[\s,]+|(?=\s?[+\-])/),r=0;r<t.length;r++){var n=t[r];if(n.indexOf(".")!==n.lastIndexOf("."))for(var i=n.split("."),o=2;o<i.length;o++)t.splice(r+o-1,0,"0."+i[o]);t[r]=parseFloat(n)}return t}function s(e){var t=e.elements;return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function l(e){var t=e.elements;return Math.sqrt(t[3]*t[3]+t[4]*t[4])}console.log("SVGLoader");var u=[],c=[],h=new Matrix3,p=new Matrix3,f=new Matrix3,d=new Matrix3,m=new Matrix3;console.time("SVGLoader: DOMParser");var v=(new DOMParser).parseFromString(e,"image/svg+xml");return console.timeEnd("SVGLoader: DOMParser"),console.time("SVGLoader: Parse"),function e(r,v){if(1===r.nodeType){var g=function(e){if(!e.hasAttribute("transform"))return null;var t=function(e){for(var t=new Matrix3,r=h,n=e.getAttribute("transform").split(" "),i=n.length-1;i>=0;i--){var o=n[i],s=o.indexOf("("),l=o.indexOf(")");if(s>0&&s<l){var u=o.substr(0,s),c=a(o.substr(s+1,l-s-1));switch(r.identity(),u){case"translate":if(c.length>=1){var m=c[0],v=m;c.length>=2&&(v=c[1]),r.translate(m,v)}break;case"rotate":if(c.length>=1){var g=0,y=0,b=0;g=-c[0]*Math.PI/180,c.length>=3&&(y=c[1],b=c[2]),p.identity().translate(-y,-b),f.identity().rotate(g),d.multiplyMatrices(f,p),p.identity().translate(y,b),r.multiplyMatrices(p,d)}break;case"scale":if(c.length>=1){var x=c[0],w=x;c.length>=2&&(w=c[1]),r.scale(x,w)}break;case"skewX":1===c.length&&r.set(1,Math.tan(c[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":1===c.length&&r.set(1,0,0,Math.tan(c[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":6===c.length&&r.set(c[0],c[2],c[4],c[1],c[3],c[5],0,0,1)}}t.premultiply(r)}return t}(e);return t&&(c.length>0&&t.premultiply(c[c.length-1]),m.copy(t),c.push(t)),t}(r),y=null;switch(r.nodeName){case"svg":break;case"g":v=n(r,v);break;case"path":v=n(r,v),r.hasAttribute("d")&&i(v)&&(y=function(e,r){var n=new ShapePath;n.color.setStyle(r.fill);for(var i=new Vector2,s=new Vector2,l=new Vector2,u=!0,c=!1,h=e.getAttribute("d").match(/[a-df-z][^a-df-z]*/gi),p=0,f=h.length;p<f;p++){var d=h[p],m=d.charAt(0),v=d.substr(1).trim();switch(!0===u&&(c=!0,u=!1),m){case"M":for(var g=a(v),y=0,b=g.length;y<b;y+=2)i.x=g[y+0],i.y=g[y+1],s.x=i.x,s.y=i.y,0===y?n.moveTo(i.x,i.y):n.lineTo(i.x,i.y),0===y&&!0===c&&l.copy(i);break;case"H":for(var g=a(v),y=0,b=g.length;y<b;y++)i.x=g[y],s.x=i.x,s.y=i.y,n.lineTo(i.x,i.y),0===y&&!0===c&&l.copy(i);break;case"V":for(var g=a(v),y=0,b=g.length;y<b;y++)i.y=g[y],s.x=i.x,s.y=i.y,n.lineTo(i.x,i.y),0===y&&!0===c&&l.copy(i);break;case"L":for(var g=a(v),y=0,b=g.length;y<b;y+=2)i.x=g[y+0],i.y=g[y+1],s.x=i.x,s.y=i.y,n.lineTo(i.x,i.y),0===y&&!0===c&&l.copy(i);break;case"C":for(var g=a(v),y=0,b=g.length;y<b;y+=6)n.bezierCurveTo(g[y+0],g[y+1],g[y+2],g[y+3],g[y+4],g[y+5]),s.x=g[y+2],s.y=g[y+3],i.x=g[y+4],i.y=g[y+5],0===y&&!0===c&&l.copy(i);break;case"S":for(var g=a(v),y=0,b=g.length;y<b;y+=4)n.bezierCurveTo(o(i.x,s.x),o(i.y,s.y),g[y+0],g[y+1],g[y+2],g[y+3]),s.x=g[y+0],s.y=g[y+1],i.x=g[y+2],i.y=g[y+3],0===y&&!0===c&&l.copy(i);break;case"Q":for(var g=a(v),y=0,b=g.length;y<b;y+=4)n.quadraticCurveTo(g[y+0],g[y+1],g[y+2],g[y+3]),s.x=g[y+0],s.y=g[y+1],i.x=g[y+2],i.y=g[y+3],0===y&&!0===c&&l.copy(i);break;case"T":for(var g=a(v),y=0,b=g.length;y<b;y+=2){var x=o(i.x,s.x),w=o(i.y,s.y);n.quadraticCurveTo(x,w,g[y+0],g[y+1]),s.x=x,s.y=w,i.x=g[y+0],i.y=g[y+1],0===y&&!0===c&&l.copy(i)}break;case"A":for(var g=a(v),y=0,b=g.length;y<b;y+=7){var S=i.clone();i.x=g[y+5],i.y=g[y+6],s.x=i.x,s.y=i.y,t(n,g[y],g[y+1],g[y+2],g[y+3],g[y+4],S,i),0===y&&!0===c&&l.copy(i)}break;case"m":for(var g=a(v),y=0,b=g.length;y<b;y+=2)i.x+=g[y+0],i.y+=g[y+1],s.x=i.x,s.y=i.y,0===y?n.moveTo(i.x,i.y):n.lineTo(i.x,i.y),0===y&&!0===c&&l.copy(i);break;case"h":for(var g=a(v),y=0,b=g.length;y<b;y++)i.x+=g[y],s.x=i.x,s.y=i.y,n.lineTo(i.x,i.y),0===y&&!0===c&&l.copy(i);break;case"v":for(var g=a(v),y=0,b=g.length;y<b;y++)i.y+=g[y],s.x=i.x,s.y=i.y,n.lineTo(i.x,i.y),0===y&&!0===c&&l.copy(i);break;case"l":for(var g=a(v),y=0,b=g.length;y<b;y+=2)i.x+=g[y+0],i.y+=g[y+1],s.x=i.x,s.y=i.y,n.lineTo(i.x,i.y),0===y&&!0===c&&l.copy(i);break;case"c":for(var g=a(v),y=0,b=g.length;y<b;y+=6)n.bezierCurveTo(i.x+g[y+0],i.y+g[y+1],i.x+g[y+2],i.y+g[y+3],i.x+g[y+4],i.y+g[y+5]),s.x=i.x+g[y+2],s.y=i.y+g[y+3],i.x+=g[y+4],i.y+=g[y+5],0===y&&!0===c&&l.copy(i);break;case"s":for(var g=a(v),y=0,b=g.length;y<b;y+=4)n.bezierCurveTo(o(i.x,s.x),o(i.y,s.y),i.x+g[y+0],i.y+g[y+1],i.x+g[y+2],i.y+g[y+3]),s.x=i.x+g[y+0],s.y=i.y+g[y+1],i.x+=g[y+2],i.y+=g[y+3],0===y&&!0===c&&l.copy(i);break;case"q":for(var g=a(v),y=0,b=g.length;y<b;y+=4)n.quadraticCurveTo(i.x+g[y+0],i.y+g[y+1],i.x+g[y+2],i.y+g[y+3]),s.x=i.x+g[y+0],s.y=i.y+g[y+1],i.x+=g[y+2],i.y+=g[y+3],0===y&&!0===c&&l.copy(i);break;case"t":for(var g=a(v),y=0,b=g.length;y<b;y+=2){var x=o(i.x,s.x),w=o(i.y,s.y);n.quadraticCurveTo(x,w,i.x+g[y+0],i.y+g[y+1]),s.x=x,s.y=w,i.x=i.x+g[y+0],i.y=i.y+g[y+1],0===y&&!0===c&&l.copy(i)}break;case"a":for(var g=a(v),y=0,b=g.length;y<b;y+=7){var S=i.clone();i.x+=g[y+5],i.y+=g[y+6],s.x=i.x,s.y=i.y,t(n,g[y],g[y+1],g[y+2],g[y+3],g[y+4],S,i),0===y&&!0===c&&l.copy(i)}break;case"Z":case"z":n.currentPath.autoClose=!0,n.currentPath.curves.length>0&&(i.copy(l),n.currentPath.currentPoint.copy(i),u=!0);break;default:console.warn(d)}c=!1}return n}(r,v));break;case"rect":i(v=n(r,v))&&(y=function(e,t){var r=parseFloat(e.getAttribute("x")||0),n=parseFloat(e.getAttribute("y")||0),i=parseFloat(e.getAttribute("rx")||0),o=parseFloat(e.getAttribute("ry")||0),a=parseFloat(e.getAttribute("width")),s=parseFloat(e.getAttribute("height")),l=new ShapePath;return l.color.setStyle(t.fill),l.moveTo(r+2*i,n),l.lineTo(r+a-2*i,n),(0!==i||0!==o)&&l.bezierCurveTo(r+a,n,r+a,n,r+a,n+2*o),l.lineTo(r+a,n+s-2*o),(0!==i||0!==o)&&l.bezierCurveTo(r+a,n+s,r+a,n+s,r+a-2*i,n+s),l.lineTo(r+2*i,n+s),(0!==i||0!==o)&&l.bezierCurveTo(r,n+s,r,n+s,r,n+s-2*o),l.lineTo(r,n+2*o),(0!==i||0!==o)&&l.bezierCurveTo(r,n,r,n,r+2*i,n),l}(r,v));break;case"polygon":i(v=n(r,v))&&(y=function(e,t){var r=new ShapePath;r.color.setStyle(t.fill);var n=0;return e.getAttribute("points").replace(/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,function(e,t,i){var o=parseFloat(t),a=parseFloat(i);0===n?r.moveTo(o,a):r.lineTo(o,a),n++}),r.currentPath.autoClose=!0,r}(r,v));break;case"polyline":i(v=n(r,v))&&(y=function(e,t){var r=new ShapePath;r.color.setStyle(t.fill);var n=0;return e.getAttribute("points").replace(/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,function(e,t,i){var o=parseFloat(t),a=parseFloat(i);0===n?r.moveTo(o,a):r.lineTo(o,a),n++}),r.currentPath.autoClose=!1,r}(r,v));break;case"circle":i(v=n(r,v))&&(y=function(e,t){var r=parseFloat(e.getAttribute("cx")),n=parseFloat(e.getAttribute("cy")),i=parseFloat(e.getAttribute("r")),o=new Path;o.absarc(r,n,i,0,2*Math.PI);var a=new ShapePath;return a.color.setStyle(t.fill),a.subPaths.push(o),a}(r,v));break;case"ellipse":i(v=n(r,v))&&(y=function(e,t){var r=parseFloat(e.getAttribute("cx")),n=parseFloat(e.getAttribute("cy")),i=parseFloat(e.getAttribute("rx")),o=parseFloat(e.getAttribute("ry")),a=new Path;a.absellipse(r,n,i,o,0,2*Math.PI);var s=new ShapePath;return s.color.setStyle(t.fill),s.subPaths.push(a),s}(r,v));break;case"line":i(v=n(r,v))&&(y=function(e,t){var r=parseFloat(e.getAttribute("x1")),n=parseFloat(e.getAttribute("y1")),i=parseFloat(e.getAttribute("x2")),o=parseFloat(e.getAttribute("y2")),a=new ShapePath;return a.moveTo(r,n),a.lineTo(i,o),a.currentPath.autoClose=!1,a}(r));break;default:console.log(r)}y&&(function(e,t){function r(e){o.set(e.x,e.y,1).applyMatrix3(t),e.set(o.x,o.y)}for(var n=function(e){return 0!==e.elements[1]||0!==e.elements[3]}(t),i=new Vector2,o=new Vector3,a=e.subPaths,u=0,c=a.length;u<c;u++)for(var h=a[u],p=h.curves,f=0;f<p.length;f++){var d=p[f];d.isLineCurve?(r(d.v1),r(d.v2)):d.isCubicBezierCurve?(r(d.v0),r(d.v1),r(d.v2),r(d.v3)):d.isQuadraticBezierCurve?(r(d.v0),r(d.v1),r(d.v2)):d.isEllipseCurve&&(n&&console.warn("SVGLoader: Elliptic arc or ellipse rotation or skewing is not implemented."),i.set(d.aX,d.aY),r(i),d.aX=i.x,d.aY=i.y,d.xRadius*=s(t),d.yRadius*=l(t))}}(y,m),u.push(y));for(var b=r.childNodes,x=0;x<b.length;x++)e(b[x],v);g&&m.copy(c.pop())}}(v.documentElement,{fill:"#000"}),console.timeEnd("SVGLoader: Parse"),u}};var TDSLoader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager,this.debug=!1,this.group=null,this.position=0,this.materials=[],this.meshes=[]};TDSLoader.prototype={constructor:TDSLoader,crossOrigin:"anonymous",load:function(e,t,r,n){var i=this,o=void 0!==this.path?this.path:LoaderUtils.extractUrlBase(e),a=new FileLoader(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.load(e,function(e){t(i.parse(e,o))},r,n)},parse:function(e,t){this.group=new Group,this.position=0,this.materials=[],this.meshes=[],this.readFile(e,t);for(var r=0;r<this.meshes.length;r++)this.group.add(this.meshes[r]);return this.group},readFile:function(e,t){var r=new DataView(e),n=this.readChunk(r);if(n.id===MLIBMAGIC||n.id===CMAGIC||n.id===M3DMAGIC)for(var i=this.nextChunk(r,n);0!==i;){if(i===M3D_VERSION){var o=this.readDWord(r);this.debugMessage("3DS file version: "+o)}else i===MDATA?(this.resetPosition(r),this.readMeshData(r,t)):this.debugMessage("Unknown main chunk: "+i.toString(16));i=this.nextChunk(r,n)}this.debugMessage("Parsed "+this.meshes.length+" meshes")},readMeshData:function(e,t){for(var r=this.readChunk(e),n=this.nextChunk(e,r);0!==n;){if(n===MESH_VERSION){var i=+this.readDWord(e);this.debugMessage("Mesh Version: "+i)}else if(n===MASTER_SCALE){var o=this.readFloat(e);this.debugMessage("Master scale: "+o),this.group.scale.set(o,o,o)}else n===NAMED_OBJECT?(this.debugMessage("Named Object"),this.resetPosition(e),this.readNamedObject(e)):n===MAT_ENTRY?(this.debugMessage("Material"),this.resetPosition(e),this.readMaterialEntry(e,t)):this.debugMessage("Unknown MDATA chunk: "+n.toString(16));n=this.nextChunk(e,r)}},readNamedObject:function(e){var t=this.readChunk(e),r=this.readString(e,64);t.cur=this.position;for(var n=this.nextChunk(e,t);0!==n;){if(n===N_TRI_OBJECT){this.resetPosition(e);var i=this.readMesh(e);i.name=r,this.meshes.push(i)}else this.debugMessage("Unknown named object chunk: "+n.toString(16));n=this.nextChunk(e,t)}this.endChunk(t)},readMaterialEntry:function(e,t){for(var r=this.readChunk(e),n=this.nextChunk(e,r),i=new MeshPhongMaterial;0!==n;){if(n===MAT_NAME)i.name=this.readString(e,64),this.debugMessage("   Name: "+i.name);else if(n===MAT_WIRE)this.debugMessage("   Wireframe"),i.wireframe=!0;else if(n===MAT_WIRE_SIZE){var o=this.readByte(e);i.wireframeLinewidth=o,this.debugMessage("   Wireframe Thickness: "+o)}else if(n===MAT_TWO_SIDE)i.side=DoubleSide,this.debugMessage("   DoubleSided");else if(n===MAT_ADDITIVE)this.debugMessage("   Additive Blending"),i.blending=AdditiveBlending;else if(n===MAT_DIFFUSE)this.debugMessage("   Diffuse Color"),i.color=this.readColor(e);else if(n===MAT_SPECULAR)this.debugMessage("   Specular Color"),i.specular=this.readColor(e);else if(n===MAT_AMBIENT)this.debugMessage("   Ambient color"),i.color=this.readColor(e);else if(n===MAT_SHININESS){var a=this.readWord(e);i.shininess=a,this.debugMessage("   Shininess : "+a)}else n===MAT_TEXMAP?(this.debugMessage("   ColorMap"),this.resetPosition(e),i.map=this.readMap(e,t)):n===MAT_BUMPMAP?(this.debugMessage("   BumpMap"),this.resetPosition(e),i.bumpMap=this.readMap(e,t)):n===MAT_OPACMAP?(this.debugMessage("   OpacityMap"),this.resetPosition(e),i.alphaMap=this.readMap(e,t)):n===MAT_SPECMAP?(this.debugMessage("   SpecularMap"),this.resetPosition(e),i.specularMap=this.readMap(e,t)):this.debugMessage("   Unknown material chunk: "+n.toString(16));n=this.nextChunk(e,r)}this.endChunk(r),this.materials[i.name]=i},readMesh:function(e){var t=this.readChunk(e),r=this.nextChunk(e,t),n=new BufferGeometry,i=[],o=new Mesh(n,new MeshPhongMaterial);for(o.name="mesh";0!==r;){if(r===POINT_ARRAY){var a=this.readWord(e);this.debugMessage("   Vertex: "+a);for(var s=[],l=0;l<a;l++)s.push(this.readFloat(e)),s.push(this.readFloat(e)),s.push(this.readFloat(e));n.addAttribute("position",new Float32BufferAttribute(s,3))}else if(r===FACE_ARRAY)this.resetPosition(e),this.readFaceArray(e,o);else if(r===TEX_VERTS){var u=this.readWord(e);this.debugMessage("   UV: "+u);for(i=[],l=0;l<u;l++)i.push(this.readFloat(e)),i.push(this.readFloat(e));n.addAttribute("uv",new Float32BufferAttribute(i,2))}else if(r===MESH_MATRIX){this.debugMessage("   Tranformation Matrix (TODO)");var c=[];for(l=0;l<12;l++)c[l]=this.readFloat(e);var h=new Matrix4;h.elements[0]=c[0],h.elements[1]=c[6],h.elements[2]=c[3],h.elements[3]=c[9],h.elements[4]=c[2],h.elements[5]=c[8],h.elements[6]=c[5],h.elements[7]=c[11],h.elements[8]=c[1],h.elements[9]=c[7],h.elements[10]=c[4],h.elements[11]=c[10],h.elements[12]=0,h.elements[13]=0,h.elements[14]=0,h.elements[15]=1,h.transpose();var p=new Matrix4;p.getInverse(h,!0),n.applyMatrix(p),h.decompose(o.position,o.quaternion,o.scale)}else this.debugMessage("   Unknown mesh chunk: "+r.toString(16));r=this.nextChunk(e,t)}return this.endChunk(t),n.computeVertexNormals(),o},readFaceArray:function(e,t){var r=this.readChunk(e),n=this.readWord(e);this.debugMessage("   Faces: "+n);for(var i=[],o=0;o<n;++o){i.push(this.readWord(e),this.readWord(e),this.readWord(e));this.readWord(e)}for(t.geometry.setIndex(i);this.position<r.end;){if((r=this.readChunk(e)).id===MSH_MAT_GROUP){this.debugMessage("      Material Group"),this.resetPosition(e);var a=this.readMaterialGroup(e),s=this.materials[a.name];void 0!==s&&(t.material=s,""===s.name&&(s.name=t.name))}else this.debugMessage("      Unknown face array chunk: "+r.toString(16));this.endChunk(r)}this.endChunk(r)},readMap:function(e,t){var r=this.readChunk(e),n=this.nextChunk(e,r),i={},o=new TextureLoader(this.manager);for(o.setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);0!==n;){if(n===MAT_MAPNAME){var a=this.readString(e,128);i=o.load(a),this.debugMessage("      File: "+t+a)}else n===MAT_MAP_UOFFSET?(i.offset.x=this.readFloat(e),this.debugMessage("      OffsetX: "+i.offset.x)):n===MAT_MAP_VOFFSET?(i.offset.y=this.readFloat(e),this.debugMessage("      OffsetY: "+i.offset.y)):n===MAT_MAP_USCALE?(i.repeat.x=this.readFloat(e),this.debugMessage("      RepeatX: "+i.repeat.x)):n===MAT_MAP_VSCALE?(i.repeat.y=this.readFloat(e),this.debugMessage("      RepeatY: "+i.repeat.y)):this.debugMessage("      Unknown map chunk: "+n.toString(16));n=this.nextChunk(e,r)}return this.endChunk(r),i},readMaterialGroup:function(e){this.readChunk(e);var t=this.readString(e,64),r=this.readWord(e);this.debugMessage("         Name: "+t),this.debugMessage("         Faces: "+r);for(var n=[],i=0;i<r;++i)n.push(this.readWord(e));return{name:t,index:n}},readColor:function(e){var t=this.readChunk(e),r=new Color;if(t.id===COLOR_24||t.id===LIN_COLOR_24){var n=this.readByte(e),i=this.readByte(e),o=this.readByte(e);r.setRGB(n/255,i/255,o/255),this.debugMessage("      Color: "+r.r+", "+r.g+", "+r.b)}else if(t.id===COLOR_F||t.id===LIN_COLOR_F){n=this.readFloat(e),i=this.readFloat(e),o=this.readFloat(e);r.setRGB(n,i,o),this.debugMessage("      Color: "+r.r+", "+r.g+", "+r.b)}else this.debugMessage("      Unknown color chunk: "+t.toString(16));return this.endChunk(t),r},readChunk:function(e){var t={};return t.cur=this.position,t.id=this.readWord(e),t.size=this.readDWord(e),t.end=t.cur+t.size,t.cur+=6,t},endChunk:function(e){this.position=e.end},nextChunk:function(e,t){if(t.cur>=t.end)return 0;this.position=t.cur;try{var r=this.readChunk(e);return t.cur+=r.size,r.id}catch(n){return this.debugMessage("Unable to read chunk at "+this.position),0}},resetPosition:function(){this.position-=6},readByte:function(e){var t=e.getUint8(this.position,!0);return this.position+=1,t},readFloat:function(e){try{var t=e.getFloat32(this.position,!0);return this.position+=4,t}catch(r){this.debugMessage(r+" "+this.position+" "+e.byteLength)}},readInt:function(e){var t=e.getInt32(this.position,!0);return this.position+=4,t},readShort:function(e){var t=e.getInt16(this.position,!0);return this.position+=2,t},readDWord:function(e){var t=e.getUint32(this.position,!0);return this.position+=4,t},readWord:function(e){var t=e.getUint16(this.position,!0);return this.position+=2,t},readString:function(e,t){for(var r="",n=0;n<t;n++){var i=this.readByte(e);if(!i)break;r+=String.fromCharCode(i)}return r},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},debugMessage:function(e){this.debug&&console.log(e)}};var M3DMAGIC=19789,MLIBMAGIC=15786,CMAGIC=49725,M3D_VERSION=2,COLOR_F=16,COLOR_24=17,LIN_COLOR_24=18,LIN_COLOR_F=19,MDATA=15677,MESH_VERSION=15678,MASTER_SCALE=256,MAT_ENTRY=45055,MAT_NAME=40960,MAT_AMBIENT=40976,MAT_DIFFUSE=40992,MAT_SPECULAR=41008,MAT_SHININESS=41024,MAT_TWO_SIDE=41089,MAT_ADDITIVE=41091,MAT_WIRE=41093,MAT_WIRE_SIZE=41095,MAT_TEXMAP=41472,MAT_OPACMAP=41488,MAT_BUMPMAP=41520,MAT_SPECMAP=41476,MAT_MAPNAME=41728,MAT_MAP_USCALE=41812,MAT_MAP_VSCALE=41814,MAT_MAP_UOFFSET=41816,MAT_MAP_VOFFSET=41818,NAMED_OBJECT=16384,N_TRI_OBJECT=16640,POINT_ARRAY=16656,FACE_ARRAY=16672,MSH_MAT_GROUP=16688,TEX_VERTS=16704,MESH_MATRIX=16736,TTFLoader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager,this.reversed=!1};TTFLoader.prototype={constructor:TTFLoader,load:function(e,t,r,n){var i=this,o=new FileLoader(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){function t(e){var t,r=[];e.forEach(function(e){"m"===e.type.toLowerCase()?(t=[e],r.push(t)):"z"!==e.type.toLowerCase()&&t.push(e)});var n=[];return r.forEach(function(e){var t={type:"m",x:e[e.length-1].x,y:e[e.length-1].y};n.push(t);for(var r=e.length-1;r>0;r--){var i=e[r];t={type:i.type};void 0!==i.x2&&void 0!==i.y2?(t.x1=i.x2,t.y1=i.y2,t.x2=i.x1,t.y2=i.y1):void 0!==i.x1&&void 0!==i.y1&&(t.x1=i.x1,t.y1=i.y1),t.x=e[r-1].x,t.y=e[r-1].y,n.push(t)}}),n}return"undefined"===typeof opentype?(console.warn("TTFLoader: The loader requires opentype.js. Make sure it's included before using the loader."),null):function(e,r){for(var n=Math.round,i={},o=1e5/(72*(e.unitsPerEm||2048)),a=0;a<e.glyphs.length;a++){var s=e.glyphs.glyphs[a];if(void 0!==s.unicode){var l={ha:n(s.advanceWidth*o),x_min:n(s.xMin*o),x_max:n(s.xMax*o),o:""};r&&(s.path.commands=t(s.path.commands)),s.path.commands.forEach(function(e,t){"c"===e.type.toLowerCase()&&(e.type="b"),l.o+=e.type.toLowerCase()+" ",void 0!==e.x&&void 0!==e.y&&(l.o+=n(e.x*o)+" "+n(e.y*o)+" "),void 0!==e.x1&&void 0!==e.y1&&(l.o+=n(e.x1*o)+" "+n(e.y1*o)+" "),void 0!==e.x2&&void 0!==e.y2&&(l.o+=n(e.x2*o)+" "+n(e.y2*o)+" ")}),i[String.fromCharCode(s.unicode)]=l}}return{glyphs:i,familyName:e.familyName,ascender:n(e.ascender*o),descender:n(e.descender*o),underlinePosition:e.tables.post.underlinePosition,underlineThickness:e.tables.post.underlineThickness,boundingBox:{xMin:e.tables.head.xMin,xMax:e.tables.head.xMax,yMin:e.tables.head.yMin,yMax:e.tables.head.yMax},resolution:1e3,original_font_information:e.tables.name}}(opentype.parse(e),this.reversed)}};var VRMLLoader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager};VRMLLoader.prototype={constructor:VRMLLoader,isRecordingPoints:!1,isRecordingFaces:!1,points:[],indexes:[],isRecordingAngles:!1,isRecordingColors:!1,angles:[],colors:[],recordingFieldname:null,crossOrigin:"anonymous",load:function(e,t,r,n){var i=this,o=void 0===i.path?LoaderUtils.extractUrlBase(e):i.path,a=new FileLoader(this.manager);a.setPath(i.path),a.load(e,function(e){t(i.parse(e,o))},r,n)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,t){var r=this,n=new TextureLoader(this.manager);n.setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);for(var i=new Scene,o=e.split("\n"),a=o.length-1;a>-1;a--){var s=o[a];if(s=s.replace(/(#.*)/,""),/{.*[{\[]/.test(s))(l=s.split("{").join("{\n").split("\n")).unshift(1),l.unshift(a),o.splice.apply(o,l);else if(/\].*}/.test(s)){var l;(l=s.split("]").join("]\n").split("\n")).unshift(1),l.unshift(a),o.splice.apply(o,l)}if(/}.*}/.test(s))(l=s.split("}").join("}\n").split("\n")).unshift(1),l.unshift(a),o.splice.apply(o,l);/^\b[^\s]+\b$/.test(s.trim())?(o[a+1]=s+" "+o[a+1].trim(),o.splice(a,1)):s.indexOf("coord")>-1&&s.indexOf("[")<0&&s.indexOf("{")<0&&(o[a]+=" Coordinate {}")}var u=o.shift();return/V1.0/.exec(u)?console.warn("VRMLLoader: V1.0 not supported yet."):/V2.0/.exec(u)&&function(e,t){var i={},o=/(\b|\-|\+)([\d\.e]+)/,a=/([\d\.\+\-e]+)\s+([\d\.\+\-e]+)/g,s=/([\d\.\+\-e]+)\s+([\d\.\+\-e]+)\s+([\d\.\+\-e]+)/g;function l(e,t,r,n,i){for(var o=!0===i?1:-1,a=[],s={},l={},u=0;u<r.length;u++){var c={x:o*(Math.cos(r[u])*t),y:o*(Math.sin(r[u])*t)};a.push(c)}for(var h=e.index,p=e.attributes.position,f=new BufferAttribute(new Float32Array(3*e.attributes.position.count),3),d=new Vector3,m=new Color,v=0;v<h.count;v++){var g=h.getX(v);d.fromBufferAttribute(p,g);for(var y=0;y<n.length;y++)if(0===y?(s.x=0,s.y=!0===i?t:-1*t):(s.x=a[y-1].x,s.y=a[y-1].y),void 0!==(l=a[y]))if(!0===(!0===i?d.y<=s.y&&d.y>l.y:d.y>=s.y&&d.y<l.y)){var b=n[y],x=n[y+1],w=Math.abs(d.y-s.y)/(s.y-l.y);m.copy(b).lerp(x,w),f.setXYZ(g,m.r,m.g,m.b)}else{var S=n[!0===i?n.length-1:0];f.setXYZ(g,S.r,S.g,S.b)}}e.addAttribute("color",f)}var u=[];function c(e,t){for(var n,i,l,c=[],h={},p=/[^\s,\[\]]+/g;null!==(n=p.exec(t));)c.push(n[0]);switch(i=c[0]){case"skyAngle":case"groundAngle":r.recordingFieldname=i,r.isRecordingAngles=!0,r.angles=[];break;case"color":case"skyColor":case"groundColor":r.recordingFieldname=i,r.isRecordingColors=!0,r.colors=[];break;case"point":case"vector":r.recordingFieldname=i,r.isRecordingPoints=!0,r.points=[];break;case"colorIndex":case"coordIndex":case"normalIndex":case"texCoordIndex":r.recordingFieldname=i,r.isRecordingFaces=!0,r.indexes=[]}if(r.isRecordingFaces){if(c.length>0)for(var f=0;f<c.length;f++)/(-?\d+)/.test(c[f])&&("-1"===c[f]?(u.length>0&&r.indexes.push(u),u=[]):u.push(parseInt(c[f])));/]/.exec(t)&&(u.length>0&&r.indexes.push(u),u=[],r.isRecordingFaces=!1,e[r.recordingFieldname]=r.indexes)}else if(r.isRecordingPoints){if("Coordinate"==e.nodeType)for(;null!==(c=s.exec(t));)l={x:parseFloat(c[1]),y:parseFloat(c[2]),z:parseFloat(c[3])},r.points.push(l);if("Normal"==e.nodeType)for(;null!==(c=s.exec(t));)l={x:parseFloat(c[1]),y:parseFloat(c[2]),z:parseFloat(c[3])},r.points.push(l);if("TextureCoordinate"==e.nodeType)for(;null!==(c=a.exec(t));)l={x:parseFloat(c[1]),y:parseFloat(c[2])},r.points.push(l);/]/.exec(t)&&(r.isRecordingPoints=!1,e.points=r.points)}else if(r.isRecordingAngles){if(c.length>0)for(f=0;f<c.length;f++)o.test(c[f])&&r.angles.push(parseFloat(c[f]));/]/.exec(t)&&(r.isRecordingAngles=!1,e[r.recordingFieldname]=r.angles)}else if(r.isRecordingColors){for(;null!==(c=s.exec(t));){var d={r:parseFloat(c[1]),g:parseFloat(c[2]),b:parseFloat(c[3])};r.colors.push(d)}/]/.exec(t)&&(r.isRecordingColors=!1,e[r.recordingFieldname]=r.colors)}else if("NULL"!==c[c.length-1]&&"children"!==i){switch(i){case"diffuseColor":case"emissiveColor":case"specularColor":case"color":if(4!==c.length){console.warn("VRMLLoader: Invalid color format detected for %s.",i);break}h={r:parseFloat(c[1]),g:parseFloat(c[2]),b:parseFloat(c[3])};break;case"location":case"direction":case"translation":case"scale":case"size":if(4!==c.length){console.warn("VRMLLoader: Invalid vector format detected for %s.",i);break}h={x:parseFloat(c[1]),y:parseFloat(c[2]),z:parseFloat(c[3])};break;case"intensity":case"cutOffAngle":case"radius":case"topRadius":case"bottomRadius":case"height":case"transparency":case"shininess":case"ambientIntensity":case"creaseAngle":if(2!==c.length){console.warn("VRMLLoader: Invalid single float value specification detected for %s.",i);break}h=parseFloat(c[1]);break;case"rotation":if(5!==c.length){console.warn("VRMLLoader: Invalid quaternion format detected for %s.",i);break}h={x:parseFloat(c[1]),y:parseFloat(c[2]),z:parseFloat(c[3]),w:parseFloat(c[4])};break;case"on":case"ccw":case"solid":case"colorPerVertex":case"convex":if(2!==c.length){console.warn("VRMLLoader: Invalid format detected for %s.",i);break}h="TRUE"===c[1]}e[i]=h}return h}!function e(r,o){var a;if("string"!==typeof r){a=o,r.string.indexOf("AmbientLight")>-1&&"PointLight"===r.nodeType&&(r.nodeType="AmbientLight");var s=void 0===r.on||r.on,u=void 0!==r.intensity?r.intensity:1,c=new Color;if(r.color&&c.copy(r.color),"AmbientLight"===r.nodeType)(a=new AmbientLight(c,u)).visible=s,o.add(a);else if("PointLight"===r.nodeType){var h=0;void 0!==r.radius&&r.radius<1e3&&(h=r.radius),(a=new PointLight(c,u,h)).visible=s,o.add(a)}else if("SpotLight"===r.nodeType){u=1,h=0;var p=Math.PI/3;s=!0,void 0!==r.radius&&r.radius<1e3&&(h=r.radius),void 0!==r.cutOffAngle&&(p=r.cutOffAngle),(a=new SpotLight(c,u,h,p,0)).visible=s,o.add(a)}else if("Transform"===r.nodeType||"Group"===r.nodeType){if(a=new Object3D,/DEF/.exec(r.string)&&(a.name=/DEF\s+([^\s]+)/.exec(r.string)[1],i[a.name]=a),void 0!==r.translation){var f=r.translation;a.position.set(f.x,f.y,f.z)}if(void 0!==r.rotation){var d=r.rotation;a.quaternion.setFromAxisAngle(new Vector3(d.x,d.y,d.z),d.w)}if(void 0!==r.scale){var m=r.scale;a.scale.set(m.x,m.y,m.z)}o.add(a)}else if("Shape"===r.nodeType)a=new Mesh,/DEF/.exec(r.string)&&(a.name=/DEF\s+([^\s]+)/.exec(r.string)[1],i[a.name]=a),o.add(a);else if("Background"===r.nodeType){var v=2e4,g=new SphereBufferGeometry(v,20,20),y=new MeshBasicMaterial({fog:!1,side:BackSide});if(r.skyColor.length>1)l(g,v,r.skyAngle,r.skyColor,!0),y.vertexColors=VertexColors;else{var b=r.skyColor[0];y.color.setRGB(b.r,b.b,b.g)}if(t.add(new Mesh(g,y)),void 0!==r.groundColor){var x=new SphereBufferGeometry(v=12e3,20,20,0,2*Math.PI,.5*Math.PI,1.5*Math.PI),w=new MeshBasicMaterial({fog:!1,side:BackSide,vertexColors:VertexColors});l(x,v,r.groundAngle,r.groundColor,!1),t.add(new Mesh(x,w))}}else{if(/geometry/.exec(r.string)){if("Box"===r.nodeType)m=r.size,o.geometry=new BoxBufferGeometry(m.x,m.y,m.z);else if("Cylinder"===r.nodeType)o.geometry=new CylinderBufferGeometry(r.radius,r.radius,r.height);else if("Cone"===r.nodeType)o.geometry=new CylinderBufferGeometry(r.topRadius,r.bottomRadius,r.height);else if("Sphere"===r.nodeType)o.geometry=new SphereBufferGeometry(r.radius);else if("IndexedFaceSet"===r.nodeType){var S,M,_,T,A,C,E=new BufferGeometry,L=[],N=[],P=[],O=[];for(Z=0,T=r.children.length;Z<T;Z++){if("TextureCoordinate"===($=r.children[Z]).nodeType&&$.points)for(A=0,C=$.points.length;A<C;A++)_=$.points[A],O.push(_.x,_.y);if("Normal"===$.nodeType&&$.points)for(A=0,C=$.points.length;A<C;A++)M=$.points[A],P.push(M.x,M.y,M.z);if("Color"===$.nodeType&&$.color)for(A=0,C=$.color.length;A<C;A++)b=$.color[A],N.push(b.r,b.g,b.b);if("Coordinate"===$.nodeType){if($.points)for(A=0,C=$.points.length;A<C;A++)S=$.points[A],L.push(S.x,S.y,S.z);if($.string.indexOf("DEF")>-1){var R=/DEF\s+([^\s]+)/.exec($.string)[1];i[R]=L.slice(0)}$.string.indexOf("USE")>-1&&(oe=/USE\s+([^\s]+)/.exec($.string)[1],L=i[oe])}}if(r.coordIndex){var D=function(e,t,r){void 0===t&&(t=!0);var n=[],i=0;for(Z=0,T=e.length;Z<T;Z++)if(!1===r){var o=e[Z];for(A=0,C=o.length;A<C;A++){var a=o[A];n.push(a,a,a)}}else{var s=e[Z];for(i=0;s.length>=3&&i<s.length-2;){var l=s[0],u=s[i+(t?1:2)],c=s[i+(t?2:1)];n.push(l,u,c),i++}}return n},F=r.coordIndex?D(r.coordIndex,r.ccw):[],k=r.normalIndex?D(r.normalIndex,r.ccw):F,I=r.colorIndex?D(r.colorIndex,r.ccw,r.colorPerVertex):[],B=r.texCoordIndex?D(r.texCoordIndex,r.ccw):F,U=[],V=[],j=[],z=[],G=[],W=Object.create(null);for(Z=0;Z<F.length;Z++){var H=[],X=F[Z],q=k[Z],Y=I[Z],K=B[Z];H.push(X.toString(10)),void 0!==q&&H.push(q.toString(10)),void 0!==Y&&H.push(Y.toString(10)),void 0!==K&&H.push(K.toString(10));var Q=H.join(","),J=W[Q];void 0===J&&(J=V.length/3,W[Q]=J,V.push(L[3*X],L[3*X+1],L[3*X+2]),void 0!==q&&P.length>0&&j.push(P[3*q],P[3*q+1],P[3*q+2]),void 0!==Y&&N.length>0&&z.push(N[3*Y],N[3*Y+1],N[3*Y+2]),void 0!==K&&O.length>0&&G.push(O[2*K],O[2*K+1])),U.push(J)}L=V,P=j,N=z,O=G,E.setIndex(U)}else o.parent.remove(o);!1===r.solid&&(o.material.side=DoubleSide),E.solid=r.solid,E.addAttribute("position",new Float32BufferAttribute(L,3)),N.length>0&&(E.addAttribute("color",new Float32BufferAttribute(N,3)),o.material.vertexColors=VertexColors),O.length>0&&E.addAttribute("uv",new Float32BufferAttribute(O,2)),P.length>0?E.addAttribute("normal",new Float32BufferAttribute(P,3)):(E=E.toNonIndexed()).computeVertexNormals(),E.computeBoundingSphere(),/DEF/.exec(r.string)&&(E.name=/DEF ([^\s]+)/.exec(r.string)[1],i[E.name]=E),o.geometry=E}return}if(/appearance/.exec(r.string)){for(var Z=0;Z<r.children.length;Z++){var $;if("Material"===($=r.children[Z]).nodeType){var ee=new MeshPhongMaterial;if(void 0!==$.diffuseColor){var te=$.diffuseColor;ee.color.setRGB(te.r,te.g,te.b)}if(void 0!==$.emissiveColor){var re=$.emissiveColor;ee.emissive.setRGB(re.r,re.g,re.b)}void 0!==$.specularColor&&(m=$.specularColor,ee.specular.setRGB(m.r,m.g,m.b)),void 0!==$.transparency&&(f=$.transparency,ee.opacity=Math.abs(1-f),ee.transparent=!0),/DEF/.exec(r.string)&&(ee.name=/DEF ([^\s]+)/.exec(r.string)[1],i[ee.name]=ee),o.material=ee}if("ImageTexture"===$.nodeType){var ne=/"([^"]+)"/.exec($.children[0]);ne&&(o.material.name=ne[1],o.material.map=n.load(ne[1]))}}return}}Z=0;for(var ie=r.children.length;Z<ie;Z++)e(r.children[Z],a)}else if(/USE/.exec(r)){var oe=/USE\s+?([^\s]+)/.exec(r)[1];void 0==i[oe]?console.warn("VRMLLoader: %s is not defined.",oe):/appearance/.exec(r)&&oe?o.material=i[oe].clone():/geometry/.exec(r)&&oe?(o.geometry=i[oe].clone(),void 0!==i[oe].solid&&!1===i[oe].solid&&(o.geometry.solid=!1,o.material.side=DoubleSide)):oe&&(a=i[oe].clone(),o.add(a))}}(function(e){for(var t,r,n={string:"Scene",children:[]},i=n,o=0;o<e.length;o++){var a="",s=e[o];if(null===/^\s+?$/g.exec(s)&&""!==(s=s.trim())){if(/#/.exec(s)){var l=s.split("#");s=l[0],a=l[1]}if(t=/([^\s]*){1}(?:\s+)?{/.exec(s)){var u={nodeType:t[1],string:s,parent:i,children:[],comment:a};i.children.push(u),i=u,/}/.exec(s)&&(r=/{(.*)}/.exec(s)[1],u.children.push(r),c(i,r),i=i.parent)}else/}/.exec(s)?i=i.parent:""!==s&&(c(i,s),i.children.push(s))}}return n}(e),t)}(o,i),i}};var VRMLoader=function(){function e(e){if(void 0===GLTFLoader)throw new Error("VRMLoader: Import GLTFLoader.");this.manager=void 0!==e?e:DefaultLoadingManager,this.gltfLoader=new GLTFLoader(this.manager)}return e.prototype={constructor:e,crossOrigin:"anonymous",load:function(e,t,r,n){var i=this;this.gltfLoader.load(e,function(e){i.parse(e,t)},r,n)},setCrossOrigin:function(e){return this.glTFLoader.setCrossOrigin(e),this},setPath:function(e){return this.glTFLoader.setPath(e),this},setResourcePath:function(e){return this.glTFLoader.setResourcePath(e),this},setDRACOLoader:function(e){return this.glTFLoader.setDRACOLoader(e),this},parse:function(e,t){e.parser,(e.userData.gltfExtensions||{}).VRM;t(e)}},e}(),VTKLoader=function(e){this.manager=void 0!==e?e:DefaultLoadingManager};function ImmediateRenderObject(e){Object3D.call(this),this.material=e,this.render=function(){}}Object.assign(VTKLoader.prototype,EventDispatcher.prototype,{load:function(e,t,r,n){var i=this,o=new FileLoader(i.manager);o.setPath(i.path),o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){function t(e,t){var r=e.length,n=new Float32Array(r+t.length);return n.set(e),n.set(t,r),n}function r(e,t){var r=e.length,n=new Int32Array(r+t.length);return n.set(e),n.set(t,r),n}function n(e){for(var t="",r=new Uint8Array(e),n=0,i=r.length;i--;)t+=String.fromCharCode(r[n++]);return t}var i=LoaderUtils.decodeText(new Uint8Array(e,0,250)).split("\n");return-1!==i[0].indexOf("xml")?function(e){function n(e){var t,r,n,i,o,a,s="undefined"!==typeof Uint8Array?Uint8Array:Array,l=[],u=[],c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=c.length;for(t=0;t<h;t++)l[t]=c[t];for(t=0;t<h;++t)u[c.charCodeAt(t)]=t;if(u["-".charCodeAt(0)]=62,u["_".charCodeAt(0)]=63,(h=e.length)%4>0)throw new Error("Invalid string. Length must be a multiple of 4");a=new s(3*h/4-(o="="===e[h-2]?2:"="===e[h-1]?1:0)),n=o>0?h-4:h;var p=0;for(t=0,r=0;t<n;t+=4,r+=3)i=u[e.charCodeAt(t)]<<18|u[e.charCodeAt(t+1)]<<12|u[e.charCodeAt(t+2)]<<6|u[e.charCodeAt(t+3)],a[p++]=(16711680&i)>>16,a[p++]=(65280&i)>>8,a[p++]=255&i;return 2===o?(i=u[e.charCodeAt(t)]<<2|u[e.charCodeAt(t+1)]>>4,a[p++]=255&i):1===o&&(i=u[e.charCodeAt(t)]<<10|u[e.charCodeAt(t+1)]<<4|u[e.charCodeAt(t+2)]>>2,a[p++]=i>>8&255,a[p++]=255&i),a}function i(e,i){var o=0;if("UInt64"===a.attributes.header_type?o=8:"UInt32"===a.attributes.header_type&&(o=4),"binary"===e.attributes.format&&i){var s,l,u,c,h,p;if("Float32"===e.attributes.type)var f=new Float32Array;else"Int64"===e.attributes.type&&(f=new Int32Array);l=(s=n(e["#text"]))[0];for(var d=1;d<o-1;d++)l|=s[d]<<d*o;for(c=(l+3)*o,p=c+=c%3>0?3-c%3:0,(h=[]).push(p),u=3*o,d=0;d<l;d++){for(var m=s[d*o+u],v=1;v<o-1;v++)m|=s[d*o+u+v]<<8*v;p+=m,h.push(p)}for(d=0;d<h.length-1;d++)g=(g=new Zlib.Inflate(s.slice(h[d],h[d+1]),{resize:!0,verify:!0}).decompress()).buffer,"Float32"===e.attributes.type?f=t(f,g=new Float32Array(g)):"Int64"===e.attributes.type&&(f=r(f,g=new Int32Array(g)));delete e["#text"],"Int64"===e.attributes.type&&"binary"===e.attributes.format&&(f=f.filter(function(e,t){if(t%2!==1)return!0}))}else{if("binary"!==e.attributes.format||i)if(e["#text"])var g=e["#text"].split(/\s+/).filter(function(e){if(""!==e)return e});else g=new Int32Array(0).buffer;else g=(g=n(e["#text"])).slice(o).buffer;delete e["#text"],"Float32"===e.attributes.type?f=new Float32Array(g):"Int32"===e.attributes.type?f=new Int32Array(g):"Int64"===e.attributes.type&&(f=new Int32Array(g),"binary"===e.attributes.format&&(f=f.filter(function(e,t){if(t%2!==1)return!0})))}return f}var o=null;if(window.DOMParser)try{o=(new DOMParser).parseFromString(e,"text/xml")}catch(B){o=null}else{if(!window.ActiveXObject)throw new Error("Cannot parse xml string!");try{if((o=new ActiveXObject("Microsoft.XMLDOM")).async=!1,!o.loadXML())throw new Error(o.parseError.reason+o.parseError.srcText)}catch(B){o=null}}var a=function e(t){var r={};if(1===t.nodeType){if(t.attributes&&t.attributes.length>0){r.attributes={};for(var n=0;n<t.attributes.length;n++){var i=t.attributes.item(n);r.attributes[i.nodeName]=i.nodeValue.trim()}}}else 3===t.nodeType&&(r=t.nodeValue.trim());if(t.hasChildNodes())for(var o=0;o<t.childNodes.length;o++){var a=t.childNodes.item(o),s=a.nodeName;if("undefined"===typeof r[s])""!==(u=e(a))&&(r[s]=u);else{if("undefined"===typeof r[s].push){var l=r[s];r[s]=[l]}var u;""!==(u=e(a))&&r[s].push(u)}}return r}(o.documentElement),s=[],l=[],u=[];if(a.PolyData){for(var c=a.PolyData.Piece,h=a.attributes.hasOwnProperty("compressor"),p=["PointData","Points","Strips","Polys"],f=0,d=p.length;f<d;){var m=c[p[f]];if(m&&m.DataArray){if("[object Array]"===Object.prototype.toString.call(m.DataArray))var v=m.DataArray;else v=[m.DataArray];for(var g=0,y=v.length;g<y;)"#text"in v[g]&&v[g]["#text"].length>0&&(v[g].text=i(v[g],h)),g++;switch(p[f]){case"PointData":var b=parseInt(c.attributes.NumberOfPoints),x=m.attributes.Normals;if(b>0)for(var w=0,S=v.length;w<S;w++)if(x===v[w].attributes.Name){var M=v[w].attributes.NumberOfComponents;(l=new Float32Array(b*M)).set(v[w].text,0)}break;case"Points":(b=parseInt(c.attributes.NumberOfPoints))>0&&(M=m.DataArray.attributes.NumberOfComponents,(s=new Float32Array(b*M)).set(m.DataArray.text,0));break;case"Strips":var _=parseInt(c.attributes.NumberOfStrips);if(_>0){var T=new Int32Array(m.DataArray[0].text.length),A=new Int32Array(m.DataArray[1].text.length);T.set(m.DataArray[0].text,0),A.set(m.DataArray[1].text,0);var C=_+T.length;u=new Uint32Array(3*C-9*_);var E=0;for(w=0,S=_;w<S;w++){for(var L=[],N=0,P=A[w],O=0;N<P-O;N++)L.push(T[N]),w>0&&(O=A[w-1]);var R=0;for(P=A[w],O=0;R<P-O-2;R++)R%2?(u[E++]=L[R],u[E++]=L[R+2],u[E++]=L[R+1]):(u[E++]=L[R],u[E++]=L[R+1],u[E++]=L[R+2]),w>0&&(O=A[w-1])}}break;case"Polys":var D=parseInt(c.attributes.NumberOfPolys);if(D>0){T=new Int32Array(m.DataArray[0].text.length),A=new Int32Array(m.DataArray[1].text.length),T.set(m.DataArray[0].text,0),A.set(m.DataArray[1].text,0),C=D+T.length,u=new Uint32Array(3*C-9*D),E=0;var F=0;for(w=0,S=D,O=0;w<S;){var k=[];for(N=0,P=A[w];N<P-O;)k.push(T[F++]),N++;for(R=1;R<P-O-1;)u[E++]=k[0],u[E++]=k[R],u[E++]=k[R+1],R++;O=A[++w-1]}}}}f++}var I=new BufferGeometry;return I.setIndex(new BufferAttribute(u,1)),I.addAttribute("position",new BufferAttribute(s,3)),l.length===s.length&&I.addAttribute("normal",new BufferAttribute(l,3)),I}}(n(e)):i[2].includes("ASCII")?function(e){var t,r=[],n=[],i=[],o=[],a=/(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)/g,s=/^(\d+)\s+([\s\d]*)/,l=/^POINTS /,u=/^POLYGONS /,c=/^TRIANGLE_STRIPS /,h=/^POINT_DATA[ ]+(\d+)/,p=/^CELL_DATA[ ]+(\d+)/,f=/^COLOR_SCALARS[ ]+(\w+)[ ]+3/,d=/^NORMALS[ ]+(\w+)[ ]+(\w+)/,m=!1,v=!1,g=!1,y=!1,b=!1,x=!1,w=!1,S=e.split("\n");for(var M in S){var _=S[M];if(m)for(;null!==(t=a.exec(_));){var T=parseFloat(t[1]),A=parseFloat(t[2]),C=parseFloat(t[3]);n.push(T,A,C)}else if(v){if(null!==(t=s.exec(_))){var E=parseInt(t[1]),L=t[2].split(/\s+/);if(E>=3)for(var N=parseInt(L[0]),P=1,O=0;O<E-2;++O)R=parseInt(L[P]),D=parseInt(L[P+1]),r.push(N,R,D),P++}}else if(g){if(null!==(t=s.exec(_))){var R,D;if(E=parseInt(t[1]),L=t[2].split(/\s+/),E>=3)for(O=0;O<E-2;O++)O%2===1?(N=parseInt(L[O]),R=parseInt(L[O+2]),D=parseInt(L[O+1]),r.push(N,R,D)):(N=parseInt(L[O]),R=parseInt(L[O+1]),D=parseInt(L[O+2]),r.push(N,R,D))}}else if(y||b)if(x)for(;null!==(t=a.exec(_));){var F=parseFloat(t[1]),k=parseFloat(t[2]),I=parseFloat(t[3]);i.push(F,k,I)}else if(w)for(;null!==(t=a.exec(_));){var B=parseFloat(t[1]),U=parseFloat(t[2]),V=parseFloat(t[3]);o.push(B,U,V)}null!==u.exec(_)?(v=!0,m=!1,g=!1):null!==l.exec(_)?(v=!1,m=!0,g=!1):null!==c.exec(_)?(v=!1,m=!1,g=!0):null!==h.exec(_)?(y=!0,m=!1,v=!1,g=!1):null!==p.exec(_)?(b=!0,m=!1,v=!1,g=!1):null!==f.exec(_)?(x=!0,w=!1,m=!1,v=!1,g=!1):null!==d.exec(_)&&(w=!0,x=!1,m=!1,v=!1,g=!1)}var j=new BufferGeometry;if(j.setIndex(r),j.addAttribute("position",new Float32BufferAttribute(n,3)),o.length===n.length&&j.addAttribute("normal",new Float32BufferAttribute(o,3)),i.length!==r.length)i.length===n.length&&j.addAttribute("color",new Float32BufferAttribute(i,3));else{var z=(j=j.toNonIndexed()).attributes.position.count/3;if(i.length===3*z){var G=[];for(M=0;M<z;M++)F=i[3*M+0],k=i[3*M+1],I=i[3*M+2],G.push(F,k,I),G.push(F,k,I),G.push(F,k,I);j.addAttribute("color",new Float32BufferAttribute(G,3))}}return j}(n(e)):function(e){var t,r,n,i,o,a,s,l=new Uint8Array(e),u=new DataView(e),c=[],h=[],p=[],f=0;function d(e,t){for(var r=t,n=e[r],i=[];10!==n;)i.push(String.fromCharCode(n)),n=e[++r];return{start:t,end:r,next:r+1,parsedString:i.join("")}}for(;;){if(0===(s=(a=d(l,f)).parsedString).indexOf("POINTS")){for(t=4*(i=parseInt(s.split(" ")[1],10))*3,c=new Float32Array(3*i),r=a.next,n=0;n<i;n++)c[3*n]=u.getFloat32(r,!1),c[3*n+1]=u.getFloat32(r+4,!1),c[3*n+2]=u.getFloat32(r+8,!1),r+=12;a.next=a.next+t+1}else if(0===s.indexOf("TRIANGLE_STRIPS")){var m=parseInt(s.split(" ")[1],10);t=4*(x=parseInt(s.split(" ")[2],10)),p=new Uint32Array(3*x-9*m);var v=0;for(r=a.next,n=0;n<m;n++){var g=u.getInt32(r,!1),y=[];for(r+=4,o=0;o<g;o++)y.push(u.getInt32(r,!1)),r+=4;for(var b=0;b<g-2;b++)b%2?(p[v++]=y[b],p[v++]=y[b+2],p[v++]=y[b+1]):(p[v++]=y[b],p[v++]=y[b+1],p[v++]=y[b+2])}a.next=a.next+t+1}else if(0===s.indexOf("POLYGONS")){var x;for(m=parseInt(s.split(" ")[1],10),t=4*(x=parseInt(s.split(" ")[2],10)),p=new Uint32Array(3*x-9*m),v=0,r=a.next,n=0;n<m;n++){for(g=u.getInt32(r,!1),y=[],r+=4,o=0;o<g;o++)y.push(u.getInt32(r,!1)),r+=4;for(b=1;b<g-1;b++)p[v++]=y[0],p[v++]=y[b],p[v++]=y[b+1]}a.next=a.next+t+1}else if(0===s.indexOf("POINT_DATA")){for(i=parseInt(s.split(" ")[1],10),a=d(l,a.next),t=4*i*3,h=new Float32Array(3*i),r=a.next,n=0;n<i;n++)h[3*n]=u.getFloat32(r,!1),h[3*n+1]=u.getFloat32(r+4,!1),h[3*n+2]=u.getFloat32(r+8,!1),r+=12;a.next=a.next+t}if((f=a.next)>=l.byteLength)break}var w=new BufferGeometry;return w.setIndex(new BufferAttribute(p,1)),w.addAttribute("position",new BufferAttribute(c,3)),h.length===c.length&&w.addAttribute("normal",new BufferAttribute(h,3)),w}(e)}}),ImmediateRenderObject.prototype=Object.create(Object3D.prototype),ImmediateRenderObject.prototype.constructor=ImmediateRenderObject,ImmediateRenderObject.prototype.isImmediateRenderObject=!0;var MarchingCubes=function(e,t,r,n){ImmediateRenderObject.call(this,t);var i=this,o=new Float32Array(36),a=new Float32Array(36),s=new Float32Array(36);function l(e,t,r){return e+(t-e)*r}function u(e,t,r,n,u,c,h,p,f,d){var m=(r-h)/(p-h),v=i.normal_cache;o[t+0]=n+m*i.delta,o[t+1]=u,o[t+2]=c,a[t+0]=l(v[e+0],v[e+3],m),a[t+1]=l(v[e+1],v[e+4],m),a[t+2]=l(v[e+2],v[e+5],m),s[t+0]=l(i.palette[3*f+0],i.palette[3*d+0],m),s[t+1]=l(i.palette[3*f+1],i.palette[3*d+1],m),s[t+2]=l(i.palette[3*f+2],i.palette[3*d+2],m)}function c(e,t,r,n,u,c,h,p,f,d){var m=(r-h)/(p-h),v=i.normal_cache;o[t+0]=n,o[t+1]=u+m*i.delta,o[t+2]=c;var g=e+3*i.yd;a[t+0]=l(v[e+0],v[g+0],m),a[t+1]=l(v[e+1],v[g+1],m),a[t+2]=l(v[e+2],v[g+2],m),s[t+0]=l(i.palette[3*f+0],i.palette[3*d+0],m),s[t+1]=l(i.palette[3*f+1],i.palette[3*d+1],m),s[t+2]=l(i.palette[3*f+2],i.palette[3*d+2],m)}function h(e,t,r,n,u,c,h,p,f,d){var m=(r-h)/(p-h),v=i.normal_cache;o[t+0]=n,o[t+1]=u,o[t+2]=c+m*i.delta;var g=e+3*i.zd;a[t+0]=l(v[e+0],v[g+0],m),a[t+1]=l(v[e+1],v[g+1],m),a[t+2]=l(v[e+2],v[g+2],m),s[t+0]=l(i.palette[3*f+0],i.palette[3*d+0],m),s[t+1]=l(i.palette[3*f+1],i.palette[3*d+1],m),s[t+2]=l(i.palette[3*f+2],i.palette[3*d+2],m)}function p(e){var t=3*e;0===i.normal_cache[t]&&(i.normal_cache[t+0]=i.field[e-1]-i.field[e+1],i.normal_cache[t+1]=i.field[e-i.yd]-i.field[e+i.yd],i.normal_cache[t+2]=i.field[e-i.zd]-i.field[e+i.zd])}function f(e,t,r,n,l,f){var m=n+1,v=n+i.yd,g=n+i.zd,y=m+i.yd,b=m+i.zd,x=n+i.yd+i.zd,w=m+i.yd+i.zd,S=0,M=i.field[n],_=i.field[m],T=i.field[v],A=i.field[y],C=i.field[g],E=i.field[b],L=i.field[x],N=i.field[w];M<l&&(S|=1),_<l&&(S|=2),T<l&&(S|=8),A<l&&(S|=4),C<l&&(S|=16),E<l&&(S|=32),L<l&&(S|=128),N<l&&(S|=64);var P=edgeTable[S];if(0===P)return 0;var O=i.delta,R=e+O,D=t+O,F=r+O;1&P&&(p(n),p(m),u(3*n,0,l,e,t,r,M,_,n,m)),2&P&&(p(m),p(y),c(3*m,3,l,R,t,r,_,A,m,y)),4&P&&(p(v),p(y),u(3*v,6,l,e,D,r,T,A,v,y)),8&P&&(p(n),p(v),c(3*n,9,l,e,t,r,M,T,n,v)),16&P&&(p(g),p(b),u(3*g,12,l,e,t,F,C,E,g,b)),32&P&&(p(b),p(w),c(3*b,15,l,R,t,F,E,N,b,w)),64&P&&(p(x),p(w),u(3*x,18,l,e,D,F,L,N,x,w)),128&P&&(p(g),p(x),c(3*g,21,l,e,t,F,C,L,g,x)),256&P&&(p(n),p(g),h(3*n,24,l,e,t,r,M,C,n,g)),512&P&&(p(m),p(b),h(3*m,27,l,R,t,r,_,E,m,b)),1024&P&&(p(y),p(w),h(3*y,30,l,R,D,r,A,N,y,w)),2048&P&&(p(v),p(x),h(3*v,33,l,e,D,r,T,L,v,x)),S<<=4;for(var k,I,B,U=0,V=0;-1!=triTable[S+V];)I=(k=S+V)+1,B=k+2,d(o,a,s,3*triTable[k],3*triTable[I],3*triTable[B],f),V+=3,U++;return U}function d(e,t,r,n,o,a,s){var l=3*i.count;if(i.positionArray[l+0]=e[n],i.positionArray[l+1]=e[n+1],i.positionArray[l+2]=e[n+2],i.positionArray[l+3]=e[o],i.positionArray[l+4]=e[o+1],i.positionArray[l+5]=e[o+2],i.positionArray[l+6]=e[a],i.positionArray[l+7]=e[a+1],i.positionArray[l+8]=e[a+2],!0===i.material.flatShading){var u=(t[n+0]+t[o+0]+t[a+0])/3,c=(t[n+1]+t[o+1]+t[a+1])/3,h=(t[n+2]+t[o+2]+t[a+2])/3;i.normalArray[l+0]=u,i.normalArray[l+1]=c,i.normalArray[l+2]=h,i.normalArray[l+3]=u,i.normalArray[l+4]=c,i.normalArray[l+5]=h,i.normalArray[l+6]=u,i.normalArray[l+7]=c,i.normalArray[l+8]=h}else i.normalArray[l+0]=t[n+0],i.normalArray[l+1]=t[n+1],i.normalArray[l+2]=t[n+2],i.normalArray[l+3]=t[o+0],i.normalArray[l+4]=t[o+1],i.normalArray[l+5]=t[o+2],i.normalArray[l+6]=t[a+0],i.normalArray[l+7]=t[a+1],i.normalArray[l+8]=t[a+2];if(i.enableUvs){var p=2*i.count;i.uvArray[p+0]=e[n+0],i.uvArray[p+1]=e[n+2],i.uvArray[p+2]=e[o+0],i.uvArray[p+3]=e[o+2],i.uvArray[p+4]=e[a+0],i.uvArray[p+5]=e[a+2]}i.enableColors&&(i.colorArray[l+0]=r[n+0],i.colorArray[l+1]=r[n+1],i.colorArray[l+2]=r[n+2],i.colorArray[l+3]=r[o+0],i.colorArray[l+4]=r[o+1],i.colorArray[l+5]=r[o+2],i.colorArray[l+6]=r[a+0],i.colorArray[l+7]=r[a+1],i.colorArray[l+8]=r[a+2]),i.count+=3,i.count>=i.maxCount-3&&(i.hasPositions=!0,i.hasNormals=!0,i.enableUvs&&(i.hasUvs=!0),i.enableColors&&(i.hasColors=!0),s(i))}function m(e,t,r){var n=new Float32Array(e.length+r);return n.set(e,0),n.set(t.slice(0,r),e.length),n}this.enableUvs=void 0!==r&&r,this.enableColors=void 0!==n&&n,this.init=function(e){this.resolution=e,this.isolation=80,this.size=e,this.size2=this.size*this.size,this.size3=this.size2*this.size,this.halfsize=this.size/2,this.delta=2/this.size,this.yd=this.size,this.zd=this.size2,this.field=new Float32Array(this.size3),this.normal_cache=new Float32Array(3*this.size3),this.palette=new Float32Array(3*this.size3),this.maxCount=4096,this.count=0,this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=new Float32Array(3*this.maxCount),this.normalArray=new Float32Array(3*this.maxCount),this.enableUvs&&(this.uvArray=new Float32Array(2*this.maxCount)),this.enableColors&&(this.colorArray=new Float32Array(3*this.maxCount))},this.begin=function(){this.count=0,this.hasPositions=!1,this.hasNormals=!1,this.hasUvs=!1,this.hasColors=!1},this.end=function(e){if(0!==this.count){for(var t=3*this.count;t<this.positionArray.length;t++)this.positionArray[t]=0;this.hasPositions=!0,this.hasNormals=!0,this.enableUvs&&this.material.map&&(this.hasUvs=!0),this.enableColors&&this.material.vertexColors!==NoColors&&(this.hasColors=!0),e(this)}},this.addBall=function(e,t,r,n,i,o){var a=Math.sign(n);n=Math.abs(n);var s=!(void 0===o||null===o),l=new Color(e,t,r);if(s)try{l=o instanceof Color?o:Array.isArray(o)?new Color(Math.min(Math.abs(o[0]),1),Math.min(Math.abs(o[1]),1),Math.min(Math.abs(o[2]),1)):new Color(o)}catch(O){s=!1,l=new Color(e,t,r)}var u=this.size*Math.sqrt(n/i),c=r*this.size,h=t*this.size,p=e*this.size,f=Math.floor(c-u);f<1&&(f=1);var d=Math.floor(c+u);d>this.size-1&&(d=this.size-1);var m=Math.floor(h-u);m<1&&(m=1);var v=Math.floor(h+u);v>this.size-1&&(v=this.size-1);var g=Math.floor(p-u);g<1&&(g=1);var y,b,x,w,S,M,_,T,A,C,E,L=Math.floor(p+u);for(L>this.size-1&&(L=this.size-1),x=f;x<d;x++)for(S=this.size2*x,A=(T=x/this.size-r)*T,b=m;b<v;b++)for(w=S+this.size*b,C=(_=b/this.size-t)*_,y=g;y<L;y++)if((E=n/(1e-6+(M=y/this.size-e)*M+C+A)-i)>0){this.field[w+y]+=E*a;var N=Math.sqrt((y-p)*(y-p)+(b-h)*(b-h)+(x-c)*(x-c))/u,P=1-N*N*N*(N*(6*N-15)+10);this.palette[3*(w+y)+0]+=l.r*P,this.palette[3*(w+y)+1]+=l.g*P,this.palette[3*(w+y)+2]+=l.b*P}},this.addPlaneX=function(e,t){var r,n,i,o,a,s,l=this.size,u=this.yd,c=this.zd,h=this.field,p=l*Math.sqrt(e/t);for(p>l&&(p=l),r=0;r<p;r++)if((o=e/(1e-4+(a=r/l)*a)-t)>0)for(n=0;n<l;n++)for(s=r+n*u,i=0;i<l;i++)h[c*i+s]+=o},this.addPlaneY=function(e,t){var r,n,i,o,a,s,l,u=this.size,c=this.yd,h=this.zd,p=this.field,f=u*Math.sqrt(e/t);for(f>u&&(f=u),n=0;n<f;n++)if((o=e/(1e-4+(a=n/u)*a)-t)>0)for(s=n*c,r=0;r<u;r++)for(l=s+r,i=0;i<u;i++)p[h*i+l]+=o},this.addPlaneZ=function(e,t){var r,n,i,o,a,s,l,u=this.size,c=this.yd,h=this.zd,p=this.field,f=u*Math.sqrt(e/t);for(f>u&&(f=u),i=0;i<f;i++)if((o=e/(1e-4+(a=i/u)*a)-t)>0)for(s=h*i,n=0;n<u;n++)for(l=s+n*c,r=0;r<u;r++)p[l+r]+=o},this.reset=function(){var e;for(e=0;e<this.size3;e++)this.normal_cache[3*e]=0,this.field[e]=0,this.palette[3*e]=this.palette[3*e+1]=this.palette[3*e+2]=0},this.render=function(e){this.begin();for(var t=this.size-2,r=1;r<t;r++)for(var n=this.size2*r,i=(r-this.halfsize)/this.halfsize,o=1;o<t;o++)for(var a=n+this.size*o,s=(o-this.halfsize)/this.halfsize,l=1;l<t;l++){f((l-this.halfsize)/this.halfsize,s,i,a+l,this.isolation,e)}this.end(e)},this.generateGeometry=function(){return console.warn("MarchingCubes: generateGeometry() now returns BufferGeometry"),this.generateBufferGeometry()},this.generateBufferGeometry=function(){var e=new BufferGeometry,t=new Float32Array,r=new Float32Array,n=new Float32Array,i=new Float32Array,o=this;return this.render(function(e){o.hasPositions&&(t=m(t,e.positionArray,3*e.count)),o.hasNormals&&(r=m(r,e.normalArray,3*e.count)),o.hasColors&&(n=m(n,e.colorArray,3*e.count)),o.hasUvs&&(i=m(i,e.uvArray,2*e.count)),e.count=0}),this.hasPositions&&e.addAttribute("position",new BufferAttribute(t,3)),this.hasNormals&&e.addAttribute("normal",new BufferAttribute(r,3)),this.hasColors&&e.addAttribute("color",new BufferAttribute(n,3)),this.hasUvs&&e.addAttribute("uv",new BufferAttribute(i,2)),e},this.init(e)};MarchingCubes.prototype=Object.create(ImmediateRenderObject.prototype),MarchingCubes.prototype.constructor=MarchingCubes;var edgeTable=new Int32Array([0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,2291,3065,2800,1616,1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,2988,1196,1445,1711,1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0]),triTable=new Int32Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,9,8,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,2,10,0,2,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,8,3,2,10,8,10,9,8,-1,-1,-1,-1,-1,-1,-1,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,8,11,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,11,2,1,9,11,9,8,11,-1,-1,-1,-1,-1,-1,-1,3,10,1,11,10,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,10,1,0,8,10,8,11,10,-1,-1,-1,-1,-1,-1,-1,3,9,0,3,11,9,11,10,9,-1,-1,-1,-1,-1,-1,-1,9,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,7,3,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,1,9,4,7,1,7,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,4,7,3,0,4,1,2,10,-1,-1,-1,-1,-1,-1,-1,9,2,10,9,0,2,8,4,7,-1,-1,-1,-1,-1,-1,-1,2,10,9,2,9,7,2,7,3,7,9,4,-1,-1,-1,-1,8,4,7,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,4,7,11,2,4,2,0,4,-1,-1,-1,-1,-1,-1,-1,9,0,1,8,4,7,2,3,11,-1,-1,-1,-1,-1,-1,-1,4,7,11,9,4,11,9,11,2,9,2,1,-1,-1,-1,-1,3,10,1,3,11,10,7,8,4,-1,-1,-1,-1,-1,-1,-1,1,11,10,1,4,11,1,0,4,7,11,4,-1,-1,-1,-1,4,7,8,9,0,11,9,11,10,11,0,3,-1,-1,-1,-1,4,7,11,4,11,9,9,11,10,-1,-1,-1,-1,-1,-1,-1,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,5,4,1,5,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,5,4,8,3,5,3,1,5,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,10,4,9,5,-1,-1,-1,-1,-1,-1,-1,5,2,10,5,4,2,4,0,2,-1,-1,-1,-1,-1,-1,-1,2,10,5,3,2,5,3,5,4,3,4,8,-1,-1,-1,-1,9,5,4,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,0,8,11,4,9,5,-1,-1,-1,-1,-1,-1,-1,0,5,4,0,1,5,2,3,11,-1,-1,-1,-1,-1,-1,-1,2,1,5,2,5,8,2,8,11,4,8,5,-1,-1,-1,-1,10,3,11,10,1,3,9,5,4,-1,-1,-1,-1,-1,-1,-1,4,9,5,0,8,1,8,10,1,8,11,10,-1,-1,-1,-1,5,4,0,5,0,11,5,11,10,11,0,3,-1,-1,-1,-1,5,4,8,5,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,9,7,8,5,7,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,3,0,9,5,3,5,7,3,-1,-1,-1,-1,-1,-1,-1,0,7,8,0,1,7,1,5,7,-1,-1,-1,-1,-1,-1,-1,1,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,7,8,9,5,7,10,1,2,-1,-1,-1,-1,-1,-1,-1,10,1,2,9,5,0,5,3,0,5,7,3,-1,-1,-1,-1,8,0,2,8,2,5,8,5,7,10,5,2,-1,-1,-1,-1,2,10,5,2,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,7,9,5,7,8,9,3,11,2,-1,-1,-1,-1,-1,-1,-1,9,5,7,9,7,2,9,2,0,2,7,11,-1,-1,-1,-1,2,3,11,0,1,8,1,7,8,1,5,7,-1,-1,-1,-1,11,2,1,11,1,7,7,1,5,-1,-1,-1,-1,-1,-1,-1,9,5,8,8,5,7,10,1,3,10,3,11,-1,-1,-1,-1,5,7,0,5,0,9,7,11,0,1,0,10,11,10,0,-1,11,10,0,11,0,3,10,5,0,8,0,7,5,7,0,-1,11,10,5,7,11,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,0,1,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,1,9,8,5,10,6,-1,-1,-1,-1,-1,-1,-1,1,6,5,2,6,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,6,5,1,2,6,3,0,8,-1,-1,-1,-1,-1,-1,-1,9,6,5,9,0,6,0,2,6,-1,-1,-1,-1,-1,-1,-1,5,9,8,5,8,2,5,2,6,3,2,8,-1,-1,-1,-1,2,3,11,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,0,8,11,2,0,10,6,5,-1,-1,-1,-1,-1,-1,-1,0,1,9,2,3,11,5,10,6,-1,-1,-1,-1,-1,-1,-1,5,10,6,1,9,2,9,11,2,9,8,11,-1,-1,-1,-1,6,3,11,6,5,3,5,1,3,-1,-1,-1,-1,-1,-1,-1,0,8,11,0,11,5,0,5,1,5,11,6,-1,-1,-1,-1,3,11,6,0,3,6,0,6,5,0,5,9,-1,-1,-1,-1,6,5,9,6,9,11,11,9,8,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,4,7,3,6,5,10,-1,-1,-1,-1,-1,-1,-1,1,9,0,5,10,6,8,4,7,-1,-1,-1,-1,-1,-1,-1,10,6,5,1,9,7,1,7,3,7,9,4,-1,-1,-1,-1,6,1,2,6,5,1,4,7,8,-1,-1,-1,-1,-1,-1,-1,1,2,5,5,2,6,3,0,4,3,4,7,-1,-1,-1,-1,8,4,7,9,0,5,0,6,5,0,2,6,-1,-1,-1,-1,7,3,9,7,9,4,3,2,9,5,9,6,2,6,9,-1,3,11,2,7,8,4,10,6,5,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,2,4,2,0,2,7,11,-1,-1,-1,-1,0,1,9,4,7,8,2,3,11,5,10,6,-1,-1,-1,-1,9,2,1,9,11,2,9,4,11,7,11,4,5,10,6,-1,8,4,7,3,11,5,3,5,1,5,11,6,-1,-1,-1,-1,5,1,11,5,11,6,1,0,11,7,11,4,0,4,11,-1,0,5,9,0,6,5,0,3,6,11,6,3,8,4,7,-1,6,5,9,6,9,11,4,7,9,7,11,9,-1,-1,-1,-1,10,4,9,6,4,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,10,6,4,9,10,0,8,3,-1,-1,-1,-1,-1,-1,-1,10,0,1,10,6,0,6,4,0,-1,-1,-1,-1,-1,-1,-1,8,3,1,8,1,6,8,6,4,6,1,10,-1,-1,-1,-1,1,4,9,1,2,4,2,6,4,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,9,2,4,9,2,6,4,-1,-1,-1,-1,0,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,8,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,10,4,9,10,6,4,11,2,3,-1,-1,-1,-1,-1,-1,-1,0,8,2,2,8,11,4,9,10,4,10,6,-1,-1,-1,-1,3,11,2,0,1,6,0,6,4,6,1,10,-1,-1,-1,-1,6,4,1,6,1,10,4,8,1,2,1,11,8,11,1,-1,9,6,4,9,3,6,9,1,3,11,6,3,-1,-1,-1,-1,8,11,1,8,1,0,11,6,1,9,1,4,6,4,1,-1,3,11,6,3,6,0,0,6,4,-1,-1,-1,-1,-1,-1,-1,6,4,8,11,6,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,10,6,7,8,10,8,9,10,-1,-1,-1,-1,-1,-1,-1,0,7,3,0,10,7,0,9,10,6,7,10,-1,-1,-1,-1,10,6,7,1,10,7,1,7,8,1,8,0,-1,-1,-1,-1,10,6,7,10,7,1,1,7,3,-1,-1,-1,-1,-1,-1,-1,1,2,6,1,6,8,1,8,9,8,6,7,-1,-1,-1,-1,2,6,9,2,9,1,6,7,9,0,9,3,7,3,9,-1,7,8,0,7,0,6,6,0,2,-1,-1,-1,-1,-1,-1,-1,7,3,2,6,7,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,11,10,6,8,10,8,9,8,6,7,-1,-1,-1,-1,2,0,7,2,7,11,0,9,7,6,7,10,9,10,7,-1,1,8,0,1,7,8,1,10,7,6,7,10,2,3,11,-1,11,2,1,11,1,7,10,6,1,6,7,1,-1,-1,-1,-1,8,9,6,8,6,7,9,1,6,11,6,3,1,3,6,-1,0,9,1,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,0,7,0,6,3,11,0,11,6,0,-1,-1,-1,-1,7,11,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,1,9,8,3,1,11,7,6,-1,-1,-1,-1,-1,-1,-1,10,1,2,6,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,8,6,11,7,-1,-1,-1,-1,-1,-1,-1,2,9,0,2,10,9,6,11,7,-1,-1,-1,-1,-1,-1,-1,6,11,7,2,10,3,10,8,3,10,9,8,-1,-1,-1,-1,7,2,3,6,2,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,0,8,7,6,0,6,2,0,-1,-1,-1,-1,-1,-1,-1,2,7,6,2,3,7,0,1,9,-1,-1,-1,-1,-1,-1,-1,1,6,2,1,8,6,1,9,8,8,7,6,-1,-1,-1,-1,10,7,6,10,1,7,1,3,7,-1,-1,-1,-1,-1,-1,-1,10,7,6,1,7,10,1,8,7,1,0,8,-1,-1,-1,-1,0,3,7,0,7,10,0,10,9,6,10,7,-1,-1,-1,-1,7,6,10,7,10,8,8,10,9,-1,-1,-1,-1,-1,-1,-1,6,8,4,11,8,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,6,11,3,0,6,0,4,6,-1,-1,-1,-1,-1,-1,-1,8,6,11,8,4,6,9,0,1,-1,-1,-1,-1,-1,-1,-1,9,4,6,9,6,3,9,3,1,11,3,6,-1,-1,-1,-1,6,8,4,6,11,8,2,10,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,11,0,6,11,0,4,6,-1,-1,-1,-1,4,11,8,4,6,11,0,2,9,2,10,9,-1,-1,-1,-1,10,9,3,10,3,2,9,4,3,11,3,6,4,6,3,-1,8,2,3,8,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,0,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,4,2,4,6,4,3,8,-1,-1,-1,-1,1,9,4,1,4,2,2,4,6,-1,-1,-1,-1,-1,-1,-1,8,1,3,8,6,1,8,4,6,6,10,1,-1,-1,-1,-1,10,1,0,10,0,6,6,0,4,-1,-1,-1,-1,-1,-1,-1,4,6,3,4,3,8,6,10,3,0,3,9,10,9,3,-1,10,9,4,6,10,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,5,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,5,11,7,6,-1,-1,-1,-1,-1,-1,-1,5,0,1,5,4,0,7,6,11,-1,-1,-1,-1,-1,-1,-1,11,7,6,8,3,4,3,5,4,3,1,5,-1,-1,-1,-1,9,5,4,10,1,2,7,6,11,-1,-1,-1,-1,-1,-1,-1,6,11,7,1,2,10,0,8,3,4,9,5,-1,-1,-1,-1,7,6,11,5,4,10,4,2,10,4,0,2,-1,-1,-1,-1,3,4,8,3,5,4,3,2,5,10,5,2,11,7,6,-1,7,2,3,7,6,2,5,4,9,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,6,0,6,2,6,8,7,-1,-1,-1,-1,3,6,2,3,7,6,1,5,0,5,4,0,-1,-1,-1,-1,6,2,8,6,8,7,2,1,8,4,8,5,1,5,8,-1,9,5,4,10,1,6,1,7,6,1,3,7,-1,-1,-1,-1,1,6,10,1,7,6,1,0,7,8,7,0,9,5,4,-1,4,0,10,4,10,5,0,3,10,6,10,7,3,7,10,-1,7,6,10,7,10,8,5,4,10,4,8,10,-1,-1,-1,-1,6,9,5,6,11,9,11,8,9,-1,-1,-1,-1,-1,-1,-1,3,6,11,0,6,3,0,5,6,0,9,5,-1,-1,-1,-1,0,11,8,0,5,11,0,1,5,5,6,11,-1,-1,-1,-1,6,11,3,6,3,5,5,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,11,9,11,8,11,5,6,-1,-1,-1,-1,0,11,3,0,6,11,0,9,6,5,6,9,1,2,10,-1,11,8,5,11,5,6,8,0,5,10,5,2,0,2,5,-1,6,11,3,6,3,5,2,10,3,10,5,3,-1,-1,-1,-1,5,8,9,5,2,8,5,6,2,3,8,2,-1,-1,-1,-1,9,5,6,9,6,0,0,6,2,-1,-1,-1,-1,-1,-1,-1,1,5,8,1,8,0,5,6,8,3,8,2,6,2,8,-1,1,5,6,2,1,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,6,1,6,10,3,8,6,5,6,9,8,9,6,-1,10,1,0,10,0,6,9,5,0,5,6,0,-1,-1,-1,-1,0,3,8,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,7,5,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,11,7,5,8,3,0,-1,-1,-1,-1,-1,-1,-1,5,11,7,5,10,11,1,9,0,-1,-1,-1,-1,-1,-1,-1,10,7,5,10,11,7,9,8,1,8,3,1,-1,-1,-1,-1,11,1,2,11,7,1,7,5,1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,7,1,7,5,7,2,11,-1,-1,-1,-1,9,7,5,9,2,7,9,0,2,2,11,7,-1,-1,-1,-1,7,5,2,7,2,11,5,9,2,3,2,8,9,8,2,-1,2,5,10,2,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,8,2,0,8,5,2,8,7,5,10,2,5,-1,-1,-1,-1,9,0,1,5,10,3,5,3,7,3,10,2,-1,-1,-1,-1,9,8,2,9,2,1,8,7,2,10,2,5,7,5,2,-1,1,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,7,0,7,1,1,7,5,-1,-1,-1,-1,-1,-1,-1,9,0,3,9,3,5,5,3,7,-1,-1,-1,-1,-1,-1,-1,9,8,7,5,9,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,8,4,5,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,5,0,4,5,11,0,5,10,11,11,3,0,-1,-1,-1,-1,0,1,9,8,4,10,8,10,11,10,4,5,-1,-1,-1,-1,10,11,4,10,4,5,11,3,4,9,4,1,3,1,4,-1,2,5,1,2,8,5,2,11,8,4,5,8,-1,-1,-1,-1,0,4,11,0,11,3,4,5,11,2,11,1,5,1,11,-1,0,2,5,0,5,9,2,11,5,4,5,8,11,8,5,-1,9,4,5,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,5,10,3,5,2,3,4,5,3,8,4,-1,-1,-1,-1,5,10,2,5,2,4,4,2,0,-1,-1,-1,-1,-1,-1,-1,3,10,2,3,5,10,3,8,5,4,5,8,0,1,9,-1,5,10,2,5,2,4,1,9,2,9,4,2,-1,-1,-1,-1,8,4,5,8,5,3,3,5,1,-1,-1,-1,-1,-1,-1,-1,0,4,5,1,0,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,4,5,8,5,3,9,0,5,0,3,5,-1,-1,-1,-1,9,4,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,11,7,4,9,11,9,10,11,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,7,9,11,7,9,10,11,-1,-1,-1,-1,1,10,11,1,11,4,1,4,0,7,4,11,-1,-1,-1,-1,3,1,4,3,4,8,1,10,4,7,4,11,10,11,4,-1,4,11,7,9,11,4,9,2,11,9,1,2,-1,-1,-1,-1,9,7,4,9,11,7,9,1,11,2,11,1,0,8,3,-1,11,7,4,11,4,2,2,4,0,-1,-1,-1,-1,-1,-1,-1,11,7,4,11,4,2,8,3,4,3,2,4,-1,-1,-1,-1,2,9,10,2,7,9,2,3,7,7,4,9,-1,-1,-1,-1,9,10,7,9,7,4,10,2,7,8,7,0,2,0,7,-1,3,7,10,3,10,2,7,4,10,1,10,0,4,0,10,-1,1,10,2,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,7,1,3,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,0,8,1,8,7,1,-1,-1,-1,-1,4,0,3,7,4,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,8,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,11,9,10,-1,-1,-1,-1,-1,-1,-1,0,1,10,0,10,8,8,10,11,-1,-1,-1,-1,-1,-1,-1,3,1,10,11,3,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,11,1,11,9,9,11,8,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,1,2,9,2,11,9,-1,-1,-1,-1,0,2,11,8,0,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,2,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,10,8,9,-1,-1,-1,-1,-1,-1,-1,9,10,2,0,9,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,0,1,8,1,10,8,-1,-1,-1,-1,1,10,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,8,9,1,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),ColorConverter={setHSV:function(e,t,r,n){return t=_Math.euclideanModulo(t,1),r=_Math.clamp(r,0,1),n=_Math.clamp(n,0,1),e.setHSL(t,r*n/((t=(2-r)*n)<1?t:2-t),.5*t)},getHSV:function(){var e={};return function(t,r){return void 0===r&&(console.warn("ColorConverter: .getHSV() target is now required"),r={h:0,s:0,l:0}),t.getHSL(e),e.s*=e.l<.5?e.l:1-e.l,r.h=e.h,r.s=2*e.s/(e.l+e.s),r.v=e.l+e.s,r}}(),setCMYK:function(e,t,r,n,i){var o=(1-t)*(1-i),a=(1-r)*(1-i),s=(1-n)*(1-i);return e.setRGB(o,a,s)},getCMYK:function(e,t){void 0===t&&(console.warn("ColorConverter: .getCMYK() target is now required"),t={c:0,m:0,y:0,k:0});var r=e.r,n=e.g,i=e.b,o=1-Math.max(r,n,i),a=(1-r-o)/(1-o),s=(1-n-o)/(1-o),l=(1-i-o)/(1-o);return t.c=a,t.m=s,t.y=l,t.k=o,t}},geometry;function CanvasTexture(e,t,r,n,i,o,a,s,l){Texture.call(this,e,t,r,n,i,o,a,s,l),this.needsUpdate=!0}function Sprite(e){if(Object3D.call(this),this.type="Sprite",void 0===geometry){geometry=new BufferGeometry;var t=new InterleavedBuffer(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);geometry.setIndex([0,1,2,0,2,3]),geometry.addAttribute("position",new InterleavedBufferAttribute(t,3,0,!1)),geometry.addAttribute("uv",new InterleavedBufferAttribute(t,2,3,!1))}this.geometry=geometry,this.material=void 0!==e?e:new SpriteMaterial,this.center=new Vector2(.5,.5)}CanvasTexture.prototype=Object.create(Texture.prototype),CanvasTexture.prototype.constructor=CanvasTexture,CanvasTexture.prototype.isCanvasTexture=!0,Sprite.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Sprite,isSprite:!0,raycast:function(){var e=new Vector3,t=new Vector3,r=new Vector3,n=new Vector2,i=new Vector2,o=new Matrix4,a=new Vector3,s=new Vector3,l=new Vector3,u=new Vector2,c=new Vector2,h=new Vector2;function p(e,t,r,a,s,l){n.subVectors(e,r).addScalar(.5).multiply(a),void 0!==s?(i.x=l*n.x-s*n.y,i.y=s*n.x+l*n.y):i.copy(n),e.copy(t),e.x+=i.x,e.y+=i.y,e.applyMatrix4(o)}return function(n,i){t.setFromMatrixScale(this.matrixWorld),o.getInverse(this.modelViewMatrix).premultiply(this.matrixWorld),r.setFromMatrixPosition(this.modelViewMatrix);var f,d,m=this.material.rotation;0!==m&&(d=Math.cos(m),f=Math.sin(m));var v=this.center;p(a.set(-.5,-.5,0),r,v,t,f,d),p(s.set(.5,-.5,0),r,v,t,f,d),p(l.set(.5,.5,0),r,v,t,f,d),u.set(0,0),c.set(1,0),h.set(1,1);var g=n.ray.intersectTriangle(a,s,l,!1,e);if(null!==g||(p(s.set(-.5,.5,0),r,v,t,f,d),c.set(0,1),null!==(g=n.ray.intersectTriangle(a,l,s,!1,e)))){var y=n.ray.origin.distanceTo(e);y<n.near||y>n.far||i.push({distance:y,point:e.clone(),uv:Triangle.getUV(e,a,s,l,u,c,h,new Vector2),face:null,object:this})}}}(),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return Object3D.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this}});var Lut=function(e,t){this.lut=[],this.map=ColorMapKeywords[e],this.n=t,this.mapname=e;for(var r=1/this.n,n=0;n<=1;n+=r)for(var i=0;i<this.map.length-1;i++)if(n>=this.map[i][0]&&n<this.map[i+1][0]){var o=this.map[i][0],a=this.map[i+1][0],s=new Color(16777215).setHex(this.map[i][1]),l=new Color(16777215).setHex(this.map[i+1][1]),u=s.lerp(l,(n-o)/(a-o));this.lut.push(u)}return this.set(this)};Lut.prototype={constructor:Lut,lut:[],map:[],mapname:"rainbow",n:256,minV:0,maxV:1,legend:null,set:function(e){return e instanceof Lut&&this.copy(e),this},setMin:function(e){return this.minV=e,this},setMax:function(e){return this.maxV=e,this},changeNumberOfColors:function(e){return this.n=e,new Lut(this.mapname,this.n)},changeColorMap:function(e){return this.mapname=e,new Lut(this.mapname,this.n)},copy:function(e){return this.lut=e.lut,this.mapname=e.mapname,this.map=e.map,this.n=e.n,this.minV=e.minV,this.maxV=e.maxV,this},getColor:function(e){e<=this.minV?e=this.minV:e>=this.maxV&&(e=this.maxV),e=(e-this.minV)/(this.maxV-this.minV);var t=Math.round(e*this.n);return t==this.n&&(t-=1),this.lut[t]},addColorMap:function(e,t){ColorMapKeywords[e]=t},setLegendOn:function(e){void 0===e&&(e={}),this.legend={},this.legend.layout=e.hasOwnProperty("layout")?e.layout:"vertical",this.legend.position=e.hasOwnProperty("position")?e.position:{x:4,y:0,z:0},this.legend.dimensions=e.hasOwnProperty("dimensions")?e.dimensions:{width:.5,height:3},this.legend.canvas=document.createElement("canvas"),this.legend.canvas.setAttribute("id","legend"),this.legend.canvas.setAttribute("hidden",!0),document.body.appendChild(this.legend.canvas),this.legend.ctx=this.legend.canvas.getContext("2d"),this.legend.canvas.setAttribute("width",1),this.legend.canvas.setAttribute("height",this.n),this.legend.texture=new Texture(this.legend.canvas);var t=this.legend.ctx.getImageData(0,0,1,this.n),r=t.data;this.map=ColorMapKeywords[this.mapname];for(var n=0,i=1/this.n,o=1;o>=0;o-=i)for(var a=this.map.length-1;a>=0;a--)if(o<this.map[a][0]&&o>=this.map[a-1][0]){var s=this.map[a-1][0],l=this.map[a][0],u=new Color(16777215).setHex(this.map[a-1][1]),c=new Color(16777215).setHex(this.map[a][1]),h=u.lerp(c,(o-s)/(l-s));r[4*n]=Math.round(255*h.r),r[4*n+1]=Math.round(255*h.g),r[4*n+2]=Math.round(255*h.b),r[4*n+3]=255,n+=1}return this.legend.ctx.putImageData(t,0,0),this.legend.texture.needsUpdate=!0,this.legend.legendGeometry=new PlaneBufferGeometry(this.legend.dimensions.width,this.legend.dimensions.height),this.legend.legendMaterial=new MeshBasicMaterial({map:this.legend.texture,side:DoubleSide}),this.legend.mesh=new Mesh(this.legend.legendGeometry,this.legend.legendMaterial),"horizontal"==this.legend.layout&&(this.legend.mesh.rotation.z=Math.PI/180*-90),this.legend.mesh.position.copy(this.legend.position),this.legend.mesh},setLegendOff:function(){return this.legend=null,this.legend},setLegendLayout:function(e){return!!this.legend&&(this.legend.layout!=e&&(("horizontal"==e||"vertical"==e)&&(this.layout=e,"horizontal"==e&&(this.legend.mesh.rotation.z=Math.PI/180*90),"vertical"==e&&(this.legend.mesh.rotation.z=Math.PI/180*-90),this.legend.mesh)))},setLegendPosition:function(e){return this.legend.position=new Vector3(e.x,e.y,e.z),this.legend},setLegendLabels:function(e,t){if(!this.legend)return!1;"function"===typeof e&&(t=e),void 0===e&&(e={}),this.legend.labels={},this.legend.labels.fontsize=e.hasOwnProperty("fontsize")?e.fontsize:24,this.legend.labels.fontface=e.hasOwnProperty("fontface")?e.fontface:"Arial",this.legend.labels.title=e.hasOwnProperty("title")?e.title:"",this.legend.labels.um=e.hasOwnProperty("um")?" [ "+e.um+" ]":"",this.legend.labels.ticks=e.hasOwnProperty("ticks")?e.ticks:0,this.legend.labels.decimal=e.hasOwnProperty("decimal")?e.decimal:2,this.legend.labels.notation=e.hasOwnProperty("notation")?e.notation:"standard";var r=255,n=100,i=100,o=.8,a=255,s=0,l=0,u=1,c=document.createElement("canvas"),h=c.getContext("2d");h.font="Normal "+1.2*this.legend.labels.fontsize+"px "+this.legend.labels.fontface,h.fillStyle="rgba("+r+","+n+","+i+","+o+")",h.strokeStyle="rgba("+a+","+s+","+l+","+u+")",h.lineWidth=4,h.fillStyle="rgba( 0, 0, 0, 1.0 )",h.fillText(this.legend.labels.title.toString()+this.legend.labels.um.toString(),4,this.legend.labels.fontsize+4);var p=new CanvasTexture(c);p.minFilter=LinearFilter;var f=new Sprite(new SpriteMaterial({map:p}));if(f.scale.set(2,1,1),"vertical"==this.legend.layout&&f.position.set(this.legend.position.x+this.legend.dimensions.width,this.legend.position.y+.45*this.legend.dimensions.height,this.legend.position.z),"horizontal"==this.legend.layout&&f.position.set(1.015*this.legend.position.x,this.legend.position.y+.03*this.legend.dimensions.height,this.legend.position.z),this.legend.labels.ticks>0){var d={},m={};if("vertical"==this.legend.layout)var v=this.legend.position.y+.36*this.legend.dimensions.height,g=this.legend.position.y-.61*this.legend.dimensions.height;if("horizontal"==this.legend.layout)var y=this.legend.position.x+.75*this.legend.dimensions.height,b=this.legend.position.x-1.2*this.legend.dimensions.width;for(var x=0;x<this.legend.labels.ticks;x++){var w=(this.maxV-this.minV)/(this.legend.labels.ticks-1)*x+this.minV;w=t?t(w):"scientific"==this.legend.labels.notation?w.toExponential(this.legend.labels.decimal):w.toFixed(this.legend.labels.decimal);var S=document.createElement("canvas"),M=S.getContext("2d");M.font="Normal "+this.legend.labels.fontsize+"px "+this.legend.labels.fontface,M.fillStyle="rgba("+r+","+n+","+i+","+o+")",M.strokeStyle="rgba("+a+","+s+","+l+","+u+")",M.lineWidth=4,M.fillStyle="rgba( 0, 0, 0, 1.0 )",M.fillText(w.toString(),4,this.legend.labels.fontsize+4);var _=new CanvasTexture(S);_.minFilter=LinearFilter;var T=new Sprite(new SpriteMaterial({map:_}));if(T.scale.set(2,1,1),"vertical"==this.legend.layout){var A=g+(v-g)*((w-this.minV)/(this.maxV-this.minV));T.position.set(this.legend.position.x+2.7*this.legend.dimensions.width,A,this.legend.position.z)}if("horizontal"==this.legend.layout){A=b+(y-b)*((w-this.minV)/(this.maxV-this.minV));if(this.legend.labels.ticks>5)if(x%2===0)var C=1.7;else C=2.1;else C=1.7;T.position.set(A,this.legend.position.y-this.legend.dimensions.width*C,this.legend.position.z)}var E=new LineBasicMaterial({color:0,linewidth:2}),L=[];if("vertical"==this.legend.layout){var N=this.legend.position.y-.5*this.legend.dimensions.height+.01+this.legend.dimensions.height*((w-this.minV)/(this.maxV-this.minV)*.99);L.push(new Vector3(this.legend.position.x+.55*this.legend.dimensions.width,N,this.legend.position.z)),L.push(new Vector3(this.legend.position.x+.7*this.legend.dimensions.width,N,this.legend.position.z))}if("horizontal"==this.legend.layout){N=this.legend.position.x-.5*this.legend.dimensions.height+.01+this.legend.dimensions.height*((w-this.minV)/(this.maxV-this.minV)*.99);L.push(new Vector3(N,this.legend.position.y-.55*this.legend.dimensions.width,this.legend.position.z)),L.push(new Vector3(N,this.legend.position.y-.7*this.legend.dimensions.width,this.legend.position.z))}var P=new Line((new BufferGeometry).setFromPoints(L),E);m[x]=P,d[x]=T}}return{title:f,ticks:d,lines:m}}};var ColorMapKeywords={rainbow:[[0,"0x0000FF"],[.2,"0x00FFFF"],[.5,"0x00FF00"],[.8,"0xFFFF00"],[1,"0xFF0000"]],cooltowarm:[[0,"0x3C4EC2"],[.2,"0x9BBCFF"],[.5,"0xDCDCDC"],[.8,"0xF6A385"],[1,"0xB40426"]],blackbody:[[0,"0x000000"],[.2,"0x780000"],[.5,"0xE63200"],[.8,"0xFFFF00"],[1,"0xFFFFFF"]],grayscale:[[0,"0x000000"],[.2,"0x404040"],[.5,"0x7F7F80"],[.8,"0xBFBFBF"],[1,"0xFFFFFF"]]},MD2Character=function(){var e=this;function t(e,t){for(var r=new TextureLoader,i=[],o=0;o<t.length;o++)i[o]=r.load(e+t[o],n),i[o].mapping=UVMapping,i[o].name=t[o];return i}function r(e,t){var r=new MeshLambertMaterial({color:16755200,wireframe:!0,morphTargets:!0,morphNormals:!0}),n=new MeshLambertMaterial({color:16777215,wireframe:!1,map:t,morphTargets:!0,morphNormals:!0}),i=new Mesh(e,n);return i.rotation.y=-Math.PI/2,i.castShadow=!0,i.receiveShadow=!0,i.materialTexture=n,i.materialWireframe=r,i}function n(){e.loadCounter-=1,0===e.loadCounter&&e.onLoadComplete()}this.scale=1,this.animationFPS=6,this.root=new Object3D,this.meshBody=null,this.meshWeapon=null,this.skinsBody=[],this.skinsWeapon=[],this.weapons=[],this.activeAnimation=null,this.mixer=null,this.onLoadComplete=function(){},this.loadCounter=0,this.loadParts=function(i){this.loadCounter=2*i.weapons.length+i.skins.length+1;for(var o=[],a=0;a<i.weapons.length;a++)o[a]=i.weapons[a][1];this.skinsBody=t(i.baseUrl+"skins/",i.skins),this.skinsWeapon=t(i.baseUrl+"skins/",o);var s=new MD2Loader;s.load(i.baseUrl+i.body,function(t){t.computeBoundingBox(),e.root.position.y=-e.scale*t.boundingBox.min.y;var i=r(t,e.skinsBody[0]);i.scale.set(e.scale,e.scale,e.scale),e.root.add(i),e.meshBody=i,e.meshBody.clipOffset=0,e.activeAnimationClipName=i.geometry.animations[0].name,e.mixer=new AnimationMixer(i),n()});var l=function(t,i){return function(o){var a=r(o,e.skinsWeapon[t]);a.scale.set(e.scale,e.scale,e.scale),a.visible=!1,a.name=i,e.root.add(a),e.weapons[t]=a,e.meshWeapon=a,n()}};for(a=0;a<i.weapons.length;a++)s.load(i.baseUrl+i.weapons[a][0],l(a,i.weapons[a][0]))},this.setPlaybackRate=function(e){this.mixer.timeScale=0!==e?1/e:0},this.setWireframe=function(e){e?(this.meshBody&&(this.meshBody.material=this.meshBody.materialWireframe),this.meshWeapon&&(this.meshWeapon.material=this.meshWeapon.materialWireframe)):(this.meshBody&&(this.meshBody.material=this.meshBody.materialTexture),this.meshWeapon&&(this.meshWeapon.material=this.meshWeapon.materialTexture))},this.setSkin=function(e){this.meshBody&&!1===this.meshBody.material.wireframe&&(this.meshBody.material.map=this.skinsBody[e])},this.setWeapon=function(t){for(var r=0;r<this.weapons.length;r++)this.weapons[r].visible=!1;var n=this.weapons[t];n&&(n.visible=!0,this.meshWeapon=n,e.syncWeaponAnimation())},this.setAnimation=function(t){if(this.meshBody){this.meshBody.activeAction&&(this.meshBody.activeAction.stop(),this.meshBody.activeAction=null);var r=this.mixer.clipAction(t,this.meshBody);r&&(this.meshBody.activeAction=r.play())}e.activeClipName=t,e.syncWeaponAnimation()},this.syncWeaponAnimation=function(){var t=e.activeClipName;if(e.meshWeapon){this.meshWeapon.activeAction&&(this.meshWeapon.activeAction.stop(),this.meshWeapon.activeAction=null);var r=this.mixer.clipAction(t,this.meshWeapon);r&&(this.meshWeapon.activeAction=r.syncWith(this.meshBody.activeAction).play())}},this.update=function(e){this.mixer&&this.mixer.update(e)}},MorphBlendMesh=function(e,t){Mesh.call(this,e,t),this.animationsMap={},this.animationsList=[];var r=Object.keys(this.morphTargetDictionary).length,n=r-1,i=r/1;this.createAnimation("__default",0,n,i),this.setAnimationWeight("__default",1)};MorphBlendMesh.prototype=Object.assign(Object.create(Mesh.prototype),{constructor:MorphBlendMesh,createAnimation:function(e,t,r,n){var i={start:t,end:r,length:r-t+1,fps:n,duration:(r-t)/n,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[e]=i,this.animationsList.push(i)},autoCreateAnimations:function(e){var t,r=/([a-z]+)_?(\d+)/i,n={},i=0;for(var o in this.morphTargetDictionary){var a=o.match(r);if(a&&a.length>1)n[s=a[1]]||(n[s]={start:1/0,end:-1/0}),i<(l=n[s]).start&&(l.start=i),i>l.end&&(l.end=i),t||(t=s);i++}for(var s in n){var l=n[s];this.createAnimation(s,l.start,l.end,e)}this.firstAnimation=t},setAnimationDirectionForward:function(e){var t=this.animationsMap[e];t&&(t.direction=1,t.directionBackwards=!1)},setAnimationDirectionBackward:function(e){var t=this.animationsMap[e];t&&(t.direction=-1,t.directionBackwards=!0)},setAnimationFPS:function(e,t){var r=this.animationsMap[e];r&&(r.fps=t,r.duration=(r.end-r.start)/r.fps)},setAnimationDuration:function(e,t){var r=this.animationsMap[e];r&&(r.duration=t,r.fps=(r.end-r.start)/r.duration)},setAnimationWeight:function(e,t){var r=this.animationsMap[e];r&&(r.weight=t)},setAnimationTime:function(e,t){var r=this.animationsMap[e];r&&(r.time=t)},getAnimationTime:function(e){var t=0,r=this.animationsMap[e];return r&&(t=r.time),t},getAnimationDuration:function(e){var t=-1,r=this.animationsMap[e];return r&&(t=r.duration),t},playAnimation:function(e){var t=this.animationsMap[e];t?(t.time=0,t.active=!0):console.warn("MorphBlendMesh: animation["+e+"] undefined in .playAnimation()")},stopAnimation:function(e){var t=this.animationsMap[e];t&&(t.active=!1)},update:function(e){for(var t=0,r=this.animationsList.length;t<r;t++){var n=this.animationsList[t];if(n.active){var i=n.duration/n.length;n.time+=n.direction*e,n.mirroredLoop?(n.time>n.duration||n.time<0)&&(n.direction*=-1,n.time>n.duration&&(n.time=n.duration,n.directionBackwards=!0),n.time<0&&(n.time=0,n.directionBackwards=!1)):(n.time=n.time%n.duration,n.time<0&&(n.time+=n.duration));var o=n.start+_Math.clamp(Math.floor(n.time/i),0,n.length-1),a=n.weight;o!==n.currentFrame&&(this.morphTargetInfluences[n.lastFrame]=0,this.morphTargetInfluences[n.currentFrame]=1*a,this.morphTargetInfluences[o]=0,n.lastFrame=n.currentFrame,n.currentFrame=o);var s=n.time%i/i;n.directionBackwards&&(s=1-s),n.currentFrame!==n.lastFrame?(this.morphTargetInfluences[n.currentFrame]=s*a,this.morphTargetInfluences[n.lastFrame]=(1-s)*a):this.morphTargetInfluences[n.currentFrame]=a}}}});var MD2CharacterComplex=function(){var e=this;function t(e,t){for(var r=new TextureLoader,i=[],o=0;o<t.length;o++)i[o]=r.load(e+t[o],n),i[o].mapping=UVMapping,i[o].name=t[o];return i}function r(t,r){var n=new MeshLambertMaterial({color:16755200,wireframe:!0,morphTargets:!0,morphNormals:!0}),i=new MeshLambertMaterial({color:16777215,wireframe:!1,map:r,morphTargets:!0,morphNormals:!0}),o=new MorphBlendMesh(t,i);return o.rotation.y=-Math.PI/2,o.materialTexture=i,o.materialWireframe=n,o.autoCreateAnimations(e.animationFPS),o}function n(){e.loadCounter-=1,0===e.loadCounter&&e.onLoadComplete()}function i(e){return 1===e?1:1-Math.pow(2,-10*e)}this.scale=1,this.animationFPS=6,this.transitionFrames=15,this.maxSpeed=275,this.maxReverseSpeed=-275,this.frontAcceleration=600,this.backAcceleration=600,this.frontDecceleration=600,this.angularSpeed=2.5,this.root=new Object3D,this.meshBody=null,this.meshWeapon=null,this.controls=null,this.skinsBody=[],this.skinsWeapon=[],this.weapons=[],this.currentSkin=void 0,this.onLoadComplete=function(){},this.meshes=[],this.animations={},this.loadCounter=0,this.speed=0,this.bodyOrientation=0,this.walkSpeed=this.maxSpeed,this.crouchSpeed=.5*this.maxSpeed,this.activeAnimation=null,this.oldAnimation=null,this.enableShadows=function(e){for(var t=0;t<this.meshes.length;t++)this.meshes[t].castShadow=e,this.meshes[t].receiveShadow=e},this.setVisible=function(e){for(var t=0;t<this.meshes.length;t++)this.meshes[t].visible=e,this.meshes[t].visible=e},this.shareParts=function(e){this.animations=e.animations,this.walkSpeed=e.walkSpeed,this.crouchSpeed=e.crouchSpeed,this.skinsBody=e.skinsBody,this.skinsWeapon=e.skinsWeapon;var t=r(e.meshBody.geometry,this.skinsBody[0]);t.scale.set(this.scale,this.scale,this.scale),this.root.position.y=e.root.position.y,this.root.add(t),this.meshBody=t,this.meshes.push(t);for(var n=0;n<e.weapons.length;n++){var i=r(e.weapons[n].geometry,this.skinsWeapon[n]);i.scale.set(this.scale,this.scale,this.scale),i.visible=!1,i.name=e.weapons[n].name,this.root.add(i),this.weapons[n]=i,this.meshWeapon=i,this.meshes.push(i)}},this.loadParts=function(i){this.animations=i.animations,this.walkSpeed=i.walkSpeed,this.crouchSpeed=i.crouchSpeed,this.loadCounter=2*i.weapons.length+i.skins.length+1;for(var o=[],a=0;a<i.weapons.length;a++)o[a]=i.weapons[a][1];this.skinsBody=t(i.baseUrl+"skins/",i.skins),this.skinsWeapon=t(i.baseUrl+"skins/",o);var s=new MD2Loader;s.load(i.baseUrl+i.body,function(t){t.computeBoundingBox(),e.root.position.y=-e.scale*t.boundingBox.min.y;var i=r(t,e.skinsBody[0]);i.scale.set(e.scale,e.scale,e.scale),e.root.add(i),e.meshBody=i,e.meshes.push(i),n()});var l=function(t,i){return function(o){var a=r(o,e.skinsWeapon[t]);a.scale.set(e.scale,e.scale,e.scale),a.visible=!1,a.name=i,e.root.add(a),e.weapons[t]=a,e.meshWeapon=a,e.meshes.push(a),n()}};for(a=0;a<i.weapons.length;a++)s.load(i.baseUrl+i.weapons[a][0],l(a,i.weapons[a][0]))},this.setPlaybackRate=function(e){this.meshBody&&(this.meshBody.duration=this.meshBody.baseDuration/e),this.meshWeapon&&(this.meshWeapon.duration=this.meshWeapon.baseDuration/e)},this.setWireframe=function(e){e?(this.meshBody&&(this.meshBody.material=this.meshBody.materialWireframe),this.meshWeapon&&(this.meshWeapon.material=this.meshWeapon.materialWireframe)):(this.meshBody&&(this.meshBody.material=this.meshBody.materialTexture),this.meshWeapon&&(this.meshWeapon.material=this.meshWeapon.materialTexture))},this.setSkin=function(e){this.meshBody&&!1===this.meshBody.material.wireframe&&(this.meshBody.material.map=this.skinsBody[e],this.currentSkin=e)},this.setWeapon=function(e){for(var t=0;t<this.weapons.length;t++)this.weapons[t].visible=!1;var r=this.weapons[e];r&&(r.visible=!0,this.meshWeapon=r,this.activeAnimation&&(r.playAnimation(this.activeAnimation),this.meshWeapon.setAnimationTime(this.activeAnimation,this.meshBody.getAnimationTime(this.activeAnimation))))},this.setAnimation=function(e){e!==this.activeAnimation&&e&&(this.meshBody&&(this.meshBody.setAnimationWeight(e,0),this.meshBody.playAnimation(e),this.oldAnimation=this.activeAnimation,this.activeAnimation=e,this.blendCounter=this.transitionFrames),this.meshWeapon&&(this.meshWeapon.setAnimationWeight(e,0),this.meshWeapon.playAnimation(e)))},this.update=function(e){this.controls&&this.updateMovementModel(e),this.animations&&(this.updateBehaviors(e),this.updateAnimations(e))},this.updateAnimations=function(e){var t=1;this.blendCounter>0&&(t=(this.transitionFrames-this.blendCounter)/this.transitionFrames,this.blendCounter-=1),this.meshBody&&(this.meshBody.update(e),this.meshBody.setAnimationWeight(this.activeAnimation,t),this.meshBody.setAnimationWeight(this.oldAnimation,1-t)),this.meshWeapon&&(this.meshWeapon.update(e),this.meshWeapon.setAnimationWeight(this.activeAnimation,t),this.meshWeapon.setAnimationWeight(this.oldAnimation,1-t))},this.updateBehaviors=function(e){var t,r,n=this.controls,i=this.animations;n.crouch?(t=i.crouchMove,r=i.crouchIdle):(t=i.move,r=i.idle),n.jump&&(t=i.jump,r=i.jump),n.attack&&(n.crouch?(t=i.crouchAttack,r=i.crouchAttack):(t=i.attack,r=i.attack)),(n.moveForward||n.moveBackward||n.moveLeft||n.moveRight)&&this.activeAnimation!==t&&this.setAnimation(t),Math.abs(this.speed)<.2*this.maxSpeed&&!(n.moveLeft||n.moveRight||n.moveForward||n.moveBackward)&&this.activeAnimation!==r&&this.setAnimation(r),n.moveForward&&(this.meshBody&&(this.meshBody.setAnimationDirectionForward(this.activeAnimation),this.meshBody.setAnimationDirectionForward(this.oldAnimation)),this.meshWeapon&&(this.meshWeapon.setAnimationDirectionForward(this.activeAnimation),this.meshWeapon.setAnimationDirectionForward(this.oldAnimation))),n.moveBackward&&(this.meshBody&&(this.meshBody.setAnimationDirectionBackward(this.activeAnimation),this.meshBody.setAnimationDirectionBackward(this.oldAnimation)),this.meshWeapon&&(this.meshWeapon.setAnimationDirectionBackward(this.activeAnimation),this.meshWeapon.setAnimationDirectionBackward(this.oldAnimation)))},this.updateMovementModel=function(e){var t=this.controls;t.crouch?this.maxSpeed=this.crouchSpeed:this.maxSpeed=this.walkSpeed,this.maxReverseSpeed=-this.maxSpeed,t.moveForward&&(this.speed=_Math.clamp(this.speed+e*this.frontAcceleration,this.maxReverseSpeed,this.maxSpeed)),t.moveBackward&&(this.speed=_Math.clamp(this.speed-e*this.backAcceleration,this.maxReverseSpeed,this.maxSpeed));if(t.moveLeft&&(this.bodyOrientation+=e*this.angularSpeed,this.speed=_Math.clamp(this.speed+1*e*this.frontAcceleration,this.maxReverseSpeed,this.maxSpeed)),t.moveRight&&(this.bodyOrientation-=e*this.angularSpeed,this.speed=_Math.clamp(this.speed+1*e*this.frontAcceleration,this.maxReverseSpeed,this.maxSpeed)),!t.moveForward&&!t.moveBackward)if(this.speed>0){var r=i(this.speed/this.maxSpeed);this.speed=_Math.clamp(this.speed-r*e*this.frontDecceleration,0,this.maxSpeed)}else{r=i(this.speed/this.maxReverseSpeed);this.speed=_Math.clamp(this.speed+r*e*this.backAcceleration,this.maxReverseSpeed,0)}var n=this.speed*e;this.root.position.x+=Math.sin(this.bodyOrientation)*n,this.root.position.z+=Math.cos(this.bodyOrientation)*n,this.root.rotation.y=this.bodyOrientation}},ExplodeModifier=function(){};ExplodeModifier.prototype.modify=function(e){for(var t=[],r=0,n=e.faces.length;r<n;r++){var i=t.length,o=e.faces[r],a=o.a,s=o.b,l=o.c,u=e.vertices[a],c=e.vertices[s],h=e.vertices[l];t.push(u.clone()),t.push(c.clone()),t.push(h.clone()),o.a=i,o.b=i+1,o.c=i+2}e.vertices=t};var SimplifyModifier=function(){};!function(){var e=new Vector3,t=new Vector3;function r(e,t){var r=e.indexOf(t);r>-1&&e.splice(r,1)}function n(e,t){var r,n,i,o=t.position.distanceTo(e.position),a=0,s=[],l=e.faces.length;for(r=0;r<l;r++)(n=e.faces[r]).hasVertex(t)&&s.push(n);for(r=0;r<l;r++){var u=1;n=e.faces[r];for(var c=0;c<s.length;c++){i=s[c];var h=n.normal.dot(i.normal);u=Math.min(u,(1.001-h)/2)}a=Math.max(a,u)}return s.length<2&&(a=1),o*a+0}function i(e){if(0===e.neighbors.length)return e.collapseNeighbor=null,void(e.collapseCost=-.01);e.collapseCost=1e5,e.collapseNeighbor=null;for(var t=0;t<e.neighbors.length;t++){var r=n(e,e.neighbors[t]);e.collapseNeighbor||(e.collapseNeighbor=e.neighbors[t],e.collapseCost=r,e.minCost=r,e.totalCost=0,e.costCount=0),e.costCount++,e.totalCost+=r,r<e.minCost&&(e.collapseNeighbor=e.neighbors[t],e.minCost=r)}e.collapseCost=e.totalCost/e.costCount}function o(e,t){for(console.assert(0===e.faces.length);e.neighbors.length;){r(e.neighbors.pop().neighbors,e)}r(t,e)}function a(e,t){r(t,e),e.v1&&r(e.v1.faces,e),e.v2&&r(e.v2.faces,e),e.v3&&r(e.v3.faces,e);for(var n,i,o=[e.v1,e.v2,e.v3],a=0;a<3;a++)i=o[(a+1)%3],(n=o[a])&&i&&(n.removeIfNonNeighbor(i),i.removeIfNonNeighbor(n))}function s(e,t,r,n){if(n){var s,l=[];for(s=0;s<r.neighbors.length;s++)l.push(r.neighbors[s]);for(s=r.faces.length-1;s>=0;s--)r.faces[s].hasVertex(n)&&a(r.faces[s],t);for(s=r.faces.length-1;s>=0;s--)r.faces[s].replaceVertex(r,n);for(o(r,e),s=0;s<l.length;s++)i(l[s])}else o(r,e)}function l(e){for(var t=e[0],r=0;r<e.length;r++)e[r].collapseCost<t.collapseCost&&(t=e[r]);return t}function u(e,t,r,n,i,o){this.a=n,this.b=i,this.c=o,this.v1=e,this.v2=t,this.v3=r,this.normal=new Vector3,this.computeNormal(),e.faces.push(this),e.addUniqueNeighbor(t),e.addUniqueNeighbor(r),t.faces.push(this),t.addUniqueNeighbor(e),t.addUniqueNeighbor(r),r.faces.push(this),r.addUniqueNeighbor(e),r.addUniqueNeighbor(t)}function c(e,t){this.position=e,this.id=t,this.faces=[],this.neighbors=[],this.collapseCost=0,this.collapseNeighbor=null}u.prototype.computeNormal=function(){var r=this.v1.position,n=this.v2.position,i=this.v3.position;e.subVectors(i,n),t.subVectors(r,n),e.cross(t).normalize(),this.normal.copy(e)},u.prototype.hasVertex=function(e){return e===this.v1||e===this.v2||e===this.v3},u.prototype.replaceVertex=function(e,t){e===this.v1?this.v1=t:e===this.v2?this.v2=t:e===this.v3&&(this.v3=t),r(e.faces,this),t.faces.push(this),e.removeIfNonNeighbor(this.v1),this.v1.removeIfNonNeighbor(e),e.removeIfNonNeighbor(this.v2),this.v2.removeIfNonNeighbor(e),e.removeIfNonNeighbor(this.v3),this.v3.removeIfNonNeighbor(e),this.v1.addUniqueNeighbor(this.v2),this.v1.addUniqueNeighbor(this.v3),this.v2.addUniqueNeighbor(this.v1),this.v2.addUniqueNeighbor(this.v3),this.v3.addUniqueNeighbor(this.v1),this.v3.addUniqueNeighbor(this.v2),this.computeNormal()},c.prototype.addUniqueNeighbor=function(e){var t,r;t=this.neighbors,r=e,-1===t.indexOf(r)&&t.push(r)},c.prototype.removeIfNonNeighbor=function(e){var t=this.neighbors,r=this.faces,n=t.indexOf(e);if(-1!==n){for(var i=0;i<r.length;i++)if(r[i].hasVertex(e))return;t.splice(n,1)}},SimplifyModifier.prototype.modify=function(e,t){e.isBufferGeometry&&(e=(new Geometry).fromBufferGeometry(e)),e.mergeVertices();var r,n,o,a=e.vertices,h=e.faces,p=[],f=[];for(r=0,n=a.length;r<n;r++){var d=new c(a[r],r);p.push(d)}for(r=0,n=h.length;r<n;r++){var m=(M=h[r]).a,v=M.b,g=M.c,y=new u(p[m],p[v],p[g],m,v,g);f.push(y)}for(r=0,n=p.length;r<n;r++)i(p[r]);for(var b=t;b--;){if(!(o=l(p))){console.log("SimplifyModifier: No next vertex");break}s(p,f,o,o.collapseNeighbor)}var x=new BufferGeometry,w=[],S=[];for(r=0;r<p.length;r++){d=p[r].position;w.push(d.x,d.y,d.z)}for(r=0;r<f.length;r++){var M=f[r];m=p.indexOf(M.v1),v=p.indexOf(M.v2),g=p.indexOf(M.v3);S.push(m,v,g)}return x.addAttribute("position",new Float32BufferAttribute(w,3)),x.setIndex(S),x}}();var SubdivisionModifier=function(e){this.subdivisions=void 0===e?1:e};SubdivisionModifier.prototype.modify=function(e){(e=e.isBufferGeometry?(new Geometry).fromBufferGeometry(e):e.clone()).mergeVertices();for(var t=this.subdivisions;t-- >0;)this.smooth(e);return e.computeFaceNormals(),e.computeVertexNormals(),e},function(){var e=["a","b","c"];function t(e,t,r){return r[Math.min(e,t)+"_"+Math.max(e,t)]}function r(e,t,r,n,i,o){var a,s=Math.min(e,t),l=Math.max(e,t),u=s+"_"+l;u in n?a=n[u]:(a={a:r[s],b:r[l],newEdge:null,faces:[]},n[u]=a);a.faces.push(i),o[e].edges.push(a),o[t].edges.push(a)}function n(e,t,r,n,i){e.push(new Face3(t,r,n,void 0,void 0,i))}function i(e,t){return Math.abs(t-e)/2+Math.min(e,t)}function o(e,t,r,n){e.push([t.clone(),r.clone(),n.clone()])}SubdivisionModifier.prototype.smooth=function(a){var s,l,u,c,h,p,f,d,m,v,g,y,b,x,w=new Vector3,S=[];s=a.vertices,l=a.faces;var M,_,T,A,C,E,L,N,P,O,R,D,F,k,I=void 0!==(u=a.faceVertexUvs[0])&&u.length>0;for(f in function(e,t,n,i){var o,a,s;for(o=0,a=e.length;o<a;o++)n[o]={edges:[]};for(o=0,a=t.length;o<a;o++)r((s=t[o]).a,s.b,e,i,s,n),r(s.b,s.c,e,i,s,n),r(s.c,s.a,e,i,s,n)}(s,l,g=new Array(s.length),y={}),b=[],y){for(_=y[f],T=new Vector3,C=3/8,E=1/8,2!=(L=_.faces.length)&&(C=.5,E=0),T.addVectors(_.a,_.b).multiplyScalar(C),w.set(0,0,0),m=0;m<L;m++){for(A=_.faces[m],v=0;v<3&&((M=s[A[e[v]]])===_.a||M===_.b);v++);w.add(M)}w.multiplyScalar(E),T.add(w),_.newEdge=b.length,b.push(T)}for(x=[],f=0,d=s.length;f<d;f++){for(F=s[f],3==(p=(D=g[f].edges).length)?N=3/16:p>3&&(N=3/(8*p)),P=1-p*N,O=N,p<=2&&2==p&&(P=.75,O=1/8),k=F.clone().multiplyScalar(P),w.set(0,0,0),m=0;m<p;m++)M=(R=D[m]).a!==F?R.a:R.b,w.add(M);w.multiplyScalar(O),k.add(w),x.push(k)}c=x.concat(b);var B,U,V,j,z,G,W,H=x.length;h=[];var X=new Vector2,q=new Vector2,Y=new Vector2;for(f=0,d=l.length;f<d;f++)n(h,B=t((A=l[f]).a,A.b,y).newEdge+H,U=t(A.b,A.c,y).newEdge+H,V=t(A.c,A.a,y).newEdge+H,A.materialIndex),n(h,A.a,B,V,A.materialIndex),n(h,A.b,U,B,A.materialIndex),n(h,A.c,V,U,A.materialIndex),I&&(z=(j=u[f])[0],G=j[1],W=j[2],X.set(i(z.x,G.x),i(z.y,G.y)),q.set(i(G.x,W.x),i(G.y,W.y)),Y.set(i(z.x,W.x),i(z.y,W.y)),o(S,X,q,Y),o(S,z,X,Y),o(S,G,q,X),o(S,W,Y,q));a.vertices=c,a.faces=h,I&&(a.faceVertexUvs[0]=S)}}();var TessellateModifier=function(e){this.maxEdgeLength=e};TessellateModifier.prototype.modify=function(e){for(var t,r=[],n=[],i=this.maxEdgeLength*this.maxEdgeLength,o=0,a=e.faceVertexUvs.length;o<a;o++)n[o]=[];for(o=0,a=e.faces.length;o<a;o++){var s=e.faces[o];if(s instanceof Face3){var l=s.a,u=s.b,c=s.c,h=e.vertices[l],p=e.vertices[u],f=e.vertices[c],d=h.distanceToSquared(p),m=p.distanceToSquared(f),v=h.distanceToSquared(f);if(d>i||m>i||v>i){var g=e.vertices.length,y=s.clone(),b=s.clone();if(d>=m&&d>=v){if((x=h.clone()).lerp(p,.5),y.a=l,y.b=g,y.c=c,b.a=g,b.b=u,b.c=c,3===s.vertexNormals.length)(w=s.vertexNormals[0].clone()).lerp(s.vertexNormals[1],.5),y.vertexNormals[1].copy(w),b.vertexNormals[0].copy(w);if(3===s.vertexColors.length)(S=s.vertexColors[0].clone()).lerp(s.vertexColors[1],.5),y.vertexColors[1].copy(S),b.vertexColors[0].copy(S);t=0}else if(m>=d&&m>=v){if((x=p.clone()).lerp(f,.5),y.a=l,y.b=u,y.c=g,b.a=g,b.b=c,b.c=l,3===s.vertexNormals.length)(w=s.vertexNormals[1].clone()).lerp(s.vertexNormals[2],.5),y.vertexNormals[2].copy(w),b.vertexNormals[0].copy(w),b.vertexNormals[1].copy(s.vertexNormals[2]),b.vertexNormals[2].copy(s.vertexNormals[0]);if(3===s.vertexColors.length)(S=s.vertexColors[1].clone()).lerp(s.vertexColors[2],.5),y.vertexColors[2].copy(S),b.vertexColors[0].copy(S),b.vertexColors[1].copy(s.vertexColors[2]),b.vertexColors[2].copy(s.vertexColors[0]);t=1}else{var x,w,S;if((x=h.clone()).lerp(f,.5),y.a=l,y.b=u,y.c=g,b.a=g,b.b=u,b.c=c,3===s.vertexNormals.length)(w=s.vertexNormals[0].clone()).lerp(s.vertexNormals[2],.5),y.vertexNormals[2].copy(w),b.vertexNormals[0].copy(w);if(3===s.vertexColors.length)(S=s.vertexColors[0].clone()).lerp(s.vertexColors[2],.5),y.vertexColors[2].copy(S),b.vertexColors[0].copy(S);t=2}r.push(y,b),e.vertices.push(x);for(var M=0,_=e.faceVertexUvs.length;M<_;M++)if(e.faceVertexUvs[M].length){var T=e.faceVertexUvs[M][o],A=T[0],C=T[1],E=T[2];if(0===t){(P=A.clone()).lerp(C,.5);var L=[A.clone(),P.clone(),E.clone()],N=[P.clone(),C.clone(),E.clone()]}else if(1===t){(P=C.clone()).lerp(E,.5);L=[A.clone(),C.clone(),P.clone()],N=[P.clone(),E.clone(),A.clone()]}else{var P;(P=A.clone()).lerp(E,.5);L=[A.clone(),C.clone(),P.clone()],N=[P.clone(),C.clone(),E.clone()]}n[M].push(L,N)}}else{r.push(s);for(M=0,_=e.faceVertexUvs.length;M<_;M++)n[M].push(e.faceVertexUvs[M][o])}}}e.faces=r,e.faceVertexUvs=n};var MorphAnimMesh=function(e,t){Mesh.call(this,e,t),this.type="MorphAnimMesh",this.mixer=new AnimationMixer(this),this.activeAction=null};function Node$1(e){this.uuid=_Math.generateUUID(),this.name="",this.type=e,this.userData={}}function TempNode(e,t){Node$1.call(this,e),t=t||{},this.shared=void 0===t.shared||t.shared,this.unique=void 0!==t.unique&&t.unique}MorphAnimMesh.prototype=Object.create(Mesh.prototype),MorphAnimMesh.prototype.constructor=MorphAnimMesh,MorphAnimMesh.prototype.setDirectionForward=function(){this.mixer.timeScale=1},MorphAnimMesh.prototype.setDirectionBackward=function(){this.mixer.timeScale=-1},MorphAnimMesh.prototype.playAnimation=function(e,t){this.activeAction&&(this.activeAction.stop(),this.activeAction=null);var r=AnimationClip.findByName(this,e);if(!r)throw new Error("MorphAnimMesh: animations["+e+"] undefined in .playAnimation()");var n=this.mixer.clipAction(r);n.timeScale=r.tracks.length*t/r.duration,this.activeAction=n.play()},MorphAnimMesh.prototype.updateAnimation=function(e){this.mixer.update(e)},MorphAnimMesh.prototype.copy=function(e){return Mesh.prototype.copy.call(this,e),this.mixer=new AnimationMixer(this),this},Node$1.prototype={constructor:Node$1,isNode:!0,parse:function(e,t){t=t||{},e.parsing=!0,this.build(e.addFlow(t.slot,t.cache,t.context),"v4"),e.clearVertexNodeCode(),e.clearFragmentNodeCode(),e.removeFlow(),e.parsing=!1},parseAndBuildCode:function(e,t,r){return r=r||{},this.parse(e,r),this.buildCode(e,t,r)},buildCode:function(e,t,r){r=r||{};var n={result:this.build(e.addFlow(r.slot,r.cache,r.context),t)};return n.code=e.clearNodeCode(),e.removeFlow(),n},build:function(e,t,r){t=t||this.getType(e,t);var n=e.getNodeData(r||this);return e.parsing&&this.appendDepsNode(e,n,t),-1===e.nodes.indexOf(this)&&e.nodes.push(this),void 0!==this.updateFrame&&-1===e.updaters.indexOf(this)&&e.updaters.push(this),this.generate(e,t,r)},appendDepsNode:function(e,t,r){t.deps=(t.deps||0)+1;var n=e.getTypeLength(r);(n>(t.outputMax||0)||this.getType(e,r))&&(t.outputMax=n,t.output=r)},setName:function(e){return this.name=e,this},getName:function(e){return this.name},getType:function(e,t){return"sampler2D"===t||"samplerCube"===t?t:this.type},getJSONNode:function(e){if(!(void 0===e||"string"===typeof e)&&void 0!==e.nodes[this.uuid])return e.nodes[this.uuid]},copy:function(e){void 0!==e.name&&(this.name=e.name),void 0!==e.userData&&(this.userData=JSON.parse(JSON.stringify(e.userData)))},createJSONNode:function(e){var t=void 0===e||"string"===typeof e,r={};if("string"!==typeof this.nodeType)throw new Error("Node does not allow serialization.");return r.uuid=this.uuid,r.nodeType=this.nodeType,""!==this.name&&(r.name=this.name),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),t||(e.nodes[this.uuid]=r),r},toJSON:function(e){return this.getJSONNode(e)||this.createJSONNode(e)}},TempNode.prototype=Object.create(Node$1.prototype),TempNode.prototype.constructor=TempNode,TempNode.prototype.build=function(e,t,r,n){if(t=t||this.getType(e),this.getShared(e,t)){var i=this.getUnique(e,t);i&&void 0===this.constructor.uuid&&(this.constructor.uuid=_Math.generateUUID()),r=e.getUuid(r||this.getUuid(),!i);var o=e.getNodeData(r),a=o.output||this.getType(e);if(e.parsing)return(o.deps||0)>0||this.getLabel()?(this.appendDepsNode(e,o,t),this.generate(e,t,r)):Node$1.prototype.build.call(this,e,t,r);if(i)return o.name=o.name||Node$1.prototype.build.call(this,e,t,r),o.name;if(!this.getLabel()&&(!this.getShared(e,a)||!e.optimize||1===o.deps))return Node$1.prototype.build.call(this,e,t,r);r=this.getUuid(!1);var s=this.getTemp(e,r);if(s)return e.format(s,a,t);s=TempNode.prototype.generate.call(this,e,t,r,o.output,n);var l=this.generate(e,a,r);return e.addNodeCode(s+" = "+l+";"),e.format(s,a,t)}return Node$1.prototype.build.call(this,e,t,r)},TempNode.prototype.getShared=function(e,t){return"sampler2D"!==t&&"samplerCube"!==t&&this.shared},TempNode.prototype.getUnique=function(e,t){return this.unique},TempNode.prototype.setLabel=function(e){return this.label=e,this},TempNode.prototype.getLabel=function(e){return this.label},TempNode.prototype.getUuid=function(e){var t=(e||void 0==e)&&this.constructor.uuid||this.uuid;return"string"===typeof this.scope&&(t=this.scope+"-"+t),t},TempNode.prototype.getTemp=function(e,t){t=t||this.uuid;var r=e.getVars()[t];return r?r.name:void 0},TempNode.prototype.generate=function(e,t,r,n,i){return this.getShared(e,t)||console.error("TempNode is not shared!"),r=r||this.uuid,e.getTempVar(r,n||this.getType(e),i,this.getLabel()).name};var NodeLib={nodes:{},keywords:{},add:function(e){this.nodes[e.name]=e},addKeyword:function(e,t,r){r=void 0===r||r,this.keywords[e]={callback:t,cache:r}},remove:function(e){delete this.nodes[e.name]},removeKeyword:function(e){delete this.keywords[e]},get:function(e){return this.nodes[e]},getKeyword:function(e,t){return this.keywords[e].callback.call(this,t)},getKeywordData:function(e){return this.keywords[e]},contains:function(e){return void 0!=this.nodes[e]},containsKeyword:function(e){return void 0!=this.keywords[e]}},declarationRegexp=/^([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,propertiesRegexp=/[a-z_0-9]+/gi;function FunctionNode(e,t,r,n,i){this.isMethod=void 0===i,TempNode.call(this,i),this.eval(e,t,r,n)}function InputNode(e,t){(t=t||{}).shared=void 0!==t.shared&&t.shared,TempNode.call(this,e,t),this.readonly=!1}function FloatNode(e){InputNode.call(this,"f"),this.value=e||0}function PositionNode(e){TempNode.call(this,"v3"),this.scope=e||PositionNode.LOCAL}function CameraNode(e,t){TempNode.call(this,"v3"),this.setScope(e||CameraNode.POSITION),this.setCamera(t)}FunctionNode.prototype=Object.create(TempNode.prototype),FunctionNode.prototype.constructor=FunctionNode,FunctionNode.prototype.nodeType="Function",FunctionNode.prototype.useKeywords=!0,FunctionNode.prototype.getShared=function(e,t){return!this.isMethod},FunctionNode.prototype.getType=function(e){return e.getTypeByFormat(this.type)},FunctionNode.prototype.getInputByName=function(e){for(var t=this.inputs.length;t--;)if(this.inputs[t].name===e)return this.inputs[t]},FunctionNode.prototype.getIncludeByName=function(e){for(var t=this.includes.length;t--;)if(this.includes[t].name===e)return this.includes[t]},FunctionNode.prototype.generate=function(e,t){for(var r,n=0,i=this.src,o=0;o<this.includes.length;o++)e.include(this.includes[o],this);for(var a in this.extensions)e.extensions[a]=!0;for(;r=propertiesRegexp.exec(this.src);){var s=r[0],l=!this.isMethod||!this.getInputByName(s),u=s;if(this.keywords[s]||this.useKeywords&&l&&NodeLib.containsKeyword(s)){var c=this.keywords[s];if(!c){var h=NodeLib.getKeywordData(s);h.cache&&(c=e.keywords[s]),c=c||NodeLib.getKeyword(s,e),h.cache&&(e.keywords[s]=c)}u=c.build(e)}s!=u&&(i=i.substring(0,r.index+n)+u+i.substring(r.index+s.length+n),n+=u.length-s.length),void 0===this.getIncludeByName(u)&&NodeLib.contains(u)&&e.include(NodeLib.get(u))}return"source"===t?i:this.isMethod?(e.include(this,!1,i),this.name):e.format("( "+i+" )",this.getType(e),t)},FunctionNode.prototype.eval=function(e,t,r,n){if(this.src=e||"",this.includes=t||[],this.extensions=r||{},this.keywords=n||{},this.isMethod){var i=this.src.match(declarationRegexp);if(this.inputs=[],i&&4==i.length){this.type=i[1],this.name=i[2];var o=i[3].match(propertiesRegexp);if(o)for(var a=0;a<o.length;){var s,l,u=o[a++];"in"==u||"out"==u||"inout"==u?s=o[a++]:(s=u,u=""),l=o[a++],this.inputs.push({name:l,type:s,qualifier:u})}}else this.type="",this.name=""}},FunctionNode.prototype.copy=function(e){TempNode.prototype.copy.call(this,e),this.isMethod=e.isMethod,this.useKeywords=e.useKeywords,this.eval(e.src,e.includes,e.extensions,e.keywords),void 0!==e.type&&(this.type=e.type)},FunctionNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);if(!t){for(var r in(t=this.createJSONNode(e)).src=this.src,t.isMethod=this.isMethod,t.useKeywords=this.useKeywords,this.isMethod||(t.type=this.type),t.extensions=JSON.parse(JSON.stringify(this.extensions)),t.keywords={},this.keywords)t.keywords[r]=this.keywords[r].toJSON(e).uuid;if(this.includes.length){t.includes=[];for(var n=0;n<this.includes.length;n++)t.includes.push(this.includes[n].toJSON(e).uuid)}}return t},InputNode.prototype=Object.create(TempNode.prototype),InputNode.prototype.constructor=InputNode,InputNode.prototype.setReadonly=function(e){return this.readonly=e,this},InputNode.prototype.getReadonly=function(e){return this.readonly},InputNode.prototype.copy=function(e){TempNode.prototype.copy.call(this,e),void 0!==e.readonly&&(this.readonly=e.readonly)},InputNode.prototype.createJSONNode=function(e){var t=TempNode.prototype.createJSONNode.call(this,e);return!0===this.readonly&&(t.readonly=this.readonly),t},InputNode.prototype.generate=function(e,t,r,n,i,o){r=e.getUuid(r||this.getUuid()),n=n||this.getType(e);var a=e.getNodeData(r);return this.getReadonly(e)&&void 0!==this.generateReadonly?this.generateReadonly(e,t,r,n,i,o):e.isShader("vertex")?(a.vertex||(a.vertex=e.createVertexUniform(n,this,i,o,this.getLabel())),e.format(a.vertex.name,n,t)):(a.fragment||(a.fragment=e.createFragmentUniform(n,this,i,o,this.getLabel())),e.format(a.fragment.name,n,t))},FloatNode.prototype=Object.create(InputNode.prototype),FloatNode.prototype.constructor=FloatNode,FloatNode.prototype.nodeType="Float",FloatNode.prototype.generateReadonly=function(e,t,r,n,i,o){return e.format(this.value+(this.value%1?"":".0"),n,t)},FloatNode.prototype.copy=function(e){InputNode.prototype.copy.call(this,e),this.value=e.value},FloatNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value,!0===this.readonly&&(t.readonly=!0)),t},PositionNode.LOCAL="local",PositionNode.WORLD="world",PositionNode.VIEW="view",PositionNode.PROJECTION="projection",PositionNode.prototype=Object.create(TempNode.prototype),PositionNode.prototype.constructor=PositionNode,PositionNode.prototype.nodeType="Position",PositionNode.prototype.getType=function(){switch(this.scope){case PositionNode.PROJECTION:return"v4"}return this.type},PositionNode.prototype.getShared=function(e){switch(this.scope){case PositionNode.LOCAL:case PositionNode.WORLD:return!1}return!0},PositionNode.prototype.generate=function(e,t){var r;switch(this.scope){case PositionNode.LOCAL:e.requires.position=!0,r=e.isShader("vertex")?"transformed":"vPosition";break;case PositionNode.WORLD:e.requires.worldPosition=!0,r="vWPosition";break;case PositionNode.VIEW:r=e.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case PositionNode.PROJECTION:r=e.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )"}return e.format(r,this.getType(e),t)},PositionNode.prototype.copy=function(e){TempNode.prototype.copy.call(this,e),this.scope=e.scope},PositionNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope),t},NodeLib.addKeyword("position",function(){return new PositionNode}),NodeLib.addKeyword("worldPosition",function(){return new PositionNode(PositionNode.WORLD)}),NodeLib.addKeyword("viewPosition",function(){return new PositionNode(NormalNode.VIEW)}),CameraNode.Nodes={depthColor:new FunctionNode(["float depthColor( float mNear, float mFar ) {","\t#ifdef USE_LOGDEPTHBUF_EXT","\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;","\t#else","\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;","\t#endif","\treturn 1.0 - smoothstep( mNear, mFar, depth );","}"].join("\n"))},CameraNode.POSITION="position",CameraNode.DEPTH="depth",CameraNode.TO_VERTEX="toVertex",CameraNode.prototype=Object.create(TempNode.prototype),CameraNode.prototype.constructor=CameraNode,CameraNode.prototype.nodeType="Camera",CameraNode.prototype.setCamera=function(e){this.camera=e,this.updateFrame=void 0!==e?this.onUpdateFrame:void 0},CameraNode.prototype.setScope=function(e){switch(this.scope){case CameraNode.DEPTH:delete this.near,delete this.far}switch(this.scope=e,e){case CameraNode.DEPTH:var t=this.camera;this.near=new FloatNode(t?t.near:1),this.far=new FloatNode(t?t.far:1200)}},CameraNode.prototype.getType=function(e){switch(this.scope){case CameraNode.DEPTH:return"f"}return this.type},CameraNode.prototype.getUnique=function(e){switch(this.scope){case CameraNode.DEPTH:case CameraNode.TO_VERTEX:return!0}return!1},CameraNode.prototype.getShared=function(e){switch(this.scope){case CameraNode.POSITION:return!1}return!0},CameraNode.prototype.generate=function(e,t){var r;switch(this.scope){case CameraNode.POSITION:r="cameraPosition";break;case CameraNode.DEPTH:r=e.include(CameraNode.Nodes.depthColor)+"( "+this.near.build(e,"f")+", "+this.far.build(e,"f")+" )";break;case CameraNode.TO_VERTEX:r="normalize( "+new PositionNode(PositionNode.WORLD).build(e,"v3")+" - cameraPosition )"}return e.format(r,this.getType(e),t)},CameraNode.prototype.onUpdateFrame=function(e){switch(this.scope){case CameraNode.DEPTH:var t=this.camera;this.near.value=t.near,this.far.value=t.far}},CameraNode.prototype.copy=function(e){switch(TempNode.prototype.copy.call(this,e),this.setScope(e.scope),e.camera&&this.setCamera(e.camera),e.scope){case CameraNode.DEPTH:this.near.number=e.near,this.far.number=e.far}},CameraNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);if(!t)switch((t=this.createJSONNode(e)).scope=this.scope,this.camera&&(t.camera=this.camera.uuid),this.scope){case CameraNode.DEPTH:t.near=this.near.value,t.far=this.far.value}return t};var vertexDict=["color","color2"],fragmentDict=["vColor","vColor2"];function ColorsNode(e){TempNode.call(this,"v4",{shared:!1}),this.index=e||0}function LightNode(e){TempNode.call(this,"v3",{shared:!1}),this.scope=e||LightNode.TOTAL}function NormalNode$1(e){TempNode.call(this,"v3"),this.scope=e||NormalNode$1.LOCAL}function ReflectNode(e){TempNode.call(this,"v3",{unique:!0}),this.scope=e||ReflectNode.CUBE}ColorsNode.prototype=Object.create(TempNode.prototype),ColorsNode.prototype.constructor=ColorsNode,ColorsNode.prototype.generate=function(e,t){e.requires.color[this.index]=!0;var r=e.isShader("vertex")?vertexDict[this.index]:fragmentDict[this.index];return e.format(r,this.getType(e),t)},ColorsNode.prototype.copy=function(e){TempNode.prototype.copy.call(this,e),this.index=e.index},ColorsNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).index=this.index),t},LightNode.TOTAL="total",LightNode.prototype=Object.create(TempNode.prototype),LightNode.prototype.constructor=LightNode,LightNode.prototype.nodeType="Light",LightNode.prototype.generate=function(e,t){return e.isCache("light")?e.format("reflectedLight.directDiffuse",this.type,t):(console.warn('LightNode is only compatible in "light" channel.'),e.format("vec3( 0.0 )",this.type,t))},LightNode.prototype.copy=function(e){TempNode.prototype.copy.call(this,e),this.scope=e.scope},LightNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope),t},NormalNode$1.LOCAL="local",NormalNode$1.WORLD="world",NormalNode$1.VIEW="view",NormalNode$1.prototype=Object.create(TempNode.prototype),NormalNode$1.prototype.constructor=NormalNode$1,NormalNode$1.prototype.nodeType="Normal",NormalNode$1.prototype.getShared=function(e){switch(this.scope){case NormalNode$1.WORLD:return!0}return!1},NormalNode$1.prototype.generate=function(e,t){var r;switch(this.scope){case NormalNode$1.LOCAL:e.requires.normal=!0,r="normal";break;case NormalNode$1.WORLD:e.requires.worldNormal=!0,r=e.isShader("vertex")?"( modelMatrix * vec4( objectNormal, 0.0 ) ).xyz":"vWNormal";break;case NormalNode$1.VIEW:r="vNormal"}return e.format(r,this.getType(e),t)},NormalNode$1.prototype.copy=function(e){TempNode.prototype.copy.call(this,e),this.scope=e.scope},NormalNode$1.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope),t},NodeLib.addKeyword("normal",function(){return new NormalNode$1}),NodeLib.addKeyword("worldNormal",function(){return new NormalNode$1(NormalNode$1.WORLD)}),NodeLib.addKeyword("viewNormal",function(){return new NormalNode$1(NormalNode$1.VIEW)}),ReflectNode.CUBE="cube",ReflectNode.SPHERE="sphere",ReflectNode.VECTOR="vector",ReflectNode.prototype=Object.create(TempNode.prototype),ReflectNode.prototype.constructor=ReflectNode,ReflectNode.prototype.nodeType="Reflect",ReflectNode.prototype.getType=function(e){switch(this.scope){case ReflectNode.SPHERE:return"v2"}return this.type},ReflectNode.prototype.generate=function(e,t){if(e.isShader("fragment")){var r;switch(this.scope){case ReflectNode.VECTOR:e.addNodeCode("vec3 reflectVec = inverseTransformDirection( reflect( -normalize( vViewPosition ), normal ), viewMatrix );"),r="reflectVec";break;case ReflectNode.CUBE:var n=new ReflectNode(ReflectNode.VECTOR).build(e,"v3");e.addNodeCode("vec3 reflectCubeVec = vec3( -1.0 * "+n+".x, "+n+".yz );"),r="reflectCubeVec";break;case ReflectNode.SPHERE:n=new ReflectNode(ReflectNode.VECTOR).build(e,"v3");e.addNodeCode("vec2 reflectSphereVec = normalize( ( viewMatrix * vec4( "+n+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5;"),r="reflectSphereVec"}return e.format(r,this.getType(e),t)}return console.warn("ReflectNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.type,t)},ReflectNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope),t};var NodeUtils={elements:["x","y","z","w"],addShortcuts:function(){function e(e,t,r){return r?{get:function(){return this[e][t][r]},set:function(n){this[e][t][r]=n}}:{get:function(){return this[e][t]},set:function(r){this[e][t]=r}}}return function(t,r,n){for(var i={},o=0;o<n.length;++o){var a=n[o].split("."),s=a[0],l=a[1];i[s]=e(r,s,l)}Object.defineProperties(t,i)}}()};function Vector2Node(e,t){InputNode.call(this,"v2"),this.value=e instanceof Vector2?e:new Vector2(e,t)}function ResolutionNode(){Vector2Node.call(this)}function ScreenUVNode(e){TempNode.call(this,"v2"),this.resolution=e||new ResolutionNode}Vector2Node.prototype=Object.create(InputNode.prototype),Vector2Node.prototype.constructor=Vector2Node,Vector2Node.prototype.nodeType="Vector2",NodeUtils.addShortcuts(Vector2Node.prototype,"value",["x","y"]),Vector2Node.prototype.generateReadonly=function(e,t,r,n,i,o){return e.format("vec2( "+this.x+", "+this.y+" )",n,t)},Vector2Node.prototype.copy=function(e){InputNode.prototype.copy.call(this,e),this.value.copy(e)},Vector2Node.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).x=this.x,t.y=this.y,!0===this.readonly&&(t.readonly=!0)),t},ResolutionNode.prototype=Object.create(Vector2Node.prototype),ResolutionNode.prototype.constructor=ResolutionNode,ResolutionNode.prototype.nodeType="Resolution",ResolutionNode.prototype.updateFrame=function(e){if(e.renderer){var t=e.renderer.getSize(),r=e.renderer.getPixelRatio();this.x=t.width*r,this.y=t.height*r}else console.warn("ResolutionNode need a renderer in NodeFrame")},ResolutionNode.prototype.copy=function(e){Vector2Node.prototype.copy.call(this,e),this.renderer=e.renderer},ResolutionNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).renderer=this.renderer.uuid),t},ScreenUVNode.prototype=Object.create(TempNode.prototype),ScreenUVNode.prototype.constructor=ScreenUVNode,ScreenUVNode.prototype.nodeType="ScreenUV",ScreenUVNode.prototype.generate=function(e,t){var r;return e.isShader("fragment")?r="( gl_FragCoord.xy / "+this.resolution.build(e,"v2")+")":(console.warn("ScreenUVNode is not compatible with "+e.shader+" shader."),r="vec2( 0.0 )"),e.format(r,this.getType(e),t)},ScreenUVNode.prototype.copy=function(e){TempNode.prototype.copy.call(this,e),this.resolution=e.resolution},ScreenUVNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).resolution=this.resolution.toJSON(e).uuid),t};var vertexDict$1=["uv","uv2"],fragmentDict$1=["vUv","vUv2"];function UVNode(e){TempNode.call(this,"v2",{shared:!1}),this.index=e||0}function BlinnShininessExponentNode(){TempNode.call(this,"f")}function BlinnExponentToRoughnessNode(e){TempNode.call(this,"f"),this.blinnExponent=e||new BlinnShininessExponentNode}function MaxMIPLevelNode(e){FloatNode.call(this),this.texture=e,this.maxMIPLevel=0}function RoughnessToBlinnExponentNode(e){TempNode.call(this,"f"),this.texture=e,this.maxMIPLevel=new MaxMIPLevelNode(e),this.blinnShininessExponent=new BlinnShininessExponentNode}function AttributeNode(e,t){Node$1.call(this,t),this.name=e}UVNode.prototype=Object.create(TempNode.prototype),UVNode.prototype.constructor=UVNode,UVNode.prototype.nodeType="UV",UVNode.prototype.generate=function(e,t){e.requires.uv[this.index]=!0;var r=e.isShader("vertex")?vertexDict$1[this.index]:fragmentDict$1[this.index];return e.format(r,this.getType(e),t)},UVNode.prototype.copy=function(e){TempNode.prototype.copy.call(this,e),this.index=e.index},UVNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).index=this.index),t},NodeLib.addKeyword("uv",function(){return new UVNode}),NodeLib.addKeyword("uv2",function(){return new UVNode(1)}),BlinnShininessExponentNode.prototype=Object.create(TempNode.prototype),BlinnShininessExponentNode.prototype.constructor=BlinnShininessExponentNode,BlinnShininessExponentNode.prototype.nodeType="BlinnShininessExponent",BlinnShininessExponentNode.prototype.generate=function(e,t){return e.isCache("clearCoat")?e.format("Material_ClearCoat_BlinnShininessExponent( material )",this.type,t):e.format("Material_BlinnShininessExponent( material )",this.type,t)},BlinnExponentToRoughnessNode.prototype=Object.create(TempNode.prototype),BlinnExponentToRoughnessNode.prototype.constructor=BlinnExponentToRoughnessNode,BlinnExponentToRoughnessNode.prototype.nodeType="BlinnExponentToRoughness",BlinnExponentToRoughnessNode.prototype.generate=function(e,t){return e.format("BlinnExponentToGGXRoughness( "+this.blinnExponent.build(e,"f")+" )",this.type,t)},BlinnExponentToRoughnessNode.prototype.copy=function(e){TempNode.prototype.copy.call(this,e),this.blinnExponent=e.blinnExponent},BlinnExponentToRoughnessNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).blinnExponent=this.blinnExponent),t},MaxMIPLevelNode.prototype=Object.create(FloatNode.prototype),MaxMIPLevelNode.prototype.constructor=MaxMIPLevelNode,MaxMIPLevelNode.prototype.nodeType="MaxMIPLevel",Object.defineProperties(MaxMIPLevelNode.prototype,{value:{get:function(){if(0===this.maxMIPLevel){var e=this.texture.value.image?this.texture.value.image[0]:void 0;this.maxMIPLevel=void 0!==e?Math.log(Math.max(e.width,e.height))*Math.LOG2E:0}return this.maxMIPLevel},set:function(){}}}),MaxMIPLevelNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).texture=this.texture.uuid),t},RoughnessToBlinnExponentNode.Nodes={getSpecularMIPLevel:new FunctionNode(["float getSpecularMIPLevel( const in float blinnShininessExponent, const in float maxMIPLevelScalar ) {","\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );","\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );","}"].join("\n"))},RoughnessToBlinnExponentNode.prototype=Object.create(TempNode.prototype),RoughnessToBlinnExponentNode.prototype.constructor=RoughnessToBlinnExponentNode,RoughnessToBlinnExponentNode.prototype.nodeType="RoughnessToBlinnExponent",RoughnessToBlinnExponentNode.prototype.generate=function(e,t){if(e.isShader("fragment")){this.maxMIPLevel.texture=this.texture;var r=e.include(RoughnessToBlinnExponentNode.Nodes.getSpecularMIPLevel);return e.format(r+"( "+this.blinnShininessExponent.build(e,"f")+", "+this.maxMIPLevel.build(e,"f")+" )",this.type,t)}return console.warn("RoughnessToBlinnExponentNode is not compatible with "+e.shader+" shader."),e.format("0.0",this.type,t)},RoughnessToBlinnExponentNode.prototype.copy=function(e){TempNode.prototype.copy.call(this,e),this.texture=e.texture},RoughnessToBlinnExponentNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).texture=this.texture),t},AttributeNode.prototype=Object.create(Node$1.prototype),AttributeNode.prototype.constructor=AttributeNode,AttributeNode.prototype.nodeType="Attribute",AttributeNode.prototype.getAttributeType=function(e){return"number"===typeof this.type?e.getConstructorFromLength(this.type):this.type},AttributeNode.prototype.getType=function(e){var t=this.getAttributeType(e);return e.getTypeByFormat(t)},AttributeNode.prototype.generate=function(e,t){var r=this.getAttributeType(e),n=e.getAttribute(this.name,r),i=e.isShader("vertex")?this.name:n.varying.name;return console.log(n),e.format(i,this.getType(e),t)},AttributeNode.prototype.copy=function(e){Node$1.prototype.copy.call(this,e),this.type=e.type},AttributeNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).type=this.type),t};var declarationRegexp$1=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i;function ConstNode(e,t){TempNode.call(this),this.eval(e||ConstNode.PI,t)}function ExpressionNode(e,t,r,n,i){FunctionNode.call(this,e,i,n,r,t)}function FunctionCallNode(e,t){TempNode.call(this),this.setFunction(e,t)}function NodeUniform(e){e=e||{},this.name=e.name,this.type=e.type,this.node=e.node,this.needsUpdate=e.needsUpdate}ConstNode.PI="PI",ConstNode.PI2="PI2",ConstNode.RECIPROCAL_PI="RECIPROCAL_PI",ConstNode.RECIPROCAL_PI2="RECIPROCAL_PI2",ConstNode.LOG2="LOG2",ConstNode.EPSILON="EPSILON",ConstNode.prototype=Object.create(TempNode.prototype),ConstNode.prototype.constructor=ConstNode,ConstNode.prototype.nodeType="Const",ConstNode.prototype.getType=function(e){return e.getTypeByFormat(this.type)},ConstNode.prototype.eval=function(e,t){this.src=e||"";var r,n,i="",o=this.src.match(declarationRegexp$1);this.useDefine=t||"#"===this.src.charAt(0),o&&o.length>1?(n=o[1],r=o[2],i=o[3]):(r=this.src,n="f"),this.name=r,this.type=n,this.value=i},ConstNode.prototype.build=function(e,t){return"source"!==t?(e.include(this),e.format(this.name,this.getType(e),t)):this.value?this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";":this.useDefine?this.src:void 0},ConstNode.prototype.generate=function(e,t){return e.format(this.name,this.getType(e),t)},ConstNode.prototype.copy=function(e){TempNode.prototype.copy.call(this,e),this.eval(e.src,e.useDefine)},ConstNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).src=this.src,!0===t.useDefine&&(t.useDefine=!0)),t},ExpressionNode.prototype=Object.create(FunctionNode.prototype),ExpressionNode.prototype.constructor=ExpressionNode,ExpressionNode.prototype.nodeType="Expression",FunctionCallNode.prototype=Object.create(TempNode.prototype),FunctionCallNode.prototype.constructor=FunctionCallNode,FunctionCallNode.prototype.nodeType="FunctionCall",FunctionCallNode.prototype.setFunction=function(e,t){this.value=e,this.inputs=t||[]},FunctionCallNode.prototype.getFunction=function(){return this.value},FunctionCallNode.prototype.getType=function(e){return this.value.getType(e)},FunctionCallNode.prototype.generate=function(e,t){for(var r=this.getType(e),n=this.value,i=n.build(e,t)+"( ",o=[],a=0;a<n.inputs.length;a++){var s=n.inputs[a],l=this.inputs[a]||this.inputs[s.name];o.push(l.build(e,e.getTypeByFormat(s.type)))}return i+=o.join(", ")+" )",e.format(i,r,t)},FunctionCallNode.prototype.copy=function(e){for(var t in TempNode.prototype.copy.call(this,e),e.inputs)this.inputs[t]=e.inputs[t];this.value=e.value},FunctionCallNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);if(!t){var r=this.value;if((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid,r.inputs.length){t.inputs={};for(var n=0;n<r.inputs.length;n++){var i=r.inputs[n],o=this.inputs[n]||this.inputs[i.name];t.inputs[i.name]=o.toJSON(e).uuid}}}return t},Object.defineProperties(NodeUniform.prototype,{value:{get:function(){return this.node.value},set:function(e){this.node.value=e}}});var declarationRegexp$2=/^struct\s*([a-z_0-9]+)\s*{\s*((.|\n)*?)}/gim,propertiesRegexp$1=/\s*(\w*?)\s*(\w*?)(\=|\;)/gim;function StructNode(e){TempNode.call(this),this.eval(e)}function Vector3Node(e,t,r){InputNode.call(this,"v3"),this.value=e instanceof Vector3?e:new Vector3(e,t,r)}function Vector4Node(e,t,r,n){InputNode.call(this,"v4"),this.value=e instanceof Vector4?e:new Vector4(e,t,r,n)}function ColorSpaceNode(e,t){TempNode.call(this,"v4"),this.input=e,this.method=t||ColorSpaceNode.LINEAR}function TextureNode(e,t,r,n){InputNode.call(this,"v4",{shared:!0}),this.value=e,this.uv=t||new UVNode,this.bias=r,this.project=void 0!==n&&n}function CubeTextureNode(e,t,r){InputNode.call(this,"v4",{shared:!0}),this.value=e,this.uv=t||new ReflectNode,this.bias=r}function TextureCubeUVNode(e,t,r){TempNode.call(this,"TextureCubeUVData"),this.uv=e||new ReflectNode(ReflectNode.VECTOR),this.textureSize=t||new FloatNode(1024),this.blinnExponentToRoughness=r||new BlinnExponentToRoughnessNode}function TextureCubeNode(e,t){TempNode.call(this,"v4"),this.value=e,this.uv=t||new TextureCubeUVNode}StructNode.prototype=Object.create(TempNode.prototype),StructNode.prototype.constructor=StructNode,StructNode.prototype.nodeType="Struct",StructNode.prototype.getType=function(e){return e.getTypeByFormat(this.name)},StructNode.prototype.getInputByName=function(e){for(var t=this.inputs.length;t--;)if(this.inputs[t].name===e)return this.inputs[t]},StructNode.prototype.generate=function(e,t){return"source"===t?this.src+";":e.format("( "+this.src+" )",this.getType(e),t)},StructNode.prototype.eval=function(e){this.src=e||"",this.inputs=[];var t=declarationRegexp$2.exec(this.src);if(t){for(var r,n=t[2];r=propertiesRegexp$1.exec(n);)this.inputs.push({type:r[1],name:r[2]});this.name=t[1]}else this.name="";this.type=this.name},StructNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).src=this.src),t},Vector3Node.prototype=Object.create(InputNode.prototype),Vector3Node.prototype.constructor=Vector3Node,Vector3Node.prototype.nodeType="Vector3",NodeUtils.addShortcuts(Vector3Node.prototype,"value",["x","y","z"]),Vector3Node.prototype.generateReadonly=function(e,t,r,n,i,o){return e.format("vec3( "+this.x+", "+this.y+", "+this.z+" )",n,t)},Vector3Node.prototype.copy=function(e){InputNode.prototype.copy.call(this,e),this.value.copy(e)},Vector3Node.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).x=this.x,t.y=this.y,t.z=this.z,!0===this.readonly&&(t.readonly=!0)),t},Vector4Node.prototype=Object.create(InputNode.prototype),Vector4Node.prototype.constructor=Vector4Node,Vector4Node.prototype.nodeType="Vector4",NodeUtils.addShortcuts(Vector4Node.prototype,"value",["x","y","z","w"]),Vector4Node.prototype.generateReadonly=function(e,t,r,n,i,o){return e.format("vec4( "+this.x+", "+this.y+", "+this.z+", "+this.w+" )",n,t)},Vector4Node.prototype.copy=function(e){InputNode.prototype.copy.call(this,e),this.value.copy(e)},Vector4Node.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).x=this.x,t.y=this.y,t.z=this.z,t.w=this.w,!0===this.readonly&&(t.readonly=!0)),t},ColorSpaceNode.Nodes=function(){var e=new FunctionNode(["vec4 LinearToLinear( in vec4 value ) {","\treturn value;","}"].join("\n")),t=new FunctionNode(["vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {","\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );","}"].join("\n")),r=new FunctionNode(["vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {","\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );","}"].join("\n")),n=new FunctionNode(["vec4 sRGBToLinear( in vec4 value ) {","\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join("\n")),i=new FunctionNode(["vec4 LinearTosRGB( in vec4 value ) {","\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join("\n")),o=new FunctionNode(["vec4 RGBEToLinear( in vec4 value ) {","\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );","}"].join("\n")),a=new FunctionNode(["vec4 LinearToRGBE( in vec4 value ) {","\tfloat maxComponent = max( max( value.r, value.g ), value.b );","\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );","\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );","}"].join("\n")),s=new FunctionNode(["vec3 RGBMToLinear( in vec4 value, in float maxRange ) {","\treturn vec4( value.xyz * value.w * maxRange, 1.0 );","}"].join("\n")),l=new FunctionNode(["vec3 LinearToRGBM( in vec4 value, in float maxRange ) {","\tfloat maxRGB = max( value.x, max( value.g, value.b ) );","\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );","\tM            = ceil( M * 255.0 ) / 255.0;","\treturn vec4( value.rgb / ( M * maxRange ), M );","}"].join("\n")),u=new FunctionNode(["vec3 RGBDToLinear( in vec4 value, in float maxRange ) {","\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );","}"].join("\n")),c=new FunctionNode(["vec3 LinearToRGBD( in vec4 value, in float maxRange ) {","\tfloat maxRGB = max( value.x, max( value.g, value.b ) );","\tfloat D      = max( maxRange / maxRGB, 1.0 );","\tD            = min( floor( D ) / 255.0, 1.0 );","\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );","}"].join("\n")),h=new ConstNode("const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );"),p=new FunctionNode(["vec4 LinearToLogLuv( in vec4 value ) {","\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;","\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));","\tvec4 vResult;","\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;","\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;","\tvResult.w = fract(Le);","\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;","\treturn vResult;","}"].join("\n"),[h]),f=new ConstNode("const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );");return{LinearToLinear:e,GammaToLinear:t,LinearToGamma:r,sRGBToLinear:n,LinearTosRGB:i,RGBEToLinear:o,LinearToRGBE:a,RGBMToLinear:s,LinearToRGBM:l,RGBDToLinear:u,LinearToRGBD:c,cLogLuvM:h,LinearToLogLuv:p,cLogLuvInverseM:f,LogLuvToLinear:new FunctionNode(["vec4 LogLuvToLinear( in vec4 value ) {","\tfloat Le = value.z * 255.0 + value.w;","\tvec3 Xp_Y_XYZp;","\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);","\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;","\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;","\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;","\treturn vec4( max(vRGB, 0.0), 1.0 );","}"].join("\n"),[f])}}(),ColorSpaceNode.LINEAR_TO_LINEAR="LinearToLinear",ColorSpaceNode.GAMMA_TO_LINEAR="GammaToLinear",ColorSpaceNode.LINEAR_TO_GAMMA="LinearToGamma",ColorSpaceNode.SRGB_TO_LINEAR="sRGBToLinear",ColorSpaceNode.LINEAR_TO_SRGB="LinearTosRGB",ColorSpaceNode.RGBE_TO_LINEAR="RGBEToLinear",ColorSpaceNode.LINEAR_TO_RGBE="LinearToRGBE",ColorSpaceNode.RGBM_TO_LINEAR="RGBMToLinear",ColorSpaceNode.LINEAR_TO_RGBM="LinearToRGBM",ColorSpaceNode.RGBD_TO_LINEAR="RGBDToLinear",ColorSpaceNode.LINEAR_TO_RGBD="LinearToRGBD",ColorSpaceNode.LINEAR_TO_LOG_LUV="LinearToLogLuv",ColorSpaceNode.LOG_LUV_TO_LINEAR="LogLuvToLinear",ColorSpaceNode.prototype=Object.create(TempNode.prototype),ColorSpaceNode.prototype.constructor=ColorSpaceNode,ColorSpaceNode.prototype.nodeType="ColorAdjustment",ColorSpaceNode.prototype.generate=function(e,t){var r=e.context.input||this.input.build(e,"v4"),n=void 0!==e.context.encoding?this.getEncodingMethod(e.context.encoding):[this.method],i=this.factor?this.factor.build(e,"f"):n[1],o=e.include(ColorSpaceNode.Nodes[n[0]]);return i?e.format(o+"( "+r+", "+i+" )",this.getType(e),t):e.format(o+"( "+r+" )",this.getType(e),t)},ColorSpaceNode.prototype.getDecodingMethod=function(e){var t=this.getEncodingComponents(e);return t[0]+="ToLinear",t},ColorSpaceNode.prototype.getEncodingMethod=function(e){var t=this.getEncodingComponents(e);return t[0]="LinearTo"+t[0],t},ColorSpaceNode.prototype.getEncodingComponents=function(e){switch(e){case LinearEncoding:return["Linear"];case sRGBEncoding:return["sRGB"];case RGBEEncoding:return["RGBE"];case RGBM7Encoding:return["RGBM","7.0"];case RGBM16Encoding:return["RGBM","16.0"];case RGBDEncoding:return["RGBD","256.0"];case GammaEncoding:return["Gamma","float( GAMMA_FACTOR )"]}},ColorSpaceNode.prototype.copy=function(e){TempNode.prototype.copy.call(this,e),this.input=e.input,this.method=e.method},ColorSpaceNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).input=this.input.toJSON(e).uuid,t.method=this.method),t},TextureNode.prototype=Object.create(InputNode.prototype),TextureNode.prototype.constructor=TextureNode,TextureNode.prototype.nodeType="Texture",TextureNode.prototype.getTexture=function(e,t){return InputNode.prototype.generate.call(this,e,t,this.value.uuid,"t")},TextureNode.prototype.generate=function(e,t){if("sampler2D"===t)return this.getTexture(e,t);var r,n,i=this.getTexture(e,t),o=this.uv.build(e,this.project?"v4":"v2"),a=this.bias?this.bias.build(e,"f"):void 0;return void 0==a&&e.context.bias&&(a=new e.context.bias(this).build(e,"f")),r=this.project?"texture2DProj":a?"tex2DBias":"tex2D",n=a?r+"( "+i+", "+o+", "+a+" )":r+"( "+i+", "+o+" )",e.addContext({input:n,encoding:e.getTextureEncodingFromMap(this.value),include:e.isShader("vertex")}),this.colorSpace=this.colorSpace||new ColorSpaceNode(this),n=this.colorSpace.build(e,this.type),e.removeContext(),e.format(n,this.type,t)},TextureNode.prototype.copy=function(e){InputNode.prototype.copy.call(this,e),e.value&&(this.value=e.value),this.uv=e.uv,e.bias&&(this.bias=e.bias),void 0!==e.project&&(this.project=e.project)},TextureNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.value&&(t.value=this.value.uuid),t.uv=this.uv.toJSON(e).uuid,t.project=this.project,this.bias&&(t.bias=this.bias.toJSON(e).uuid)),t},CubeTextureNode.prototype=Object.create(InputNode.prototype),CubeTextureNode.prototype.constructor=CubeTextureNode,CubeTextureNode.prototype.nodeType="CubeTexture",CubeTextureNode.prototype.getTexture=function(e,t){return InputNode.prototype.generate.call(this,e,t,this.value.uuid,"tc")},CubeTextureNode.prototype.generate=function(e,t){if("samplerCube"===t)return this.getTexture(e,t);var r,n=this.getTexture(e,t),i=this.uv.build(e,"v3"),o=this.bias?this.bias.build(e,"f"):void 0;return void 0===o&&e.context.bias&&(o=new e.context.bias(this).build(e,"f")),r=o?"texCubeBias( "+n+", "+i+", "+o+" )":"texCube( "+n+", "+i+" )",e.addContext({input:r,encoding:e.getTextureEncodingFromMap(this.value),include:e.isShader("vertex")}),this.colorSpace=this.colorSpace||new ColorSpaceNode(this),r=this.colorSpace.build(e,this.type),e.removeContext(),e.format(r,this.type,t)},CubeTextureNode.prototype.copy=function(e){InputNode.prototype.copy.call(this,e),e.value&&(this.value=e.value),this.uv=e.uv,e.bias&&(this.bias=e.bias)},CubeTextureNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.uuid,t.uv=this.uv.toJSON(e).uuid,this.bias&&(t.bias=this.bias.toJSON(e).uuid)),t},TextureCubeUVNode.Nodes=function(){var e=new StructNode(["struct TextureCubeUVData {","\tvec2 uv_10;","\tvec2 uv_20;","\tfloat t;","}"].join("\n")),t=new FunctionNode(["int getFaceFromDirection(vec3 direction) {","\tvec3 absDirection = abs(direction);","\tint face = -1;","\tif( absDirection.x > absDirection.z ) {","\t\tif(absDirection.x > absDirection.y )","\t\t\tface = direction.x > 0.0 ? 0 : 3;","\t\telse","\t\t\tface = direction.y > 0.0 ? 1 : 4;","\t}","\telse {","\t\tif(absDirection.z > absDirection.y )","\t\t\tface = direction.z > 0.0 ? 2 : 5;","\t\telse","\t\t\tface = direction.y > 0.0 ? 1 : 4;","\t}","\treturn face;","}"].join("\n")),r=new ConstNode("#define cubeUV_maxLods1 ( log2( cubeUV_textureSize * 0.25 ) - 1.0 )"),n=new ConstNode("#define cubeUV_rangeClamp ( exp2( ( 6.0 - 1.0 ) * 2.0 ) )"),i=new FunctionNode(["vec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness, in float cubeUV_textureSize ) {","\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);","\tfloat dxRoughness = dFdx(roughness);","\tfloat dyRoughness = dFdy(roughness);","\tvec3 dx = dFdx( vec * scale * dxRoughness );","\tvec3 dy = dFdy( vec * scale * dyRoughness );","\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );","\td = clamp(d, 1.0, cubeUV_rangeClamp);","\tfloat mipLevel = 0.5 * log2(d);","\treturn vec2(floor(mipLevel), fract(mipLevel));","}"].join("\n"),[r,n],{derivatives:!0}),o=new ConstNode("#define cubeUV_maxLods2 ( log2( cubeUV_textureSize * 0.25 ) - 2.0 )"),a=new ConstNode("#define cubeUV_rcpTextureSize ( 1.0 / cubeUV_textureSize )"),s=new FunctionNode(["vec2 getCubeUV( vec3 direction, float roughnessLevel, float mipLevel, in float cubeUV_textureSize ) {","\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;","\tfloat a = 16.0 * cubeUV_rcpTextureSize;","","\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );","\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;","\tfloat powScale = exp2_packed.x * exp2_packed.y;","\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;","\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;","","\tbool bRes = mipLevel == 0.0;","\tscale =  bRes && (scale < a) ? a : scale;","","\tvec3 r;","\tvec2 offset;","\tint face = getFaceFromDirection(direction);","","\tfloat rcpPowScale = 1.0 / powScale;","","\tif( face == 0) {","\t\tr = vec3(direction.x, -direction.z, direction.y);","\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);","\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;","\t}","\telse if( face == 1) {","\t\tr = vec3(direction.y, direction.x, direction.z);","\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);","\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;","\t}","\telse if( face == 2) {","\t\tr = vec3(direction.z, direction.x, direction.y);","\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);","\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;","\t}","\telse if( face == 3) {","\t\tr = vec3(direction.x, direction.z, direction.y);","\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);","\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;","\t}","\telse if( face == 4) {","\t\tr = vec3(direction.y, direction.x, -direction.z);","\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);","\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;","\t}","\telse {","\t\tr = vec3(direction.z, -direction.x, direction.y);","\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);","\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;","\t}","\tr = normalize(r);","\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;","\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;","\tvec2 base = offset + vec2( texelOffset );","\treturn base + s * ( scale - 2.0 * texelOffset );","}"].join("\n"),[o,a,t]),l=new ConstNode("#define cubeUV_maxLods3 ( log2( cubeUV_textureSize * 0.25 ) - 3.0 )");return{TextureCubeUVData:e,textureCubeUV:new FunctionNode(["TextureCubeUVData textureCubeUV( vec3 reflectedDirection, float roughness, in float cubeUV_textureSize ) {","\tfloat roughnessVal = roughness * cubeUV_maxLods3;","\tfloat r1 = floor(roughnessVal);","\tfloat r2 = r1 + 1.0;","\tfloat t = fract(roughnessVal);","\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness, cubeUV_textureSize);","\tfloat s = mipInfo.y;","\tfloat level0 = mipInfo.x;","\tfloat level1 = level0 + 1.0;","\tlevel1 = level1 > 5.0 ? 5.0 : level1;","","\tlevel0 += min( floor( s + 0.5 ), 5.0 );","","\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0, cubeUV_textureSize);","\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0, cubeUV_textureSize);","","\treturn TextureCubeUVData(uv_10, uv_20, t);","}"].join("\n"),[e,l,i,s])}}(),TextureCubeUVNode.prototype=Object.create(TempNode.prototype),TextureCubeUVNode.prototype.constructor=TextureCubeUVNode,TextureCubeUVNode.prototype.nodeType="TextureCubeUV",TextureCubeUVNode.prototype.generate=function(e,t){if(e.isShader("fragment")){var r=e.include(TextureCubeUVNode.Nodes.textureCubeUV);return e.format(r+"( "+this.uv.build(e,"v3")+", "+this.blinnExponentToRoughness.build(e,"f")+", "+this.textureSize.build(e,"f")+" )",this.getType(e),t)}return console.warn("TextureCubeUVNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)},TextureCubeUVNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).uv=this.uv.toJSON(e).uuid,t.textureSize=this.textureSize.toJSON(e).uuid,t.blinnExponentToRoughness=this.blinnExponentToRoughness.toJSON(e).uuid),t},TextureCubeNode.prototype=Object.create(TempNode.prototype),TextureCubeNode.prototype.constructor=TextureCubeNode,TextureCubeNode.prototype.nodeType="TextureCube",TextureCubeNode.prototype.generate=function(e,t){if(e.isShader("fragment")){var r=this.uv.build(e)+".uv_10",n=this.uv.build(e)+".uv_20",i=this.uv.build(e)+".t",o=e.getTexelDecodingFunctionFromTexture("texture2D( "+this.value.build(e,"sampler2D")+", "+r+" )",this.value.value),a=e.getTexelDecodingFunctionFromTexture("texture2D( "+this.value.build(e,"sampler2D")+", "+n+" )",this.value.value);return e.format("vec4( mix( "+o+", "+a+", "+i+" ).rgb, 1.0 )",this.getType(e),t)}return console.warn("TextureCubeNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)},TextureCubeNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).uv=this.uv.toJSON(e).uuid,t.textureSize=this.textureSize.toJSON(e).uuid,t.blinnExponentToRoughness=this.blinnExponentToRoughness.toJSON(e).uuid,this.roughness&&(t.roughness=this.roughness.toJSON(e).uuid)),t};var elements=NodeUtils.elements,constructors=["float","vec2","vec3","vec4"],convertFormatToType={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b"},convertTypeToFormat={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4"};function NodeBuilder(){this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.requires={uv:[],color:[],lights:!1,fog:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","\t#define texCube(a, b) textureCube(a, b)","\t#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","\t#define tex2D(a, b) texture2D(a, b)","\t#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","\t#define texCube(a, b) textureCube(a, b)","\t#define texCubeBias(a, b, c) textureCube(a, b, c)","\t#define tex2D(a, b) texture2D(a, b)","\t#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif","#include <packing>","#include <common>"].join("\n"),this.parsCode={vertex:"",fragment:""},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={},this.updaters=[],this.nodes=[],this.parsing=!1,this.optimize=!0}function NodeFrame(e){this.time=void 0!==e?e:0,this.id=0}function VarNode(e,t){Node$1.call(this,e),this.value=t}function BlurNode(e,t,r,n){TempNode.call(this,"v4"),this.value=e,this.uv=t||new UVNode,this.radius=new Vector2Node(1,1),this.size=n,this.blurX=!0,this.blurY=!0,this.horizontal=new FloatNode(1/64),this.vertical=new FloatNode(1/64)}function LuminanceNode(e){TempNode.call(this,"f"),this.rgb=e}function ColorAdjustmentNode(e,t,r){TempNode.call(this,"v3"),this.rgb=e,this.adjustment=t,this.method=r||ColorAdjustmentNode.SATURATION}function BoolNode(e){InputNode.call(this,"b"),this.value=Boolean(e)}function ColorNode(e,t,r){InputNode.call(this,"c"),this.value=e instanceof Color?e:new Color(e||0,t,r)}function IntNode(e){InputNode.call(this,"i"),this.value=Math.floor(e||0)}function Matrix3Node(e){InputNode.call(this,"m3"),this.value=e||new Matrix3}function Matrix4Node(e){InputNode.call(this,"m4"),this.value=e||new Matrix4}function PropertyNode(e,t,r){InputNode.call(this,r),this.object=e,this.property=t}function OperatorNode(e,t,r){TempNode.call(this),this.a=e,this.b=t,this.op=r}function ReflectorNode(e){TempNode.call(this,"v4"),e&&this.setMirror(e)}function RawNode(e){Node$1.call(this,"v4"),this.value=e}function NodeMaterial(e,t){ShaderMaterial.call(this),this.vertex=e||new RawNode(new PositionNode(PositionNode.PROJECTION)),this.fragment=t||new RawNode(new ColorNode(16711680)),this.updaters=[]}function RTTNode(e,t,r,n){n=n||{},this.input=r,this.clear=void 0===n.clear||n.clear,this.renderTarget=new WebGLRenderTarget(e,t,n),this.material=new NodeMaterial,this.camera=new OrthographicCamera(-1,1,1,-1,0,1),this.scene=new Scene,this.quad=new Mesh(new PlaneBufferGeometry(2,2),this.material),this.quad.frustumCulled=!1,this.scene.add(this.quad),this.render=!0,TextureNode.call(this,this.renderTarget.texture)}function ScreenNode(e){TextureNode.call(this,void 0,e)}function StandardNode(){Node$1.call(this),this.color=new ColorNode(15658734),this.roughness=new FloatNode(.5),this.metalness=new FloatNode(.5)}function SwitchNode(e,t){Node$1.call(this),this.node=e,this.components=t||"x"}function NormalMapNode(e,t){TempNode.call(this,"v3"),this.value=e,this.scale=t||new Vector2Node(1,1)}function MeshStandardNode(){StandardNode.call(this),this.properties={color:new Color(16777215),roughness:.5,metalness:.5,normalScale:new Vector2(1,1)},this.inputs={color:new PropertyNode(this.properties,"color","c"),roughness:new PropertyNode(this.properties,"roughness","f"),metalness:new PropertyNode(this.properties,"metalness","f"),normalScale:new PropertyNode(this.properties,"normalScale","v2")}}function MeshStandardNodeMaterial(){var e=new MeshStandardNode;NodeMaterial.call(this,e,e),this.type="MeshStandardNodeMaterial"}function PhongNode(){Node$1.call(this),this.color=new ColorNode(15658734),this.specular=new ColorNode(1118481),this.shininess=new FloatNode(30)}function SpriteNode(){Node$1.call(this),this.color=new ColorNode(15658734),this.spherical=!0}function PhongNodeMaterial(){var e=new PhongNode;NodeMaterial.call(this,e,e),this.type="PhongNodeMaterial"}function SpriteNodeMaterial(){var e=new SpriteNode;NodeMaterial.call(this,e,e),this.type="SpriteNodeMaterial"}function StandardNodeMaterial(){var e=new StandardNode;NodeMaterial.call(this,e,e),this.type="StandardNodeMaterial"}function CondNode(e,t,r,n,i){TempNode.call(this),this.a=e,this.b=t,this.op=r,this.ifNode=n,this.elseNode=i}function Math1Node(e,t){TempNode.call(this),this.a=e,this.method=t}function Math2Node(e,t,r){TempNode.call(this),this.a=e,this.b=t,this.method=r}function Math3Node(e,t,r,n){TempNode.call(this),this.a=e,this.b=t,this.c=r,this.method=n}function BumpMapNode(e,t){TempNode.call(this,"v3"),this.value=e,this.scale=t||new FloatNode(1),this.toNormalMap=!1}NodeBuilder.prototype={constructor:NodeBuilder,build:function(e,t){return this.buildShader("vertex",e),this.buildShader("fragment",t),this.requires.uv[0]&&(this.addVaryCode("varying vec2 vUv;"),this.addVertexFinalCode("vUv = uv;")),this.requires.uv[1]&&(this.addVaryCode("varying vec2 vUv2;"),this.addVertexParsCode("attribute vec2 uv2;"),this.addVertexFinalCode("vUv2 = uv2;")),this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition&&(this.addVaryCode("varying vec3 vWPosition;"),this.addVertexFinalCode("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;")),this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = ( modelMatrix * vec4( objectNormal, 0.0 ) ).xyz;")),this},buildShader:function(e,t){this.resultCode[e]=t.build(this.setShader(e),"v4")},setMaterial:function(e,t){return this.material=e,this.renderer=t,this.requires.lights=e.lights,this.requires.fog=e.fog,this.mergeDefines(e.defines),this},addFlow:function(e,t,r){return this.addSlot(e).addCache(t).addContext(r)},removeFlow:function(){return this.removeSlot().removeCache().removeContext()},addCache:function(e){return this.cache=e||"",this.caches.push(this.cache),this},removeCache:function(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this},addContext:function(e){return this.context=Object.assign({},this.context,e),this.contexts.push(this.context),this},removeContext:function(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this},addSlot:function(e){return this.slot=e||"",this.slots.push(this.slot),this},removeSlot:function(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this},addVertexCode:function(e){this.addCode(e,"vertex")},addFragmentCode:function(e){this.addCode(e,"fragment")},addCode:function(e,t){this.code[t||this.shader]+=e+"\n"},addVertexNodeCode:function(e){this.addNodeCode(e,"vertex")},addFragmentNodeCode:function(e){this.addNodeCode(e,"fragment")},addNodeCode:function(e,t){this.nodeCode[t||this.shader]+=e+"\n"},clearNodeCode:function(e){e=e||this.shader;var t=this.nodeCode[e];return this.nodeCode[e]="",t},clearVertexNodeCode:function(){return this.clearNodeCode("vertex")},clearFragmentNodeCode:function(){return this.clearNodeCode("fragment")},addVertexFinalCode:function(e){this.addFinalCode(e,"vertex")},addFragmentFinalCode:function(e){this.addFinalCode(e,"fragment")},addFinalCode:function(e,t){this.finalCode[t||this.shader]+=e+"\n"},addVertexParsCode:function(e){this.addParsCode(e,"vertex")},addFragmentParsCode:function(e){this.addParsCode(e,"fragment")},addParsCode:function(e,t){this.parsCode[t||this.shader]+=e+"\n"},addVaryCode:function(e){this.addVertexParsCode(e),this.addFragmentParsCode(e)},isCache:function(e){return-1!==this.caches.indexOf(e)},isSlot:function(e){return-1!==this.slots.indexOf(e)},define:function(e,t){this.defines[e]=void 0===t?1:t},isDefined:function(e){return void 0!==this.defines[e]},getVar:function(e,t,r,n,i,o){void 0===n&&(n="varying"),void 0===i&&(i="V"),void 0===o&&(o="");var a=this.getVars(n),s=a[e];if(!s){var l=a.length;s={name:r||"node"+i+l+(o?"_"+o:""),type:t},a.push(s),a[e]=s}return s},getTempVar:function(e,t,r,n){return this.getVar(e,t,r,this.shader,"T",n)},getAttribute:function(e,t){if(!this.attributes[e]){var r=this.getVar(e,t);this.addVertexParsCode("attribute "+t+" "+e+";"),this.addVertexFinalCode(r.name+" = "+e+";"),this.attributes[e]={varying:r,name:e,type:t}}return this.attributes[e]},getCode:function(e){return[this.prefixCode,this.parsCode[e],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[e],"uniform"),this.getIncludesCode("consts",e),this.getIncludesCode("structs",e),this.getIncludesCode("functions",e),"void main() {",this.getVarListCode(this.getVars(e)),this.code[e],this.resultCode[e],this.finalCode[e],"}"].join("\n")},getVarListCode:function(e,t){t=t||"";for(var r="",n=0,i=e.length;n<i;++n){var o=e[n],a=o.type,s=o.name,l=this.getFormatByType(a);if(void 0===l)throw new Error("Node pars "+l+" not found.");r+=t+" "+l+" "+s+";\n"}return r},getVars:function(e){return this.inputs.vars[e||this.shader]},getNodeData:function(e){var t=e.isNode?e.uuid:e;return this.nodeData[t]=this.nodeData[t]||{}},createUniform:function(e,t,r,n,i,o){var a=this.inputs.uniforms,s=a.list.length,l=new NodeUniform({type:t,name:n||"nodeU"+s+(o?"_"+o:""),node:r,needsUpdate:i});return a.list.push(l),a[e].push(l),a[e][l.name]=l,this.uniforms[l.name]=l,l},createVertexUniform:function(e,t,r,n,i){return this.createUniform("vertex",e,t,r,n,i)},createFragmentUniform:function(e,t,r,n,i){return this.createUniform("fragment",e,t,r,n,i)},include:function(e,t,r){var n;if(e="string"===typeof e?NodeLib.get(e):e,!1===this.context.include)return e.name;e instanceof FunctionNode?n=this.includes.functions:e instanceof ConstNode?n=this.includes.consts:e instanceof StructNode&&(n=this.includes.structs);var i=n[this.shader]=n[this.shader]||[];if(e){var o=i[e.name];if(o||(o=i[e.name]={node:e,deps:[]},i.push(o),o.src=e.build(this,"source")),e instanceof FunctionNode&&t&&i[t.name]&&-1==i[t.name].deps.indexOf(e)&&(i[t.name].deps.push(e),e.includes&&e.includes.length)){var a=0;do{this.include(e.includes[a++],t)}while(a<e.includes.length)}return r&&(o.src=r),e.name}throw new Error("Include not found.")},colorToVectorProperties:function(e){return e.replace("r","x").replace("g","y").replace("b","z").replace("a","w")},colorToVector:function(e){return e.replace(/c/g,"v3")},getIncludes:function(e,t){return this.includes[e][t||this.shader]},getIncludesCode:function(){function e(e,t){return e.deps.length-t.deps.length}return function(t,r){if(!(i=this.getIncludes(t,r)))return"";for(var n="",i=i.sort(e),o=0;o<i.length;o++)i[o].src&&(n+=i[o].src+"\n");return n}}(),getConstructorFromLength:function(e){return constructors[e-1]},isTypeMatrix:function(e){return/^m/.test(e)},getTypeLength:function(e){return"f"===e?1:parseInt(this.colorToVector(e).substr(1))},getTypeFromLength:function(e){return 1===e?"f":"v"+e},findNode:function(){for(var e=arguments,t=0;t<arguments.length;t++){var r=e[t];if(void 0!==r&&r.isNode)return r}},resolve:function(){for(var e=arguments,t=0;t<arguments.length;t++){var r=e[t];if(void 0!==r){if(r.isNode)return r;if(r.isTexture)switch(r.mapping){case CubeReflectionMapping:case CubeRefractionMapping:return new CubeTextureNode(r);case CubeUVReflectionMapping:case CubeUVRefractionMapping:return new TextureCubeNode(new TextureNode(r));default:return new TextureNode(r)}else{if(r.isVector2)return new Vector2Node(r);if(r.isVector3)return new Vector3Node(r);if(r.isVector4)return new Vector4Node(r)}}}},format:function(e,t,r){switch(this.colorToVector(r+" <- "+t)){case"f <- v2":case"f <- v3":case"f <- v4":return e+".x";case"f <- i":case"f <- b":return"float( "+e+" )";case"v2 <- f":return"vec2( "+e+" )";case"v2 <- v3":case"v2 <- v4":return e+".xy";case"v2 <- i":case"v2 <- b":return"vec2( float( "+e+" ) )";case"v3 <- f":return"vec3( "+e+" )";case"v3 <- v2":return"vec3( "+e+", 0.0 )";case"v3 <- v4":return e+".xyz";case"v3 <- i":case"v3 <- b":return"vec2( float( "+e+" ) )";case"v4 <- f":return"vec4( "+e+" )";case"v4 <- v2":return"vec4( "+e+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+e+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+e+" ) )";case"i <- f":case"i <- b":return"int( "+e+" )";case"i <- v2":case"i <- v3":case"i <- v4":return"int( "+e+".x )";case"b <- f":return"( "+e+" != 0.0 )";case"b <- v2":return"( "+e+" != vec2( 0.0 ) )";case"b <- v3":return"( "+e+" != vec3( 0.0 ) )";case"b <- v4":return"( "+e+" != vec4( 0.0 ) )";case"b <- i":return"( "+e+" != 0 )"}return e},getTypeByFormat:function(e){return convertFormatToType[e]||e},getFormatByType:function(e){return convertTypeToFormat[e]||e},getUuid:function(e,t){return(t=void 0===t||t)&&this.cache&&(e=this.cache+"-"+e),e},getElementByIndex:function(e){return elements[e]},getIndexByElement:function(e){return elements.indexOf(e)},isShader:function(e){return this.shader===e},setShader:function(e){return this.shader=e,this},mergeDefines:function(e){for(var t in e)this.defines[t]=e[t];return this.defines},mergeUniform:function(e){for(var t in e)this.uniforms[t]=e[t];return this.uniforms},getTextureEncodingFromMap:function(e,t){var r;return t=void 0!==t?t:this.context.gamma&&!!this.renderer&&this.renderer.gammaInput,e?e.isTexture?r=e.encoding:e.isWebGLRenderTarget&&(console.warn("WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),r=e.texture.encoding):r=LinearEncoding,r===LinearEncoding&&t&&(r=GammaEncoding),r}},NodeFrame.prototype={constructor:NodeFrame,update:function(e){return++this.id,this.time+=e,this.delta=e,this},setRenderer:function(e){return this.renderer=e,this},setRenderTexture:function(e){return this.renderTexture=e,this},updateNode:function(e){return e.frameId===this.id?this:(e.updateFrame(this),e.frameId=this.id,this)}},VarNode.prototype=Object.create(Node$1.prototype),VarNode.prototype.constructor=VarNode,VarNode.prototype.nodeType="Var",VarNode.prototype.getType=function(e){return e.getTypeByFormat(this.type)},VarNode.prototype.generate=function(e,t){var r=e.getVar(this.uuid,this.type);return this.value&&e.isShader("vertex")&&e.addNodeCode(r.name+" = "+this.value.build(e,this.getType(e))+";"),e.format(r.name,this.getType(e),t)},VarNode.prototype.copy=function(e){Node$1.prototype.copy.call(this,e),this.type=e.type,this.value=e.value},VarNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).type=this.type,this.value&&(t.value=this.value.toJSON(e).uuid)),t},BlurNode.Nodes={blurX:new FunctionNode(["vec4 blurX( sampler2D texture, vec2 uv, float s ) {","\tvec4 sum = vec4( 0.0 );","\tsum += texture2D( texture, vec2( uv.x - 4.0 * s, uv.y ) ) * 0.051;","\tsum += texture2D( texture, vec2( uv.x - 3.0 * s, uv.y ) ) * 0.0918;","\tsum += texture2D( texture, vec2( uv.x - 2.0 * s, uv.y ) ) * 0.12245;","\tsum += texture2D( texture, vec2( uv.x - 1.0 * s, uv.y ) ) * 0.1531;","\tsum += texture2D( texture, vec2( uv.x, uv.y ) ) * 0.1633;","\tsum += texture2D( texture, vec2( uv.x + 1.0 * s, uv.y ) ) * 0.1531;","\tsum += texture2D( texture, vec2( uv.x + 2.0 * s, uv.y ) ) * 0.12245;","\tsum += texture2D( texture, vec2( uv.x + 3.0 * s, uv.y ) ) * 0.0918;","\tsum += texture2D( texture, vec2( uv.x + 4.0 * s, uv.y ) ) * 0.051;","\treturn sum * .667;","}"].join("\n")),blurY:new FunctionNode(["vec4 blurY( sampler2D texture, vec2 uv, float s ) {","\tvec4 sum = vec4( 0.0 );","\tsum += texture2D( texture, vec2( uv.x, uv.y - 4.0 * s ) ) * 0.051;","\tsum += texture2D( texture, vec2( uv.x, uv.y - 3.0 * s ) ) * 0.0918;","\tsum += texture2D( texture, vec2( uv.x, uv.y - 2.0 * s ) ) * 0.12245;","\tsum += texture2D( texture, vec2( uv.x, uv.y - 1.0 * s ) ) * 0.1531;","\tsum += texture2D( texture, vec2( uv.x, uv.y ) ) * 0.1633;","\tsum += texture2D( texture, vec2( uv.x, uv.y + 1.0 * s ) ) * 0.1531;","\tsum += texture2D( texture, vec2( uv.x, uv.y + 2.0 * s ) ) * 0.12245;","\tsum += texture2D( texture, vec2( uv.x, uv.y + 3.0 * s ) ) * 0.0918;","\tsum += texture2D( texture, vec2( uv.x, uv.y + 4.0 * s ) ) * 0.051;","\treturn sum * .667;","}"].join("\n"))},BlurNode.prototype=Object.create(TempNode.prototype),BlurNode.prototype.constructor=BlurNode,BlurNode.prototype.nodeType="Blur",BlurNode.prototype.updateFrame=function(e){if(this.size)this.horizontal.value=this.radius.x/this.size.x,this.vertical.value=this.radius.y/this.size.y;else if(this.value.value&&this.value.value.image){var t=this.value.value.image;this.horizontal.value=this.radius.x/t.width,this.vertical.value=this.radius.y/t.height}},BlurNode.prototype.generate=function(e,t){if(e.isShader("fragment")){var r,n=[],i=e.include(BlurNode.Nodes.blurX),o=e.include(BlurNode.Nodes.blurY);return this.blurX&&n.push(i+"( "+this.value.build(e,"sampler2D")+", "+this.uv.build(e,"v2")+", "+this.horizontal.build(e,"f")+" )"),this.blurY&&n.push(o+"( "+this.value.build(e,"sampler2D")+", "+this.uv.build(e,"v2")+", "+this.vertical.build(e,"f")+" )"),r=2==n.length?"( "+n.join(" + ")+" / 2.0 )":n.length?"( "+n[0]+" )":"vec4( 0.0 )",e.format(r,this.getType(e),t)}return console.warn("BlurNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)},BlurNode.prototype.copy=function(e){TempNode.prototype.copy.call(this,e),this.value=e.value,this.uv=e.uv,this.radius=e.radius,void 0!==e.size&&(this.size=new Vector2(e.size.x,e.size.y)),this.blurX=e.blurX,this.blurY=e.blurY},BlurNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid,t.uv=this.uv.toJSON(e).uuid,t.radius=this.radius.toJSON(e).uuid,this.size&&(t.size={x:this.size.x,y:this.size.y}),t.blurX=this.blurX,t.blurY=this.blurY),t},LuminanceNode.Nodes=function(){var e=new ConstNode("vec3 LUMA vec3( 0.2125, 0.7154, 0.0721 )");return{LUMA:e,luminance:new FunctionNode(["float luminance( vec3 rgb ) {","\treturn dot( rgb, LUMA );","}"].join("\n"),[e])}}(),LuminanceNode.prototype=Object.create(TempNode.prototype),LuminanceNode.prototype.constructor=LuminanceNode,LuminanceNode.prototype.nodeType="Luminance",LuminanceNode.prototype.generate=function(e,t){var r=e.include(LuminanceNode.Nodes.luminance);return e.format(r+"( "+this.rgb.build(e,"v3")+" )",this.getType(e),t)},LuminanceNode.prototype.copy=function(e){TempNode.prototype.copy.call(this,e),this.rgb=e.rgb},LuminanceNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).rgb=this.rgb.toJSON(e).uuid),t},ColorAdjustmentNode.Nodes={hue:new FunctionNode(["vec3 hue(vec3 rgb, float adjustment) {","\tconst mat3 RGBtoYIQ = mat3(0.299, 0.587, 0.114, 0.595716, -0.274453, -0.321263, 0.211456, -0.522591, 0.311135);","\tconst mat3 YIQtoRGB = mat3(1.0, 0.9563, 0.6210, 1.0, -0.2721, -0.6474, 1.0, -1.107, 1.7046);","\tvec3 yiq = RGBtoYIQ * rgb;","\tfloat hue = atan(yiq.z, yiq.y) + adjustment;","\tfloat chroma = sqrt(yiq.z * yiq.z + yiq.y * yiq.y);","\treturn YIQtoRGB * vec3(yiq.x, chroma * cos(hue), chroma * sin(hue));","}"].join("\n")),saturation:new FunctionNode(["vec3 saturation(vec3 rgb, float adjustment) {","\tvec3 intensity = vec3( luminance( rgb ) );","\treturn mix( intensity, rgb, adjustment );","}"].join("\n"),[LuminanceNode.Nodes.luminance]),vibrance:new FunctionNode(["vec3 vibrance(vec3 rgb, float adjustment) {","\tfloat average = (rgb.r + rgb.g + rgb.b) / 3.0;","\tfloat mx = max(rgb.r, max(rgb.g, rgb.b));","\tfloat amt = (mx - average) * (-3.0 * adjustment);","\treturn mix(rgb.rgb, vec3(mx), amt);","}"].join("\n"))},ColorAdjustmentNode.SATURATION="saturation",ColorAdjustmentNode.HUE="hue",ColorAdjustmentNode.VIBRANCE="vibrance",ColorAdjustmentNode.BRIGHTNESS="brightness",ColorAdjustmentNode.CONTRAST="contrast",ColorAdjustmentNode.prototype=Object.create(TempNode.prototype),ColorAdjustmentNode.prototype.constructor=ColorAdjustmentNode,ColorAdjustmentNode.prototype.nodeType="ColorAdjustment",ColorAdjustmentNode.prototype.generate=function(e,t){var r=this.rgb.build(e,"v3"),n=this.adjustment.build(e,"f");switch(this.method){case ColorAdjustmentNode.BRIGHTNESS:return e.format("( "+r+" + "+n+" )",this.getType(e),t);case ColorAdjustmentNode.CONTRAST:return e.format("( "+r+" * "+n+" )",this.getType(e),t)}var i=e.include(ColorAdjustmentNode.Nodes[this.method]);return e.format(i+"( "+r+", "+n+" )",this.getType(e),t)},ColorAdjustmentNode.prototype.copy=function(e){TempNode.prototype.copy.call(this,e),this.rgb=e.rgb,this.adjustment=e.adjustment,this.method=e.method},ColorAdjustmentNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).rgb=this.rgb.toJSON(e).uuid,t.adjustment=this.adjustment.toJSON(e).uuid,t.method=this.method),t},BoolNode.prototype=Object.create(InputNode.prototype),BoolNode.prototype.constructor=BoolNode,BoolNode.prototype.nodeType="Bool",BoolNode.prototype.generateReadonly=function(e,t,r,n,i,o){return e.format(this.value,n,t)},BoolNode.prototype.copy=function(e){InputNode.prototype.copy.call(this,e),this.value=e.value},BoolNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value,!0===this.readonly&&(t.readonly=!0)),t},ColorNode.prototype=Object.create(InputNode.prototype),ColorNode.prototype.constructor=ColorNode,ColorNode.prototype.nodeType="Color",NodeUtils.addShortcuts(ColorNode.prototype,"value",["r","g","b"]),ColorNode.prototype.generateReadonly=function(e,t,r,n,i,o){return e.format("vec3( "+this.r+", "+this.g+", "+this.b+" )",n,t)},ColorNode.prototype.copy=function(e){InputNode.prototype.copy.call(this,e),this.value.copy(e)},ColorNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).r=this.r,t.g=this.g,t.b=this.b,!0===this.readonly&&(t.readonly=!0)),t},IntNode.prototype=Object.create(InputNode.prototype),IntNode.prototype.constructor=IntNode,IntNode.prototype.nodeType="Int",IntNode.prototype.generateReadonly=function(e,t,r,n,i,o){return e.format(this.value,n,t)},IntNode.prototype.copy=function(e){InputNode.prototype.copy.call(this,e),this.value=e.value},IntNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value,!0===this.readonly&&(t.readonly=!0)),t},Matrix3Node.prototype=Object.create(InputNode.prototype),Matrix3Node.prototype.constructor=Matrix3Node,Matrix3Node.prototype.nodeType="Matrix3",Object.defineProperties(Matrix3Node.prototype,{elements:{set:function(e){this.value.elements=e},get:function(){return this.value.elements}}}),Matrix3Node.prototype.generateReadonly=function(e,t,r,n,i,o){return e.format("mat3( "+this.value.elements.join(", ")+" )",n,t)},Matrix3Node.prototype.copy=function(e){InputNode.prototype.copy.call(this,e),this.value.fromArray(e.elements)},Matrix3Node.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).elements=this.value.elements.concat()),t},Matrix4Node.prototype=Object.create(InputNode.prototype),Matrix4Node.prototype.constructor=Matrix4Node,Matrix4Node.prototype.nodeType="Matrix4",Object.defineProperties(Matrix4Node.prototype,{elements:{set:function(e){this.value.elements=e},get:function(){return this.value.elements}}}),Matrix4Node.prototype.generateReadonly=function(e,t,r,n,i,o){return e.format("mat4( "+this.value.elements.join(", ")+" )",n,t)},Matrix4Node.prototype.copy=function(e){InputNode.prototype.copy.call(this,e),this.scope.value.fromArray(e.elements)},Matrix4Node.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).elements=this.value.elements.concat()),t},PropertyNode.prototype=Object.create(InputNode.prototype),PropertyNode.prototype.constructor=PropertyNode,PropertyNode.prototype.nodeType="Property",Object.defineProperties(PropertyNode.prototype,{value:{get:function(){return this.object[this.property]},set:function(e){this.object[this.property]=e}}}),PropertyNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value,t.property=this.property),t},OperatorNode.ADD="+",OperatorNode.SUB="-",OperatorNode.MUL="*",OperatorNode.DIV="/",OperatorNode.prototype=Object.create(TempNode.prototype),OperatorNode.prototype.constructor=OperatorNode,OperatorNode.prototype.nodeType="Operator",OperatorNode.prototype.getType=function(e){var t=this.a.getType(e),r=this.b.getType(e);return e.isTypeMatrix(t)?"v4":e.getTypeLength(r)>e.getTypeLength(t)?r:t},OperatorNode.prototype.generate=function(e,t){e.getNodeData(this);var r=this.getType(e),n=this.a.build(e,r),i=this.b.build(e,r);return e.format("( "+n+" "+this.op+" "+i+" )",r,t)},OperatorNode.prototype.copy=function(e){TempNode.prototype.copy.call(this,e),this.a=e.a,this.b=e.b,this.op=e.op},OperatorNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).a=this.a.toJSON(e).uuid,t.b=this.b.toJSON(e).uuid,t.op=this.op),t},ReflectorNode.prototype=Object.create(TempNode.prototype),ReflectorNode.prototype.constructor=ReflectorNode,ReflectorNode.prototype.nodeType="Reflector",ReflectorNode.prototype.setMirror=function(e){this.mirror=e,this.textureMatrix=new Matrix4Node(this.mirror.material.uniforms.textureMatrix.value),this.localPosition=new PositionNode(PositionNode.LOCAL),this.uv=new OperatorNode(this.textureMatrix,this.localPosition,OperatorNode.MUL),this.uvResult=new OperatorNode(null,this.uv,OperatorNode.ADD),this.texture=new TextureNode(this.mirror.material.uniforms.tDiffuse.value,this.uv,null,!0)},ReflectorNode.prototype.generate=function(e,t){return e.isShader("fragment")?(this.uvResult.a=this.offset,this.texture.uv=this.offset?this.uvResult:this.uv,"sampler2D"===t?this.texture.build(e,t):e.format(this.texture.build(e,this.type),this.type,t)):(console.warn("ReflectorNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.type,t))},ReflectorNode.prototype.copy=function(e){InputNode.prototype.copy.call(this,e),this.scope.mirror=e.mirror},ReflectorNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).mirror=this.mirror.uuid,this.offset&&(t.offset=this.offset.toJSON(e).uuid)),t},RawNode.prototype=Object.create(Node$1.prototype),RawNode.prototype.constructor=RawNode,RawNode.prototype.nodeType="Raw",RawNode.prototype.generate=function(e){var t=this.value.parseAndBuildCode(e,this.type),r=t.code+"\n";return e.isShader("vertex")?r+="gl_Position = "+t.result+";":r+="gl_FragColor = "+t.result+";",r},RawNode.prototype.copy=function(e){Node$1.prototype.copy.call(this,e),this.value=e.value},RawNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid),t},NodeMaterial.prototype=Object.create(ShaderMaterial.prototype),NodeMaterial.prototype.constructor=NodeMaterial,NodeMaterial.prototype.type="NodeMaterial",NodeMaterial.prototype.isNodeMaterial=!0,Object.defineProperties(NodeMaterial.prototype,{properties:{get:function(){return this.fragment.properties}}}),NodeMaterial.prototype.updateFrame=function(e){for(var t=0;t<this.updaters.length;++t)e.updateNode(this.updaters[t])},NodeMaterial.prototype.onBeforeCompile=function(e,t){this.needsUpdate&&(this.build({renderer:t}),e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader)},NodeMaterial.prototype.build=function(e){var t=(e=e||{}).builder||new NodeBuilder;return t.setMaterial(this,e.renderer),t.build(this.vertex,this.fragment),this.vertexShader=t.getCode("vertex"),this.fragmentShader=t.getCode("fragment"),this.defines=t.defines,this.uniforms=t.uniforms,this.extensions=t.extensions,this.updaters=t.updaters,this.fog=t.requires.fog,this.lights=t.requires.lights,this.transparent=t.requires.transparent||this.blending>NormalBlending,this.needsUpdate=!1,this},NodeMaterial.prototype.copy=function(e){var t=this.uuid;for(var r in e)this[r]=e[r];this.uuid=t,void 0!==e.userData&&(this.userData=JSON.parse(JSON.stringify(e.userData)))},NodeMaterial.prototype.toJSON=function(e){if((void 0===e||"string"===typeof e)&&(e={nodes:{}}),e&&!e.materials&&(e.materials={}),!e.materials[this.uuid]){var t={};t.uuid=this.uuid,t.type=this.type,e.materials[t.uuid]=t,""!==this.name&&(t.name=this.name),void 0!==this.size&&(t.size=this.size),void 0!==this.sizeAttenuation&&(t.sizeAttenuation=this.sizeAttenuation),this.blending!==NormalBlending&&(t.blending=this.blending),!0===this.flatShading&&(t.flatShading=this.flatShading),this.side!==FrontSide&&(t.side=this.side),this.vertexColors!==NoColors&&(t.vertexColors=this.vertexColors),this.depthFunc!==LessEqualDepth&&(t.depthFunc=this.depthFunc),!1===this.depthTest&&(t.depthTest=this.depthTest),!1===this.depthWrite&&(t.depthWrite=this.depthWrite),1!==this.linewidth&&(t.linewidth=this.linewidth),void 0!==this.dashSize&&(t.dashSize=this.dashSize),void 0!==this.gapSize&&(t.gapSize=this.gapSize),void 0!==this.scale&&(t.scale=this.scale),!0===this.dithering&&(t.dithering=!0),!0===this.wireframe&&(t.wireframe=this.wireframe),this.wireframeLinewidth>1&&(t.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(t.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(t.wireframeLinejoin=this.wireframeLinejoin),this.alphaTest>0&&(t.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(t.premultipliedAlpha=this.premultipliedAlpha),!0===this.morphTargets&&(t.morphTargets=!0),!0===this.skinning&&(t.skinning=!0),!1===this.visible&&(t.visible=!1),"{}"!==JSON.stringify(this.userData)&&(t.userData=this.userData),t.fog=this.fog,t.lights=this.lights,t.vertex=this.vertex.toJSON(e).uuid,t.fragment=this.fragment.toJSON(e).uuid}return e.material=this.uuid,e},RTTNode.prototype=Object.create(TextureNode.prototype),RTTNode.prototype.constructor=RTTNode,RTTNode.prototype.nodeType="RTT",RTTNode.prototype.build=function(e,t,r){var n=new NodeBuilder;return n.nodes=e.nodes,n.updaters=e.updaters,this.material.fragment.value=this.input,this.material.build({builder:n}),TextureNode.prototype.build.call(this,e,t,r)},RTTNode.prototype.updateFramesaveTo=function(e){if(this.saveTo.render=!1,this.saveTo!==this.saveToCurrent){this.saveToMaterial&&this.saveToMaterial.dispose();var t=new NodeMaterial;t.fragment.value=this,t.build();var r=new Scene,n=new Mesh(new PlaneBufferGeometry(2,2),t);n.frustumCulled=!1,r.add(n),this.saveToScene=r,this.saveToMaterial=t}this.saveToCurrent=this.saveTo,e.renderer.setRenderTarget(this.saveTo.renderTarget),this.saveTo.clear&&e.renderer.clear(),e.renderer.render(this.saveToScene,this.camera)},RTTNode.prototype.updateFrame=function(e){e.renderer?(this.saveTo&&!1===this.saveTo.render&&this.updateFramesaveTo(e),this.render&&(this.material.uniforms.renderTexture&&(this.material.uniforms.renderTexture.value=e.renderTexture),e.renderer.setRenderTarget(this.renderTarget),this.clear&&e.renderer.clear(),e.renderer.render(this.scene,this.camera)),this.saveTo&&!0===this.saveTo.render&&this.updateFramesaveTo(e)):console.warn("RTTNode need a renderer in NodeFrame")},RTTNode.prototype.copy=function(e){TextureNode.prototype.copy.call(this,e),this.saveTo=e.saveTo},RTTNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=TextureNode.prototype.toJSON.call(this,e),this.saveTo&&(t.saveTo=this.saveTo.toJSON(e).uuid)),t},ScreenNode.prototype=Object.create(TextureNode.prototype),ScreenNode.prototype.constructor=ScreenNode,ScreenNode.prototype.nodeType="Screen",ScreenNode.prototype.getUnique=function(){return!0},ScreenNode.prototype.getTexture=function(e,t){return InputNode.prototype.generate.call(this,e,t,this.getUuid(),"t","renderTexture")},StandardNode.prototype=Object.create(Node$1.prototype),StandardNode.prototype.constructor=StandardNode,StandardNode.prototype.nodeType="Standard",StandardNode.prototype.build=function(e){var t;if(e.define(this.clearCoat||this.clearCoatRoughness?"PHYSICAL":"STANDARD"),e.requires.lights=!0,e.extensions.shaderTextureLOD=!0,e.isShader("vertex")){var r=this.position?this.position.parseAndBuildCode(e,"v3",{cache:"position"}):void 0;e.mergeUniform(UniformsUtils.merge([UniformsLib.fog,UniformsLib.lights])),e.addParsCode(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif","#include <fog_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","#include <shadowmap_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));var n=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#ifndef FLAT_SHADED","\tvNormal = normalize( transformedNormal );","#endif","#include <begin_vertex>"];r&&n.push(r.code,r.result?"transformed = "+r.result+";":""),n.push("#include <morphtarget_vertex>","#include <skinning_vertex>","#include <project_vertex>","#include <fog_vertex>","#include <logdepthbuf_vertex>","#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),t=n.join("\n")}else{var i={bias:RoughnessToBlinnExponentNode,gamma:!0},o={gamma:!0},a=!e.isDefined("STANDARD");this.mask&&this.mask.parse(e),this.color.parse(e,{slot:"color",context:o}),this.roughness.parse(e),this.metalness.parse(e),this.alpha&&this.alpha.parse(e),this.normal&&this.normal.parse(e),this.clearCoat&&this.clearCoat.parse(e),this.clearCoatRoughness&&this.clearCoatRoughness.parse(e),this.reflectivity&&this.reflectivity.parse(e),this.light&&this.light.parse(e,{cache:"light"}),this.ao&&this.ao.parse(e),this.ambient&&this.ambient.parse(e),this.shadow&&this.shadow.parse(e),this.emissive&&this.emissive.parse(e,{slot:"emissive"}),this.environment&&this.environment.parse(e,{cache:"env",context:i,slot:"environment"});var s=this.mask?this.mask.buildCode(e,"b"):void 0,l=this.color.buildCode(e,"c",{slot:"color",context:o}),u=this.roughness.buildCode(e,"f"),c=this.metalness.buildCode(e,"f"),h=this.alpha?this.alpha.buildCode(e,"f"):void 0,p=this.normal?this.normal.buildCode(e,"v3"):void 0,f=this.clearCoat?this.clearCoat.buildCode(e,"f"):void 0,d=this.clearCoatRoughness?this.clearCoatRoughness.buildCode(e,"f"):void 0,m=this.reflectivity?this.reflectivity.buildCode(e,"f"):void 0,v=this.light?this.light.buildCode(e,"v3",{cache:"light"}):void 0,g=this.ao?this.ao.buildCode(e,"f"):void 0,y=this.ambient?this.ambient.buildCode(e,"c"):void 0,b=this.shadow?this.shadow.buildCode(e,"c"):void 0,x=this.emissive?this.emissive.buildCode(e,"c",{slot:"emissive"}):void 0,w=this.environment?this.environment.buildCode(e,"c",{cache:"env",context:i,slot:"environment"}):void 0,S=a&&w?this.environment.buildCode(e,"c",{cache:"clearCoat",context:i,slot:"environment"}):void 0;e.requires.transparent=void 0!==h,e.addParsCode(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>","#include <logdepthbuf_pars_fragment>"].join("\n"));n=["#include <clipping_planes_fragment>","\t#include <normal_fragment_begin>","\tPhysicalMaterial material;","\tmaterial.diffuseColor = vec3( 1.0 );"];s&&n.push(s.code,"if ( ! "+s.result+" ) discard;"),n.push(l.code,"\tvec3 diffuseColor = "+l.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","#include <logdepthbuf_fragment>",u.code,"\tfloat roughnessFactor = "+u.result+";",c.code,"\tfloat metalnessFactor = "+c.result+";"),h&&n.push(h.code,"#ifdef ALPHATEST","\tif ( "+h.result+" <= ALPHATEST ) discard;","#endif"),p&&n.push(p.code,"normal = "+p.result+";"),n.push("material.diffuseColor = "+(v?"vec3( 1.0 )":"diffuseColor * (1.0 - metalnessFactor)")+";","material.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );"),f?n.push(f.code,"material.clearCoat = saturate( "+f.result+" );"):a&&n.push("material.clearCoat = 0.0;"),d?n.push(d.code,"material.clearCoatRoughness = clamp( "+d.result+", 0.04, 1.0 );"):a&&n.push("material.clearCoatRoughness = 0.0;"),m?n.push(m.code,"material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( "+m.result+" ) ), diffuseColor, metalnessFactor );"):n.push("material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor, metalnessFactor );"),n.push("#include <lights_fragment_begin>"),v&&(n.push(v.code,"reflectedLight.directDiffuse = "+v.result+";"),n.push("diffuseColor *= 1.0 - metalnessFactor;","reflectedLight.directDiffuse *= diffuseColor;","reflectedLight.indirectDiffuse *= diffuseColor;")),g&&n.push(g.code,"reflectedLight.indirectDiffuse *= "+g.result+";","float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );","reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, "+g.result+", material.specularRoughness );"),y&&n.push(y.code,"reflectedLight.indirectDiffuse += "+y.result+";"),b&&n.push(b.code,"reflectedLight.directDiffuse *= "+b.result+";","reflectedLight.directSpecular *= "+b.result+";"),x&&n.push(x.code,"reflectedLight.directDiffuse += "+x.result+";"),w&&(n.push(w.code),S&&n.push(S.code,"clearCoatRadiance += "+S.result+";"),n.push("radiance += "+w.result+";")),n.push("#include <lights_fragment_end>"),n.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular;"),h?n.push("gl_FragColor = vec4( outgoingLight, "+h.result+" );"):n.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),n.push("#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>","#include <premultiplied_alpha_fragment>","#include <dithering_fragment>"),t=n.join("\n")}return t},StandardNode.prototype.copy=function(e){Node$1.prototype.copy.call(this,e),e.position&&(this.position=e.position),this.color=e.color,this.roughness=e.roughness,this.metalness=e.metalness,e.mask&&(this.mask=e.mask),e.alpha&&(this.alpha=e.alpha),e.normal&&(this.normal=e.normal),e.clearCoat&&(this.clearCoat=e.clearCoat),e.clearCoatRoughness&&(this.clearCoatRoughness=e.clearCoatRoughness),e.reflectivity&&(this.reflectivity=e.reflectivity),e.light&&(this.light=e.light),e.shadow&&(this.shadow=e.shadow),e.ao&&(this.ao=e.ao),e.emissive&&(this.emissive=e.emissive),e.ambient&&(this.ambient=e.ambient),e.environment&&(this.environment=e.environment)},StandardNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.position&&(t.position=this.position.toJSON(e).uuid),t.color=this.color.toJSON(e).uuid,t.roughness=this.roughness.toJSON(e).uuid,t.metalness=this.metalness.toJSON(e).uuid,this.mask&&(t.mask=this.mask.toJSON(e).uuid),this.alpha&&(t.alpha=this.alpha.toJSON(e).uuid),this.normal&&(t.normal=this.normal.toJSON(e).uuid),this.clearCoat&&(t.clearCoat=this.clearCoat.toJSON(e).uuid),this.clearCoatRoughness&&(t.clearCoatRoughness=this.clearCoatRoughness.toJSON(e).uuid),this.reflectivity&&(t.reflectivity=this.reflectivity.toJSON(e).uuid),this.light&&(t.light=this.light.toJSON(e).uuid),this.shadow&&(t.shadow=this.shadow.toJSON(e).uuid),this.ao&&(t.ao=this.ao.toJSON(e).uuid),this.emissive&&(t.emissive=this.emissive.toJSON(e).uuid),this.ambient&&(t.ambient=this.ambient.toJSON(e).uuid),this.environment&&(t.environment=this.environment.toJSON(e).uuid)),t},SwitchNode.prototype=Object.create(Node$1.prototype),SwitchNode.prototype.constructor=SwitchNode,SwitchNode.prototype.nodeType="Switch",SwitchNode.prototype.getType=function(e){return e.getTypeFromLength(this.components.length)},SwitchNode.prototype.generate=function(e,t){var r=this.node.getType(e),n=this.node.build(e,r),i=e.getTypeLength(r)-1;if(i>0){var o,a=0,s=e.colorToVectorProperties(this.components),l=s.length;for(o=0;o<l;o++)a=Math.max(a,e.getIndexByElement(s.charAt(o)));for(a>i&&(a=i),n+=".",o=0;o<l;o++){s.charAt(o);var u=e.getIndexByElement(s.charAt(o));u>a&&(u=a),n+=e.getElementByIndex(u)}return e.format(n,this.getType(e),t)}return e.format(n,r,t)},SwitchNode.prototype.copy=function(e){Node$1.prototype.copy.call(this,e),this.node=e.node,this.components=e.components},SwitchNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).node=this.node.toJSON(e).uuid,t.components=this.components),t},NormalMapNode.Nodes={perturbNormal2Arb:new FunctionNode(["vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 map, vec2 mUv, vec2 normalScale ) {","\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );","\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );","\tvec2 st0 = dFdx( mUv.st );","\tvec2 st1 = dFdy( mUv.st );","\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );","\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );","\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );","\tvec3 N = normalize( surf_norm );","\tmat3 tsn = mat3( S, T, N );","\tvec3 mapN = map * 2.0 - 1.0;","\tmapN.xy *= normalScale;","\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );","\treturn normalize( tsn * mapN );","}"].join("\n"),null,{derivatives:!0})},NormalMapNode.prototype=Object.create(TempNode.prototype),NormalMapNode.prototype.constructor=NormalMapNode,NormalMapNode.prototype.nodeType="NormalMap",NormalMapNode.prototype.generate=function(e,t){if(e.isShader("fragment")){var r=e.include(NormalMapNode.Nodes.perturbNormal2Arb);return this.normal=this.normal||new NormalNode$1,this.position=this.position||new PositionNode(PositionNode.VIEW),this.uv=this.uv||new UVNode,e.format(r+"( -"+this.position.build(e,"v3")+", "+this.normal.build(e,"v3")+", "+this.value.build(e,"v3")+", "+this.uv.build(e,"v2")+", "+this.scale.build(e,"v2")+" )",this.getType(e),t)}return console.warn("NormalMapNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)},NormalMapNode.prototype.copy=function(e){TempNode.prototype.copy.call(this,e),this.value=e.value,this.scale=e.scale},NormalMapNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid,t.scale=this.scale.toJSON(e).uuid),t},MeshStandardNode.prototype=Object.create(StandardNode.prototype),MeshStandardNode.prototype.constructor=MeshStandardNode,MeshStandardNode.prototype.nodeType="MeshStandard",MeshStandardNode.prototype.build=function(e){var t=this.properties,r=this.inputs;if(e.isShader("fragment")){var n=e.findNode(t.color,r.color),i=e.resolve(t.map);this.color=i?new OperatorNode(n,i,OperatorNode.MUL):n;var o=e.findNode(t.roughness,r.roughness),a=e.resolve(t.roughnessMap);this.roughness=a?new OperatorNode(o,new SwitchNode(a,"g"),OperatorNode.MUL):o;var s=e.findNode(t.metalness,r.metalness),l=e.resolve(t.metalnessMap);this.metalness=l?new OperatorNode(s,new SwitchNode(l,"b"),OperatorNode.MUL):s,t.normalMap?(this.normal=new NormalMapNode(e.resolve(t.normalMap)),this.normal.scale=e.findNode(t.normalScale,r.normalScale)):this.normal=void 0,this.environment=e.resolve(t.envMap)}return StandardNode.prototype.build.call(this,e)},MeshStandardNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),console.warn(".toJSON not implemented in",this)),t},MeshStandardNodeMaterial.prototype=Object.create(NodeMaterial.prototype),MeshStandardNodeMaterial.prototype.constructor=MeshStandardNodeMaterial,NodeUtils.addShortcuts(MeshStandardNodeMaterial.prototype,"properties",["color","roughness","metalness","map","normalMap","normalScale","metalnessMap","roughnessMap","envMap"]),PhongNode.prototype=Object.create(Node$1.prototype),PhongNode.prototype.constructor=PhongNode,PhongNode.prototype.nodeType="Phong",PhongNode.prototype.build=function(e){var t;if(e.define("PHONG"),e.requires.lights=!0,e.isShader("vertex")){var r=this.position?this.position.parseAndBuildCode(e,"v3",{cache:"position"}):void 0;e.mergeUniform(UniformsUtils.merge([UniformsLib.fog,UniformsLib.lights])),e.addParsCode(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif","#include <fog_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","#include <shadowmap_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));var n=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#ifndef FLAT_SHADED","\tvNormal = normalize( transformedNormal );","#endif","#include <begin_vertex>"];r&&n.push(r.code,r.result?"transformed = "+r.result+";":""),n.push("\t#include <morphtarget_vertex>","\t#include <skinning_vertex>","\t#include <project_vertex>","\t#include <fog_vertex>","\t#include <logdepthbuf_vertex>","\t#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\t#include <shadowmap_vertex>","\t#include <fog_vertex>"),t=n.join("\n")}else{this.mask&&this.mask.parse(e),this.color.parse(e,{slot:"color"}),this.specular.parse(e),this.shininess.parse(e),this.alpha&&this.alpha.parse(e),this.normal&&this.normal.parse(e),this.light&&this.light.parse(e,{cache:"light"}),this.ao&&this.ao.parse(e),this.ambient&&this.ambient.parse(e),this.shadow&&this.shadow.parse(e),this.emissive&&this.emissive.parse(e,{slot:"emissive"}),this.environment&&this.environment.parse(e,{slot:"environment"}),this.environmentAlpha&&this.environment&&this.environmentAlpha.parse(e);var i=this.mask?this.mask.buildCode(e,"b"):void 0,o=this.color.buildCode(e,"c",{slot:"color"}),a=this.specular.buildCode(e,"c"),s=this.shininess.buildCode(e,"f"),l=this.alpha?this.alpha.buildCode(e,"f"):void 0,u=this.normal?this.normal.buildCode(e,"v3"):void 0,c=this.light?this.light.buildCode(e,"v3",{cache:"light"}):void 0,h=this.ao?this.ao.buildCode(e,"f"):void 0,p=this.ambient?this.ambient.buildCode(e,"c"):void 0,f=this.shadow?this.shadow.buildCode(e,"c"):void 0,d=this.emissive?this.emissive.buildCode(e,"c",{slot:"emissive"}):void 0,m=this.environment?this.environment.buildCode(e,"c",{slot:"environment"}):void 0,v=this.environmentAlpha&&this.environment?this.environmentAlpha.buildCode(e,"f"):void 0;e.requires.transparent=void 0!=l,e.addParsCode(["#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <logdepthbuf_pars_fragment>"].join("\n"));n=["#include <normal_fragment_begin>","\tBlinnPhongMaterial material;"];i&&n.push(i.code,"if ( ! "+i.result+" ) discard;"),n.push(o.code,"\tvec3 diffuseColor = "+o.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","#include <logdepthbuf_fragment>",a.code,"\tvec3 specular = "+a.result+";",s.code,"\tfloat shininess = max( 0.0001, "+s.result+" );","\tfloat specularStrength = 1.0;"),l&&n.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),u&&n.push(u.code,"normal = "+u.result+";"),n.push("material.diffuseColor = "+(c?"vec3( 1.0 )":"diffuseColor")+";"),n.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),c&&(n.push(c.code,"reflectedLight.directDiffuse = "+c.result+";"),n.push("reflectedLight.directDiffuse *= diffuseColor;","reflectedLight.indirectDiffuse *= diffuseColor;")),h&&n.push(h.code,"reflectedLight.indirectDiffuse *= "+h.result+";"),p&&n.push(p.code,"reflectedLight.indirectDiffuse += "+p.result+";"),f&&n.push(f.code,"reflectedLight.directDiffuse *= "+f.result+";","reflectedLight.directSpecular *= "+f.result+";"),d&&n.push(d.code,"reflectedLight.directDiffuse += "+d.result+";"),n.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular;"),m&&(n.push(m.code),v?n.push(v.code,"outgoingLight = mix( outgoingLight, "+m.result+", "+v.result+" );"):n.push("outgoingLight = "+m.result+";")),l?n.push("gl_FragColor = vec4( outgoingLight, "+l.result+" );"):n.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),n.push("#include <premultiplied_alpha_fragment>","#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>"),t=n.join("\n")}return t},PhongNode.prototype.copy=function(e){Node$1.prototype.copy.call(this,e),e.position&&(this.position=e.position),this.color=e.color,this.specular=e.specular,this.shininess=e.shininess,e.mask&&(this.mask=e.mask),e.alpha&&(this.alpha=e.alpha),e.normal&&(this.normal=e.normal),e.light&&(this.light=e.light),e.shadow&&(this.shadow=e.shadow),e.ao&&(this.ao=e.ao),e.emissive&&(this.emissive=e.emissive),e.ambient&&(this.ambient=e.ambient),e.environment&&(this.environment=e.environment),e.environmentAlpha&&(this.environmentAlpha=e.environmentAlpha)},PhongNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.position&&(t.position=this.position.toJSON(e).uuid),t.color=this.color.toJSON(e).uuid,t.specular=this.specular.toJSON(e).uuid,t.shininess=this.shininess.toJSON(e).uuid,this.mask&&(t.mask=this.mask.toJSON(e).uuid),this.alpha&&(t.alpha=this.alpha.toJSON(e).uuid),this.normal&&(t.normal=this.normal.toJSON(e).uuid),this.light&&(t.light=this.light.toJSON(e).uuid),this.ao&&(t.ao=this.ao.toJSON(e).uuid),this.ambient&&(t.ambient=this.ambient.toJSON(e).uuid),this.shadow&&(t.shadow=this.shadow.toJSON(e).uuid),this.emissive&&(t.emissive=this.emissive.toJSON(e).uuid),this.environment&&(t.environment=this.environment.toJSON(e).uuid),this.environmentAlpha&&(t.environmentAlpha=this.environmentAlpha.toJSON(e).uuid)),t},SpriteNode.prototype=Object.create(Node$1.prototype),SpriteNode.prototype.constructor=SpriteNode,SpriteNode.prototype.nodeType="Sprite",SpriteNode.prototype.build=function(e){if(e.define("SPRITE"),e.requires.lights=!1,e.requires.transparent=void 0!==this.alpha,e.isShader("vertex")){var t=this.position?this.position.parseAndBuildCode(e,"v3",{cache:"position"}):void 0;e.mergeUniform(UniformsUtils.merge([UniformsLib.fog])),e.addParsCode(["#include <fog_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n")),o=["#include <clipping_planes_fragment>","#include <begin_vertex>"],t&&o.push(t.code,t.result?"transformed = "+t.result+";":""),o.push("#include <project_vertex>","#include <fog_vertex>","mat4 modelViewMtx = modelViewMatrix;","mat4 modelMtx = modelMatrix;","modelMtx[3][0] = 0.0;","modelMtx[3][1] = 0.0;","modelMtx[3][2] = 0.0;"),this.spherical||o.push("modelMtx[1][1] = 1.0;"),o.push("modelViewMtx[0][0] = 1.0;","modelViewMtx[0][1] = 0.0;","modelViewMtx[0][2] = 0.0;"),this.spherical&&o.push("modelViewMtx[1][0] = 0.0;","modelViewMtx[1][1] = 1.0;","modelViewMtx[1][2] = 0.0;"),o.push("modelViewMtx[2][0] = 0.0;","modelViewMtx[2][1] = 0.0;","modelViewMtx[2][2] = 1.0;","gl_Position = projectionMatrix * modelViewMtx * modelMtx * vec4( transformed, 1.0 );","#include <logdepthbuf_vertex>","#include <clipping_planes_vertex>","#include <fog_vertex>")}else{e.addParsCode(["#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","#include <clipping_planes_pars_fragment>"].join("\n")),e.addCode(["#include <clipping_planes_fragment>","#include <logdepthbuf_fragment>"].join("\n")),this.mask&&this.mask.parse(e),this.alpha&&this.alpha.parse(e),this.color.parse(e,{slot:"color"});var r=this.mask?this.mask.buildCode(e,"b"):void 0,n=this.alpha?this.alpha.buildCode(e,"f"):void 0,i=this.color.buildCode(e,"c",{slot:"color"}),o=[];r&&o.push(r.code,"if ( ! "+r.result+" ) discard;"),n?o.push(n.code,"#ifdef ALPHATEST","if ( "+n.result+" <= ALPHATEST ) discard;","#endif",i.code,"gl_FragColor = vec4( "+i.result+", "+n.result+" );"):o.push(i.code,"gl_FragColor = vec4( "+i.result+", 1.0 );"),o.push("#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>")}return o.join("\n")},SpriteNode.prototype.copy=function(e){Node$1.prototype.copy.call(this,e),e.position&&(this.position=e.position),this.color=e.color,void 0!==e.spherical&&(this.spherical=e.spherical),e.mask&&(this.mask=e.mask),e.alpha&&(this.alpha=e.alpha)},SpriteNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.position&&(t.position=this.position.toJSON(e).uuid),t.color=this.color.toJSON(e).uuid,!1===this.spherical&&(t.spherical=!1),this.mask&&(t.mask=this.mask.toJSON(e).uuid),this.alpha&&(t.alpha=this.alpha.toJSON(e).uuid)),t},PhongNodeMaterial.prototype=Object.create(NodeMaterial.prototype),PhongNodeMaterial.prototype.constructor=PhongNodeMaterial,NodeUtils.addShortcuts(PhongNodeMaterial.prototype,"fragment",["color","alpha","specular","shininess","normal","emissive","ambient","light","shadow","ao","environment","environmentAlpha","mask","position"]),SpriteNodeMaterial.prototype=Object.create(NodeMaterial.prototype),SpriteNodeMaterial.prototype.constructor=SpriteNodeMaterial,NodeUtils.addShortcuts(SpriteNodeMaterial.prototype,"fragment",["color","alpha","mask","position","spherical"]),StandardNodeMaterial.prototype=Object.create(NodeMaterial.prototype),StandardNodeMaterial.prototype.constructor=StandardNodeMaterial,NodeUtils.addShortcuts(StandardNodeMaterial.prototype,"fragment",["color","alpha","roughness","metalness","reflectivity","clearCoat","clearCoatRoughness","normal","emissive","ambient","light","shadow","ao","environment","mask","position"]),CondNode.EQUAL="==",CondNode.NOT_EQUAL="!=",CondNode.GREATER=">",CondNode.GREATER_EQUAL=">=",CondNode.LESS="<",CondNode.LESS_EQUAL="<=",CondNode.prototype=Object.create(TempNode.prototype),CondNode.prototype.constructor=CondNode,CondNode.prototype.nodeType="Cond",CondNode.prototype.getType=function(e){if(this.ifNode){var t=this.ifNode.getType(e),r=this.elseNode.getType(e);return e.getTypeLength(r)>e.getTypeLength(t)?r:t}return"b"},CondNode.prototype.getCondType=function(e){return e.getTypeLength(this.b.getType(e))>e.getTypeLength(this.a.getType(e))?this.b.getType(e):this.a.getType(e)},CondNode.prototype.generate=function(e,t){var r,n=this.getType(e),i=this.getCondType(e),o=this.a.build(e,i),a=this.b.build(e,i);if(this.ifNode){var s=this.ifNode.build(e,n),l=this.elseNode.build(e,n);r="( "+[o,this.op,a,"?",s,":",l].join(" ")+" )"}else r="( "+o+" "+this.op+" "+a+" )";return e.format(r,this.getType(e),t)},CondNode.prototype.copy=function(e){TempNode.prototype.copy.call(this,e),this.a=e.a,this.b=e.b,this.op=e.op,this.ifNode=e.ifNode,this.elseNode=e.elseNode},CondNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).a=this.a.toJSON(e).uuid,t.b=this.b.toJSON(e).uuid,t.op=this.op,t.ifNode&&(t.ifNode=this.ifNode.toJSON(e).uuid),t.elseNode&&(t.elseNode=this.elseNode.toJSON(e).uuid)),t},Math1Node.RAD="radians",Math1Node.DEG="degrees",Math1Node.EXP="exp",Math1Node.EXP2="exp2",Math1Node.LOG="log",Math1Node.LOG2="log2",Math1Node.SQRT="sqrt",Math1Node.INV_SQRT="inversesqrt",Math1Node.FLOOR="floor",Math1Node.CEIL="ceil",Math1Node.NORMALIZE="normalize",Math1Node.FRACT="fract",Math1Node.SATURATE="saturate",Math1Node.SIN="sin",Math1Node.COS="cos",Math1Node.TAN="tan",Math1Node.ASIN="asin",Math1Node.ACOS="acos",Math1Node.ARCTAN="atan",Math1Node.ABS="abs",Math1Node.SIGN="sign",Math1Node.LENGTH="length",Math1Node.NEGATE="negate",Math1Node.INVERT="invert",Math1Node.prototype=Object.create(TempNode.prototype),Math1Node.prototype.constructor=Math1Node,Math1Node.prototype.nodeType="Math1",Math1Node.prototype.getType=function(e){switch(this.method){case Math1Node.LENGTH:return"f"}return this.a.getType(e)},Math1Node.prototype.generate=function(e,t){var r=this.getType(e),n=this.a.build(e,r);switch(this.method){case Math1Node.NEGATE:n="( -"+n+" )";break;case Math1Node.INVERT:n="( 1.0 - "+n+" )";break;default:n=this.method+"( "+n+" )"}return e.format(n,r,t)},Math1Node.prototype.copy=function(e){TempNode.prototype.copy.call(this,e),this.a=e.a,this.method=e.method},Math1Node.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).a=this.a.toJSON(e).uuid,t.method=this.method),t},Math2Node.MIN="min",Math2Node.MAX="max",Math2Node.MOD="mod",Math2Node.STEP="step",Math2Node.REFLECT="reflect",Math2Node.DISTANCE="distance",Math2Node.DOT="dot",Math2Node.CROSS="cross",Math2Node.POW="pow",Math2Node.prototype=Object.create(TempNode.prototype),Math2Node.prototype.constructor=Math2Node,Math2Node.prototype.nodeType="Math2",Math2Node.prototype.getInputType=function(e){return e.getTypeLength(this.b.getType(e))>e.getTypeLength(this.a.getType(e))?this.b.getType(e):this.a.getType(e)},Math2Node.prototype.getType=function(e){switch(this.method){case Math2Node.DISTANCE:case Math2Node.DOT:return"f";case Math2Node.CROSS:return"v3"}return this.getInputType(e)},Math2Node.prototype.generate=function(e,t){var r,n,i=this.getInputType(e),o=e.getTypeLength(this.a.getType(e)),a=e.getTypeLength(this.b.getType(e));switch(this.method){case Math2Node.CROSS:r=this.a.build(e,"v3"),n=this.b.build(e,"v3");break;case Math2Node.STEP:r=this.a.build(e,1===o?"f":i),n=this.b.build(e,i);break;case Math2Node.MIN:case Math2Node.MAX:case Math2Node.MOD:r=this.a.build(e,i),n=this.b.build(e,1===a?"f":i);break;default:r=this.a.build(e,i),n=this.b.build(e,i)}return e.format(this.method+"( "+r+", "+n+" )",this.getType(e),t)},Math2Node.prototype.copy=function(e){TempNode.prototype.copy.call(this,e),this.a=e.a,this.b=e.b,this.method=e.method},Math2Node.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).a=this.a.toJSON(e).uuid,t.b=this.b.toJSON(e).uuid,t.method=this.method),t},Math3Node.MIX="mix",Math3Node.CLAMP="clamp",Math3Node.REFRACT="refract",Math3Node.SMOOTHSTEP="smoothstep",Math3Node.FACEFORWARD="faceforward",Math3Node.prototype=Object.create(TempNode.prototype),Math3Node.prototype.constructor=Math3Node,Math3Node.prototype.nodeType="Math3",Math3Node.prototype.getType=function(e){var t=e.getTypeLength(this.a.getType(e)),r=e.getTypeLength(this.b.getType(e)),n=e.getTypeLength(this.c.getType(e));return t>r&&t>n?this.a.getType(e):r>n?this.b.getType(e):this.c.getType(e)},Math3Node.prototype.generate=function(e,t){e.getTypeLength(this.a.getType(e)),e.getTypeLength(this.b.getType(e));var r,n,i,o=e.getTypeLength(this.c.getType(e)),a=this.getType(e);switch(this.method){case Math3Node.REFRACT:r=this.a.build(e,a),n=this.b.build(e,a),i=this.c.build(e,"f");break;case Math3Node.MIX:r=this.a.build(e,a),n=this.b.build(e,a),i=this.c.build(e,1===o?"f":a);break;default:r=this.a.build(e,a),n=this.b.build(e,a),i=this.c.build(e,a)}return e.format(this.method+"( "+r+", "+n+", "+i+" )",a,t)},Math3Node.prototype.copy=function(e){TempNode.prototype.copy.call(this,e),this.a=e.a,this.b=e.b,this.c=e.c,this.method=e.method},Math3Node.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).a=this.a.toJSON(e).uuid,t.b=this.b.toJSON(e).uuid,t.c=this.c.toJSON(e).uuid,t.method=this.method),t},BumpMapNode.Nodes=function(){var e=new FunctionNode(["vec2 dHdxy_fwd( sampler2D bumpMap, vec2 vUv, float bumpScale ) {","\tvec2 dSTdx = dFdx( vUv );","\tvec2 dSTdy = dFdy( vUv );","\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;","\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;","\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;","\treturn vec2( dBx, dBy );","}"].join("\n"),null,{derivatives:!0});return{dHdxy_fwd:e,perturbNormalArb:new FunctionNode(["vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {","\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );","\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );","\tvec3 vN = surf_norm;","\tvec3 R1 = cross( vSigmaY, vN );","\tvec3 R2 = cross( vN, vSigmaX );","\tfloat fDet = dot( vSigmaX, R1 );","\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );","\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );","\treturn normalize( abs( fDet ) * surf_norm - vGrad );","}"].join("\n"),[e],{derivatives:!0}),bumpToNormal:new FunctionNode(["vec3 bumpToNormal( sampler2D bumpMap, vec2 uv, float scale ) {","\tvec2 dSTdx = dFdx( uv );","\tvec2 dSTdy = dFdy( uv );","\tfloat Hll = texture2D( bumpMap, uv ).x;","\tfloat dBx = texture2D( bumpMap, uv + dSTdx ).x - Hll;","\tfloat dBy = texture2D( bumpMap, uv + dSTdy ).x - Hll;","\treturn vec3( .5 - ( dBx * scale ), .5 - ( dBy * scale ), 1.0 );","}"].join("\n"),null,{derivatives:!0})}}(),BumpMapNode.prototype=Object.create(TempNode.prototype),BumpMapNode.prototype.constructor=BumpMapNode,BumpMapNode.prototype.nodeType="BumpMap",BumpMapNode.prototype.generate=function(e,t){if(e.isShader("fragment")){if(this.toNormalMap){var r=e.include(BumpMapNode.Nodes.bumpToNormal);return e.format(r+"( "+this.value.build(e,"sampler2D")+", "+this.value.uv.build(e,"v2")+", "+this.scale.build(e,"f")+" )",this.getType(e),t)}var n=e.include(BumpMapNode.Nodes.dHdxy_fwd),i=e.include(BumpMapNode.Nodes.perturbNormalArb);this.normal=this.normal||new NormalNode$1,this.position=this.position||new PositionNode(PositionNode.VIEW);var o=n+"( "+this.value.build(e,"sampler2D")+", "+this.value.uv.build(e,"v2")+", "+this.scale.build(e,"f")+" )";return e.format(i+"( -"+this.position.build(e,"v3")+", "+this.normal.build(e,"v3")+", "+o+" )",this.getType(e),t)}return console.warn("BumpMapNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)},BumpMapNode.prototype.copy=function(e){TempNode.prototype.copy.call(this,e),this.value=e.value,this.scale=e.scale},BumpMapNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid,t.scale=this.scale.toJSON(e).uuid),t};var Pass=function(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1};Object.assign(Pass.prototype,{setSize:function(e,t){},render:function(e,t,r,n,i){console.error("Pass: .render() must be implemented in derived pass.")}});var ShaderPass=function(e,t){Pass.call(this),this.textureID=void 0!==t?t:"tDiffuse",e instanceof ShaderMaterial?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=UniformsUtils.clone(e.uniforms),this.material=new ShaderMaterial({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.camera=new OrthographicCamera(-1,1,1,-1,0,1),this.scene=new Scene,this.quad=new Mesh(new PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};function NodePass(){ShaderPass.call(this),this.name="",this.uuid=_Math.generateUUID(),this.userData={},this.textureID="renderTexture",this.input=new ScreenNode,this.material=new NodeMaterial,this.needsUpdate=!0}function NodePostProcessing(e,t){if(void 0===t){var r={minFilter:LinearFilter,magFilter:LinearFilter,format:RGBAFormat,stencilBuffer:!1},n=e.getDrawingBufferSize(new Vector2);t=new WebGLRenderTarget(n.width,n.height,r)}this.renderer=e,this.renderTarget=t,this.output=new ScreenNode,this.material=new NodeMaterial,this.camera=new OrthographicCamera(-1,1,1,-1,0,1),this.scene=new Scene,this.quad=new Mesh(new PlaneBufferGeometry(2,2),this.material),this.quad.frustumCulled=!1,this.scene.add(this.quad),this.needsUpdate=!0}function CheckerNode(e){TempNode.call(this,"f"),this.uv=e||new UVNode}function NoiseNode(e){TempNode.call(this,"f"),this.uv=e||new UVNode}function BypassNode(e,t){Node$1.call(this),this.code=e,this.value=t}ShaderPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:ShaderPass,render:function(e,t,r,n,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.quad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),e.render(this.scene,this.camera)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera))}}),NodePass.prototype=Object.create(ShaderPass.prototype),NodePass.prototype.constructor=NodePass,NodePass.prototype.render=function(){this.needsUpdate&&(this.material.dispose(),this.material.fragment.value=this.input,this.needsUpdate=!1),this.uniforms=this.material.uniforms,ShaderPass.prototype.render.apply(this,arguments)},NodePass.prototype.copy=function(e){this.input=e.input},NodePass.prototype.toJSON=function(e){if((void 0===e||"string"===typeof e)&&(e={nodes:{}}),e&&!e.passes&&(e.passes={}),!e.passes[this.uuid]){var t={};t.uuid=this.uuid,t.type="NodePass",e.passes[this.uuid]=t,""!==this.name&&(t.name=this.name),"{}"!==JSON.stringify(this.userData)&&(t.userData=this.userData),t.input=this.input.toJSON(e).uuid}return e.pass=this.uuid,e},NodePostProcessing.prototype={constructor:NodePostProcessing,render:function(e,t,r){this.needsUpdate&&(this.material.dispose(),this.material.fragment.value=this.output,this.material.build(),this.material.uniforms.renderTexture&&(this.material.uniforms.renderTexture.value=this.renderTarget.texture),this.needsUpdate=!1),r.setRenderer(this.renderer).setRenderTexture(this.renderTarget.texture),this.renderer.setRenderTarget(this.renderTarget),this.renderer.render(e,t),r.updateNode(this.material),this.renderer.setRenderTarget(null),this.renderer.render(this.scene,this.camera)},setSize:function(e,t){this.renderTarget.setSize(e,t),this.renderer.setSize(e,t)},copy:function(e){this.output=e.output},toJSON:function(e){if((void 0===e||"string"===typeof e)&&(e={nodes:{}}),e&&!e.post&&(e.post={}),!e.post[this.uuid]){var t={};t.uuid=this.uuid,t.type="NodePostProcessing",e.post[this.uuid]=t,""!==this.name&&(t.name=this.name),"{}"!==JSON.stringify(this.userData)&&(t.userData=this.userData),t.output=this.output.toJSON(e).uuid}return e.post=this.uuid,e}},CheckerNode.prototype=Object.create(TempNode.prototype),CheckerNode.prototype.constructor=CheckerNode,CheckerNode.prototype.nodeType="Noise",CheckerNode.Nodes={checker:new FunctionNode(["float checker( vec2 uv ) {","\tfloat cx = floor( uv.x );","\tfloat cy = floor( uv.y ); ","\tfloat result = mod( cx + cy, 2.0 );","\treturn sign( result );","}"].join("\n"))},CheckerNode.prototype.generate=function(e,t){var r=e.include(CheckerNode.Nodes.checker);return e.format(r+"( "+this.uv.build(e,"v2")+" )",this.getType(e),t)},CheckerNode.prototype.copy=function(e){TempNode.prototype.copy.call(this,e),this.uv=e.uv},CheckerNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).uv=this.uv.toJSON(e).uuid),t},NoiseNode.prototype=Object.create(TempNode.prototype),NoiseNode.prototype.constructor=NoiseNode,NoiseNode.prototype.nodeType="Noise",NoiseNode.Nodes={snoise:new FunctionNode(["float snoise(vec2 co) {","\treturn fract( sin( dot( co.xy, vec2( 12.9898, 78.233 ) ) ) * 43758.5453 );","}"].join("\n"))},NoiseNode.prototype.generate=function(e,t){var r=e.include(NoiseNode.Nodes.snoise);return e.format(r+"( "+this.uv.build(e,"v2")+" )",this.getType(e),t)},NoiseNode.prototype.copy=function(e){TempNode.prototype.copy.call(this,e),this.uv=e.uv},NoiseNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).uv=this.uv.toJSON(e).uuid),t},BypassNode.prototype=Object.create(Node$1.prototype),BypassNode.prototype.constructor=BypassNode,BypassNode.prototype.nodeType="Bypass",BypassNode.prototype.getType=function(e){return this.value?this.value.getType(e):e.isShader("fragment")?"f":"void"},BypassNode.prototype.generate=function(e,t){var r=this.code.build(e,t)+";";return e.addNodeCode(r),e.isShader("vertex")?this.value?this.value.build(e,t):void 0:this.value?this.value.build(e,t):e.format("0.0","f",t)},BypassNode.prototype.copy=function(e){Node$1.prototype.copy.call(this,e),this.code=e.code,this.value=e.value},BypassNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).code=this.code.toJSON(e).uuid,this.value&&(t.value=this.value.toJSON(e).uuid)),t};var inputs=NodeUtils.elements;function JoinNode(e,t,r,n){TempNode.call(this,"f"),this.x=e,this.y=t,this.z=r,this.w=n}function TimerNode(e,t,r){FloatNode.call(this),this.scale=void 0!==e?e:1,this.scope=t||TimerNode.GLOBAL,this.timeScale=void 0!==r?r:void 0!==e}function UVTransformNode(e,t){ExpressionNode.call(this,"( uvTransform * vec3( uvNode, 1 ) ).xy","vec2"),this.uv=e||new UVNode,this.position=t||new Matrix3Node}function VelocityNode(e,t){Vector3Node.call(this),this.params={},this.velocity=new Vector3,this.setTarget(e),this.setParams(t)}function Clock(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}JoinNode.prototype=Object.create(TempNode.prototype),JoinNode.prototype.constructor=JoinNode,JoinNode.prototype.nodeType="Join",JoinNode.prototype.getNumElements=function(){for(var e=inputs.length;e--;)if(void 0!==this[inputs[e]]){++e;break}return Math.max(e,2)},JoinNode.prototype.getType=function(e){return e.getTypeFromLength(this.getNumElements())},JoinNode.prototype.generate=function(e,t){for(var r=this.getType(e),n=this.getNumElements(),i=[],o=0;o<n;o++){var a=this[inputs[o]];i.push(a?a.build(e,"f"):"0.0")}var s=(n>1?e.getConstructorFromLength(n):"")+"( "+i.join(", ")+" )";return e.format(s,r,t)},JoinNode.prototype.copy=function(e){for(var t in TempNode.prototype.copy.call(this,e),e.inputs)this[t]=e.inputs[t]},JoinNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);if(!t){(t=this.createJSONNode(e)).inputs={};for(var r=this.getNumElements(),n=0;n<r;n++){var i=this[inputs[n]];i&&(t.inputs[inputs[n]]=i.toJSON(e).uuid)}}return t},TimerNode.GLOBAL="global",TimerNode.LOCAL="local",TimerNode.DELTA="delta",TimerNode.prototype=Object.create(FloatNode.prototype),TimerNode.prototype.constructor=TimerNode,TimerNode.prototype.nodeType="Timer",TimerNode.prototype.getReadonly=function(){return!1},TimerNode.prototype.getUnique=function(){return this.timeScale&&(this.scope===TimerNode.GLOBAL||this.scope===TimerNode.DELTA)},TimerNode.prototype.updateFrame=function(e){var t=this.timeScale?this.scale:1;switch(this.scope){case TimerNode.LOCAL:this.value+=e.delta*t;break;case TimerNode.DELTA:this.value=e.delta*t;break;default:this.value=e.time*t}},TimerNode.prototype.copy=function(e){FloatNode.prototype.copy.call(this,e),this.scope=e.scope,this.scale=e.scale,this.timeScale=e.timeScale},TimerNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope,t.scale=this.scale,t.timeScale=this.timeScale),t},NodeLib.addKeyword("time",function(){return new TimerNode}),UVTransformNode.prototype=Object.create(ExpressionNode.prototype),UVTransformNode.prototype.constructor=UVTransformNode,UVTransformNode.prototype.nodeType="UVTransform",UVTransformNode.prototype.generate=function(e,t){return this.keywords.uvNode=this.uv,this.keywords.uvTransform=this.position,ExpressionNode.prototype.generate.call(this,e,t)},UVTransformNode.prototype.setUvTransform=function(e,t,r,n,i,o,a){o=void 0!==o?o:.5,a=void 0!==a?a:.5,this.position.value.setUvTransform(e,t,r,n,i,o,a)},UVTransformNode.prototype.copy=function(e){ExpressionNode.prototype.copy.call(this,e),this.uv=e.uv,this.position=e.position},UVTransformNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).uv=this.uv.toJSON(e).uuid,t.position=this.position.toJSON(e).uuid),t},VelocityNode.prototype=Object.create(Vector3Node.prototype),VelocityNode.prototype.constructor=VelocityNode,VelocityNode.prototype.nodeType="Velocity",VelocityNode.prototype.getReadonly=function(e){return!1},VelocityNode.prototype.setParams=function(e){switch(this.params.type){case"elastic":delete this.moment,delete this.speed,delete this.springVelocity,delete this.lastVelocity}switch(this.params=e||{},this.params.type){case"elastic":this.moment=new Vector3,this.speed=new Vector3,this.springVelocity=new Vector3,this.lastVelocity=new Vector3}},VelocityNode.prototype.setTarget=function(e){this.target&&(delete this.position,delete this.oldPosition),this.target=e,e&&(this.position=e.getWorldPosition(this.position||new Vector3),this.oldPosition=this.position.clone())},VelocityNode.prototype.updateFrameVelocity=function(e){this.target&&(this.position=this.target.getWorldPosition(this.position||new Vector3),this.velocity.subVectors(this.position,this.oldPosition),this.oldPosition.copy(this.position))},VelocityNode.prototype.updateFrame=function(e){switch(this.updateFrameVelocity(e),this.params.type){case"elastic":var t=e.delta*(this.params.fps||60),r=Math.pow(this.params.spring,t),n=Math.pow(this.params.damping,t);this.velocity.multiplyScalar(Math.exp(-this.params.damping*t)),this.velocity.add(this.springVelocity),this.velocity.add(this.speed.multiplyScalar(n).multiplyScalar(1-r)),this.speed.subVectors(this.velocity,this.lastVelocity),this.springVelocity.add(this.speed),this.springVelocity.multiplyScalar(r),this.moment.add(this.springVelocity),this.moment.multiplyScalar(n),this.lastVelocity.copy(this.velocity),this.value.copy(this.moment);break;default:this.value.copy(this.velocity)}},VelocityNode.prototype.copy=function(e){Vector3Node.prototype.copy.call(this,e),e.target&&object.setTarget(e.target),object.setParams(e.params)},VelocityNode.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.target&&(t.target=this.target.uuid),t.params=JSON.parse(JSON.stringify(this.params))),t},Object.assign(Clock.prototype,{start:function(){this.startTime=("undefined"===typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"===typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}});var Fire=function e(t,r){Mesh.call(this,t),this.type="Fire",this.clock=new Clock;var n=(r=r||{}).textureWidth||512,i=r.textureHeight||512,o=1/n,a=1/i,s=void 0!==r.debug&&r.debug;this.color1=r.color1||new Color(16777215),this.color2=r.color2||new Color(16752640),this.color3=r.color3||new Color(0),this.colorBias=void 0===r.colorBias?.8:r.colorBias,this.diffuse=void 0===r.diffuse?1.33:r.diffuse,this.viscosity=void 0===r.viscosity?.25:r.viscosity,this.expansion=void 0===r.expansion?-.25:r.expansion,this.swirl=void 0===r.swirl?50:r.swirl,this.burnRate=void 0===r.burnRate?.3:r.burnRate,this.drag=void 0===r.drag?.35:r.drag,this.airSpeed=void 0===r.airSpeed?6:r.airSpeed,this.windVector=r.windVector||new Vector2(0,.75),this.speed=void 0===r.speed?500:r.speed,this.massConservation=void 0!==r.massConservation&&r.massConservation;var l=n*i;this.sourceData=new Uint8Array(4*l),this.clearSources=function(){for(var e=0;e<i;e++)for(var t=0;t<n;t++){var r=4*(e*n+t);this.sourceData[r]=0,this.sourceData[r+1]=0,this.sourceData[r+2]=0,this.sourceData[r+3]=0}return this.sourceMaterial.uniforms.sourceMap.value=this.internalSource,this.sourceMaterial.needsUpdate=!0,this.sourceData},this.addSource=function(e,t,r,s,l,u){void 0===s&&(s=null),void 0===l&&(l=null),void 0===u&&(u=null);for(var c=Math.max(Math.floor((e-r)*n),0),h=Math.max(Math.floor((t-r)*i),0),p=Math.min(Math.floor((e+r)*n),n),f=Math.min(Math.floor((t+r)*i),i),d=h;d<f;d++)for(var m=c;m<p;m++){var v=m*o-e,g=d*a-t;if(v*v+g*g<r*r){var y,b=4*(d*n+m);if(null!=s&&(this.sourceData[b]=255*Math.min(Math.max(s,0),1)),null!=l)y=(y=Math.min(Math.max(l,-1),1))<0?Math.floor(127*y)+255:Math.floor(127*y),this.sourceData[b+1]=y;if(null!=u)y=(y=Math.min(Math.max(u,-1),1))<0?Math.floor(127*y)+255:Math.floor(127*y),this.sourceData[b+2]=y}}return this.internalSource.needsUpdate=!0,this.sourceData},this.setSourceMap=function(e){this.sourceMaterial.uniforms.sourceMap.value=e};var u={minFilter:NearestFilter,magFilter:NearestFilter,depthBuffer:!1,stencilBuffer:!1};this.field0=new WebGLRenderTarget(n,i,u),this.field0.background=new Color(0),this.field1=new WebGLRenderTarget(n,i,u),this.field0.background=new Color(0),this.fieldProj=new WebGLRenderTarget(n,i,u),this.field0.background=new Color(0),_Math.isPowerOfTwo(n)&&_Math.isPowerOfTwo(i)||(this.field0.texture.generateMipmaps=!1,this.field1.texture.generateMipmaps=!1,this.fieldProj.texture.generateMipmaps=!1),this.fieldScene=new Scene,this.fieldScene.background=new Color(0),this.orthoCamera=new OrthographicCamera(n/-2,n/2,i/2,i/-2,1,2),this.orthoCamera.position.z=1,this.fieldGeometry=new PlaneBufferGeometry(n,i),this.internalSource=new DataTexture(this.sourceData,n,i,RGBAFormat);var c=e.SourceShader;this.sourceMaterial=new ShaderMaterial({uniforms:c.uniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,transparent:!1}),this.clearSources(),this.sourceMesh=new Mesh(this.fieldGeometry,this.sourceMaterial),this.fieldScene.add(this.sourceMesh);c=e.DiffuseShader;this.diffuseMaterial=new ShaderMaterial({uniforms:c.uniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,transparent:!1}),this.diffuseMaterial.uniforms.oneOverWidth.value=o,this.diffuseMaterial.uniforms.oneOverHeight.value=a,this.diffuseMesh=new Mesh(this.fieldGeometry,this.diffuseMaterial),this.fieldScene.add(this.diffuseMesh),c=e.DriftShader,this.driftMaterial=new ShaderMaterial({uniforms:c.uniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,transparent:!1}),this.driftMaterial.uniforms.oneOverWidth.value=o,this.driftMaterial.uniforms.oneOverHeight.value=a,this.driftMesh=new Mesh(this.fieldGeometry,this.driftMaterial),this.fieldScene.add(this.driftMesh),c=e.ProjectionShader1,this.projMaterial1=new ShaderMaterial({uniforms:c.uniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,transparent:!1}),this.projMaterial1.uniforms.oneOverWidth.value=o,this.projMaterial1.uniforms.oneOverHeight.value=a,this.projMesh1=new Mesh(this.fieldGeometry,this.projMaterial1),this.fieldScene.add(this.projMesh1),c=e.ProjectionShader2,this.projMaterial2=new ShaderMaterial({uniforms:c.uniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,transparent:!1}),this.projMaterial2.uniforms.oneOverWidth.value=o,this.projMaterial2.uniforms.oneOverHeight.value=a,this.projMesh2=new Mesh(this.fieldGeometry,this.projMaterial2),this.fieldScene.add(this.projMesh2),c=e.ProjectionShader3,this.projMaterial3=new ShaderMaterial({uniforms:c.uniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,transparent:!1}),this.projMaterial3.uniforms.oneOverWidth.value=o,this.projMaterial3.uniforms.oneOverHeight.value=a,this.projMesh3=new Mesh(this.fieldGeometry,this.projMaterial3),this.fieldScene.add(this.projMesh3),c=s?e.DebugShader:e.ColorShader,this.material=new ShaderMaterial({uniforms:c.uniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,transparent:!0}),this.material.uniforms.densityMap.value=this.field1.texture,this.configShaders=function(e){this.diffuseMaterial.uniforms.diffuse.value=.05*e*this.diffuse,this.diffuseMaterial.uniforms.viscosity.value=.05*e*this.viscosity,this.diffuseMaterial.uniforms.expansion.value=Math.exp(-1*this.expansion),this.diffuseMaterial.uniforms.swirl.value=Math.exp(-.1*this.swirl),this.diffuseMaterial.uniforms.drag.value=Math.exp(-.1*this.drag),this.diffuseMaterial.uniforms.burnRate.value=this.burnRate*e*.01,this.driftMaterial.uniforms.windVector.value=this.windVector,this.driftMaterial.uniforms.airSpeed.value=e*this.airSpeed*.001*i,this.material.uniforms.color1.value=this.color1,this.material.uniforms.color2.value=this.color2,this.material.uniforms.color3.value=this.color3,this.material.uniforms.colorBias.value=this.colorBias},this.clearDiffuse=function(){this.diffuseMaterial.uniforms.expansion.value=1,this.diffuseMaterial.uniforms.swirl.value=1,this.diffuseMaterial.uniforms.drag.value=1,this.diffuseMaterial.uniforms.burnRate.value=0},this.swapTextures=function(){var e=this.field0;this.field0=this.field1,this.field1=e},this.saveRenderState=function(e){this.savedRenderTarget=e.getRenderTarget(),this.savedVrEnabled=e.vr.enabled,this.savedShadowAutoUpdate=e.shadowMap.autoUpdate,this.savedAntialias=e.antialias,this.savedToneMapping=e.toneMapping},this.restoreRenderState=function(e){e.vr.enabled=this.savedVrEnabled,e.shadowMap.autoUpdate=this.savedShadowAutoUpdate,e.setRenderTarget(this.savedRenderTarget),e.antialias=this.savedAntialias,e.toneMapping=this.savedToneMapping},this.renderSource=function(e){this.sourceMesh.visible=!0,this.sourceMaterial.uniforms.densityMap.value=this.field0.texture,e.setRenderTarget(this.field1),e.render(this.fieldScene,this.orthoCamera),this.sourceMesh.visible=!1,this.swapTextures()},this.renderDiffuse=function(e){this.diffuseMesh.visible=!0,this.diffuseMaterial.uniforms.densityMap.value=this.field0.texture,e.setRenderTarget(this.field1),e.render(this.fieldScene,this.orthoCamera),this.diffuseMesh.visible=!1,this.swapTextures()},this.renderDrift=function(e){this.driftMesh.visible=!0,this.driftMaterial.uniforms.densityMap.value=this.field0.texture,e.setRenderTarget(this.field1),e.render(this.fieldScene,this.orthoCamera),this.driftMesh.visible=!1,this.swapTextures()},this.renderProject=function(e){this.projMesh1.visible=!0,this.projMaterial1.uniforms.densityMap.value=this.field0.texture,e.setRenderTarget(this.fieldProj),e.render(this.fieldScene,this.orthoCamera),this.projMesh1.visible=!1,this.projMaterial2.uniforms.densityMap.value=this.fieldProj.texture,this.projMesh2.visible=!0;for(var t=0;t<20;t++){e.setRenderTarget(this.field1),e.render(this.fieldScene,this.orthoCamera);var r=this.field1;this.field1=this.fieldProj,this.fieldProj=r,this.projMaterial2.uniforms.densityMap.value=this.fieldProj.texture}this.projMesh2.visible=!1,this.projMaterial3.uniforms.densityMap.value=this.field0.texture,this.projMaterial3.uniforms.projMap.value=this.fieldProj.texture,this.projMesh3.visible=!0,e.setRenderTarget(this.field1),e.render(this.fieldScene,this.orthoCamera),this.projMesh3.visible=!1,this.swapTextures()},this.onBeforeRender=function(e,t,r){var n=this.clock.getDelta();n>.1&&(n=.1);var i=n*(.1*this.speed);this.configShaders(i),this.saveRenderState(e),e.vr.enabled=!1,e.shadowMap.autoUpdate=!1,e.antialias=!1,e.toneMapping=NoToneMapping,this.sourceMesh.visible=!1,this.diffuseMesh.visible=!1,this.driftMesh.visible=!1,this.projMesh1.visible=!1,this.projMesh2.visible=!1,this.projMesh3.visible=!1,this.renderSource(e),this.clearDiffuse();for(var o=0;o<21;o++)this.renderDiffuse(e);this.configShaders(i),this.renderDiffuse(e),this.renderDrift(e),this.massConservation&&(this.renderProject(e),this.renderProject(e)),this.material.map=this.field1.texture,this.material.transparent=!0,this.material.minFilter=LinearFilter,this.material.magFilter=LinearFilter,this.restoreRenderState(e)}};function Box2(e,t){this.min=void 0!==e?e:new Vector2(1/0,1/0),this.max=void 0!==t?t:new Vector2(-1/0,-1/0)}Fire.prototype=Object.create(Mesh.prototype),Fire.prototype.constructor=Fire,Fire.SourceShader={uniforms:{sourceMap:{type:"t",value:null},densityMap:{type:"t",value:null}},vertexShader:["varying vec2 vUv;","void main() {"," \t  vUv = uv;","     vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","     gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform sampler2D sourceMap;","uniform sampler2D densityMap;","varying vec2 vUv;","void main() {","    vec4 source = texture2D( sourceMap, vUv );","    vec4 current = texture2D( densityMap, vUv );","    vec2 v0 = (current.gb - step(0.5, current.gb)) * 2.0;","    vec2 v1 = (source.gb - step(0.5, source.gb)) * 2.0;","    vec2 newVel = v0 + v1;","    newVel = clamp(newVel, -0.99, 0.99);","    newVel = newVel * 0.5 + step(0.0, -newVel);","    float newDensity = source.r + current.a;","    float newTemp = source.r + current.r;","    newDensity = clamp(newDensity, 0.0, 1.0);","    newTemp = clamp(newTemp, 0.0, 1.0);","    gl_FragColor = vec4(newTemp, newVel.xy, newDensity);","}"].join("\n")},Fire.DiffuseShader={uniforms:{oneOverWidth:{type:"f",value:null},oneOverHeight:{type:"f",value:null},diffuse:{type:"f",value:null},viscosity:{type:"f",value:null},expansion:{type:"f",value:null},swirl:{type:"f",value:null},drag:{type:"f",value:null},burnRate:{type:"f",value:null},densityMap:{type:"t",value:null}},vertexShader:["varying vec2 vUv;","void main() {"," \t  vUv = uv;","     vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","     gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform float oneOverWidth;","uniform float oneOverHeight;","uniform float diffuse;","uniform float viscosity;","uniform float expansion;","uniform float swirl;","uniform float burnRate;","uniform float drag;","uniform sampler2D densityMap;","varying vec2 vUv;","void main() {","    vec4 dC = texture2D( densityMap, vUv );","    vec4 dL = texture2D( densityMap, vec2(vUv.x - oneOverWidth, vUv.y) );","    vec4 dR = texture2D( densityMap, vec2(vUv.x + oneOverWidth, vUv.y) );","    vec4 dU = texture2D( densityMap, vec2(vUv.x, vUv.y - oneOverHeight) );","    vec4 dD = texture2D( densityMap, vec2(vUv.x, vUv.y + oneOverHeight) );","    vec4 dUL = texture2D( densityMap, vec2(vUv.x - oneOverWidth, vUv.y - oneOverHeight) );","    vec4 dUR = texture2D( densityMap, vec2(vUv.x + oneOverWidth, vUv.y - oneOverHeight) );","    vec4 dDL = texture2D( densityMap, vec2(vUv.x - oneOverWidth, vUv.y + oneOverHeight) );","    vec4 dDR = texture2D( densityMap, vec2(vUv.x + oneOverWidth, vUv.y + oneOverHeight) );","    dC.yz = (dC.yz - step(0.5, dC.yz)) * 2.0;","    dL.yz = (dL.yz - step(0.5, dL.yz)) * 2.0;","    dR.yz = (dR.yz - step(0.5, dR.yz)) * 2.0;","    dU.yz = (dU.yz - step(0.5, dU.yz)) * 2.0;","    dD.yz = (dD.yz - step(0.5, dD.yz)) * 2.0;","    dUL.yz = (dUL.yz - step(0.5, dUL.yz)) * 2.0;","    dUR.yz = (dUR.yz - step(0.5, dUR.yz)) * 2.0;","    dDL.yz = (dDL.yz - step(0.5, dDL.yz)) * 2.0;","    dDR.yz = (dDR.yz - step(0.5, dDR.yz)) * 2.0;","    vec4 result = (dC + vec4(diffuse, viscosity, viscosity, diffuse) * ( dL + dR + dU + dD + dUL + dUR + dDL + dDR )) / (1.0 + 8.0 * vec4(diffuse, viscosity, viscosity, diffuse)) - vec4(0.0, 0.0, 0.0, 0.001);","    float temperature = result.r;","    temperature = clamp(temperature - burnRate, 0.0, 1.0);","    vec2 velocity = result.yz;","    vec2 expansionVec = vec2(dL.w - dR.w, dU.w - dD.w);","    vec2 swirlVec = vec2((dL.z - dR.z) * 0.5, (dU.y - dD.y) * 0.5);","    velocity = velocity + (1.0 - expansion) * expansionVec + (1.0 - swirl) * swirlVec;","    velocity = velocity - (1.0 - drag) * velocity;","    gl_FragColor = vec4(temperature, velocity * 0.5 + step(0.0, -velocity), result.w);","    gl_FragColor = gl_FragColor * step(oneOverWidth, vUv.x);","    gl_FragColor = gl_FragColor * step(oneOverHeight, vUv.y);","    gl_FragColor = gl_FragColor * step(vUv.x, 1.0 - oneOverWidth);","    gl_FragColor = gl_FragColor * step(vUv.y, 1.0 - oneOverHeight);","}"].join("\n")},Fire.DriftShader={uniforms:{oneOverWidth:{type:"f",value:null},oneOverHeight:{type:"f",value:null},windVector:{type:"v2",value:new Vector2(0,0)},airSpeed:{type:"f",value:null},densityMap:{type:"t",value:null}},vertexShader:["varying vec2 vUv;","void main() {"," \t  vUv = uv;","     vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","     gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform float oneOverWidth;","uniform float oneOverHeight;","uniform vec2 windVector;","uniform float airSpeed;","uniform sampler2D densityMap;","varying vec2 vUv;","void main() {","    vec2 velocity = texture2D( densityMap, vUv ).gb;","    velocity = (velocity - step(0.5, velocity)) * 2.0;","    velocity = velocity + windVector;","    vec2 sourcePos = vUv - airSpeed * vec2(oneOverWidth, oneOverHeight) * velocity;","    vec2 units = sourcePos / vec2(oneOverWidth, oneOverHeight);","    vec2 intPos = floor(units);","    vec2 frac = units - intPos;","    intPos = intPos * vec2(oneOverWidth, oneOverHeight);","    vec4 dX0Y0 = texture2D( densityMap, intPos + vec2(0.0, -oneOverHeight) );","    vec4 dX1Y0 = texture2D( densityMap, intPos + vec2(oneOverWidth, 0.0) );","    vec4 dX0Y1 = texture2D( densityMap, intPos + vec2(0.0, oneOverHeight) );","    vec4 dX1Y1 = texture2D( densityMap, intPos + vec2(oneOverWidth, oneOverHeight) );","    dX0Y0.gb = (dX0Y0.gb - step(0.5, dX0Y0.gb)) * 2.0;","    dX1Y0.gb = (dX1Y0.gb - step(0.5, dX1Y0.gb)) * 2.0;","    dX0Y1.gb = (dX0Y1.gb - step(0.5, dX0Y1.gb)) * 2.0;","    dX1Y1.gb = (dX1Y1.gb - step(0.5, dX1Y1.gb)) * 2.0;","    vec4 source = mix(mix(dX0Y0, dX1Y0, frac.x), mix(dX0Y1, dX1Y1, frac.x), frac.y);","    source.gb = source.gb * 0.5 + step(0.0, -source.gb);","    gl_FragColor = source;","}"].join("\n")},Fire.ProjectionShader1={uniforms:{oneOverWidth:{type:"f",value:null},oneOverHeight:{type:"f",value:null},densityMap:{type:"t",value:null}},vertexShader:["varying vec2 vUv;","void main() {"," \t  vUv = uv;","     vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","     gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform float oneOverWidth;","uniform float oneOverHeight;","uniform sampler2D densityMap;","varying vec2 vUv;","void main() {","    float dL = texture2D( densityMap, vec2(vUv.x - oneOverWidth, vUv.y) ).g;","    float dR = texture2D( densityMap, vec2(vUv.x + oneOverWidth, vUv.y) ).g;","    float dU = texture2D( densityMap, vec2(vUv.x, vUv.y - oneOverHeight) ).b;","    float dD = texture2D( densityMap, vec2(vUv.x, vUv.y + oneOverHeight) ).b;","    dL = (dL - step(0.5, dL)) * 2.0;","    dR = (dR - step(0.5, dR)) * 2.0;","    dU = (dU - step(0.5, dU)) * 2.0;","    dD = (dD - step(0.5, dD)) * 2.0;","    float h = (oneOverWidth + oneOverHeight) * 0.5;","    float div = -0.5 * h * (dR - dL + dD - dU);","    gl_FragColor = vec4( 0.0, 0.0, div * 0.5 + step(0.0, -div), 0.0);","}"].join("\n")},Fire.ProjectionShader2={uniforms:{oneOverWidth:{type:"f",value:null},oneOverHeight:{type:"f",value:null},densityMap:{type:"t",value:null}},vertexShader:["varying vec2 vUv;","void main() {"," \t  vUv = uv;","     vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","     gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform float oneOverWidth;","uniform float oneOverHeight;","uniform sampler2D densityMap;","varying vec2 vUv;","void main() {","    float div = texture2D( densityMap, vUv ).b;","    float pL = texture2D( densityMap, vec2(vUv.x - oneOverWidth, vUv.y) ).g;","    float pR = texture2D( densityMap, vec2(vUv.x + oneOverWidth, vUv.y) ).g;","    float pU = texture2D( densityMap, vec2(vUv.x, vUv.y - oneOverHeight) ).g;","    float pD = texture2D( densityMap, vec2(vUv.x, vUv.y + oneOverHeight) ).g;","    float divNorm = (div - step(0.5, div)) * 2.0;","    pL = (pL - step(0.5, pL)) * 2.0;","    pR = (pR - step(0.5, pR)) * 2.0;","    pU = (pU - step(0.5, pU)) * 2.0;","    pD = (pD - step(0.5, pD)) * 2.0;","    float p = (divNorm + pR + pL + pD + pU) * 0.25;","    gl_FragColor = vec4( 0.0, p * 0.5 + step(0.0, -p), div, 0.0);","}"].join("\n")},Fire.ProjectionShader3={uniforms:{oneOverWidth:{type:"f",value:null},oneOverHeight:{type:"f",value:null},densityMap:{type:"t",value:null},projMap:{type:"t",value:null}},vertexShader:["varying vec2 vUv;","void main() {"," \t  vUv = uv;","     vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","     gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform float oneOverWidth;","uniform float oneOverHeight;","uniform sampler2D densityMap;","uniform sampler2D projMap;","varying vec2 vUv;","void main() {","    vec4 orig = texture2D(densityMap, vUv);","    float pL = texture2D( projMap, vec2(vUv.x - oneOverWidth, vUv.y) ).g;","    float pR = texture2D( projMap, vec2(vUv.x + oneOverWidth, vUv.y) ).g;","    float pU = texture2D( projMap, vec2(vUv.x, vUv.y - oneOverHeight) ).g;","    float pD = texture2D( projMap, vec2(vUv.x, vUv.y + oneOverHeight) ).g;","    float uNorm = (orig.g - step(0.5, orig.g)) * 2.0;","    float vNorm = (orig.b - step(0.5, orig.b)) * 2.0;","    pL = (pL - step(0.5, pL)) * 2.0;","    pR = (pR - step(0.5, pR)) * 2.0;","    pU = (pU - step(0.5, pU)) * 2.0;","    pD = (pD - step(0.5, pD)) * 2.0;","    float h = (oneOverWidth + oneOverHeight) * 0.5;","    float u = uNorm - (0.5 * (pR - pL) / h);","    float v = vNorm - (0.5 * (pD - pU) / h);","    gl_FragColor = vec4( orig.r, u * 0.5 + step(0.0, -u), v * 0.5 + step(0.0, -v), orig.a);","}"].join("\n")},Fire.ColorShader={uniforms:{color1:{type:"c",value:null},color2:{type:"c",value:null},color3:{type:"c",value:null},colorBias:{type:"f",value:null},densityMap:{type:"t",value:null}},vertexShader:["varying vec2 vUv;","void main() {"," \t  vUv = uv;","     vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","     gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform vec3 color1;","uniform vec3 color2;","uniform vec3 color3;","uniform float colorBias;","uniform sampler2D densityMap;","varying vec2 vUv;","void main() {","    float density = texture2D( densityMap, vUv ).a;","    float temperature = texture2D( densityMap, vUv ).r;","    float bias = clamp(colorBias, 0.0001, 0.9999);","    vec3 blend1 = mix(color3, color2, temperature / bias) * (1.0 - step(bias, temperature));","    vec3 blend2 = mix(color2, color1, (temperature - bias) / (1.0 - bias) ) * step(bias, temperature);","    gl_FragColor = vec4(blend1 + blend2, density);","}"].join("\n")},Fire.DebugShader={uniforms:{color1:{type:"c",value:null},color2:{type:"c",value:null},color3:{type:"c",value:null},colorBias:{type:"f",value:null},densityMap:{type:"t",value:null}},vertexShader:["varying vec2 vUv;","void main() {"," \t  vUv = uv;","     vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","     gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform sampler2D densityMap;","varying vec2 vUv;","void main() {","    float density;","    density = texture2D( densityMap, vUv ).a;","    vec2 vel = texture2D( densityMap, vUv ).gb;","    vel = (vel - step(0.5, vel)) * 2.0;","    float r = density;","    float g = max(abs(vel.x), density * 0.5);","    float b = max(abs(vel.y), density * 0.5);","    float a = max(density * 0.5, max(abs(vel.x), abs(vel.y)));","    gl_FragColor = vec4(r, g, b, a);","}"].join("\n")},Object.assign(Box2.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new Vector2;return function(t,r){var n=e.copy(r).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return void 0===e&&(console.warn("Box2: .getCenter() target is now required"),e=new Vector2),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("Box2: .getSize() target is now required"),e=new Vector2),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return void 0===t&&(console.warn("Box2: .getParameter() target is now required"),t=new Vector2),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return void 0===t&&(console.warn("Box2: .clampPoint() target is now required"),t=new Vector2),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new Vector2;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var Lensflare=function e(){Mesh.call(this,e.Geometry,new MeshBasicMaterial({opacity:0,transparent:!0})),this.type="Lensflare",this.frustumCulled=!1,this.renderOrder=1/0;var t=new Vector3,r=new Vector3,n=new DataTexture(new Uint8Array(768),16,16,RGBFormat);n.minFilter=NearestFilter,n.magFilter=NearestFilter,n.wrapS=ClampToEdgeWrapping,n.wrapT=ClampToEdgeWrapping,n.needsUpdate=!0;var i=new DataTexture(new Uint8Array(768),16,16,RGBFormat);i.minFilter=NearestFilter,i.magFilter=NearestFilter,i.wrapS=ClampToEdgeWrapping,i.wrapT=ClampToEdgeWrapping,i.needsUpdate=!0;var o=e.Geometry,a=new RawShaderMaterial({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","attribute vec3 position;","void main() {","\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","void main() {","\tgl_FragColor = vec4( 1.0, 0.0, 1.0, 1.0 );","}"].join("\n"),depthTest:!0,depthWrite:!1,transparent:!1}),s=new RawShaderMaterial({uniforms:{map:{value:n},scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","attribute vec3 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","\tvUV = uv;","\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","uniform sampler2D map;","varying vec2 vUV;","void main() {","\tgl_FragColor = texture2D( map, vUV );","}"].join("\n"),depthTest:!1,depthWrite:!1,transparent:!1}),l=new Mesh(o,a),u=[],c=LensflareElement.Shader,h=new RawShaderMaterial({uniforms:{map:{value:null},occlusionMap:{value:i},color:{value:new Color(16777215)},scale:{value:new Vector2},screenPosition:{value:new Vector3}},vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,blending:AdditiveBlending,transparent:!0,depthWrite:!1}),p=new Mesh(o,h);this.addElement=function(e){u.push(e)};var f=new Vector2,d=new Vector2,m=new Box2,v=new Vector4;this.onBeforeRender=function(e,c,g){e.getCurrentViewport(v);var y=v.w/v.z,b=v.z/2,x=v.w/2,w=16/v.w;if(f.set(w*y,w),m.min.set(v.x,v.y),m.max.set(v.x+(v.z-16),v.y+(v.w-16)),r.setFromMatrixPosition(this.matrixWorld),r.applyMatrix4(g.matrixWorldInverse),!(r.z>0)&&(t.copy(r).applyMatrix4(g.projectionMatrix),d.x=v.x+t.x*b+b-8,d.y=v.y+t.y*x+x-8,m.containsPoint(d))){e.copyFramebufferToTexture(d,n),(A=a.uniforms).scale.value=f,A.screenPosition.value=t,e.renderBufferDirect(g,null,o,a,l,null),e.copyFramebufferToTexture(d,i),(A=s.uniforms).scale.value=f,A.screenPosition.value=t,e.renderBufferDirect(g,null,o,s,l,null);for(var S=2*-t.x,M=2*-t.y,_=0,T=u.length;_<T;_++){var A,C=u[_];(A=h.uniforms).color.value.copy(C.color),A.map.value=C.texture,A.screenPosition.value.x=t.x+S*C.distance,A.screenPosition.value.y=t.y+M*C.distance;w=C.size/v.w,y=v.w/v.z;A.scale.value.set(w*y,w),h.uniformsNeedUpdate=!0,e.renderBufferDirect(g,null,o,h,p,null)}}},this.dispose=function(){a.dispose(),s.dispose(),h.dispose(),n.dispose(),i.dispose();for(var e=0,t=u.length;e<t;e++)u[e].texture.dispose()}};Lensflare.prototype=Object.create(Mesh.prototype),Lensflare.prototype.constructor=Lensflare,Lensflare.prototype.isLensflare=!0;var LensflareElement=function(e,t,r,n){this.texture=e,this.size=t||1,this.distance=r||0,this.color=n||new Color(16777215)};LensflareElement.Shader={uniforms:{map:{value:null},occlusionMap:{value:null},color:{value:null},scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform sampler2D occlusionMap;","attribute vec3 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","\tvUV = uv;","\tvec2 pos = position.xy;","\tvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","\tvVisibility =        visibility.r / 9.0;","\tvVisibility *= 1.0 - visibility.g / 9.0;","\tvVisibility *=       visibility.b / 9.0;","\tgl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","uniform sampler2D map;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","\tvec4 texture = texture2D( map, vUV );","\ttexture.a *= vVisibility;","\tgl_FragColor = texture;","\tgl_FragColor.rgb *= color;","}"].join("\n")},Lensflare.Geometry=function(){var e=new BufferGeometry,t=new InterleavedBuffer(new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,1,1,0,1,1,-1,1,0,0,1]),5);return e.setIndex([0,1,2,0,2,3]),e.addAttribute("position",new InterleavedBufferAttribute(t,3,0,!1)),e.addAttribute("uv",new InterleavedBufferAttribute(t,2,3,!1)),e}();var LightningStorm=function(e){Object3D.call(this),e=e||{},this.stormParams=e,e.size=void 0!==e.size?e.size:1e3,e.minHeight=void 0!==e.minHeight?e.minHeight:80,e.maxHeight=void 0!==e.maxHeight?e.maxHeight:100,e.maxSlope=void 0!==e.maxSlope?e.maxSlope:1.1,e.maxLightnings=void 0!==e.maxLightnings?e.maxLightnings:3,e.lightningMinPeriod=void 0!==e.lightningMinPeriod?e.lightningMinPeriod:3,e.lightningMaxPeriod=void 0!==e.lightningMaxPeriod?e.lightningMaxPeriod:7,e.lightningMinDuration=void 0!==e.lightningMinDuration?e.lightningMinDuration:1,e.lightningMaxDuration=void 0!==e.lightningMaxDuration?e.lightningMaxDuration:2.5,this.lightningParameters=LightningStrike.copyParameters(e.lightningParameters,e.lightningParameters),this.lightningParameters.isEternal=!1,this.lightningMaterial=void 0!==e.lightningMaterial?e.lightningMaterial:new MeshBasicMaterial({color:11599871}),void 0!==e.onRayPosition?this.onRayPosition=e.onRayPosition:this.onRayPosition=function(t,r){r.set((Math.random()-.5)*e.size,0,(Math.random()-.5)*e.size);var n=_Math.lerp(e.minHeight,e.maxHeight,Math.random());t.set(e.maxSlope*(2*Math.random()-1),1,e.maxSlope*(2*Math.random()-1)).multiplyScalar(n).add(r)},this.onLightningDown=e.onLightningDown,this.inited=!1,this.nextLightningTime=0,this.lightningsMeshes=[],this.deadLightningsMeshes=[];for(var t=0;t<this.stormParams.maxLightnings;t++){var r=new Mesh(new LightningStrike(LightningStrike.copyParameters({},this.lightningParameters)),this.lightningMaterial);this.deadLightningsMeshes.push(r)}};LightningStorm.prototype=Object.create(Object3D.prototype),LightningStorm.prototype.constructor=LightningStorm,LightningStorm.prototype.isLightningStorm=!0,LightningStorm.prototype.update=function(e){if(this.inited||(this.nextLightningTime=this.getNextLightningTime(e)*Math.random(),this.inited=!0),e>=this.nextLightningTime){var t=this.deadLightningsMeshes.pop();if(t){var r=LightningStrike.copyParameters(t.geometry.rayParameters,this.lightningParameters);r.birthTime=e,r.deathTime=e+_Math.lerp(this.stormParams.lightningMinDuration,this.stormParams.lightningMaxDuration,Math.random()),this.onRayPosition(r.sourceOffset,r.destOffset),r.noiseSeed=Math.random(),this.add(t),this.lightningsMeshes.push(t)}this.nextLightningTime=this.getNextLightningTime(e)}var n=0;for(il=this.lightningsMeshes.length;n<il;){var i=this.lightningsMeshes[n],o=i.geometry,a=o.state;o.update(e),a===LightningStrike.RAY_PROPAGATING&&o.state>a&&this.onLightningDown&&this.onLightningDown(o),o.state===LightningStrike.RAY_EXTINGUISHED?(this.lightningsMeshes.splice(this.lightningsMeshes.indexOf(i),1),this.deadLightningsMeshes.push(i),this.remove(i),il--):n++}},LightningStorm.prototype.getNextLightningTime=function(e){return e+_Math.lerp(this.stormParams.lightningMinPeriod,this.stormParams.lightningMaxPeriod,Math.random())/(this.stormParams.maxLightnings+1)},LightningStorm.prototype.copy=function(e){return Object3D.prototype.copy.call(this,e),this.stormParams.size=e.stormParams.size,this.stormParams.minHeight=e.stormParams.minHeight,this.stormParams.maxHeight=e.stormParams.maxHeight,this.stormParams.maxSlope=e.stormParams.maxSlope,this.stormParams.maxLightnings=e.stormParams.maxLightnings,this.stormParams.lightningMinPeriod=e.stormParams.lightningMinPeriod,this.stormParams.lightningMaxPeriod=e.stormParams.lightningMaxPeriod,this.stormParams.lightningMinDuration=e.stormParams.lightningMinDuration,this.stormParams.lightningMaxDuration=e.stormParams.lightningMaxDuration,this.lightningParameters=LightningStrike.copyParameters({},e.lightningParameters),this.lightningMaterial=e.stormParams.lightningMaterial,this.onLightningDown=e.onLightningDown,this},LightningStrike.prototype.clone=function(){return new this.constructor(this.stormParams).copy(this)};var Reflector=function e(t,r){Mesh.call(this,t),this.type="Reflector";var n=this,i=void 0!==(r=r||{}).color?new Color(r.color):new Color(8355711),o=r.textureWidth||512,a=r.textureHeight||512,s=r.clipBias||0,l=r.shader||e.ReflectorShader,u=void 0!==r.recursion?r.recursion:0,c=new Plane,h=new Vector3,p=new Vector3,f=new Vector3,d=new Matrix4,m=new Vector3(0,0,-1),v=new Vector4,g=new Vector4,y=new Vector3,b=new Vector3,x=new Vector4,w=new Vector2,S=new Matrix4,M=new PerspectiveCamera,_=new WebGLRenderTarget(o,a,{minFilter:LinearFilter,magFilter:LinearFilter,format:RGBFormat,stencilBuffer:!1});_Math.isPowerOfTwo(o)&&_Math.isPowerOfTwo(a)||(_.texture.generateMipmaps=!1);var T=new ShaderMaterial({uniforms:UniformsUtils.clone(l.uniforms),fragmentShader:l.fragmentShader,vertexShader:l.vertexShader});T.uniforms.tDiffuse.value=_.texture,T.uniforms.color.value=i,T.uniforms.textureMatrix.value=S,this.material=T,this.onBeforeRender=function(e,t,r){if("recursion"in r.userData){if(r.userData.recursion===u)return;r.userData.recursion++}if(p.setFromMatrixPosition(n.matrixWorld),f.setFromMatrixPosition(r.matrixWorld),d.extractRotation(n.matrixWorld),h.set(0,0,1),h.applyMatrix4(d),y.subVectors(p,f),!(y.dot(h)>0)){y.reflect(h).negate(),y.add(p),d.extractRotation(r.matrixWorld),m.set(0,0,-1),m.applyMatrix4(d),m.add(f),b.subVectors(p,m),b.reflect(h).negate(),b.add(p),M.position.copy(y),M.up.set(0,1,0),M.up.applyMatrix4(d),M.up.reflect(h),M.lookAt(b),M.far=r.far,M.updateMatrixWorld(),M.projectionMatrix.copy(r.projectionMatrix),M.userData.recursion=0,S.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),S.multiply(M.projectionMatrix),S.multiply(M.matrixWorldInverse),S.multiply(n.matrixWorld),c.setFromNormalAndCoplanarPoint(h,p),c.applyMatrix4(M.matrixWorldInverse),v.set(c.normal.x,c.normal.y,c.normal.z,c.constant);var i=M.projectionMatrix;x.x=(Math.sign(v.x)+i.elements[8])/i.elements[0],x.y=(Math.sign(v.y)+i.elements[9])/i.elements[5],x.z=-1,x.w=(1+i.elements[10])/i.elements[14],v.multiplyScalar(2/v.dot(x)),i.elements[2]=v.x,i.elements[6]=v.y,i.elements[10]=v.z+1-s,i.elements[14]=v.w,n.visible=!1;var o=e.getRenderTarget(),a=e.vr.enabled,l=e.shadowMap.autoUpdate;e.vr.enabled=!1,e.shadowMap.autoUpdate=!1,e.setRenderTarget(_),e.clear(),e.render(t,M),e.vr.enabled=a,e.shadowMap.autoUpdate=l,e.setRenderTarget(o);var T=r.bounds;if(void 0!==T){e.getSize(w);var A=e.getPixelRatio();g.x=T.x*w.width*A,g.y=T.y*w.height*A,g.z=T.z*w.width*A,g.w=T.w*w.height*A,e.state.viewport(g)}n.visible=!0}},this.getRenderTarget=function(){return _}};Reflector.prototype=Object.create(Mesh.prototype),Reflector.prototype.constructor=Reflector,Reflector.ReflectorShader={uniforms:{color:{type:"c",value:null},tDiffuse:{type:"t",value:null},textureMatrix:{type:"m4",value:null}},vertexShader:["uniform mat4 textureMatrix;","varying vec4 vUv;","void main() {","\tvUv = textureMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","\tvec4 base = texture2DProj( tDiffuse, vUv );","\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")};var ReflectorRTT=function(e,t){Reflector.call(this,e,t),this.geometry.setDrawRange(0,0)};ReflectorRTT.prototype=Object.create(Reflector.prototype);var Refractor=function e(t,r){Mesh.call(this,t),this.type="Refractor";var n=this,i=void 0!==(r=r||{}).color?new Color(r.color):new Color(8355711),o=r.textureWidth||512,a=r.textureHeight||512,s=r.clipBias||0,l=r.shader||e.RefractorShader,u=new PerspectiveCamera;u.matrixAutoUpdate=!1,u.userData.refractor=!0;var c=new Plane,h=new Matrix4,p=new WebGLRenderTarget(o,a,{minFilter:LinearFilter,magFilter:LinearFilter,format:RGBFormat,stencilBuffer:!1});_Math.isPowerOfTwo(o)&&_Math.isPowerOfTwo(a)||(p.texture.generateMipmaps=!1),this.material=new ShaderMaterial({uniforms:UniformsUtils.clone(l.uniforms),vertexShader:l.vertexShader,fragmentShader:l.fragmentShader,transparent:!0}),this.material.uniforms.color.value=i,this.material.uniforms.tDiffuse.value=p.texture,this.material.uniforms.textureMatrix.value=h;var f=function(){var e=new Vector3,t=new Vector3,r=new Matrix4,i=new Vector3,o=new Vector3;return function(a){return e.setFromMatrixPosition(n.matrixWorld),t.setFromMatrixPosition(a.matrixWorld),i.subVectors(e,t),r.extractRotation(n.matrixWorld),o.set(0,0,1),o.applyMatrix4(r),i.dot(o)<0}}(),d=function(){var e=new Vector3,t=new Vector3,r=new Quaternion,i=new Vector3;return function(){n.matrixWorld.decompose(t,r,i),e.set(0,0,1).applyQuaternion(r).normalize(),e.negate(),c.setFromNormalAndCoplanarPoint(e,t)}}(),m=function(){var e=new Plane,t=new Vector4,r=new Vector4;return function(n){u.matrixWorld.copy(n.matrixWorld),u.matrixWorldInverse.getInverse(u.matrixWorld),u.projectionMatrix.copy(n.projectionMatrix),u.far=n.far,e.copy(c),e.applyMatrix4(u.matrixWorldInverse),t.set(e.normal.x,e.normal.y,e.normal.z,e.constant);var i=u.projectionMatrix;r.x=(Math.sign(t.x)+i.elements[8])/i.elements[0],r.y=(Math.sign(t.y)+i.elements[9])/i.elements[5],r.z=-1,r.w=(1+i.elements[10])/i.elements[14],t.multiplyScalar(2/t.dot(r)),i.elements[2]=t.x,i.elements[6]=t.y,i.elements[10]=t.z+1-s,i.elements[14]=t.w}}();var v=function(){var e=new Vector4,t=new Vector2;return function(r,i,o){n.visible=!1;var a=r.getRenderTarget(),s=r.vr.enabled,l=r.shadowMap.autoUpdate;r.vr.enabled=!1,r.shadowMap.autoUpdate=!1,r.setRenderTarget(p),r.clear(),r.render(i,u),r.vr.enabled=s,r.shadowMap.autoUpdate=l,r.setRenderTarget(a);var c=o.bounds;if(void 0!==c){r.getSize(t);var h=r.getPixelRatio();e.x=c.x*t.width*h,e.y=c.y*t.height*h,e.z=c.z*t.width*h,e.w=c.w*t.height*h,r.state.viewport(e)}n.visible=!0}}();this.onBeforeRender=function(e,t,r){!0!==r.userData.refractor&&!0!==!f(r)&&(d(),function(e){h.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),h.multiply(e.projectionMatrix),h.multiply(e.matrixWorldInverse),h.multiply(n.matrixWorld)}(r),m(r),v(e,t,r))},this.getRenderTarget=function(){return p}};Refractor.prototype=Object.create(Mesh.prototype),Refractor.prototype.constructor=Refractor,Refractor.RefractorShader={uniforms:{color:{type:"c",value:null},tDiffuse:{type:"t",value:null},textureMatrix:{type:"m4",value:null}},vertexShader:["uniform mat4 textureMatrix;","varying vec4 vUv;","void main() {","\tvUv = textureMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","\tvec4 base = texture2DProj( tDiffuse, vUv );","\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")};var ShadowMesh=function(e){var t=new MeshBasicMaterial({color:0,transparent:!0,opacity:.6,depthWrite:!1});Mesh.call(this,e.geometry,t),this.meshMatrix=e.matrixWorld,this.frustumCulled=!1,this.matrixAutoUpdate=!1};ShadowMesh.prototype=Object.create(Mesh.prototype),ShadowMesh.prototype.constructor=ShadowMesh,ShadowMesh.prototype.update=function(){var e=new Matrix4;return function(t,r){var n=t.normal.x*r.x+t.normal.y*r.y+t.normal.z*r.z+-t.constant*r.w,i=e.elements;i[0]=n-r.x*t.normal.x,i[4]=-r.x*t.normal.y,i[8]=-r.x*t.normal.z,i[12]=-r.x*-t.constant,i[1]=-r.y*t.normal.x,i[5]=n-r.y*t.normal.y,i[9]=-r.y*t.normal.z,i[13]=-r.y*-t.constant,i[2]=-r.z*t.normal.x,i[6]=-r.z*t.normal.y,i[10]=n-r.z*t.normal.z,i[14]=-r.z*-t.constant,i[3]=-r.w*t.normal.x,i[7]=-r.w*t.normal.y,i[11]=-r.w*t.normal.z,i[15]=n-r.w*-t.constant,this.matrix.multiplyMatrices(e,this.meshMatrix)}}();var Sky=function e(){var t=e.SkyShader,r=new ShaderMaterial({fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,uniforms:UniformsUtils.clone(t.uniforms),side:BackSide});Mesh.call(this,new BoxBufferGeometry(1,1,1),r)};Sky.prototype=Object.create(Mesh.prototype),Sky.SkyShader={uniforms:{luminance:{value:1},turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new Vector3}},vertexShader:["uniform vec3 sunPosition;","uniform float rayleigh;","uniform float turbidity;","uniform float mieCoefficient;","varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","const vec3 up = vec3( 0.0, 1.0, 0.0 );","const float e = 2.71828182845904523536028747135266249775724709369995957;","const float pi = 3.141592653589793238462643383279502884197169;","const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );","const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );","const float v = 4.0;","const vec3 K = vec3( 0.686, 0.678, 0.666 );","const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );","const float cutoffAngle = 1.6110731556870734;","const float steepness = 1.5;","const float EE = 1000.0;","float sunIntensity( float zenithAngleCos ) {","\tzenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );","\treturn EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );","}","vec3 totalMie( float T ) {","\tfloat c = ( 0.2 * T ) * 10E-18;","\treturn 0.434 * c * MieConst;","}","void main() {","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvWorldPosition = worldPosition.xyz;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","\tgl_Position.z = gl_Position.w;","\tvSunDirection = normalize( sunPosition );","\tvSunE = sunIntensity( dot( vSunDirection, up ) );","\tvSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );","\tfloat rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );","\tvBetaR = totalRayleigh * rayleighCoefficient;","\tvBetaM = totalMie( turbidity ) * mieCoefficient;","}"].join("\n"),fragmentShader:["varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","uniform float luminance;","uniform float mieDirectionalG;","const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );","const float pi = 3.141592653589793238462643383279502884197169;","const float n = 1.0003;","const float N = 2.545E25;","const float rayleighZenithLength = 8.4E3;","const float mieZenithLength = 1.25E3;","const vec3 up = vec3( 0.0, 1.0, 0.0 );","const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;","const float THREE_OVER_SIXTEENPI = 0.05968310365946075;","const float ONE_OVER_FOURPI = 0.07957747154594767;","float rayleighPhase( float cosTheta ) {","\treturn THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );","}","float hgPhase( float cosTheta, float g ) {","\tfloat g2 = pow( g, 2.0 );","\tfloat inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );","\treturn ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );","}","const float A = 0.15;","const float B = 0.50;","const float C = 0.10;","const float D = 0.20;","const float E = 0.02;","const float F = 0.30;","const float whiteScale = 1.0748724675633854;","vec3 Uncharted2Tonemap( vec3 x ) {","\treturn ( ( x * ( A * x + C * B ) + D * E ) / ( x * ( A * x + B ) + D * F ) ) - E / F;","}","void main() {","\tfloat zenithAngle = acos( max( 0.0, dot( up, normalize( vWorldPosition - cameraPos ) ) ) );","\tfloat inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );","\tfloat sR = rayleighZenithLength * inverse;","\tfloat sM = mieZenithLength * inverse;","\tvec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );","\tfloat cosTheta = dot( normalize( vWorldPosition - cameraPos ), vSunDirection );","\tfloat rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );","\tvec3 betaRTheta = vBetaR * rPhase;","\tfloat mPhase = hgPhase( cosTheta, mieDirectionalG );","\tvec3 betaMTheta = vBetaM * mPhase;","\tvec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );","\tLin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );","\tvec3 direction = normalize( vWorldPosition - cameraPos );","\tfloat theta = acos( direction.y ); // elevation --\x3e y-axis, [-pi/2, pi/2]","\tfloat phi = atan( direction.z, direction.x ); // azimuth --\x3e x-axis [-pi/2, pi/2]","\tvec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );","\tvec3 L0 = vec3( 0.1 ) * Fex;","\tfloat sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );","\tL0 += ( vSunE * 19000.0 * Fex ) * sundisk;","\tvec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );","\tvec3 curr = Uncharted2Tonemap( ( log2( 2.0 / pow( luminance, 4.0 ) ) ) * texColor );","\tvec3 color = curr * whiteScale;","\tvec3 retColor = pow( color, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );","\tgl_FragColor = vec4( retColor, 1.0 );","}"].join("\n")};var Water=function(e,t){Mesh.call(this,e);var r=this,n=void 0!==(t=t||{}).textureWidth?t.textureWidth:512,i=void 0!==t.textureHeight?t.textureHeight:512,o=void 0!==t.clipBias?t.clipBias:0,a=void 0!==t.alpha?t.alpha:1,s=void 0!==t.time?t.time:0,l=void 0!==t.waterNormals?t.waterNormals:null,u=void 0!==t.sunDirection?t.sunDirection:new Vector3(.70707,.70707,0),c=new Color(void 0!==t.sunColor?t.sunColor:16777215),h=new Color(void 0!==t.waterColor?t.waterColor:8355711),p=void 0!==t.eye?t.eye:new Vector3(0,0,0),f=void 0!==t.distortionScale?t.distortionScale:20,d=void 0!==t.side?t.side:FrontSide,m=void 0!==t.fog&&t.fog,v=new Plane,g=new Vector3,y=new Vector3,b=new Vector3,x=new Matrix4,w=new Vector3(0,0,-1),S=new Vector4,M=new Vector3,_=new Vector3,T=new Vector4,A=new Matrix4,C=new PerspectiveCamera,E=new WebGLRenderTarget(n,i,{minFilter:LinearFilter,magFilter:LinearFilter,format:RGBFormat,stencilBuffer:!1});_Math.isPowerOfTwo(n)&&_Math.isPowerOfTwo(i)||(E.texture.generateMipmaps=!1);var L={uniforms:UniformsUtils.merge([UniformsLib.fog,UniformsLib.lights,{normalSampler:{value:null},mirrorSampler:{value:null},alpha:{value:1},time:{value:0},size:{value:1},distortionScale:{value:20},textureMatrix:{value:new Matrix4},sunColor:{value:new Color(8355711)},sunDirection:{value:new Vector3(.70707,.70707,0)},eye:{value:new Vector3},waterColor:{value:new Color(5592405)}}]),vertexShader:["uniform mat4 textureMatrix;","uniform float time;","varying vec4 mirrorCoord;","varying vec4 worldPosition;",ShaderChunk.fog_pars_vertex,ShaderChunk.shadowmap_pars_vertex,"void main() {","\tmirrorCoord = modelMatrix * vec4( position, 1.0 );","\tworldPosition = mirrorCoord.xyzw;","\tmirrorCoord = textureMatrix * mirrorCoord;","\tvec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * mvPosition;",ShaderChunk.fog_vertex,ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform sampler2D mirrorSampler;","uniform float alpha;","uniform float time;","uniform float size;","uniform float distortionScale;","uniform sampler2D normalSampler;","uniform vec3 sunColor;","uniform vec3 sunDirection;","uniform vec3 eye;","uniform vec3 waterColor;","varying vec4 mirrorCoord;","varying vec4 worldPosition;","vec4 getNoise( vec2 uv ) {","\tvec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);","\tvec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );","\tvec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );","\tvec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );","\tvec4 noise = texture2D( normalSampler, uv0 ) +","\t\ttexture2D( normalSampler, uv1 ) +","\t\ttexture2D( normalSampler, uv2 ) +","\t\ttexture2D( normalSampler, uv3 );","\treturn noise * 0.5 - 1.0;","}","void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {","\tvec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );","\tfloat direction = max( 0.0, dot( eyeDirection, reflection ) );","\tspecularColor += pow( direction, shiny ) * sunColor * spec;","\tdiffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;","}",ShaderChunk.common,ShaderChunk.packing,ShaderChunk.bsdfs,ShaderChunk.fog_pars_fragment,ShaderChunk.lights_pars_begin,ShaderChunk.shadowmap_pars_fragment,ShaderChunk.shadowmask_pars_fragment,"void main() {","\tvec4 noise = getNoise( worldPosition.xz * size );","\tvec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );","\tvec3 diffuseLight = vec3(0.0);","\tvec3 specularLight = vec3(0.0);","\tvec3 worldToEye = eye-worldPosition.xyz;","\tvec3 eyeDirection = normalize( worldToEye );","\tsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );","\tfloat distance = length(worldToEye);","\tvec2 distortion = surfaceNormal.xz * ( 0.001 + 1.0 / distance ) * distortionScale;","\tvec3 reflectionSample = vec3( texture2D( mirrorSampler, mirrorCoord.xy / mirrorCoord.w + distortion ) );","\tfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );","\tfloat rf0 = 0.3;","\tfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );","\tvec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;","\tvec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ) * getShadowMask(), ( vec3( 0.1 ) + reflectionSample * 0.9 + reflectionSample * specularLight ), reflectance);","\tvec3 outgoingLight = albedo;","\tgl_FragColor = vec4( outgoingLight, alpha );",ShaderChunk.tonemapping_fragment,ShaderChunk.fog_fragment,"}"].join("\n")},N=new ShaderMaterial({fragmentShader:L.fragmentShader,vertexShader:L.vertexShader,uniforms:UniformsUtils.clone(L.uniforms),transparent:!0,lights:!0,side:d,fog:m});N.uniforms.mirrorSampler.value=E.texture,N.uniforms.textureMatrix.value=A,N.uniforms.alpha.value=a,N.uniforms.time.value=s,N.uniforms.normalSampler.value=l,N.uniforms.sunColor.value=c,N.uniforms.waterColor.value=h,N.uniforms.sunDirection.value=u,N.uniforms.distortionScale.value=f,N.uniforms.eye.value=p,r.material=N,r.onBeforeRender=function(e,t,n){if(y.setFromMatrixPosition(r.matrixWorld),b.setFromMatrixPosition(n.matrixWorld),x.extractRotation(r.matrixWorld),g.set(0,0,1),g.applyMatrix4(x),M.subVectors(y,b),!(M.dot(g)>0)){M.reflect(g).negate(),M.add(y),x.extractRotation(n.matrixWorld),w.set(0,0,-1),w.applyMatrix4(x),w.add(b),_.subVectors(y,w),_.reflect(g).negate(),_.add(y),C.position.copy(M),C.up.set(0,1,0),C.up.applyMatrix4(x),C.up.reflect(g),C.lookAt(_),C.far=n.far,C.updateMatrixWorld(),C.projectionMatrix.copy(n.projectionMatrix),A.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),A.multiply(C.projectionMatrix),A.multiply(C.matrixWorldInverse),v.setFromNormalAndCoplanarPoint(g,y),v.applyMatrix4(C.matrixWorldInverse),S.set(v.normal.x,v.normal.y,v.normal.z,v.constant);var i=C.projectionMatrix;T.x=(Math.sign(S.x)+i.elements[8])/i.elements[0],T.y=(Math.sign(S.y)+i.elements[9])/i.elements[5],T.z=-1,T.w=(1+i.elements[10])/i.elements[14],S.multiplyScalar(2/S.dot(T)),i.elements[2]=S.x,i.elements[6]=S.y,i.elements[10]=S.z+1-o,i.elements[14]=S.w,p.setFromMatrixPosition(n.matrixWorld);var a=e.getRenderTarget(),s=e.vr.enabled,l=e.shadowMap.autoUpdate;r.visible=!1,e.vr.enabled=!1,e.shadowMap.autoUpdate=!1,e.setRenderTarget(E),e.clear(),e.render(t,C),r.visible=!0,e.vr.enabled=s,e.shadowMap.autoUpdate=l,e.setRenderTarget(a)}}};function Water2(e,t){Mesh.call(this,e),this.type="Water2";var r=this,n=void 0!==(t=t||{}).color?new Color(t.color):new Color(16777215),i=t.textureWidth||512,o=t.textureHeight||512,a=t.clipBias||0,s=t.flowDirection||new Vector2(1,0),l=t.flowSpeed||.03,u=t.reflectivity||.02,c=t.scale||1,h=t.shader||Water2.Water2Shader,p=new TextureLoader,f=t.flowMap||void 0,d=t.normalMap0||p.load("textures/water/Water2_1_M_Normal.jpg"),m=t.normalMap1||p.load("textures/water/Water2_2_M_Normal.jpg"),v=.15,g=.5*v,y=new Matrix4,b=new Clock;if(void 0!==Reflector)if(void 0!==Refractor){var x=new Reflector(e,{textureWidth:i,textureHeight:o,clipBias:a}),w=new Refractor(e,{textureWidth:i,textureHeight:o,clipBias:a});x.matrixAutoUpdate=!1,w.matrixAutoUpdate=!1,this.material=new ShaderMaterial({uniforms:UniformsUtils.merge([UniformsLib.fog,h.uniforms]),vertexShader:h.vertexShader,fragmentShader:h.fragmentShader,transparent:!0,fog:!0}),void 0!==f?(this.material.defines.USE_FLOWMAP="",this.material.uniforms.tFlowMap={type:"t",value:f}):this.material.uniforms.flowDirection={type:"v2",value:s},d.wrapS=d.wrapT=RepeatWrapping,m.wrapS=m.wrapT=RepeatWrapping,this.material.uniforms.tReflectionMap.value=x.getRenderTarget().texture,this.material.uniforms.tRefractionMap.value=w.getRenderTarget().texture,this.material.uniforms.tNormalMap0.value=d,this.material.uniforms.tNormalMap1.value=m,this.material.uniforms.color.value=n,this.material.uniforms.reflectivity.value=u,this.material.uniforms.textureMatrix.value=y,this.material.uniforms.config.value.x=0,this.material.uniforms.config.value.y=g,this.material.uniforms.config.value.z=g,this.material.uniforms.config.value.w=c,this.onBeforeRender=function(e,t,n){!function(e){y.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),y.multiply(e.projectionMatrix),y.multiply(e.matrixWorldInverse),y.multiply(r.matrixWorld)}(n),function(){var e=b.getDelta(),t=r.material.uniforms.config;t.value.x+=l*e,t.value.y=t.value.x+g,t.value.x>=v?(t.value.x=0,t.value.y=g):t.value.y>=v&&(t.value.y=t.value.y-v)}(),r.visible=!1,x.matrixWorld.copy(r.matrixWorld),w.matrixWorld.copy(r.matrixWorld),x.onBeforeRender(e,t,n),w.onBeforeRender(e,t,n),r.visible=!0}}else console.error("Water2: Required component Refractor not found.");else console.error("Water2: Required component Reflector not found.")}Water.prototype=Object.create(Mesh.prototype),Water.prototype.constructor=Water,Water2.prototype=Object.create(Mesh.prototype),Water2.prototype.constructor=Water2,Water2.Water2Shader={uniforms:{color:{type:"c",value:null},reflectivity:{type:"f",value:0},tReflectionMap:{type:"t",value:null},tRefractionMap:{type:"t",value:null},tNormalMap0:{type:"t",value:null},tNormalMap1:{type:"t",value:null},textureMatrix:{type:"m4",value:null},config:{type:"v4",value:new Vector4}},vertexShader:["#include <fog_pars_vertex>","uniform mat4 textureMatrix;","varying vec4 vCoord;","varying vec2 vUv;","varying vec3 vToEye;","void main() {","\tvUv = uv;","\tvCoord = textureMatrix * vec4( position, 1.0 );","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvToEye = cameraPosition - worldPosition.xyz;","\tvec4 mvPosition =  viewMatrix * worldPosition;","\tgl_Position = projectionMatrix * mvPosition;","\t#include <fog_vertex>","}"].join("\n"),fragmentShader:["#include <common>","#include <fog_pars_fragment>","uniform sampler2D tReflectionMap;","uniform sampler2D tRefractionMap;","uniform sampler2D tNormalMap0;","uniform sampler2D tNormalMap1;","#ifdef USE_FLOWMAP","\tuniform sampler2D tFlowMap;","#else","\tuniform vec2 flowDirection;","#endif","uniform vec3 color;","uniform float reflectivity;","uniform vec4 config;","varying vec4 vCoord;","varying vec2 vUv;","varying vec3 vToEye;","void main() {","\tfloat flowMapOffset0 = config.x;","\tfloat flowMapOffset1 = config.y;","\tfloat halfCycle = config.z;","\tfloat scale = config.w;","\tvec3 toEye = normalize( vToEye );","\tvec2 flow;","\t#ifdef USE_FLOWMAP","\t\tflow = texture2D( tFlowMap, vUv ).rg * 2.0 - 1.0;","\t#else","\t\tflow = flowDirection;","\t#endif","\tflow.x *= - 1.0;","\tvec4 normalColor0 = texture2D( tNormalMap0, ( vUv * scale ) + flow * flowMapOffset0 );","\tvec4 normalColor1 = texture2D( tNormalMap1, ( vUv * scale ) + flow * flowMapOffset1 );","\tfloat flowLerp = abs( halfCycle - flowMapOffset0 ) / halfCycle;","\tvec4 normalColor = mix( normalColor0, normalColor1, flowLerp );","\tvec3 normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b,  normalColor.g * 2.0 - 1.0 ) );","\tfloat theta = max( dot( toEye, normal ), 0.0 );","\tfloat reflectance = reflectivity + ( 1.0 - reflectivity ) * pow( ( 1.0 - theta ), 5.0 );","\tvec3 coord = vCoord.xyz / vCoord.w;","\tvec2 uv = coord.xy + coord.z * normal.xz * 0.05;","\tvec4 reflectColor = texture2D( tReflectionMap, vec2( 1.0 - uv.x, uv.y ) );","\tvec4 refractColor = texture2D( tRefractionMap, uv );","\tgl_FragColor = vec4( color, 1.0 ) * mix( refractColor, reflectColor, reflectance );","\t#include <tonemapping_fragment>","\t#include <encodings_fragment>","\t#include <fog_fragment>","}"].join("\n")};var Ocean=function(e,t,r,n){function i(e,t){return void 0!==e?e:t}this.changed=!0,this.initial=!0,this.oceanCamera=new OrthographicCamera,this.oceanCamera.position.z=1,this.renderer=e,this.renderer.clearColor(16777215),this.scene=new Scene,n=n||{},this.clearColor=i(n.CLEAR_COLOR,[1,1,1,0]),this.geometryOrigin=i(n.GEOMETRY_ORIGIN,[-1e3,-1e3]),this.sunDirectionX=i(n.SUN_DIRECTION[0],-1),this.sunDirectionY=i(n.SUN_DIRECTION[1],1),this.sunDirectionZ=i(n.SUN_DIRECTION[2],1),this.oceanColor=i(n.OCEAN_COLOR,new Vector3(.004,.016,.047)),this.skyColor=i(n.SKY_COLOR,new Vector3(3.2,9.6,12.8)),this.exposure=i(n.EXPOSURE,.35),this.geometryResolution=i(n.GEOMETRY_RESOLUTION,32),this.geometrySize=i(n.GEOMETRY_SIZE,2e3),this.resolution=i(n.RESOLUTION,64),this.floatSize=i(n.SIZE_OF_FLOAT,4),this.windX=i(n.INITIAL_WIND[0],10),this.windY=i(n.INITIAL_WIND[1],10),this.size=i(n.INITIAL_SIZE,250),this.choppiness=i(n.INITIAL_CHOPPINESS,1.5),this.matrixNeedsUpdate=!1;var o=i(n.USE_HALF_FLOAT,!1)?HalfFloatType:FloatType,a={minFilter:LinearFilter,magFilter:LinearFilter,wrapS:ClampToEdgeWrapping,wrapT:ClampToEdgeWrapping,format:RGBAFormat,stencilBuffer:!1,depthBuffer:!1,premultiplyAlpha:!1,type:o},s={minFilter:NearestFilter,magFilter:NearestFilter,wrapS:ClampToEdgeWrapping,wrapT:ClampToEdgeWrapping,format:RGBAFormat,stencilBuffer:!1,depthBuffer:!1,premultiplyAlpha:!1,type:o},l={minFilter:NearestFilter,magFilter:NearestFilter,wrapS:RepeatWrapping,wrapT:RepeatWrapping,format:RGBAFormat,stencilBuffer:!1,depthBuffer:!1,premultiplyAlpha:!1,type:o};this.initialSpectrumFramebuffer=new WebGLRenderTarget(this.resolution,this.resolution,l),this.spectrumFramebuffer=new WebGLRenderTarget(this.resolution,this.resolution,s),this.pingPhaseFramebuffer=new WebGLRenderTarget(this.resolution,this.resolution,s),this.pongPhaseFramebuffer=new WebGLRenderTarget(this.resolution,this.resolution,s),this.pingTransformFramebuffer=new WebGLRenderTarget(this.resolution,this.resolution,s),this.pongTransformFramebuffer=new WebGLRenderTarget(this.resolution,this.resolution,s),this.displacementMapFramebuffer=new WebGLRenderTarget(this.resolution,this.resolution,a),this.normalMapFramebuffer=new WebGLRenderTarget(this.resolution,this.resolution,a);var u=ShaderLib.ocean_sim_vertex,c=ShaderLib.ocean_subtransform,h=UniformsUtils.clone(c.uniforms);this.materialOceanHorizontal=new ShaderMaterial({uniforms:h,vertexShader:u.vertexShader,fragmentShader:"#define HORIZONTAL \n"+c.fragmentShader}),this.materialOceanHorizontal.uniforms.u_transformSize={value:this.resolution},this.materialOceanHorizontal.uniforms.u_subtransformSize={value:null},this.materialOceanHorizontal.uniforms.u_input={value:null},this.materialOceanHorizontal.depthTest=!1;var p=ShaderLib.ocean_subtransform,f=UniformsUtils.clone(p.uniforms);this.materialOceanVertical=new ShaderMaterial({uniforms:f,vertexShader:u.vertexShader,fragmentShader:p.fragmentShader}),this.materialOceanVertical.uniforms.u_transformSize={value:this.resolution},this.materialOceanVertical.uniforms.u_subtransformSize={value:null},this.materialOceanVertical.uniforms.u_input={value:null},this.materialOceanVertical.depthTest=!1;var d=ShaderLib.ocean_initial_spectrum,m=UniformsUtils.clone(d.uniforms);this.materialInitialSpectrum=new ShaderMaterial({uniforms:m,vertexShader:d.vertexShader,fragmentShader:d.fragmentShader}),this.materialInitialSpectrum.uniforms.u_wind={value:new Vector2},this.materialInitialSpectrum.uniforms.u_resolution={value:this.resolution},this.materialInitialSpectrum.depthTest=!1;var v=ShaderLib.ocean_phase,g=UniformsUtils.clone(v.uniforms);this.materialPhase=new ShaderMaterial({uniforms:g,vertexShader:u.vertexShader,fragmentShader:v.fragmentShader}),this.materialPhase.uniforms.u_resolution={value:this.resolution},this.materialPhase.depthTest=!1;var y=ShaderLib.ocean_spectrum,b=UniformsUtils.clone(y.uniforms);this.materialSpectrum=new ShaderMaterial({uniforms:b,vertexShader:u.vertexShader,fragmentShader:y.fragmentShader}),this.materialSpectrum.uniforms.u_initialSpectrum={value:null},this.materialSpectrum.uniforms.u_resolution={value:this.resolution},this.materialSpectrum.depthTest=!1;var x=ShaderLib.ocean_normals,w=UniformsUtils.clone(x.uniforms);this.materialNormal=new ShaderMaterial({uniforms:w,vertexShader:u.vertexShader,fragmentShader:x.fragmentShader}),this.materialNormal.uniforms.u_displacementMap={value:null},this.materialNormal.uniforms.u_resolution={value:this.resolution},this.materialNormal.depthTest=!1;var S=ShaderLib.ocean_main,M=UniformsUtils.clone(S.uniforms);this.materialOcean=new ShaderMaterial({uniforms:M,vertexShader:S.vertexShader,fragmentShader:S.fragmentShader}),this.materialOcean.uniforms.u_geometrySize={value:this.resolution},this.materialOcean.uniforms.u_displacementMap={value:this.displacementMapFramebuffer.texture},this.materialOcean.uniforms.u_normalMap={value:this.normalMapFramebuffer.texture},this.materialOcean.uniforms.u_oceanColor={value:this.oceanColor},this.materialOcean.uniforms.u_skyColor={value:this.skyColor},this.materialOcean.uniforms.u_sunDirection={value:new Vector3(this.sunDirectionX,this.sunDirectionY,this.sunDirectionZ)},this.materialOcean.uniforms.u_exposure={value:this.exposure},this.materialOceanHorizontal.blending=0,this.materialOceanVertical.blending=0,this.materialInitialSpectrum.blending=0,this.materialPhase.blending=0,this.materialSpectrum.blending=0,this.materialNormal.blending=0,this.materialOcean.blending=0,this.screenQuad=new Mesh(new PlaneBufferGeometry(2,2)),this.scene.add(this.screenQuad),this.generateSeedPhaseTexture(),this.generateMesh()};Ocean.prototype.generateMesh=function(){var e=new PlaneBufferGeometry(this.geometrySize,this.geometrySize,this.geometryResolution,this.geometryResolution);e.rotateX(-Math.PI/2),this.oceanMesh=new Mesh(e,this.materialOcean)},Ocean.prototype.render=function(){var e=this.renderer.getRenderTarget();this.scene.overrideMaterial=null,this.changed&&this.renderInitialSpectrum(),this.renderWavePhase(),this.renderSpectrum(),this.renderSpectrumFFT(),this.renderNormalMap(),this.scene.overrideMaterial=null,this.renderer.setRenderTarget(e)},Ocean.prototype.generateSeedPhaseTexture=function(){this.pingPhase=!0;for(var e=new window.Float32Array(this.resolution*this.resolution*4),t=0;t<this.resolution;t++)for(var r=0;r<this.resolution;r++)e[t*this.resolution*4+4*r]=2*Math.random()*Math.PI,e[t*this.resolution*4+4*r+1]=0,e[t*this.resolution*4+4*r+2]=0,e[t*this.resolution*4+4*r+3]=0;this.pingPhaseTexture=new DataTexture(e,this.resolution,this.resolution,RGBAFormat),this.pingPhaseTexture.wrapS=ClampToEdgeWrapping,this.pingPhaseTexture.wrapT=ClampToEdgeWrapping,this.pingPhaseTexture.type=FloatType,this.pingPhaseTexture.needsUpdate=!0},Ocean.prototype.renderInitialSpectrum=function(){this.scene.overrideMaterial=this.materialInitialSpectrum,this.materialInitialSpectrum.uniforms.u_wind.value.set(this.windX,this.windY),this.materialInitialSpectrum.uniforms.u_size.value=this.size,this.renderer.setRenderTarget(this.initialSpectrumFramebuffer),this.renderer.clear(),this.renderer.render(this.scene,this.oceanCamera)},Ocean.prototype.renderWavePhase=function(){this.scene.overrideMaterial=this.materialPhase,this.screenQuad.material=this.materialPhase,this.initial?(this.materialPhase.uniforms.u_phases.value=this.pingPhaseTexture,this.initial=!1):this.materialPhase.uniforms.u_phases.value=this.pingPhase?this.pingPhaseFramebuffer.texture:this.pongPhaseFramebuffer.texture,this.materialPhase.uniforms.u_deltaTime.value=this.deltaTime,this.materialPhase.uniforms.u_size.value=this.size,this.renderer.setRenderTarget(this.pingPhase?this.pongPhaseFramebuffer:this.pingPhaseFramebuffer),this.renderer.render(this.scene,this.oceanCamera),this.pingPhase=!this.pingPhase},Ocean.prototype.renderSpectrum=function(){this.scene.overrideMaterial=this.materialSpectrum,this.materialSpectrum.uniforms.u_initialSpectrum.value=this.initialSpectrumFramebuffer.texture,this.materialSpectrum.uniforms.u_phases.value=this.pingPhase?this.pingPhaseFramebuffer.texture:this.pongPhaseFramebuffer.texture,this.materialSpectrum.uniforms.u_choppiness.value=this.choppiness,this.materialSpectrum.uniforms.u_size.value=this.size,this.renderer.setRenderTarget(this.spectrumFramebuffer),this.renderer.render(this.scene,this.oceanCamera)},Ocean.prototype.renderSpectrumFFT=function(){var e=Math.log(this.resolution)/Math.log(2);this.scene.overrideMaterial=this.materialOceanHorizontal;for(var t=0;t<e;t++)0===t?(this.materialOceanHorizontal.uniforms.u_input.value=this.spectrumFramebuffer.texture,this.materialOceanHorizontal.uniforms.u_subtransformSize.value=Math.pow(2,t%e+1),this.renderer.setRenderTarget(this.pingTransformFramebuffer),this.renderer.render(this.scene,this.oceanCamera)):t%2===1?(this.materialOceanHorizontal.uniforms.u_input.value=this.pingTransformFramebuffer.texture,this.materialOceanHorizontal.uniforms.u_subtransformSize.value=Math.pow(2,t%e+1),this.renderer.setRenderTarget(this.pongTransformFramebuffer),this.renderer.render(this.scene,this.oceanCamera)):(this.materialOceanHorizontal.uniforms.u_input.value=this.pongTransformFramebuffer.texture,this.materialOceanHorizontal.uniforms.u_subtransformSize.value=Math.pow(2,t%e+1),this.renderer.setRenderTarget(this.pingTransformFramebuffer),this.renderer.render(this.scene,this.oceanCamera));this.scene.overrideMaterial=this.materialOceanVertical;for(t=e;t<2*e;t++)t===2*e-1?(this.materialOceanVertical.uniforms.u_input.value=e%2===0?this.pingTransformFramebuffer.texture:this.pongTransformFramebuffer.texture,this.materialOceanVertical.uniforms.u_subtransformSize.value=Math.pow(2,t%e+1),this.renderer.setRenderTarget(this.displacementMapFramebuffer),this.renderer.render(this.scene,this.oceanCamera)):t%2===1?(this.materialOceanVertical.uniforms.u_input.value=this.pingTransformFramebuffer.texture,this.materialOceanVertical.uniforms.u_subtransformSize.value=Math.pow(2,t%e+1),this.renderer.setRenderTarget(this.pongTransformFramebuffer),this.renderer.render(this.scene,this.oceanCamera)):(this.materialOceanVertical.uniforms.u_input.value=this.pongTransformFramebuffer.texture,this.materialOceanVertical.uniforms.u_subtransformSize.value=Math.pow(2,t%e+1),this.renderer.setRenderTarget(this.pingTransformFramebuffer),this.renderer.render(this.scene,this.oceanCamera))},Ocean.prototype.renderNormalMap=function(){this.scene.overrideMaterial=this.materialNormal,this.changed&&(this.materialNormal.uniforms.u_size.value=this.size),this.materialNormal.uniforms.u_displacementMap.value=this.displacementMapFramebuffer.texture,this.renderer.setRenderTarget(this.normalMapFramebuffer),this.renderer.clear(),this.renderer.render(this.scene,this.oceanCamera)};var PMREMCubeUVPacker=function(){var e=new OrthographicCamera,t=new Scene,r=function(){var e=new ShaderMaterial({uniforms:{faceIndex:{value:0},mapSize:{value:0},envMap:{value:null},testColor:{value:new Vector3(1,1,1)}},vertexShader:"precision highp float;        varying vec2 vUv;        void main() {          vUv = uv;          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );        }",fragmentShader:"precision highp float;        varying vec2 vUv;        uniform samplerCube envMap;        uniform float mapSize;        uniform vec3 testColor;        uniform int faceIndex;                void main() {          vec3 sampleDirection;          vec2 uv = vUv;          uv = uv * 2.0 - 1.0;          uv.y *= -1.0;          if(faceIndex == 0) {            sampleDirection = normalize(vec3(1.0, uv.y, -uv.x));          } else if(faceIndex == 1) {            sampleDirection = normalize(vec3(uv.x, 1.0, uv.y));          } else if(faceIndex == 2) {            sampleDirection = normalize(vec3(uv.x, uv.y, 1.0));          } else if(faceIndex == 3) {            sampleDirection = normalize(vec3(-1.0, uv.y, uv.x));          } else if(faceIndex == 4) {            sampleDirection = normalize(vec3(uv.x, -1.0, -uv.y));          } else {            sampleDirection = normalize(vec3(-uv.x, uv.y, -1.0));          }          vec4 color = envMapTexelToLinear( textureCube( envMap, sampleDirection ) );          gl_FragColor = linearToOutputTexel( color );        }",blending:NoBlending});return e.type="PMREMCubeUVPacker",e}(),n=function(e){this.cubeLods=e;var t=4*e[0].width,n=e[0].texture,i={format:n.format,magFilter:n.magFilter,minFilter:n.minFilter,type:n.type,generateMipmaps:n.generateMipmaps,anisotropy:n.anisotropy,encoding:n.encoding===RGBEEncoding?RGBM16Encoding:n.encoding};i.encoding===RGBM16Encoding&&(i.magFilter=LinearFilter,i.minFilter=LinearFilter),this.CubeUVRenderTarget=new WebGLRenderTarget(t,t,i),this.CubeUVRenderTarget.texture.name="PMREMCubeUVPacker.cubeUv",this.CubeUVRenderTarget.texture.mapping=CubeUVReflectionMapping,this.objects=[];var o=new PlaneBufferGeometry(1,1),a=[];a.push(new Vector2(0,0)),a.push(new Vector2(1,0)),a.push(new Vector2(2,0)),a.push(new Vector2(0,1)),a.push(new Vector2(1,1)),a.push(new Vector2(2,1));var s=t;t=e[0].width;var l=0,u=4;this.numLods=Math.log(e[0].width)/Math.log(2)-2;for(var c=0;c<this.numLods;c++){var h=.5*(s-s/u);t>16&&(u*=2);for(var p=t>16?6:1,f=0,d=0,m=t,v=0;v<p;v++){for(var g=0;g<6;g++){var y=r.clone();y.uniforms.envMap.value=this.cubeLods[c].texture,y.envMap=this.cubeLods[c].texture,y.uniforms.faceIndex.value=g,y.uniforms.mapSize.value=m;var b=new Mesh(o,y);b.position.x=a[g].x*m-h+f,b.position.y=a[g].y*m-h+l+d,b.material.side=BackSide,b.scale.setScalar(m),this.objects.push(b)}d+=1.75*m,f+=1.25*m,m/=2}l+=2*t,t>16&&(t/=2)}};return n.prototype={constructor:n,update:function(r){var n=4*this.cubeLods[0].width;e.left=.5*-n,e.right=.5*n,e.top=.5*-n,e.bottom=.5*n,e.near=0,e.far=1,e.updateProjectionMatrix();for(var i=0;i<this.objects.length;i++)t.add(this.objects[i]);var o=r.gammaInput,a=r.gammaOutput,s=r.toneMapping,l=r.toneMappingExposure,u=r.getRenderTarget();r.gammaInput=!1,r.gammaOutput=!1,r.toneMapping=LinearToneMapping,r.toneMappingExposure=1,r.setRenderTarget(this.CubeUVRenderTarget),r.render(t,e),r.setRenderTarget(u),r.toneMapping=s,r.toneMappingExposure=l,r.gammaInput=o,r.gammaOutput=a;for(i=0;i<this.objects.length;i++)t.remove(this.objects[i])},dispose:function(){for(var e=0,t=this.objects.length;e<t;e++)this.objects[e].material.dispose();this.objects[0].geometry.dispose()}},n}(),PMREMGenerator=function(){var e=function(){var e=new ShaderMaterial({defines:{SAMPLES_PER_LEVEL:20},uniforms:{faceIndex:{value:0},roughness:{value:.5},mapSize:{value:.5},envMap:{value:null},tFlip:{value:-1}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform int faceIndex;\n\t\t\t\tuniform float roughness;\n\t\t\t\tuniform samplerCube envMap;\n\t\t\t\tuniform float mapSize;\n\t\t\t\tuniform float tFlip;\n\t\t\t\t\n\t\t\t\tfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\t\t\t\t\tfloat a = ggxRoughness + 0.0001;\n\t\t\t\t\ta *= a;\n\t\t\t\t\treturn ( 2.0 / a - 2.0 );\n\t\t\t\t}\n\t\t\t\tvec3 ImportanceSamplePhong(vec2 uv, mat3 vecSpace, float specPow) {\n\t\t\t\t\tfloat phi = uv.y * 2.0 * PI;\n\t\t\t\t\tfloat cosTheta = pow(1.0 - uv.x, 1.0 / (specPow + 1.0));\n\t\t\t\t\tfloat sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n\t\t\t\t\tvec3 sampleDir = vec3(cos(phi) * sinTheta, sin(phi) * sinTheta, cosTheta);\n\t\t\t\t\treturn vecSpace * sampleDir;\n\t\t\t\t}\n\t\t\t\tvec3 ImportanceSampleGGX( vec2 uv, mat3 vecSpace, float Roughness )\n\t\t\t\t{\n\t\t\t\t\tfloat a = Roughness * Roughness;\n\t\t\t\t\tfloat Phi = 2.0 * PI * uv.x;\n\t\t\t\t\tfloat CosTheta = sqrt( (1.0 - uv.y) / ( 1.0 + (a*a - 1.0) * uv.y ) );\n\t\t\t\t\tfloat SinTheta = sqrt( 1.0 - CosTheta * CosTheta );\n\t\t\t\t\treturn vecSpace * vec3(SinTheta * cos( Phi ), SinTheta * sin( Phi ), CosTheta);\n\t\t\t\t}\n\t\t\t\tmat3 matrixFromVector(vec3 n) {\n\t\t\t\t\tfloat a = 1.0 / (1.0 + n.z);\n\t\t\t\t\tfloat b = -n.x * n.y * a;\n\t\t\t\t\tvec3 b1 = vec3(1.0 - n.x * n.x * a, b, -n.x);\n\t\t\t\t\tvec3 b2 = vec3(b, 1.0 - n.y * n.y * a, -n.y);\n\t\t\t\t\treturn mat3(b1, b2, n);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvec4 testColorMap(float Roughness) {\n\t\t\t\t\tvec4 color;\n\t\t\t\t\tif(faceIndex == 0)\n\t\t\t\t\t\tcolor = vec4(1.0,0.0,0.0,1.0);\n\t\t\t\t\telse if(faceIndex == 1)\n\t\t\t\t\t\tcolor = vec4(0.0,1.0,0.0,1.0);\n\t\t\t\t\telse if(faceIndex == 2)\n\t\t\t\t\t\tcolor = vec4(0.0,0.0,1.0,1.0);\n\t\t\t\t\telse if(faceIndex == 3)\n\t\t\t\t\t\tcolor = vec4(1.0,1.0,0.0,1.0);\n\t\t\t\t\telse if(faceIndex == 4)\n\t\t\t\t\t\tcolor = vec4(0.0,1.0,1.0,1.0);\n\t\t\t\t\telse\n\t\t\t\t\t\tcolor = vec4(1.0,0.0,1.0,1.0);\n\t\t\t\t\tcolor *= ( 1.0 - Roughness );\n\t\t\t\t\treturn color;\n\t\t\t\t}\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec3 sampleDirection;\n\t\t\t\t\tvec2 uv = vUv*2.0 - 1.0;\n\t\t\t\t\tfloat offset = -1.0/mapSize;\n\t\t\t\t\tconst float a = -1.0;\n\t\t\t\t\tconst float b = 1.0;\n\t\t\t\t\tfloat c = -1.0 + offset;\n\t\t\t\t\tfloat d = 1.0 - offset;\n\t\t\t\t\tfloat bminusa = b - a;\n\t\t\t\t\tuv.x = (uv.x - a)/bminusa * d - (uv.x - b)/bminusa * c;\n\t\t\t\t\tuv.y = (uv.y - a)/bminusa * d - (uv.y - b)/bminusa * c;\n\t\t\t\t\tif (faceIndex==0) {\n\t\t\t\t\t\tsampleDirection = vec3(1.0, -uv.y, -uv.x);\n\t\t\t\t\t} else if (faceIndex==1) {\n\t\t\t\t\t\tsampleDirection = vec3(-1.0, -uv.y, uv.x);\n\t\t\t\t\t} else if (faceIndex==2) {\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, 1.0, uv.y);\n\t\t\t\t\t} else if (faceIndex==3) {\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, -1.0, -uv.y);\n\t\t\t\t\t} else if (faceIndex==4) {\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, -uv.y, 1.0);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsampleDirection = vec3(-uv.x, -uv.y, -1.0);\n\t\t\t\t\t}\n\t\t\t\t\tvec3 correctedDirection = vec3( tFlip * sampleDirection.x, sampleDirection.yz );\n\t\t\t\t\tmat3 vecSpace = matrixFromVector( normalize( correctedDirection ) );\n\t\t\t\t\tvec3 rgbColor = vec3(0.0);\n\t\t\t\t\tconst int NumSamples = SAMPLES_PER_LEVEL;\n\t\t\t\t\tvec3 vect;\n\t\t\t\t\tfloat weight = 0.0;\n\t\t\t\t\tfor( int i = 0; i < NumSamples; i ++ ) {\n\t\t\t\t\t\tfloat sini = sin(float(i));\n\t\t\t\t\t\tfloat cosi = cos(float(i));\n\t\t\t\t\t\tfloat r = rand(vec2(sini, cosi));\n\t\t\t\t\t\tvect = ImportanceSampleGGX(vec2(float(i) / float(NumSamples), r), vecSpace, roughness);\n\t\t\t\t\t\tfloat dotProd = dot(vect, normalize(sampleDirection));\n\t\t\t\t\t\tweight += dotProd;\n\t\t\t\t\t\tvec3 color = envMapTexelToLinear(textureCube(envMap, vect)).rgb;\n\t\t\t\t\t\trgbColor.rgb += color;\n\t\t\t\t\t}\n\t\t\t\t\trgbColor /= float(NumSamples);\n\t\t\t\t\t//rgbColor = testColorMap( roughness ).rgb;\n\t\t\t\t\tgl_FragColor = linearToOutputTexel( vec4( rgbColor, 1.0 ) );\n\t\t\t\t}",blending:NoBlending});return e.type="PMREMGenerator",e}(),t=new OrthographicCamera(-1,1,1,-1,0,1e3),r=new Scene,n=new Mesh(new PlaneBufferGeometry(2,2,0),e);n.material.side=DoubleSide,r.add(n),r.add(t);var i=function(e,t,r){this.sourceTexture=e,this.resolution=void 0!==r?r:256,this.samplesPerLevel=void 0!==t?t:32;var n=this.sourceTexture.encoding===LinearEncoding||this.sourceTexture.encoding===GammaEncoding||this.sourceTexture.encoding===sRGBEncoding;this.sourceTexture.minFilter=n?LinearFilter:NearestFilter,this.sourceTexture.magFilter=n?LinearFilter:NearestFilter,this.sourceTexture.generateMipmaps=this.sourceTexture.generateMipmaps&&n,this.cubeLods=[];var i=this.resolution,o={format:this.sourceTexture.format,magFilter:this.sourceTexture.magFilter,minFilter:this.sourceTexture.minFilter,type:this.sourceTexture.type,generateMipmaps:this.sourceTexture.generateMipmaps,anisotropy:this.sourceTexture.anisotropy,encoding:this.sourceTexture.encoding};this.numLods=Math.log(i)/Math.log(2)-2;for(var a=0;a<this.numLods;a++){var s=new WebGLRenderTargetCube(i,i,o);s.texture.name="PMREMGenerator.cube"+a,this.cubeLods.push(s),i=Math.max(16,i/2)}};return i.prototype={constructor:i,update:function(t){var r=this.sourceTexture.isCubeTexture?-1:1;e.defines.SAMPLES_PER_LEVEL=this.samplesPerLevel,e.uniforms.faceIndex.value=0,e.uniforms.envMap.value=this.sourceTexture,e.envMap=this.sourceTexture,e.needsUpdate=!0;var n=t.gammaInput,i=t.gammaOutput,o=t.toneMapping,a=t.toneMappingExposure,s=t.getRenderTarget();t.toneMapping=LinearToneMapping,t.toneMappingExposure=1,t.gammaInput=!1,t.gammaOutput=!1;for(var l=0;l<this.numLods;l++){var u=l/(this.numLods-1);e.uniforms.roughness.value=.9*u,e.uniforms.tFlip.value=0==l?r:1;var c=this.cubeLods[l].width;e.uniforms.mapSize.value=c,this.renderToCubeMapTarget(t,this.cubeLods[l]),l<5&&(e.uniforms.envMap.value=this.cubeLods[l].texture)}t.setRenderTarget(s),t.toneMapping=o,t.toneMappingExposure=a,t.gammaInput=n,t.gammaOutput=i},renderToCubeMapTarget:function(e,t){for(var r=0;r<6;r++)this.renderToCubeMapTargetFace(e,t,r)},renderToCubeMapTargetFace:function(n,i,o){e.uniforms.faceIndex.value=o,n.setRenderTarget(i,o),n.clear(),n.render(r,t)},dispose:function(){for(var e=0,t=this.cubeLods.length;e<t;e++)this.cubeLods[e].dispose()}},i}(),CopyShader={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = opacity * texel;","}"].join("\n")},LuminosityShader={uniforms:{tDiffuse:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","float l = linearToRelativeLuminance( texel.rgb );","gl_FragColor = vec4( l, l, l, texel.w );","}"].join("\n")},ToneMapShader={uniforms:{tDiffuse:{value:null},averageLuminance:{value:1},luminanceMap:{value:null},maxLuminance:{value:16},minLuminance:{value:.01},middleGrey:{value:.6}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform sampler2D tDiffuse;","varying vec2 vUv;","uniform float middleGrey;","uniform float minLuminance;","uniform float maxLuminance;","#ifdef ADAPTED_LUMINANCE","uniform sampler2D luminanceMap;","#else","uniform float averageLuminance;","#endif","vec3 ToneMap( vec3 vColor ) {","#ifdef ADAPTED_LUMINANCE","float fLumAvg = texture2D(luminanceMap, vec2(0.5, 0.5)).r;","#else","float fLumAvg = averageLuminance;","#endif","float fLumPixel = linearToRelativeLuminance( vColor );","float fLumScaled = (fLumPixel * middleGrey) / max( minLuminance, fLumAvg );","float fLumCompressed = (fLumScaled * (1.0 + (fLumScaled / (maxLuminance * maxLuminance)))) / (1.0 + fLumScaled);","return fLumCompressed * vColor;","}","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = vec4( ToneMap( texel.xyz ), texel.w );","}"].join("\n")},AdaptiveToneMappingPass=function(e,t){Pass.call(this),this.resolution=void 0!==t?t:256,this.needsInit=!0,this.adaptive=void 0===e||!!e,this.luminanceRT=null,this.previousLuminanceRT=null,this.currentLuminanceRT=null,void 0===CopyShader&&console.error("AdaptiveToneMappingPass relies on CopyShader");var r=CopyShader;this.copyUniforms=UniformsUtils.clone(r.uniforms),this.materialCopy=new ShaderMaterial({uniforms:this.copyUniforms,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,blending:NoBlending,depthTest:!1}),void 0===LuminosityShader&&console.error("AdaptiveToneMappingPass relies on LuminosityShader"),this.materialLuminance=new ShaderMaterial({uniforms:UniformsUtils.clone(LuminosityShader.uniforms),vertexShader:LuminosityShader.vertexShader,fragmentShader:LuminosityShader.fragmentShader,blending:NoBlending}),this.adaptLuminanceShader={defines:{MIP_LEVEL_1X1:(Math.log(this.resolution)/Math.log(2)).toFixed(1)},uniforms:{lastLum:{value:null},currentLum:{value:null},minLuminance:{value:.01},delta:{value:.016},tau:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","uniform sampler2D lastLum;","uniform sampler2D currentLum;","uniform float minLuminance;","uniform float delta;","uniform float tau;","void main() {","\tvec4 lastLum = texture2D( lastLum, vUv, MIP_LEVEL_1X1 );","\tvec4 currentLum = texture2D( currentLum, vUv, MIP_LEVEL_1X1 );","\tfloat fLastLum = max( minLuminance, lastLum.r );","\tfloat fCurrentLum = max( minLuminance, currentLum.r );","\tfCurrentLum *= fCurrentLum;","\tfloat fAdaptedLum = fLastLum + (fCurrentLum - fLastLum) * (1.0 - exp(-delta * tau));","\tgl_FragColor.r = fAdaptedLum;","}"].join("\n")},this.materialAdaptiveLum=new ShaderMaterial({uniforms:UniformsUtils.clone(this.adaptLuminanceShader.uniforms),vertexShader:this.adaptLuminanceShader.vertexShader,fragmentShader:this.adaptLuminanceShader.fragmentShader,defines:Object.assign({},this.adaptLuminanceShader.defines),blending:NoBlending}),void 0===ToneMapShader&&console.error("AdaptiveToneMappingPass relies on ToneMapShader"),this.materialToneMap=new ShaderMaterial({uniforms:UniformsUtils.clone(ToneMapShader.uniforms),vertexShader:ToneMapShader.vertexShader,fragmentShader:ToneMapShader.fragmentShader,blending:NoBlending}),this.camera=new OrthographicCamera(-1,1,1,-1,0,1),this.scene=new Scene,this.quad=new Mesh(new PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};AdaptiveToneMappingPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:AdaptiveToneMappingPass,render:function(e,t,r,n,i){this.needsInit&&(this.reset(e),this.luminanceRT.texture.type=r.texture.type,this.previousLuminanceRT.texture.type=r.texture.type,this.currentLuminanceRT.texture.type=r.texture.type,this.needsInit=!1),this.adaptive&&(this.quad.material=this.materialLuminance,this.materialLuminance.uniforms.tDiffuse.value=r.texture,e.setRenderTarget(this.currentLuminanceRT),e.render(this.scene,this.camera),this.quad.material=this.materialAdaptiveLum,this.materialAdaptiveLum.uniforms.delta.value=n,this.materialAdaptiveLum.uniforms.lastLum.value=this.previousLuminanceRT.texture,this.materialAdaptiveLum.uniforms.currentLum.value=this.currentLuminanceRT.texture,e.setRenderTarget(this.luminanceRT),e.render(this.scene,this.camera),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.luminanceRT.texture,e.setRenderTarget(this.previousLuminanceRT),e.render(this.scene,this.camera)),this.quad.material=this.materialToneMap,this.materialToneMap.uniforms.tDiffuse.value=r.texture,this.renderToScreen?(e.setRenderTarget(null),e.render(this.scene,this.camera)):(e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera))},reset:function(e){this.luminanceRT&&this.luminanceRT.dispose(),this.currentLuminanceRT&&this.currentLuminanceRT.dispose(),this.previousLuminanceRT&&this.previousLuminanceRT.dispose();var t={minFilter:LinearFilter,magFilter:LinearFilter,format:RGBAFormat};this.luminanceRT=new WebGLRenderTarget(this.resolution,this.resolution,t),this.luminanceRT.texture.name="AdaptiveToneMappingPass.l",this.luminanceRT.texture.generateMipmaps=!1,this.previousLuminanceRT=new WebGLRenderTarget(this.resolution,this.resolution,t),this.previousLuminanceRT.texture.name="AdaptiveToneMappingPass.pl",this.previousLuminanceRT.texture.generateMipmaps=!1,t.minFilter=LinearMipMapLinearFilter,t.generateMipmaps=!0,this.currentLuminanceRT=new WebGLRenderTarget(this.resolution,this.resolution,t),this.currentLuminanceRT.texture.name="AdaptiveToneMappingPass.cl",this.adaptive&&(this.materialToneMap.defines.ADAPTED_LUMINANCE="",this.materialToneMap.uniforms.luminanceMap.value=this.luminanceRT.texture),this.quad.material=new MeshBasicMaterial({color:7829367}),this.materialLuminance.needsUpdate=!0,this.materialAdaptiveLum.needsUpdate=!0,this.materialToneMap.needsUpdate=!0},setAdaptive:function(e){e?(this.adaptive=!0,this.materialToneMap.defines.ADAPTED_LUMINANCE="",this.materialToneMap.uniforms.luminanceMap.value=this.luminanceRT.texture):(this.adaptive=!1,delete this.materialToneMap.defines.ADAPTED_LUMINANCE,this.materialToneMap.uniforms.luminanceMap.value=null),this.materialToneMap.needsUpdate=!0},setAdaptionRate:function(e){e&&(this.materialAdaptiveLum.uniforms.tau.value=Math.abs(e))},setMinLuminance:function(e){e&&(this.materialToneMap.uniforms.minLuminance.value=e,this.materialAdaptiveLum.uniforms.minLuminance.value=e)},setMaxLuminance:function(e){e&&(this.materialToneMap.uniforms.maxLuminance.value=e)},setAverageLuminance:function(e){e&&(this.materialToneMap.uniforms.averageLuminance.value=e)},setMiddleGrey:function(e){e&&(this.materialToneMap.uniforms.middleGrey.value=e)},dispose:function(){this.luminanceRT&&this.luminanceRT.dispose(),this.previousLuminanceRT&&this.previousLuminanceRT.dispose(),this.currentLuminanceRT&&this.currentLuminanceRT.dispose(),this.materialLuminance&&this.materialLuminance.dispose(),this.materialAdaptiveLum&&this.materialAdaptiveLum.dispose(),this.materialCopy&&this.materialCopy.dispose(),this.materialToneMap&&this.materialToneMap.dispose()}});var AfterimageShader={uniforms:{damp:{value:.96},tOld:{value:null},tNew:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float damp;","uniform sampler2D tOld;","uniform sampler2D tNew;","varying vec2 vUv;","vec4 when_gt( vec4 x, float y ) {","return max( sign( x - y ), 0.0 );","}","void main() {","vec4 texelOld = texture2D( tOld, vUv );","vec4 texelNew = texture2D( tNew, vUv );","texelOld *= damp * when_gt( texelOld, 0.1 );","gl_FragColor = max(texelNew, texelOld);","}"].join("\n")},AfterimagePass=function(e){Pass.call(this),void 0===AfterimageShader&&console.error("AfterimagePass relies on AfterimageShader"),this.shader=AfterimageShader,this.uniforms=UniformsUtils.clone(this.shader.uniforms),this.uniforms.damp.value=void 0!==e?e:.96,this.textureComp=new WebGLRenderTarget(window.innerWidth,window.innerHeight,{minFilter:LinearFilter,magFilter:NearestFilter,format:RGBAFormat}),this.textureOld=new WebGLRenderTarget(window.innerWidth,window.innerHeight,{minFilter:LinearFilter,magFilter:NearestFilter,format:RGBAFormat}),this.shaderMaterial=new ShaderMaterial({uniforms:this.uniforms,vertexShader:this.shader.vertexShader,fragmentShader:this.shader.fragmentShader}),this.sceneComp=new Scene,this.scene=new Scene,this.camera=new OrthographicCamera(-1,1,1,-1,0,1),this.camera.position.z=1;var t=new PlaneBufferGeometry(2,2);this.quadComp=new Mesh(t,this.shaderMaterial),this.sceneComp.add(this.quadComp);var r=new Mesh(t,new MeshBasicMaterial({map:this.textureComp.texture}));this.scene.add(r)};AfterimagePass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:AfterimagePass,render:function(e,t,r){this.uniforms.tOld.value=this.textureOld.texture,this.uniforms.tNew.value=r.texture,this.quadComp.material=this.shaderMaterial,e.setRenderTarget(this.textureComp),e.render(this.sceneComp,this.camera),e.setRenderTarget(this.textureOld),e.render(this.scene,this.camera),this.renderToScreen?(e.setRenderTarget(null),e.render(this.scene,this.camera)):(e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera))}});var ConvolutionShader={defines:{KERNEL_SIZE_FLOAT:"25.0",KERNEL_SIZE_INT:"25"},uniforms:{tDiffuse:{value:null},uImageIncrement:{value:new Vector2(.001953125,0)},cKernel:{value:[]}},vertexShader:["uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","vUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float cKernel[ KERNEL_SIZE_INT ];","uniform sampler2D tDiffuse;","uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","vec2 imageCoord = vUv;","vec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );","for( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {","sum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];","imageCoord += uImageIncrement;","}","gl_FragColor = sum;","}"].join("\n"),buildKernel:function(e){function t(e,t){return Math.exp(-e*e/(2*t*t))}var r,n,i,o,a=2*Math.ceil(3*e)+1;for(a>25&&(a=25),o=.5*(a-1),n=new Array(a),i=0,r=0;r<a;++r)n[r]=t(r-o,e),i+=n[r];for(r=0;r<a;++r)n[r]/=i;return n}},BloomPass=function e(t,r,n,i){Pass.call(this),t=void 0!==t?t:1,r=void 0!==r?r:25,n=void 0!==n?n:4,i=void 0!==i?i:256;var o={minFilter:LinearFilter,magFilter:LinearFilter,format:RGBAFormat};this.renderTargetX=new WebGLRenderTarget(i,i,o),this.renderTargetX.texture.name="BloomPass.x",this.renderTargetY=new WebGLRenderTarget(i,i,o),this.renderTargetY.texture.name="BloomPass.y",void 0===CopyShader&&console.error("BloomPass relies on CopyShader");var a=CopyShader;this.copyUniforms=UniformsUtils.clone(a.uniforms),this.copyUniforms.opacity.value=t,this.materialCopy=new ShaderMaterial({uniforms:this.copyUniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,blending:AdditiveBlending,transparent:!0}),void 0===ConvolutionShader&&console.error("BloomPass relies on ConvolutionShader");var s=ConvolutionShader;this.convolutionUniforms=UniformsUtils.clone(s.uniforms),this.convolutionUniforms.uImageIncrement.value=e.blurX,this.convolutionUniforms.cKernel.value=ConvolutionShader.buildKernel(n),this.materialConvolution=new ShaderMaterial({uniforms:this.convolutionUniforms,vertexShader:s.vertexShader,fragmentShader:s.fragmentShader,defines:{KERNEL_SIZE_FLOAT:r.toFixed(1),KERNEL_SIZE_INT:r.toFixed(0)}}),this.needsSwap=!1,this.camera=new OrthographicCamera(-1,1,1,-1,0,1),this.scene=new Scene,this.quad=new Mesh(new PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};BloomPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:BloomPass,render:function(e,t,r,n,i){i&&e.context.disable(e.context.STENCIL_TEST),this.quad.material=this.materialConvolution,this.convolutionUniforms.tDiffuse.value=r.texture,this.convolutionUniforms.uImageIncrement.value=BloomPass.blurX,e.setRenderTarget(this.renderTargetX),e.clear(),e.render(this.scene,this.camera),this.convolutionUniforms.tDiffuse.value=this.renderTargetX.texture,this.convolutionUniforms.uImageIncrement.value=BloomPass.blurY,e.setRenderTarget(this.renderTargetY),e.clear(),e.render(this.scene,this.camera),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetY.texture,i&&e.context.enable(e.context.STENCIL_TEST),e.setRenderTarget(r),this.clear&&e.clear(),e.render(this.scene,this.camera)}}),BloomPass.blurX=new Vector2(.001953125,0),BloomPass.blurY=new Vector2(0,.001953125);var BokehPass=function(e,t,r){Pass.call(this),this.scene=e,this.camera=t;var n=void 0!==r.focus?r.focus:1,i=void 0!==r.aspect?r.aspect:t.aspect,o=void 0!==r.aperture?r.aperture:.025,a=void 0!==r.maxblur?r.maxblur:1,s=r.width||window.innerWidth||1,l=r.height||window.innerHeight||1;this.renderTargetColor=new WebGLRenderTarget(s,l,{minFilter:LinearFilter,magFilter:LinearFilter,format:RGBFormat}),this.renderTargetColor.texture.name="BokehPass.color",this.renderTargetDepth=this.renderTargetColor.clone(),this.renderTargetDepth.texture.name="BokehPass.depth",this.materialDepth=new MeshDepthMaterial,this.materialDepth.depthPacking=RGBADepthPacking,this.materialDepth.blending=NoBlending,void 0===BokehShader&&console.error("BokehPass relies on BokehShader");var u=BokehShader,c=UniformsUtils.clone(u.uniforms);c.tDepth.value=this.renderTargetDepth.texture,c.focus.value=n,c.aspect.value=i,c.aperture.value=o,c.maxblur.value=a,c.nearClip.value=t.near,c.farClip.value=t.far,this.materialBokeh=new ShaderMaterial({defines:Object.assign({},u.defines),uniforms:c,vertexShader:u.vertexShader,fragmentShader:u.fragmentShader}),this.uniforms=c,this.needsSwap=!1,this.camera2=new OrthographicCamera(-1,1,1,-1,0,1),this.scene2=new Scene,this.quad2=new Mesh(new PlaneBufferGeometry(2,2),null),this.quad2.frustumCulled=!1,this.scene2.add(this.quad2),this.oldClearColor=new Color,this.oldClearAlpha=1};BokehPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:BokehPass,render:function(e,t,r,n,i){this.quad2.material=this.materialBokeh,this.scene.overrideMaterial=this.materialDepth,this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha();e.autoClear;e.autoClear=!1,e.setClearColor(16777215),e.setClearAlpha(1),e.setRenderTarget(this.renderTargetDepth),e.clear(),e.render(this.scene,this.camera),this.uniforms.tColor.value=r.texture,this.uniforms.nearClip.value=this.camera.near,this.uniforms.farClip.value=this.camera.far,this.renderToScreen?(e.setRenderTarget(null),e.render(this.scene2,this.camera2)):(e.setRenderTarget(t),e.clear(),e.render(this.scene2,this.camera2)),this.scene.overrideMaterial=null,e.setClearColor(this.oldClearColor),e.setClearAlpha(this.oldClearAlpha),e.autoClear=this.oldAutoClear}});var ClearPass=function(e,t){Pass.call(this),this.needsSwap=!1,this.clearColor=void 0!==e?e:0,this.clearAlpha=void 0!==t?t:0};ClearPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:ClearPass,render:function(e,t,r,n,i){var o,a;this.clearColor&&(o=e.getClearColor().getHex(),a=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),e.setRenderTarget(this.renderToScreen?null:r),e.clear(),this.clearColor&&e.setClearColor(o,a)}});var CubeTexturePass=function(e,t,r){Pass.call(this),this.camera=e,this.needsSwap=!1,this.cubeShader=ShaderLib.cube,this.cubeMesh=new Mesh(new BoxBufferGeometry(10,10,10),new ShaderMaterial({uniforms:this.cubeShader.uniforms,vertexShader:this.cubeShader.vertexShader,fragmentShader:this.cubeShader.fragmentShader,depthTest:!1,depthWrite:!1,side:BackSide})),this.envMap=t,this.opacity=void 0!==r?r:1,this.cubeScene=new Scene,this.cubeCamera=new PerspectiveCamera,this.cubeScene.add(this.cubeMesh)};CubeTexturePass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:CubeTexturePass,render:function(e,t,r,n,i){var o=e.autoClear;e.autoClear=!1,this.cubeCamera.projectionMatrix.copy(this.camera.projectionMatrix),this.cubeCamera.quaternion.setFromRotationMatrix(this.camera.matrixWorld),this.cubeMesh.material.uniforms.tCube.value=this.envMap,this.cubeMesh.material.uniforms.opacity.value=this.opacity,this.cubeMesh.material.transparent=this.opacity<1,e.setRenderTarget(this.renderToScreen?null:r),this.clear&&e.clear(),e.render(this.cubeScene,this.cubeCamera),e.autoClear=o}});var DotScreenShader={uniforms:{tDiffuse:{value:null},tSize:{value:new Vector2(256,256)},center:{value:new Vector2(.5,.5)},angle:{value:1.57},scale:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec2 center;","uniform float angle;","uniform float scale;","uniform vec2 tSize;","uniform sampler2D tDiffuse;","varying vec2 vUv;","float pattern() {","float s = sin( angle ), c = cos( angle );","vec2 tex = vUv * tSize - center;","vec2 point = vec2( c * tex.x - s * tex.y, s * tex.x + c * tex.y ) * scale;","return ( sin( point.x ) * sin( point.y ) ) * 4.0;","}","void main() {","vec4 color = texture2D( tDiffuse, vUv );","float average = ( color.r + color.g + color.b ) / 3.0;","gl_FragColor = vec4( vec3( average * 10.0 - 5.0 + pattern() ), color.a );","}"].join("\n")},DotScreenPass=function(e,t,r){Pass.call(this),void 0===DotScreenShader&&console.error("DotScreenPass relies on DotScreenShader");var n=DotScreenShader;this.uniforms=UniformsUtils.clone(n.uniforms),void 0!==e&&this.uniforms.center.value.copy(e),void 0!==t&&(this.uniforms.angle.value=t),void 0!==r&&(this.uniforms.scale.value=r),this.material=new ShaderMaterial({uniforms:this.uniforms,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader}),this.camera=new OrthographicCamera(-1,1,1,-1,0,1),this.scene=new Scene,this.quad=new Mesh(new PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};DotScreenPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:DotScreenPass,render:function(e,t,r,n,i){this.uniforms.tDiffuse.value=r.texture,this.uniforms.tSize.value.set(r.width,r.height),this.quad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),e.render(this.scene,this.camera)):(e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera))}});var MaskPass=function(e,t){Pass.call(this),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1};MaskPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:MaskPass,render:function(e,t,r,n,i){var o,a,s=e.context,l=e.state;l.buffers.color.setMask(!1),l.buffers.depth.setMask(!1),l.buffers.color.setLocked(!0),l.buffers.depth.setLocked(!0),this.inverse?(o=0,a=1):(o=1,a=0),l.buffers.stencil.setTest(!0),l.buffers.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),l.buffers.stencil.setFunc(s.ALWAYS,o,4294967295),l.buffers.stencil.setClear(a),e.setRenderTarget(r),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),l.buffers.color.setLocked(!1),l.buffers.depth.setLocked(!1),l.buffers.stencil.setFunc(s.EQUAL,1,4294967295),l.buffers.stencil.setOp(s.KEEP,s.KEEP,s.KEEP)}});var ClearMaskPass=function(){Pass.call(this),this.needsSwap=!1};ClearMaskPass.prototype=Object.create(Pass.prototype),Object.assign(ClearMaskPass.prototype,{render:function(e,t,r,n,i){e.state.buffers.stencil.setTest(!1)}});var EffectComposer=function(e,t){if(this.renderer=e,void 0===t){var r={minFilter:LinearFilter,magFilter:LinearFilter,format:RGBAFormat,stencilBuffer:!1},n=e.getDrawingBufferSize(new Vector2);(t=new WebGLRenderTarget(n.width,n.height,r)).texture.name="EffectComposer.rt1"}this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.passes=[],void 0===CopyShader&&console.error("EffectComposer relies on CopyShader"),void 0===ShaderPass&&console.error("EffectComposer relies on ShaderPass"),this.copyPass=new ShaderPass(CopyShader),this._previousFrameTime=Date.now()};Object.assign(EffectComposer.prototype,{swapBuffers:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e},addPass:function(e){this.passes.push(e);var t=this.renderer.getDrawingBufferSize(new Vector2);e.setSize(t.width,t.height)},insertPass:function(e,t){this.passes.splice(t,0,e)},render:function(e){void 0===e&&(e=.001*(Date.now()-this._previousFrameTime)),this._previousFrameTime=Date.now();var t,r,n=this.renderer.getRenderTarget(),i=!1,o=this.passes.length;for(r=0;r<o;r++)if(!1!==(t=this.passes[r]).enabled){if(t.render(this.renderer,this.writeBuffer,this.readBuffer,e,i),t.needsSwap){if(i){var a=this.renderer.context;a.stencilFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),a.stencilFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==MaskPass&&(t instanceof MaskPass?i=!0:t instanceof ClearMaskPass&&(i=!1))}this.renderer.setRenderTarget(n)},reset:function(e){if(void 0===e){var t=this.renderer.getDrawingBufferSize(new Vector2);(e=this.renderTarget1.clone()).setSize(t.width,t.height)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(e,t){this.renderTarget1.setSize(e,t),this.renderTarget2.setSize(e,t);for(var r=0;r<this.passes.length;r++)this.passes[r].setSize(e,t)}});var FilmShader={uniforms:{tDiffuse:{value:null},time:{value:0},nIntensity:{value:.5},sIntensity:{value:.05},sCount:{value:4096},grayscale:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform float time;","uniform bool grayscale;","uniform float nIntensity;","uniform float sIntensity;","uniform float sCount;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 cTextureScreen = texture2D( tDiffuse, vUv );","float dx = rand( vUv + time );","vec3 cResult = cTextureScreen.rgb + cTextureScreen.rgb * clamp( 0.1 + dx, 0.0, 1.0 );","vec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );","cResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;","cResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );","if( grayscale ) {","cResult = vec3( cResult.r * 0.3 + cResult.g * 0.59 + cResult.b * 0.11 );","}","gl_FragColor =  vec4( cResult, cTextureScreen.a );","}"].join("\n")},FilmPass=function(e,t,r,n){Pass.call(this),void 0===FilmShader&&console.error("FilmPass relies on FilmShader");var i=FilmShader;this.uniforms=UniformsUtils.clone(i.uniforms),this.material=new ShaderMaterial({uniforms:this.uniforms,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader}),void 0!==n&&(this.uniforms.grayscale.value=n),void 0!==e&&(this.uniforms.nIntensity.value=e),void 0!==t&&(this.uniforms.sIntensity.value=t),void 0!==r&&(this.uniforms.sCount.value=r),this.camera=new OrthographicCamera(-1,1,1,-1,0,1),this.scene=new Scene,this.quad=new Mesh(new PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};FilmPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:FilmPass,render:function(e,t,r,n,i){this.uniforms.tDiffuse.value=r.texture,this.uniforms.time.value+=n,this.quad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),e.render(this.scene,this.camera)):(e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera))}});var DigitalGlitch={uniforms:{tDiffuse:{value:null},tDisp:{value:null},byp:{value:0},amount:{value:.08},angle:{value:.02},seed:{value:.02},seed_x:{value:.02},seed_y:{value:.02},distortion_x:{value:.5},distortion_y:{value:.6},col_s:{value:.05}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform int byp;","uniform sampler2D tDiffuse;","uniform sampler2D tDisp;","uniform float amount;","uniform float angle;","uniform float seed;","uniform float seed_x;","uniform float seed_y;","uniform float distortion_x;","uniform float distortion_y;","uniform float col_s;","varying vec2 vUv;","float rand(vec2 co){","return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);","}","void main() {","if(byp<1) {","vec2 p = vUv;","float xs = floor(gl_FragCoord.x / 0.5);","float ys = floor(gl_FragCoord.y / 0.5);","vec4 normal = texture2D (tDisp, p*seed*seed);","if(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {","if(seed_x>0.){","p.y = 1. - (p.y + distortion_y);","}","else {","p.y = distortion_y;","}","}","if(p.x<distortion_y+col_s && p.x>distortion_y-col_s*seed) {","if(seed_y>0.){","p.x=distortion_x;","}","else {","p.x = 1. - (p.x + distortion_x);","}","}","p.x+=normal.x*seed_x*(seed/5.);","p.y+=normal.y*seed_y*(seed/5.);","vec2 offset = amount * vec2( cos(angle), sin(angle));","vec4 cr = texture2D(tDiffuse, p + offset);","vec4 cga = texture2D(tDiffuse, p);","vec4 cb = texture2D(tDiffuse, p - offset);","gl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);","vec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.2);","gl_FragColor = gl_FragColor+ snow;","}","else {","gl_FragColor=texture2D (tDiffuse, vUv);","}","}"].join("\n")},GlitchPass=function(e){Pass.call(this),void 0===DigitalGlitch&&console.error("GlitchPass relies on DigitalGlitch");var t=DigitalGlitch;this.uniforms=UniformsUtils.clone(t.uniforms),void 0==e&&(e=64),this.uniforms.tDisp.value=this.generateHeightmap(e),this.material=new ShaderMaterial({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.camera=new OrthographicCamera(-1,1,1,-1,0,1),this.scene=new Scene,this.quad=new Mesh(new PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad),this.goWild=!1,this.curF=0,this.generateTrigger()};GlitchPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:GlitchPass,render:function(e,t,r,n,i){this.uniforms.tDiffuse.value=r.texture,this.uniforms.seed.value=Math.random(),this.uniforms.byp.value=0,this.curF%this.randX==0||1==this.goWild?(this.uniforms.amount.value=Math.random()/30,this.uniforms.angle.value=_Math.randFloat(-Math.PI,Math.PI),this.uniforms.seed_x.value=_Math.randFloat(-1,1),this.uniforms.seed_y.value=_Math.randFloat(-1,1),this.uniforms.distortion_x.value=_Math.randFloat(0,1),this.uniforms.distortion_y.value=_Math.randFloat(0,1),this.curF=0,this.generateTrigger()):this.curF%this.randX<this.randX/5?(this.uniforms.amount.value=Math.random()/90,this.uniforms.angle.value=_Math.randFloat(-Math.PI,Math.PI),this.uniforms.distortion_x.value=_Math.randFloat(0,1),this.uniforms.distortion_y.value=_Math.randFloat(0,1),this.uniforms.seed_x.value=_Math.randFloat(-.3,.3),this.uniforms.seed_y.value=_Math.randFloat(-.3,.3)):0==this.goWild&&(this.uniforms.byp.value=1),this.curF++,this.quad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),e.render(this.scene,this.camera)):(e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera))},generateTrigger:function(){this.randX=_Math.randInt(120,240)},generateHeightmap:function(e){for(var t=new Float32Array(e*e*3),r=e*e,n=0;n<r;n++){var i=_Math.randFloat(0,1);t[3*n+0]=i,t[3*n+1]=i,t[3*n+2]=i}var o=new DataTexture(t,e,e,RGBFormat,FloatType);return o.needsUpdate=!0,o}});var HalftoneShader={uniforms:{tDiffuse:{value:null},shape:{value:1},radius:{value:4},rotateR:{value:Math.PI/12*1},rotateG:{value:Math.PI/12*2},rotateB:{value:Math.PI/12*3},scatter:{value:0},width:{value:1},height:{value:1},blending:{value:1},blendingMode:{value:1},greyscale:{value:!1},disable:{value:!1}},vertexShader:["varying vec2 vUV;","void main() {","vUV = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join("\n"),fragmentShader:["#define SQRT2_MINUS_ONE 0.41421356","#define SQRT2_HALF_MINUS_ONE 0.20710678","#define PI2 6.28318531","#define SHAPE_DOT 1","#define SHAPE_ELLIPSE 2","#define SHAPE_LINE 3","#define SHAPE_SQUARE 4","#define BLENDING_LINEAR 1","#define BLENDING_MULTIPLY 2","#define BLENDING_ADD 3","#define BLENDING_LIGHTER 4","#define BLENDING_DARKER 5","uniform sampler2D tDiffuse;","uniform float radius;","uniform float rotateR;","uniform float rotateG;","uniform float rotateB;","uniform float scatter;","uniform float width;","uniform float height;","uniform int shape;","uniform bool disable;","uniform float blending;","uniform int blendingMode;","varying vec2 vUV;","uniform bool greyscale;","const int samples = 8;","float blend( float a, float b, float t ) {","return a * ( 1.0 - t ) + b * t;","}","float hypot( float x, float y ) {","return sqrt( x * x + y * y );","}","float rand( vec2 seed ){","return fract( sin( dot( seed.xy, vec2( 12.9898, 78.233 ) ) ) * 43758.5453 );","}","float distanceToDotRadius( float channel, vec2 coord, vec2 normal, vec2 p, float angle, float rad_max ) {","float dist = hypot( coord.x - p.x, coord.y - p.y );","float rad = channel;","if ( shape == SHAPE_DOT ) {","rad = pow( abs( rad ), 1.125 ) * rad_max;","} else if ( shape == SHAPE_ELLIPSE ) {","rad = pow( abs( rad ), 1.125 ) * rad_max;","if ( dist != 0.0 ) {","float dot_p = abs( ( p.x - coord.x ) / dist * normal.x + ( p.y - coord.y ) / dist * normal.y );","dist = ( dist * ( 1.0 - SQRT2_HALF_MINUS_ONE ) ) + dot_p * dist * SQRT2_MINUS_ONE;","}","} else if ( shape == SHAPE_LINE ) {","rad = pow( abs( rad ), 1.5) * rad_max;","float dot_p = ( p.x - coord.x ) * normal.x + ( p.y - coord.y ) * normal.y;","dist = hypot( normal.x * dot_p, normal.y * dot_p );","} else if ( shape == SHAPE_SQUARE ) {","float theta = atan( p.y - coord.y, p.x - coord.x ) - angle;","float sin_t = abs( sin( theta ) );","float cos_t = abs( cos( theta ) );","rad = pow( abs( rad ), 1.4 );","rad = rad_max * ( rad + ( ( sin_t > cos_t ) ? rad - sin_t * rad : rad - cos_t * rad ) );","}","return rad - dist;","}","struct Cell {","vec2 normal;","vec2 p1;","vec2 p2;","vec2 p3;","vec2 p4;","float samp2;","float samp1;","float samp3;","float samp4;","};","vec4 getSample( vec2 point ) {","vec4 tex = texture2D( tDiffuse, vec2( point.x / width, point.y / height ) );","float base = rand( vec2( floor( point.x ), floor( point.y ) ) ) * PI2;","float step = PI2 / float( samples );","float dist = radius * 0.66;","for ( int i = 0; i < samples; ++i ) {","float r = base + step * float( i );","vec2 coord = point + vec2( cos( r ) * dist, sin( r ) * dist );","tex += texture2D( tDiffuse, vec2( coord.x / width, coord.y / height ) );","}","tex /= float( samples ) + 1.0;","return tex;","}","float getDotColour( Cell c, vec2 p, int channel, float angle, float aa ) {","float dist_c_1, dist_c_2, dist_c_3, dist_c_4, res;","if ( channel == 0 ) {","c.samp1 = getSample( c.p1 ).r;","c.samp2 = getSample( c.p2 ).r;","c.samp3 = getSample( c.p3 ).r;","c.samp4 = getSample( c.p4 ).r;","} else if (channel == 1) {","c.samp1 = getSample( c.p1 ).g;","c.samp2 = getSample( c.p2 ).g;","c.samp3 = getSample( c.p3 ).g;","c.samp4 = getSample( c.p4 ).g;","} else {","c.samp1 = getSample( c.p1 ).b;","c.samp3 = getSample( c.p3 ).b;","c.samp2 = getSample( c.p2 ).b;","c.samp4 = getSample( c.p4 ).b;","}","dist_c_1 = distanceToDotRadius( c.samp1, c.p1, c.normal, p, angle, radius );","dist_c_2 = distanceToDotRadius( c.samp2, c.p2, c.normal, p, angle, radius );","dist_c_3 = distanceToDotRadius( c.samp3, c.p3, c.normal, p, angle, radius );","dist_c_4 = distanceToDotRadius( c.samp4, c.p4, c.normal, p, angle, radius );","res = ( dist_c_1 > 0.0 ) ? clamp( dist_c_1 / aa, 0.0, 1.0 ) : 0.0;","res += ( dist_c_2 > 0.0 ) ? clamp( dist_c_2 / aa, 0.0, 1.0 ) : 0.0;","res += ( dist_c_3 > 0.0 ) ? clamp( dist_c_3 / aa, 0.0, 1.0 ) : 0.0;","res += ( dist_c_4 > 0.0 ) ? clamp( dist_c_4 / aa, 0.0, 1.0 ) : 0.0;","res = clamp( res, 0.0, 1.0 );","return res;","}","Cell getReferenceCell( vec2 p, vec2 origin, float grid_angle, float step ) {","Cell c;","vec2 n = vec2( cos( grid_angle ), sin( grid_angle ) );","float threshold = step * 0.5;","float dot_normal = n.x * ( p.x - origin.x ) + n.y * ( p.y - origin.y );","float dot_line = -n.y * ( p.x - origin.x ) + n.x * ( p.y - origin.y );","vec2 offset = vec2( n.x * dot_normal, n.y * dot_normal );","float offset_normal = mod( hypot( offset.x, offset.y ), step );","float normal_dir = ( dot_normal < 0.0 ) ? 1.0 : -1.0;","float normal_scale = ( ( offset_normal < threshold ) ? -offset_normal : step - offset_normal ) * normal_dir;","float offset_line = mod( hypot( ( p.x - offset.x ) - origin.x, ( p.y - offset.y ) - origin.y ), step );","float line_dir = ( dot_line < 0.0 ) ? 1.0 : -1.0;","float line_scale = ( ( offset_line < threshold ) ? -offset_line : step - offset_line ) * line_dir;","c.normal = n;","c.p1.x = p.x - n.x * normal_scale + n.y * line_scale;","c.p1.y = p.y - n.y * normal_scale - n.x * line_scale;","if ( scatter != 0.0 ) {","float off_mag = scatter * threshold * 0.5;","float off_angle = rand( vec2( floor( c.p1.x ), floor( c.p1.y ) ) ) * PI2;","c.p1.x += cos( off_angle ) * off_mag;","c.p1.y += sin( off_angle ) * off_mag;","}","float normal_step = normal_dir * ( ( offset_normal < threshold ) ? step : -step );","float line_step = line_dir * ( ( offset_line < threshold ) ? step : -step );","c.p2.x = c.p1.x - n.x * normal_step;","c.p2.y = c.p1.y - n.y * normal_step;","c.p3.x = c.p1.x + n.y * line_step;","c.p3.y = c.p1.y - n.x * line_step;","c.p4.x = c.p1.x - n.x * normal_step + n.y * line_step;","c.p4.y = c.p1.y - n.y * normal_step - n.x * line_step;","return c;","}","float blendColour( float a, float b, float t ) {","if ( blendingMode == BLENDING_LINEAR ) {","return blend( a, b, 1.0 - t );","} else if ( blendingMode == BLENDING_ADD ) {","return blend( a, min( 1.0, a + b ), t );","} else if ( blendingMode == BLENDING_MULTIPLY ) {","return blend( a, max( 0.0, a * b ), t );","} else if ( blendingMode == BLENDING_LIGHTER ) {","return blend( a, max( a, b ), t );","} else if ( blendingMode == BLENDING_DARKER ) {","return blend( a, min( a, b ), t );","} else {","return blend( a, b, 1.0 - t );","}","}","void main() {","if ( ! disable ) {","vec2 p = vec2( vUV.x * width, vUV.y * height );","vec2 origin = vec2( 0, 0 );","float aa = ( radius < 2.5 ) ? radius * 0.5 : 1.25;","Cell cell_r = getReferenceCell( p, origin, rotateR, radius );","Cell cell_g = getReferenceCell( p, origin, rotateG, radius );","Cell cell_b = getReferenceCell( p, origin, rotateB, radius );","float r = getDotColour( cell_r, p, 0, rotateR, aa );","float g = getDotColour( cell_g, p, 1, rotateG, aa );","float b = getDotColour( cell_b, p, 2, rotateB, aa );","vec4 colour = texture2D( tDiffuse, vUV );","r = blendColour( r, colour.r, blending );","g = blendColour( g, colour.g, blending );","b = blendColour( b, colour.b, blending );","if ( greyscale ) {","r = g = b = (r + b + g) / 3.0;","}","gl_FragColor = vec4( r, g, b, 1.0 );","} else {","gl_FragColor = texture2D( tDiffuse, vUV );","}","}"].join("\n")},HalftonePass=function(e,t,r){for(var n in Pass.call(this),void 0===HalftoneShader&&console.error("HalftonePass requires HalftoneShader"),this.uniforms=UniformsUtils.clone(HalftoneShader.uniforms),this.material=new ShaderMaterial({uniforms:this.uniforms,fragmentShader:HalftoneShader.fragmentShader,vertexShader:HalftoneShader.vertexShader}),this.uniforms.width.value=e,this.uniforms.height.value=t,r)r.hasOwnProperty(n)&&this.uniforms.hasOwnProperty(n)&&(this.uniforms[n].value=r[n]);this.camera=new OrthographicCamera(-1,1,1,-1,0,1),this.scene=new Scene,this.quad=new Mesh(new PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};HalftonePass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:HalftonePass,render:function(e,t,r,n,i){this.material.uniforms.tDiffuse.value=r.texture,this.quad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),e.render(this.scene,this.camera)):(e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera))},setSize:function(e,t){this.uniforms.width.value=e,this.uniforms.height.value=t}});var OutlinePass=function(e,t,r,n){this.renderScene=t,this.renderCamera=r,this.selectedObjects=void 0!==n?n:[],this.visibleEdgeColor=new Color(1,1,1),this.hiddenEdgeColor=new Color(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,Pass.call(this),this.resolution=void 0!==e?new Vector2(e.x,e.y):new Vector2(256,256);var i={minFilter:LinearFilter,magFilter:LinearFilter,format:RGBAFormat},o=Math.round(this.resolution.x/this.downSampleRatio),a=Math.round(this.resolution.y/this.downSampleRatio);this.maskBufferMaterial=new MeshBasicMaterial({color:16777215}),this.maskBufferMaterial.side=DoubleSide,this.renderTargetMaskBuffer=new WebGLRenderTarget(this.resolution.x,this.resolution.y,i),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new MeshDepthMaterial,this.depthMaterial.side=DoubleSide,this.depthMaterial.depthPacking=RGBADepthPacking,this.depthMaterial.blending=NoBlending,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=DoubleSide,this.prepareMaskMaterial.fragmentShader=function(e,t){var r=t.isPerspectiveCamera?"perspective":"orthographic";return e.replace(/DEPTH_TO_VIEW_Z/g,r+"DepthToViewZ")}(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new WebGLRenderTarget(this.resolution.x,this.resolution.y,i),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new WebGLRenderTarget(o,a,i),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new WebGLRenderTarget(o,a,i),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new WebGLRenderTarget(Math.round(o/2),Math.round(a/2),i),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new WebGLRenderTarget(o,a,i),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new WebGLRenderTarget(Math.round(o/2),Math.round(a/2),i),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1;this.separableBlurMaterial1=this.getSeperableBlurMaterial(4),this.separableBlurMaterial1.uniforms.texSize.value=new Vector2(o,a),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(4),this.separableBlurMaterial2.uniforms.texSize.value=new Vector2(Math.round(o/2),Math.round(a/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=4,this.overlayMaterial=this.getOverlayMaterial(),void 0===CopyShader&&console.error("OutlinePass relies on CopyShader");var s=CopyShader;this.copyUniforms=UniformsUtils.clone(s.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new ShaderMaterial({uniforms:this.copyUniforms,vertexShader:s.vertexShader,fragmentShader:s.fragmentShader,blending:NoBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new Color,this.oldClearAlpha=1,this.camera=new OrthographicCamera(-1,1,1,-1,0,1),this.scene=new Scene,this.quad=new Mesh(new PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad),this.tempPulseColor1=new Color,this.tempPulseColor2=new Color,this.textureMatrix=new Matrix4};OutlinePass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:OutlinePass,dispose:function(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose()},setSize:function(e,t){this.renderTargetMaskBuffer.setSize(e,t);var r=Math.round(e/this.downSampleRatio),n=Math.round(t/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(r,n),this.renderTargetBlurBuffer1.setSize(r,n),this.renderTargetEdgeBuffer1.setSize(r,n),this.separableBlurMaterial1.uniforms.texSize.value=new Vector2(r,n),r=Math.round(r/2),n=Math.round(n/2),this.renderTargetBlurBuffer2.setSize(r,n),this.renderTargetEdgeBuffer2.setSize(r,n),this.separableBlurMaterial2.uniforms.texSize.value=new Vector2(r,n)},changeVisibilityOfSelectedObjects:function(e){function t(t){t.isMesh&&(e?(t.visible=t.userData.oldVisible,delete t.userData.oldVisible):(t.userData.oldVisible=t.visible,t.visible=e))}for(var r=0;r<this.selectedObjects.length;r++){this.selectedObjects[r].traverse(t)}},changeVisibilityOfNonSelectedObjects:function(e){var t=[];function r(e){e.isMesh&&t.push(e)}for(var n=0;n<this.selectedObjects.length;n++){this.selectedObjects[n].traverse(r)}this.renderScene.traverse(function(r){if(r.isMesh||r.isLine||r.isSprite){for(var n=!1,i=0;i<t.length;i++)if(t[i].id===r.id){n=!0;break}if(!n){var o=r.visible;e&&!r.bVisible||(r.visible=e),r.bVisible=o}}})},updateTextureMatrix:function(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)},render:function(e,t,r,n,i){if(this.selectedObjects.length>0){this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha();var o=e.autoClear;e.autoClear=!1,i&&e.context.disable(e.context.STENCIL_TEST),e.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1);var a=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,e.setRenderTarget(this.renderTargetDepthBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.changeVisibilityOfSelectedObjects(!0),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value=new Vector2(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,e.setRenderTarget(this.renderTargetMaskBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this.renderScene.background=a,this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,e.setRenderTarget(this.renderTargetMaskDownSampleBuffer),e.clear(),e.render(this.scene,this.camera),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){var s=.625+.75*Math.cos(.01*performance.now()/this.pulsePeriod)/2;this.tempPulseColor1.multiplyScalar(s),this.tempPulseColor2.multiplyScalar(s)}this.quad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value=new Vector2(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),e.render(this.scene,this.camera),this.quad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=OutlinePass.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,e.setRenderTarget(this.renderTargetBlurBuffer1),e.clear(),e.render(this.scene,this.camera),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=OutlinePass.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),e.render(this.scene,this.camera),this.quad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=OutlinePass.BlurDirectionX,e.setRenderTarget(this.renderTargetBlurBuffer2),e.clear(),e.render(this.scene,this.camera),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=OutlinePass.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer2),e.clear(),e.render(this.scene,this.camera),this.quad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,i&&e.context.enable(e.context.STENCIL_TEST),e.setRenderTarget(r),e.render(this.scene,this.camera),e.setClearColor(this.oldClearColor,this.oldClearAlpha),e.autoClear=o}this.renderToScreen&&(this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=r.texture,e.setRenderTarget(null),e.render(this.scene,this.camera))},getPrepareMaskMaterial:function(){return new ShaderMaterial({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new Vector2(.5,.5)},textureMatrix:{value:new Matrix4}},vertexShader:["varying vec4 projTexCoord;","varying vec4 vPosition;","uniform mat4 textureMatrix;","void main() {","\tvPosition = modelViewMatrix * vec4( position, 1.0 );","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tprojTexCoord = textureMatrix * worldPosition;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <packing>","varying vec4 vPosition;","varying vec4 projTexCoord;","uniform sampler2D depthTexture;","uniform vec2 cameraNearFar;","void main() {","\tfloat depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));","\tfloat viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );","\tfloat depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;","\tgl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);","}"].join("\n")})},getEdgeDetectionMaterial:function(){return new ShaderMaterial({uniforms:{maskTexture:{value:null},texSize:{value:new Vector2(.5,.5)},visibleEdgeColor:{value:new Vector3(1,1,1)},hiddenEdgeColor:{value:new Vector3(1,1,1)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec3 visibleEdgeColor;\t\t\t\tuniform vec3 hiddenEdgeColor;\t\t\t\t\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tvec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\t\t\t\t\tvec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\t\t\t\t\tvec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\t\t\t\t\tvec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\t\t\t\t\tvec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\t\t\t\t\tfloat diff1 = (c1.r - c2.r)*0.5;\t\t\t\t\tfloat diff2 = (c3.r - c4.r)*0.5;\t\t\t\t\tfloat d = length( vec2(diff1, diff2) );\t\t\t\t\tfloat a1 = min(c1.g, c2.g);\t\t\t\t\tfloat a2 = min(c3.g, c4.g);\t\t\t\t\tfloat visibilityFactor = min(a1, a2);\t\t\t\t\tvec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\t\t\t\t\tgl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\t\t\t\t}"})},getSeperableBlurMaterial:function(e){return new ShaderMaterial({defines:{MAX_RADIUS:e},uniforms:{colorTexture:{value:null},texSize:{value:new Vector2(.5,.5)},direction:{value:new Vector2(.5,.5)},kernelRadius:{value:1}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\t\t\t\tuniform sampler2D colorTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\tuniform float kernelRadius;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, kernelRadius);\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\t\t\t\t\tvec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\t\t\t\t\tvec2 uvOffset = delta;\t\t\t\t\tfor( int i = 1; i <= MAX_RADIUS; i ++ ) {\t\t\t\t\t\tfloat w = gaussianPdf(uvOffset.x, kernelRadius);\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\t\t\t\t\t\tdiffuseSum += ((sample1 + sample2) * w);\t\t\t\t\t\tweightSum += (2.0 * w);\t\t\t\t\t\tuvOffset += delta;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\t\t\t\t}"})},getOverlayMaterial:function(){return new ShaderMaterial({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform sampler2D edgeTexture1;\t\t\t\tuniform sampler2D edgeTexture2;\t\t\t\tuniform sampler2D patternTexture;\t\t\t\tuniform float edgeStrength;\t\t\t\tuniform float edgeGlow;\t\t\t\tuniform bool usePatternTexture;\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tvec4 edgeValue1 = texture2D(edgeTexture1, vUv);\t\t\t\t\tvec4 edgeValue2 = texture2D(edgeTexture2, vUv);\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\t\t\t\t\tvec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\t\t\t\t\tfloat visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\t\t\t\t\tvec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\t\t\t\t\tvec4 finalColor = edgeStrength * maskColor.r * edgeValue;\t\t\t\t\tif(usePatternTexture)\t\t\t\t\t\tfinalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\t\t\t\t\tgl_FragColor = finalColor;\t\t\t\t}",blending:AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0})}}),OutlinePass.BlurDirectionX=new Vector2(1,0),OutlinePass.BlurDirectionY=new Vector2(0,1);var RenderPass=function(e,t,r,n,i){Pass.call(this),this.scene=e,this.camera=t,this.overrideMaterial=r,this.clearColor=n,this.clearAlpha=void 0!==i?i:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1};function DepthTexture(e,t,r,n,i,o,a,s,l,u){if((u=void 0!==u?u:DepthFormat)!==DepthFormat&&u!==DepthStencilFormat)throw new Error("DepthTexture format must be either DepthFormat or DepthStencilFormat");void 0===r&&u===DepthFormat&&(r=UnsignedShortType),void 0===r&&u===DepthStencilFormat&&(r=UnsignedInt248Type),Texture.call(this,null,n,i,o,a,s,u,r,l),this.image={width:e,height:t},this.magFilter=void 0!==a?a:NearestFilter,this.minFilter=void 0!==s?s:NearestFilter,this.flipY=!1,this.generateMipmaps=!1}RenderPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:RenderPass,render:function(e,t,r,n,i){var o,a,s=e.autoClear;e.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(o=e.getClearColor().getHex(),a=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:r),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(o,a),this.scene.overrideMaterial=null,e.autoClear=s}}),DepthTexture.prototype=Object.create(Texture.prototype),DepthTexture.prototype.constructor=DepthTexture,DepthTexture.prototype.isDepthTexture=!0;var SAOShader={defines:{NUM_SAMPLES:7,NUM_RINGS:4,NORMAL_TEXTURE:0,DIFFUSE_TEXTURE:0,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{type:"t",value:null},tDiffuse:{type:"t",value:null},tNormal:{type:"t",value:null},size:{type:"v2",value:new Vector2(512,512)},cameraNear:{type:"f",value:1},cameraFar:{type:"f",value:100},cameraProjectionMatrix:{type:"m4",value:new Matrix4},cameraInverseProjectionMatrix:{type:"m4",value:new Matrix4},scale:{type:"f",value:1},intensity:{type:"f",value:.1},bias:{type:"f",value:.5},minResolution:{type:"f",value:0},kernelRadius:{type:"f",value:100},randomSeed:{type:"f",value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","varying vec2 vUv;","#if DIFFUSE_TEXTURE == 1","uniform sampler2D tDiffuse;","#endif","uniform sampler2D tDepth;","#if NORMAL_TEXTURE == 1","uniform sampler2D tNormal;","#endif","uniform float cameraNear;","uniform float cameraFar;","uniform mat4 cameraProjectionMatrix;","uniform mat4 cameraInverseProjectionMatrix;","uniform float scale;","uniform float intensity;","uniform float bias;","uniform float kernelRadius;","uniform float minResolution;","uniform vec2 size;","uniform float randomSeed;","// RGBA depth","#include <packing>","vec4 getDefaultColor( const in vec2 screenPosition ) {","\t#if DIFFUSE_TEXTURE == 1","\treturn texture2D( tDiffuse, vUv );","\t#else","\treturn vec4( 1.0 );","\t#endif","}","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","\t#else","\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );","\t#endif","}","vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {","\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];","\tvec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );","\tclipPosition *= clipW; // unprojection.","\treturn ( cameraInverseProjectionMatrix * clipPosition ).xyz;","}","vec3 getViewNormal( const in vec3 viewPosition, const in vec2 screenPosition ) {","\t#if NORMAL_TEXTURE == 1","\treturn unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );","\t#else","\treturn normalize( cross( dFdx( viewPosition ), dFdy( viewPosition ) ) );","\t#endif","}","float scaleDividedByCameraFar;","float minResolutionMultipliedByCameraFar;","float getOcclusion( const in vec3 centerViewPosition, const in vec3 centerViewNormal, const in vec3 sampleViewPosition ) {","\tvec3 viewDelta = sampleViewPosition - centerViewPosition;","\tfloat viewDistance = length( viewDelta );","\tfloat scaledScreenDistance = scaleDividedByCameraFar * viewDistance;","\treturn max(0.0, (dot(centerViewNormal, viewDelta) - minResolutionMultipliedByCameraFar) / scaledScreenDistance - bias) / (1.0 + pow2( scaledScreenDistance ) );","}","// moving costly divides into consts","const float ANGLE_STEP = PI2 * float( NUM_RINGS ) / float( NUM_SAMPLES );","const float INV_NUM_SAMPLES = 1.0 / float( NUM_SAMPLES );","float getAmbientOcclusion( const in vec3 centerViewPosition ) {","\t// precompute some variables require in getOcclusion.","\tscaleDividedByCameraFar = scale / cameraFar;","\tminResolutionMultipliedByCameraFar = minResolution * cameraFar;","\tvec3 centerViewNormal = getViewNormal( centerViewPosition, vUv );","\t// jsfiddle that shows sample pattern: https://jsfiddle.net/a16ff1p7/","\tfloat angle = rand( vUv + randomSeed ) * PI2;","\tvec2 radius = vec2( kernelRadius * INV_NUM_SAMPLES ) / size;","\tvec2 radiusStep = radius;","\tfloat occlusionSum = 0.0;","\tfloat weightSum = 0.0;","\tfor( int i = 0; i < NUM_SAMPLES; i ++ ) {","\t\tvec2 sampleUv = vUv + vec2( cos( angle ), sin( angle ) ) * radius;","\t\tradius += radiusStep;","\t\tangle += ANGLE_STEP;","\t\tfloat sampleDepth = getDepth( sampleUv );","\t\tif( sampleDepth >= ( 1.0 - EPSILON ) ) {","\t\t\tcontinue;","\t\t}","\t\tfloat sampleViewZ = getViewZ( sampleDepth );","\t\tvec3 sampleViewPosition = getViewPosition( sampleUv, sampleDepth, sampleViewZ );","\t\tocclusionSum += getOcclusion( centerViewPosition, centerViewNormal, sampleViewPosition );","\t\tweightSum += 1.0;","\t}","\tif( weightSum == 0.0 ) discard;","\treturn occlusionSum * ( intensity / weightSum );","}","void main() {","\tfloat centerDepth = getDepth( vUv );","\tif( centerDepth >= ( 1.0 - EPSILON ) ) {","\t\tdiscard;","\t}","\tfloat centerViewZ = getViewZ( centerDepth );","\tvec3 viewPosition = getViewPosition( vUv, centerDepth, centerViewZ );","\tfloat ambientOcclusion = getAmbientOcclusion( viewPosition );","\tgl_FragColor = getDefaultColor( vUv );","\tgl_FragColor.xyz *=  1.0 - ambientOcclusion;","}"].join("\n")},DepthLimitedBlurShader={defines:{KERNEL_RADIUS:4,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDiffuse:{type:"t",value:null},size:{type:"v2",value:new Vector2(512,512)},sampleUvOffsets:{type:"v2v",value:[new Vector2(0,0)]},sampleWeights:{type:"1fv",value:[1]},tDepth:{type:"t",value:null},cameraNear:{type:"f",value:10},cameraFar:{type:"f",value:1e3},depthCutoff:{type:"f",value:10}},vertexShader:["#include <common>","uniform vec2 size;","varying vec2 vUv;","varying vec2 vInvSize;","void main() {","\tvUv = uv;","\tvInvSize = 1.0 / size;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","#include <packing>","uniform sampler2D tDiffuse;","uniform sampler2D tDepth;","uniform float cameraNear;","uniform float cameraFar;","uniform float depthCutoff;","uniform vec2 sampleUvOffsets[ KERNEL_RADIUS + 1 ];","uniform float sampleWeights[ KERNEL_RADIUS + 1 ];","varying vec2 vUv;","varying vec2 vInvSize;","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","\t#else","\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );","\t#endif","}","void main() {","\tfloat depth = getDepth( vUv );","\tif( depth >= ( 1.0 - EPSILON ) ) {","\t\tdiscard;","\t}","\tfloat centerViewZ = -getViewZ( depth );","\tbool rBreak = false, lBreak = false;","\tfloat weightSum = sampleWeights[0];","\tvec4 diffuseSum = texture2D( tDiffuse, vUv ) * weightSum;","\tfor( int i = 1; i <= KERNEL_RADIUS; i ++ ) {","\t\tfloat sampleWeight = sampleWeights[i];","\t\tvec2 sampleUvOffset = sampleUvOffsets[i] * vInvSize;","\t\tvec2 sampleUv = vUv + sampleUvOffset;","\t\tfloat viewZ = -getViewZ( getDepth( sampleUv ) );","\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) rBreak = true;","\t\tif( ! rBreak ) {","\t\t\tdiffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;","\t\t\tweightSum += sampleWeight;","\t\t}","\t\tsampleUv = vUv - sampleUvOffset;","\t\tviewZ = -getViewZ( getDepth( sampleUv ) );","\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) lBreak = true;","\t\tif( ! lBreak ) {","\t\t\tdiffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;","\t\t\tweightSum += sampleWeight;","\t\t}","\t}","\tgl_FragColor = diffuseSum / weightSum;","}"].join("\n")},BlurShaderUtils={createSampleWeights:function(e,t){for(var r=function(e,t){return Math.exp(-e*e/(t*t*2))/(Math.sqrt(2*Math.PI)*t)},n=[],i=0;i<=e;i++)n.push(r(i,t));return n},createSampleOffsets:function(e,t){for(var r=[],n=0;n<=e;n++)r.push(t.clone().multiplyScalar(n));return r},configure:function(e,t,r,n){e.defines.KERNEL_RADIUS=t,e.uniforms.sampleUvOffsets.value=BlurShaderUtils.createSampleOffsets(t,n),e.uniforms.sampleWeights.value=BlurShaderUtils.createSampleWeights(t,r),e.needsUpdate=!0}},UnpackDepthRGBAShader={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","#include <packing>","void main() {","float depth = 1.0 - unpackRGBAToDepth( texture2D( tDiffuse, vUv ) );","gl_FragColor = vec4( vec3( depth ), opacity );","}"].join("\n")},SAOPass=function(e,t,r,n,i){(Pass.call(this),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.supportsDepthTextureExtension=void 0!==r&&r,this.supportsNormalTexture=void 0!==n&&n,this.originalClearColor=new Color,this.oldClearColor=new Color,this.oldClearAlpha=1,this.params={output:0,saoBias:.5,saoIntensity:.18,saoScale:1,saoKernelRadius:100,saoMinResolution:0,saoBlur:!0,saoBlurRadius:8,saoBlurStdDev:4,saoBlurDepthCutoff:.01},this.resolution=void 0!==i?new Vector2(i.x,i.y):new Vector2(256,256),this.saoRenderTarget=new WebGLRenderTarget(this.resolution.x,this.resolution.y,{minFilter:LinearFilter,magFilter:LinearFilter,format:RGBAFormat}),this.blurIntermediateRenderTarget=this.saoRenderTarget.clone(),this.beautyRenderTarget=this.saoRenderTarget.clone(),this.normalRenderTarget=new WebGLRenderTarget(this.resolution.x,this.resolution.y,{minFilter:NearestFilter,magFilter:NearestFilter,format:RGBAFormat}),this.depthRenderTarget=this.normalRenderTarget.clone(),this.supportsDepthTextureExtension)&&((r=new DepthTexture).type=UnsignedShortType,r.minFilter=NearestFilter,r.maxFilter=NearestFilter,this.beautyRenderTarget.depthTexture=r,this.beautyRenderTarget.depthBuffer=!0);this.depthMaterial=new MeshDepthMaterial,this.depthMaterial.depthPacking=RGBADepthPacking,this.depthMaterial.blending=NoBlending,this.normalMaterial=new MeshNormalMaterial,this.normalMaterial.blending=NoBlending,void 0===SAOShader&&console.error("SAOPass relies on SAOShader"),this.saoMaterial=new ShaderMaterial({defines:Object.assign({},SAOShader.defines),fragmentShader:SAOShader.fragmentShader,vertexShader:SAOShader.vertexShader,uniforms:UniformsUtils.clone(SAOShader.uniforms)}),this.saoMaterial.extensions.derivatives=!0,this.saoMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.saoMaterial.defines.NORMAL_TEXTURE=this.supportsNormalTexture?1:0,this.saoMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.saoMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?r:this.depthRenderTarget.texture,this.saoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.saoMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.getInverse(this.camera.projectionMatrix),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.blending=NoBlending,void 0===DepthLimitedBlurShader&&console.error("SAOPass relies on DepthLimitedBlurShader"),this.vBlurMaterial=new ShaderMaterial({uniforms:UniformsUtils.clone(DepthLimitedBlurShader.uniforms),defines:Object.assign({},DepthLimitedBlurShader.defines),vertexShader:DepthLimitedBlurShader.vertexShader,fragmentShader:DepthLimitedBlurShader.fragmentShader}),this.vBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.vBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.vBlurMaterial.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.vBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?r:this.depthRenderTarget.texture,this.vBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.vBlurMaterial.blending=NoBlending,this.hBlurMaterial=new ShaderMaterial({uniforms:UniformsUtils.clone(DepthLimitedBlurShader.uniforms),defines:Object.assign({},DepthLimitedBlurShader.defines),vertexShader:DepthLimitedBlurShader.vertexShader,fragmentShader:DepthLimitedBlurShader.fragmentShader}),this.hBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.hBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.hBlurMaterial.uniforms.tDiffuse.value=this.blurIntermediateRenderTarget.texture,this.hBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?r:this.depthRenderTarget.texture,this.hBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.hBlurMaterial.blending=NoBlending,void 0===CopyShader&&console.error("SAOPass relies on CopyShader"),this.materialCopy=new ShaderMaterial({uniforms:UniformsUtils.clone(CopyShader.uniforms),vertexShader:CopyShader.vertexShader,fragmentShader:CopyShader.fragmentShader,blending:NoBlending}),this.materialCopy.transparent=!0,this.materialCopy.depthTest=!1,this.materialCopy.depthWrite=!1,this.materialCopy.blending=CustomBlending,this.materialCopy.blendSrc=DstColorFactor,this.materialCopy.blendDst=ZeroFactor,this.materialCopy.blendEquation=AddEquation,this.materialCopy.blendSrcAlpha=DstAlphaFactor,this.materialCopy.blendDstAlpha=ZeroFactor,this.materialCopy.blendEquationAlpha=AddEquation,void 0===CopyShader&&console.error("SAOPass relies on UnpackDepthRGBAShader"),this.depthCopy=new ShaderMaterial({uniforms:UniformsUtils.clone(UnpackDepthRGBAShader.uniforms),vertexShader:UnpackDepthRGBAShader.vertexShader,fragmentShader:UnpackDepthRGBAShader.fragmentShader,blending:NoBlending}),this.quadCamera=new OrthographicCamera(-1,1,1,-1,0,1),this.quadScene=new Scene,this.quad=new Mesh(new PlaneBufferGeometry(2,2),null),this.quadScene.add(this.quad)};SAOPass.OUTPUT={Beauty:1,Default:0,SAO:2,Depth:3,Normal:4},SAOPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:SAOPass,render:function(e,t,r,n,i){if(this.renderToScreen&&(this.materialCopy.blending=NoBlending,this.materialCopy.uniforms.tDiffuse.value=r.texture,this.materialCopy.needsUpdate=!0,this.renderPass(e,this.materialCopy,null)),1!==this.params.output){this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha();var o=e.autoClear;e.autoClear=!1,e.setRenderTarget(this.depthRenderTarget),e.clear(),this.saoMaterial.uniforms.bias.value=this.params.saoBias,this.saoMaterial.uniforms.intensity.value=this.params.saoIntensity,this.saoMaterial.uniforms.scale.value=this.params.saoScale,this.saoMaterial.uniforms.kernelRadius.value=this.params.saoKernelRadius,this.saoMaterial.uniforms.minResolution.value=this.params.saoMinResolution,this.saoMaterial.uniforms.cameraNear.value=this.camera.near,this.saoMaterial.uniforms.cameraFar.value=this.camera.far;var a=this.params.saoBlurDepthCutoff*(this.camera.far-this.camera.near);this.vBlurMaterial.uniforms.depthCutoff.value=a,this.hBlurMaterial.uniforms.depthCutoff.value=a,this.vBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.vBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.hBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.hBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.params.saoBlurRadius=Math.floor(this.params.saoBlurRadius),this.prevStdDev===this.params.saoBlurStdDev&&this.prevNumSamples===this.params.saoBlurRadius||(BlurShaderUtils.configure(this.vBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new Vector2(0,1)),BlurShaderUtils.configure(this.hBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new Vector2(1,0)),this.prevStdDev=this.params.saoBlurStdDev,this.prevNumSamples=this.params.saoBlurRadius),e.setClearColor(0),e.setRenderTarget(this.beautyRenderTarget),e.clear(),e.render(this.scene,this.camera),this.supportsDepthTextureExtension||this.renderOverride(e,this.depthMaterial,this.depthRenderTarget,0,1),this.supportsNormalTexture&&this.renderOverride(e,this.normalMaterial,this.normalRenderTarget,7829503,1),this.renderPass(e,this.saoMaterial,this.saoRenderTarget,16777215,1),this.params.saoBlur&&(this.renderPass(e,this.vBlurMaterial,this.blurIntermediateRenderTarget,16777215,1),this.renderPass(e,this.hBlurMaterial,this.saoRenderTarget,16777215,1));var s=this.materialCopy;3===this.params.output?this.supportsDepthTextureExtension?(this.materialCopy.uniforms.tDiffuse.value=this.beautyRenderTarget.depthTexture,this.materialCopy.needsUpdate=!0):(this.depthCopy.uniforms.tDiffuse.value=this.depthRenderTarget.texture,this.depthCopy.needsUpdate=!0,s=this.depthCopy):4===this.params.output?(this.materialCopy.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.materialCopy.needsUpdate=!0):(this.materialCopy.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.materialCopy.needsUpdate=!0),0===this.params.output?s.blending=CustomBlending:s.blending=NoBlending,this.renderPass(e,s,this.renderToScreen?null:r),e.setClearColor(this.oldClearColor,this.oldClearAlpha),e.autoClear=o}},renderPass:function(e,t,r,n,i){this.originalClearColor.copy(e.getClearColor());var o=e.getClearAlpha(),a=e.autoClear;e.setRenderTarget(r),e.autoClear=!1,void 0!==n&&null!==n&&(e.setClearColor(n),e.setClearAlpha(i||0),e.clear()),this.quad.material=t,e.render(this.quadScene,this.quadCamera),e.autoClear=a,e.setClearColor(this.originalClearColor),e.setClearAlpha(o)},renderOverride:function(e,t,r,n,i){this.originalClearColor.copy(e.getClearColor());var o=e.getClearAlpha(),a=e.autoClear;e.setRenderTarget(r),e.autoClear=!1,n=t.clearColor||n,i=t.clearAlpha||i,void 0!==n&&null!==n&&(e.setClearColor(n),e.setClearAlpha(i||0),e.clear()),this.scene.overrideMaterial=t,e.render(this.scene,this.camera),this.scene.overrideMaterial=null,e.autoClear=a,e.setClearColor(this.originalClearColor),e.setClearAlpha(o)},setSize:function(e,t){this.beautyRenderTarget.setSize(e,t),this.saoRenderTarget.setSize(e,t),this.blurIntermediateRenderTarget.setSize(e,t),this.normalRenderTarget.setSize(e,t),this.depthRenderTarget.setSize(e,t),this.saoMaterial.uniforms.size.value.set(e,t),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.getInverse(this.camera.projectionMatrix),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.needsUpdate=!0,this.vBlurMaterial.uniforms.size.value.set(e,t),this.vBlurMaterial.needsUpdate=!0,this.hBlurMaterial.uniforms.size.value.set(e,t),this.hBlurMaterial.needsUpdate=!0}});var SavePass=function(e){Pass.call(this),void 0===CopyShader&&console.error("SavePass relies on CopyShader");var t=CopyShader;this.textureID="tDiffuse",this.uniforms=UniformsUtils.clone(t.uniforms),this.material=new ShaderMaterial({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.renderTarget=e,void 0===this.renderTarget&&(this.renderTarget=new WebGLRenderTarget(window.innerWidth,window.innerHeight,{minFilter:LinearFilter,magFilter:LinearFilter,format:RGBFormat,stencilBuffer:!1}),this.renderTarget.texture.name="SavePass.rt"),this.needsSwap=!1,this.camera=new OrthographicCamera(-1,1,1,-1,0,1),this.scene=new Scene,this.quad=new Mesh(new PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};SavePass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:SavePass,render:function(e,t,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.quad.material=this.material,e.setRenderTarget(this.renderTarget),this.clear&&e.clear(),e.render(this.scene,this.camera)}});var SMAAShader=[{defines:{SMAA_THRESHOLD:"0.1"},uniforms:{tDiffuse:{value:null},resolution:{value:new Vector2(1/1024,1/512)}},vertexShader:["uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[ 3 ];","void SMAAEdgeDetectionVS( vec2 texcoord ) {","vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 );","vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 );","vOffset[ 2 ] = texcoord.xyxy + resolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 );","}","void main() {","vUv = uv;","SMAAEdgeDetectionVS( vUv );","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","varying vec4 vOffset[ 3 ];","vec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {","vec2 threshold = vec2( SMAA_THRESHOLD, SMAA_THRESHOLD );","vec4 delta;","vec3 C = texture2D( colorTex, texcoord ).rgb;","vec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;","vec3 t = abs( C - Cleft );","delta.x = max( max( t.r, t.g ), t.b );","vec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;","t = abs( C - Ctop );","delta.y = max( max( t.r, t.g ), t.b );","vec2 edges = step( threshold, delta.xy );","if ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )","discard;","vec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;","t = abs( C - Cright );","delta.z = max( max( t.r, t.g ), t.b );","vec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;","t = abs( C - Cbottom );","delta.w = max( max( t.r, t.g ), t.b );","float maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );","vec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;","t = abs( C - Cleftleft );","delta.z = max( max( t.r, t.g ), t.b );","vec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;","t = abs( C - Ctoptop );","delta.w = max( max( t.r, t.g ), t.b );","maxDelta = max( max( maxDelta, delta.z ), delta.w );","edges.xy *= step( 0.5 * maxDelta, delta.xy );","return vec4( edges, 0.0, 0.0 );","}","void main() {","gl_FragColor = SMAAColorEdgeDetectionPS( vUv, vOffset, tDiffuse );","}"].join("\n")},{defines:{SMAA_MAX_SEARCH_STEPS:"8",SMAA_AREATEX_MAX_DISTANCE:"16",SMAA_AREATEX_PIXEL_SIZE:"( 1.0 / vec2( 160.0, 560.0 ) )",SMAA_AREATEX_SUBTEX_SIZE:"( 1.0 / 7.0 )"},uniforms:{tDiffuse:{value:null},tArea:{value:null},tSearch:{value:null},resolution:{value:new Vector2(1/1024,1/512)}},vertexShader:["uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[ 3 ];","varying vec2 vPixcoord;","void SMAABlendingWeightCalculationVS( vec2 texcoord ) {","vPixcoord = texcoord / resolution;","vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 );","vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 );","vOffset[ 2 ] = vec4( vOffset[ 0 ].xz, vOffset[ 1 ].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * resolution.xxyy * float( SMAA_MAX_SEARCH_STEPS );","}","void main() {","vUv = uv;","SMAABlendingWeightCalculationVS( vUv );","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )","uniform sampler2D tDiffuse;","uniform sampler2D tArea;","uniform sampler2D tSearch;","uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[3];","varying vec2 vPixcoord;","vec2 round( vec2 x ) {","return sign( x ) * floor( abs( x ) + 0.5 );","}","float SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {","e.r = bias + e.r * scale;","return 255.0 * texture2D( searchTex, e, 0.0 ).r;","}","float SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {","vec2 e = vec2( 0.0, 1.0 );","for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {","e = texture2D( edgesTex, texcoord, 0.0 ).rg;","texcoord -= vec2( 2.0, 0.0 ) * resolution;","if ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;","}","texcoord.x += 0.25 * resolution.x;","texcoord.x += resolution.x;","texcoord.x += 2.0 * resolution.x;","texcoord.x -= resolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);","return texcoord.x;","}","float SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {","vec2 e = vec2( 0.0, 1.0 );","for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {","e = texture2D( edgesTex, texcoord, 0.0 ).rg;","texcoord += vec2( 2.0, 0.0 ) * resolution;","if ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;","}","texcoord.x -= 0.25 * resolution.x;","texcoord.x -= resolution.x;","texcoord.x -= 2.0 * resolution.x;","texcoord.x += resolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );","return texcoord.x;","}","float SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {","vec2 e = vec2( 1.0, 0.0 );","for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {","e = texture2D( edgesTex, texcoord, 0.0 ).rg;","texcoord += vec2( 0.0, 2.0 ) * resolution;","if ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;","}","texcoord.y -= 0.25 * resolution.y;","texcoord.y -= resolution.y;","texcoord.y -= 2.0 * resolution.y;","texcoord.y += resolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 );","return texcoord.y;","}","float SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {","vec2 e = vec2( 1.0, 0.0 );","for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {","e = texture2D( edgesTex, texcoord, 0.0 ).rg;","texcoord -= vec2( 0.0, 2.0 ) * resolution;","if ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;","}","texcoord.y += 0.25 * resolution.y;","texcoord.y += resolution.y;","texcoord.y += 2.0 * resolution.y;","texcoord.y -= resolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 );","return texcoord.y;","}","vec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {","vec2 texcoord = float( SMAA_AREATEX_MAX_DISTANCE ) * round( 4.0 * vec2( e1, e2 ) ) + dist;","texcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );","texcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;","return texture2D( areaTex, texcoord, 0.0 ).rg;","}","vec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {","vec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );","vec2 e = texture2D( edgesTex, texcoord ).rg;","if ( e.g > 0.0 ) {","vec2 d;","vec2 coords;","coords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );","coords.y = offset[ 1 ].y;","d.x = coords.x;","float e1 = texture2D( edgesTex, coords, 0.0 ).r;","coords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );","d.y = coords.x;","d = d / resolution.x - pixcoord.x;","vec2 sqrt_d = sqrt( abs( d ) );","coords.y -= 1.0 * resolution.y;","float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 1, 0 ) ).r;","weights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );","}","if ( e.r > 0.0 ) {","vec2 d;","vec2 coords;","coords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );","coords.x = offset[ 0 ].x;","d.x = coords.y;","float e1 = texture2D( edgesTex, coords, 0.0 ).g;","coords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );","d.y = coords.y;","d = d / resolution.y - pixcoord.y;","vec2 sqrt_d = sqrt( abs( d ) );","coords.y -= 1.0 * resolution.y;","float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 0, 1 ) ).g;","weights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );","}","return weights;","}","void main() {","gl_FragColor = SMAABlendingWeightCalculationPS( vUv, vPixcoord, vOffset, tDiffuse, tArea, tSearch, ivec4( 0.0 ) );","}"].join("\n")},{uniforms:{tDiffuse:{value:null},tColor:{value:null},resolution:{value:new Vector2(1/1024,1/512)}},vertexShader:["uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[ 2 ];","void SMAANeighborhoodBlendingVS( vec2 texcoord ) {","vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 );","vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 );","}","void main() {","vUv = uv;","SMAANeighborhoodBlendingVS( vUv );","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform sampler2D tColor;","uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[ 2 ];","vec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {","vec4 a;","a.xz = texture2D( blendTex, texcoord ).xz;","a.y = texture2D( blendTex, offset[ 1 ].zw ).g;","a.w = texture2D( blendTex, offset[ 1 ].xy ).a;","if ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {","return texture2D( colorTex, texcoord, 0.0 );","} else {","vec2 offset;","offset.x = a.a > a.b ? a.a : -a.b;","offset.y = a.g > a.r ? -a.g : a.r;","if ( abs( offset.x ) > abs( offset.y )) {","offset.y = 0.0;","} else {","offset.x = 0.0;","}","vec4 C = texture2D( colorTex, texcoord, 0.0 );","texcoord += sign( offset ) * resolution;","vec4 Cop = texture2D( colorTex, texcoord, 0.0 );","float s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );","C.xyz = pow(C.xyz, vec3(2.2));","Cop.xyz = pow(Cop.xyz, vec3(2.2));","vec4 mixed = mix(C, Cop, s);","mixed.xyz = pow(mixed.xyz, vec3(1.0 / 2.2));","return mixed;","}","}","void main() {","gl_FragColor = SMAANeighborhoodBlendingPS( vUv, vOffset, tColor, tDiffuse );","}"].join("\n")}],SMAAPass=function(e,t){Pass.call(this),this.edgesRT=new WebGLRenderTarget(e,t,{depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1,minFilter:LinearFilter,format:RGBFormat}),this.edgesRT.texture.name="SMAAPass.edges",this.weightsRT=new WebGLRenderTarget(e,t,{depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1,minFilter:LinearFilter,format:RGBAFormat}),this.weightsRT.texture.name="SMAAPass.weights";var r=this,n=new Image;n.src=this.getAreaTexture(),n.onload=function(){r.areaTexture.needsUpdate=!0},this.areaTexture=new Texture,this.areaTexture.name="SMAAPass.area",this.areaTexture.image=n,this.areaTexture.format=RGBFormat,this.areaTexture.minFilter=LinearFilter,this.areaTexture.generateMipmaps=!1,this.areaTexture.flipY=!1;var i=new Image;i.src=this.getSearchTexture(),i.onload=function(){r.searchTexture.needsUpdate=!0},this.searchTexture=new Texture,this.searchTexture.name="SMAAPass.search",this.searchTexture.image=i,this.searchTexture.magFilter=NearestFilter,this.searchTexture.minFilter=NearestFilter,this.searchTexture.generateMipmaps=!1,this.searchTexture.flipY=!1,void 0===SMAAShader&&console.error("SMAAPass relies on SMAAShader"),this.uniformsEdges=UniformsUtils.clone(SMAAShader[0].uniforms),this.uniformsEdges.resolution.value.set(1/e,1/t),this.materialEdges=new ShaderMaterial({defines:Object.assign({},SMAAShader[0].defines),uniforms:this.uniformsEdges,vertexShader:SMAAShader[0].vertexShader,fragmentShader:SMAAShader[0].fragmentShader}),this.uniformsWeights=UniformsUtils.clone(SMAAShader[1].uniforms),this.uniformsWeights.resolution.value.set(1/e,1/t),this.uniformsWeights.tDiffuse.value=this.edgesRT.texture,this.uniformsWeights.tArea.value=this.areaTexture,this.uniformsWeights.tSearch.value=this.searchTexture,this.materialWeights=new ShaderMaterial({defines:Object.assign({},SMAAShader[1].defines),uniforms:this.uniformsWeights,vertexShader:SMAAShader[1].vertexShader,fragmentShader:SMAAShader[1].fragmentShader}),this.uniformsBlend=UniformsUtils.clone(SMAAShader[2].uniforms),this.uniformsBlend.resolution.value.set(1/e,1/t),this.uniformsBlend.tDiffuse.value=this.weightsRT.texture,this.materialBlend=new ShaderMaterial({uniforms:this.uniformsBlend,vertexShader:SMAAShader[2].vertexShader,fragmentShader:SMAAShader[2].fragmentShader}),this.needsSwap=!1,this.camera=new OrthographicCamera(-1,1,1,-1,0,1),this.scene=new Scene,this.quad=new Mesh(new PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};SMAAPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:SMAAPass,render:function(e,t,r,n,i){this.uniformsEdges.tDiffuse.value=r.texture,this.quad.material=this.materialEdges,e.setRenderTarget(this.edgesRT),this.clear&&e.clear(),e.render(this.scene,this.camera),this.quad.material=this.materialWeights,e.setRenderTarget(this.weightsRT),this.clear&&e.clear(),e.render(this.scene,this.camera),this.uniformsBlend.tColor.value=r.texture,this.quad.material=this.materialBlend,this.renderToScreen?(e.setRenderTarget(null),e.render(this.scene,this.camera)):(e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera))},setSize:function(e,t){this.edgesRT.setSize(e,t),this.weightsRT.setSize(e,t),this.materialEdges.uniforms.resolution.value.set(1/e,1/t),this.materialWeights.uniforms.resolution.value.set(1/e,1/t),this.materialBlend.uniforms.resolution.value.set(1/e,1/t)},getAreaTexture:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAIAAACOVPcQAACBeklEQVR42u39W4xlWXrnh/3WWvuciIzMrKxrV8/0rWbY0+SQFKcb4owIkSIFCjY9AC1BT/LYBozRi+EX+cV+8IMsYAaCwRcBwjzMiw2jAWtgwC8WR5Q8mDFHZLNHTarZGrLJJllt1W2qKrsumZWZcTvn7L3W54e1vrXX3vuciLPPORFR1XE2EomorB0nVuz//r71re/y/1eMvb4Cb3N11xV/PP/2v4UBAwJG/7H8urx6/25/Gf8O5hypMQ0EEEQwAqLfoN/Z+97f/SW+/NvcgQk4sGBJK6H7N4PFVL+K+e0N11yNfkKvwUdwdlUAXPHHL38oa15f/i/46Ih6SuMSPmLAYAwyRKn7dfMGH97jaMFBYCJUgotIC2YAdu+LyW9vvubxAP8kAL8H/koAuOKP3+q6+xGnd5kdYCeECnGIJViwGJMAkQKfDvB3WZxjLKGh8VSCCzhwEWBpMc5/kBbjawT4HnwJfhr+pPBIu7uu+OOTo9vsmtQcniMBGkKFd4jDWMSCRUpLjJYNJkM+IRzQ+PQvIeAMTrBS2LEiaiR9b/5PuT6Ap/AcfAFO4Y3dA3DFH7/VS+M8k4baEAQfMI4QfbVDDGIRg7GKaIY52qAjTAgTvGBAPGIIghOCYAUrGFNgzA7Q3QhgCwfwAnwe5vDejgG44o/fbm1C5ZlYQvQDARPAIQGxCWBM+wWl37ZQESb4gImexGMDouhGLx1Cst0Saa4b4AqO4Hk4gxo+3DHAV/nx27p3JziPM2pVgoiia5MdEzCGULprIN7gEEeQ5IQxEBBBQnxhsDb5auGmAAYcHMA9eAAz8PBol8/xij9+C4Djlim4gJjWcwZBhCBgMIIYxGAVIkH3ZtcBuLdtRFMWsPGoY9rN+HoBji9VBYdwD2ZQg4cnO7OSq/z4rU5KKdwVbFAjNojCQzTlCLPFSxtamwh2jMUcEgg2Wm/6XgErIBhBckQtGN3CzbVacERgCnfgLswhnvqf7QyAq/z4rRZm1YglYE3affGITaZsdIe2FmMIpnOCap25I6jt2kCwCW0D1uAD9sZctNGXcQIHCkINDQgc78aCr+zjtw3BU/ijdpw3zhCwcaONwBvdeS2YZKkJNJsMPf2JKEvC28RXxxI0ASJyzQCjCEQrO4Q7sFArEzjZhaFc4cdv+/JFdKULM4px0DfUBI2hIsy06BqLhGTQEVdbfAIZXYMPesq6VoCHICzUyjwInO4Y411//LYLs6TDa9wvg2CC2rElgAnpTBziThxaL22MYhzfkghz6GAs2VHbbdM91VZu1MEEpupMMwKyVTb5ij9+u4VJG/5EgEMMmFF01cFai3isRbKbzb+YaU/MQbAm2XSMoUPAmvZzbuKYRIFApbtlrfFuUGd6vq2hXNnH78ZLh/iFhsQG3T4D1ib7k5CC6vY0DCbtrohgLEIClXiGtl10zc0CnEGIhhatLBva7NP58Tvw0qE8yWhARLQ8h4+AhQSP+I4F5xoU+VilGRJs6wnS7ruti/4KvAY/CfdgqjsMy4pf8fodQO8/gnuX3f/3xi3om1/h7THr+co3x93PP9+FBUfbNUjcjEmhcrkT+8K7ml7V10Jo05mpIEFy1NmCJWx9SIKKt+EjAL4Ez8EBVOB6havuT/rByPvHXK+9zUcfcbb254+9fydJknYnRr1oGfdaiAgpxu1Rx/Rek8KISftx3L+DfsLWAANn8Hvw0/AFeAGO9DFV3c6D+CcWbL8Dj9e7f+T1k8AZv/d7+PXWM/Z+VvdCrIvuAKO09RpEEQJM0Ci6+B4xhTWr4cZNOvhktabw0ta0rSJmqz3Yw5/AKXwenod7cAhTmBSPKf6JBdvH8IP17h95pXqw50/+BFnj88fev4NchyaK47OPhhtI8RFSvAfDSNh0Ck0p2gLxGkib5NJj/JWCr90EWQJvwBzO4AHcgztwAFN1evHPUVGwfXON+0debT1YeGON9Yy9/63X+OguiwmhIhQhD7l4sMqlG3D86Suc3qWZ4rWjI1X7u0Ytw6x3rIMeIOPDprfe2XzNgyj6PahhBjO4C3e6puDgXrdg+/5l948vF3bqwZetZ+z9Rx9zdIY5pInPK4Nk0t+l52xdK2B45Qd87nM8fsD5EfUhIcJcERw4RdqqH7Yde5V7m1vhNmtedkz6EDzUMF/2jJYWbC+4fzzA/Y+/8PPH3j9dcBAPIRP8JLXd5BpAu03aziOL3VVHZzz3CXWDPWd+SH2AnxIqQoTZpo9Ckc6HIrFbAbzNmlcg8Ag8NFDDAhbJvTBZXbC94P7t68EXfv6o+21gUtPETU7bbkLxvNKRFG2+KXzvtObonPP4rBvsgmaKj404DlshFole1Glfh02fE7bYR7dZ82oTewIBGn1Md6CG6YUF26X376oevOLzx95vhUmgblI6LBZwTCDY7vMq0op5WVXgsObOXJ+1x3qaBl9j1FeLxbhU9w1F+Wiba6s1X/TBz1LnUfuYDi4r2C69f1f14BWfP+p+W2GFKuC9phcELMYRRLur9DEZTUdEH+iEqWdaM7X4WOoPGI+ZYD2+wcQ+y+ioHUZ9dTDbArzxmi/bJI9BND0Ynd6lBdve/butBw8+f/T9D3ABa3AG8W3VPX4hBin+bj8dMMmSpp5pg7fJ6xrBFE2WQQEWnV8Qg3FbAWzYfM1rREEnmvkN2o1+acG2d/9u68GDzx91v3mAjb1zkpqT21OipPKO0b9TO5W0nTdOmAQm0TObts3aBKgwARtoPDiCT0gHgwnbArzxmtcLc08HgF1asN0C4Ms/fvD5I+7PhfqyXE/b7RbbrGyRQRT9ARZcwAUmgdoz0ehJ9Fn7QAhUjhDAQSw0bV3T3WbNa59jzmiP6GsWbGXDX2ytjy8+f9T97fiBPq9YeLdBmyuizZHaqXITnXiMUEEVcJ7K4j3BFPurtB4bixW8wTpweL8DC95szWMOqucFYGsWbGU7p3TxxxefP+r+oTVktxY0v5hbq3KiOKYnY8ddJVSBxuMMVffNbxwIOERShst73HZ78DZrHpmJmH3K6sGz0fe3UUj0eyRrSCGTTc+rjVNoGzNSv05srAxUBh8IhqChiQgVNIIBH3AVPnrsnXQZbLTm8ammv8eVXn/vWpaTem5IXRlt+U/LA21zhSb9cye6jcOfCnOwhIAYXAMVTUNV0QhVha9xjgA27ODJbLbmitt3tRN80lqG6N/khgot4ZVlOyO4WNg3OIMzhIZQpUEHieg2im6F91hB3I2tubql6BYNN9Hj5S7G0G2tahslBWKDnOiIvuAEDzakDQKDNFQT6gbn8E2y4BBubM230YIpBnDbMa+y3dx0n1S0BtuG62lCCXwcY0F72T1VRR3t2ONcsmDjbmzNt9RFs2LO2hQNyb022JisaI8rAWuw4HI3FuAIhZdOGIcdjLJvvObqlpqvWTJnnQbyi/1M9O8UxWhBs//H42I0q1Yb/XPGONzcmm+ri172mHKvZBpHkJaNJz6v9jxqiklDj3U4CA2ugpAaYMWqNXsdXbmJNd9egCnJEsphXNM+MnK3m0FCJ5S1kmJpa3DgPVbnQnPGWIDspW9ozbcO4K/9LkfaQO2KHuqlfFXSbdNzcEcwoqNEFE9zcIXu9/6n/ym/BC/C3aJLzEKPuYVlbFnfhZ8kcWxV3dbv4bKl28566wD+8C53aw49lTABp9PWbsB+knfc/Li3eVizf5vv/xmvnPKg5ihwKEwlrcHqucuVcVOxEv8aH37E3ZqpZypUulrHEtIWKUr+txHg+ojZDGlwnqmkGlzcVi1dLiNSJiHjfbRNOPwKpx9TVdTn3K05DBx4psIk4Ei8aCkJahRgffk4YnEXe07T4H2RR1u27E6wfQsBDofUgjFUFnwC2AiVtA+05J2zpiDK2Oa0c5fmAecN1iJzmpqFZxqYBCYhFTCsUNEmUnIcZ6aEA5rQVhEywG6w7HSW02XfOoBlQmjwulOFQAg66SvJblrTEX1YtJ3uG15T/BH1OfOQeuR8g/c0gdpT5fx2SKbs9EfHTKdM8A1GaJRHLVIwhcGyydZsbifAFVKl5EMKNU2Hryo+06BeTgqnxzYjThVySDikbtJPieco75lYfKAJOMEZBTjoITuWHXXZVhcUDIS2hpiXHV9Ku4u44bN5OYLDOkJo8w+xJSMbhBRHEdEs9JZUCkQrPMAvaHyLkxgkEHxiNkx/x2YB0mGsQ8EUWj/stW5YLhtS5SMu+/YBbNPDCkGTUybN8krRLBGPlZkVOA0j+a1+rkyQKWGaPHPLZOkJhioQYnVZ2hS3zVxMtgC46KuRwbJNd9nV2PHgb36F194ecf/Yeu2vAFe5nm/bRBFrnY4BauE8ERmZRFUn0k8hbftiVYSKMEme2dJCJSCGYAlNqh87bXOPdUkGy24P6d1ll21MBqqx48Fvv8ZHH8HZFY7j/uAq1xMJUFqCSUlJPmNbIiNsmwuMs/q9CMtsZsFO6SprzCS1Z7QL8xCQClEelpjTduDMsmWD8S1PT152BtvmIGvUeDA/yRn83u/x0/4qxoPHjx+PXY9pqX9bgMvh/Nz9kpP4pOe1/fYf3axUiMdHLlPpZCNjgtNFAhcHEDxTumNONhHrBduW+vOyY++70WWnPXj98eA4kOt/mj/5E05l9+O4o8ePx67HFqyC+qSSnyselqjZGaVK2TadbFLPWAQ4NBhHqDCCV7OTpo34AlSSylPtIdd2AJZlyzYQrDJ5lcWGNceD80CunPLGGzsfD+7wRb95NevJI5docQ3tgCyr5bGnyaPRlmwNsFELViOOx9loebGNq2moDOKpHLVP5al2cymWHbkfzGXL7kfRl44H9wZy33tvt+PB/Xnf93e+nh5ZlU18wCiRUa9m7kib9LYuOk+hudQNbxwm0AQqbfloimaB2lM5fChex+ylMwuTbfmXQtmWlenZljbdXTLuOxjI/fDDHY4Hjx8/Hrse0zXfPFxbUN1kKqSCCSk50m0Ajtx3ub9XHBKHXESb8iO6E+qGytF4nO0OG3SXzbJlhxBnKtKyl0NwybjvYCD30aMdjgePHz8eu56SVTBbgxJMliQ3Oauwg0QHxXE2Ez/EIReLdQj42Gzb4CLS0YJD9xUx7bsi0vJi5mUbW1QzL0h0PFk17rtiIPfJk52MB48fPx67npJJwyrBa2RCCQRTbGZSPCxTPOiND4G2pYyOQ4h4jINIJh5wFU1NFZt+IsZ59LSnDqBjZ2awbOku+yInunLcd8VA7rNnOxkPHj9+PGY9B0MWJJNozOJmlglvDMXDEozdhQWbgs/U6oBanGzLrdSNNnZFjOkmbi5bNt1lX7JLLhn3vXAg9/h4y/Hg8ePHI9dzQMEkWCgdRfYykYKnkP7D4rIujsujaKPBsB54vE2TS00ccvFY/Tth7JXeq1hz+qgVy04sAJawTsvOknHfCwdyT062HA8eP348Zj0vdoXF4pilKa2BROed+9fyw9rWRXeTFXESMOanvDZfJuJaSXouQdMdDJZtekZcLLvEeK04d8m474UDuaenW44Hjx8/Xns9YYqZpszGWB3AN/4VHw+k7WSFtJ3Qicuqb/NlVmgXWsxh570xg2UwxUw3WfO6B5nOuO8aA7lnZxuPB48fPx6znm1i4bsfcbaptF3zNT78eFPtwi1OaCNOqp1x3zUGcs/PN++AGD1+fMXrSVm2baTtPhPahbPhA71wIHd2bXzRa69nG+3CraTtPivahV/55tXWg8fyRY/9AdsY8VbSdp8V7cKrrgdfM//z6ILQFtJ2nxHtwmuoB4/kf74+gLeRtvvMaBdeSz34+vifx0YG20jbfTa0C6+tHrwe//NmOG0L8EbSdp8R7cLrrQe/996O+ai3ujQOskpTNULa7jOjXXj99eCd8lHvoFiwsbTdZ0a78PrrwTvlo966pLuRtB2fFe3Cm6oHP9kNH/W2FryxtN1nTLvwRurBO+Kj3pWXHidtx2dFu/Bm68Fb81HvykuPlrb7LGkX3mw9eGs+6h1Y8MbSdjegXcguQLjmevDpTQLMxtJ2N6NdyBZu9AbrwVvwUW+LbteULUpCdqm0HTelXbhNPe8G68Gb8lFvVfYfSNuxvrTdTWoXbozAzdaDZzfkorOj1oxVxlIMlpSIlpLrt8D4hrQL17z+c3h6hU/wv4Q/utps4+bm+6P/hIcf0JwQ5oQGPBL0eKPTYEXTW+eL/2DKn73J9BTXYANG57hz1cEMviVf/4tf5b/6C5pTQkMIWoAq7hTpOJjtAM4pxKu5vg5vXeUrtI09/Mo/5H+4z+Mp5xULh7cEm2QbRP2tFIKR7WM3fPf/jZ3SWCqLM2l4NxID5zB72HQXv3jj/8mLR5xXNA5v8EbFQEz7PpRfl1+MB/hlAN65qgDn3wTgH13hK7T59bmP+NIx1SHHU84nLOITt3iVz8mNO+lPrjGAnBFqmioNn1mTyk1ta47R6d4MrX7tjrnjYUpdUbv2rVr6YpVfsGG58AG8Ah9eyUN8CX4WfgV+G8LVWPDGb+Zd4cU584CtqSbMKxauxTg+dyn/LkVgA+IR8KHtejeFKRtTmLLpxN6mYVLjYxwXf5x2VofiZcp/lwKk4wGOpYDnoIZPdg/AAbwMfx0+ge9dgZvYjuqKe4HnGnykYo5TvJbG0Vj12JagRhwKa44H95ShkZa5RyLGGdfYvG7aw1TsF6iapPAS29mNS3NmsTQZCmgTzFwgL3upCTgtBTRwvGMAKrgLn4evwin8+afJRcff+8izUGUM63GOOuAs3tJkw7J4kyoNreqrpO6cYLQeFUd7TTpr5YOTLc9RUUogUOVJQ1GYJaFLAW0oTmKyYS46ZooP4S4EON3xQ5zC8/CX4CnM4c1PE8ApexpoYuzqlP3d4S3OJP8ZDK7cKWNaTlqmgDiiHwl1YsE41w1zT4iRTm3DBqxvOUsbMKKDa/EHxagtnta072ejc3DOIh5ojvh8l3tk1JF/AV6FU6jh3U8HwEazLgdCLYSQ+MYiAI2ltomkzttUb0gGHdSUUgsIYjTzLG3mObX4FBRaYtpDVNZrih9TgTeYOBxsEnN1gOCTM8Bsw/ieMc75w9kuAT6A+/AiHGvN/+Gn4KRkiuzpNNDYhDGFndWRpE6SVfm8U5bxnSgVV2jrg6JCKmneqey8VMFgq2+AM/i4L4RUbfSi27lNXZ7R7W9RTcq/q9fk4Xw3AMQd4I5ifAZz8FcVtm9SAom/dyN4lczJQW/kC42ZrHgcCoIf1oVMKkVItmMBi9cOeNHGLqOZk+QqQmrbc5YmYgxELUUN35z2iohstgfLIFmcMV7s4CFmI74L9+EFmGsi+tGnAOD4Yk9gIpo01Y4cA43BWGygMdr4YZekG3OBIUXXNukvJS8tqa06e+lSDCtnqqMFu6hWHXCF+WaYt64m9QBmNxi7Ioy7D+fa1yHw+FMAcPt7SysFLtoG4PXAk7JOA3aAxBRqUiAdU9Yp5lK3HLSRFtOim0sa8euEt08xvKjYjzeJ2GU7YawexrnKI9tmobInjFXCewpwriY9+RR4aaezFhMhGCppKwom0ChrgFlKzyPKkGlTW1YQrE9HJqu8hKGgMc6hVi5QRq0PZxNfrYNgE64utmRv6KKHRpxf6VDUaOvNP5jCEx5q185My/7RKz69UQu2im5k4/eownpxZxNLwiZ1AZTO2ZjWjkU9uaB2HFn6Q3u0JcsSx/qV9hTEApRzeBLDJQXxYmTnq7bdLa3+uqFrxLJ5w1TehnNHx5ECvCh2g2c3hHH5YsfdaSKddztfjQ6imKFGSyFwlLzxEGPp6r5IevVjk1AMx3wMqi1NxDVjLBiPs9tbsCkIY5we5/ML22zrCScFxnNtzsr9Wcc3CnD+pYO+4VXXiDE0oc/vQQ/fDK3oPESJMYXNmJa/DuloJZkcTpcYE8lIH8Dz8DJMiynNC86Mb2lNaaqP/+L7f2fcE/yP7/Lde8xfgSOdMxvOixZf/9p3+M4hT1+F+zApxg9XfUvYjc8qX2lfOOpK2gNRtB4flpFu9FTKCp2XJRgXnX6olp1zyYjTKJSkGmLE2NjUr1bxFM4AeAAHBUFIeSLqXR+NvH/M9fOnfHzOD2vCSyQJKzfgsCh+yi/Mmc35F2fUrw7miW33W9hBD1vpuUojFphIyvg7aTeoymDkIkeW3XLHmguMzbIAJejN6B5MDrhipE2y6SoFRO/AK/AcHHZHNIfiWrEe/C6cr3f/yOvrQKB+zMM55/GQdLDsR+ifr5Fiuu+/y+M78LzOE5dsNuXC3PYvYWd8NXvphLSkJIasrlD2/HOqQ+RjcRdjKTGWYhhVUm4yxlyiGPuMsZR7sMCHUBeTuNWA7if+ifXgc/hovftHXs/DV+Fvwe+f8shzMiMcweFgBly3//vwJfg5AN4450fn1Hd1Rm1aBLu22Dy3y3H2+OqMemkbGZ4jozcDjJf6596xOLpC0eMTHbKnxLxH27uZ/bMTGs2jOaMOY4m87CfQwF0dw53oa1k80JRuz/XgS+8fX3N9Af4qPIMfzKgCp4H5TDGe9GGeFPzSsZz80SlPTxXjgwJmC45njzgt2vbQ4b4OAdUK4/vWhO8d8v6EE8fMUsfakXbPpFJeLs2ubM/qdm/la3WP91uWhxXHjoWhyRUq2iJ/+5mA73zwIIo+LoZ/SgvIRjAd1IMvvn98PfgOvAJfhhm8scAKVWDuaRaK8aQ9f7vuPDH6Bj47ZXau7rqYJ66mTDwEDU6lLbCjCK0qTXyl5mnDoeNRxanj3FJbaksTk0faXxHxLrssgPkWB9LnA/MFleXcJozzjwsUvUG0X/QCve51qkMDXp9mtcyOy3rwBfdvVJK7D6/ACSzg3RoruIq5UDeESfEmVclDxnniU82vxMLtceD0hGZWzBNPMM/jSPne2OVatiTKUpY5vY7gc0LdUAWeWM5tH+O2I66AOWw9xT2BuyRVLGdoDHUsVRXOo/c+ZdRXvFfnxWyIV4upFLCl9eAL7h8Zv0QH8Ry8pA2cHzQpGesctVA37ZtklBTgHjyvdSeKY/RZw/kJMk0Y25cSNRWSigQtlULPTw+kzuJPeYEkXjQRpoGZobYsLF79pyd1dMRHInbgFTZqNLhDqiIsTNpoex2WLcy0/X6rHcdMMQvFSd5dWA++4P7xv89deACnmr36uGlL69bRCL6BSZsS6c0TU2TKK5gtWCzgAOOwQcurqk9j8whvziZSMLcq5hbuwBEsYjopUBkqw1yYBGpLA97SRElEmx5MCInBY5vgLk94iKqSWmhIGmkJ4Bi9m4L645J68LyY4wsFYBfUg5feP/6gWWm58IEmKQM89hq7KsZNaKtP5TxxrUZZVkNmMJtjbKrGxLNEbHPJxhqy7lAmbC32ZqeF6lTaknRWcYaFpfLUBh/rwaQycCCJmW15Kstv6jRHyJFry2C1ahkkIW0LO75s61+owxK1y3XqweX9m5YLM2DPFeOjn/iiqCKJ+yKXF8t5Yl/kNsqaSCryxPq5xWTFIaP8KSW0RYxqupaUf0RcTNSSdJZGcKYdYA6kdtrtmyBckfKXwqk0pHpUHlwWaffjNRBYFPUDWa8e3Lt/o0R0CdisKDM89cX0pvRHEfM8ca4t0s2Xx4kgo91MPQJ/0c9MQYq0co8MBh7bz1fio0UUHLR4aAIOvOmoYO6kwlEVODSSTliWtOtH6sPkrtctF9ZtJ9GIerBskvhdVS5cFNv9s1BU0AbdUgdK4FG+dRnjFmDTzniRMdZO1QhzMK355vigbdkpz9P6qjUGE5J2qAcXmwJ20cZUiAD0z+pGMx6xkzJkmEf40Hr4qZfVg2XzF9YOyoV5BjzVkUJngKf8lgNYwKECEHrCNDrWZzMlflS3yBhr/InyoUgBc/lKT4pxVrrC6g1YwcceK3BmNxZcAtz3j5EIpqguh9H6wc011YN75cKDLpFDxuwkrPQmUwW4KTbj9mZTwBwLq4aQMUZbHm1rylJ46dzR0dua2n3RYCWZsiHROeywyJGR7mXKlpryyCiouY56sFkBWEnkEB/raeh/Sw4162KeuAxMQpEkzy5alMY5wamMsWKKrtW2WpEWNnReZWONKWjrdsKZarpFjqCslq773PLmEhM448Pc3+FKr1+94vv/rfw4tEcu+lKTBe4kZSdijBrykwv9vbCMPcLQTygBjzVckSLPRVGslqdunwJ4oegtFOYb4SwxNgWLCmD7T9kVjTv5YDgpo0XBmN34Z/rEHp0sgyz7lngsrm4lvMm2Mr1zNOJYJ5cuxuQxwMGJq/TP5emlb8fsQBZviK4t8hFL+zbhtlpwaRSxQRWfeETjuauPsdGxsBVdO7nmP4xvzSoT29pRl7kGqz+k26B3Oy0YNV+SXbbQas1ctC/GarskRdFpKczVAF1ZXnLcpaMuzVe6lZ2g/1ndcvOVgRG3sdUAY1bKD6achijMPdMxV4muKVorSpiDHituH7rSTs7n/4y5DhRXo4FVBN4vO/zbAcxhENzGbHCzU/98Mcx5e7a31kWjw9FCe/zNeYyQjZsWb1uc7U33pN4Mji6hCLhivqfa9Ss6xLg031AgfesA/l99m9fgvnaF9JoE6bYKmkGNK3aPbHB96w3+DnxFm4hs0drLsk7U8kf/N/CvwQNtllna0rjq61sH8L80HAuvwH1tvBy2ChqWSCaYTaGN19sTvlfzFD6n+iKTbvtayfrfe9ueWh6GJFoxLdr7V72a5ZpvHcCPDzma0wTO4EgbLyedxstO81n57LYBOBzyfsOhUKsW1J1BB5vr/tz8RyqOFylQP9Tvst2JALsC5lsH8PyQ40DV4ANzYa4dedNiKNR1s+x2wwbR7q4/4cTxqEk4LWDebfisuo36JXLiWFjOtLrlNWh3K1rRS4xvHcDNlFnNmWBBAl5SWaL3oPOfnvbr5pdjVnEaeBJSYjuLEkyLLsWhKccadmOphZkOPgVdalj2QpSmfOsADhMWE2ZBu4+EEJI4wKTAuCoC4xwQbWXBltpxbjkXJtKxxabo9e7tyhlgb6gNlSbUpMh+l/FaqzVwewGu8BW1Zx7pTpQDJUjb8tsUTW6+GDXbMn3mLbXlXJiGdggxFAoUrtPS3wE4Nk02UZG2OOzlk7fRs7i95QCLo3E0jtrjnM7SR3uS1p4qtS2nJ5OwtQVHgOvArLBFijZUV9QtSl8dAY5d0E0hM0w3HS2DpIeB6m/A1+HfhJcGUq4sOxH+x3f5+VO+Ds9rYNI7zPXOYWPrtf8bYMx6fuOAX5jzNR0PdsuON+X1f7EERxMJJoU6GkTEWBvVolVlb5lh3tKCg6Wx1IbaMDdJ+9sUCc5KC46hKGCk3IVOS4TCqdBNfUs7Kd4iXf2RjnT/LLysJy3XDcHLh/vde3x8DoGvwgsa67vBk91G5Pe/HbOe7xwym0NXbtiuuDkGO2IJDh9oQvJ4cY4vdoqLDuoH9Zl2F/ofsekn8lkuhIlhQcffUtSjytFyp++p6NiE7Rqx/lodgKVoceEp/CP4FfjrquZaTtj2AvH5K/ywpn7M34K/SsoYDAdIN448I1/0/wveW289T1/lX5xBzc8N5IaHr0XMOQdHsIkDuJFifj20pBm5jzwUv9e2FhwRsvhAbalCIuIw3bhJihY3p6nTFFIZgiSYjfTf3aXuOjmeGn4bPoGvwl+CFzTRczBIuHBEeImHc37/lGfwZR0cXzVDOvaKfNHvwe+suZ771K/y/XcBlsoN996JpBhoE2toYxOznNEOS5TJc6Id5GEXLjrWo+LEWGNpPDU4WAwsIRROu+1vM+0oW37z/MBN9kqHnSArwPfgFJ7Cq/Ai3Ie7g7ncmI09v8sjzw9mzOAEXoIHxURueaAce5V80f/DOuuZwHM8vsMb5wBzOFWM7wymTXPAEvm4vcFpZ2ut0VZRjkiP2MlmLd6DIpbGSiHOjdnUHN90hRYmhTnmvhzp1iKDNj+b7t5hi79lWGwQ+HN9RsfFMy0FXbEwhfuczKgCbyxYwBmcFhhvo/7a44v+i3XWcwDP86PzpGQYdWh7csP5dBvZ1jNzdxC8pBGuxqSW5vw40nBpj5JhMwvOzN0RWqERHMr4Lv1kWX84xLR830G3j6yqZ1a8UstTlW+qJPOZ+sZ7xZPKTJLhiNOAFd6tk+jrTH31ncLOxid8+nzRb128HhUcru/y0Wn6iT254YPC6FtVSIMoW2sk727AhvTtrWKZTvgsmckfXYZWeNRXx/3YQ2OUxLDrbHtN11IwrgXT6c8dATDwLniYwxzO4RzuQqTKSC5gAofMZ1QBK3zQ4JWobFbcvJm87FK+6JXrKahLn54m3p+McXzzYtP8VF/QpJuh1OwieElEoI1pRxPS09FBrkq2tWCU59+HdhNtTIqKm8EBrw2RTOEDpG3IKo2Y7mFdLm3ZeVjYwVw11o/oznceMve4CgMfNym/utA/d/ILMR7gpXzRy9eDsgLcgbs8O2Va1L0zzIdwGGemTBuwROHeoMShkUc7P+ISY3KH5ZZeWqO8mFTxQYeXTNuzvvK5FGPdQfuu00DwYFY9dyhctEt+OJDdnucfpmyhzUJzfsJjr29l8S0bXBfwRS9ZT26tmMIdZucch5ZboMz3Nio3nIOsYHCGoDT4kUA9MiXEp9Xsui1S8th/kbWIrMBxDGLodWUQIWcvnXy+9M23xPiSMOiRPqM+YMXkUN3gXFrZJwXGzUaMpJfyRS9ZT0lPe8TpScuRlbMHeUmlaKDoNuy62iWNTWNFYjoxFzuJs8oR+RhRx7O4SVNSXpa0ZJQ0K1LAHDQ+D9IepkMXpcsq5EVCvClBUIzDhDoyKwDw1Lc59GbTeORivugw1IcuaEOaGWdNm+Ps5fQ7/tm0DjMegq3yM3vb5j12qUId5UZD2oxDSEWOZMSqFl/W+5oynWDa/aI04tJRQ2eTXusg86SQVu/nwSYwpW6wLjlqIzwLuxGIvoAvul0PS+ZNz0/akp/pniO/8JDnGyaCkzbhl6YcqmK/69prxPqtpx2+Km9al9sjL+rwMgHw4jE/C8/HQ3m1vBuL1fldbzd8mOueVJ92syqdEY4KJjSCde3mcRw2TA6szxedn+zwhZMps0XrqEsiUjnC1hw0TELC2Ek7uAAdzcheXv1BYLagspxpzSAoZZUsIzIq35MnFQ9DOrlNB30jq3L4pkhccKUAA8/ocvN1Rzx9QyOtERs4CVsJRK/DF71kPYrxYsGsm6RMh4cps5g1DOmM54Ly1ii0Hd3Y/BMk8VWFgBVmhqrkJCPBHAolwZaWzLR9Vb7bcWdX9NyUYE+uB2BKfuaeBUcjDljbYVY4DdtsVWvzRZdWnyUzDpjNl1Du3aloAjVJTNDpcIOVVhrHFF66lLfJL1zJr9PQ2nFJSBaKoDe+sAvLufZVHVzYh7W0h/c6AAZ+7Tvj6q9j68G/cTCS/3n1vLKHZwNi+P+pS0WkZNMBMUl+LDLuiE4omZy71r3UFMwNJV+VJ/GC5ixVUkBStsT4gGKh0Gm4Oy3qvq7Lbmq24nPdDuDR9deR11XzP4vFu3TYzfnIyiSVmgizUYGqkIXNdKTY9pgb9D2Ix5t0+NHkVzCdU03suWkkVZAoCONCn0T35gAeW38de43mf97sMOpSvj4aa1KYUm58USI7Wxxes03bAZdRzk6UtbzMaCQ6IxO0dy7X+XsjoD16hpsBeGz9dfzHj+R/Hp8nCxZRqkEDTaCKCSywjiaoMJ1TITE9eg7Jqnq8HL6gDwiZb0u0V0Rr/rmvqjxKuaLCX7ZWXTvAY+uvm3z8CP7nzVpngqrJpZKwWnCUjIviYVlirlGOzPLI3SMVyp/elvBUjjDkNhrtufFFErQ8pmdSlbK16toBHlt/HV8uHMX/vEGALkV3RJREiSlopxwdMXOZPLZ+ix+kAHpMKIk8UtE1ygtquttwxNhphrIZ1IBzjGF3IIGxGcBj6q8bHJBG8T9vdsoWrTFEuebEZuVxhhClH6P5Zo89OG9fwHNjtNQTpD0TG9PJLEYqvEY6Rlxy+ZZGfL0Aj62/bnQCXp//eeM4KzfQVJbgMQbUjlMFIm6TpcfWlZje7NBSV6IsEVmumWIbjiloUzQX9OzYdo8L1wjw2PrrpimONfmfNyzKklrgnEkSzT5QWYQW40YShyzqsRmMXbvVxKtGuYyMKaU1ugenLDm5Ily4iT14fP11Mx+xJv+zZ3MvnfdFqxU3a1W/FTB4m3Qfsyc1XUcdVhDeUDZXSFHHLQj/Y5jtC7ZqM0CXGwB4bP11i3LhOvzPGygYtiUBiwQV/4wFO0majijGsafHyRLu0yG6q35cL1rOpVxr2s5cM2jJYMCdc10Aj6q/blRpWJ//+dmm5psMl0KA2+AFRx9jMe2WbC4jQxnikd4DU8TwUjRVacgdlhmr3bpddzuJ9zXqr2xnxJfzP29RexdtjDVZqzkqa6PyvcojGrfkXiJ8SEtml/nYskicv0ivlxbqjemwUjMw5evdg8fUX9nOiC/lf94Q2i7MURk9nW1MSj5j8eAyV6y5CN2S6qbnw3vdA1Iwq+XOSCl663udN3IzLnrt+us25cI1+Z83SXQUldqQq0b5XOT17bGpLd6ssN1VMPf8c+jG8L3NeCnMdF+Ra3fRa9dft39/LuZ/3vwHoHrqGmQFafmiQw6eyzMxS05K4bL9uA+SKUQzCnSDkqOGokXyJvbgJ/BHI+qvY69//4rl20NsmK2ou2dTsyIALv/91/8n3P2Aao71WFGi8KKv1fRC5+J67Q/507/E/SOshqN5TsmYIjVt+kcjAx98iz/4SaojbIV1rexE7/C29HcYD/DX4a0rBOF5VTu7omsb11L/AWcVlcVZHSsqGuXLLp9ha8I//w3Mv+T4Ew7nTBsmgapoCrNFObIcN4pf/Ob/mrvHTGqqgAupL8qWjWPS9m/31jAe4DjA+4+uCoQoT/zOzlrNd3qd4SdphFxsUvYwGWbTWtISc3wNOWH+kHBMfc6kpmpwPgHWwqaSUG2ZWWheYOGQGaHB+eQ/kn6b3pOgLV+ODSn94wDvr8Bvb70/LLuiPPEr8OGVWfDmr45PZyccEmsVXZGe1pRNX9SU5+AVQkNTIVPCHF/jGmyDC9j4R9LfWcQvfiETmgMMUCMN1uNCakkweZsowdYobiMSlnKA93u7NzTXlSfe+SVbfnPQXmg9LpYAQxpwEtONyEyaueWM4FPjjyjG3uOaFmBTWDNgBXGEiQpsaWhnAqIijB07Dlsy3fUGeP989xbWkyf+FF2SNEtT1E0f4DYYVlxFlbaSMPIRMk/3iMU5pME2SIWJvjckciebkQuIRRyhUvkHg/iUljG5kzVog5hV7vIlCuBrmlhvgPfNHQM8lCf+FEGsYbMIBC0qC9a0uuy2wLXVbLBaP5kjHokCRxapkQyzI4QEcwgYHRZBp+XEFTqXFuNVzMtjXLJgX4gAid24Hjwc4N3dtVSe+NNiwTrzH4WVUOlDobUqr1FuAgYllc8pmzoVrELRHSIW8ViPxNy4xwjBpyR55I6J220qQTZYR4guvUICJiSpr9gFFle4RcF/OMB7BRiX8sSfhpNSO3lvEZCQfLUVTKT78Ek1LRLhWN+yLyTnp8qWUZ46b6vxdRGXfHVqx3eI75YaLa4iNNiK4NOW7wPW6lhbSOF9/M9qw8e/aoB3d156qTzxp8pXx5BKAsYSTOIIiPkp68GmTq7sZtvyzBQaRLNxIZ+paozHWoLFeExIhRBrWitHCAHrCF7/thhD8JhYz84wg93QRV88wLuLY8zF8sQ36qF1J455bOlgnELfshKVxYOXKVuKx0jaj22sczTQqPqtV/XDgpswmGTWWMSDw3ssyUunLLrVPGjYRsH5ggHeHSWiV8kT33ycFSfMgkoOK8apCye0J6VW6GOYvffgU9RWsukEi2kUV2nl4dOYUzRik9p7bcA4ggdJ53LxKcEe17B1R8eqAd7dOepV8sTXf5lhejoL85hUdhDdknPtKHFhljOT+bdq0hxbm35p2nc8+Ja1Iw+tJykgp0EWuAAZYwMVwac5KzYMslhvgHdHRrxKnvhTYcfKsxTxtTETkjHO7rr3zjoV25lAQHrqpV7bTiy2aXMmUhTBnKS91jhtR3GEoF0oLnWhWNnYgtcc4N0FxlcgT7yz3TgNIKkscx9jtV1ZKpWW+Ub1tc1eOv5ucdgpx+FJy9pgbLE7xDyXb/f+hLHVGeitHOi6A7ybo3sF8sS7w7cgdk0nJaOn3hLj3uyD0Zp5pazFIUXUpuTTU18d1EPkDoX8SkmWTnVIozEdbTcZjoqxhNHf1JrSS/AcvHjZ/SMHhL/7i5z+POsTUh/8BvNfYMTA8n+yU/MlTZxSJDRStqvEuLQKWwDctMTQogUDyQRoTQG5Kc6oQRE1yV1jCA7ri7jdZyK0sYTRjCR0Hnnd+y7nHxNgTULqw+8wj0mQKxpYvhjm9uSUxg+TTy7s2GtLUGcywhXSKZN275GsqlclX90J6bRI1aouxmgL7Q0Nen5ziM80SqMIo8cSOo+8XplT/5DHNWsSUr/6lLN/QQ3rDyzLruEW5enpf7KqZoShEduuSFOV7DLX7Ye+GmXb6/hnNNqKsVXuMDFpb9Y9eH3C6NGEzuOuI3gpMH/I6e+zDiH1fXi15t3vA1czsLws0TGEtmPEJdiiFPwlwKbgLHAFk4P6ZyPdymYYHGE0dutsChQBl2JcBFlrEkY/N5bQeXQ18gjunuMfMfsBlxJSx3niO485fwO4fGD5T/+3fPQqkneWVdwnw/3bMPkW9Wbqg+iC765Zk+xcT98ibKZc2EdgHcLoF8cSOo/Oc8fS+OyEULF4g4sJqXVcmfMfsc7A8v1/yfGXmL9I6Fn5pRwZhsPv0TxFNlAfZCvG+Oohi82UC5f/2IsJo0cTOm9YrDoKhFPEUr/LBYTUNht9zelHXDqwfPCIw4owp3mOcIQcLttWXFe3VZ/j5H3cIc0G6oPbCR+6Y2xF2EC5cGUm6wKC5tGEzhsWqw5hNidUiKX5gFWE1GXh4/Qplw4sVzOmx9QxU78g3EF6wnZlEN4FzJ1QPSLEZz1KfXC7vd8ssGdIbNUYpVx4UapyFUHzJoTOo1McSkeNn1M5MDQfs4qQuhhX5vQZFw8suwWTcyYTgioISk2YdmkhehG4PkE7w51inyAGGaU+uCXADabGzJR1fn3lwkty0asIo8cROm9Vy1g0yDxxtPvHDAmpu+PKnM8Ix1wwsGw91YJqhteaWgjYBmmQiebmSpwKKzE19hx7jkzSWOm66oPbzZ8Yj6kxVSpYjVAuvLzYMCRo3oTQecOOjjgi3NQ4l9K5/hOGhNTdcWVOTrlgYNkEXINbpCkBRyqhp+LdRB3g0OU6rMfW2HPCFFMV9nSp+uB2woepdbLBuJQyaw/ZFysXrlXwHxI0b0LovEkiOpXGA1Ijagf+KUNC6rKNa9bQnLFqYNkEnMc1uJrg2u64ELPBHpkgWbmwKpJoDhMwNbbGzAp7Yg31wS2T5rGtzit59PrKhesWG550CZpHEzpv2NGRaxlNjbMqpmEIzygJqQfjypycs2pg2cS2RY9r8HUqkqdEgKTWtWTKoRvOBPDYBltja2SO0RGjy9UHtxwRjA11ujbKF+ti5cIR9eCnxUg6owidtyoU5tK4NLji5Q3HCtiyF2IqLGYsHViOXTXOYxucDqG0HyttqYAKqYo3KTY1ekyDXRAm2AWh9JmsVh/ccg9WJ2E8YjG201sPq5ULxxX8n3XLXuMInbft2mk80rRGjCGctJ8/GFdmEQ9Ug4FlE1ll1Y7jtiraqm5Fe04VV8lvSVBL8hiPrfFVd8+7QH3Qbu2ipTVi8cvSGivc9cj8yvH11YMHdNSERtuOslM97feYFOPKzGcsI4zW0YGAbTAOaxCnxdfiYUmVWslxiIblCeAYr9VYR1gM7GmoPrilunSxxeT3DN/2eBQ9H11+nk1adn6VK71+5+Jfct4/el10/7KBZfNryUunWSCPxPECk1rdOv1WVSrQmpC+Tl46YD3ikQYcpunSQgzVB2VHFhxHVGKDgMEY5GLlQnP7FMDzw7IacAWnO6sBr12u+XanW2AO0wQ8pknnFhsL7KYIqhkEPmEXFkwaN5KQphbkUmG72wgw7WSm9RiL9QT925hkjiVIIhphFS9HKI6/8QAjlpXqg9W2C0apyaVDwKQwrwLY3j6ADR13ZyUNByQXHQu6RY09Hu6zMqXRaNZGS/KEJs0cJEe9VH1QdvBSJv9h09eiRmy0V2uJcqHcShcdvbSNg5fxkenkVprXM9rDVnX24/y9MVtncvbKY706anNl3ASll9a43UiacVquXGhvq4s2FP62NGKfQLIQYu9q1WmdMfmUrDGt8eDS0cXozH/fjmUH6Jruvm50hBDSaEU/2Ru2LEN/dl006TSc/g7tfJERxGMsgDUEr104pfWH9lQaN+M4KWQjwZbVc2rZVNHsyHal23wZtIs2JJqtIc/WLXXRFCpJkfE9jvWlfFbsNQ9pP5ZBS0zKh4R0aMFj1IjTcTnvi0Zz2rt7NdvQb2mgbju1plsH8MmbnEk7KbK0b+wC2iy3aX3szW8xeZvDwET6hWZYwqTXSSG+wMETKum0Dq/q+x62gt2ua2ppAo309TRk9TPazfV3qL9H8z7uhGqGqxNVg/FKx0HBl9OVUORn8Q8Jx9gFttGQUDr3tzcXX9xGgN0EpzN9mdZ3GATtPhL+CjxFDmkeEU6x56kqZRusLzALXVqkCN7zMEcqwjmywDQ6OhyUe0Xao1Qpyncrg6wKp9XfWDsaZplElvQ/b3sdweeghorwBDlHzgk1JmMc/wiERICVy2VJFdMjFuLQSp3S0W3+sngt2njwNgLssFGVQdJ0tu0KH4ky1LW4yrbkuaA6Iy9oz/qEMMXMMDWyIHhsAyFZc2peV9hc7kiKvfULxCl9iddfRK1f8kk9qvbdOoBtOg7ZkOZ5MsGrSHsokgLXUp9y88smniwWyuFSIRVmjplga3yD8Uij5QS1ZiM4U3Qw5QlSm2bXjFe6jzzBFtpg+/YBbLAWG7OPynNjlCw65fukGNdkJRf7yM1fOxVzbxOJVocFoYIaGwH22mIQkrvu1E2nGuebxIgW9U9TSiukPGU+Lt++c3DJPKhyhEEbXCQLUpae2exiKy6tMPe9mDRBFCEMTWrtwxN8qvuGnt6MoihKWS5NSyBhbH8StXoAz8PLOrRgLtOT/+4vcu+7vDLnqNvztOq7fmd8sMmY9Xzn1zj8Dq8+XVdu2Nv0IIySgEdQo3xVHps3Q5i3fLFsV4aiqzAiBhbgMDEd1uh8qZZ+lwhjkgokkOIv4xNJmyncdfUUzgB4oFMBtiu71Xumpz/P+cfUP+SlwFExwWW62r7b+LSPxqxn/gvMZ5z9C16t15UbNlq+jbGJtco7p8wbYlL4alSyfWdeuu0j7JA3JFNuVAwtst7F7FhWBbPFNKIUORndWtLraFLmMu7KFVDDOzqkeaiN33YAW/r76wR4XDN/yN1z7hejPau06EddkS/6XThfcz1fI/4K736fO48vlxt2PXJYFaeUkFS8U15XE3428xdtn2kc8GQlf1vkIaNRRnOMvLTWrZbElEHeLWi1o0dlKPAh1MVgbbVquPJ5+Cr8LU5/H/+I2QlHIU2ClXM9G8v7Rr7oc/hozfUUgsPnb3D+I+7WF8kNO92GY0SNvuxiE+2Bt8prVJTkzE64sfOstxuwfxUUoyk8VjcTlsqe2qITSFoSj6Epd4KsT6BZOWmtgE3hBfir8IzZDwgV4ZTZvD8VvPHERo8v+vL1DASHTz/i9OlKueHDjK5Rnx/JB1Vb1ioXdBra16dmt7dgik10yA/FwJSVY6XjA3oy4SqM2frqDPPSRMex9qs3XQtoWxMj7/Er8GWYsXgjaVz4OYumP2+9kbxvny/6kvWsEBw+fcb5bInc8APdhpOSs01tEqIkoiZjbAqKMruLbJYddHuHFRIyJcbdEdbl2sVLaySygunutBg96Y2/JjKRCdyHV+AEFtTvIpbKIXOamknYSiB6KV/0JetZITgcjjk5ZdaskBtWO86UF0ap6ozGXJk2WNiRUlCPFir66lzdm/SLSuK7EUdPz8f1z29Skq6F1fXg8+5UVR6bszncP4Tn4KUkkdJ8UFCY1zR1i8RmL/qQL3rlei4THG7OODlnKko4oI01kd3CaM08Ia18kC3GNoVaO9iDh+hWxSyTXFABXoau7Q6q9OxYg/OVEMw6jdbtSrJ9cBcewGmaZmg+bvkUnUUaGr+ZfnMH45Ivevl61hMcXsxYLFTu1hTm2zViCp7u0o5l+2PSUh9bDj6FgYypufBDhqK2+oXkiuHFHR3zfj+9PtA8oR0xnqX8qn+sx3bFODSbbF0X8EUvWQ8jBIcjo5bRmLOljDNtcqNtOe756h3l0VhKa9hDd2l1eqmsnh0MNMT/Cqnx6BInumhLT8luljzQ53RiJeA/0dxe5NK0o2fA1+GLXr6eNQWHNUOJssQaTRlGpLHKL9fD+IrQzTOMZS9fNQD4AnRNVxvTdjC+fJdcDDWQcyB00B0t9BDwTxXgaAfzDZ/DBXzRnfWMFRwuNqocOmX6OKNkY63h5n/fFcB28McVHqnXZVI27K0i4rDLNE9lDKV/rT+udVbD8dFFu2GGZ8mOt0kAXcoX3ZkIWVtw+MNf5NjR2FbivROHmhV1/pj2egv/fMGIOWTIWrV3Av8N9imV9IWml36H6cUjqEWNv9aNc+veb2sH46PRaHSuMBxvtW+twxctq0z+QsHhux8Q7rCY4Ct8lqsx7c6Sy0dl5T89rIeEuZKoVctIk1hNpfavER6yyH1Vvm3MbsUHy4ab4hWr/OZPcsRBphnaV65/ZcdYPNNwsjN/djlf9NqCw9U5ExCPcdhKxUgLSmfROpLp4WSUr8ojdwbncbvCf+a/YzRaEc6QOvXcGO256TXc5Lab9POvB+AWY7PigWYjzhifbovuunzRawsO24ZqQQAqguBtmpmPB7ysXJfyDDaV/aPGillgz1MdQg4u5MYaEtBNNHFjkRlSpd65lp4hd2AVPTfbV7FGpyIOfmNc/XVsPfg7vzaS/3nkvLL593ANLvMuRMGpQIhiF7kUEW9QDpAUbTWYBcbp4WpacHHY1aacqQyjGZS9HI3yCBT9kUZJhVOD+zUDvEH9ddR11fzPcTDQ5TlgB0KwqdXSavk9BC0pKp0WmcuowSw07VXmXC5guzSa4p0UvRw2lbDiYUx0ExJJRzWzi6Gm8cnEkfXXsdcG/M/jAJa0+bmCgdmQ9CYlNlSYZOKixmRsgiFxkrmW4l3KdFKv1DM8tk6WxPYJZhUUzcd8Kdtgrw/gkfXXDT7+avmfVak32qhtkg6NVdUS5wgkru1YzIkSduTW1FDwVWV3JQVJVuieTc0y4iDpFwc7/BvSalvKdQM8sv662cevz/+8sQVnjVAT0W2wLllw1JiMhJRxgDjCjLQsOzSFSgZqx7lAW1JW0e03yAD3asC+GD3NbQhbe+mN5GXH1F83KDOM4n/e5JIuH4NpdQARrFPBVptUNcjj4cVMcFSRTE2NpR1LEYbYMmfWpXgP9KejaPsLUhuvLCsVXznAG9dfx9SR1ud/3hZdCLHb1GMdPqRJgqDmm76mHbvOXDtiO2QPUcKo/TWkQ0i2JFXpBoo7vij1i1Lp3ADAo+qvG3V0rM//vFnnTE4hxd5Ka/Cor5YEdsLVJyKtDgVoHgtW11pWSjolPNMnrlrVj9Fv2Qn60twMwKPqr+N/wvr8z5tZcDsDrv06tkqyzESM85Ycv6XBWA2birlNCXrI6VbD2lx2L0vQO0QVTVVLH4SE67fgsfVXv8n7sz7/85Z7cMtbE6f088wSaR4kCkCm10s6pKbJhfqiUNGLq+0gLWC6eUAZFPnLjwqtKd8EwGvWX59t7iPW4X/eAN1svgRVSY990YZg06BD1ohLMtyFTI4pKTJsS9xREq9EOaPWiO2gpms7397x6nQJkbh+Fz2q/rqRROX6/M8bJrqlVW4l6JEptKeUFuMYUbtCQ7CIttpGc6MY93x1r1vgAnRXvY5cvwWPqb9uWQm+lP95QxdNMeWhOq1x0Db55C7GcUv2ZUuN6n8iKzsvOxibC//Yfs9Na8r2Rlz02vXXDT57FP/zJi66/EJSmsJKa8QxnoqW3VLQ+jZVUtJwJ8PNX1NQCwfNgdhhHD9on7PdRdrdGPF28rJr1F+3LBdeyv+8yYfLoMYet1vX4upNAjVvwOUWnlNXJXlkzk5Il6kqeoiL0C07qno+/CYBXq/+utlnsz7/Mzvy0tmI4zm4ag23PRN3t/CWryoUVJGm+5+K8RJ0V8Hc88/XHUX/HfiAq7t+BH+x6v8t438enWmdJwFA6ZINriLGKv/95f8lT9/FnyA1NMVEvQyaXuu+gz36f/DD73E4pwqpLcvm/o0Vle78n//+L/NPvoefp1pTJye6e4A/D082FERa5/opeH9zpvh13cNm19/4v/LDe5xMWTi8I0Ta0qKlK27AS/v3/r+/x/2GO9K2c7kVMonDpq7//jc5PKCxeNPpFVzaRr01wF8C4Pu76hXuX18H4LduTr79guuFD3n5BHfI+ZRFhY8w29TYhbbLi/bvBdqKE4fUgg1pBKnV3FEaCWOWyA+m3WpORZr/j+9TKJtW8yBTF2/ZEODI9/QavHkVdGFp/Pjn4Q+u5hXapsP5sOH+OXXA1LiKuqJxiMNbhTkbdJTCy4llEt6NnqRT4dhg1V3nbdrm6dYMecA1yTOL4PWTE9L5VzPFlLBCvlG58AhehnN4uHsAYinyJ+AZ/NkVvELbfOBUuOO5syBIEtiqHU1k9XeISX5bsimrkUUhnGDxourN8SgUsCZVtKyGbyGzHXdjOhsAvOAswSRyIBddRdEZWP6GZhNK/yjwew9ehBo+3jEADu7Ay2n8mDc+TS7awUHg0OMzR0LABhqLD4hJEh/BEGyBdGlSJoXYXtr+3HS4ijzVpgi0paWXtdruGTknXBz+11qT1Q2inxaTzQCO46P3lfLpyS4fou2PH/PupwZgCxNhGlj4IvUuWEsTkqMWm6i4xCSMc9N1RDQoCVcuGItJ/MRWefais+3synowi/dESgJjkilnWnBTGvRWmaw8oR15257t7CHmCf8HOn7cwI8+NQBXMBEmAa8PMRemrNCEhLGEhDQKcGZWS319BX9PFBEwGTbRBhLbDcaV3drFcDqk5kCTd2JF1Wp0HraqBx8U0wwBTnbpCadwBA/gTH/CDrcCs93LV8E0YlmmcyQRQnjBa8JESmGUfIjK/7fkaDJpmD2QptFNVJU1bbtIAjjWQizepOKptRjbzR9Kag6xZmMLLjHOtcLT3Tx9o/0EcTT1XN3E45u24AiwEypDJXihKjQxjLprEwcmRKclaDNZCVqr/V8mYWyFADbusiY5hvgFoU2vio49RgJLn5OsReRFN6tabeetiiy0V7KFHT3HyZLx491u95sn4K1QQSPKM9hNT0wMVvAWbzDSVdrKw4zRjZMyJIHkfq1VAVCDl/bUhNKlGq0zGr05+YAceXVPCttVk0oqjVwMPt+BBefx4yPtGVkUsqY3CHDPiCM5ngupUwCdbkpd8kbPrCWHhkmtIKLEetF2499eS1jZlIPGYnlcPXeM2KD9vLS0bW3ktYNqUllpKLn5ZrsxlIzxvDu5eHxzGLctkZLEY4PgSOg2IUVVcUONzUDBEpRaMoXNmUc0tFZrTZquiLyKxrSm3DvIW9Fil+AkhXu5PhEPx9mUNwqypDvZWdKlhIJQY7vn2OsnmBeOWnYZ0m1iwbbw1U60by5om47iHRV6fOgzjMf/DAZrlP40Z7syxpLK0lJ0gqaAK1c2KQKu7tabTXkLFz0sCftuwX++MyNeNn68k5Buq23YQhUh0SNTJa1ioQ0p4nUG2y0XilF1JqODqdImloPS4Bp111DEWT0jJjVv95uX9BBV7eB3bUWcu0acSVM23YZdd8R8UbQUxJ9wdu3oMuhdt929ME+mh6JXJ8di2RxbTi6TbrDquqV4aUKR2iwT6aZbyOwEXN3DUsWr8Hn4EhwNyHuXHh7/pdaUjtR7vnDh/d8c9xD/s5f501eQ1+CuDiCvGhk1AN/4Tf74RfxPwD3toLarR0zNtsnPzmS64KIRk861dMWCU8ArasG9T9H0ZBpsDGnjtAOM2+/LuIb2iIUGXNgl5ZmKD/Tw8TlaAuihaFP5yrw18v4x1898zIdP+DDAX1bM3GAMvPgRP/cJn3zCW013nrhHkrITyvYuwOUkcHuKlRSW5C6rzIdY4ppnF7J8aAJbQepgbJYBjCY9usGXDKQxq7RZfh9eg5d1UHMVATRaD/4BHK93/1iAgYZ/+jqPn8Dn4UExmWrpa3+ZOK6MvM3bjwfzxNWA2dhs8+51XHSPJiaAhGSpWevEs5xHLXcEGFXYiCONySH3fPWq93JIsBiSWvWyc3CAN+EcXoT7rCSANloPPoa31rt/5PUA/gp8Q/jDD3hyrjzlR8VkanfOvB1XPubt17vzxAfdSVbD1pzAnfgyF3ycadOTOTXhpEUoLC1HZyNGW3dtmjeXgr2r56JNmRwdNNWaQVBddd6rh4MhviEB9EFRD/7RGvePvCbwAL4Mx/D6M541hHO4D3e7g6PafdcZVw689z7NGTwo5om7A8sPhccT6qKcl9NJl9aM/9kX+e59Hh1yPqGuCCZxuITcsmNaJ5F7d0q6J3H48TO1/+M57085q2icdu2U+W36Ldllz9Agiv4YGljoEN908EzvDOrBF98/vtJwCC/BF2AG75xxEmjmMIcjxbjoaxqOK3/4hPOZzhMPBpYPG44CM0dTVm1LjLtUWWVz1Bcf8tEx0zs8O2A2YVHRxKYOiy/aOVoAaMu0i7ubu43njjmd4ibMHU1sIDHaQNKrZND/FZYdk54oCXetjq7E7IVl9eAL7t+oHnwXXtLx44czzoRFHBztYVwtH1d+NOMkupZ5MTM+gUmq90X+Bh9zjRlmaQ+m7YMqUL/veemcecAtOJ0yq1JnVlN27di2E0+Klp1tAJ4KRw1eMI7aJjsO3R8kPSI3fUFXnIOfdQe86sIIVtWDL7h//Ok6vj8vwDk08NEcI8zz7OhBy+WwalzZeZ4+0XniRfst9pAJqQHDGLzVQ2pheZnnv1OWhwO43/AgcvAEXEVVpa4db9sGvNK8wjaENHkfFQ4Ci5i7dqnQlPoLQrHXZDvO3BIXZbJOBrOaEbML6sFL798I4FhKihjHMsPjBUZYCMFr6nvaArxqXPn4lCa+cHfSa2cP27g3Z3ziYTRrcbQNGLQmGF3F3cBdzzzX7AILx0IB9rbwn9kx2G1FW3Inic+ZLIsVvKR8Zwfj0l1fkqo8LWY1M3IX14OX3r9RKTIO+d9XzAI8qRPGPn/4NC2n6o4rN8XJ82TOIvuVA8zLKUHRFgBCetlDZlqR1gLKjS39xoE7Bt8UvA6BxuEDjU3tFsEijgA+615tmZkXKqiEENrh41iLDDZNq4pKTWR3LZfnos81LOuNa15cD956vLMsJd1rqYp51gDUQqMYm2XsxnUhD2jg1DM7SeuJxxgrmpfISSXVIJIS5qJJSvJPEQ49DQTVIbYWJ9QWa/E2+c/oPK1drmC7WSfJRNKBO5Yjvcp7Gc3dmmI/Xh1kDTEuiSnWqQf37h+fTMhGnDf6dsS8SQfQWlqqwXXGlc/PEZ/SC5mtzIV0nAshlQdM/LvUtYutrEZ/Y+EAFtq1k28zQhOwLr1AIeANzhF8t9qzTdZf2qRKO6MWE9ohBYwibbOmrFtNmg3mcS+tB28xv2uKd/agYCvOP+GkSc+0lr7RXzyufL7QbkUpjLjEWFLqOIkAGu2B0tNlO9Eau2W1qcOUvVRgKzypKIQZ5KI3q0MLzqTNRYqiZOqmtqloIRlmkBHVpHmRYV6/HixbO6UC47KOFJnoMrVyr7wYz+SlW6GUaghYbY1I6kkxA2W1fSJokUdSh2LQ1GAimRGm0MT+uu57H5l7QgOWxERpO9moLRPgTtquWCfFlGlIjQaRly9odmzMOWY+IBO5tB4sW/0+VWGUh32qYk79EidWKrjWuiLpiVNGFWFRJVktyeXWmbgBBzVl8anPuXyNJlBJOlKLTgAbi/EYHVHxWiDaVR06GnHQNpJcWcK2jJtiCfG2sEHLzuI66sGrMK47nPIInPnu799935aOK2cvmvubrE38ZzZjrELCmXM2hM7UcpXD2oC3+ECVp7xtIuxptJ0jUr3sBmBS47TVxlvJ1Sqb/E0uLdvLj0lLr29ypdd/eMX3f6lrxGlKwKQxEGvw0qHbkbwrF3uHKwVENbIV2wZ13kNEF6zD+x24aLNMfDTCbDPnEikZFyTNttxWBXDaBuM8KtI2rmaMdUY7cXcUPstqTGvBGSrFWIpNMfbdea990bvAOC1YX0qbc6smDS1mPxSJoW4fwEXvjMmhlijDRq6qale6aJEuFGoppYDoBELQzLBuh/mZNx7jkinv0EtnUp50lO9hbNK57lZaMAWuWR5Yo9/kYwcYI0t4gWM47Umnl3YmpeBPqSyNp3K7s2DSAS/39KRuEN2bS4xvowV3dFRMx/VFcp2Yp8w2nTO9hCXtHG1kF1L4KlrJr2wKfyq77R7MKpFKzWlY9UkhYxyHWW6nBWPaudvEAl3CGcNpSXPZ6R9BbBtIl6cHL3gIBi+42CYXqCx1gfGWe7Ap0h3luyXdt1MKy4YUT9xSF01G16YEdWsouW9mgDHd3veyA97H+Ya47ZmEbqMY72oPztCGvK0onL44AvgC49saZKkWRz4veWljE1FHjbRJaWv6ZKKtl875h4CziFCZhG5rx7tefsl0aRT1bMHZjm8dwL/6u7wCRysaQblQoG5yAQN5zpatMNY/+yf8z+GLcH/Qn0iX2W2oEfXP4GvwQHuIL9AYGnaO3zqAX6946nkgqZNnUhx43DIdQtMFeOPrgy/y3Yd85HlJWwjLFkU3kFwq28xPnuPhMWeS+tDLV9Otllq7pQCf3uXJDN9wFDiUTgefHaiYbdfi3b3u8+iY6TnzhgehI1LTe8lcd7s1wJSzKbahCRxKKztTLXstGAiu3a6rPuQs5pk9TWAan5f0BZmGf7Ylxzzk/A7PAs4QPPPAHeFQ2hbFHszlgZuKZsJcUmbDC40sEU403cEjczstOEypa+YxevL4QBC8oRYqWdK6b7sK25tfE+oDZgtOQ2Jg8T41HGcBE6fTWHn4JtHcu9S7uYgU5KSCkl/mcnq+5/YBXOEr6lCUCwOTOM1taOI8mSxx1NsCXBEmLKbMAg5MkwbLmpBaFOPrNSlO2HnLiEqW3tHEwd8AeiQLmn+2gxjC3k6AxREqvKcJbTEzlpLiw4rNZK6oJdidbMMGX9FULKr0AkW+2qDEPBNNm5QAt2Ik2nftNWHetubosHLo2nG4vQA7GkcVCgVCgaDixHqo9UUn1A6OshapaNR/LPRYFV8siT1cCtJE0k/3WtaNSuUZYKPnsVIW0xXWnMUxq5+En4Kvw/MqQmVXnAXj9Z+9zM98zM/Agy7F/qqj2Nh67b8HjFnPP3iBn/tkpdzwEJX/whIcQUXOaikeliCRGUk7tiwF0rItwMEhjkZ309hikFoRAmLTpEXWuHS6y+am/KB/fM50aLEhGnSMwkpxzOov4H0AvgovwJ1iGzDLtJn/9BU+fAINfwUe6FHSLhu83viV/+/HrOePX+STT2B9uWGbrMHHLldRBlhS/CJQmcRxJFqZica01XixAZsYiH1uolZxLrR/SgxVIJjkpQP4PE9sE59LKLr7kltSBogS5tyszzH8Fvw8/AS8rNOg0xUS9fIaHwb+6et8Q/gyvKRjf5OusOzGx8evA/BP4IP11uN/grca5O0lcsPLJ5YjwI4QkJBOHa0WdMZYGxPbh2W2nR9v3WxEWqgp/G3+6VZbRLSAAZ3BhdhAaUL33VUSw9yjEsvbaQ9u4A/gGXwZXoEHOuU1GSj2chf+Mo+f8IcfcAxfIKVmyunRbYQVnoevwgfw3TXXcw++xNuP4fhyueEUNttEduRVaDttddoP0eSxLe2LENk6itYxlrxBNBYrNNKSQmeaLcm9c8UsaB5WyO6675yyQIAWSDpBVoA/gxmcwEvwoDv0m58UE7gHn+fJOa8/Ywan8EKRfjsopF83eCglX/Sfr7OeaRoQfvt1CGvIDccH5BCvw1sWIzRGC/66t0VTcLZQZtm6PlAasbOJ9iwWtUo7biktTSIPxnR24jxP1ZKaqq+2RcXM9OrBAm/AAs7hDJ5bNmGb+KIfwCs8a3jnjBrOFeMjHSCdbKr+2uOLfnOd9eiA8Hvvwwq54VbP2OqwkB48Ytc4YEOiH2vTXqodabfWEOzso4qxdbqD5L6tbtNPECqbhnA708DZH4QOJUXqScmUlks7Ot6FBuZw3n2mEbaUX7kDzxHOOQk8nKWMzAzu6ZZ8sOFw4RK+6PcuXo9tB4SbMz58ApfKDXf3szjNIIbGpD5TKTRxGkEMLjLl+K3wlWXBsCUxIDU+jbOiysESqAy1MGUJpXgwbTWzNOVEziIXZrJ+VIztl1PUBxTSo0dwn2bOmfDRPD3TRTGlfbCJvO9KvuhL1hMHhB9wPuPRLGHcdOWG2xc0U+5bQtAJT0nRTewXL1pgk2+rZAdeWmz3jxAqfNQQdzTlbF8uJ5ecEIWvTkevAHpwz7w78QujlD/Lr491bD8/1vhM2yrUQRrWXNQY4fGilfctMWYjL72UL/qS9eiA8EmN88nbNdour+PBbbAjOjIa4iBhfFg6rxeKdEGcL6p3EWR1Qq2Qkhs2DrnkRnmN9tG2EAqmgPw6hoL7Oza7B+3SCrR9tRftko+Lsf2F/mkTndN2LmzuMcKTuj/mX2+4Va3ki16+nnJY+S7MefpkidxwnV+4wkXH8TKnX0tsYzYp29DOOoSW1nf7nTh2akYiWmcJOuTidSaqESrTYpwjJJNVGQr+rLI7WsqerHW6Kp/oM2pKuV7T1QY9gjqlZp41/WfKpl56FV/0kvXQFRyeQ83xaTu5E8p5dNP3dUF34ihyI3GSpeCsywSh22ZJdWto9winhqifb7VRvgktxp13vyjrS0EjvrRfZ62uyqddSWaWYlwTPAtJZ2oZ3j/Sgi/mi+6vpzesfAcWNA0n8xVyw90GVFGuZjTXEQy+6GfLGLMLL523f5E0OmxVjDoOuRiH91RKU+vtoCtH7TgmvBLvtFXWLW15H9GTdVw8ow4IlRLeHECN9ym1e9K0I+Cbnhgv4Yu+aD2HaQJ80XDqOzSGAV4+4yCqBxrsJAX6ZTIoX36QnvzhhzzMfFW2dZVLOJfo0zbce5OvwXMFaZ81mOnlTVXpDZsQNuoYWveketKb5+6JOOsgX+NTm7H49fUTlx+WLuWL7qxnOFh4BxpmJx0p2gDzA/BUARuS6phR+pUsY7MMboAHx5xNsSVfVZcYSwqCKrqon7zM+8ecCkeS4nm3rINuaWvVNnMRI1IRpxTqx8PZUZ0Br/UEduo3B3hNvmgZfs9gQPj8vIOxd2kndir3awvJ6BLvoUuOfFWNYB0LR1OQJoUySKb9IlOBx74q1+ADC2G6rOdmFdJcD8BkfualA+BdjOOzP9uUhGUEX/TwhZsUduwRr8wNuXKurCixLBgpQI0mDbJr9dIqUuV+92ngkJZ7xduCk2yZKbfWrH1VBiTg9VdzsgRjW3CVXCvAwDd+c1z9dWw9+B+8MJL/eY15ZQ/HqvTwVdsZn5WQsgRRnMaWaecu3jFvMBEmgg+FJFZsnSl0zjB9OqPYaBD7qmoVyImFvzi41usesV0julaAR9dfR15Xzv9sEruRDyk1nb+QaLU67T885GTls6YgcY+UiMa25M/pwGrbCfzkvR3e0jjtuaFtnwuagHTSb5y7boBH119HXhvwP487jJLsLJ4XnUkHX5sLbS61dpiAXRoZSCrFJ+EjpeU3puVfitngYNo6PJrAigKktmwjyQdZpfq30mmtulaAx9Zfx15Xzv+cyeuiBFUs9zq8Kq+XB9a4PVvph3GV4E3y8HENJrN55H1X2p8VyqSKwVusJDKzXOZzplWdzBUFK9e+B4+uv468xvI/b5xtSAkBHQaPvtqWzllVvEOxPbuiE6+j2pvjcKsbvI7txnRErgfH7LdXqjq0IokKzga14GzQ23SSbCQvO6r+Or7SMIr/efOkkqSdMnj9mBx2DRsiY29Uj6+qK9ZrssCKaptR6HKURdwUYeUWA2kPzVKQO8ku2nU3Anhs/XWkBx3F/7wJtCTTTIKftthue1ty9xvNYLY/zo5KSbIuKbXpbEdSyeRyYdAIwKY2neyoc3+k1XUaufYga3T9daMUx/r8z1s10ITknIO0kuoMt+TB8jK0lpayqqjsJ2qtXAYwBU932zinimgmd6mTRDnQfr88q36NAI+tv24E8Pr8zxtasBqx0+xHH9HhlrwsxxNUfKOHQaZBITNf0uccj8GXiVmXAuPEAKSdN/4GLHhs/XWj92dN/uetNuBMnVR+XWDc25JLjo5Mg5IZIq226tmCsip2zZliL213YrTlL2hcFjpCduyim3M7/eB16q/blQsv5X/esDRbtJeabLIosWy3ycavwLhtxdWzbMmHiBTiVjJo6lCLjXZsi7p9PEPnsq6X6wd4bP11i0rD5fzPm/0A6brrIsllenZs0lCJlU4abakR59enZKrKe3BZihbTxlyZ2zl1+g0wvgmA166/bhwDrcn/7Ddz0eWZuJvfSESug6NzZsox3Z04FIxz0mUjMwVOOVTq1CQ0AhdbBGVdjG/CgsfUX7esJl3K/7ytWHRv683praW/8iDOCqWLLhpljDY1ZpzK75QiaZoOTpLKl60auHS/97oBXrv+umU9+FL+5+NtLFgjqVLCdbmj7pY5zPCPLOHNCwXGOcLquOhi8CmCWvbcuO73XmMUPab+ug3A6/A/78Bwe0bcS2+tgHn4J5pyS2WbOck0F51Vq3LcjhLvZ67p1ABbaL2H67bg78BfjKi/jr3+T/ABV3ilLmNXTI2SpvxWBtt6/Z//D0z/FXaGbSBgylzlsEGp+5//xrd4/ae4d8DUUjlslfIYS3t06HZpvfQtvv0N7AHWqtjP2pW08QD/FLy//da38vo8PNlKHf5y37Dxdfe/oj4kVIgFq3koLReSR76W/bx//n9k8jonZxzWTANVwEniDsg87sOSd/z7//PvMp3jQiptGVWFX2caezzAXwfgtzYUvbr0iozs32c3Uge7varH+CNE6cvEYmzbPZ9hMaYDdjK4V2iecf6EcEbdUDVUARda2KzO/JtCuDbNQB/iTeL0EG1JSO1jbXS+nLxtPMDPw1fh5+EPrgSEKE/8Gry5A73ui87AmxwdatyMEBCPNOCSKUeRZ2P6Myb5MRvgCHmA9ywsMifU+AYXcB6Xa5GibUC5TSyerxyh0j6QgLVpdyhfArRTTLqQjwe4HOD9s92D4Ap54odXAPBWLAwB02igG5Kkc+piN4lvODIFGAZgT+EO4Si1s7fjSR7vcQETUkRm9O+MXyo9OYhfe4xt9STQ2pcZRLayCV90b4D3jR0DYAfyxJ+eywg2IL7NTMXna7S/RpQ63JhWEM8U41ZyQGjwsVS0QBrEKLu8xwZsbi4wLcCT+OGidPIOCe1PiSc9Qt+go+vYqB7cG+B9d8cAD+WJPz0Am2gxXgU9IneOqDpAAXOsOltVuMzpdakJXrdPCzXiNVUpCeOos5cxnpQT39G+XVLhs1osQVvJKPZyNq8HDwd4d7pNDuWJPxVX7MSzqUDU6gfadKiNlUFTzLeFHHDlzO4kpa7aiKhBPGKwOqxsBAmYkOIpipyXcQSPlRTf+Tii0U3EJGaZsDER2qoB3h2hu0qe+NNwUooYU8y5mILbJe6OuX+2FTKy7bieTDAemaQyQ0CPthljSWO+xmFDIYiESjM5xKd6Ik5lvLq5GrQ3aCMLvmCA9wowLuWJb9xF59hVVP6O0CrBi3ZjZSNOvRy+I6klNVRJYRBaEzdN+imiUXQ8iVF8fsp+W4JXw7WISW7fDh7lptWkCwZ4d7QTXyBPfJMYK7SijjFppGnlIVJBJBYj7eUwtiP1IBXGI1XCsjNpbjENVpSAJ2hq2LTywEly3hUYazt31J8w2+aiLx3g3fohXixPfOMYm6zCGs9LVo9MoW3MCJE7R5u/WsOIjrqBoHUO0bJE9vxBpbhsd3+Nb4/vtPCZ4oZYCitNeYuC/8UDvDvy0qvkiW/cgqNqRyzqSZa/s0mqNGjtKOoTm14zZpUauiQgVfqtQiZjq7Q27JNaSK5ExRcrGCXO1FJYh6jR6CFqK7bZdQZ4t8g0rSlPfP1RdBtqaa9diqtzJkQ9duSryi2brQXbxDwbRUpFMBHjRj8+Nt7GDKgvph9okW7LX47gu0SpGnnFQ1S1lYldOsC7hYteR574ZuKs7Ei1lBsfdz7IZoxzzCVmmVqaSySzQbBVAWDek+N4jh9E/4VqZrJjPwiv9BC1XcvOWgO8275CVyBPvAtTVlDJfZkaZGU7NpqBogAj/xEHkeAuJihWYCxGN6e8+9JtSegFXF1TrhhLGP1fak3pebgPz192/8gB4d/6WT7+GdYnpH7hH/DJzzFiYPn/vjW0SgNpTNuPIZoAEZv8tlGw4+RLxy+ZjnKa5NdFoC7UaW0aduoYse6+bXg1DLg6UfRYwmhGEjqPvF75U558SANrElK/+MdpXvmqBpaXOa/MTZaa1DOcSiLaw9j0NNNst3c+63c7EKTpkvKHzu6bPbP0RkuHAVcbRY8ijP46MIbQeeT1mhA+5PV/inyDdQipf8LTvMXbwvoDy7IruDNVZKTfV4CTSRUYdybUCnGU7KUTDxLgCknqUm5aAW6/1p6eMsOYsphLzsHrE0Y/P5bQedx1F/4yPHnMB3/IOoTU9+BL8PhtjuFKBpZXnYNJxTuv+2XqolKR2UQgHhS5novuxVySJhBNRF3SoKK1XZbbXjVwWNyOjlqWJjrWJIy+P5bQedyldNScP+HZ61xKSK3jyrz+NiHG1hcOLL/+P+PDF2gOkekKGiNWKgJ+8Z/x8Iv4DdQHzcpZyF4v19I27w9/yPGDFQvmEpKtqv/TLiWMfn4sofMm9eAH8Ao0zzh7h4sJqYtxZd5/D7hkYPneDzl5idlzNHcIB0jVlQ+8ULzw/nc5/ojzl2juE0apD7LRnJxe04dMz2iOCFNtGFpTuXA5AhcTRo8mdN4kz30nVjEC4YTZQy4gpC7GlTlrePKhGsKKgeXpCYeO0MAd/GH7yKQUlXPLOasOH3FnSphjHuDvEu4gB8g66oNbtr6eMbFIA4fIBJkgayoXriw2XEDQPJrQeROAlY6aeYOcMf+IVYTU3XFlZufMHinGywaW3YLpObVBAsbjF4QJMsVUSayjk4voPsHJOQfPWDhCgDnmDl6XIRerD24HsGtw86RMHOLvVSHrKBdeVE26gKB5NKHzaIwLOmrqBWJYZDLhASG16c0Tn+CdRhWDgWXnqRZUTnPIHuMJTfLVpkoYy5CzylHVTGZMTwkGAo2HBlkQplrJX6U+uF1wZz2uwS1SQ12IqWaPuO4baZaEFBdukksJmkcTOm+YJSvoqPFzxFA/YUhIvWxcmSdPWTWwbAKVp6rxTtPFUZfKIwpzm4IoMfaYQLWgmlG5FME2gdBgm+J7J+rtS/XBbaVLsR7bpPQnpMFlo2doWaVceHk9+MkyguZNCJ1He+kuHTWyQAzNM5YSUg/GlTk9ZunAsg1qELVOhUSAK0LABIJHLKbqaEbHZLL1VA3VgqoiOKXYiS+HRyaEKgsfIqX64HYWbLRXy/qWoylIV9gudL1OWBNgBgTNmxA6b4txDT4gi3Ri7xFSLxtXpmmYnzAcWDZgY8d503LFogz5sbonDgkKcxGsWsE1OI+rcQtlgBBCSOKD1mtqYpIU8cTvBmAT0yZe+zUzeY92fYjTtGipXLhuR0ePoHk0ofNWBX+lo8Z7pAZDk8mEw5L7dVyZZoE/pTewbI6SNbiAL5xeygW4xPRuLCGbhcO4RIeTMFYHEJkYyEO9HmJfXMDEj/LaH781wHHZEtqSQ/69UnGpzH7LKIAZEDSPJnTesJTUa+rwTepI9dLJEawYV+ZkRn9g+QirD8vF8Mq0jFQ29js6kCS3E1+jZIhgPNanHdHFqFvPJLHqFwQqbIA4jhDxcNsOCCQLDomaL/dr5lyJaJU6FxPFjO3JOh3kVMcROo8u+C+jo05GjMF3P3/FuDLn5x2M04xXULPwaS6hBYki+MrMdZJSgPHlcB7nCR5bJ9Kr5ACUn9jk5kivdd8tk95SOGrtqu9lr2IhK65ZtEl7ZKrp7DrqwZfRUSN1el7+7NJxZbywOC8neNKTch5vsTEMNsoCCqHBCqIPRjIPkm0BjvFODGtto99rCl+d3wmHkW0FPdpZtC7MMcVtGFQjJLX5bdQ2+x9ypdc313uj8xlsrfuLgWXz1cRhZvJYX0iNVBRcVcmCXZs6aEf3RQF2WI/TcCbKmGU3IOoDJGDdDub0+hYckt6PlGu2BcxmhbTdj/klhccLGJMcqRjMJP1jW2ETqLSWJ/29MAoORluJ+6LPffBZbi5gqi5h6catQpmOT7/OFf5UorRpLzCqcMltBLhwd1are3kztrSzXO0LUbXRQcdLh/RdSZ+swRm819REDrtqzC4es6Gw4JCKlSnjYVpo0xeq33PrADbFLL3RuCmObVmPN+24kfa+AojDuM4umKe2QwCf6EN906HwjujaitDs5o0s1y+k3lgbT2W2i7FJdnwbLXhJUBq/9liTctSmFC/0OqUinb0QddTWamtjbHRFuWJJ6NpqZ8vO3fZJ37Db+2GkaPYLGHs7XTTdiFQJ68SkVJFVmY6McR5UycflNCsccHFaV9FNbR4NttLxw4pQ7wJd066Z0ohVbzihaxHVExd/ay04oxUKWt+AsdiQ9OUyZ2krzN19IZIwafSTFgIBnMV73ADj7V/K8u1MaY2sJp2HWm0f41tqwajEvdHWOJs510MaAqN4aoSiPCXtN2KSi46dUxHdaMquar82O1x5jqhDGvqmoE9LfxcY3zqA7/x3HA67r9ZG4O6Cuxu12/+TP+eLP+I+HErqDDCDVmBDO4larujNe7x8om2rMug0MX0rL1+IWwdwfR+p1TNTyNmVJ85ljWzbWuGv8/C7HD/izjkHNZNYlhZcUOKVzKFUxsxxN/kax+8zPWPSFKw80rJr9Tizyj3o1gEsdwgWGoxPezDdZ1TSENE1dLdNvuKL+I84nxKesZgxXVA1VA1OcL49dFlpFV5yJMhzyCmNQ+a4BqusPJ2bB+xo8V9u3x48VVIEPS/mc3DvAbXyoYr6VgDfh5do5hhHOCXMqBZUPhWYbWZECwVJljLgMUWOCB4MUuMaxGNUQDVI50TQ+S3kFgIcu2qKkNSHVoM0SHsgoZxP2d5HH8B9woOk4x5bPkKtAHucZsdykjxuIpbUrSILgrT8G7G5oCW+K0990o7E3T6AdW4TilH5kDjds+H64kS0mz24grtwlzDHBJqI8YJQExotPvoC4JBq0lEjjQkyBZ8oH2LnRsQ4Hu1QsgDTJbO8fQDnllitkxuVskoiKbRF9VwzMDvxHAdwB7mD9yCplhHFEyUWHx3WtwCbSMMTCUCcEmSGlg4gTXkHpZXWQ7kpznK3EmCHiXInqndkQjunG5kxTKEeGye7jWz9cyMR2mGiFQ15ENRBTbCp+Gh86vAyASdgmJq2MC6hoADQ3GosP0QHbnMHjyBQvQqfhy/BUbeHd5WY/G/9LK/8Ka8Jd7UFeNWEZvzPb458Dn8DGLOe3/wGL/4xP+HXlRt+M1PE2iLhR8t+lfgxsuh7AfO2AOf+owWhSZRYQbd622hbpKWKuU+XuvNzP0OseRDa+mObgDHJUSc/pKx31QdKffQ5OIJpt8GWjlgTwMc/w5MPCR/yl1XC2a2Yut54SvOtMev55Of45BOat9aWG27p2ZVORRvnEk1hqWMVUmqa7S2YtvlIpspuF1pt0syuZS2NV14mUidCSfzQzg+KqvIYCMljIx2YK2AO34fX4GWdu5xcIAb8MzTw+j/lyWM+Dw/gjs4GD6ehNgA48kX/AI7XXM/XAN4WHr+9ntywqoCakCqmKP0rmQrJJEErG2Upg1JObr01lKQy4jskWalKYfJ/EDLMpjNSHFEUAde2fltaDgmrNaWQ9+AAb8I5vKjz3L1n1LriB/BXkG/wwR9y/oRX4LlioHA4LzP2inzRx/DWmutRweFjeP3tNeSGlaE1Fde0OS11yOpmbIp2u/jF1n2RRZviJM0yBT3IZl2HWImKjQOxIyeU325b/qWyU9Moj1o07tS0G7qJDoGHg5m8yeCxMoEH8GU45tnrNM84D2l297DQ9t1YP7jki/7RmutRweEA77/HWXOh3HCxkRgldDQkAjNTMl2Iloc1qN5JfJeeTlyTRzxURTdn1Ixv2uKjs12AbdEWlBtmVdk2k7FFwj07PCZ9XAwW3dG+8xKzNFr4EnwBZpy9Qzhh3jDXebBpYcpuo4fQ44u+fD1dweEnHzI7v0xuuOALRUV8rXpFyfSTQYkhd7IHm07jpyhlkCmI0ALYqPTpUxXS+z4jgDj1Pflvmz5ecuItpIBxyTHpSTGWd9g1ApfD/bvwUhL4nT1EzqgX7cxfCcNmb3mPL/qi9SwTHJ49oj5ZLjccbTG3pRmlYi6JCG0mQrAt1+i2UXTZ2dv9IlQpN5naMYtviaXlTrFpoMsl3bOAFEa8sqPj2WCMrx3Yjx99qFwO59Aw/wgx+HlqNz8oZvA3exRDvuhL1jMQHPaOJ0+XyA3fp1OfM3qObEVdhxjvynxNMXQV4+GJyvOEFqeQBaIbbO7i63rpxCltdZShPFxkjM2FPVkn3TG+Rp9pO3l2RzFegGfxGDHIAh8SteR0C4HopXzRF61nheDw6TFN05Ebvq8M3VKKpGjjO6r7nhudTEGMtYM92HTDaR1FDMXJ1eThsbKfywyoWwrzRSXkc51flG3vIid62h29bIcFbTGhfV+faaB+ohj7dPN0C2e2lC96+XouFByen9AsunLDJZ9z7NExiUc0OuoYW6UZkIyx2YUR2z6/TiRjyKMx5GbbjLHvHuf7YmtKghf34LJfx63Yg8vrvN2zC7lY0x0tvKezo4HmGYDU+Gab6dFL+KI761lDcNifcjLrrr9LWZJctG1FfU1uwhoQE22ObjdfkSzY63CbU5hzs21WeTddH2BaL11Gi7lVdlxP1nkxqhnKhVY6knS3EPgVGg1JpN5cP/hivujOelhXcPj8HC/LyI6MkteVjlolBdMmF3a3DbsuAYhL44dxzthWSN065xxUd55Lmf0wRbOYOqH09/o9WbO2VtFdaMb4qBgtFJoT1SqoN8wPXMoXLb3p1PUEhxfnnLzGzBI0Ku7FxrKsNJj/8bn/H8fPIVOd3rfrklUB/DOeO+nkghgSPzrlPxluCMtOnDL4Yml6dK1r3vsgMxgtPOrMFUZbEUbTdIzii5beq72G4PD0DKnwjmBULUVFmy8t+k7fZ3pKc0Q4UC6jpVRqS9Umv8bxw35flZVOU1X7qkjnhZlsMbk24qQ6Hz7QcuL6sDC0iHHki96Uh2UdvmgZnjIvExy2TeJdMDZNSbdZyAHe/Yd1xsQhHiKzjh7GxQ4yqMPaywPkjMamvqrYpmO7Knad+ZQC5msCuAPWUoxrxVhrGv7a+KLXFhyONdTMrZ7ke23qiO40ZJUyzgYyX5XyL0mV7NiUzEs9mjtbMN0dERqwyAJpigad0B3/zRV7s4PIfXSu6YV/MK7+OrYe/JvfGMn/PHJe2fyUdtnFrKRNpXV0Y2559aWPt/G4BlvjTMtXlVIWCnNyA3YQBDmYIodFz41PvXPSa6rq9lWZawZ4dP115HXV/M/tnFkkrBOdzg6aP4pID+MZnTJ1SuuB6iZlyiox4HT2y3YBtkUKWooacBQUDTpjwaDt5poBHl1/HXltwP887lKKXxNUEyPqpGTyA699UqY/lt9yGdlUKra0fFWS+36iylVWrAyd7Uw0CZM0z7xKTOduznLIjG2Hx8cDPLb+OvK6Bv7n1DYci4CxUuRxrjBc0bb4vD3rN5Zz36ntLb83eVJIB8LiIzCmn6SMPjlX+yNlTjvIGjs+QzHPf60Aj62/jrzG8j9vYMFtm1VoRWCJdmw7z9N0t+c8cxZpPeK4aTRicS25QhrVtUp7U578chk4q04Wx4YoQSjFryUlpcQ1AbxZ/XVMknIU//OGl7Q6z9Zpxi0+3yFhSkjUDpnCIUhLWVX23KQ+L9vKvFKI0ZWFQgkDLvBoylrHNVmaw10zwCPrr5tlodfnf94EWnQ0lFRWy8pW9LbkLsyUVDc2NSTHGDtnD1uMtchjbCeb1mpxFP0YbcClhzdLu6lfO8Bj6q+bdT2sz/+8SZCV7VIxtt0DUn9L7r4cLYWDSXnseEpOGFuty0qbOVlS7NNzs5FOGJUqQpl2Q64/yBpZf90sxbE+//PGdZ02HSipCbmD6NItmQ4Lk5XUrGpDMkhbMm2ZVheNYV+VbUWTcv99+2NyX1VoafSuC+AN6q9bFIMv5X/eagNWXZxEa9JjlMwNWb00akGUkSoepp1/yRuuqHGbUn3UdBSTxBU6SEVklzWRUkPndVvw2PrrpjvxOvzPmwHc0hpmq82npi7GRro8dXp0KXnUQmhZbRL7NEVp1uuZmO45vuzKsHrktS3GLWXODVjw+vXXLYx4Hf7njRPd0i3aoAGX6W29GnaV5YdyDj9TFkakje7GHYzDoObfddHtOSpoi2SmzJHrB3hM/XUDDEbxP2/oosszcRlehWXUvzHv4TpBVktHqwenFo8uLVmy4DKLa5d3RtLrmrM3aMFr1183E4sewf+85VWeg1c5ag276NZrM9IJVNcmLEvDNaV62aq+14IAOGFsBt973Ra8Xv11YzXwNfmft7Jg2oS+XOyoC8/cwzi66Dhmgk38kUmP1CUiYWOX1bpD2zWXt2FCp7uq8703APAa9dfNdscR/M/bZLIyouVxqJfeWvG9Je+JVckHQ9+CI9NWxz+blX/KYYvO5n2tAP/vrlZ7+8/h9y+9qeB/Hnt967e5mevX10rALDWK//FaAT5MXdBXdP0C/BAes792c40H+AiAp1e1oH8HgH94g/Lttx1gp63op1eyoM/Bvw5/G/7xFbqJPcCXnmBiwDPb/YKO4FX4OjyCb289db2/Noqicw4i7N6TVtoz8tNwDH+8x/i6Ae7lmaQVENzJFb3Di/BFeAwz+Is9SjeQySpPqbLFlNmyz47z5a/AF+AYFvDmHqibSXTEzoT4Gc3OALaqAP4KPFUJ6n+1x+rGAM6Zd78bgJ0a8QN4GU614vxwD9e1Amy6CcskNrczLx1JIp6HE5UZD/DBHrFr2oNlgG4Odv226BodoryjGJ9q2T/AR3vQrsOCS0ctXZi3ruLlhpFDJYl4HmYtjQCP9rhdn4suySLKDt6wLcC52h8xPlcjju1fn+yhuw4LZsAGUuo2b4Fx2UwQu77uqRHXGtg92aN3tQCbFexc0uk93vhTXbct6y7MulLycoUljx8ngDMBg1tvJjAazpEmOtxlzclvj1vQf1Tx7QlPDpGpqgtdSKz/d9/hdy1vTfFHSmC9dGDZbLiezz7Ac801HirGZsWjydfZyPvHXL/Y8Mjzg8BxTZiuwKz4Eb8sBE9zznszmjvFwHKPIWUnwhqfVRcd4Ck0K6ate48m1oOfrX3/yOtvAsJ8zsPAM89sjnddmuLuDPjX9Bu/L7x7xpMzFk6nWtyQfPg278Gn4Aekz2ZgOmU9eJ37R14vwE/BL8G3aibCiWMWWDQ0ZtkPMnlcGeAu/Ag+8ZyecU5BPuy2ILD+sQqyZhAKmn7XZd+jIMTN9eBL7x95xVLSX4On8EcNlXDqmBlqS13jG4LpmGbkF/0CnOi3H8ETOIXzmnmtb0a16Tzxj1sUvQCBiXZGDtmB3KAefPH94xcUa/6vwRn80GOFyjEXFpba4A1e8KQfFF+259tx5XS4egYn8fQsLGrqGrHbztr+uByTahWuL1NUGbDpsnrwBfePPwHHIf9X4RnM4Z2ABWdxUBlqQ2PwhuDxoS0vvqB1JzS0P4h2nA/QgTrsJFn+Y3AOjs9JFC07CGWX1oNX3T/yHOzgDjwPn1PM3g9Jk9lZrMEpxnlPmBbjyo2+KFXRU52TJM/2ALcY57RUzjObbjqxVw++4P6RAOf58pcVsw9Daje3htriYrpDOonre3CudSe6bfkTEgHBHuDiyu5MCsc7BHhYDx7ePxLjqigXZsw+ijMHFhuwBmtoTPtOxOrTvYJDnC75dnUbhfwu/ZW9AgYd+peL68HD+0emKquiXHhWjJg/UrkJYzuiaL3E9aI/ytrCvAd4GcYZMCkSQxfUg3v3j8c4e90j5ZTPdvmJJGHnOCI2nHS8081X013pHuBlV1gB2MX1YNmWLHqqGN/TWmG0y6clJWthxNUl48q38Bi8vtMKyzzpFdSDhxZ5WBA5ZLt8Jv3895DduBlgbPYAj8C4B8hO68FDkoh5lydC4FiWvBOVqjYdqjiLv92t8yPDjrDaiHdUD15qkSURSGmXJwOMSxWAXYwr3zaAufJ66l+94vv3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/wHuD9tQd4f+0B3l97gPfXHuD9tQd4f+0B3l97gG8LwP8G/AL8O/A5OCq0Ys2KIdv/qOIXG/4mvFAMF16gZD+2Xvu/B8as5+8bfllWyg0zaNO5bfXj6vfhhwD86/Aq3NfRS9t9WPnhfnvCIw/CT8GLcFTMnpntdF/z9V+PWc/vWoIH+FL3Znv57PitcdGP4R/C34avw5fgRVUInCwbsn1yyA8C8zm/BH8NXoXnVE6wVPjdeCI38kX/3+Ct9dbz1pTmHFRu+Hm4O9Ch3clr99negxfwj+ER/DR8EV6B5+DuQOnTgUw5rnkY+FbNU3gNXh0o/JYTuWOvyBf9FvzX663HH/HejO8LwAl8Hl5YLTd8q7sqA3wbjuExfAFegQdwfyDoSkWY8swzEf6o4Qyewefg+cHNbqMQruSL/u/WWc+E5g7vnnEXgDmcDeSGb/F4cBcCgT+GGRzDU3hZYburAt9TEtHgbM6JoxJ+6NMzzTcf6c2bycv2+KK/f+l6LBzw5IwfqZJhA3M472pWT/ajKxnjv4AFnMEpnBTPND6s2J7qHbPAqcMK74T2mZ4VGB9uJA465It+/eL1WKhYOD7xHOkr1ajK7d0C4+ke4Hy9qXZwpgLr+Znm/uNFw8xQOSy8H9IzjUrd9+BIfenYaylf9FsXr8fBAadnPIEDna8IBcwlxnuA0/Wv6GAWPd7dDIKjMdSWueAsBj4M7TOd06qBbwDwKr7oleuxMOEcTuEZTHWvDYUO7aHqAe0Bbq+HEFRzOz7WVoTDQkVds7A4sIIxfCQdCefFRoIOF/NFL1mPab/nvOakSL/Q1aFtNpUb/nFOVX6gzyg/1nISyDfUhsokIzaBR9Kxm80s5mK+6P56il1jXic7nhQxsxSm3OwBHl4fFdLqi64nDQZvqE2at7cWAp/IVvrN6/BFL1mPhYrGMBfOi4PyjuSGf6wBBh7p/FZTghCNWGgMzlBbrNJoPJX2mW5mwZfyRffXo7OFi5pZcS4qZUrlViptrXtw+GQoyhDPS+ANjcGBNRiLCQDPZPMHuiZfdFpPSTcQwwKYdRNqpkjm7AFeeT0pJzALgo7g8YYGrMHS0iocy+YTm2vyRUvvpXCIpQ5pe666TJrcygnScUf/p0NDs/iAI/nqDHC8TmQT8x3NF91l76oDdQGwu61Z6E0ABv7uO1dbf/37Zlv+Zw/Pbh8f1s4Avur6657/+YYBvur6657/+YYBvur6657/+YYBvur6657/+aYBvuL6657/+VMA8FXWX/f8zzcN8BXXX/f8zzcNMFdbf93zP38KLPiK6697/uebtuArrr/u+Z9vGmCusP6653/+1FjwVdZf9/zPN7oHX339dc//fNMu+irrr3v+50+Bi+Zq6697/uebA/jz8Pudf9ht/fWv517J/XUzAP8C/BAeX9WCDrUpZ3/dEMBxgPcfbtTVvsYV5Yn32u03B3Ac4P3b8I+vxNBKeeL9dRMAlwO83959qGO78sT769oB7g3w/vGVYFzKE++v6wV4OMD7F7tckFkmT7y/rhHgpQO8b+4Y46XyxPvrugBeNcB7BRiX8sT767oAvmCA9woAHsoT76+rBJjLBnh3txOvkifeX1dswZcO8G6N7sXyxPvr6i340gHe3TnqVfLE++uKAb50gHcXLnrX8sR7gNdPRqwzwLu7Y/FO5Yn3AK9jXCMGeHdgxDuVJ75VAI8ljP7PAb3/RfjcZfePHBB+79dpfpH1CanN30d+mT1h9GqAxxJGM5LQeeQ1+Tb+EQJrElLb38VHQ94TRq900aMIo8cSOo+8Dp8QfsB8zpqE1NO3OI9Zrj1h9EV78PqE0WMJnUdeU6E+Jjyk/hbrEFIfeWbvId8H9oTRFwdZaxJGvziW0Hn0gqYB/wyZ0PwRlxJST+BOw9m77Amj14ii1yGM/txYQudN0qDzGe4EqfA/5GJCagsHcPaEPWH0esekSwmjRxM6b5JEcZ4ww50ilvAOFxBSx4yLW+A/YU8YvfY5+ALC6NGEzhtmyZoFZoarwBLeZxUhtY4rc3bKnjB6TKJjFUHzJoTOozF2YBpsjcyxDgzhQ1YRUse8+J4wenwmaylB82hC5w0zoRXUNXaRBmSMQUqiWSWkLsaVqc/ZE0aPTFUuJWgeTei8SfLZQeMxNaZSIzbII4aE1Nmr13P2hNHjc9E9guYNCZ032YlNwESMLcZiLQHkE4aE1BFg0yAR4z1h9AiAGRA0jyZ03tyIxWMajMPWBIsxYJCnlITU5ShiHYdZ94TR4wCmSxg9jtB5KyPGYzymAYexWEMwAPIsAdYdV6aObmNPGD0aYLoEzaMJnTc0Ygs+YDw0GAtqxBjkuP38bMRWCHn73xNGjz75P73WenCEJnhwyVe3AEe8TtKdJcYhBl97wuhNAObK66lvD/9J9NS75v17wuitAN5fe4D31x7g/bUHeH/tAd5fe4D3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/w/toDvAd4f/24ABzZ8o+KLsSLS+Pv/TqTb3P4hKlQrTGh+fbIBT0Axqznnb+L/V2mb3HkN5Mb/nEHeK7d4IcDld6lmDW/iH9E+AH1MdOw/Jlu2T1xNmY98sv4wHnD7D3uNHu54WUuOsBTbQuvBsPT/UfzNxGYzwkP8c+Yz3C+r/i6DcyRL/rZ+utRwWH5PmfvcvYEt9jLDS/bg0/B64DWKrQM8AL8FPwS9beQCe6EMKNZYJol37jBMy35otdaz0Bw2H/C2Smc7+WGB0HWDELBmOByA3r5QONo4V+DpzR/hFS4U8wMW1PXNB4TOqYz9urxRV++ntWCw/U59Ty9ebdWbrgfRS9AYKKN63ZokZVygr8GZ/gfIhZXIXPsAlNjPOLBby5c1eOLvmQ9lwkOy5x6QV1j5TYqpS05JtUgUHUp5toHGsVfn4NX4RnMCe+AxTpwmApTYxqMxwfCeJGjpXzRF61nbcHhUBPqWze9svwcHJ+S6NPscKrEjug78Dx8Lj3T8D4YxGIdxmJcwhi34fzZUr7olevZCw5vkOhoClq5zBPZAnygD/Tl9EzDh6kl3VhsHYcDEb+hCtJSvuiV69kLDm+WycrOTArHmB5/VYyP6jOVjwgGawk2zQOaTcc1L+aLXrKeveDwZqlKrw8U9Y1p66uK8dEzdYwBeUQAY7DbyYNezBfdWQ97weEtAKYQg2xJIkuveAT3dYeLGH+ShrWNwZgN0b2YL7qznr3g8JYAo5bQBziPjx7BPZ0d9RCQp4UZbnFdzBddor4XHN4KYMrB2qHFRIzzcLAHQZ5the5ovui94PCWAPefaYnxIdzRwdHCbuR4B+tbiy96Lzi8E4D7z7S0mEPd+eqO3cT53Z0Y8SV80XvB4Z0ADJi/f7X113f+7p7/+UYBvur6657/+YYBvur6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+VMA8FXWX/f8z58OgK+y/rrnf75RgLna+uue//lTA/CV1V/3/M837aKvvv6653++UQvmauuve/7nTwfAV1N/3fM/fzr24Cuuv+75nz8FFnxl9dc9//MOr/8/glixwRuUfM4AAAAASUVORK5CYII="},getSearchTexture:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII="}});var SSAARenderPass=function(e,t,r,n){Pass.call(this),this.scene=e,this.camera=t,this.sampleLevel=4,this.unbiased=!0,this.clearColor=void 0!==r?r:0,this.clearAlpha=void 0!==n?n:0,void 0===CopyShader&&console.error("SSAARenderPass relies on CopyShader");var i=CopyShader;this.copyUniforms=UniformsUtils.clone(i.uniforms),this.copyMaterial=new ShaderMaterial({uniforms:this.copyUniforms,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,premultipliedAlpha:!0,transparent:!0,blending:AdditiveBlending,depthTest:!1,depthWrite:!1}),this.camera2=new OrthographicCamera(-1,1,1,-1,0,1),this.scene2=new Scene,this.quad2=new Mesh(new PlaneBufferGeometry(2,2),this.copyMaterial),this.quad2.frustumCulled=!1,this.scene2.add(this.quad2)};SSAARenderPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:SSAARenderPass,dispose:function(){this.sampleRenderTarget&&(this.sampleRenderTarget.dispose(),this.sampleRenderTarget=null)},setSize:function(e,t){this.sampleRenderTarget&&this.sampleRenderTarget.setSize(e,t)},render:function(e,t,r){this.sampleRenderTarget||(this.sampleRenderTarget=new WebGLRenderTarget(r.width,r.height,{minFilter:LinearFilter,magFilter:LinearFilter,format:RGBAFormat}),this.sampleRenderTarget.texture.name="SSAARenderPass.sample");var n=SSAARenderPass.JitterVectors[Math.max(0,Math.min(this.sampleLevel,5))],i=e.autoClear;e.autoClear=!1;var o=e.getClearColor().getHex(),a=e.getClearAlpha(),s=1/n.length;this.copyUniforms.tDiffuse.value=this.sampleRenderTarget.texture;for(var l=r.width,u=r.height,c=0;c<n.length;c++){var h=n[c];this.camera.setViewOffset&&this.camera.setViewOffset(l,u,.0625*h[0],.0625*h[1],l,u);var p=s;if(this.unbiased)p+=1/32*((c+.5)/n.length-.5);this.copyUniforms.opacity.value=p,e.setClearColor(this.clearColor,this.clearAlpha),e.setRenderTarget(this.sampleRenderTarget),e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(this.renderToScreen?null:t),0===c&&(e.setClearColor(0,0),e.clear()),e.render(this.scene2,this.camera2)}this.camera.clearViewOffset&&this.camera.clearViewOffset(),e.autoClear=i,e.setClearColor(o,a)}}),SSAARenderPass.JitterVectors=[[[0,0]],[[4,4],[-4,-4]],[[-2,-6],[6,-2],[-6,2],[2,6]],[[1,-3],[-1,3],[5,1],[-3,-5],[-5,5],[-7,-1],[3,7],[7,-7]],[[1,1],[-1,-3],[-3,2],[4,-1],[-5,-2],[2,5],[5,3],[3,-5],[-2,6],[0,-7],[-4,-6],[-6,4],[-8,0],[7,-4],[6,7],[-7,-8]],[[-4,-7],[-7,-5],[-3,-5],[-5,-4],[-1,-4],[-2,-2],[-6,-1],[-4,0],[-7,1],[-1,2],[-6,3],[-3,3],[-7,6],[-3,6],[-5,7],[-1,7],[5,-7],[1,-6],[6,-5],[4,-4],[2,-3],[7,-2],[1,-1],[4,-1],[2,1],[6,2],[0,4],[4,4],[2,5],[7,5],[5,6],[3,7]]];var SSAOShader={defines:{PERSPECTIVE_CAMERA:1,KERNEL_SIZE:32},uniforms:{tDiffuse:{value:null},tNormal:{value:null},tDepth:{value:null},tNoise:{value:null},kernel:{value:null},cameraNear:{value:null},cameraFar:{value:null},resolution:{value:new Vector2},cameraProjectionMatrix:{value:new Matrix4},cameraInverseProjectionMatrix:{value:new Matrix4},kernelRadius:{value:8},minDistance:{value:.005},maxDistance:{value:.05}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform sampler2D tNormal;","uniform sampler2D tDepth;","uniform sampler2D tNoise;","uniform vec3 kernel[ KERNEL_SIZE ];","uniform vec2 resolution;","uniform float cameraNear;","uniform float cameraFar;","uniform mat4 cameraProjectionMatrix;","uniform mat4 cameraInverseProjectionMatrix;","uniform float kernelRadius;","uniform float minDistance;","uniform float maxDistance;","varying vec2 vUv;","#include <packing>","float getDepth( const in vec2 screenPosition ) {","\treturn texture2D( tDepth, screenPosition ).x;","}","float getLinearDepth( const in vec2 screenPosition ) {","\t#if PERSPECTIVE_CAMERA == 1","\t\tfloat fragCoordZ = texture2D( tDepth, screenPosition ).x;","\t\tfloat viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );","\t\treturn viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );","\t#else","\t\treturn texture2D( depthSampler, coord ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\t\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","\t#else","\t\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );","\t#endif","}","vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {","\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];","\tvec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );","\tclipPosition *= clipW; // unprojection.","\treturn ( cameraInverseProjectionMatrix * clipPosition ).xyz;","}","vec3 getViewNormal( const in vec2 screenPosition ) {","\treturn unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );","}","void main() {","\tfloat depth = getDepth( vUv );","\tfloat viewZ = getViewZ( depth );","\tvec3 viewPosition = getViewPosition( vUv, depth, viewZ );","\tvec3 viewNormal = getViewNormal( vUv );"," vec2 noiseScale = vec2( resolution.x / 4.0, resolution.y / 4.0 );","\tvec3 random = texture2D( tNoise, vUv * noiseScale ).xyz;","\tvec3 tangent = normalize( random - viewNormal * dot( random, viewNormal ) );","\tvec3 bitangent = cross( viewNormal, tangent );","\tmat3 kernelMatrix = mat3( tangent, bitangent, viewNormal );"," float occlusion = 0.0;"," for ( int i = 0; i < KERNEL_SIZE; i ++ ) {","\t\tvec3 sampleVector = kernelMatrix * kernel[ i ];","\t\tvec3 samplePoint = viewPosition + ( sampleVector * kernelRadius );","\t\tvec4 samplePointNDC = cameraProjectionMatrix * vec4( samplePoint, 1.0 );","\t\tsamplePointNDC /= samplePointNDC.w;","\t\tvec2 samplePointUv = samplePointNDC.xy * 0.5 + 0.5;","\t\tfloat realDepth = getLinearDepth( samplePointUv );","\t\tfloat sampleDepth = viewZToOrthographicDepth( samplePoint.z, cameraNear, cameraFar );","\t\tfloat delta = sampleDepth - realDepth;","\t\tif ( delta > minDistance && delta < maxDistance ) {","\t\t\tocclusion += 1.0;","\t\t}","\t}","\tocclusion = clamp( occlusion / float( KERNEL_SIZE ), 0.0, 1.0 );","\tgl_FragColor = vec4( vec3( 1.0 - occlusion ), 1.0 );","}"].join("\n")},SSAODepthShader={defines:{PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{value:null},cameraNear:{value:null},cameraFar:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDepth;","uniform float cameraNear;","uniform float cameraFar;","varying vec2 vUv;","#include <packing>","float getLinearDepth( const in vec2 screenPosition ) {","\t#if PERSPECTIVE_CAMERA == 1","\t\tfloat fragCoordZ = texture2D( tDepth, screenPosition ).x;","\t\tfloat viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );","\t\treturn viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );","\t#else","\t\treturn texture2D( depthSampler, coord ).x;","\t#endif","}","void main() {","\tfloat depth = getLinearDepth( vUv );","\tgl_FragColor = vec4( vec3( 1.0 - depth ), 1.0 );","}"].join("\n")},SSAOBlurShader={uniforms:{tDiffuse:{value:null},resolution:{value:new Vector2}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec2 resolution;","varying vec2 vUv;","void main() {","\tvec2 texelSize = ( 1.0 / resolution );","\tfloat result = 0.0;","\tfor ( int i = - 2; i <= 2; i ++ ) {","\t\tfor ( int j = - 2; j <= 2; j ++ ) {","\t\t\tvec2 offset = ( vec2( float( i ), float( j ) ) ) * texelSize;","\t\t\tresult += texture2D( tDiffuse, vUv + offset ).r;","\t\t}","\t}","\tgl_FragColor = vec4( vec3( result / ( 5.0 * 5.0 ) ), 1.0 );","}"].join("\n")},SSAOPass=function(e,t,r,n){Pass.call(this),this.width=void 0!==r?r:512,this.height=void 0!==n?n:512,this.clear=!0,this.camera=t,this.scene=e,this.kernelRadius=8,this.kernelSize=32,this.kernel=[],this.noiseTexture=null,this.output=0,this.minDistance=.005,this.maxDistance=.1,this.generateSampleKernel(),this.generateRandomKernelRotations();var i=new DepthTexture;i.type=UnsignedShortType,i.minFilter=NearestFilter,i.maxFilter=NearestFilter,this.beautyRenderTarget=new WebGLRenderTarget(this.width,this.height,{minFilter:LinearFilter,magFilter:LinearFilter,format:RGBAFormat,depthTexture:i,depthBuffer:!0}),this.normalRenderTarget=new WebGLRenderTarget(this.width,this.height,{minFilter:NearestFilter,magFilter:NearestFilter,format:RGBAFormat}),this.ssaoRenderTarget=new WebGLRenderTarget(this.width,this.height,{minFilter:LinearFilter,magFilter:LinearFilter,format:RGBAFormat}),this.blurRenderTarget=this.ssaoRenderTarget.clone(),void 0===SSAOShader&&console.error("SSAOPass: The pass relies on SSAOShader."),this.ssaoMaterial=new ShaderMaterial({defines:Object.assign({},SSAOShader.defines),uniforms:UniformsUtils.clone(SSAOShader.uniforms),vertexShader:SSAOShader.vertexShader,fragmentShader:SSAOShader.fragmentShader,blending:NoBlending}),this.ssaoMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.ssaoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.ssaoMaterial.uniforms.tDepth.value=this.beautyRenderTarget.depthTexture,this.ssaoMaterial.uniforms.tNoise.value=this.noiseTexture,this.ssaoMaterial.uniforms.kernel.value=this.kernel,this.ssaoMaterial.uniforms.cameraNear.value=this.camera.near,this.ssaoMaterial.uniforms.cameraFar.value=this.camera.far,this.ssaoMaterial.uniforms.resolution.value.set(this.width,this.height),this.ssaoMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssaoMaterial.uniforms.cameraInverseProjectionMatrix.value.getInverse(this.camera.projectionMatrix),this.normalMaterial=new MeshNormalMaterial,this.normalMaterial.blending=NoBlending,this.blurMaterial=new ShaderMaterial({defines:Object.assign({},SSAOBlurShader.defines),uniforms:UniformsUtils.clone(SSAOBlurShader.uniforms),vertexShader:SSAOBlurShader.vertexShader,fragmentShader:SSAOBlurShader.fragmentShader}),this.blurMaterial.uniforms.tDiffuse.value=this.ssaoRenderTarget.texture,this.blurMaterial.uniforms.resolution.value.set(this.width,this.height),this.depthRenderMaterial=new ShaderMaterial({defines:Object.assign({},SSAODepthShader.defines),uniforms:UniformsUtils.clone(SSAODepthShader.uniforms),vertexShader:SSAODepthShader.vertexShader,fragmentShader:SSAODepthShader.fragmentShader,blending:NoBlending}),this.depthRenderMaterial.uniforms.tDepth.value=this.beautyRenderTarget.depthTexture,this.depthRenderMaterial.uniforms.cameraNear.value=this.camera.near,this.depthRenderMaterial.uniforms.cameraFar.value=this.camera.far,this.copyMaterial=new ShaderMaterial({uniforms:UniformsUtils.clone(CopyShader.uniforms),vertexShader:CopyShader.vertexShader,fragmentShader:CopyShader.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1,blendSrc:DstColorFactor,blendDst:ZeroFactor,blendEquation:AddEquation,blendSrcAlpha:DstAlphaFactor,blendDstAlpha:ZeroFactor,blendEquationAlpha:AddEquation}),this.quadCamera=new OrthographicCamera(-1,1,1,-1,0,1),this.quadScene=new Scene,this.quad=new Mesh(new PlaneBufferGeometry(2,2),null),this.quadScene.add(this.quad),this.originalClearColor=new Color};SSAOPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:SSAOPass,dispose:function(){this.beautyRenderTarget.dispose(),this.normalRenderTarget.dispose(),this.ssaoRenderTarget.dispose(),this.blurRenderTarget.dispose(),this.quad.geometry.dispose(),this.normalMaterial.dispose(),this.blurMaterial.dispose(),this.copyMaterial.dispose(),this.depthRenderMaterial.dispose()},render:function(e,t){switch(e.setRenderTarget(this.beautyRenderTarget),e.clear(),e.render(this.scene,this.camera),this.renderOverride(e,this.normalMaterial,this.normalRenderTarget,7829503,1),this.ssaoMaterial.uniforms.kernelRadius.value=this.kernelRadius,this.ssaoMaterial.uniforms.minDistance.value=this.minDistance,this.ssaoMaterial.uniforms.maxDistance.value=this.maxDistance,this.renderPass(e,this.ssaoMaterial,this.ssaoRenderTarget),this.renderPass(e,this.blurMaterial,this.blurRenderTarget),this.output){case SSAOPass.OUTPUT.SSAO:this.copyMaterial.uniforms.tDiffuse.value=this.ssaoRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(e,this.copyMaterial,null);break;case SSAOPass.OUTPUT.Blur:this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(e,this.copyMaterial,null);break;case SSAOPass.OUTPUT.Beauty:this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(e,this.copyMaterial,null);break;case SSAOPass.OUTPUT.Depth:this.renderPass(e,this.depthRenderMaterial,null);break;case SSAOPass.OUTPUT.Normal:this.copyMaterial.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(e,this.copyMaterial,null);break;case SSAOPass.OUTPUT.Default:this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(e,this.copyMaterial,null),this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.copyMaterial.blending=CustomBlending,this.renderPass(e,this.copyMaterial,this.renderToScreen?null:t);break;default:console.warn("SSAOPass: Unknown output type.")}},renderPass:function(e,t,r,n,i){this.originalClearColor.copy(e.getClearColor());var o=e.getClearAlpha(),a=e.autoClear;e.setRenderTarget(r),e.autoClear=!1,void 0!==n&&null!==n&&(e.setClearColor(n),e.setClearAlpha(i||0),e.clear()),this.quad.material=t,e.render(this.quadScene,this.quadCamera),e.autoClear=a,e.setClearColor(this.originalClearColor),e.setClearAlpha(o)},renderOverride:function(e,t,r,n,i){this.originalClearColor.copy(e.getClearColor());var o=e.getClearAlpha(),a=e.autoClear;e.setRenderTarget(r),e.autoClear=!1,n=t.clearColor||n,i=t.clearAlpha||i,void 0!==n&&null!==n&&(e.setClearColor(n),e.setClearAlpha(i||0),e.clear()),this.scene.overrideMaterial=t,e.render(this.scene,this.camera),this.scene.overrideMaterial=null,e.autoClear=a,e.setClearColor(this.originalClearColor),e.setClearAlpha(o)},setSize:function(e,t){this.width=e,this.height=t,this.beautyRenderTarget.setSize(e,t),this.ssaoRenderTarget.setSize(e,t),this.normalRenderTarget.setSize(e,t),this.blurRenderTarget.setSize(e,t),this.ssaoMaterial.uniforms.resolution.value.set(e,t),this.ssaoMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssaoMaterial.uniforms.cameraInverseProjectionMatrix.value.getInverse(this.camera.projectionMatrix),this.blurMaterial.uniforms.resolution.value.set(e,t)},generateSampleKernel:function(){for(var e=this.kernelSize,t=this.kernel,r=0;r<e;r++){var n=new Vector3;n.x=2*Math.random()-1,n.y=2*Math.random()-1,n.z=Math.random(),n.normalize();var i=r/e;i=_Math.lerp(.1,1,i*i),n.multiplyScalar(i),t.push(n)}},generateRandomKernelRotations:function(){void 0===SimplexNoise&&console.error("SSAOPass: The pass relies on SimplexNoise.");for(var e=new SimplexNoise,t=new Float32Array(64),r=0;r<16;r++){var n=4*r,i=2*Math.random()-1,o=2*Math.random()-1,a=e.noise3d(i,o,0);t[n]=a,t[n+1]=a,t[n+2]=a,t[n+3]=1}this.noiseTexture=new DataTexture(t,4,4,RGBAFormat,FloatType),this.noiseTexture.wrapS=RepeatWrapping,this.noiseTexture.wrapT=RepeatWrapping,this.noiseTexture.needsUpdate=!0}}),SSAOPass.OUTPUT={Default:0,SSAO:1,Blur:2,Beauty:3,Depth:4,Normal:5};var TAARenderPass=function(e,t,r){void 0===SSAARenderPass&&console.error("TAARenderPass relies on SSAARenderPass"),SSAARenderPass.call(this,e,t,r),this.sampleLevel=0,this.accumulate=!1};TAARenderPass.JitterVectors=SSAARenderPass.JitterVectors,TAARenderPass.prototype=Object.assign(Object.create(SSAARenderPass.prototype),{constructor:TAARenderPass,render:function(e,t,r,n){if(!this.accumulate)return SSAARenderPass.prototype.render.call(this,e,t,r,n),void(this.accumulateIndex=-1);var i=TAARenderPass.JitterVectors[5];this.sampleRenderTarget||(this.sampleRenderTarget=new WebGLRenderTarget(r.width,r.height,this.params),this.sampleRenderTarget.texture.name="TAARenderPass.sample"),this.holdRenderTarget||(this.holdRenderTarget=new WebGLRenderTarget(r.width,r.height,this.params),this.holdRenderTarget.texture.name="TAARenderPass.hold"),this.accumulate&&-1===this.accumulateIndex&&(SSAARenderPass.prototype.render.call(this,e,this.holdRenderTarget,r,n),this.accumulateIndex=0);var o=e.autoClear;e.autoClear=!1;var a=1/i.length;if(this.accumulateIndex>=0&&this.accumulateIndex<i.length){this.copyUniforms.opacity.value=a,this.copyUniforms.tDiffuse.value=t.texture;for(var s=Math.pow(2,this.sampleLevel),l=0;l<s;l++){var u=i[this.accumulateIndex];if(this.camera.setViewOffset&&this.camera.setViewOffset(r.width,r.height,.0625*u[0],.0625*u[1],r.width,r.height),e.setRenderTarget(t),e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(this.sampleRenderTarget),0===this.accumulateIndex&&e.clear(),e.render(this.scene2,this.camera2),this.accumulateIndex++,this.accumulateIndex>=i.length)break}this.camera.clearViewOffset&&this.camera.clearViewOffset()}var c=this.accumulateIndex*a;c>0&&(this.copyUniforms.opacity.value=1,this.copyUniforms.tDiffuse.value=this.sampleRenderTarget.texture,e.setRenderTarget(t),e.clear(),e.render(this.scene2,this.camera2)),c<1&&(this.copyUniforms.opacity.value=1-c,this.copyUniforms.tDiffuse.value=this.holdRenderTarget.texture,e.setRenderTarget(t),0===c&&e.clear(),e.render(this.scene2,this.camera2)),e.autoClear=o}});var TexturePass=function(e,t){Pass.call(this),void 0===CopyShader&&console.error("TexturePass relies on CopyShader");var r=CopyShader;this.map=e,this.opacity=void 0!==t?t:1,this.uniforms=UniformsUtils.clone(r.uniforms),this.material=new ShaderMaterial({uniforms:this.uniforms,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,depthTest:!1,depthWrite:!1}),this.needsSwap=!1,this.camera=new OrthographicCamera(-1,1,1,-1,0,1),this.scene=new Scene,this.quad=new Mesh(new PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};TexturePass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:TexturePass,render:function(e,t,r,n,i){var o=e.autoClear;e.autoClear=!1,this.quad.material=this.material,this.uniforms.opacity.value=this.opacity,this.uniforms.tDiffuse.value=this.map,this.material.transparent=this.opacity<1,e.setRenderTarget(this.renderToScreen?null:r),this.clear&&e.clear(),e.render(this.scene,this.camera),e.autoClear=o}});var LuminosityHighPassShader={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{type:"t",value:null},luminosityThreshold:{type:"f",value:1},smoothWidth:{type:"f",value:1},defaultColor:{type:"c",value:new Color(0)},defaultOpacity:{type:"f",value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec3 defaultColor;","uniform float defaultOpacity;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec3 luma = vec3( 0.299, 0.587, 0.114 );","float v = dot( texel.xyz, luma );","vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );","float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );","gl_FragColor = mix( outputColor, texel, alpha );","}"].join("\n")},UnrealBloomPass=function(e,t,r,n){Pass.call(this),this.strength=void 0!==t?t:1,this.radius=r,this.threshold=n,this.resolution=void 0!==e?new Vector2(e.x,e.y):new Vector2(256,256),this.clearColor=new Color(0,0,0);var i={minFilter:LinearFilter,magFilter:LinearFilter,format:RGBAFormat};this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;var o=Math.round(this.resolution.x/2),a=Math.round(this.resolution.y/2);this.renderTargetBright=new WebGLRenderTarget(o,a,i),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(var s=0;s<this.nMips;s++){var l=new WebGLRenderTarget(o,a,i);l.texture.name="UnrealBloomPass.h"+s,l.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(l);var u=new WebGLRenderTarget(o,a,i);u.texture.name="UnrealBloomPass.v"+s,u.texture.generateMipmaps=!1,this.renderTargetsVertical.push(u),o=Math.round(o/2),a=Math.round(a/2)}void 0===LuminosityHighPassShader&&console.error("UnrealBloomPass relies on LuminosityHighPassShader");var c=LuminosityHighPassShader;this.highPassUniforms=UniformsUtils.clone(c.uniforms),this.highPassUniforms.luminosityThreshold.value=n,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new ShaderMaterial({uniforms:this.highPassUniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,defines:{}}),this.separableBlurMaterials=[];var h=[3,5,7,9,11];for(o=Math.round(this.resolution.x/2),a=Math.round(this.resolution.y/2),s=0;s<this.nMips;s++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(h[s])),this.separableBlurMaterials[s].uniforms.texSize.value=new Vector2(o,a),o=Math.round(o/2),a=Math.round(a/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new Vector3(1,1,1),new Vector3(1,1,1),new Vector3(1,1,1),new Vector3(1,1,1),new Vector3(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,void 0===CopyShader&&console.error("BloomPass relies on CopyShader");var p=CopyShader;this.copyUniforms=UniformsUtils.clone(p.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new ShaderMaterial({uniforms:this.copyUniforms,vertexShader:p.vertexShader,fragmentShader:p.fragmentShader,blending:AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new Color,this.oldClearAlpha=1,this.camera=new OrthographicCamera(-1,1,1,-1,0,1),this.scene=new Scene,this.basic=new MeshBasicMaterial,this.quad=new Mesh(new PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};UnrealBloomPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:UnrealBloomPass,dispose:function(){for(var e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose()},setSize:function(e,t){var r=Math.round(e/2),n=Math.round(t/2);this.renderTargetBright.setSize(r,n);for(var i=0;i<this.nMips;i++)this.renderTargetsHorizontal[i].setSize(r,n),this.renderTargetsVertical[i].setSize(r,n),this.separableBlurMaterials[i].uniforms.texSize.value=new Vector2(r,n),r=Math.round(r/2),n=Math.round(n/2)},render:function(e,t,r,n,i){this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha();var o=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),i&&e.context.disable(e.context.STENCIL_TEST),this.renderToScreen&&(this.quad.material=this.basic,this.basic.map=r.texture,e.setRenderTarget(null),e.clear(),e.render(this.scene,this.camera)),this.highPassUniforms.tDiffuse.value=r.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.quad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),e.render(this.scene,this.camera);for(var a=this.renderTargetBright,s=0;s<this.nMips;s++)this.quad.material=this.separableBlurMaterials[s],this.separableBlurMaterials[s].uniforms.colorTexture.value=a.texture,this.separableBlurMaterials[s].uniforms.direction.value=UnrealBloomPass.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[s]),e.clear(),e.render(this.scene,this.camera),this.separableBlurMaterials[s].uniforms.colorTexture.value=this.renderTargetsHorizontal[s].texture,this.separableBlurMaterials[s].uniforms.direction.value=UnrealBloomPass.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[s]),e.clear(),e.render(this.scene,this.camera),a=this.renderTargetsVertical[s];this.quad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),e.render(this.scene,this.camera),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,i&&e.context.enable(e.context.STENCIL_TEST),this.renderToScreen?(e.setRenderTarget(null),e.render(this.scene,this.camera)):(e.setRenderTarget(r),e.render(this.scene,this.camera)),e.setClearColor(this.oldClearColor,this.oldClearAlpha),e.autoClear=o},getSeperableBlurMaterial:function(e){return new ShaderMaterial({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new Vector2(.5,.5)},direction:{value:new Vector2(.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat fSigma = float(SIGMA);\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\t\t\t\t\t\tfloat x = float(i);\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\t\t\t\t\t\tweightSum += 2.0 * w;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})},getCompositeMaterial:function(e){return new ShaderMaterial({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D blurTexture1;\t\t\t\tuniform sampler2D blurTexture2;\t\t\t\tuniform sampler2D blurTexture3;\t\t\t\tuniform sampler2D blurTexture4;\t\t\t\tuniform sampler2D blurTexture5;\t\t\t\tuniform sampler2D dirtTexture;\t\t\t\tuniform float bloomStrength;\t\t\t\tuniform float bloomRadius;\t\t\t\tuniform float bloomFactors[NUM_MIPS];\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\t\t\t\t\t\t\t\tfloat lerpBloomFactor(const in float factor) { \t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\t\t\t\t}\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\t\t\t\t}"})}}),UnrealBloomPass.BlurDirectionX=new Vector2(1,0),UnrealBloomPass.BlurDirectionY=new Vector2(0,1);var PRNG=function(){this.seed=1,this.next=function(){return this.gen()/2147483647},this.nextRange=function(e,t){return e+(t-e)*this.next()},this.gen=function(){return this.seed=16807*this.seed%2147483647}},CSS2DObject=function(e){Object3D.call(this),this.element=e,this.element.style.position="absolute",this.addEventListener("removed",function(e){null!==this.element.parentNode&&this.element.parentNode.removeChild(this.element)})};CSS2DObject.prototype=Object.create(Object3D.prototype),CSS2DObject.prototype.constructor=CSS2DObject;var CSS2DRenderer=function(){var e,t,r,n;console.log("CSS2DRenderer",REVISION);var i=new Vector3,o=new Matrix4,a=new Matrix4,s={objects:new WeakMap},l=document.createElement("div");l.style.overflow="hidden",this.domElement=l,this.getSize=function(){return{width:e,height:t}},this.setSize=function(i,o){r=(e=i)/2,n=(t=o)/2,l.style.width=i+"px",l.style.height=o+"px"};var u=function(){var e=new Vector3,t=new Vector3;return function(r,n){return e.setFromMatrixPosition(r.matrixWorld),t.setFromMatrixPosition(n.matrixWorld),e.distanceToSquared(t)}}(),c=function(e){for(var t=function(e){var t=[];return e.traverse(function(e){e instanceof CSS2DObject&&t.push(e)}),t}(e).sort(function(e,t){return s.objects.get(e).distanceToCameraSquared-s.objects.get(t).distanceToCameraSquared}),r=t.length,n=0,i=t.length;n<i;n++)t[n].element.style.zIndex=r-n};this.render=function(e,t){e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),o.copy(t.matrixWorldInverse),a.multiplyMatrices(t.projectionMatrix,o),function e(t,o){if(t instanceof CSS2DObject){i.setFromMatrixPosition(t.matrixWorld),i.applyMatrix4(a);var c=t.element,h="translate(-50%,-50%) translate("+(i.x*r+r)+"px,"+(-i.y*n+n)+"px)";c.style.WebkitTransform=h,c.style.MozTransform=h,c.style.oTransform=h,c.style.transform=h;var p={distanceToCameraSquared:u(o,t)};s.objects.set(t,p),c.parentNode!==l&&l.appendChild(c)}for(var f=0,d=t.children.length;f<d;f++)e(t.children[f],o)}(e,t),c(e)}},CSS3DObject=function(e){Object3D.call(this),this.element=e,this.element.style.position="absolute",this.addEventListener("removed",function(){null!==this.element.parentNode&&this.element.parentNode.removeChild(this.element)})};CSS3DObject.prototype=Object.create(Object3D.prototype),CSS3DObject.prototype.constructor=CSS3DObject;var CSS3DSprite=function(e){CSS3DObject.call(this,e)};CSS3DSprite.prototype=Object.create(CSS3DObject.prototype),CSS3DSprite.prototype.constructor=CSS3DSprite;var CSS3DRenderer=function(){var e,t,r,n;console.log("CSS3DRenderer",REVISION);var i=new Matrix4,o={camera:{fov:0,style:""},objects:new WeakMap},a=document.createElement("div");a.style.overflow="hidden",this.domElement=a;var s=document.createElement("div");s.style.WebkitTransformStyle="preserve-3d",s.style.transformStyle="preserve-3d",a.appendChild(s);var l=/Trident/i.test(navigator.userAgent);function u(e){return Math.abs(e)<1e-10?0:e}function c(e){var t=e.elements;return"matrix3d("+u(t[0])+","+u(-t[1])+","+u(t[2])+","+u(t[3])+","+u(t[4])+","+u(-t[5])+","+u(t[6])+","+u(t[7])+","+u(t[8])+","+u(-t[9])+","+u(t[10])+","+u(t[11])+","+u(t[12])+","+u(-t[13])+","+u(t[14])+","+u(t[15])+")"}function h(e,t){var i=e.elements,o="matrix3d("+u(i[0])+","+u(i[1])+","+u(i[2])+","+u(i[3])+","+u(-i[4])+","+u(-i[5])+","+u(-i[6])+","+u(-i[7])+","+u(i[8])+","+u(i[9])+","+u(i[10])+","+u(i[11])+","+u(i[12])+","+u(i[13])+","+u(i[14])+","+u(i[15])+")";return l?"translate(-50%,-50%)translate("+r+"px,"+n+"px)"+t+o:"translate(-50%,-50%)"+o}this.getSize=function(){return{width:e,height:t}},this.setSize=function(i,o){r=(e=i)/2,n=(t=o)/2,a.style.width=i+"px",a.style.height=o+"px",s.style.width=i+"px",s.style.height=o+"px"};var p=function(){var e=new Vector3,t=new Vector3;return function(r,n){return e.setFromMatrixPosition(r.matrixWorld),t.setFromMatrixPosition(n.matrixWorld),e.distanceToSquared(t)}}();function f(e){for(var t=function(e){var t=[];return e.traverse(function(e){e instanceof CSS3DObject&&t.push(e)}),t}(e).sort(function(e,t){return o.objects.get(e).distanceToCameraSquared-o.objects.get(t).distanceToCameraSquared}),r=t.length,n=0,i=t.length;n<i;n++)t[n].element.style.zIndex=r-n}this.render=function(e,t){var d=t.projectionMatrix.elements[5]*n;if(o.camera.fov!==d&&(t.isPerspectiveCamera&&(a.style.WebkitPerspective=d+"px",a.style.perspective=d+"px"),o.camera.fov=d),e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),t.isOrthographicCamera)var m=-(t.right+t.left)/2,v=(t.top+t.bottom)/2;var g=t.isOrthographicCamera?"scale("+d+")translate("+u(m)+"px,"+u(v)+"px)"+c(t.matrixWorldInverse):"translateZ("+d+"px)"+c(t.matrixWorldInverse),y=g+"translate("+r+"px,"+n+"px)";o.camera.style===y||l||(s.style.WebkitTransform=y,s.style.transform=y,o.camera.style=y),function e(t,r,n){if(t instanceof CSS3DObject){var a;t instanceof CSS3DSprite?(i.copy(r.matrixWorldInverse),i.transpose(),i.copyPosition(t.matrixWorld),i.scale(t.scale),i.elements[3]=0,i.elements[7]=0,i.elements[11]=0,i.elements[15]=1,a=h(i,n)):a=h(t.matrixWorld,n);var u=t.element,c=o.objects.get(t);if(void 0===c||c.style!==a){u.style.WebkitTransform=a,u.style.transform=a;var f={style:a};l&&(f.distanceToCameraSquared=p(r,t)),o.objects.set(t,f)}u.parentNode!==s&&s.appendChild(u)}for(var d=0,m=t.children.length;d<m;d++)e(t.children[d],r,n)}(e,t,g),l&&f(e)}},RenderableObject=function(){this.id=0,this.object=null,this.z=0,this.renderOrder=0},RenderableFace=function(){this.id=0,this.v1=new RenderableVertex,this.v2=new RenderableVertex,this.v3=new RenderableVertex,this.normalModel=new Vector3,this.vertexNormalsModel=[new Vector3,new Vector3,new Vector3],this.vertexNormalsLength=0,this.color=new Color,this.material=null,this.uvs=[new Vector2,new Vector2,new Vector2],this.z=0,this.renderOrder=0},RenderableVertex=function(){this.position=new Vector3,this.positionWorld=new Vector3,this.positionScreen=new Vector4,this.visible=!0};RenderableVertex.prototype.copy=function(e){this.positionWorld.copy(e.positionWorld),this.positionScreen.copy(e.positionScreen)};var RenderableLine=function(){this.id=0,this.v1=new RenderableVertex,this.v2=new RenderableVertex,this.vertexColors=[new Color,new Color],this.material=null,this.z=0,this.renderOrder=0},RenderableSprite=function(){this.id=0,this.object=null,this.x=0,this.y=0,this.z=0,this.rotation=0,this.scale=new Vector2,this.material=null,this.renderOrder=0},Projector=function(){var e,t,r,n,i,o,a,s,l,u,c,h=[],p=0,f=[],d=0,m=[],v=0,g=[],y=0,b=[],x=0,w={objects:[],lights:[],elements:[]},S=new Vector3,M=new Vector4,_=new Box3(new Vector3(-1,-1,-1),new Vector3(1,1,1)),T=new Box3,A=new Array(3),C=new Matrix4,E=new Matrix4,L=new Matrix4,N=new Matrix3,P=new Frustum,O=new Vector4,R=new Vector4;this.projectVector=function(e,t){console.warn("Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(){console.error("Projector: .pickingRay() is now raycaster.setFromCamera().")};var D=new function(){var e=[],t=[],n=[],o=null,s=new Matrix3;function l(e){var t=e.position,r=e.positionWorld,n=e.positionScreen;r.copy(t).applyMatrix4(c),n.copy(r).applyMatrix4(E);var i=1/n.w;n.x*=i,n.y*=i,n.z*=i,e.visible=n.x>=-1&&n.x<=1&&n.y>=-1&&n.y<=1&&n.z>=-1&&n.z<=1}function u(e,t,r){return!0===e.visible||!0===t.visible||!0===r.visible||(A[0]=e.positionScreen,A[1]=t.positionScreen,A[2]=r.positionScreen,_.intersectsBox(T.setFromPoints(A)))}function h(e,t,r){return(r.positionScreen.x-e.positionScreen.x)*(t.positionScreen.y-e.positionScreen.y)-(r.positionScreen.y-e.positionScreen.y)*(t.positionScreen.x-e.positionScreen.x)<0}return{setObject:function(r){(o=r).material,s.getNormalMatrix(o.matrixWorld),e.length=0,t.length=0,n.length=0},projectVertex:l,checkTriangleVisibility:u,checkBackfaceCulling:h,pushVertex:function(e,t,n){(r=I()).position.set(e,t,n),l(r)},pushNormal:function(t,r,n){e.push(t,r,n)},pushColor:function(e,r,n){t.push(e,r,n)},pushUv:function(e,t){n.push(e,t)},pushLine:function(e,r){var n=f[e],i=f[r];n.positionScreen.copy(n.position).applyMatrix4(L),i.positionScreen.copy(i.position).applyMatrix4(L),!0===j(n.positionScreen,i.positionScreen)&&(n.positionScreen.multiplyScalar(1/n.positionScreen.w),i.positionScreen.multiplyScalar(1/i.positionScreen.w),(a=U()).id=o.id,a.v1.copy(n),a.v2.copy(i),a.z=Math.max(n.positionScreen.z,i.positionScreen.z),a.renderOrder=o.renderOrder,a.material=o.material,o.material.vertexColors===VertexColors&&(a.vertexColors[0].fromArray(t,3*e),a.vertexColors[1].fromArray(t,3*r)),w.elements.push(a))},pushTriangle:function(r,a,l,c){var p=arguments,d=f[r],m=f[a],v=f[l];if(!1!==u(d,m,v)&&(c.side===DoubleSide||!0===h(d,m,v))){(i=B()).id=o.id,i.v1.copy(d),i.v2.copy(m),i.v3.copy(v),i.z=(d.positionScreen.z+m.positionScreen.z+v.positionScreen.z)/3,i.renderOrder=o.renderOrder,S.subVectors(v.position,m.position),M.subVectors(d.position,m.position),S.cross(M),i.normalModel.copy(S),i.normalModel.applyMatrix3(s).normalize();for(var g=0;g<3;g++){var y=i.vertexNormalsModel[g];y.fromArray(e,3*p[g]),y.applyMatrix3(s).normalize(),i.uvs[g].fromArray(n,2*p[g])}i.vertexNormalsLength=3,i.material=c,c.vertexColors!==FaceColors&&c.vertexColors!==VertexColors||i.color.fromArray(t,3*r),w.elements.push(i)}}}};function F(r){(e=function(){if(t===p){var e=new RenderableObject;return h.push(e),p++,t++,e}return h[t++]}()).id=r.id,e.object=r,S.setFromMatrixPosition(r.matrixWorld),S.applyMatrix4(E),e.z=S.z,e.renderOrder=r.renderOrder,w.objects.push(e)}function k(e,t,r){var n=1/e.w;e.z*=n,e.z>=-1&&e.z<=1&&((l=function(){if(u===x){var e=new RenderableSprite;return b.push(e),x++,u++,e}return b[u++]}()).id=t.id,l.x=e.x*n,l.y=e.y*n,l.z=e.z,l.renderOrder=t.renderOrder,l.object=t,l.rotation=t.rotation,l.scale.x=t.scale.x*Math.abs(l.x-(e.x+r.projectionMatrix.elements[0])/(e.w+r.projectionMatrix.elements[12])),l.scale.y=t.scale.y*Math.abs(l.y-(e.y+r.projectionMatrix.elements[5])/(e.w+r.projectionMatrix.elements[13])),l.material=t.material,w.elements.push(l))}function I(){if(n===d){var e=new RenderableVertex;return f.push(e),d++,n++,e}return f[n++]}function B(){if(o===v){var e=new RenderableFace;return m.push(e),v++,o++,e}return m[o++]}function U(){if(s===y){var e=new RenderableLine;return g.push(e),y++,s++,e}return g[s++]}function V(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id!==t.id?e.id-t.id:0}function j(e,t){var r=0,n=1,i=e.z+e.w,o=t.z+t.w,a=-e.z+e.w,s=-t.z+t.w;return i>=0&&o>=0&&a>=0&&s>=0||!(i<0&&o<0||a<0&&s<0)&&(i<0?r=Math.max(r,i/(i-o)):o<0&&(n=Math.min(n,i/(i-o))),a<0?r=Math.max(r,a/(a-s)):s<0&&(n=Math.min(n,a/(a-s))),!(n<r)&&(e.lerp(t,r),t.lerp(e,1-n),!0))}this.projectScene=function(e,r,l,h){o=0,s=0,u=0,w.elements.length=0,!0===e.autoUpdate&&e.updateMatrixWorld(),null===r.parent&&r.updateMatrixWorld(),C.copy(r.matrixWorldInverse),E.multiplyMatrices(r.projectionMatrix,C),P.setFromMatrix(E),t=0,w.objects.length=0,w.lights.length=0,function e(t){if(!1!==t.visible){if(t instanceof Light)w.lights.push(t);else if(t instanceof Mesh||t instanceof Line||t instanceof Points){if(!1===t.material.visible)return;if(!0===t.frustumCulled&&!1===P.intersectsObject(t))return;F(t)}else if(t instanceof Sprite){if(!1===t.material.visible)return;if(!0===t.frustumCulled&&!1===P.intersectsSprite(t))return;F(t)}for(var r=t.children,n=0,i=r.length;n<i;n++)e(r[n])}}(e),!0===l&&w.objects.sort(V);for(var p=w.objects,d=0,m=p.length;d<m;d++){var v=p[d].object,g=v.geometry;if(D.setObject(v),c=v.matrixWorld,n=0,v instanceof Mesh){if(g instanceof BufferGeometry){var y=v.material,b=Array.isArray(y),x=g.attributes,_=g.groups;if(void 0===x.position)continue;for(var T=0,A=(Te=x.position.array).length;T<A;T+=3){var z=Te[T],G=Te[T+1],W=Te[T+2];if(!0===y.morphTargets)for(var H=g.morphAttributes.position,X=v.morphTargetInfluences,q=0,Y=H.length;q<Y;q++){if(0!==(ae=X[q]))z+=((se=H[q]).getX(T/3)-Te[T])*ae,G+=(se.getY(T/3)-Te[T+1])*ae,W+=(se.getZ(T/3)-Te[T+2])*ae}D.pushVertex(z,G,W)}if(void 0!==x.normal){var K=x.normal.array;for(T=0,A=K.length;T<A;T+=3)D.pushNormal(K[T],K[T+1],K[T+2])}if(void 0!==x.color)for(T=0,A=(Me=x.color.array).length;T<A;T+=3)D.pushColor(Me[T],Me[T+1],Me[T+2]);if(void 0!==x.uv){var Q=x.uv.array;for(T=0,A=Q.length;T<A;T+=2)D.pushUv(Q[T],Q[T+1])}if(null!==g.index){var J=g.index.array;if(_.length>0)for(var Z=0;Z<_.length;Z++){var $=_[Z];if(void 0!==(y=!0===b?v.material[$.materialIndex]:v.material))for(T=$.start,A=$.start+$.count;T<A;T+=3)D.pushTriangle(J[T],J[T+1],J[T+2],y)}else for(T=0,A=J.length;T<A;T+=3)D.pushTriangle(J[T],J[T+1],J[T+2],y)}else if(_.length>0)for(Z=0;Z<_.length;Z++){$=_[Z];if(void 0!==(y=!0===b?v.material[$.materialIndex]:v.material))for(T=$.start,A=$.start+$.count;T<A;T+=3)D.pushTriangle(T,T+1,T+2,y)}else for(T=0,A=Te.length/3;T<A;T+=3)D.pushTriangle(T,T+1,T+2,y)}else if(g instanceof Geometry){var ee=g.vertices,te=g.faces,re=g.faceVertexUvs[0];N.getNormalMatrix(c);y=v.material,b=Array.isArray(y);for(var ne=0,ie=ee.length;ne<ie;ne++){var oe=ee[ne];if(S.copy(oe),!0===y.morphTargets)for(H=g.morphTargets,X=v.morphTargetInfluences,q=0,Y=H.length;q<Y;q++){var ae;if(0!==(ae=X[q])){var se,le=(se=H[q]).vertices[ne];S.x+=(le.x-oe.x)*ae,S.y+=(le.y-oe.y)*ae,S.z+=(le.z-oe.z)*ae}}D.pushVertex(S.x,S.y,S.z)}for(var ue=0,ce=te.length;ue<ce;ue++){var he=te[ue];if(void 0!==(y=!0===b?v.material[he.materialIndex]:v.material)){var pe=y.side,fe=f[he.a],de=f[he.b],me=f[he.c];if(!1!==D.checkTriangleVisibility(fe,de,me)){var ve=D.checkBackfaceCulling(fe,de,me);if(pe!==DoubleSide){if(pe===FrontSide&&!1===ve)continue;if(pe===BackSide&&!0===ve)continue}(i=B()).id=v.id,i.v1.copy(fe),i.v2.copy(de),i.v3.copy(me),i.normalModel.copy(he.normal),!1!==ve||pe!==BackSide&&pe!==DoubleSide||i.normalModel.negate(),i.normalModel.applyMatrix3(N).normalize();for(var ge=he.vertexNormals,ye=0,be=Math.min(ge.length,3);ye<be;ye++){var xe=i.vertexNormalsModel[ye];xe.copy(ge[ye]),!1!==ve||pe!==BackSide&&pe!==DoubleSide||xe.negate(),xe.applyMatrix3(N).normalize()}i.vertexNormalsLength=ge.length;var we=re[ue];if(void 0!==we)for(var Se=0;Se<3;Se++)i.uvs[Se].copy(we[Se]);i.color=he.color,i.material=y,i.z=(fe.positionScreen.z+de.positionScreen.z+me.positionScreen.z)/3,i.renderOrder=v.renderOrder,w.elements.push(i)}}}}}else if(v instanceof Line){if(L.multiplyMatrices(E,c),g instanceof BufferGeometry){if(void 0!==(x=g.attributes).position){for(T=0,A=(Te=x.position.array).length;T<A;T+=3)D.pushVertex(Te[T],Te[T+1],Te[T+2]);if(void 0!==x.color){var Me;for(T=0,A=(Me=x.color.array).length;T<A;T+=3)D.pushColor(Me[T],Me[T+1],Me[T+2])}if(null!==g.index)for(T=0,A=(J=g.index.array).length;T<A;T+=2)D.pushLine(J[T],J[T+1]);else{var _e=v instanceof LineSegments?2:1;for(T=0,A=Te.length/3-1;T<A;T+=_e)D.pushLine(T,T+1)}}}else if(g instanceof Geometry){if(0===(ee=v.geometry.vertices).length)continue;(fe=I()).positionScreen.copy(ee[0]).applyMatrix4(L);for(_e=v instanceof LineSegments?2:1,ne=1,ie=ee.length;ne<ie;ne++)(fe=I()).positionScreen.copy(ee[ne]).applyMatrix4(L),(ne+1)%_e>0||(de=f[n-2],O.copy(fe.positionScreen),R.copy(de.positionScreen),!0===j(O,R)&&(O.multiplyScalar(1/O.w),R.multiplyScalar(1/R.w),(a=U()).id=v.id,a.v1.positionScreen.copy(O),a.v2.positionScreen.copy(R),a.z=Math.max(O.z,R.z),a.renderOrder=v.renderOrder,a.material=v.material,v.material.vertexColors===VertexColors&&(a.vertexColors[0].copy(v.geometry.colors[ne]),a.vertexColors[1].copy(v.geometry.colors[ne-1])),w.elements.push(a)))}}else if(v instanceof Points){if(L.multiplyMatrices(E,c),g instanceof Geometry)for(ne=0,ie=(ee=v.geometry.vertices).length;ne<ie;ne++){oe=ee[ne];M.set(oe.x,oe.y,oe.z,1),M.applyMatrix4(L),k(M,v,r)}else if(g instanceof BufferGeometry){if(void 0!==(x=g.attributes).position){var Te;for(T=0,A=(Te=x.position.array).length;T<A;T+=3)M.set(Te[T],Te[T+1],Te[T+2],1),M.applyMatrix4(L),k(M,v,r)}}}else v instanceof Sprite&&(v.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,v.matrixWorld),M.set(c.elements[12],c.elements[13],c.elements[14],1),M.applyMatrix4(E),k(M,v,r))}return!0===h&&w.elements.sort(V),w}},RaytracingRenderer=function(e){console.log("RaytracingRenderer",REVISION),e=e||{};var t,r,n=this,i=[],o=!1,a=document.createElement("canvas"),s=a.getContext("2d",{alpha:!0===e.alpha}),l=new Color(0);this.domElement=a,this.autoClear=!0;var u=e.workers,c=e.blockSize||64;this.randomize=e.randomize;var h,p,f,d=[],m=0,v=0;function g(e){e.postMessage({init:[t,r],worker:e.id,blockSize:c})}function y(e){if(!d.length)return o=!1,n.dispatchEvent({type:"complete"});var t=d.pop(),r=t%p*c,i=(t/p|0)*c;e.postMessage({render:!0,x:r,y:i,sceneId:v}),s.fillStyle="#"+e.color,s.fillRect(r,i,c,c)}console.log("%cSpinning off "+u+" Workers ","font-size: 20px; background: black; color: white; font-family: monospace;"),this.setWorkers=function(t){for(u=t||navigator.hardwareConcurrency||4;i.length<u;){var r=new Worker(e.workerPath);r.id=m++,r.onmessage=function(e){var t=e.data;if(t&&t.blockSize&&v==t.sceneId){var r=new ImageData(new Uint8ClampedArray(t.data),t.blockSize,t.blockSize);if(s.putImageData(r,t.blockX,t.blockY),console.log("Worker "+this.id,t.time/1e3,(Date.now()-w)/1e3+" s"),i.length>u)return i.splice(i.indexOf(this),1),this.terminate();y(this)}},r.color=(new Color).setHSL(Math.random(),.8,.8).getHexString(),i.push(r),g(r),o&&(r.postMessage({scene:b,camera:x,annex:S,sceneId:v}),y(r))}if(!o)for(;i.length>u;)i.pop().terminate()},this.setWorkers(u),this.setClearColor=function(e){l.set(e)},this.setPixelRatio=function(){},this.setSize=function(e,n){a.width=e,a.height=n,t=a.width,r=a.height,s.fillStyle="white",i.forEach(g)},this.setSize(a.width,a.height),this.clear=function(){};var b,x,w,S={},M={mirror:1,reflectivity:1,refractionRatio:1,glass:1};function _(e){var t=e.material;if(t&&!(t.uuid in S)){var r={};for(var n in M)void 0!==t[n]&&(r[n]=t[n]);S[t.uuid]=r}}this.render=function(e,a){o=!0,!0===e.autoUpdate&&e.updateMatrixWorld(),null===a.parent&&a.updateMatrixWorld(),b=e.toJSON(),x=a.toJSON(),++v,e.traverse(_),i.forEach(function(e){e.postMessage({scene:b,camera:x,annex:S,sceneId:v})}),s.clearRect(0,0,t,r),w=Date.now(),p=Math.ceil(t/c),f=Math.ceil(r/c),h=p*f,d=[];for(var l=0;l<h;l++)d.push(l);if(n.randomize)for(l=0;l<h;l++){var u=Math.random()*h|0,m=d[u];d[u]=d[l],d[l]=m}i.forEach(y)}};Object.assign(RaytracingRenderer.prototype,EventDispatcher.prototype);var SoftwareRenderer=function e(t){console.log("SoftwareRenderer",REVISION);var r,n,i,o,a,s,l,u,c,h,p,f,d,m,v,g,y=void 0!==(t=t||{}).canvas?t.canvas:document.createElement("canvas"),b=y.getContext("2d",{alpha:!0===t.alpha}),x={},w={},S=new Color(0),M=!0===t.alpha?0:1,_=1,T=2,A=4,C=(1<<A)-1,E=3,L=1<<E,N=1<<24,P=!1,O=new Vector3(0,0,1),R=new Vector3,D=1/0,F=1/0,k=0,I=0,B=1/0,U=1/0,V=0,j=0,z=new Projector,G=new Vector4,W=new Vector4,H=new Vector4,X=new Vector2,q=new Vector2,Y=new Vector2,K=[],Q=0,J=[],Z=0,$=[],ee=0,te=this;function re(){return!0===t.alpha?M:1}function ne(e){for(var t=r*n*4,i=0;i<t;i+=4)f[i]=255*e.r|0,f[i+1]=255*e.g|0,f[i+2]=255*e.b|0,f[i+3]=255*re()|0;b.fillStyle="rgba("+(255*S.r|0)+","+(255*S.g|0)+","+(255*S.b|0)+","+re()+")",b.fillRect(0,0,r,n)}function ie(e,t){var r=0,n=0,i=255*e.color.r,o=255*e.color.g,a=255*e.color.b,s=new Uint8Array(768);if(t){for(;r<204;)s[n++]=Math.min(r*i/204,255),s[n++]=Math.min(r*o/204,255),s[n++]=Math.min(r*a/204,255),++r;for(;r<256;)s[n++]=Math.min(i+(r-204)*(255-i)/82,255),s[n++]=Math.min(o+(r-204)*(255-o)/82,255),s[n++]=Math.min(a+(r-204)*(255-a)/82,255),++r}else for(;r<256;)s[n++]=Math.min(r*i/255,255),s[n++]=Math.min(r*o/255,255),s[n++]=Math.min(r*a/255,255),++r;return s}function oe(e,t,r,n,i,o,a,s,l){var u=4*r,c=w[l.map.id];if(c.data){var h=c.width,p=l.transparent,f=h-1,d=c.data,m=4*((o*h&f)*h+(i*h&f));if(p){var v=d[m],g=d[m+1],y=d[m+2],b=d[m+3]*l.opacity/255,x=e[u],S=e[u+1],M=e[u+2];e[u]=v*b+x*(1-b),e[u+1]=g*b+S*(1-b),e[u+2]=y*b+M*(1-b),e[u+3]=(l.opacity<<8)-1,255==e[u+3]&&(t[r]=n)}else e[u]=d[m],e[u+1]=d[m+1],e[u+2]=d[m+2],e[u+3]=(l.opacity<<8)-1,t[r]=n}}function ae(e,t,r,n,i,o,a,s,l){var u=4*r,c=w[l.map.id];if(c.data){var h=c.width,p=l.transparent,f=3*(a>0?~~a:0),d=h-1,m=c.data,v=4*((o*h&d)*h+(i*h&d));if(p){var g=l.palette[f]*m[v],y=l.palette[f+1]*m[v+1],b=l.palette[f+2]*m[v+2],x=m[v+3]*l.opacity/256,S=e[u],M=e[u+1],_=e[u+2];e[u]=g*x+S*(1-x),e[u+1]=y*x+M*(1-x),e[u+2]=b*x+_*(1-x),e[u+3]=(l.opacity<<8)-1,255==e[u+3]&&(t[r]=n)}else e[u]=l.palette[f]*m[v]>>8,e[u+1]=l.palette[f+1]*m[v+1]>>8,e[u+2]=l.palette[f+2]*m[v+2]>>8,e[u+3]=(l.opacity<<8)-1,t[r]=n}}function se(t){var r=t.id,n=x[r];if(n&&t.map&&!w[t.map.id]&&delete x[r],void 0===x[r]||!0===t.needsUpdate){if(t instanceof MeshBasicMaterial||t instanceof MeshLambertMaterial||t instanceof MeshPhongMaterial||t instanceof SpriteMaterial)if(t instanceof MeshLambertMaterial?t.palette||(t.palette=ie(t,!1)):t instanceof MeshPhongMaterial&&(t.palette||(t.palette=ie(t,!0))),t.map){var i=new e.Texture;if(i.fromImage(t.map.image),!i.data)return;w[t.map.id]=i,n=t instanceof MeshBasicMaterial||t instanceof SpriteMaterial?oe:ae}else o=t.vertexColors===FaceColors||t.vertexColors===VertexColors?["var colorOffset = offset * 4;","buffer[ colorOffset ] = face.color.r * 255;","buffer[ colorOffset + 1 ] = face.color.g * 255;","buffer[ colorOffset + 2 ] = face.color.b * 255;","buffer[ colorOffset + 3 ] = material.opacity * 255;","depthBuf[ offset ] = depth;"].join("\n"):["var colorOffset = offset * 4;","buffer[ colorOffset ] = material.color.r * 255;","buffer[ colorOffset + 1 ] = material.color.g * 255;","buffer[ colorOffset + 2 ] = material.color.b * 255;","buffer[ colorOffset + 3 ] = material.opacity * 255;","depthBuf[ offset ] = depth;"].join("\n"),n=new Function("buffer, depthBuf, offset, depth, u, v, n, face, material",o);else if(t instanceof LineBasicMaterial){var o=["var colorOffset = offset * 4;","buffer[ colorOffset ] = material.color.r * (color1.r+color2.r) * 0.5 * 255;","buffer[ colorOffset + 1 ] = material.color.g * (color1.g+color2.g) * 0.5 * 255;","buffer[ colorOffset + 2 ] = material.color.b * (color1.b+color2.b) * 0.5 * 255;","buffer[ colorOffset + 3 ] = 255;","depthBuf[ offset ] = depth;"].join("\n");n=new Function("buffer, depthBuf, offset, depth, color1, color2, material",o)}else{o=["var colorOffset = offset * 4;","buffer[ colorOffset ] = u * 255;","buffer[ colorOffset + 1 ] = v * 255;","buffer[ colorOffset + 2 ] = 0;","buffer[ colorOffset + 3 ] = 255;","depthBuf[ offset ] = depth;"].join("\n");n=new Function("buffer, depthBuf, offset, depth, u, v, n, face, material",o)}x[r]=n,t.needsUpdate=!1}return n}function le(e,t,o,p,m,y,b,x,w){if(!(e.z<-1||e.z>1||t.z<-1||t.z>1||o.z<-1||o.z>1)){var S=1<<A,M=e.x*a+u|0,N=t.x*a+u|0,P=o.x*a+u|0,O=e.y*s+c|0,R=t.y*s+c|0,B=o.y*s+c|0,U=x.vertexNormalsModel&&x.vertexNormalsModel.length,V=p&&m&&y,j=Math.max(Math.sqrt((M-N)*(M-N)+(O-R)*(O-R)),Math.sqrt((N-P)*(N-P)+(R-B)*(R-B)),Math.sqrt((P-M)*(P-M)+(B-O)*(B-O)));if(!(x instanceof RenderableSprite)&&j>100*S){var z,G,W,H,X,q,Y,te,re,ne,ie={vertexNormalsModel:[],color:x.color};if(V)ee===$.length?(z=new Vector2,$.push(z),++ee,G=new Vector2,$.push(G),++ee,W=new Vector2,$.push(W),++ee):(z=$[ee],G=$[++ee],W=$[++ee],++ee),H=(1+t.z)*(t.w/e.w)/(1+e.z),z.copy(p).multiplyScalar(H).add(m).multiplyScalar(1/(H+1)),H=(1+o.z)*(o.w/t.w)/(1+t.z),G.copy(m).multiplyScalar(H).add(y).multiplyScalar(1/(H+1)),H=(1+e.z)*(e.w/o.w)/(1+o.z),W.copy(y).multiplyScalar(H).add(p).multiplyScalar(1/(H+1));return Q===K.length?(X=new Vector4,K.push(X),++Q,q=new Vector4,K.push(q),++Q,Y=new Vector4,K.push(Y),++Q):(X=K[Q],q=K[++Q],Y=K[++Q],++Q),X.copy(e).add(t).multiplyScalar(.5),q.copy(t).add(o).multiplyScalar(.5),Y.copy(o).add(e).multiplyScalar(.5),U&&(Z===J.length?(te=new Vector3,J.push(te),++Z,re=new Vector3,J.push(re),++Z,ne=new Vector3,J.push(ne),++Z):(te=J[Z],re=J[++Z],ne=J[++Z],++Z),te.copy(x.vertexNormalsModel[0]).add(x.vertexNormalsModel[1]).normalize(),re.copy(x.vertexNormalsModel[1]).add(x.vertexNormalsModel[2]).normalize(),ne.copy(x.vertexNormalsModel[2]).add(x.vertexNormalsModel[0]).normalize()),U&&(ie.vertexNormalsModel[0]=x.vertexNormalsModel[0],ie.vertexNormalsModel[1]=te,ie.vertexNormalsModel[2]=ne),le(e,X,Y,p,z,W,b,ie,w),U&&(ie.vertexNormalsModel[0]=x.vertexNormalsModel[1],ie.vertexNormalsModel[1]=re,ie.vertexNormalsModel[2]=te),le(t,q,X,m,G,z,b,ie,w),U&&(ie.vertexNormalsModel[0]=te,ie.vertexNormalsModel[1]=re,ie.vertexNormalsModel[2]=ne),le(X,q,Y,z,G,W,b,ie,w),U&&(ie.vertexNormalsModel[0]=x.vertexNormalsModel[2],ie.vertexNormalsModel[1]=ne,ie.vertexNormalsModel[2]=re),void le(o,Y,q,y,W,G,b,ie,w)}var oe,ae,se,ue,he,pe,fe,de,me,ve,ge,ye,be=e.z*l+h|0,xe=t.z*l+h|0,we=o.z*l+h|0;V=!1;p&&m&&y&&(V=!0,oe=p.x,ae=1-p.y,se=m.x,ue=1-m.y,he=y.x,pe=1-y.y),U&&(fe=x.vertexNormalsModel[0],de=x.vertexNormalsModel[1],me=x.vertexNormalsModel[2],ve=255*fe.z,ge=255*de.z,ye=255*me.z);var Se=M-N,Me=R-O,_e=N-P,Te=B-R,Ae=P-M,Ce=O-B,Ee=Math.max(Math.min(M,N,P)+C>>A,0),Le=Math.min(Math.max(M,N,P)+C>>A,r),Ne=Math.max(Math.min(O,R,B)+C>>A,0),Pe=Math.min(Math.max(O,R,B)+C>>A,n);D=Math.min(Ee,D),k=Math.max(Le,k),F=Math.min(Ne,F),I=Math.max(Pe,I);var Oe=L,Re=(Ee&=~(Oe-1))<<A,De=(Ne&=~(Oe-1))<<A,Fe=Me*(Re-M)+Se*(De-O),ke=Te*(Re-N)+_e*(De-R),Ie=Ce*(Re-P)+Ae*(De-B);(Me>0||0==Me&&Se>0)&&Fe++,(Te>0||0==Te&&_e>0)&&ke++,(Ce>0||0==Ce&&Ae>0)&&Ie++;var Be,Ue,Ve,je,ze,Ge=be-xe,We=we-be,He=1/(Se*Ce-Ae*Me),Xe=He*(Ge*Ce-We*Me),qe=He*(Ge*Ae-Se*We),Ye=be+(Re-M)*Xe+(De-O)*qe|0;if(V){var Ke=oe-se,Qe=he-oe,Je=He*(Ke*Ce-Qe*Me),Ze=He*(Ke*Ae-Se*Qe),$e=ae-ue,et=pe-ae;Ve=oe+(Re-M)*Je+(De-O)*Ze,je=ae+(Re-M)*(Be=He*($e*Ce-et*Me))+(De-O)*(Ue=He*($e*Ae-Se*et)),Je*=S,Ze*=S,Be*=S,Ue*=S}if(U){var tt,rt=ve-ge,nt=ye-ve,it=He*(rt*Ce-nt*Me);ze=ve+(Re-M)*it+(De-O)*(tt=He*(rt*Ae-Se*nt)),it*=S,tt*=S}var ot=Oe-1,at=0,st=0,lt=0,ut=0,ct=0,ht=0,pt=0,ft=0;Se>=0?st-=ot*Se:at-=ot*Se,Me>=0?st-=ot*Me:at-=ot*Me,_e>=0?ut-=ot*_e:lt-=ot*_e,Te>=0?ut-=ot*Te:lt-=ot*Te,Ae>=0?ht-=ot*Ae:ct-=ot*Ae,Ce>=0?ht-=ot*Ce:ct-=ot*Ce,(Xe=Xe*S|0)>=0?ft+=ot*Xe:pt+=ot*Xe,(qe=qe*S|0)>=0?ft+=ot*qe:pt+=ot*qe;var dt,mt,vt,gt=r-Oe,yt=Fe=Fe-1>>A,bt=ke=ke-1>>A,xt=Ie=Ie-1>>A,wt=Ye,St=-Oe,Mt=St*Me,_t=St*Te,Tt=St*Ce,At=St*Xe;V&&(dt=St*Je,mt=St*Be),U&&(vt=St*it);for(var Ct=Ee,Et=Ne;Et<Pe;Et+=Oe){for(;Ct>=Ee&&Ct<Le&&yt>=st&&bt>=ut&&xt>=ht;)Ct+=St,yt+=Mt,bt+=_t,xt+=Tt,wt+=At,V&&(Ve+=dt,je+=mt),U&&(ze+=vt);for(St=-St,Mt=-Mt,_t=-_t,Tt=-Tt,At=-At,V&&(dt=-dt,mt=-mt),U&&(vt=-vt);yt+=Mt,bt+=_t,xt+=Tt,wt+=At,V&&(Ve+=dt,je+=mt),U&&(ze+=vt),!((Ct+=St)<Ee||Ct>=Le);)if(yt<st){if(Mt<0)break}else if(bt<ut){if(_t<0)break}else if(xt<ht){if(Tt<0)break}else{var Lt=Ct>>E,Nt=Et>>E,Pt=Lt+Nt*i,Ot=wt+pt;if(!(v[Pt]<Ot)){var Rt=g[Pt];Rt&T&&ce(Lt,Nt),g[Pt]=Rt&~(_|T);var Dt=Ct+Et*r;if(yt>=at&&bt>=lt&&xt>=ct){var Ft=wt+ft;v[Pt]=Math.min(v[Pt],Ft);var kt=yt,It=bt,Bt=wt;V&&(Wt=Ve,Ht=je),U&&(Xt=ze);for(var Ut=0;Ut<Oe;Ut++){var Vt=kt,jt=It,zt=Bt;V&&(Yt=Wt,Kt=Ht),U&&(Qt=Xt);for(var Gt=0;Gt<Oe;Gt++){(Zt=zt)<d[Dt]&&b(f,d,Dt,Zt,Yt,Kt,Qt,x,w),Vt+=Me,jt+=Te,zt+=Xe,V&&(Yt+=Je,Kt+=Be),U&&(Qt+=it),Dt++}kt+=Se,It+=_e,Bt+=qe,V&&(Wt+=Ze,Ht+=Ue),U&&(Xt+=tt),Dt+=gt}}else{kt=yt,It=bt;var Wt,Ht,Xt,qt=xt;Bt=wt;V&&(Wt=Ve,Ht=je),U&&(Xt=ze);for(Ut=0;Ut<Oe;Ut++){Vt=kt,jt=It;var Yt,Kt,Qt,Jt=qt;zt=Bt;V&&(Yt=Wt,Kt=Ht),U&&(Qt=Xt);for(Gt=0;Gt<Oe;Gt++){var Zt;if((Vt|jt|Jt)>=0)(Zt=zt)<d[Dt]&&b(f,d,Dt,Zt,Yt,Kt,Qt,x,w);Vt+=Me,jt+=Te,Jt+=Ce,zt+=Xe,V&&(Yt+=Je,Kt+=Be),U&&(Qt+=it),Dt++}kt+=Se,It+=_e,qt+=Ae,Bt+=qe,V&&(Wt+=Ze,Ht+=Ue),U&&(Xt+=tt),Dt+=gt}}}}yt+=Oe*Se,bt+=Oe*_e,xt+=Oe*Ae,wt+=Oe*qe,V&&(Ve+=Oe*Ze,je+=Oe*Ue),U&&(ze+=Oe*tt)}}}function ue(e,t,o,p,m,b){if(P||(P=!0,L=1<<(E=0),te.setSize(y.width,y.height)),!(e.z<-1||e.z>1||t.z<-1||t.z>1)){var x=Math.floor(.5*(b.linewidth-1)),w=e.x*a+u|0,S=t.x*a+u|0,M=e.y*s+c|0,N=t.y*s+c|0,B=e.z*l+h|0,U=t.z*l+h|0,V=w-S,j=M-N,z=B-U,G=Math.max(Math.min(w,S)+C>>A,0),W=Math.min(Math.max(w,S)+C>>A,r),H=Math.max(Math.min(M,N)+C>>A,0),X=Math.min(Math.max(M,N)+C>>A,n),q=Math.max(Math.min(B,U)+C>>A,0),Y=Math.max(B,U)+C>>A;D=Math.min(G,D),k=Math.max(W,k),F=Math.min(H,F),I=Math.max(X,I);var K,Q,J,Z,$,ee=Math.sqrt(j*j+V*V),re=V/ee,ne=j/ee,ie=z/ee;for(R.set(re,ne,ie),R.cross(O),R.normalize();ee>0;){K=(K=S+ee*re)+C>>A,Q=(Q=N+ee*ne)+C>>A,$=U+ee*ie+C>>A;for(var oe=-x;oe<=x;++oe)if(J=Math.floor(K+R.x*oe),Z=Math.floor(Q+R.y*oe),!(D>=J||k<=J||F>=Z||I<=Z)){var ae=J>>E,se=Z>>E,le=ae+se*i;if(!(v[le]<q)){v[le]=Math.min(v[le],Y);var ue=g[le];ue&T&&ce(ae,se),g[le]=ue&~(_|T);var he=J+Z*r;$<d[he]&&m(f,d,he,$,o,p,b)}}--ee}}}function ce(e,t){for(var n=e*L+t*L*r,i=4*n,o=r-L,a=4*o,s=0;s<L;s++){for(var l=0;l<L;l++)d[n++]=N,f[i++]=255*S.r|0,f[i++]=255*S.g|0,f[i++]=255*S.b|0,f[i++]=255*re()|0;n+=o,i+=a}}this.domElement=y,this.autoClear=!0,this.setClearColor=function(e,t){S.set(e),M=t,ne(S)},this.setPixelRatio=function(){},this.setSize=function(e,t){i=Math.floor(e/L),o=Math.floor(t/L);var x=1<<A;a=x*(r=i*L)/2,s=-x*(n=o*L)/2,l=N/2,u=x*r/2+.5,c=x*n/2+.5,h=N/2+.5,y.width=r,y.height=n,p=b.getImageData(0,0,r,n),f=p.data,d=new Int32Array(f.length/4),m=i*o,v=new Int32Array(m),g=new Uint8Array(m);for(var w=0,M=d.length;w<M;w++)d[w]=N;for(w=0;w<m;w++)g[w]=_;ne(S)},this.clear=function(){D=1/0,F=1/0,k=0,I=0,Q=0,Z=0,ee=0;for(var e=0;e<m;e++)v[e]=N,g[e]=g[e]&_?_:T},this.render=function(e,t){this.clear();var r=e.background;r&&r.isColor&&ne(r);for(var n=z.projectScene(e,t,!1,!1).elements,a=0,s=n.length;a<s;a++){var l=n[a],u=l.material;if(f=se(u))if(l instanceof RenderableFace)l.uvs?le(l.v1.positionScreen,l.v2.positionScreen,l.v3.positionScreen,l.uvs[0],l.uvs[1],l.uvs[2],f,l,u):le(l.v1.positionScreen,l.v2.positionScreen,l.v3.positionScreen,null,null,null,f,l,u);else if(l instanceof RenderableSprite){var c=.5*l.scale.x,h=.5*l.scale.y;G.copy(l),G.x-=c,G.y+=h,W.copy(l),W.x-=c,W.y-=h,H.copy(l),H.x+=c,H.y+=h,u.map?(X.set(0,1),q.set(0,0),Y.set(1,1),le(G,W,H,X,q,Y,f,l,u)):le(G,W,H,null,null,null,f,l,u),G.copy(l),G.x+=c,G.y+=h,W.copy(l),W.x-=c,W.y-=h,H.copy(l),H.x+=c,H.y-=h,u.map?(X.set(1,1),q.set(0,0),Y.set(1,0),le(G,W,H,X,q,Y,f,l,u)):le(G,W,H,null,null,null,f,l,u)}else if(l instanceof RenderableLine){var f=se(u);ue(l.v1.positionScreen,l.v2.positionScreen,l.vertexColors[0],l.vertexColors[1],f,u)}}!function(){for(var e=0,t=0;t<o;t++)for(var r=0;r<i;r++)g[e]&T&&(ce(r,t),g[e]=_),e++}();var d=Math.min(D,B),m=Math.min(F,U),v=Math.max(k,V)-d,y=Math.max(I,j)-m;d!==1/0&&b.putImageData(p,0,0,d,m,v,y),B=D,U=F,V=k,j=I}};SoftwareRenderer.Texture=function(){var e;this.fromImage=function(t){if(!(!t||t.width<=0||t.height<=0)){void 0===e&&(e=document.createElement("canvas"));var r=t.width>t.height?t.width:t.height;r=_Math.ceilPowerOfTwo(r),e.width==r&&e.height==r||(e.width=r,e.height=r);var n=e.getContext("2d");n.clearRect(0,0,r,r),n.drawImage(t,0,0,r,r);var i=n.getImageData(0,0,r,r);this.data=i.data,this.width=r,this.height=r,this.srcUrl=t.src}}};var SVGObject=function(e){Object3D.call(this),this.node=e};SVGObject.prototype=Object.create(Object3D.prototype),SVGObject.prototype.constructor=SVGObject;var SVGRenderer=function(){console.log("SVGRenderer",REVISION);var e,t,r,n,i,o,a,s,l,u,c,h,p,f=this,d=new Projector,m=document.createElementNS("http://www.w3.org/2000/svg","svg"),v=new Box2,g=new Box2,y=new Color,b=new Color,x=new Color,w=new Color,S=new Color,M=new Color,_=1,T=new Vector3,A=new Vector3,C=new Vector3,E=new Matrix3,L=new Matrix4,N=new Matrix4,P=[],O=0,R=1,D=null;function F(){for(O=0;m.childNodes.length>0;)m.removeChild(m.childNodes[0])}function k(e,t){var r=Math.floor(255*e.r)+","+Math.floor(255*e.g)+","+Math.floor(255*e.b);return void 0===t||1===t?"rgb("+r+")":"rgb("+r+"); fill-opacity: "+t}function I(e){return null!==D?e.toFixed(D):e}function B(e,t,r){var n=t.scale.x*o,i=t.scale.y*a;r.isPointsMaterial&&(n*=r.size,i*=r.size);var s="M"+I(e.x-.5*n)+","+I(e.y-.5*i)+"h"+I(n)+"v"+I(i)+"h"+I(-n)+"z",l="";(r.isSpriteMaterial||r.isPointsMaterial)&&(l="fill:"+k(r.color,r.opacity)),j(l,s)}function U(e,t,r,n){var i="M"+I(e.positionScreen.x)+","+I(e.positionScreen.y)+"L"+I(t.positionScreen.x)+","+I(t.positionScreen.y);if(n.isLineBasicMaterial){var o="fill:none;stroke:"+k(n.color,n.opacity)+";stroke-width:"+n.linewidth+";stroke-linecap:"+n.linecap;n.isLineDashedMaterial&&(o=o+";stroke-dasharray:"+n.dashSize+","+n.gapSize),j(o,i)}}function V(e,t,n,i,o){f.info.render.vertices+=3,f.info.render.faces++;var a="M"+I(e.positionScreen.x)+","+I(e.positionScreen.y)+"L"+I(t.positionScreen.x)+","+I(t.positionScreen.y)+"L"+I(n.positionScreen.x)+","+I(n.positionScreen.y)+"z";o.isMeshBasicMaterial?(y.copy(o.color),o.vertexColors!==FaceColors&&o.vertexColors!==VertexColors||y.multiply(i.color)):o.isMeshLambertMaterial||o.isMeshPhongMaterial||o.isMeshStandardMaterial?(b.copy(o.color),o.vertexColors!==FaceColors&&o.vertexColors!==VertexColors||b.multiply(i.color),y.copy(x),A.copy(e.positionWorld).add(t.positionWorld).add(n.positionWorld).divideScalar(3),function(e,t,r,n){for(var i=0,o=e.length;i<o;i++){var a=e[i],s=a.color;if(a.isDirectionalLight){var l=T.setFromMatrixPosition(a.matrixWorld).normalize();if((u=r.dot(l))<=0)continue;u*=a.intensity,n.r+=s.r*u,n.g+=s.g*u,n.b+=s.b*u}else if(a.isPointLight){var u;if(l=T.setFromMatrixPosition(a.matrixWorld),(u=r.dot(T.subVectors(l,t).normalize()))<=0)continue;if(0==(u*=0==a.distance?1:1-Math.min(t.distanceTo(l)/a.distance,1)))continue;u*=a.intensity,n.r+=s.r*u,n.g+=s.g*u,n.b+=s.b*u}}}(r,A,i.normalModel,y),y.multiply(b).add(o.emissive)):o.isMeshNormalMaterial&&(C.copy(i.normalModel).applyMatrix3(E),y.setRGB(C.x,C.y,C.z).multiplyScalar(.5).addScalar(.5)),j(o.wireframe?"fill:none;stroke:"+k(y,o.opacity)+";stroke-width:"+o.wireframeLinewidth+";stroke-linecap:"+o.wireframeLinecap+";stroke-linejoin:"+o.wireframeLinejoin:"fill:"+k(y,o.opacity),a)}function j(e,t){p===e?h+=t:(z(),p=e,h=t)}function z(){h&&((c=function(e){if(null==P[e])return P[e]=document.createElementNS("http://www.w3.org/2000/svg","path"),0==R&&P[e].setAttribute("shape-rendering","crispEdges"),P[e];return P[e]}(O++)).setAttribute("d",h),c.setAttribute("style",p),m.appendChild(c)),h="",p=""}this.domElement=m,this.autoClear=!0,this.sortObjects=!0,this.sortElements=!0,this.info={render:{vertices:0,faces:0}},this.setQuality=function(e){switch(e){case"high":R=1;break;case"low":R=0}},this.setClearColor=function(e,t){M.set(e),_=void 0!==t?t:1},this.setPixelRatio=function(){},this.setSize=function(e,t){o=(n=e)/2,a=(i=t)/2,m.setAttribute("viewBox",-o+" "+-a+" "+n+" "+i),m.setAttribute("width",n),m.setAttribute("height",i),v.min.set(-o,-a),v.max.set(o,a)},this.setPrecision=function(e){D=e},this.clear=function(){F(),m.style.backgroundColor=k(M,_)},this.render=function(n,i){if(i instanceof Camera!==!1){var c=n.background;c&&c.isColor?(F(),m.style.backgroundColor=k(c)):!0===this.autoClear&&this.clear(),f.info.render.vertices=0,f.info.render.faces=0,L.copy(i.matrixWorldInverse),N.multiplyMatrices(i.projectionMatrix,L),e=d.projectScene(n,i,this.sortObjects,this.sortElements),t=e.elements,r=e.lights,E.getNormalMatrix(i.matrixWorldInverse),function(e){x.setRGB(0,0,0),w.setRGB(0,0,0),S.setRGB(0,0,0);for(var t=0,r=e.length;t<r;t++){var n=e[t],i=n.color;n.isAmbientLight?(x.r+=i.r,x.g+=i.g,x.b+=i.b):n.isDirectionalLight?(w.r+=i.r,w.g+=i.g,w.b+=i.b):n.isPointLight&&(S.r+=i.r,S.g+=i.g,S.b+=i.b)}}(r),h="",p="";for(var y=0,b=t.length;y<b;y++){var M=t[y],_=M.material;if(void 0!==_&&0!==_.opacity)if(g.makeEmpty(),M instanceof RenderableSprite)(s=M).x*=o,s.y*=-a,B(s,M,_);else if(M instanceof RenderableLine)s=M.v1,l=M.v2,s.positionScreen.x*=o,s.positionScreen.y*=-a,l.positionScreen.x*=o,l.positionScreen.y*=-a,g.setFromPoints([s.positionScreen,l.positionScreen]),!0===v.intersectsBox(g)&&U(s,l,M,_);else if(M instanceof RenderableFace){if(s=M.v1,l=M.v2,u=M.v3,s.positionScreen.z<-1||s.positionScreen.z>1)continue;if(l.positionScreen.z<-1||l.positionScreen.z>1)continue;if(u.positionScreen.z<-1||u.positionScreen.z>1)continue;s.positionScreen.x*=o,s.positionScreen.y*=-a,l.positionScreen.x*=o,l.positionScreen.y*=-a,u.positionScreen.x*=o,u.positionScreen.y*=-a,g.setFromPoints([s.positionScreen,l.positionScreen,u.positionScreen]),!0===v.intersectsBox(g)&&V(s,l,u,M,_)}}z(),n.traverseVisible(function(e){if(e instanceof SVGObject){if(T.setFromMatrixPosition(e.matrixWorld),T.applyMatrix4(N),T.z<-1||T.z>1)return;var t=T.x*o,r=-T.y*a,n=e.node;n.setAttribute("transform","translate("+t+","+r+")"),m.appendChild(n)}})}else console.error("SVGRenderer.render: camera is not an instance of Camera.")}};function WebGLAnimation(){var e=null,t=!1,r=null;function n(i,o){!1!==t&&(r(i,o),e.requestAnimationFrame(n))}return{start:function(){!0!==t&&null!==r&&(e.requestAnimationFrame(n),t=!0)},stop:function(){t=!1},setAnimationLoop:function(e){r=e},setContext:function(t){e=t}}}function WebGLAttributes(e){var t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(r){r.isInterleavedBufferAttribute&&(r=r.data);var n=t.get(r);n&&(e.deleteBuffer(n.buffer),t.delete(r))},update:function(r,n){r.isInterleavedBufferAttribute&&(r=r.data);var i=t.get(r);void 0===i?t.set(r,function(t,r){var n=t.array,i=t.dynamic?e.DYNAMIC_DRAW:e.STATIC_DRAW,o=e.createBuffer();e.bindBuffer(r,o),e.bufferData(r,n,i),t.onUploadCallback();var a=e.FLOAT;return n instanceof Float32Array?a=e.FLOAT:n instanceof Float64Array?console.warn("WebGLAttributes: Unsupported data buffer format: Float64Array."):n instanceof Uint16Array?a=e.UNSIGNED_SHORT:n instanceof Int16Array?a=e.SHORT:n instanceof Uint32Array?a=e.UNSIGNED_INT:n instanceof Int32Array?a=e.INT:n instanceof Int8Array?a=e.BYTE:n instanceof Uint8Array&&(a=e.UNSIGNED_BYTE),{buffer:o,type:a,bytesPerElement:n.BYTES_PER_ELEMENT,version:t.version}}(r,n)):i.version<r.version&&(function(t,r,n){var i=r.array,o=r.updateRange;e.bindBuffer(n,t),!1===r.dynamic?e.bufferData(n,i,e.STATIC_DRAW):-1===o.count?e.bufferSubData(n,0,i):0===o.count?console.error("WebGLObjects.updateBuffer: dynamic BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(e.bufferSubData(n,o.offset*i.BYTES_PER_ELEMENT,i.subarray(o.offset,o.offset+o.count)),o.count=-1)}(i.buffer,r,n),i.version=r.version)}}}function WebGLBackground(e,t,r,n){var i,o,a=new Color(0),s=0,l=null,u=0;function c(e,r){t.buffers.color.setClear(e.r,e.g,e.b,r,n)}return{getClearColor:function(){return a},setClearColor:function(e,t){a.set(e),c(a,s=void 0!==t?t:1)},getClearAlpha:function(){return s},setClearAlpha:function(e){c(a,s=e)},render:function(t,n,h,p){var f=n.background;if(null===f?(c(a,s),l=null,u=0):f&&f.isColor&&(c(f,1),p=!0,l=null,u=0),(e.autoClear||p)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),f&&(f.isCubeTexture||f.isWebGLRenderTargetCube)){void 0===o&&((o=new Mesh(new BoxBufferGeometry(1,1,1),new ShaderMaterial({type:"BackgroundCubeMaterial",uniforms:cloneUniforms(ShaderLib.cube.uniforms),vertexShader:ShaderLib.cube.vertexShader,fragmentShader:ShaderLib.cube.fragmentShader,side:BackSide,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),o.geometry.removeAttribute("uv"),o.onBeforeRender=function(e,t,r){this.matrixWorld.copyPosition(r.matrixWorld)},Object.defineProperty(o.material,"map",{get:function(){return this.uniforms.tCube.value}}),r.update(o));var d=f.isWebGLRenderTargetCube?f.texture:f;o.material.uniforms.tCube.value=d,o.material.uniforms.tFlip.value=f.isWebGLRenderTargetCube?1:-1,l===f&&u===d.version||(o.material.needsUpdate=!0,l=f,u=d.version),t.unshift(o,o.geometry,o.material,0,0,null)}else f&&f.isTexture&&(void 0===i&&((i=new Mesh(new PlaneBufferGeometry(2,2),new ShaderMaterial({type:"BackgroundMaterial",uniforms:cloneUniforms(ShaderLib.background.uniforms),vertexShader:ShaderLib.background.vertexShader,fragmentShader:ShaderLib.background.fragmentShader,side:FrontSide,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),Object.defineProperty(i.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(i)),i.material.uniforms.t2D.value=f,!0===f.matrixAutoUpdate&&f.updateMatrix(),i.material.uniforms.uvTransform.value.copy(f.matrix),l===f&&u===f.version||(i.material.needsUpdate=!0,l=f,u=f.version),t.unshift(i,i.geometry,i.material,0,0,null))}}}function WebGLBufferRenderer(e,t,r,n){var i;this.setMode=function(e){i=e},this.render=function(t,n){e.drawArrays(i,t,n),r.update(n,i)},this.renderInstances=function(o,a,s){var l;if(n.isWebGL2)l=e;else if(null===(l=t.get("ANGLE_instanced_arrays")))return void console.error("WebGLBufferRenderer: using InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[n.isWebGL2?"drawArraysInstanced":"drawArraysInstancedANGLE"](i,a,s,o.maxInstancedCount),r.update(s,i,o.maxInstancedCount)}}function WebGLCapabilities(e,t,r){var n;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var o="undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext,a=void 0!==r.precision?r.precision:"highp",s=i(a);s!==a&&(console.warn("WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);var l=!0===r.logarithmicDepthBuffer,u=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),c=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),h=e.getParameter(e.MAX_TEXTURE_SIZE),p=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),f=e.getParameter(e.MAX_VERTEX_ATTRIBS),d=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),m=e.getParameter(e.MAX_VARYING_VECTORS),v=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),g=c>0,y=o||!!t.get("OES_texture_float");return{isWebGL2:o,getMaxAnisotropy:function(){if(void 0!==n)return n;var r=t.get("EXT_texture_filter_anisotropic");return n=null!==r?e.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:a,logarithmicDepthBuffer:l,maxTextures:u,maxVertexTextures:c,maxTextureSize:h,maxCubemapSize:p,maxAttributes:f,maxVertexUniforms:d,maxVaryings:m,maxFragmentUniforms:v,vertexTextures:g,floatFragmentTextures:y,floatVertexTextures:g&&y,maxSamples:o?e.getParameter(e.MAX_SAMPLES):0}}function WebGLClipping(){var e=this,t=null,r=0,n=!1,i=!1,o=new Plane,a=new Matrix3,s={value:null,needsUpdate:!1};function l(){s.value!==t&&(s.value=t,s.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function u(t,r,n,i){var l=null!==t?t.length:0,u=null;if(0!==l){if(u=s.value,!0!==i||null===u){var c=n+4*l,h=r.matrixWorldInverse;a.getNormalMatrix(h),(null===u||u.length<c)&&(u=new Float32Array(c));for(var p=0,f=n;p!==l;++p,f+=4)o.copy(t[p]).applyMatrix4(h,a),o.normal.toArray(u,f),u[f+3]=o.constant}s.value=u,s.needsUpdate=!0}return e.numPlanes=l,u}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(e,i,o){var a=0!==e.length||i||0!==r||n;return n=i,t=u(e,o,0),r=e.length,a},this.beginShadows=function(){i=!0,u(null)},this.endShadows=function(){i=!1,l()},this.setState=function(e,o,a,c,h,p){if(!n||null===e||0===e.length||i&&!a)i?u(null):l();else{var f=i?0:r,d=4*f,m=h.clippingState||null;s.value=m,m=u(e,c,d,p);for(var v=0;v!==d;++v)m[v]=t[v];h.clippingState=m,this.numIntersection=o?this.numPlanes:0,this.numPlanes+=f}}}function WebGLExtensions(e){var t={};return{get:function(r){if(void 0!==t[r])return t[r];var n;switch(r){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(r)}return null===n&&console.warn("WebGLRenderer: "+r+" extension not supported."),t[r]=n,n}}}function WebGLGeometries(e,t,r){var n={},i={};function o(e){var a=e.target,s=n[a.id];for(var l in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[l]);a.removeEventListener("dispose",o),delete n[a.id];var u=i[s.id];u&&(t.remove(u),delete i[s.id]),r.memory.geometries--}return{get:function(e,t){var i=n[t.id];return i||(t.addEventListener("dispose",o),t.isBufferGeometry?i=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new BufferGeometry).setFromObject(e)),i=t._bufferGeometry),n[t.id]=i,r.memory.geometries++,i)},update:function(r){var n=r.index,i=r.attributes;for(var o in null!==n&&t.update(n,e.ELEMENT_ARRAY_BUFFER),i)t.update(i[o],e.ARRAY_BUFFER);var a=r.morphAttributes;for(var o in a)for(var s=a[o],l=0,u=s.length;l<u;l++)t.update(s[l],e.ARRAY_BUFFER)},getWireframeAttribute:function(r){var n=i[r.id];if(n)return n;var o,a=[],s=r.index,l=r.attributes;if(null!==s)for(var u=0,c=(o=s.array).length;u<c;u+=3){var h=o[u+0],p=o[u+1],f=o[u+2];a.push(h,p,p,f,f,h)}else for(u=0,c=(o=l.position.array).length/3-1;u<c;u+=3)h=u+0,p=u+1,f=u+2,a.push(h,p,p,f,f,h);return n=new(arrayMax(a)>65535?Uint32BufferAttribute:Uint16BufferAttribute)(a,1),t.update(n,e.ELEMENT_ARRAY_BUFFER),i[r.id]=n,n}}}function WebGLIndexedBufferRenderer(e,t,r,n){var i,o,a;this.setMode=function(e){i=e},this.setIndex=function(e){o=e.type,a=e.bytesPerElement},this.render=function(t,n){e.drawElements(i,n,o,t*a),r.update(n,i)},this.renderInstances=function(s,l,u){var c;if(n.isWebGL2)c=e;else if(null===(c=t.get("ANGLE_instanced_arrays")))return void console.error("WebGLIndexedBufferRenderer: using InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[n.isWebGL2?"drawElementsInstanced":"drawElementsInstancedANGLE"](i,u,o,l*a,s.maxInstancedCount),r.update(u,i,s.maxInstancedCount)}}function WebGLInfo(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(r,n,i){switch(i=i||1,t.calls++,n){case e.TRIANGLES:t.triangles+=i*(r/3);break;case e.TRIANGLE_STRIP:case e.TRIANGLE_FAN:t.triangles+=i*(r-2);break;case e.LINES:t.lines+=i*(r/2);break;case e.LINE_STRIP:t.lines+=i*(r-1);break;case e.LINE_LOOP:t.lines+=i*r;break;case e.POINTS:t.points+=i*r;break;default:console.error("WebGLInfo: Unknown draw mode:",n)}}}}function absNumericalSort(e,t){return Math.abs(t[1])-Math.abs(e[1])}function WebGLMorphtargets(e){var t={},r=new Float32Array(8);return{update:function(n,i,o,a){var s=n.morphTargetInfluences,l=s.length,u=t[i.id];if(void 0===u){u=[];for(var c=0;c<l;c++)u[c]=[c,0];t[i.id]=u}var h=o.morphTargets&&i.morphAttributes.position,p=o.morphNormals&&i.morphAttributes.normal;for(c=0;c<l;c++)0!==(f=u[c])[1]&&(h&&i.removeAttribute("morphTarget"+c),p&&i.removeAttribute("morphNormal"+c));for(c=0;c<l;c++)(f=u[c])[0]=c,f[1]=s[c];for(u.sort(absNumericalSort),c=0;c<8;c++){var f;if(f=u[c]){var d=f[0],m=f[1];if(m){h&&i.addAttribute("morphTarget"+c,h[d]),p&&i.addAttribute("morphNormal"+c,p[d]),r[c]=m;continue}}r[c]=0}a.getUniforms().setValue(e,"morphTargetInfluences",r)}}}function WebGLObjects(e,t){var r={};return{update:function(n){var i=t.render.frame,o=n.geometry,a=e.get(n,o);return r[a.id]!==i&&(o.isGeometry&&a.updateFromObject(n),e.update(a),r[a.id]=i),a},dispose:function(){r={}}}}function DataTexture3D(e,t,r,n){Texture.call(this,null),this.image={data:e,width:t,height:r,depth:n},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1}DataTexture3D.prototype=Object.create(Texture.prototype),DataTexture3D.prototype.constructor=DataTexture3D,DataTexture3D.prototype.isDataTexture3D=!0;var emptyTexture=new Texture,emptyTexture3d=new DataTexture3D,emptyCubeTexture=new CubeTexture;function UniformContainer(){this.seq=[],this.map={}}var arrayCacheF32=[],arrayCacheI32=[],mat4array=new Float32Array(16),mat3array=new Float32Array(9),mat2array=new Float32Array(4);function flatten(e,t,r){var n=e[0];if(n<=0||n>0)return e;var i=t*r,o=arrayCacheF32[i];if(void 0===o&&(o=new Float32Array(i),arrayCacheF32[i]=o),0!==t){n.toArray(o,0);for(var a=1,s=0;a!==t;++a)s+=r,e[a].toArray(o,s)}return o}function arraysEqual(e,t){if(e.length!==t.length)return!1;for(var r=0,n=e.length;r<n;r++)if(e[r]!==t[r])return!1;return!0}function copyArray(e,t){for(var r=0,n=t.length;r<n;r++)e[r]=t[r]}function allocTexUnits(e,t){var r=arrayCacheI32[t];void 0===r&&(r=new Int32Array(t),arrayCacheI32[t]=r);for(var n=0;n!==t;++n)r[n]=e.allocTextureUnit();return r}function setValue1f(e,t){var r=this.cache;r[0]!==t&&(e.uniform1f(this.addr,t),r[0]=t)}function setValue1i(e,t){var r=this.cache;r[0]!==t&&(e.uniform1i(this.addr,t),r[0]=t)}function setValue2fv(e,t){var r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(arraysEqual(r,t))return;e.uniform2fv(this.addr,t),copyArray(r,t)}}function setValue3fv(e,t){var r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y&&r[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else if(void 0!==t.r)r[0]===t.r&&r[1]===t.g&&r[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),r[0]=t.r,r[1]=t.g,r[2]=t.b);else{if(arraysEqual(r,t))return;e.uniform3fv(this.addr,t),copyArray(r,t)}}function setValue4fv(e,t){var r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y&&r[2]===t.z&&r[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(arraysEqual(r,t))return;e.uniform4fv(this.addr,t),copyArray(r,t)}}function setValue2fm(e,t){var r=this.cache,n=t.elements;if(void 0===n){if(arraysEqual(r,t))return;e.uniformMatrix2fv(this.addr,!1,t),copyArray(r,t)}else{if(arraysEqual(r,n))return;mat2array.set(n),e.uniformMatrix2fv(this.addr,!1,mat2array),copyArray(r,n)}}function setValue3fm(e,t){var r=this.cache,n=t.elements;if(void 0===n){if(arraysEqual(r,t))return;e.uniformMatrix3fv(this.addr,!1,t),copyArray(r,t)}else{if(arraysEqual(r,n))return;mat3array.set(n),e.uniformMatrix3fv(this.addr,!1,mat3array),copyArray(r,n)}}function setValue4fm(e,t){var r=this.cache,n=t.elements;if(void 0===n){if(arraysEqual(r,t))return;e.uniformMatrix4fv(this.addr,!1,t),copyArray(r,t)}else{if(arraysEqual(r,n))return;mat4array.set(n),e.uniformMatrix4fv(this.addr,!1,mat4array),copyArray(r,n)}}function setValueT1(e,t,r){var n=this.cache,i=r.allocTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTexture2D(t||emptyTexture,i)}function setValueT3D1(e,t,r){var n=this.cache,i=r.allocTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTexture3D(t||emptyTexture3d,i)}function setValueT6(e,t,r){var n=this.cache,i=r.allocTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTextureCube(t||emptyCubeTexture,i)}function setValue2iv(e,t){var r=this.cache;arraysEqual(r,t)||(e.uniform2iv(this.addr,t),copyArray(r,t))}function setValue3iv(e,t){var r=this.cache;arraysEqual(r,t)||(e.uniform3iv(this.addr,t),copyArray(r,t))}function setValue4iv(e,t){var r=this.cache;arraysEqual(r,t)||(e.uniform4iv(this.addr,t),copyArray(r,t))}function getSingularSetter(e){switch(e){case 5126:return setValue1f;case 35664:return setValue2fv;case 35665:return setValue3fv;case 35666:return setValue4fv;case 35674:return setValue2fm;case 35675:return setValue3fm;case 35676:return setValue4fm;case 35678:case 36198:return setValueT1;case 35679:return setValueT3D1;case 35680:return setValueT6;case 5124:case 35670:return setValue1i;case 35667:case 35671:return setValue2iv;case 35668:case 35672:return setValue3iv;case 35669:case 35673:return setValue4iv}}function setValue1fv(e,t){var r=this.cache;arraysEqual(r,t)||(e.uniform1fv(this.addr,t),copyArray(r,t))}function setValue1iv(e,t){var r=this.cache;arraysEqual(r,t)||(e.uniform1iv(this.addr,t),copyArray(r,t))}function setValueV2a(e,t){var r=this.cache,n=flatten(t,this.size,2);arraysEqual(r,n)||(e.uniform2fv(this.addr,n),this.updateCache(n))}function setValueV3a(e,t){var r=this.cache,n=flatten(t,this.size,3);arraysEqual(r,n)||(e.uniform3fv(this.addr,n),this.updateCache(n))}function setValueV4a(e,t){var r=this.cache,n=flatten(t,this.size,4);arraysEqual(r,n)||(e.uniform4fv(this.addr,n),this.updateCache(n))}function setValueM2a(e,t){var r=this.cache,n=flatten(t,this.size,4);arraysEqual(r,n)||(e.uniformMatrix2fv(this.addr,!1,n),this.updateCache(n))}function setValueM3a(e,t){var r=this.cache,n=flatten(t,this.size,9);arraysEqual(r,n)||(e.uniformMatrix3fv(this.addr,!1,n),this.updateCache(n))}function setValueM4a(e,t){var r=this.cache,n=flatten(t,this.size,16);arraysEqual(r,n)||(e.uniformMatrix4fv(this.addr,!1,n),this.updateCache(n))}function setValueT1a(e,t,r){var n=this.cache,i=t.length,o=allocTexUnits(r,i);!1===arraysEqual(n,o)&&(e.uniform1iv(this.addr,o),copyArray(n,o));for(var a=0;a!==i;++a)r.setTexture2D(t[a]||emptyTexture,o[a])}function setValueT6a(e,t,r){var n=this.cache,i=t.length,o=allocTexUnits(r,i);!1===arraysEqual(n,o)&&(e.uniform1iv(this.addr,o),copyArray(n,o));for(var a=0;a!==i;++a)r.setTextureCube(t[a]||emptyCubeTexture,o[a])}function getPureArraySetter(e){switch(e){case 5126:return setValue1fv;case 35664:return setValueV2a;case 35665:return setValueV3a;case 35666:return setValueV4a;case 35674:return setValueM2a;case 35675:return setValueM3a;case 35676:return setValueM4a;case 35678:return setValueT1a;case 35680:return setValueT6a;case 5124:case 35670:return setValue1iv;case 35667:case 35671:return setValue2iv;case 35668:case 35672:return setValue3iv;case 35669:case 35673:return setValue4iv}}function SingleUniform(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=getSingularSetter(t.type)}function PureArrayUniform(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=getPureArraySetter(t.type)}function StructuredUniform(e){this.id=e,UniformContainer.call(this)}PureArrayUniform.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),copyArray(t,e)},StructuredUniform.prototype.setValue=function(e,t,r){for(var n=this.seq,i=0,o=n.length;i!==o;++i){var a=n[i];a.setValue(e,t[a.id],r)}};var RePathPart=/([\w\d_]+)(\])?(\[|\.)?/g;function addUniform(e,t){e.seq.push(t),e.map[t.id]=t}function parseUniform(e,t,r){var n=e.name,i=n.length;for(RePathPart.lastIndex=0;;){var o=RePathPart.exec(n),a=RePathPart.lastIndex,s=o[1],l="]"===o[2],u=o[3];if(l&&(s|=0),void 0===u||"["===u&&a+2===i){addUniform(r,void 0===u?new SingleUniform(s,e,t):new PureArrayUniform(s,e,t));break}var c=r.map[s];void 0===c&&addUniform(r,c=new StructuredUniform(s)),r=c}}function WebGLUniforms(e,t,r){UniformContainer.call(this),this.renderer=r;for(var n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),i=0;i<n;++i){var o=e.getActiveUniform(t,i);parseUniform(o,e.getUniformLocation(t,o.name),this)}}function addLineNumbers(e){for(var t=e.split("\n"),r=0;r<t.length;r++)t[r]=r+1+": "+t[r];return t.join("\n")}function WebGLShader(e,t,r){var n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),!1===e.getShaderParameter(n,e.COMPILE_STATUS)&&console.error("WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(n)&&console.warn("WebGLShader: gl.getShaderInfoLog()",t===e.VERTEX_SHADER?"vertex":"fragment",e.getShaderInfoLog(n),addLineNumbers(r)),n}WebGLUniforms.prototype.setValue=function(e,t,r){var n=this.map[t];void 0!==n&&n.setValue(e,r,this.renderer)},WebGLUniforms.prototype.setOptional=function(e,t,r){var n=t[r];void 0!==n&&this.setValue(e,r,n)},WebGLUniforms.upload=function(e,t,r,n){for(var i=0,o=t.length;i!==o;++i){var a=t[i],s=r[a.id];!1!==s.needsUpdate&&a.setValue(e,s.value,n)}},WebGLUniforms.seqWithValue=function(e,t){for(var r=[],n=0,i=e.length;n!==i;++n){var o=e[n];o.id in t&&r.push(o)}return r};var programIdCount=0;function getEncodingComponents(e){switch(e){case LinearEncoding:return["Linear","( value )"];case sRGBEncoding:return["sRGB","( value )"];case RGBEEncoding:return["RGBE","( value )"];case RGBM7Encoding:return["RGBM","( value, 7.0 )"];case RGBM16Encoding:return["RGBM","( value, 16.0 )"];case RGBDEncoding:return["RGBD","( value, 256.0 )"];case GammaEncoding:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+e)}}function getTexelDecodingFunction(e,t){var r=getEncodingComponents(t);return"vec4 "+e+"( vec4 value ) { return "+r[0]+"ToLinear"+r[1]+"; }"}function getTexelEncodingFunction(e,t){var r=getEncodingComponents(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function getToneMappingFunction(e,t){var r;switch(t){case LinearToneMapping:r="Linear";break;case ReinhardToneMapping:r="Reinhard";break;case Uncharted2ToneMapping:r="Uncharted2";break;case CineonToneMapping:r="OptimizedCineon";break;case ACESFilmicToneMapping:r="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function generateExtensions(e,t,r){return[(e=e||{}).derivatives||t.envMapCubeUV||t.bumpMap||t.normalMap&&!t.objectSpaceNormalMap||t.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||t.logarithmicDepthBuffer)&&r.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&r.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||t.envMap)&&r.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(filterEmptyLine).join("\n")}function generateDefines(e){var t=[];for(var r in e){var n=e[r];!1!==n&&t.push("#define "+r+" "+n)}return t.join("\n")}function fetchAttributeLocations(e,t){for(var r={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i=0;i<n;i++){var o=e.getActiveAttrib(t,i).name;r[o]=e.getAttribLocation(t,o)}return r}function filterEmptyLine(e){return""!==e}function replaceLightNums(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function replaceClippingPlaneNums(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}function parseIncludes(e){return e.replace(/^[ \t]*#include +<([\w\d.\/]+)>/gm,function(e,t){var r=ShaderChunk[t];if(void 0===r)throw new Error("Can not resolve #include <"+t+">");return parseIncludes(r)})}function unrollLoops(e){return e.replace(/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(e,t,r,n){for(var i="",o=parseInt(t);o<parseInt(r);o++)i+=n.replace(/\[ i \]/g,"[ "+o+" ]");return i})}function WebGLProgram(e,t,r,n,i,o,a){var s=e.context,l=n.defines,u=i.vertexShader,c=i.fragmentShader,h="SHADOWMAP_TYPE_BASIC";o.shadowMapType===PCFShadowMap?h="SHADOWMAP_TYPE_PCF":o.shadowMapType===PCFSoftShadowMap&&(h="SHADOWMAP_TYPE_PCF_SOFT");var p="ENVMAP_TYPE_CUBE",f="ENVMAP_MODE_REFLECTION",d="ENVMAP_BLENDING_MULTIPLY";if(o.envMap){switch(n.envMap.mapping){case CubeReflectionMapping:case CubeRefractionMapping:p="ENVMAP_TYPE_CUBE";break;case CubeUVReflectionMapping:case CubeUVRefractionMapping:p="ENVMAP_TYPE_CUBE_UV";break;case EquirectangularReflectionMapping:case EquirectangularRefractionMapping:p="ENVMAP_TYPE_EQUIREC";break;case SphericalReflectionMapping:p="ENVMAP_TYPE_SPHERE"}switch(n.envMap.mapping){case CubeRefractionMapping:case EquirectangularRefractionMapping:f="ENVMAP_MODE_REFRACTION"}switch(n.combine){case MultiplyOperation:d="ENVMAP_BLENDING_MULTIPLY";break;case MixOperation:d="ENVMAP_BLENDING_MIX";break;case AddOperation:d="ENVMAP_BLENDING_ADD"}}var m,v,g=e.gammaFactor>0?e.gammaFactor:1,y=a.isWebGL2?"":generateExtensions(n.extensions,o,t),b=generateDefines(l),x=s.createProgram();if(n.isRawShaderMaterial?((m=[b].filter(filterEmptyLine).join("\n")).length>0&&(m+="\n"),(v=[y,b].filter(filterEmptyLine).join("\n")).length>0&&(v+="\n")):(m=["precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,b,o.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+g,"#define MAX_BONES "+o.maxBones,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+f:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.normalMap&&o.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",o.displacementMap&&o.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexTangents?"#define USE_TANGENT":"",o.vertexColors?"#define USE_COLOR":"",o.flatShading?"#define FLAT_SHADED":"",o.skinning?"#define USE_SKINNING":"",o.useVertexTexture?"#define BONE_TEXTURE":"",o.morphTargets?"#define USE_MORPHTARGETS":"",o.morphNormals&&!1===o.flatShading?"#define USE_MORPHNORMALS":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+h:"",o.sizeAttenuation?"#define USE_SIZEATTENUATION":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&(a.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(filterEmptyLine).join("\n"),v=[y,"precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,b,o.alphaTest?"#define ALPHATEST "+o.alphaTest+(o.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+g,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.matcap?"#define USE_MATCAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+p:"",o.envMap?"#define "+f:"",o.envMap?"#define "+d:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.normalMap&&o.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexTangents?"#define USE_TANGENT":"",o.vertexColors?"#define USE_COLOR":"",o.gradientMap?"#define USE_GRADIENTMAP":"",o.flatShading?"#define FLAT_SHADED":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+h:"",o.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",o.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&(a.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"",o.envMap&&(a.isWebGL2||t.get("EXT_shader_texture_lod"))?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",o.toneMapping!==NoToneMapping?"#define TONE_MAPPING":"",o.toneMapping!==NoToneMapping?ShaderChunk.tonemapping_pars_fragment:"",o.toneMapping!==NoToneMapping?getToneMappingFunction("toneMapping",o.toneMapping):"",o.dithering?"#define DITHERING":"",o.outputEncoding||o.mapEncoding||o.matcapEncoding||o.envMapEncoding||o.emissiveMapEncoding?ShaderChunk.encodings_pars_fragment:"",o.mapEncoding?getTexelDecodingFunction("mapTexelToLinear",o.mapEncoding):"",o.matcapEncoding?getTexelDecodingFunction("matcapTexelToLinear",o.matcapEncoding):"",o.envMapEncoding?getTexelDecodingFunction("envMapTexelToLinear",o.envMapEncoding):"",o.emissiveMapEncoding?getTexelDecodingFunction("emissiveMapTexelToLinear",o.emissiveMapEncoding):"",o.outputEncoding?getTexelEncodingFunction("linearToOutputTexel",o.outputEncoding):"",o.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(filterEmptyLine).join("\n")),u=replaceClippingPlaneNums(u=replaceLightNums(u=parseIncludes(u),o),o),c=replaceClippingPlaneNums(c=replaceLightNums(c=parseIncludes(c),o),o),u=unrollLoops(u),c=unrollLoops(c),a.isWebGL2&&!n.isRawShaderMaterial){var w=!1,S=/^\s*#version\s+300\s+es\s*\n/;n.isShaderMaterial&&null!==u.match(S)&&null!==c.match(S)&&(w=!0,u=u.replace(S,""),c=c.replace(S,"")),m=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+m,v=["#version 300 es\n","#define varying in",w?"":"out highp vec4 pc_fragColor;",w?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+v}var M=m+u,_=v+c,T=WebGLShader(s,s.VERTEX_SHADER,M),A=WebGLShader(s,s.FRAGMENT_SHADER,_);s.attachShader(x,T),s.attachShader(x,A),void 0!==n.index0AttributeName?s.bindAttribLocation(x,0,n.index0AttributeName):!0===o.morphTargets&&s.bindAttribLocation(x,0,"position"),s.linkProgram(x);var C,E,L=s.getProgramInfoLog(x).trim(),N=s.getShaderInfoLog(T).trim(),P=s.getShaderInfoLog(A).trim(),O=!0,R=!0;return!1===s.getProgramParameter(x,s.LINK_STATUS)?(O=!1,console.error("WebGLProgram: shader error: ",s.getError(),"gl.VALIDATE_STATUS",s.getProgramParameter(x,s.VALIDATE_STATUS),"gl.getProgramInfoLog",L,N,P)):""!==L?console.warn("WebGLProgram: gl.getProgramInfoLog()",L):""!==N&&""!==P||(R=!1),R&&(this.diagnostics={runnable:O,material:n,programLog:L,vertexShader:{log:N,prefix:m},fragmentShader:{log:P,prefix:v}}),s.deleteShader(T),s.deleteShader(A),this.getUniforms=function(){return void 0===C&&(C=new WebGLUniforms(s,x,e)),C},this.getAttributes=function(){return void 0===E&&(E=fetchAttributeLocations(s,x)),E},this.destroy=function(){s.deleteProgram(x),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.name=i.name,this.id=programIdCount++,this.code=r,this.usedTimes=1,this.program=x,this.vertexShader=T,this.fragmentShader=A,this}function WebGLPrograms(e,t,r){var n=[],i={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},o=["precision","supportsVertexTextures","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function a(e,t){var r;return e?e.isTexture?r=e.encoding:e.isWebGLRenderTarget&&(console.warn("WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),r=e.texture.encoding):r=LinearEncoding,r===LinearEncoding&&t&&(r=GammaEncoding),r}this.getParameters=function(t,n,o,s,l,u,c){var h=i[t.type],p=c.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(r.floatVertexTextures)return 1024;var n=r.maxVertexUniforms,i=Math.floor((n-20)/4),o=Math.min(i,t.length);return o<t.length?(console.warn("WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+o+"."),0):o}(c):0,f=r.precision;null!==t.precision&&(f=r.getMaxPrecision(t.precision))!==t.precision&&console.warn("WebGLProgram.getParameters:",t.precision,"not supported, using",f,"instead.");var d=e.getRenderTarget();return{shaderID:h,precision:f,supportsVertexTextures:r.vertexTextures,outputEncoding:a(d?d.texture:null,e.gammaOutput),map:!!t.map,mapEncoding:a(t.map,e.gammaInput),matcap:!!t.matcap,matcapEncoding:a(t.matcap,e.gammaInput),envMap:!!t.envMap,envMapMode:t.envMap&&t.envMap.mapping,envMapEncoding:a(t.envMap,e.gammaInput),envMapCubeUV:!!t.envMap&&(t.envMap.mapping===CubeUVReflectionMapping||t.envMap.mapping===CubeUVRefractionMapping),lightMap:!!t.lightMap,aoMap:!!t.aoMap,emissiveMap:!!t.emissiveMap,emissiveMapEncoding:a(t.emissiveMap,e.gammaInput),bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,objectSpaceNormalMap:t.normalMapType===ObjectSpaceNormalMap,displacementMap:!!t.displacementMap,roughnessMap:!!t.roughnessMap,metalnessMap:!!t.metalnessMap,specularMap:!!t.specularMap,alphaMap:!!t.alphaMap,gradientMap:!!t.gradientMap,combine:t.combine,vertexTangents:t.normalMap&&t.vertexTangents,vertexColors:t.vertexColors,fog:!!s,useFog:t.fog,fogExp:s&&s.isFogExp2,flatShading:t.flatShading,sizeAttenuation:t.sizeAttenuation,logarithmicDepthBuffer:r.logarithmicDepthBuffer,skinning:t.skinning&&p>0,maxBones:p,useVertexTexture:r.floatVertexTextures,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:n.directional.length,numPointLights:n.point.length,numSpotLights:n.spot.length,numRectAreaLights:n.rectArea.length,numHemiLights:n.hemi.length,numClippingPlanes:l,numClipIntersection:u,dithering:t.dithering,shadowMapEnabled:e.shadowMap.enabled&&c.receiveShadow&&o.length>0,shadowMapType:e.shadowMap.type,toneMapping:e.toneMapping,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:t.premultipliedAlpha,alphaTest:t.alphaTest,doubleSided:t.side===DoubleSide,flipSided:t.side===BackSide,depthPacking:void 0!==t.depthPacking&&t.depthPacking}},this.getProgramCode=function(t,r){var n=[];if(r.shaderID?n.push(r.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var i in t.defines)n.push(i),n.push(t.defines[i]);for(var a=0;a<o.length;a++)n.push(r[o[a]]);return n.push(t.onBeforeCompile.toString()),n.push(e.gammaOutput),n.push(e.gammaFactor),n.join()},this.acquireProgram=function(i,o,a,s){for(var l,u=0,c=n.length;u<c;u++){var h=n[u];if(h.code===s){++(l=h).usedTimes;break}}return void 0===l&&(l=new WebGLProgram(e,t,s,i,o,a,r),n.push(l)),l},this.releaseProgram=function(e){if(0===--e.usedTimes){var t=n.indexOf(e);n[t]=n[n.length-1],n.pop(),e.destroy()}},this.programs=n}function WebGLProperties(){var e=new WeakMap;return{get:function(t){var r=e.get(t);return void 0===r&&(r={},e.set(t,r)),r},remove:function(t){e.delete(t)},update:function(t,r,n){e.get(t)[r]=n},dispose:function(){e=new WeakMap}}}function painterSortStable(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program&&t.program&&e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function reversePainterSortStable(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function WebGLRenderList(){var e=[],t=0,r=[],n=[];function i(r,n,i,o,a,s){var l=e[t];return void 0===l?(l={id:r.id,object:r,geometry:n,material:i,program:i.program,groupOrder:o,renderOrder:r.renderOrder,z:a,group:s},e[t]=l):(l.id=r.id,l.object=r,l.geometry=n,l.material=i,l.program=i.program,l.groupOrder=o,l.renderOrder=r.renderOrder,l.z=a,l.group=s),t++,l}return{opaque:r,transparent:n,init:function(){t=0,r.length=0,n.length=0},push:function(e,t,o,a,s,l){var u=i(e,t,o,a,s,l);(!0===o.transparent?n:r).push(u)},unshift:function(e,t,o,a,s,l){var u=i(e,t,o,a,s,l);(!0===o.transparent?n:r).unshift(u)},sort:function(){r.length>1&&r.sort(painterSortStable),n.length>1&&n.sort(reversePainterSortStable)}}}function WebGLRenderLists(){var e={};function t(r){var n=r.target;n.removeEventListener("dispose",t),delete e[n.id]}return{get:function(r,n){var i,o=e[r.id];return void 0===o?(i=new WebGLRenderList,e[r.id]={},e[r.id][n.id]=i,r.addEventListener("dispose",t)):void 0===(i=o[n.id])&&(i=new WebGLRenderList,o[n.id]=i),i},dispose:function(){e={}}}}function UniformsCache(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var r;switch(t.type){case"DirectionalLight":r={direction:new Vector3,color:new Color,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"SpotLight":r={position:new Vector3,direction:new Vector3,color:new Color,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"PointLight":r={position:new Vector3,color:new Color,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Vector2,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":r={direction:new Vector3,skyColor:new Color,groundColor:new Color};break;case"RectAreaLight":r={color:new Color,position:new Vector3,halfWidth:new Vector3,halfHeight:new Vector3}}return e[t.id]=r,r}}}var count=0;function WebGLLights(){var e=new UniformsCache,t={id:count++,hash:{stateID:-1,directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,shadowsLength:-1},ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},r=new Vector3,n=new Matrix4,i=new Matrix4;return{setup:function(o,a,s){for(var l=0,u=0,c=0,h=0,p=0,f=0,d=0,m=0,v=s.matrixWorldInverse,g=0,y=o.length;g<y;g++){var b=o[g],x=b.color,w=b.intensity,S=b.distance,M=b.shadow&&b.shadow.map?b.shadow.map.texture:null;if(b.isAmbientLight)l+=x.r*w,u+=x.g*w,c+=x.b*w;else if(b.isDirectionalLight){if((T=e.get(b)).color.copy(b.color).multiplyScalar(b.intensity),T.direction.setFromMatrixPosition(b.matrixWorld),r.setFromMatrixPosition(b.target.matrixWorld),T.direction.sub(r),T.direction.transformDirection(v),T.shadow=b.castShadow,b.castShadow){var _=b.shadow;T.shadowBias=_.bias,T.shadowRadius=_.radius,T.shadowMapSize=_.mapSize}t.directionalShadowMap[h]=M,t.directionalShadowMatrix[h]=b.shadow.matrix,t.directional[h]=T,h++}else if(b.isSpotLight)(T=e.get(b)).position.setFromMatrixPosition(b.matrixWorld),T.position.applyMatrix4(v),T.color.copy(x).multiplyScalar(w),T.distance=S,T.direction.setFromMatrixPosition(b.matrixWorld),r.setFromMatrixPosition(b.target.matrixWorld),T.direction.sub(r),T.direction.transformDirection(v),T.coneCos=Math.cos(b.angle),T.penumbraCos=Math.cos(b.angle*(1-b.penumbra)),T.decay=b.decay,T.shadow=b.castShadow,b.castShadow&&(_=b.shadow,T.shadowBias=_.bias,T.shadowRadius=_.radius,T.shadowMapSize=_.mapSize),t.spotShadowMap[f]=M,t.spotShadowMatrix[f]=b.shadow.matrix,t.spot[f]=T,f++;else if(b.isRectAreaLight)(T=e.get(b)).color.copy(x).multiplyScalar(w),T.position.setFromMatrixPosition(b.matrixWorld),T.position.applyMatrix4(v),i.identity(),n.copy(b.matrixWorld),n.premultiply(v),i.extractRotation(n),T.halfWidth.set(.5*b.width,0,0),T.halfHeight.set(0,.5*b.height,0),T.halfWidth.applyMatrix4(i),T.halfHeight.applyMatrix4(i),t.rectArea[d]=T,d++;else if(b.isPointLight)(T=e.get(b)).position.setFromMatrixPosition(b.matrixWorld),T.position.applyMatrix4(v),T.color.copy(b.color).multiplyScalar(b.intensity),T.distance=b.distance,T.decay=b.decay,T.shadow=b.castShadow,b.castShadow&&(_=b.shadow,T.shadowBias=_.bias,T.shadowRadius=_.radius,T.shadowMapSize=_.mapSize,T.shadowCameraNear=_.camera.near,T.shadowCameraFar=_.camera.far),t.pointShadowMap[p]=M,t.pointShadowMatrix[p]=b.shadow.matrix,t.point[p]=T,p++;else if(b.isHemisphereLight){var T;(T=e.get(b)).direction.setFromMatrixPosition(b.matrixWorld),T.direction.transformDirection(v),T.direction.normalize(),T.skyColor.copy(b.color).multiplyScalar(w),T.groundColor.copy(b.groundColor).multiplyScalar(w),t.hemi[m]=T,m++}}t.ambient[0]=l,t.ambient[1]=u,t.ambient[2]=c,t.directional.length=h,t.spot.length=f,t.rectArea.length=d,t.point.length=p,t.hemi.length=m,t.hash.stateID=t.id,t.hash.directionalLength=h,t.hash.pointLength=p,t.hash.spotLength=f,t.hash.rectAreaLength=d,t.hash.hemiLength=m,t.hash.shadowsLength=a.length},state:t}}function WebGLRenderState(){var e=new WebGLLights,t=[],r=[];return{init:function(){t.length=0,r.length=0},state:{lightsArray:t,shadowsArray:r,lights:e},setupLights:function(n){e.setup(t,r,n)},pushLight:function(e){t.push(e)},pushShadow:function(e){r.push(e)}}}function WebGLRenderStates(){var e={};function t(r){var n=r.target;n.removeEventListener("dispose",t),delete e[n.id]}return{get:function(r,n){var i;return void 0===e[r.id]?(i=new WebGLRenderState,e[r.id]={},e[r.id][n.id]=i,r.addEventListener("dispose",t)):void 0===e[r.id][n.id]?(i=new WebGLRenderState,e[r.id][n.id]=i):i=e[r.id][n.id],i},dispose:function(){e={}}}}function WebGLShadowMap(e,t,r){for(var n=new Frustum,i=new Matrix4,o=new Vector2,a=new Vector2(r,r),s=new Vector3,l=new Vector3,u=1,c=2,h=1+(u|c),p=new Array(h),f=new Array(h),d={},m={0:BackSide,1:FrontSide,2:DoubleSide},v=[new Vector3(1,0,0),new Vector3(-1,0,0),new Vector3(0,0,1),new Vector3(0,0,-1),new Vector3(0,1,0),new Vector3(0,-1,0)],g=[new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,0,1),new Vector3(0,0,-1)],y=[new Vector4,new Vector4,new Vector4,new Vector4,new Vector4,new Vector4],b=0;b!==h;++b){var x=0!==(b&u),w=0!==(b&c),S=new MeshDepthMaterial({depthPacking:RGBADepthPacking,morphTargets:x,skinning:w});p[b]=S;var M=new MeshDistanceMaterial({morphTargets:x,skinning:w});f[b]=M}var _=this;function T(t,r,n,i,o,a){var s=t.geometry,l=null,h=p,v=t.customDepthMaterial;if(n&&(h=f,v=t.customDistanceMaterial),v)l=v;else{var g=!1;r.morphTargets&&(s&&s.isBufferGeometry?g=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:s&&s.isGeometry&&(g=s.morphTargets&&s.morphTargets.length>0)),t.isSkinnedMesh&&!1===r.skinning&&console.warn("WebGLShadowMap: SkinnedMesh with material.skinning set to false:",t);var y=t.isSkinnedMesh&&r.skinning,b=0;g&&(b|=u),y&&(b|=c),l=h[b]}if(e.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length){var x=l.uuid,w=r.uuid,S=d[x];void 0===S&&(S={},d[x]=S);var M=S[w];void 0===M&&(M=l.clone(),S[w]=M),l=M}return l.visible=r.visible,l.wireframe=r.wireframe,l.side=null!=r.shadowSide?r.shadowSide:m[r.side],l.clipShadows=r.clipShadows,l.clippingPlanes=r.clippingPlanes,l.clipIntersection=r.clipIntersection,l.wireframeLinewidth=r.wireframeLinewidth,l.linewidth=r.linewidth,n&&l.isMeshDistanceMaterial&&(l.referencePosition.copy(i),l.nearDistance=o,l.farDistance=a),l}function A(r,i,o,a){if(!1!==r.visible){if(r.layers.test(i.layers)&&(r.isMesh||r.isLine||r.isPoints)&&r.castShadow&&(!r.frustumCulled||n.intersectsObject(r))){r.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,r.matrixWorld);var s=t.update(r),u=r.material;if(Array.isArray(u))for(var c=s.groups,h=0,p=c.length;h<p;h++){var f=c[h],d=u[f.materialIndex];if(d&&d.visible){var m=T(r,d,a,l,o.near,o.far);e.renderBufferDirect(o,null,s,m,r,f)}}else if(u.visible){m=T(r,u,a,l,o.near,o.far);e.renderBufferDirect(o,null,s,m,r,null)}}for(var v=r.children,g=0,y=v.length;g<y;g++)A(v[g],i,o,a)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=PCFShadowMap,this.render=function(t,r,u){if(!1!==_.enabled&&(!1!==_.autoUpdate||!1!==_.needsUpdate)&&0!==t.length){var c,h=e.getRenderTarget(),p=e.state;p.setBlending(NoBlending),p.buffers.color.setClear(1,1,1,1),p.buffers.depth.setTest(!0),p.setScissorTest(!1);for(var f=0,d=t.length;f<d;f++){var m=t[f],b=m.shadow,x=m&&m.isPointLight;if(void 0!==b){var w=b.camera;if(o.copy(b.mapSize),o.min(a),x){var S=o.x,M=o.y;y[0].set(2*S,M,S,M),y[1].set(0,M,S,M),y[2].set(3*S,M,S,M),y[3].set(S,M,S,M),y[4].set(3*S,0,S,M),y[5].set(S,0,S,M),o.x*=4,o.y*=2}if(null===b.map){var T={minFilter:NearestFilter,magFilter:NearestFilter,format:RGBAFormat};b.map=new WebGLRenderTarget(o.x,o.y,T),b.map.texture.name=m.name+".shadowMap",w.updateProjectionMatrix()}b.isSpotLightShadow&&b.update(m);var C=b.map,E=b.matrix;l.setFromMatrixPosition(m.matrixWorld),w.position.copy(l),x?(c=6,E.makeTranslation(-l.x,-l.y,-l.z)):(c=1,s.setFromMatrixPosition(m.target.matrixWorld),w.lookAt(s),w.updateMatrixWorld(),E.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),E.multiply(w.projectionMatrix),E.multiply(w.matrixWorldInverse)),e.setRenderTarget(C),e.clear();for(var L=0;L<c;L++){if(x){s.copy(w.position),s.add(v[L]),w.up.copy(g[L]),w.lookAt(s),w.updateMatrixWorld();var N=y[L];p.viewport(N)}i.multiplyMatrices(w.projectionMatrix,w.matrixWorldInverse),n.setFromMatrix(i),A(r,u,w,x)}}else console.warn("WebGLShadowMap:",m,"has no shadow.")}_.needsUpdate=!1,e.setRenderTarget(h)}}}function WebGLState(e,t,r,n){var i=new function(){var t=!1,r=new Vector4,n=null,i=new Vector4(0,0,0,0);return{setMask:function(r){n===r||t||(e.colorMask(r,r,r,r),n=r)},setLocked:function(e){t=e},setClear:function(t,n,o,a,s){!0===s&&(t*=a,n*=a,o*=a),r.set(t,n,o,a),!1===i.equals(r)&&(e.clearColor(t,n,o,a),i.copy(r))},reset:function(){t=!1,n=null,i.set(-1,0,0,0)}}},o=new function(){var t=!1,r=null,n=null,i=null;return{setTest:function(t){t?U(e.DEPTH_TEST):V(e.DEPTH_TEST)},setMask:function(n){r===n||t||(e.depthMask(n),r=n)},setFunc:function(t){if(n!==t){if(t)switch(t){case NeverDepth:e.depthFunc(e.NEVER);break;case AlwaysDepth:e.depthFunc(e.ALWAYS);break;case LessDepth:e.depthFunc(e.LESS);break;case LessEqualDepth:e.depthFunc(e.LEQUAL);break;case EqualDepth:e.depthFunc(e.EQUAL);break;case GreaterEqualDepth:e.depthFunc(e.GEQUAL);break;case GreaterDepth:e.depthFunc(e.GREATER);break;case NotEqualDepth:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}else e.depthFunc(e.LEQUAL);n=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,r=null,n=null,i=null}}},a=new function(){var t=!1,r=null,n=null,i=null,o=null,a=null,s=null,l=null,u=null;return{setTest:function(t){t?U(e.STENCIL_TEST):V(e.STENCIL_TEST)},setMask:function(n){r===n||t||(e.stencilMask(n),r=n)},setFunc:function(t,r,a){n===t&&i===r&&o===a||(e.stencilFunc(t,r,a),n=t,i=r,o=a)},setOp:function(t,r,n){a===t&&s===r&&l===n||(e.stencilOp(t,r,n),a=t,s=r,l=n)},setLocked:function(e){t=e},setClear:function(t){u!==t&&(e.clearStencil(t),u=t)},reset:function(){t=!1,r=null,n=null,i=null,o=null,a=null,s=null,l=null,u=null}}},s=e.getParameter(e.MAX_VERTEX_ATTRIBS),l=new Uint8Array(s),u=new Uint8Array(s),c=new Uint8Array(s),h={},p=null,f=null,d=null,m=null,v=null,g=null,y=null,b=null,x=null,w=null,S=!1,M=null,_=null,T=null,A=null,C=null,E=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),L=!1,N=0,P=e.getParameter(e.VERSION);-1!==P.indexOf("WebGL")?(N=parseFloat(/^WebGL\ ([0-9])/.exec(P)[1]),L=N>=1):-1!==P.indexOf("OpenGL ES")&&(N=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(P)[1]),L=N>=2);var O=null,R={},D=new Vector4,F=new Vector4;function k(t,r,n){var i=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(var a=0;a<n;a++)e.texImage2D(r+a,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,i);return o}var I={};function B(r,i){(l[r]=1,0===u[r]&&(e.enableVertexAttribArray(r),u[r]=1),c[r]!==i)&&((n.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](r,i),c[r]=i)}function U(t){!0!==h[t]&&(e.enable(t),h[t]=!0)}function V(t){!1!==h[t]&&(e.disable(t),h[t]=!1)}function j(t,n,i,o,a,s,l,u){if(t!==NoBlending){if(d||(U(e.BLEND),d=!0),t===CustomBlending)a=a||n,s=s||i,l=l||o,n===v&&a===b||(e.blendEquationSeparate(r.convert(n),r.convert(a)),v=n,b=a),i===g&&o===y&&s===x&&l===w||(e.blendFuncSeparate(r.convert(i),r.convert(o),r.convert(s),r.convert(l)),g=i,y=o,x=s,w=l),m=t,S=null;else if(t!==m||u!==S){if(v===AddEquation&&b===AddEquation||(e.blendEquation(e.FUNC_ADD),v=AddEquation,b=AddEquation),u)switch(t){case NormalBlending:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:e.blendFunc(e.ONE,e.ONE);break;case SubtractiveBlending:e.blendFuncSeparate(e.ZERO,e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ONE_MINUS_SRC_ALPHA);break;case MultiplyBlending:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("WebGLState: Invalid blending: ",t)}else switch(t){case NormalBlending:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case SubtractiveBlending:e.blendFunc(e.ZERO,e.ONE_MINUS_SRC_COLOR);break;case MultiplyBlending:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("WebGLState: Invalid blending: ",t)}g=null,y=null,x=null,w=null,m=t,S=u}}else d&&(V(e.BLEND),d=!1)}function z(t){M!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),M=t)}function G(t){t!==CullFaceNone?(U(e.CULL_FACE),t!==_&&(t===CullFaceBack?e.cullFace(e.BACK):t===CullFaceFront?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):V(e.CULL_FACE),_=t}function W(t,r,n){t?(U(e.POLYGON_OFFSET_FILL),A===r&&C===n||(e.polygonOffset(r,n),A=r,C=n)):V(e.POLYGON_OFFSET_FILL)}function H(t){void 0===t&&(t=e.TEXTURE0+E-1),O!==t&&(e.activeTexture(t),O=t)}return I[e.TEXTURE_2D]=k(e.TEXTURE_2D,e.TEXTURE_2D,1),I[e.TEXTURE_CUBE_MAP]=k(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),i.setClear(0,0,0,1),o.setClear(1),a.setClear(0),U(e.DEPTH_TEST),o.setFunc(LessEqualDepth),z(!1),G(CullFaceBack),U(e.CULL_FACE),j(NoBlending),{buffers:{color:i,depth:o,stencil:a},initAttributes:function(){for(var e=0,t=l.length;e<t;e++)l[e]=0},enableAttribute:function(e){B(e,0)},enableAttributeAndDivisor:B,disableUnusedAttributes:function(){for(var t=0,r=u.length;t!==r;++t)u[t]!==l[t]&&(e.disableVertexAttribArray(t),u[t]=0)},enable:U,disable:V,getCompressedTextureFormats:function(){if(null===p&&(p=[],t.get("WEBGL_compressed_texture_pvrtc")||t.get("WEBGL_compressed_texture_s3tc")||t.get("WEBGL_compressed_texture_etc1")||t.get("WEBGL_compressed_texture_astc")))for(var r=e.getParameter(e.COMPRESSED_TEXTURE_FORMATS),n=0;n<r.length;n++)p.push(r[n]);return p},useProgram:function(t){return f!==t&&(e.useProgram(t),f=t,!0)},setBlending:j,setMaterial:function(t,r){t.side===DoubleSide?V(e.CULL_FACE):U(e.CULL_FACE);var n=t.side===BackSide;r&&(n=!n),z(n),t.blending===NormalBlending&&!1===t.transparent?j(NoBlending):j(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),o.setFunc(t.depthFunc),o.setTest(t.depthTest),o.setMask(t.depthWrite),i.setMask(t.colorWrite),W(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:z,setCullFace:G,setLineWidth:function(t){t!==T&&(L&&e.lineWidth(t),T=t)},setPolygonOffset:W,setScissorTest:function(t){t?U(e.SCISSOR_TEST):V(e.SCISSOR_TEST)},activeTexture:H,bindTexture:function(t,r){null===O&&H();var n=R[O];void 0===n&&(n={type:void 0,texture:void 0},R[O]=n),n.type===t&&n.texture===r||(e.bindTexture(t,r||I[t]),n.type=t,n.texture=r)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(t){console.error("WebGLState:",t)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(t){console.error("WebGLState:",t)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(t){console.error("WebGLState:",t)}},scissor:function(t){!1===D.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),D.copy(t))},viewport:function(t){!1===F.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),F.copy(t))},reset:function(){for(var t=0;t<u.length;t++)1===u[t]&&(e.disableVertexAttribArray(t),u[t]=0);h={},p=null,O=null,R={},f=null,m=null,M=null,_=null,i.reset(),o.reset(),a.reset()}}}function WebGLTextures(e,t,r,n,i,o,a){var s,l={},u="undefined"!==typeof OffscreenCanvas;function c(e,t){return u?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function h(e,t,r,n){var i=1;if((e.width>n||e.height>n)&&(i=n/Math.max(e.width,e.height)),i<1||!0===t){if(e instanceof ImageBitmap||e instanceof HTMLImageElement||e instanceof HTMLCanvasElement){var o=t?_Math.floorPowerOfTwo:Math.floor,a=o(i*e.width),l=o(i*e.height);void 0===s&&(s=c(a,l));var h=r?c(a,l):s;return h.width=a,h.height=l,h.getContext("2d").drawImage(e,0,0,a,l),console.warn("WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+a+"x"+l+")."),u?h.transferToImageBitmap():h}return"data"in e&&console.warn("WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function p(e){return _Math.isPowerOfTwo(e.width)&&_Math.isPowerOfTwo(e.height)}function f(e,t){return e.generateMipmaps&&t&&e.minFilter!==NearestFilter&&e.minFilter!==LinearFilter}function d(t,r,i,o){e.generateMipmap(t),n.get(r).__maxMipLevel=Math.log(Math.max(i,o))*Math.LOG2E}function m(r,n){if(!i.isWebGL2)return r;var o=r;return r===e.RED&&(n===e.FLOAT&&(o=e.R32F),n===e.HALF_FLOAT&&(o=e.R16F),n===e.UNSIGNED_BYTE&&(o=e.R8)),r===e.RGB&&(n===e.FLOAT&&(o=e.RGB32F),n===e.HALF_FLOAT&&(o=e.RGB16F),n===e.UNSIGNED_BYTE&&(o=e.RGB8)),r===e.RGBA&&(n===e.FLOAT&&(o=e.RGBA32F),n===e.HALF_FLOAT&&(o=e.RGBA16F),n===e.UNSIGNED_BYTE&&(o=e.RGBA8)),o===e.R16F||o===e.R32F||o===e.RGBA16F||o===e.RGBA32F?t.get("EXT_color_buffer_float"):o!==e.RGB16F&&o!==e.RGB32F||console.warn("WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead."),o}function v(t){return t===NearestFilter||t===NearestMipMapNearestFilter||t===NearestMipMapLinearFilter?e.NEAREST:e.LINEAR}function g(t){var r=t.target;r.removeEventListener("dispose",g),function(t){var r=n.get(t);if(void 0===r.__webglInit)return;e.deleteTexture(r.__webglTexture),n.remove(t)}(r),r.isVideoTexture&&delete l[r.id],a.memory.textures--}function y(t){var r=t.target;r.removeEventListener("dispose",y),function(t){var r=n.get(t),i=n.get(t.texture);if(!t)return;void 0!==i.__webglTexture&&e.deleteTexture(i.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLRenderTargetCube)for(var o=0;o<6;o++)e.deleteFramebuffer(r.__webglFramebuffer[o]),r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer[o]);else e.deleteFramebuffer(r.__webglFramebuffer),r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer);n.remove(t.texture),n.remove(t)}(r),a.memory.textures--}function b(t,i){var o=n.get(t);if(t.isVideoTexture&&function(e){var t=e.id,r=a.render.frame;l[t]!==r&&(l[t]=r,e.update())}(t),t.version>0&&o.__version!==t.version){var s=t.image;if(void 0===s)console.warn("WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==s.complete)return void S(o,t,i);console.warn("WebGLRenderer: Texture marked for update but image is incomplete")}}r.activeTexture(e.TEXTURE0+i),r.bindTexture(e.TEXTURE_2D,o.__webglTexture)}function x(r,a,s){var l;if(s?(e.texParameteri(r,e.TEXTURE_WRAP_S,o.convert(a.wrapS)),e.texParameteri(r,e.TEXTURE_WRAP_T,o.convert(a.wrapT)),r===e.TEXTURE_3D&&e.texParameteri(r,e.TEXTURE_WRAP_R,o.convert(a.wrapR)),e.texParameteri(r,e.TEXTURE_MAG_FILTER,o.convert(a.magFilter)),e.texParameteri(r,e.TEXTURE_MIN_FILTER,o.convert(a.minFilter))):(e.texParameteri(r,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(r,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),r===e.TEXTURE_3D&&e.texParameteri(r,e.TEXTURE_WRAP_R,e.CLAMP_TO_EDGE),a.wrapS===ClampToEdgeWrapping&&a.wrapT===ClampToEdgeWrapping||console.warn("WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to ClampToEdgeWrapping."),e.texParameteri(r,e.TEXTURE_MAG_FILTER,v(a.magFilter)),e.texParameteri(r,e.TEXTURE_MIN_FILTER,v(a.minFilter)),a.minFilter!==NearestFilter&&a.minFilter!==LinearFilter&&console.warn("WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to NearestFilter or LinearFilter.")),l=t.get("EXT_texture_filter_anisotropic")){if(a.type===FloatType&&null===t.get("OES_texture_float_linear"))return;if(a.type===HalfFloatType&&null===(i.isWebGL2||t.get("OES_texture_half_float_linear")))return;(a.anisotropy>1||n.get(a).__currentAnisotropy)&&(e.texParameterf(r,l.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),n.get(a).__currentAnisotropy=a.anisotropy)}}function w(t,r){void 0===t.__webglInit&&(t.__webglInit=!0,r.addEventListener("dispose",g),t.__webglTexture=e.createTexture(),a.memory.textures++)}function S(t,n,a){var s=n.isDataTexture3D?e.TEXTURE_3D:e.TEXTURE_2D;w(t,n),r.activeTexture(e.TEXTURE0+a),r.bindTexture(s,t.__webglTexture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,n.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,n.unpackAlignment);var l=function(e){return!i.isWebGL2&&(e.wrapS!==ClampToEdgeWrapping||e.wrapT!==ClampToEdgeWrapping||e.minFilter!==NearestFilter&&e.minFilter!==LinearFilter)}(n)&&!1===p(n.image),u=h(n.image,l,!1,i.maxTextureSize),c=p(u)||i.isWebGL2,v=o.convert(n.format),g=o.convert(n.type),y=m(v,g);x(s,n,c);var b,S=n.mipmaps;if(n.isDepthTexture){if(y=e.DEPTH_COMPONENT,n.type===FloatType){if(!i.isWebGL2)throw new Error("Float Depth Texture only supported in WebGL2.0");y=e.DEPTH_COMPONENT32F}else i.isWebGL2&&(y=e.DEPTH_COMPONENT16);n.format===DepthFormat&&y===e.DEPTH_COMPONENT&&n.type!==UnsignedShortType&&n.type!==UnsignedIntType&&(console.warn("WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),n.type=UnsignedShortType,g=o.convert(n.type)),n.format===DepthStencilFormat&&(y=e.DEPTH_STENCIL,n.type!==UnsignedInt248Type&&(console.warn("WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),n.type=UnsignedInt248Type,g=o.convert(n.type))),r.texImage2D(e.TEXTURE_2D,0,y,u.width,u.height,0,v,g,null)}else if(n.isDataTexture)if(S.length>0&&c){for(var M=0,_=S.length;M<_;M++)b=S[M],r.texImage2D(e.TEXTURE_2D,M,y,b.width,b.height,0,v,g,b.data);n.generateMipmaps=!1,t.__maxMipLevel=S.length-1}else r.texImage2D(e.TEXTURE_2D,0,y,u.width,u.height,0,v,g,u.data),t.__maxMipLevel=0;else if(n.isCompressedTexture){for(M=0,_=S.length;M<_;M++)b=S[M],n.format!==RGBAFormat&&n.format!==RGBFormat?r.getCompressedTextureFormats().indexOf(v)>-1?r.compressedTexImage2D(e.TEXTURE_2D,M,y,b.width,b.height,0,b.data):console.warn("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):r.texImage2D(e.TEXTURE_2D,M,y,b.width,b.height,0,v,g,b.data);t.__maxMipLevel=S.length-1}else if(n.isDataTexture3D)r.texImage3D(e.TEXTURE_3D,0,y,u.width,u.height,u.depth,0,v,g,u.data),t.__maxMipLevel=0;else if(S.length>0&&c){for(M=0,_=S.length;M<_;M++)b=S[M],r.texImage2D(e.TEXTURE_2D,M,y,v,g,b);n.generateMipmaps=!1,t.__maxMipLevel=S.length-1}else r.texImage2D(e.TEXTURE_2D,0,y,v,g,u),t.__maxMipLevel=0;f(n,c)&&d(e.TEXTURE_2D,n,u.width,u.height),t.__version=n.version,n.onUpdate&&n.onUpdate(n)}function M(t,i,a,s){var l=o.convert(i.texture.format),u=o.convert(i.texture.type),c=m(l,u);r.texImage2D(s,0,c,i.width,i.height,0,l,u,null),e.bindFramebuffer(e.FRAMEBUFFER,t),e.framebufferTexture2D(e.FRAMEBUFFER,a,s,n.get(i.texture).__webglTexture,0),e.bindFramebuffer(e.FRAMEBUFFER,null)}function _(t,r,n){if(e.bindRenderbuffer(e.RENDERBUFFER,t),r.depthBuffer&&!r.stencilBuffer){if(n){var i=A(r);e.renderbufferStorageMultisample(e.RENDERBUFFER,i,e.DEPTH_COMPONENT16,r.width,r.height)}else e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,r.width,r.height);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)}else if(r.depthBuffer&&r.stencilBuffer){if(n){i=A(r);e.renderbufferStorageMultisample(e.RENDERBUFFER,i,e.DEPTH_STENCIL,r.width,r.height)}else e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,r.width,r.height);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)}else{var a=m(o.convert(r.texture.format),o.convert(r.texture.type));if(n){i=A(r);e.renderbufferStorageMultisample(e.RENDERBUFFER,i,a,r.width,r.height)}else e.renderbufferStorage(e.RENDERBUFFER,a,r.width,r.height)}e.bindRenderbuffer(e.RENDERBUFFER,null)}function T(t){var r=n.get(t),i=!0===t.isWebGLRenderTargetCube;if(t.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,r){if(r&&r.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(e.FRAMEBUFFER,t),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of DepthTexture");n.get(r.depthTexture).__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),b(r.depthTexture,0);var i=n.get(r.depthTexture).__webglTexture;if(r.depthTexture.format===DepthFormat)e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,i,0);else{if(r.depthTexture.format!==DepthStencilFormat)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,i,0)}}(r.__webglFramebuffer,t)}else if(i){r.__webglDepthbuffer=[];for(var o=0;o<6;o++)e.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer[o]),r.__webglDepthbuffer[o]=e.createRenderbuffer(),_(r.__webglDepthbuffer[o],t)}else e.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer),r.__webglDepthbuffer=e.createRenderbuffer(),_(r.__webglDepthbuffer,t);e.bindFramebuffer(e.FRAMEBUFFER,null)}function A(e){return i.isWebGL2&&e.isWebGLMultisampleRenderTarget?Math.min(i.maxSamples,e.samples):0}this.setTexture2D=b,this.setTexture3D=function(t,i){var o=n.get(t);t.version>0&&o.__version!==t.version?S(o,t,i):(r.activeTexture(e.TEXTURE0+i),r.bindTexture(e.TEXTURE_3D,o.__webglTexture))},this.setTextureCube=function(t,a){var s=n.get(t);if(6===t.image.length)if(t.version>0&&s.__version!==t.version){w(s,t),r.activeTexture(e.TEXTURE0+a),r.bindTexture(e.TEXTURE_CUBE_MAP,s.__webglTexture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var l=t&&t.isCompressedTexture,u=t.image[0]&&t.image[0].isDataTexture,c=[],v=0;v<6;v++)c[v]=l||u?u?t.image[v].image:t.image[v]:h(t.image[v],!1,!0,i.maxCubemapSize);var g=c[0],y=p(g)||i.isWebGL2,b=o.convert(t.format),S=o.convert(t.type),M=m(b,S);for(x(e.TEXTURE_CUBE_MAP,t,y),v=0;v<6;v++)if(l)for(var _,T=c[v].mipmaps,A=0,C=T.length;A<C;A++)_=T[A],t.format!==RGBAFormat&&t.format!==RGBFormat?r.getCompressedTextureFormats().indexOf(b)>-1?r.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+v,A,M,_.width,_.height,0,_.data):console.warn("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+v,A,M,_.width,_.height,0,b,S,_.data);else u?r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,M,c[v].width,c[v].height,0,b,S,c[v].data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,M,b,S,c[v]);s.__maxMipLevel=l?T.length-1:0,f(t,y)&&d(e.TEXTURE_CUBE_MAP,t,g.width,g.height),s.__version=t.version,t.onUpdate&&t.onUpdate(t)}else r.activeTexture(e.TEXTURE0+a),r.bindTexture(e.TEXTURE_CUBE_MAP,s.__webglTexture)},this.setTextureCubeDynamic=function(t,i){r.activeTexture(e.TEXTURE0+i),r.bindTexture(e.TEXTURE_CUBE_MAP,n.get(t).__webglTexture)},this.setupRenderTarget=function(t){var s=n.get(t),l=n.get(t.texture);t.addEventListener("dispose",y),l.__webglTexture=e.createTexture(),a.memory.textures++;var u=!0===t.isWebGLRenderTargetCube,c=!0===t.isWebGLMultisampleRenderTarget,h=p(t)||i.isWebGL2;if(u){s.__webglFramebuffer=[];for(var v=0;v<6;v++)s.__webglFramebuffer[v]=e.createFramebuffer()}else if(s.__webglFramebuffer=e.createFramebuffer(),c)if(i.isWebGL2){s.__webglMultisampledFramebuffer=e.createFramebuffer(),s.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,s.__webglColorRenderbuffer);var g=m(o.convert(t.texture.format),o.convert(t.texture.type)),b=A(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,b,g,t.width,t.height),e.bindFramebuffer(e.FRAMEBUFFER,s.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,s.__webglColorRenderbuffer),e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(s.__webglDepthRenderbuffer=e.createRenderbuffer(),_(s.__webglDepthRenderbuffer,t,!0)),e.bindFramebuffer(e.FRAMEBUFFER,null)}else console.warn("WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(u){for(r.bindTexture(e.TEXTURE_CUBE_MAP,l.__webglTexture),x(e.TEXTURE_CUBE_MAP,t.texture,h),v=0;v<6;v++)M(s.__webglFramebuffer[v],t,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+v);f(t.texture,h)&&d(e.TEXTURE_CUBE_MAP,t.texture,t.width,t.height),r.bindTexture(e.TEXTURE_CUBE_MAP,null)}else r.bindTexture(e.TEXTURE_2D,l.__webglTexture),x(e.TEXTURE_2D,t.texture,h),M(s.__webglFramebuffer,t,e.COLOR_ATTACHMENT0,e.TEXTURE_2D),f(t.texture,h)&&d(e.TEXTURE_2D,t.texture,t.width,t.height),r.bindTexture(e.TEXTURE_2D,null);t.depthBuffer&&T(t)},this.updateRenderTargetMipmap=function(t){var o=t.texture;if(f(o,p(t)||i.isWebGL2)){var a=t.isWebGLRenderTargetCube?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,s=n.get(o).__webglTexture;r.bindTexture(a,s),d(a,o,t.width,t.height),r.bindTexture(a,null)}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(i.isWebGL2){var r=n.get(t);e.bindFramebuffer(e.READ_FRAMEBUFFER,r.__webglMultisampledFramebuffer),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,r.__webglFramebuffer);var o=t.width,a=t.height,s=e.COLOR_BUFFER_BIT;t.depthBuffer&&(s|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&(s|=e.STENCIL_BUFFER_BIT),e.blitFramebuffer(0,0,o,a,0,0,o,a,s,e.NEAREST)}else console.warn("WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}}function WebGLUtils(e,t,r){return{convert:function(n){var i;if(n===RepeatWrapping)return e.REPEAT;if(n===ClampToEdgeWrapping)return e.CLAMP_TO_EDGE;if(n===MirroredRepeatWrapping)return e.MIRRORED_REPEAT;if(n===NearestFilter)return e.NEAREST;if(n===NearestMipMapNearestFilter)return e.NEAREST_MIPMAP_NEAREST;if(n===NearestMipMapLinearFilter)return e.NEAREST_MIPMAP_LINEAR;if(n===LinearFilter)return e.LINEAR;if(n===LinearMipMapNearestFilter)return e.LINEAR_MIPMAP_NEAREST;if(n===LinearMipMapLinearFilter)return e.LINEAR_MIPMAP_LINEAR;if(n===UnsignedByteType)return e.UNSIGNED_BYTE;if(n===UnsignedShort4444Type)return e.UNSIGNED_SHORT_4_4_4_4;if(n===UnsignedShort5551Type)return e.UNSIGNED_SHORT_5_5_5_1;if(n===UnsignedShort565Type)return e.UNSIGNED_SHORT_5_6_5;if(n===ByteType)return e.BYTE;if(n===ShortType)return e.SHORT;if(n===UnsignedShortType)return e.UNSIGNED_SHORT;if(n===IntType)return e.INT;if(n===UnsignedIntType)return e.UNSIGNED_INT;if(n===FloatType)return e.FLOAT;if(n===HalfFloatType){if(r.isWebGL2)return e.HALF_FLOAT;if(null!==(i=t.get("OES_texture_half_float")))return i.HALF_FLOAT_OES}if(n===AlphaFormat)return e.ALPHA;if(n===RGBFormat)return e.RGB;if(n===RGBAFormat)return e.RGBA;if(n===LuminanceFormat)return e.LUMINANCE;if(n===LuminanceAlphaFormat)return e.LUMINANCE_ALPHA;if(n===DepthFormat)return e.DEPTH_COMPONENT;if(n===DepthStencilFormat)return e.DEPTH_STENCIL;if(n===RedFormat)return e.RED;if(n===AddEquation)return e.FUNC_ADD;if(n===SubtractEquation)return e.FUNC_SUBTRACT;if(n===ReverseSubtractEquation)return e.FUNC_REVERSE_SUBTRACT;if(n===ZeroFactor)return e.ZERO;if(n===OneFactor)return e.ONE;if(n===SrcColorFactor)return e.SRC_COLOR;if(n===OneMinusSrcColorFactor)return e.ONE_MINUS_SRC_COLOR;if(n===SrcAlphaFactor)return e.SRC_ALPHA;if(n===OneMinusSrcAlphaFactor)return e.ONE_MINUS_SRC_ALPHA;if(n===DstAlphaFactor)return e.DST_ALPHA;if(n===OneMinusDstAlphaFactor)return e.ONE_MINUS_DST_ALPHA;if(n===DstColorFactor)return e.DST_COLOR;if(n===OneMinusDstColorFactor)return e.ONE_MINUS_DST_COLOR;if(n===SrcAlphaSaturateFactor)return e.SRC_ALPHA_SATURATE;if((n===RGB_S3TC_DXT1_Format||n===RGBA_S3TC_DXT1_Format||n===RGBA_S3TC_DXT3_Format||n===RGBA_S3TC_DXT5_Format)&&null!==(i=t.get("WEBGL_compressed_texture_s3tc"))){if(n===RGB_S3TC_DXT1_Format)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===RGBA_S3TC_DXT1_Format)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===RGBA_S3TC_DXT3_Format)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===RGBA_S3TC_DXT5_Format)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((n===RGB_PVRTC_4BPPV1_Format||n===RGB_PVRTC_2BPPV1_Format||n===RGBA_PVRTC_4BPPV1_Format||n===RGBA_PVRTC_2BPPV1_Format)&&null!==(i=t.get("WEBGL_compressed_texture_pvrtc"))){if(n===RGB_PVRTC_4BPPV1_Format)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===RGB_PVRTC_2BPPV1_Format)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===RGBA_PVRTC_4BPPV1_Format)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===RGBA_PVRTC_2BPPV1_Format)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===RGB_ETC1_Format&&null!==(i=t.get("WEBGL_compressed_texture_etc1")))return i.COMPRESSED_RGB_ETC1_WEBGL;if((n===RGBA_ASTC_4x4_Format||n===RGBA_ASTC_5x4_Format||n===RGBA_ASTC_5x5_Format||n===RGBA_ASTC_6x5_Format||n===RGBA_ASTC_6x6_Format||n===RGBA_ASTC_8x5_Format||n===RGBA_ASTC_8x6_Format||n===RGBA_ASTC_8x8_Format||n===RGBA_ASTC_10x5_Format||n===RGBA_ASTC_10x6_Format||n===RGBA_ASTC_10x8_Format||n===RGBA_ASTC_10x10_Format||n===RGBA_ASTC_12x10_Format||n===RGBA_ASTC_12x12_Format)&&null!==(i=t.get("WEBGL_compressed_texture_astc")))return n;if(n===MinEquation||n===MaxEquation){if(r.isWebGL2){if(n===MinEquation)return e.MIN;if(n===MaxEquation)return e.MAX}if(null!==(i=t.get("EXT_blend_minmax"))){if(n===MinEquation)return i.MIN_EXT;if(n===MaxEquation)return i.MAX_EXT}}if(n===UnsignedInt248Type){if(r.isWebGL2)return e.UNSIGNED_INT_24_8;if(null!==(i=t.get("WEBGL_depth_texture")))return i.UNSIGNED_INT_24_8_WEBGL}return 0}}}function ArrayCamera(e){PerspectiveCamera.call(this),this.cameras=e||[]}ArrayCamera.prototype=Object.assign(Object.create(PerspectiveCamera.prototype),{constructor:ArrayCamera,isArrayCamera:!0});var cameraLPos=new Vector3,cameraRPos=new Vector3;function setProjectionFromUnion(e,t,r){cameraLPos.setFromMatrixPosition(t.matrixWorld),cameraRPos.setFromMatrixPosition(r.matrixWorld);var n=cameraLPos.distanceTo(cameraRPos),i=t.projectionMatrix.elements,o=r.projectionMatrix.elements,a=i[14]/(i[10]-1),s=i[14]/(i[10]+1),l=(i[9]+1)/i[5],u=(i[9]-1)/i[5],c=(i[8]-1)/i[0],h=(o[8]+1)/o[0],p=a*c,f=a*h,d=n/(-c+h),m=d*-c;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(d),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.getInverse(e.matrixWorld);var v=a+d,g=s+d,y=p-m,b=f+(n-m),x=l*s/g*v,w=u*s/g*v;e.projectionMatrix.makePerspective(y,b,x,w,v,g)}function WebVRManager(e){var t=this,r=null,n=null,i=null,o=[],a=new Matrix4,s=new Matrix4,l=1,u="stage";"undefined"!==typeof window&&"VRFrameData"in window&&(n=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",b,!1));var c=new Matrix4,h=new Quaternion,p=new Vector3,f=new PerspectiveCamera;f.bounds=new Vector4(0,0,.5,1),f.layers.enable(1);var d=new PerspectiveCamera;d.bounds=new Vector4(.5,0,.5,1),d.layers.enable(2);var m=new ArrayCamera([f,d]);function v(){return null!==r&&!0===r.isPresenting}m.layers.enable(1),m.layers.enable(2);var g,y=new Vector2;function b(){if(v()){var n=r.getEyeParameters("left"),i=n.renderWidth*l,o=n.renderHeight*l;g=e.getPixelRatio(),e.getSize(y),e.setDrawingBufferSize(2*i,o,1),S.start()}else t.enabled&&e.setDrawingBufferSize(y.width,y.height,g),S.stop()}var x=[];function w(e){for(var t=navigator.getGamepads&&navigator.getGamepads(),r=0,n=0,i=t.length;r<i;r++){var o=t[r];if(o&&("Daydream Controller"===o.id||"Gear VR Controller"===o.id||"Oculus Go Controller"===o.id||"OpenVR Gamepad"===o.id||o.id.startsWith("Oculus Touch")||o.id.startsWith("Spatial Controller"))){if(n===e)return o;n++}}}this.enabled=!1,this.getController=function(e){var t=o[e];return void 0===t&&((t=new Group).matrixAutoUpdate=!1,t.visible=!1,o[e]=t),t},this.getDevice=function(){return r},this.setDevice=function(e){void 0!==e&&(r=e),S.setContext(e)},this.setFramebufferScaleFactor=function(e){l=e},this.setFrameOfReferenceType=function(e){u=e},this.setPoseTarget=function(e){void 0!==e&&(i=e)},this.getCamera=function(e){var t="stage"===u?1.6:0;if(!1===v())return e.position.set(0,t,0),e.rotation.set(0,0,0),e;if(r.depthNear=e.near,r.depthFar=e.far,r.getFrameData(n),"stage"===u){var l=r.stageParameters;l?a.fromArray(l.sittingToStandingTransform):a.makeTranslation(0,t,0)}var g=n.pose,y=null!==i?i:e;y.matrix.copy(a),y.matrix.decompose(y.position,y.quaternion,y.scale),null!==g.orientation&&(h.fromArray(g.orientation),y.quaternion.multiply(h)),null!==g.position&&(h.setFromRotationMatrix(a),p.fromArray(g.position),p.applyQuaternion(h),y.position.add(p)),y.updateMatrixWorld(),f.near=e.near,d.near=e.near,f.far=e.far,d.far=e.far,f.matrixWorldInverse.fromArray(n.leftViewMatrix),d.matrixWorldInverse.fromArray(n.rightViewMatrix),s.getInverse(a),"stage"===u&&(f.matrixWorldInverse.multiply(s),d.matrixWorldInverse.multiply(s));var b=y.parent;null!==b&&(c.getInverse(b.matrixWorld),f.matrixWorldInverse.multiply(c),d.matrixWorldInverse.multiply(c)),f.matrixWorld.getInverse(f.matrixWorldInverse),d.matrixWorld.getInverse(d.matrixWorldInverse),f.projectionMatrix.fromArray(n.leftProjectionMatrix),d.projectionMatrix.fromArray(n.rightProjectionMatrix),setProjectionFromUnion(m,f,d);var S=r.getLayers();if(S.length){var M=S[0];null!==M.leftBounds&&4===M.leftBounds.length&&f.bounds.fromArray(M.leftBounds),null!==M.rightBounds&&4===M.rightBounds.length&&d.bounds.fromArray(M.rightBounds)}return function(){for(var e=0;e<o.length;e++){var t=o[e],r=w(e);if(void 0!==r&&void 0!==r.pose){if(null===r.pose)return;var n=r.pose;!1===n.hasPosition&&t.position.set(.2,-.6,-.05),null!==n.position&&t.position.fromArray(n.position),null!==n.orientation&&t.quaternion.fromArray(n.orientation),t.matrix.compose(t.position,t.quaternion,t.scale),t.matrix.premultiply(a),t.matrix.decompose(t.position,t.quaternion,t.scale),t.matrixWorldNeedsUpdate=!0,t.visible=!0;var i="Daydream Controller"===r.id?0:1;x[e]!==r.buttons[i].pressed&&(x[e]=r.buttons[i].pressed,!0===x[e]?t.dispatchEvent({type:"selectstart"}):(t.dispatchEvent({type:"selectend"}),t.dispatchEvent({type:"select"})))}else t.visible=!1}}(),m},this.getStandingMatrix=function(){return a},this.isPresenting=v;var S=new WebGLAnimation;this.setAnimationLoop=function(e){S.setAnimationLoop(e)},this.submitFrame=function(){v()&&r.submitFrame()},this.dispose=function(){"undefined"!==typeof window&&window.removeEventListener("vrdisplaypresentchange",b)}}function WebXRManager(e){var t=e.context,r=null,n=null,i=1,o=null,a="stage",s=null,l=[],u=[];function c(){return null!==n&&null!==o}var h=new PerspectiveCamera;h.layers.enable(1),h.viewport=new Vector4;var p=new PerspectiveCamera;p.layers.enable(2),p.viewport=new Vector4;var f=new ArrayCamera([h,p]);function d(e){var t=l[u.indexOf(e.inputSource)];t&&t.dispatchEvent({type:e.type})}function m(){e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),y.stop()}function v(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.getInverse(e.matrixWorld)}f.layers.enable(1),f.layers.enable(2),this.enabled=!1,this.getController=function(e){var t=l[e];return void 0===t&&((t=new Group).matrixAutoUpdate=!1,t.visible=!1,l[e]=t),t},this.getDevice=function(){return r},this.setDevice=function(e){void 0!==e&&(r=e),e instanceof XRDevice&&t.setCompatibleXRDevice(e)},this.setFramebufferScaleFactor=function(e){i=e},this.setFrameOfReferenceType=function(e){a=e},this.setSession=function(r){null!==(n=r)&&(n.addEventListener("select",d),n.addEventListener("selectstart",d),n.addEventListener("selectend",d),n.addEventListener("end",m),n.baseLayer=new XRWebGLLayer(n,t,{framebufferScaleFactor:i}),n.requestFrameOfReference(a).then(function(t){o=t,e.setFramebuffer(n.baseLayer.framebuffer),y.setContext(n),y.start()}),u=n.getInputSources(),n.addEventListener("inputsourceschange",function(){u=n.getInputSources(),console.log(u);for(var e=0;e<l.length;e++){l[e].userData.inputSource=u[e]}}))},this.getCamera=function(e){if(c()){var t=e.parent,r=f.cameras;v(f,t);for(var n=0;n<r.length;n++)v(r[n],t);e.matrixWorld.copy(f.matrixWorld);for(var i=e.children,o=(n=0,i.length);n<o;n++)i[n].updateMatrixWorld(!0);return setProjectionFromUnion(f,h,p),f}return e},this.isPresenting=c;var g=null;var y=new WebGLAnimation;y.setAnimationLoop(function(e,t){if(null!==(s=t.getDevicePose(o)))for(var r=n.baseLayer,i=t.views,a=0;a<i.length;a++){var c=i[a],h=r.getViewport(c),p=s.getViewMatrix(c),d=f.cameras[a];d.matrix.fromArray(p).getInverse(d.matrix),d.projectionMatrix.fromArray(c.projectionMatrix),d.viewport.set(h.x,h.y,h.width,h.height),0===a&&f.matrix.copy(d.matrix)}for(a=0;a<l.length;a++){var m=l[a],v=u[a];if(v){var y=t.getInputPose(v,o);if(null!==y){"targetRay"in y?m.matrix.elements=y.targetRay.transformMatrix:"pointerMatrix"in y&&(m.matrix.elements=y.pointerMatrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.visible=!0;continue}}m.visible=!1}g&&g(e)}),this.setAnimationLoop=function(e){g=e},this.dispose=function(){},this.getStandingMatrix=function(){return console.warn("WebXRManager: getStandingMatrix() is no longer needed."),new Matrix4},this.submitFrame=function(){}}function WebGLRenderer(e){console.log("WebGLRenderer",REVISION);var t=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),r=void 0!==e.context?e.context:null,n=void 0!==e.alpha&&e.alpha,i=void 0===e.depth||e.depth,o=void 0===e.stencil||e.stencil,a=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,u=void 0!==e.powerPreference?e.powerPreference:"default",c=null,h=null;this.domElement=t,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=LinearToneMapping,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var p,f,d,m,v,g,y,b,x,w,S,M,_,T,A,C,E,L,N=this,P=!1,O=null,R=null,D=null,F=-1,k={geometry:null,program:null,wireframe:!1},I=null,B=null,U=new Vector4,V=new Vector4,j=null,z=0,G=t.width,W=t.height,H=1,X=new Vector4(0,0,G,W),q=new Vector4(0,0,G,W),Y=!1,K=new Frustum,Q=new WebGLClipping,J=!1,Z=!1,$=new Matrix4,ee=new Vector3;function te(){return null===R?H:1}try{var re={alpha:n,depth:i,stencil:o,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:l,powerPreference:u};if(t.addEventListener("webglcontextlost",ae,!1),t.addEventListener("webglcontextrestored",se,!1),null===(p=r||t.getContext("webgl",re)||t.getContext("experimental-webgl",re)))throw null!==t.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===p.getShaderPrecisionFormat&&(p.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(be){throw console.error("WebGLRenderer: "+be.message),be}function ne(){f=new WebGLExtensions(p),(d=new WebGLCapabilities(p,f,e)).isWebGL2||(f.get("WEBGL_depth_texture"),f.get("OES_texture_float"),f.get("OES_texture_half_float"),f.get("OES_texture_half_float_linear"),f.get("OES_standard_derivatives"),f.get("OES_element_index_uint"),f.get("ANGLE_instanced_arrays")),f.get("OES_texture_float_linear"),L=new WebGLUtils(p,f,d),(m=new WebGLState(p,f,L,d)).scissor(V.copy(q).multiplyScalar(H)),m.viewport(U.copy(X).multiplyScalar(H)),v=new WebGLInfo(p),g=new WebGLProperties,y=new WebGLTextures(p,f,m,g,d,L,v),b=new WebGLAttributes(p),x=new WebGLGeometries(p,b,v),w=new WebGLObjects(x,v),A=new WebGLMorphtargets(p),S=new WebGLPrograms(N,f,d),M=new WebGLRenderLists,_=new WebGLRenderStates,T=new WebGLBackground(N,m,w,s),C=new WebGLBufferRenderer(p,f,v,d),E=new WebGLIndexedBufferRenderer(p,f,v,d),v.programs=S.programs,N.context=p,N.capabilities=d,N.extensions=f,N.properties=g,N.renderLists=M,N.state=m,N.info=v}ne();var ie=null;"undefined"!==typeof navigator&&(ie="xr"in navigator?new WebXRManager(N):new WebVRManager(N)),this.vr=ie;var oe=new WebGLShadowMap(N,w,d.maxTextureSize);function ae(e){e.preventDefault(),console.log("WebGLRenderer: Context Lost."),P=!0}function se(){console.log("WebGLRenderer: Context Restored."),P=!1,ne()}function le(e){var t=e.target;t.removeEventListener("dispose",le),function(e){ue(e),g.remove(e)}(t)}function ue(e){var t=g.get(e).program;e.program=void 0,void 0!==t&&S.releaseProgram(t)}this.shadowMap=oe,this.getContext=function(){return p},this.getContextAttributes=function(){return p.getContextAttributes()},this.forceContextLoss=function(){var e=f.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=f.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return H},this.setPixelRatio=function(e){void 0!==e&&(H=e,this.setSize(G,W,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new Vector2),e.set(G,W)},this.setSize=function(e,r,n){ie.isPresenting()?console.warn("WebGLRenderer: Can't change size while VR device is presenting."):(G=e,W=r,t.width=e*H,t.height=r*H,!1!==n&&(t.style.width=e+"px",t.style.height=r+"px"),this.setViewport(0,0,e,r))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new Vector2),e.set(G*H,W*H)},this.setDrawingBufferSize=function(e,r,n){G=e,W=r,H=n,t.width=e*n,t.height=r*n,this.setViewport(0,0,e,r)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new Vector4),e.copy(U)},this.getViewport=function(e){return e.copy(X)},this.setViewport=function(e,t,r,n){e.isVector4?X.set(e.x,e.y,e.z,e.w):X.set(e,t,r,n),m.viewport(U.copy(X).multiplyScalar(H))},this.getScissor=function(e){return e.copy(q)},this.setScissor=function(e,t,r,n){e.isVector4?q.set(e.x,e.y,e.z,e.w):q.set(e,t,r,n),m.scissor(V.copy(q).multiplyScalar(H))},this.getScissorTest=function(){return Y},this.setScissorTest=function(e){m.setScissorTest(Y=e)},this.getClearColor=function(){return T.getClearColor()},this.setClearColor=function(){T.setClearColor.apply(T,arguments)},this.getClearAlpha=function(){return T.getClearAlpha()},this.setClearAlpha=function(){T.setClearAlpha.apply(T,arguments)},this.clear=function(e,t,r){var n=0;(void 0===e||e)&&(n|=p.COLOR_BUFFER_BIT),(void 0===t||t)&&(n|=p.DEPTH_BUFFER_BIT),(void 0===r||r)&&(n|=p.STENCIL_BUFFER_BIT),p.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",ae,!1),t.removeEventListener("webglcontextrestored",se,!1),M.dispose(),_.dispose(),g.dispose(),w.dispose(),ie.dispose(),he.stop()},this.renderBufferImmediate=function(e,t){m.initAttributes();var r=g.get(e);e.hasPositions&&!r.position&&(r.position=p.createBuffer()),e.hasNormals&&!r.normal&&(r.normal=p.createBuffer()),e.hasUvs&&!r.uv&&(r.uv=p.createBuffer()),e.hasColors&&!r.color&&(r.color=p.createBuffer());var n=t.getAttributes();e.hasPositions&&(p.bindBuffer(p.ARRAY_BUFFER,r.position),p.bufferData(p.ARRAY_BUFFER,e.positionArray,p.DYNAMIC_DRAW),m.enableAttribute(n.position),p.vertexAttribPointer(n.position,3,p.FLOAT,!1,0,0)),e.hasNormals&&(p.bindBuffer(p.ARRAY_BUFFER,r.normal),p.bufferData(p.ARRAY_BUFFER,e.normalArray,p.DYNAMIC_DRAW),m.enableAttribute(n.normal),p.vertexAttribPointer(n.normal,3,p.FLOAT,!1,0,0)),e.hasUvs&&(p.bindBuffer(p.ARRAY_BUFFER,r.uv),p.bufferData(p.ARRAY_BUFFER,e.uvArray,p.DYNAMIC_DRAW),m.enableAttribute(n.uv),p.vertexAttribPointer(n.uv,2,p.FLOAT,!1,0,0)),e.hasColors&&(p.bindBuffer(p.ARRAY_BUFFER,r.color),p.bufferData(p.ARRAY_BUFFER,e.colorArray,p.DYNAMIC_DRAW),m.enableAttribute(n.color),p.vertexAttribPointer(n.color,3,p.FLOAT,!1,0,0)),m.disableUnusedAttributes(),p.drawArrays(p.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,r,n,i,o){var a=i.isMesh&&i.matrixWorld.determinant()<0;m.setMaterial(n,a);var s=me(e,t,n,i),l=!1;k.geometry===r.id&&k.program===s.id&&k.wireframe===(!0===n.wireframe)||(k.geometry=r.id,k.program=s.id,k.wireframe=!0===n.wireframe,l=!0),i.morphTargetInfluences&&(A.update(i,r,n,s),l=!0);var u,c=r.index,h=r.attributes.position,v=1;!0===n.wireframe&&(c=x.getWireframeAttribute(r),v=2);var g=C;null!==c&&(u=b.get(c),(g=E).setIndex(u)),l&&(!function(e,t,r){if(r&&r.isInstancedBufferGeometry&&!d.isWebGL2&&null===f.get("ANGLE_instanced_arrays"))return void console.error("WebGLRenderer.setupVertexAttributes: using InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");m.initAttributes();var n=r.attributes,i=t.getAttributes(),o=e.defaultAttributeValues;for(var a in i){var s=i[a];if(s>=0){var l=n[a];if(void 0!==l){var u=l.normalized,c=l.itemSize,h=b.get(l);if(void 0===h)continue;var v=h.buffer,g=h.type,y=h.bytesPerElement;if(l.isInterleavedBufferAttribute){var x=l.data,w=x.stride,S=l.offset;x&&x.isInstancedInterleavedBuffer?(m.enableAttributeAndDivisor(s,x.meshPerAttribute),void 0===r.maxInstancedCount&&(r.maxInstancedCount=x.meshPerAttribute*x.count)):m.enableAttribute(s),p.bindBuffer(p.ARRAY_BUFFER,v),p.vertexAttribPointer(s,c,g,u,w*y,S*y)}else l.isInstancedBufferAttribute?(m.enableAttributeAndDivisor(s,l.meshPerAttribute),void 0===r.maxInstancedCount&&(r.maxInstancedCount=l.meshPerAttribute*l.count)):m.enableAttribute(s),p.bindBuffer(p.ARRAY_BUFFER,v),p.vertexAttribPointer(s,c,g,u,0,0)}else if(void 0!==o){var M=o[a];if(void 0!==M)switch(M.length){case 2:p.vertexAttrib2fv(s,M);break;case 3:p.vertexAttrib3fv(s,M);break;case 4:p.vertexAttrib4fv(s,M);break;default:p.vertexAttrib1fv(s,M)}}}}m.disableUnusedAttributes()}(n,s,r),null!==c&&p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,u.buffer));var y=1/0;null!==c?y=c.count:void 0!==h&&(y=h.count);var w=r.drawRange.start*v,S=r.drawRange.count*v,M=null!==o?o.start*v:0,_=null!==o?o.count*v:1/0,T=Math.max(w,M),L=Math.min(y,w+S,M+_)-1,N=Math.max(0,L-T+1);if(0!==N){if(i.isMesh)if(!0===n.wireframe)m.setLineWidth(n.wireframeLinewidth*te()),g.setMode(p.LINES);else switch(i.drawMode){case TrianglesDrawMode:g.setMode(p.TRIANGLES);break;case TriangleStripDrawMode:g.setMode(p.TRIANGLE_STRIP);break;case TriangleFanDrawMode:g.setMode(p.TRIANGLE_FAN)}else if(i.isLine){var P=n.linewidth;void 0===P&&(P=1),m.setLineWidth(P*te()),i.isLineSegments?g.setMode(p.LINES):i.isLineLoop?g.setMode(p.LINE_LOOP):g.setMode(p.LINE_STRIP)}else i.isPoints?g.setMode(p.POINTS):i.isSprite&&g.setMode(p.TRIANGLES);r&&r.isInstancedBufferGeometry?r.maxInstancedCount>0&&g.renderInstances(r,T,N):g.render(T,N)}},this.compile=function(e,t){(h=_.get(e,t)).init(),e.traverse(function(e){e.isLight&&(h.pushLight(e),e.castShadow&&h.pushShadow(e))}),h.setupLights(t),e.traverse(function(t){if(t.material)if(Array.isArray(t.material))for(var r=0;r<t.material.length;r++)de(t.material[r],e.fog,t);else de(t.material,e.fog,t)})};var ce=null;var he=new WebGLAnimation;function pe(e,t,r,n){for(var i=0,o=e.length;i<o;i++){var a=e[i],s=a.object,l=a.geometry,u=void 0===n?a.material:n,c=a.group;if(r.isArrayCamera){B=r;for(var p=r.cameras,f=0,d=p.length;f<d;f++){var v=p[f];if(s.layers.test(v.layers)){if("viewport"in v)m.viewport(U.copy(v.viewport));else{var g=v.bounds,y=g.x*G,b=g.y*W,x=g.z*G,w=g.w*W;m.viewport(U.set(y,b,x,w).multiplyScalar(H))}h.setupLights(v),fe(s,t,v,l,u,c)}}}else B=null,fe(s,t,r,l,u,c)}}function fe(e,t,r,n,i,o){if(e.onBeforeRender(N,t,r,n,i,o),h=_.get(t,B||r),e.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){m.setMaterial(i);var a=me(r,t.fog,i,e);k.geometry=null,k.program=null,k.wireframe=!1,function(e,t){e.render(function(e){N.renderBufferImmediate(e,t)})}(e,a)}else N.renderBufferDirect(r,t.fog,n,i,e,o);e.onAfterRender(N,t,r,n,i,o),h=_.get(t,B||r)}function de(e,t,r){var n=g.get(e),i=h.state.lights,o=h.state.shadowsArray,a=n.lightsHash,s=i.state.hash,l=S.getParameters(e,i.state,o,t,Q.numPlanes,Q.numIntersection,r),u=S.getProgramCode(e,l),c=n.program,p=!0;if(void 0===c)e.addEventListener("dispose",le);else if(c.code!==u)ue(e);else if(a.stateID!==s.stateID||a.directionalLength!==s.directionalLength||a.pointLength!==s.pointLength||a.spotLength!==s.spotLength||a.rectAreaLength!==s.rectAreaLength||a.hemiLength!==s.hemiLength||a.shadowsLength!==s.shadowsLength)a.stateID=s.stateID,a.directionalLength=s.directionalLength,a.pointLength=s.pointLength,a.spotLength=s.spotLength,a.rectAreaLength=s.rectAreaLength,a.hemiLength=s.hemiLength,a.shadowsLength=s.shadowsLength,p=!1;else{if(void 0!==l.shaderID)return;p=!1}if(p){if(l.shaderID){var f=ShaderLib[l.shaderID];n.shader={name:e.type,uniforms:cloneUniforms(f.uniforms),vertexShader:f.vertexShader,fragmentShader:f.fragmentShader}}else n.shader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};e.onBeforeCompile(n.shader,N),u=S.getProgramCode(e,l),c=S.acquireProgram(e,n.shader,l,u),n.program=c,e.program=c}var d=c.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var m=0;m<N.maxMorphTargets;m++)d["morphTarget"+m]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;for(m=0;m<N.maxMorphNormals;m++)d["morphNormal"+m]>=0&&e.numSupportedMorphNormals++}var v=n.shader.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(n.numClippingPlanes=Q.numPlanes,n.numIntersection=Q.numIntersection,v.clippingPlanes=Q.uniform),n.fog=t,void 0===a&&(n.lightsHash=a={}),a.stateID=s.stateID,a.directionalLength=s.directionalLength,a.pointLength=s.pointLength,a.spotLength=s.spotLength,a.rectAreaLength=s.rectAreaLength,a.hemiLength=s.hemiLength,a.shadowsLength=s.shadowsLength,e.lights&&(v.ambientLightColor.value=i.state.ambient,v.directionalLights.value=i.state.directional,v.spotLights.value=i.state.spot,v.rectAreaLights.value=i.state.rectArea,v.pointLights.value=i.state.point,v.hemisphereLights.value=i.state.hemi,v.directionalShadowMap.value=i.state.directionalShadowMap,v.directionalShadowMatrix.value=i.state.directionalShadowMatrix,v.spotShadowMap.value=i.state.spotShadowMap,v.spotShadowMatrix.value=i.state.spotShadowMatrix,v.pointShadowMap.value=i.state.pointShadowMap,v.pointShadowMatrix.value=i.state.pointShadowMatrix);var y=n.program.getUniforms(),b=WebGLUniforms.seqWithValue(y.seq,v);n.uniformsList=b}function me(e,t,r,n){z=0;var i=g.get(r),o=h.state.lights,a=i.lightsHash,s=o.state.hash;if(J&&(Z||e!==I)){var l=e===I&&r.id===F;Q.setState(r.clippingPlanes,r.clipIntersection,r.clipShadows,e,i,l)}!1===r.needsUpdate&&(void 0===i.program?r.needsUpdate=!0:r.fog&&i.fog!==t?r.needsUpdate=!0:(!r.lights||a.stateID===s.stateID&&a.directionalLength===s.directionalLength&&a.pointLength===s.pointLength&&a.spotLength===s.spotLength&&a.rectAreaLength===s.rectAreaLength&&a.hemiLength===s.hemiLength&&a.shadowsLength===s.shadowsLength)&&(void 0===i.numClippingPlanes||i.numClippingPlanes===Q.numPlanes&&i.numIntersection===Q.numIntersection)||(r.needsUpdate=!0)),r.needsUpdate&&(de(r,t,n),r.needsUpdate=!1);var u,c,f=!1,v=!1,y=!1,b=i.program,x=b.getUniforms(),w=i.shader.uniforms;if(m.useProgram(b.program)&&(f=!0,v=!0,y=!0),r.id!==F&&(F=r.id,v=!0),f||I!==e){if(x.setValue(p,"projectionMatrix",e.projectionMatrix),d.logarithmicDepthBuffer&&x.setValue(p,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),I!==e&&(I=e,v=!0,y=!0),r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshStandardMaterial||r.envMap){var S=x.map.cameraPosition;void 0!==S&&S.setValue(p,ee.setFromMatrixPosition(e.matrixWorld))}(r.isMeshPhongMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.skinning)&&x.setValue(p,"viewMatrix",e.matrixWorldInverse)}if(r.skinning){x.setOptional(p,n,"bindMatrix"),x.setOptional(p,n,"bindMatrixInverse");var M=n.skeleton;if(M){var _=M.bones;if(d.floatVertexTextures){if(void 0===M.boneTexture){var T=Math.sqrt(4*_.length);T=_Math.ceilPowerOfTwo(T),T=Math.max(T,4);var A=new Float32Array(T*T*4);A.set(M.boneMatrices);var C=new DataTexture(A,T,T,RGBAFormat,FloatType);C.needsUpdate=!0,M.boneMatrices=A,M.boneTexture=C,M.boneTextureSize=T}x.setValue(p,"boneTexture",M.boneTexture),x.setValue(p,"boneTextureSize",M.boneTextureSize)}else x.setOptional(p,M,"boneMatrices")}}return v&&(x.setValue(p,"toneMappingExposure",N.toneMappingExposure),x.setValue(p,"toneMappingWhitePoint",N.toneMappingWhitePoint),r.lights&&(c=y,(u=w).ambientLightColor.needsUpdate=c,u.directionalLights.needsUpdate=c,u.pointLights.needsUpdate=c,u.spotLights.needsUpdate=c,u.rectAreaLights.needsUpdate=c,u.hemisphereLights.needsUpdate=c),t&&r.fog&&function(e,t){e.fogColor.value=t.color,t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)}(w,t),r.isMeshBasicMaterial?ve(w,r):r.isMeshLambertMaterial?(ve(w,r),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(w,r)):r.isMeshPhongMaterial?(ve(w,r),r.isMeshToonMaterial?function(e,t){ge(e,t),t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(w,r):ge(w,r)):r.isMeshStandardMaterial?(ve(w,r),r.isMeshPhysicalMaterial?function(e,t){ye(e,t),e.reflectivity.value=t.reflectivity,e.clearCoat.value=t.clearCoat,e.clearCoatRoughness.value=t.clearCoatRoughness}(w,r):ye(w,r)):r.isMeshMatcapMaterial?(ve(w,r),function(e,t){t.matcap&&(e.matcap.value=t.matcap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===BackSide&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===BackSide&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(w,r)):r.isMeshDepthMaterial?(ve(w,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(w,r)):r.isMeshDistanceMaterial?(ve(w,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias);e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(w,r)):r.isMeshNormalMaterial?(ve(w,r),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===BackSide&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===BackSide&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(w,r)):r.isLineBasicMaterial?(function(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity}(w,r),r.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(w,r)):r.isPointsMaterial?function(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity,e.size.value=t.size*H,e.scale.value=.5*W,e.map.value=t.map,null!==t.map&&(!0===t.map.matrixAutoUpdate&&t.map.updateMatrix(),e.uvTransform.value.copy(t.map.matrix))}(w,r):r.isSpriteMaterial?function(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity,e.rotation.value=t.rotation,e.map.value=t.map,null!==t.map&&(!0===t.map.matrixAutoUpdate&&t.map.updateMatrix(),e.uvTransform.value.copy(t.map.matrix))}(w,r):r.isShadowMaterial&&(w.color.value=r.color,w.opacity.value=r.opacity),void 0!==w.ltc_1&&(w.ltc_1.value=UniformsLib.LTC_1),void 0!==w.ltc_2&&(w.ltc_2.value=UniformsLib.LTC_2),WebGLUniforms.upload(p,i.uniformsList,w,N)),r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(WebGLUniforms.upload(p,i.uniformsList,w,N),r.uniformsNeedUpdate=!1),r.isSpriteMaterial&&x.setValue(p,"center",n.center),x.setValue(p,"modelViewMatrix",n.modelViewMatrix),x.setValue(p,"normalMatrix",n.normalMatrix),x.setValue(p,"modelMatrix",n.matrixWorld),b}function ve(e,t){var r;e.opacity.value=t.opacity,t.color&&(e.diffuse.value=t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap),t.envMap&&(e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio,e.maxMipLevel.value=g.get(t.envMap).__maxMipLevel),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity),t.map?r=t.map:t.specularMap?r=t.specularMap:t.displacementMap?r=t.displacementMap:t.normalMap?r=t.normalMap:t.bumpMap?r=t.bumpMap:t.roughnessMap?r=t.roughnessMap:t.metalnessMap?r=t.metalnessMap:t.alphaMap?r=t.alphaMap:t.emissiveMap&&(r=t.emissiveMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix))}function ge(e,t){e.specular.value=t.specular,e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===BackSide&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===BackSide&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function ye(e,t){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===BackSide&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===BackSide&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}he.setAnimationLoop(function(e){ie.isPresenting()||ce&&ce(e)}),"undefined"!==typeof window&&he.setContext(window),this.setAnimationLoop=function(e){ce=e,ie.setAnimationLoop(e),he.start()},this.render=function(e,t){var r,n;if(void 0!==arguments[2]&&(console.warn("WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),r=arguments[2]),void 0!==arguments[3]&&(console.warn("WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),n=arguments[3]),t&&t.isCamera){if(!P){k.geometry=null,k.program=null,k.wireframe=!1,F=-1,I=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),ie.enabled&&(t=ie.getCamera(t)),(h=_.get(e,t)).init(),e.onBeforeRender(N,e,t,r||R),$.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),K.setFromMatrix($),Z=this.localClippingEnabled,J=Q.init(this.clippingPlanes,Z,t),(c=M.get(e,t)).init(),function e(t,r,n,i){if(!1===t.visible)return;var o=t.layers.test(r.layers);if(o)if(t.isGroup)n=t.renderOrder;else if(t.isLight)h.pushLight(t),t.castShadow&&h.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||K.intersectsSprite(t)){i&&ee.setFromMatrixPosition(t.matrixWorld).applyMatrix4($);var a=w.update(t),s=t.material;c.push(t,a,s,n,ee.z,null)}}else if(t.isImmediateRenderObject)i&&ee.setFromMatrixPosition(t.matrixWorld).applyMatrix4($),c.push(t,null,t.material,n,ee.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),!t.frustumCulled||K.intersectsObject(t))){i&&ee.setFromMatrixPosition(t.matrixWorld).applyMatrix4($);var a=w.update(t),s=t.material;if(Array.isArray(s))for(var l=a.groups,u=0,p=l.length;u<p;u++){var f=l[u],d=s[f.materialIndex];d&&d.visible&&c.push(t,a,d,n,ee.z,f)}else s.visible&&c.push(t,a,s,n,ee.z,null)}var m=t.children;for(var u=0,p=m.length;u<p;u++)e(m[u],r,n,i)}(e,t,0,N.sortObjects),!0===N.sortObjects&&c.sort(),J&&Q.beginShadows();var i=h.state.shadowsArray;oe.render(i,e,t),h.setupLights(t),J&&Q.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==r&&this.setRenderTarget(r),T.render(c,e,t,n);var o=c.opaque,a=c.transparent;if(e.overrideMaterial){var s=e.overrideMaterial;o.length&&pe(o,e,t,s),a.length&&pe(a,e,t,s)}else o.length&&pe(o,e,t),a.length&&pe(a,e,t);null!==R&&(y.updateRenderTargetMipmap(R),y.updateMultisampleRenderTarget(R)),m.buffers.depth.setTest(!0),m.buffers.depth.setMask(!0),m.buffers.color.setMask(!0),m.setPolygonOffset(!1),e.onAfterRender(N,e,t),ie.enabled&&ie.submitFrame(),c=null,h=null}}else console.error("WebGLRenderer.render: camera is not an instance of Camera.")},this.allocTextureUnit=function(){var e=z;return e>=d.maxTextures&&console.warn("WebGLRenderer: Trying to use "+e+" texture units while this GPU supports only "+d.maxTextures),z+=1,e},this.setTexture2D=function(){var e=!1;return function(t,r){t&&t.isWebGLRenderTarget&&(e||(console.warn("WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),e=!0),t=t.texture),y.setTexture2D(t,r)}}(),this.setTexture3D=function(e,t){y.setTexture3D(e,t)},this.setTexture=function(){var e=!1;return function(t,r){e||(console.warn("WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),e=!0),y.setTexture2D(t,r)}}(),this.setTextureCube=function(){var e=!1;return function(t,r){t&&t.isWebGLRenderTargetCube&&(e||(console.warn("WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),e=!0),t=t.texture),t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?y.setTextureCube(t,r):y.setTextureCubeDynamic(t,r)}}(),this.setFramebuffer=function(e){O=e},this.getRenderTarget=function(){return R},this.setRenderTarget=function(e,t,r){R=e,e&&void 0===g.get(e).__webglFramebuffer&&y.setupRenderTarget(e);var n=O,i=!1;if(e){var o=g.get(e).__webglFramebuffer;e.isWebGLRenderTargetCube?(n=o[t||0],i=!0):n=e.isWebGLMultisampleRenderTarget?g.get(e).__webglMultisampledFramebuffer:o,U.copy(e.viewport),V.copy(e.scissor),j=e.scissorTest}else U.copy(X).multiplyScalar(H),V.copy(q).multiplyScalar(H),j=Y;if(D!==n&&(p.bindFramebuffer(p.FRAMEBUFFER,n),D=n),m.viewport(U),m.scissor(V),m.setScissorTest(j),i){var a=g.get(e.texture);p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_CUBE_MAP_POSITIVE_X+t||0,a.__webglTexture,r||0)}},this.readRenderTargetPixels=function(e,t,r,n,i,o){if(e&&e.isWebGLRenderTarget){var a=g.get(e).__webglFramebuffer;if(a){var s=!1;a!==D&&(p.bindFramebuffer(p.FRAMEBUFFER,a),s=!0);try{var l=e.texture,u=l.format,c=l.type;if(u!==RGBAFormat&&L.convert(u)!==p.getParameter(p.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(c!==UnsignedByteType&&L.convert(c)!==p.getParameter(p.IMPLEMENTATION_COLOR_READ_TYPE)&&(c!==FloatType||!(d.isWebGL2||f.get("OES_texture_float")||f.get("WEBGL_color_buffer_float")))&&(c!==HalfFloatType||(d.isWebGL2?!f.get("EXT_color_buffer_float"):!f.get("EXT_color_buffer_half_float"))))return void console.error("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");p.checkFramebufferStatus(p.FRAMEBUFFER)===p.FRAMEBUFFER_COMPLETE?t>=0&&t<=e.width-n&&r>=0&&r<=e.height-i&&p.readPixels(t,r,n,i,L.convert(u),L.convert(c),o):console.error("WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&p.bindFramebuffer(p.FRAMEBUFFER,D)}}}else console.error("WebGLRenderer.readRenderTargetPixels: renderTarget is not WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t,r){var n=t.image.width,i=t.image.height,o=L.convert(t.format);this.setTexture2D(t,0),p.copyTexImage2D(p.TEXTURE_2D,r||0,o,e.x,e.y,n,i,0)},this.copyTextureToTexture=function(e,t,r,n){var i=t.image.width,o=t.image.height,a=L.convert(r.format),s=L.convert(r.type);this.setTexture2D(r,0),t.isDataTexture?p.texSubImage2D(p.TEXTURE_2D,n||0,e.x,e.y,i,o,a,s,t.image.data):p.texSubImage2D(p.TEXTURE_2D,n||0,e.x,e.y,a,s,t.image)}}function Uniform(e){"string"===typeof e&&(console.warn("Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}Uniform.prototype.clone=function(){return new Uniform(void 0===this.value.clone?this.value:this.value.clone())};var FXAAShader={uniforms:{tDiffuse:{value:null},resolution:{value:new Vector2(1/1024,1/512)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","","uniform sampler2D tDiffuse;","","uniform vec2 resolution;","","varying vec2 vUv;","","// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)","","//----------------------------------------------------------------------------------","// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag","// SDK Version: v3.00","// Email:       gameworks@nvidia.com","// Site:        http://developer.nvidia.com/","//","// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.","//","// Redistribution and use in source and binary forms, with or without","// modification, are permitted provided that the following conditions","// are met:","//  * Redistributions of source code must retain the above copyright","//    notice, this list of conditions and the following disclaimer.","//  * Redistributions in binary form must reproduce the above copyright","//    notice, this list of conditions and the following disclaimer in the","//    documentation and/or other materials provided with the distribution.","//  * Neither the name of NVIDIA CORPORATION nor the names of its","//    contributors may be used to endorse or promote products derived","//    from this software without specific prior written permission.","//","// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY","// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE","// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR","// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR","// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,","// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,","// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR","// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY","// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT","// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE","// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.","//","//----------------------------------------------------------------------------------","","#define FXAA_PC 1","#define FXAA_GLSL_100 1","#define FXAA_QUALITY_PRESET 12","","#define FXAA_GREEN_AS_LUMA 1","","","#ifndef FXAA_PC_CONSOLE","    //","    // The console algorithm for PC is included","    // for developers targeting really low spec machines.","    // Likely better to just run FXAA_PC, and use a really low preset.","    //","    #define FXAA_PC_CONSOLE 0","#endif","","#ifndef FXAA_GLSL_120","    #define FXAA_GLSL_120 0","#endif","","#ifndef FXAA_GLSL_130","    #define FXAA_GLSL_130 0","#endif","","#ifndef FXAA_HLSL_3","    #define FXAA_HLSL_3 0","#endif","","#ifndef FXAA_HLSL_4","    #define FXAA_HLSL_4 0","#endif","","#ifndef FXAA_HLSL_5","    #define FXAA_HLSL_5 0","#endif","","#ifndef FXAA_GREEN_AS_LUMA","    //","    // For those using non-linear color,","    // and either not able to get luma in alpha, or not wanting to,","    // this enables FXAA to run using green as a proxy for luma.","    // So with this enabled, no need to pack luma in alpha.","    //","    // This will turn off AA on anything which lacks some amount of green.","    // Pure red and blue or combination of only R and B, will get no AA.","    //","    // Might want to lower the settings for both,","    //    fxaaConsoleEdgeThresholdMin","    //    fxaaQualityEdgeThresholdMin","    // In order to insure AA does not get turned off on colors","    // which contain a minor amount of green.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_GREEN_AS_LUMA 0","#endif","","#ifndef FXAA_EARLY_EXIT","    //","    // Controls algorithm's early exit path.","    // On PS3 turning this ON adds 2 cycles to the shader.","    // On 360 turning this OFF adds 10ths of a millisecond to the shader.","    // Turning this off on console will result in a more blurry image.","    // So this defaults to on.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_EARLY_EXIT 1","#endif","","#ifndef FXAA_DISCARD","    //","    // Only valid for PC OpenGL currently.","    // Probably will not work when FXAA_GREEN_AS_LUMA = 1.","    //","    // 1 = Use discard on pixels which don't need AA.","    //     For APIs which enable concurrent TEX+ROP from same surface.","    // 0 = Return unchanged color on pixels which don't need AA.","    //","    #define FXAA_DISCARD 0","#endif","","#ifndef FXAA_FAST_PIXEL_OFFSET","    //","    // Used for GLSL 120 only.","    //","    // 1 = GL API supports fast pixel offsets","    // 0 = do not use fast pixel offsets","    //","    #ifdef GL_EXT_gpu_shader4","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifndef FXAA_FAST_PIXEL_OFFSET","        #define FXAA_FAST_PIXEL_OFFSET 0","    #endif","#endif","","#ifndef FXAA_GATHER4_ALPHA","    //","    // 1 = API supports gather4 on alpha channel.","    // 0 = API does not support gather4 on alpha channel.","    //","    #if (FXAA_HLSL_5 == 1)","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifndef FXAA_GATHER4_ALPHA","        #define FXAA_GATHER4_ALPHA 0","    #endif","#endif","","","","#ifndef FXAA_QUALITY_PRESET","    //","    // Choose the quality preset.","    // This needs to be compiled into the shader as it effects code.","    // Best option to include multiple presets is to","    // in each shader define the preset, then include this file.","    //","    // OPTIONS","    // -----------------------------------------------------------------------","    // 10 to 15 - default medium dither (10=fastest, 15=highest quality)","    // 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)","    // 39       - no dither, very expensive","    //","    // NOTES","    // -----------------------------------------------------------------------","    // 12 = slightly faster then FXAA 3.9 and higher edge quality (default)","    // 13 = about same speed as FXAA 3.9 and better than 12","    // 23 = closest to FXAA 3.9 visually and performance wise","    //  _ = the lowest digit is directly related to performance","    // _  = the highest digit is directly related to style","    //","    #define FXAA_QUALITY_PRESET 12","#endif","","","","","","#if (FXAA_QUALITY_PRESET == 10)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 3.0","    #define FXAA_QUALITY_P2 12.0","#endif","","#if (FXAA_QUALITY_PRESET == 11)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 3.0","    #define FXAA_QUALITY_P3 12.0","#endif","","#if (FXAA_QUALITY_PRESET == 12)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 4.0","    #define FXAA_QUALITY_P4 12.0","#endif","","#if (FXAA_QUALITY_PRESET == 13)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 4.0","    #define FXAA_QUALITY_P5 12.0","#endif","","#if (FXAA_QUALITY_PRESET == 14)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 4.0","    #define FXAA_QUALITY_P6 12.0","#endif","","#if (FXAA_QUALITY_PRESET == 15)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 12.0","#endif","","","#if (FXAA_QUALITY_PRESET == 20)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 2.0","    #define FXAA_QUALITY_P2 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 21)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 22)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 23)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 24)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 3.0","    #define FXAA_QUALITY_P6 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 25)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 26)","    #define FXAA_QUALITY_PS 9","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 4.0","    #define FXAA_QUALITY_P8 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 27)","    #define FXAA_QUALITY_PS 10","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 4.0","    #define FXAA_QUALITY_P9 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 28)","    #define FXAA_QUALITY_PS 11","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 4.0","    #define FXAA_QUALITY_P10 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 29)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","","#if (FXAA_QUALITY_PRESET == 39)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.0","    #define FXAA_QUALITY_P2 1.0","    #define FXAA_QUALITY_P3 1.0","    #define FXAA_QUALITY_P4 1.0","    #define FXAA_QUALITY_P5 1.5","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","","","","#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)","    #define FxaaBool bool","    #define FxaaDiscard discard","    #define FxaaFloat float","    #define FxaaFloat2 vec2","    #define FxaaFloat3 vec3","    #define FxaaFloat4 vec4","    #define FxaaHalf float","    #define FxaaHalf2 vec2","    #define FxaaHalf3 vec3","    #define FxaaHalf4 vec4","    #define FxaaInt2 ivec2","    #define FxaaSat(x) clamp(x, 0.0, 1.0)","    #define FxaaTex sampler2D","#else","    #define FxaaBool bool","    #define FxaaDiscard clip(-1)","    #define FxaaFloat float","    #define FxaaFloat2 float2","    #define FxaaFloat3 float3","    #define FxaaFloat4 float4","    #define FxaaHalf half","    #define FxaaHalf2 half2","    #define FxaaHalf3 half3","    #define FxaaHalf4 half4","    #define FxaaSat(x) saturate(x)","#endif","","#if (FXAA_GLSL_100 == 1)","  #define FxaaTexTop(t, p) texture2D(t, p, 0.0)","  #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)","#endif","","#if (FXAA_GLSL_120 == 1)","    // Requires,","    //  #version 120","    // And at least,","    //  #extension GL_EXT_gpu_shader4 : enable","    //  (or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)","    #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)","    #if (FXAA_FAST_PIXEL_OFFSET == 1)","        #define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)","    #else","        #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)","    #endif","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","","#if (FXAA_GLSL_130 == 1)",'    // Requires "#version 130" or better',"    #define FxaaTexTop(t, p) textureLod(t, p, 0.0)","    #define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","","#if (FXAA_HLSL_3 == 1)","    #define FxaaInt2 float2","    #define FxaaTex sampler2D","    #define FxaaTexTop(t, p) tex2Dlod(t, float4(p, 0.0, 0.0))","    #define FxaaTexOff(t, p, o, r) tex2Dlod(t, float4(p + (o * r), 0, 0))","#endif","","#if (FXAA_HLSL_4 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","#endif","","#if (FXAA_HLSL_5 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","    #define FxaaTexAlpha4(t, p) t.tex.GatherAlpha(t.smpl, p)","    #define FxaaTexOffAlpha4(t, p, o) t.tex.GatherAlpha(t.smpl, p, o)","    #define FxaaTexGreen4(t, p) t.tex.GatherGreen(t.smpl, p)","    #define FxaaTexOffGreen4(t, p, o) t.tex.GatherGreen(t.smpl, p, o)","#endif","","","","#if (FXAA_GREEN_AS_LUMA == 0)","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }","#else","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }","#endif","","","","","","#if (FXAA_PC == 1)","","FxaaFloat4 FxaaPixelShader(","    //","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy} = center of pixel","    FxaaFloat2 pos,","    //","    // Used only for FXAA Console, and not used on the 360 version.","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy_} = upper left of pixel","    // {_zw} = lower right of pixel","    FxaaFloat4 fxaaConsolePosPos,","    //","    // Input color texture.","    // {rgb_} = color in linear or perceptual color space","    // if (FXAA_GREEN_AS_LUMA == 0)","    //     {__a} = luma in perceptual color space (not linear)","    FxaaTex tex,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 2nd sampler.","    // This sampler needs to have an exponent bias of -1.","    FxaaTex fxaaConsole360TexExpBiasNegOne,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 3nd sampler.","    // This sampler needs to have an exponent bias of -2.","    FxaaTex fxaaConsole360TexExpBiasNegTwo,","    //","    // Only used on FXAA Quality.","    // This must be from a constant/uniform.","    // {x_} = 1.0/screenWidthInPixels","    // {_y} = 1.0/screenHeightInPixels","    FxaaFloat2 fxaaQualityRcpFrame,","    //","    // Only used on FXAA Console.","    // This must be from a constant/uniform.","    // This effects sub-pixel AA quality and inversely sharpness.","    //   Where N ranges between,","    //     N = 0.50 (default)","    //     N = 0.33 (sharper)","    // {x__} = -N/screenWidthInPixels","    // {_y_} = -N/screenHeightInPixels","    // {_z_} =  N/screenWidthInPixels","    // {__w} =  N/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt,","    //","    // Only used on FXAA Console.","    // Not used on 360, but used on PS3 and PC.","    // This must be from a constant/uniform.","    // {x__} = -2.0/screenWidthInPixels","    // {_y_} = -2.0/screenHeightInPixels","    // {_z_} =  2.0/screenWidthInPixels","    // {__w} =  2.0/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt2,","    //","    // Only used on FXAA Console.","    // Only used on 360 in place of fxaaConsoleRcpFrameOpt2.","    // This must be from a constant/uniform.","    // {x__} =  8.0/screenWidthInPixels","    // {_y_} =  8.0/screenHeightInPixels","    // {_z_} = -4.0/screenWidthInPixels","    // {__w} = -4.0/screenHeightInPixels","    FxaaFloat4 fxaaConsole360RcpFrameOpt2,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_SUBPIX define.","    // It is here now to allow easier tuning.","    // Choose the amount of sub-pixel aliasing removal.","    // This can effect sharpness.","    //   1.00 - upper limit (softer)","    //   0.75 - default amount of filtering","    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)","    //   0.25 - almost off","    //   0.00 - completely off","    FxaaFloat fxaaQualitySubpix,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // The minimum amount of local contrast required to apply algorithm.","    //   0.333 - too little (faster)","    //   0.250 - low quality","    //   0.166 - default","    //   0.125 - high quality","    //   0.063 - overkill (slower)","    FxaaFloat fxaaQualityEdgeThreshold,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    //   0.0833 - upper limit (default, the start of visible unfiltered edges)","    //   0.0625 - high quality (faster)","    //   0.0312 - visible limit (slower)","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaQualityEdgeThresholdMin,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_SHARPNESS define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_SHARPNESS for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only three safe values here: 2 and 4 and 8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // For all other platforms can be a non-power of two.","    //   8.0 is sharper (default!!!)","    //   4.0 is softer","    //   2.0 is really soft (good only for vector graphics inputs)","    FxaaFloat fxaaConsoleEdgeSharpness,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_THRESHOLD for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only two safe values here: 1/4 and 1/8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // The console setting has a different mapping than the quality setting.","    // Other platforms can use other values.","    //   0.125 leaves less aliasing, but is softer (default!!!)","    //   0.25 leaves more aliasing, and is sharper","    FxaaFloat fxaaConsoleEdgeThreshold,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    // The console setting has a different mapping than the quality setting.","    // This only applies when FXAA_EARLY_EXIT is 1.","    // This does not apply to PS3,","    // PS3 was simplified to avoid more shader instructions.","    //   0.06 - faster but more aliasing in darks","    //   0.05 - default","    //   0.04 - slower and less aliasing in darks","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaConsoleEdgeThresholdMin,","    //","    // Extra constants for 360 FXAA Console only.","    // Use zeros or anything else for other platforms.","    // These must be in physical constant registers and NOT immediates.","    // Immediates will result in compiler un-optimizing.","    // {xyzw} = float4(1.0, -1.0, 0.25, -0.25)","    FxaaFloat4 fxaaConsole360ConstDir",") {","","    FxaaFloat2 posM;","    posM.x = pos.x;","    posM.y = pos.y;","    #if (FXAA_GATHER4_ALPHA == 1)","        #if (FXAA_DISCARD == 0)","            FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","            #if (FXAA_GREEN_AS_LUMA == 0)","                #define lumaM rgbyM.w","            #else","                #define lumaM rgbyM.y","            #endif","        #endif","        #if (FXAA_GREEN_AS_LUMA == 0)","            FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));","        #else","            FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));","        #endif","        #if (FXAA_DISCARD == 1)","            #define lumaM luma4A.w","        #endif","        #define lumaE luma4A.z","        #define lumaS luma4A.x","        #define lumaSE luma4A.y","        #define lumaNW luma4B.w","        #define lumaN luma4B.z","        #define lumaW luma4B.x","    #else","        FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","        #if (FXAA_GREEN_AS_LUMA == 0)","            #define lumaM rgbyM.w","        #else","            #define lumaM rgbyM.y","        #endif","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));","        #endif","    #endif","","    FxaaFloat maxSM = max(lumaS, lumaM);","    FxaaFloat minSM = min(lumaS, lumaM);","    FxaaFloat maxESM = max(lumaE, maxSM);","    FxaaFloat minESM = min(lumaE, minSM);","    FxaaFloat maxWN = max(lumaN, lumaW);","    FxaaFloat minWN = min(lumaN, lumaW);","    FxaaFloat rangeMax = max(maxWN, maxESM);","    FxaaFloat rangeMin = min(minWN, minESM);","    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;","    FxaaFloat range = rangeMax - rangeMin;","    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);","    FxaaBool earlyExit = range < rangeMaxClamped;","","    if(earlyExit)","        #if (FXAA_DISCARD == 1)","            FxaaDiscard;","        #else","            return rgbyM;","        #endif","","    #if (FXAA_GATHER4_ALPHA == 0)","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","        #endif","    #else","        FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));","        FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","    #endif","","    FxaaFloat lumaNS = lumaN + lumaS;","    FxaaFloat lumaWE = lumaW + lumaE;","    FxaaFloat subpixRcpRange = 1.0/range;","    FxaaFloat subpixNSWE = lumaNS + lumaWE;","    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;","    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;","","    FxaaFloat lumaNESE = lumaNE + lumaSE;","    FxaaFloat lumaNWNE = lumaNW + lumaNE;","    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;","    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;","","    FxaaFloat lumaNWSW = lumaNW + lumaSW;","    FxaaFloat lumaSWSE = lumaSW + lumaSE;","    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);","    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);","    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;","    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;","    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;","    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;","","    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;","    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;","    FxaaBool horzSpan = edgeHorz >= edgeVert;","    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;","","    if(!horzSpan) lumaN = lumaW;","    if(!horzSpan) lumaS = lumaE;","    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;","    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;","","    FxaaFloat gradientN = lumaN - lumaM;","    FxaaFloat gradientS = lumaS - lumaM;","    FxaaFloat lumaNN = lumaN + lumaM;","    FxaaFloat lumaSS = lumaS + lumaM;","    FxaaBool pairN = abs(gradientN) >= abs(gradientS);","    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));","    if(pairN) lengthSign = -lengthSign;","    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);","","    FxaaFloat2 posB;","    posB.x = posM.x;","    posB.y = posM.y;","    FxaaFloat2 offNP;","    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;","    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;","    if(!horzSpan) posB.x += lengthSign * 0.5;","    if( horzSpan) posB.y += lengthSign * 0.5;","","    FxaaFloat2 posN;","    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;","    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;","    FxaaFloat2 posP;","    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;","    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;","    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;","    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));","    FxaaFloat subpixE = subpixC * subpixC;","    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));","","    if(!pairN) lumaNN = lumaSS;","    FxaaFloat gradientScaled = gradient * 1.0/4.0;","    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;","    FxaaFloat subpixF = subpixD * subpixE;","    FxaaBool lumaMLTZero = lumaMM < 0.0;","","    lumaEndN -= lumaNN * 0.5;","    lumaEndP -= lumaNN * 0.5;","    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;","    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;","    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;","    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;","    FxaaBool doneNP = (!doneN) || (!doneP);","    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;","    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;","","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;","","        #if (FXAA_QUALITY_PS > 3)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;","","            #if (FXAA_QUALITY_PS > 4)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;","","                #if (FXAA_QUALITY_PS > 5)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;","","                    #if (FXAA_QUALITY_PS > 6)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;","","                        #if (FXAA_QUALITY_PS > 7)","                        if(doneNP) {","                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                            doneN = abs(lumaEndN) >= gradientScaled;","                            doneP = abs(lumaEndP) >= gradientScaled;","                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;","                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;","                            doneNP = (!doneN) || (!doneP);","                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;","                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;","","    #if (FXAA_QUALITY_PS > 8)","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;","","        #if (FXAA_QUALITY_PS > 9)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;","","            #if (FXAA_QUALITY_PS > 10)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;","","                #if (FXAA_QUALITY_PS > 11)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;","","                    #if (FXAA_QUALITY_PS > 12)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;","","                    }","                    #endif","","                }","                #endif","","            }","            #endif","","        }","        #endif","","    }","    #endif","","                        }","                        #endif","","                    }","                    #endif","","                }","                #endif","","            }","            #endif","","        }","        #endif","","    }","","    FxaaFloat dstN = posM.x - posN.x;","    FxaaFloat dstP = posP.x - posM.x;","    if(!horzSpan) dstN = posM.y - posN.y;","    if(!horzSpan) dstP = posP.y - posM.y;","","    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;","    FxaaFloat spanLength = (dstP + dstN);","    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;","    FxaaFloat spanLengthRcp = 1.0/spanLength;","","    FxaaBool directionN = dstN < dstP;","    FxaaFloat dst = min(dstN, dstP);","    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;","    FxaaFloat subpixG = subpixF * subpixF;","    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;","    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;","","    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;","    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);","    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;","    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;","    #if (FXAA_DISCARD == 1)","        return FxaaTexTop(tex, posM);","    #else","        return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);","    #endif","}","","#endif","","void main() {","  gl_FragColor = FxaaPixelShader(","    vUv,","    vec4(0.0),","    tDiffuse,","    tDiffuse,","    tDiffuse,","    resolution,","    vec4(0.0),","    vec4(0.0),","    vec4(0.0),","    0.75,","    0.166,","    0.0833,","    0.0,","    0.0,","    0.0,","    vec4(0.0)","  );","","  // TODO avoid querying texture twice for same texel","  gl_FragColor.a = texture2D(tDiffuse, vUv).a;","}"].join("\n")},WebGLDeferredRenderer=function(e){e=e||{};var t,r,n,i,o,a,s,l,u,c,h,p,f,d,m,v,g,y,b,x,w,S,M=this,_=!1,T=!1,A=!1,C=!1,E=new ShaderMaterial({visible:!1}),L=new Vector3,N={},P={},O={},R={},D={},F={},k={},I={},B={},U=60,V={},j={},z={};function G(e){var t=N[e.uuid],r=P[e.uuid];void 0===t&&((n=new Scene).userData.lights={},(t=_e()).scene=n,N[e.uuid]=t);if(void 0===r){var n;(n=new Scene).userData.lights={};var i=function(){var e=ShaderDeferred.emissiveLight,t=new ShaderMaterial({uniforms:Object.assign({},e.uniforms),vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,blending:NoBlending,depthWrite:!1}),r=new Mesh(new PlaneBufferGeometry(2,2),t);return r.onBeforeRender=function(e,t,r,n,i,a){i.uniforms.samplerColor.value=o.renderTarget2.texture},r}();n.userData.emissiveLight=i,n.add(i),(r=_e()).scene=n,P[e.uuid]=r}t.used=!0,r.used=!0;var a=t.scene,s=r.scene;s.userData.emissiveLight.visible=!A,w=a,S=s}function W(e,t,r,n){var i=t[e.uuid];return void 0===i&&((i=_e()).material=r(e),t[e.uuid]=i),i.used=!0,n(i.material,e),V[i.material.uuid]=e,i.material}function H(e,t,r){if(void 0!==e.material){if(Array.isArray(e.material))for(var n=0,i=e.material.length;n<i;n++)e.material[n]=t(e.material[n]);else e.material=t(e.material);e.onBeforeRender=r}}function X(e){if(void 0!==e.material)if(Array.isArray(e.material))for(var t=0,r=e.material.length;t<r;t++)e.material[t]=V[e.material[t].uuid];else e.material=V[e.material.uuid]}function q(e){H(e,Y,J)}function Y(e){return W(e,A?R:O,K,Q)}function K(e){var t=A?ShaderDeferred.normalDepthShininess:ShaderDeferred.normalDepth;return new ShaderMaterial({uniforms:Object.assign({},t.uniforms),fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,blending:NoBlending})}function Q(e,t){void 0!==t.skinning&&(e.skinning=t.skinning),void 0!==t.morphTargets&&(e.morphTargets=t.morphTargets),!0===t.visible?e.visible=!t.transparent:e.visible=!1}function J(e,t,r,n,i,o){if(A){var a=V[i.uuid];void 0!==a&&void 0!==a.shininess&&(i.uniforms.shininess.value=a.shininess)}}function Z(e){H(e,$,re)}function $(e){return W(e,D,ee,te)}function ee(e){var t=ShaderDeferred.color,r=new ShaderMaterial({uniforms:Object.assign({},t.uniforms),fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,blending:NoBlending});return void 0!==e.map&&(r.map=e.map),r}function te(e,t){void 0!==t.map&&(e.map=t.map),void 0!==t.skinning&&(e.skinning=t.skinning),void 0!==t.morphTargets&&(e.morphTargets=t.morphTargets),!0===t.visible?e.visible=!t.transparent:e.visible=!1}function re(e,t,r,n,i,o){var a,s,l=V[i.uuid],u=i.uniforms;!0===l.isMeshBasicMaterial?s=l.color:(a=l.color,s=l.emissive);var c=l.specular,h=l.shininess,p=l.map;void 0!==a&&u.diffuse.value.copy(a),void 0!==s&&u.emissive.value.copy(s),void 0!==c&&u.specular.value.copy(c),void 0!==h&&void 0!==u.shininess&&(u.shininess.value=h),void 0!==p&&(u.map.value=p)}function ne(e){H(e,ie,se)}function ie(e){return!0===e.transparent?(V[e.uuid]=e,e):W(e,F,oe,ae)}function oe(e){var t=ShaderDeferred.reconstruction,r=new ShaderMaterial({uniforms:Object.assign({},t.uniforms),fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,blending:NoBlending});return void 0!==e.map&&(r.map=e.map),r}function ae(e,t){te(e,t)}function se(e,t,r,n,i,o){if(!0!==i.transparent)re(0,0,0,0,i),i.uniforms.samplerLight.value=p.renderTarget2.texture;else{var a=j[this.uuid];a&&a.call(this,e,t,r,n,i,o)}}function le(e){if(void 0!==e.material)if(Array.isArray(e.material))for(var t=0,r=e.material.length;t<r;t++)void 0===z[e.material[t].uuid]&&(z[e.material[t].uuid]=e.material[t].visible,e.material[t].visible=e.material[t].transparent&&e.material[t].visible);else void 0===z[e.material.uuid]&&(z[e.material.uuid]=e.material.visible,e.material.visible=e.material.transparent&&e.material.visible)}function ue(e){if(void 0!==e.material)if(Array.isArray(e.material))for(var t=0,r=e.material.length;t<r;t++)e.material[t].visible=z[e.material[t].uuid];else e.material.visible=z[e.material.uuid]}function ce(e){return e.isPointLight?function(e){var t=de(e,new SphereBufferGeometry(1,16,8));return t.onBeforeRender=ge,t}(e):e.isSpotLight?function(e){var t=de(e,new PlaneBufferGeometry(2,2));return t.onBeforeRender=ye,t}(e):e.isDirectionalLight?function(e){var t=de(e,new PlaneBufferGeometry(2,2));return t.onBeforeRender=be,t}(e):null}function he(e){return e.isPointLight?function(){var e=me(A?ShaderDeferred.pointLightPre:ShaderDeferred.pointLight);return e.side=BackSide,e.depthFunc=GreaterEqualDepth,e}():e.isSpotLight?function(){var e=me(A?ShaderDeferred.spotLightPre:ShaderDeferred.spotLight);return e.depthTest=!1,e}():e.isDirectionalLight?function(){var e=me(A?ShaderDeferred.directionalLightPre:ShaderDeferred.directionalLight);return e.depthTest=!1,e}():null}function pe(e){var t=A?B:I,r=t[e.uuid];return void 0===r&&((r=_e()).material=he(e.userData.originalLight),t[e.uuid]=r),r.used=!0,r.material}function fe(e){e.userData.originalLight.isPointLight&&function(e){var t=e.userData.originalLight,r=t.distance;r>0&&(e.scale.set(1,1,1).multiplyScalar(r),e.position.setFromMatrixPosition(t.matrixWorld))}(e)}function de(e,t){var r=new Mesh(t,E);return r.userData.originalLight=e,r}function me(e){var t=new ShaderMaterial({uniforms:Object.assign({},e.uniforms),vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,transparent:!0,blending:AdditiveBlending,depthWrite:!1});return A&&(t.premultipliedAlpha=!0),t}function ve(e){A?e.samplerNormalDepthShininess.value=h.renderTarget2.texture:(e.samplerNormalDepth.value=h.renderTarget2.texture,e.samplerColor.value=o.renderTarget2.texture)}function ge(e,t,r,n,i,o){var a=this.userData.originalLight,s=a.distance,l=i.uniforms;l.lightColor.value.copy(a.color),s>0?(l.lightRadius.value=s,l.lightIntensity.value=a.intensity,l.lightPositionVS.value.setFromMatrixPosition(a.matrixWorld).applyMatrix4(x.matrixWorldInverse)):l.lightRadius.value=1/0,ve(l)}function ye(e,t,r,n,i,o){var a=this.userData.originalLight,s=this.material.uniforms;s.lightAngle.value=a.angle,s.lightColor.value.copy(a.color),s.lightIntensity.value=a.intensity,s.lightPositionVS.value.setFromMatrixPosition(a.matrixWorld).applyMatrix4(x.matrixWorldInverse);var l=s.lightDirectionVS.value,u=L;l.setFromMatrixPosition(a.matrixWorld),u.setFromMatrixPosition(a.target.matrixWorld),l.sub(u).normalize().transformDirection(x.matrixWorldInverse),ve(s)}function be(e,t,r,n,i,o){var a=this.userData.originalLight,s=this.material.uniforms;s.lightColor.value.copy(a.color),s.lightIntensity.value=a.intensity;var l=s.lightDirectionVS.value,u=L;l.setFromMatrixPosition(a.matrixWorld),u.setFromMatrixPosition(a.target.matrixWorld),l.sub(u).normalize().transformDirection(x.matrixWorldInverse),ve(s)}function xe(e){if(void 0!==e.material&&(j[e.uuid]=e.onBeforeRender,!T&&!A&&e.visible))if(Array.isArray(e.material)){for(var t=0,r=e.material.length;t<r;t++)if(!0===e.material[t].visible&&!0===e.material[t].transparent){T=!0;break}}else!0===e.material.visible&&!0===e.material.transparent&&(T=!0)}function we(e){void 0!==e.material&&(e.onBeforeRender=j[e.uuid])}function Se(e){if(!0===e.isLight){var t=k[e.uuid];void 0===t&&((t=_e()).light=ce(e),k[e.uuid]=t),t.used=!0;var r=t.light;if(null!==r){var n=!0===e.isPointLight?w:S,i=n.userData.lights;void 0===i[r.uuid]&&(n.add(r),i[r.uuid]={light:r,found:!0}),i[r.uuid].found=!0}}}function Me(e){for(var t=e.userData.lights,r=Object.keys(t),n=0,i=r.length;n<i;n++){var o=r[n];if(!1===t[o].found)e.remove(t[o].light),delete t[o];else{var a=t[o].light;a.material=pe(a),fe(a),t[o].found=!1}}}function _e(){return{used:!0,keepAlive:C,count:0}}function Te(e){for(var t=Object.keys(e),r=0,n=t.length;r<n;r++){var i=t[r];!1===e[i].used?(e[i].count++,!1===e[i].keepAlive&&e[i].count>U&&delete e[i]):(e[i].used=!1,e[i].count=0)}}function Ae(e){for(var t=Object.keys(e),r=0,n=t.length;r<n;r++){e[t[r]]=void 0}}function Ce(e,t){!A&&T&&(e.traverse(le),e.traverse(we),s.scene=e,s.camera=t),A?(s.renderToScreen=!1,s.enabled=!1,l.renderToScreen=!1,l.enabled=!1,_?(g.renderToScreen=!1,y.renderToScreen=!0,y.enabled=!0):(g.renderToScreen=!0,y.renderToScreen=!1,y.enabled=!1)):T?_?(g.renderToScreen=!1,s.renderToScreen=!1,s.enabled=!0,l.renderToScreen=!1,l.enabled=!1,y.renderToScreen=!0,y.enabled=!0):(g.renderToScreen=!1,s.renderToScreen=!1,s.enabled=!0,l.renderToScreen=!0,l.enabled=!0,y.renderToScreen=!1,y.enabled=!1):_?(g.renderToScreen=!1,s.renderToScreen=!1,s.enabled=!1,l.renderToScreen=!1,l.enabled=!1,y.renderToScreen=!0,y.enabled=!0):(g.renderToScreen=!0,s.renderToScreen=!1,s.enabled=!1,l.renderToScreen=!1,l.enabled=!1,y.renderToScreen=!1,y.enabled=!1),M.renderer.autoClearDepth=!1,M.renderer.autoClearStencil=!1,f.render(),!A&&T&&e.traverse(ue)}this.renderer=void 0,this.domElement=void 0,this.forwardRendering=!1,this.setSize=function(e,t){n=e,i=t,this.renderer.setSize(n,i),h.setSize(n,i),o.setSize(n,i),p.setSize(n,i),u.setSize(n,i),f.setSize(n,i),b.image.width=n,b.image.height=i,b.needsUpdate=!0,y.uniforms.resolution.value.set(1/n,1/i)},this.setAntialias=function(e){_=e},this.enableLightPrePass=function(e){A=e,g.uniforms.samplerResult.value=A?u.renderTarget2.texture:p.renderTarget2.texture},this.render=function(e,s){if(this.forwardRendering)this.renderer.render(e,s);else{var l=e.autoUpdate,f=this.renderer.autoClearColor,g=this.renderer.autoClearDepth,y=this.renderer.autoClearStencil;x=s,G(e),e.autoUpdate=!1,e.updateMatrixWorld(),T=!1,e.traverse(xe),function(e){var t=ShaderDeferredCommon.commonUniforms;t.viewWidth.value=n,t.viewHeight.value=i,t.matProjInverse.value.getInverse(e.projectionMatrix)}(s),function(e,n){e.traverse(q),d.scene=e,d.camera=n,M.renderer.autoClearDepth=!0,M.renderer.autoClearStencil=!0,r.buffers.stencil.setTest(!0),r.buffers.stencil.setFunc(t.ALWAYS,1,4294967295),r.buffers.stencil.setOp(t.REPLACE,t.REPLACE,t.REPLACE),h.render(),e.traverse(X)}(e,s),A?(function(e,n){e.traverse(Se),Me(w),Me(S),m.scene=w,m.camera=n,v.scene=S,M.renderer.autoClearDepth=!1,M.renderer.autoClearStencil=!1,r.buffers.stencil.setFunc(t.EQUAL,1,4294967295),r.buffers.stencil.setOp(t.KEEP,t.KEEP,t.KEEP),p.render()}(e,s),function(e,t){e.traverse(ne),c.scene=e,c.camera=t,M.renderer.autoClearDepth=!1,M.renderer.autoClearStencil=!1,u.render(),r.buffers.stencil.setTest(!1),e.traverse(X)}(e,s)):(function(e,n){e.traverse(Z),a.scene=e,a.camera=n,M.renderer.autoClearDepth=!1,M.renderer.autoClearStencil=!1,r.buffers.stencil.setFunc(t.EQUAL,1,4294967295),r.buffers.stencil.setOp(t.KEEP,t.KEEP,t.KEEP),o.render(),e.traverse(X)}(e,s),function(e,t){e.traverse(Se),Me(w),Me(S),m.scene=w,m.camera=t,v.scene=S,M.renderer.autoClearDepth=!1,M.renderer.autoClearStencil=!1,p.render(),r.buffers.stencil.setTest(!1)}(e,s)),Ce(e,s),e.traverse(we),Te(N),Te(P),Te(O),Te(R),Te(D),Te(F),Te(I),Te(B),Te(k),Ae(V),Ae(j),Ae(z),e.autoUpdate=l,this.renderer.autoClearColor=f,this.renderer.autoClearDepth=g,this.renderer.autoClearStencil=y}},function(e){M.renderer=void 0!==e.renderer?e.renderer:new WebGLRenderer,M.domElement=M.renderer.domElement,t=M.renderer.context,r=M.renderer.state,n=void 0!==e.width?e.width:M.renderer.getSize(new Vector2).width,i=void 0!==e.height?e.height:M.renderer.getSize(new Vector2).height;var x=void 0!==e.antialias&&e.antialias;void 0!==e.cacheKeepAlive&&(C=e.cacheKeepAlive),b=new DepthTexture(n,i,UnsignedInt248Type,void 0,void 0,void 0,void 0,void 0,void 0,DepthStencilFormat),function(){(d=new RenderPass).clear=!0;var e=new WebGLRenderTarget(n,i,{minFilter:NearestFilter,magFilter:NearestFilter,format:RGBAFormat,type:FloatType,stencilBuffer:!0,depthTexture:b});e.texture.generateMipamps=!1,(h=new EffectComposer(M.renderer,e)).addPass(d)}(),function(){(a=new RenderPass).clear=!0;var e=new WebGLRenderTarget(n,i,{minFilter:NearestFilter,magFilter:NearestFilter,format:RGBAFormat,type:FloatType,depthTexture:b});e.texture.generateMipamps=!1,(o=new EffectComposer(M.renderer,e)).addPass(a)}(),function(){(v=new RenderPass).clear=!0,v.camera=new OrthographicCamera(-1,1,1,-1,0,1),(m=new RenderPass).clear=!1;var e=new WebGLRenderTarget(n,i,{minFilter:NearestFilter,magFilter:NearestFilter,format:RGBAFormat,type:FloatType,depthTexture:b});e.texture.generateMipamps=!1,(p=new EffectComposer(M.renderer,e)).addPass(v),p.addPass(m)}(),function(){(c=new RenderPass).clear=!0;var e=new WebGLRenderTarget(n,i,{minFilter:NearestFilter,magFilter:NearestFilter,format:RGBAFormat,type:FloatType,depthTexture:b});e.texture.generateMipamps=!1,(u=new EffectComposer(M.renderer,e)).addPass(c)}(),function(){(g=new ShaderPass(ShaderDeferred.final)).clear=!0,g.uniforms.samplerResult.value=p.renderTarget2.texture,g.material.blending=NoBlending,g.material.depthWrite=!1,g.material.depthTest=!1,(s=new RenderPass).clear=!1,l=new ShaderPass(CopyShader),y=new ShaderPass(FXAAShader);var e=new WebGLRenderTarget(n,i,{minFilter:NearestFilter,magFilter:LinearFilter,format:RGBFormat,type:UnsignedByteType,depthTexture:b});e.texture.generateMipamps=!1,(f=new EffectComposer(M.renderer,e)).addPass(g),f.addPass(s),f.addPass(l),f.addPass(y)}(),M.setSize(n,i),M.setAntialias(x),M.enableLightPrePass(!1)}(e)},DeferredShaderChunk={packVector3:["float vec3_to_float( vec3 data ) {","\tconst float unit = 255.0/256.0;","\thighp float compressed = fract( data.x * unit ) + floor( data.y * unit * 255.0 ) + floor( data.z * unit * 255.0 ) * 255.0;","\treturn compressed;","}"].join("\n"),unpackFloat:["vec3 float_to_vec3( float data ) {","\tconst float unit = 255.0;","\tvec3 uncompressed;","\tuncompressed.x = fract( data );","\tfloat zInt = floor( data / unit );","\tuncompressed.z = fract( zInt / unit );","\tuncompressed.y = fract( floor( data - ( zInt * unit ) ) / unit );","\treturn uncompressed;","}"].join("\n"),packNormal:["vec2 normal_to_vec2( vec3 normal ) {","\treturn normal.xy / sqrt( normal.z * 8.0 + 8.0 ) + 0.5;","}"].join("\n"),unpackVector2:["vec3 vec2_to_normal( vec2 data ) {","\tvec2 fenc = data * 4.0 - 2.0;","\tfloat f = dot( fenc, fenc );","\tfloat g = sqrt( 1.0 - f / 4.0 );","\tvec3 normal;","\tnormal.xy = fenc * g;","\tnormal.z = 1.0 - f / 2.0;","\treturn normal;","}"].join("\n"),computeTextureCoord:["vec2 texCoord = gl_FragCoord.xy / vec2( viewWidth, viewHeight );"].join("\n"),packNormalDepth:["vec4 packedNormalDepth;","packedNormalDepth.xyz = normal * 0.5 + 0.5;","packedNormalDepth.w = position.z / position.w;"].join("\n"),unpackNormalDepth:["vec4 normalDepthMap = texture2D( samplerNormalDepth, texCoord );","float depth = normalDepthMap.w;","if ( depth == 0.0 ) discard;","vec3 normal = normalDepthMap.xyz * 2.0 - 1.0;"].join("\n"),packNormalDepthShininess:["vec4 packedNormalDepthShininess;","packedNormalDepthShininess.xy = normal_to_vec2( normal );","packedNormalDepthShininess.z = shininess;","packedNormalDepthShininess.w = position.z / position.w;"].join("\n"),unpackNormalDepthShininess:["vec4 normalDepthMap = texture2D( samplerNormalDepthShininess, texCoord );","float depth = normalDepthMap.w;","if ( depth == 0.0 ) discard;","vec3 normal = vec2_to_normal( normalDepthMap.xy );","float shininess = normalDepthMap.z;"].join("\n"),packColor:["vec4 packedColor;","packedColor.x = vec3_to_float( diffuseColor.rgb );","packedColor.y = vec3_to_float( emissiveColor );","packedColor.z = vec3_to_float( specularColor );","packedColor.w = shininess;"].join("\n"),unpackColor:["vec4 colorMap = texture2D( samplerColor, texCoord );","vec3 diffuseColor = float_to_vec3( colorMap.x );","vec3 emissiveColor = float_to_vec3( colorMap.y );","vec3 specularColor = float_to_vec3( colorMap.z );","float shininess = colorMap.w;"].join("\n"),packLight:["vec4 packedLight;","packedLight.xyz = lightIntensity * lightColor * max( dot( lightVector, normal ), 0.0 ) * attenuation;","packedLight.w = lightIntensity * specular * max( dot( lightVector, normal ), 0.0 ) * attenuation;"].join("\n"),computeVertexPositionVS:["vec2 xy = texCoord * 2.0 - 1.0;","vec4 vertexPositionProjected = vec4( xy, depth, 1.0 );","vec4 vertexPositionVS = matProjInverse * vertexPositionProjected;","vertexPositionVS.xyz /= vertexPositionVS.w;","vertexPositionVS.w = 1.0;"].join("\n"),computeSpecular:["vec3 halfVector = normalize( lightVector - normalize( vertexPositionVS.xyz ) );","float dotNormalHalf = max( dot( normal, halfVector ), 0.0 );","float specular = 0.31830988618 * ( shininess * 0.5 + 1.0 ) * pow( dotNormalHalf, shininess );"].join("\n"),combine:["gl_FragColor = vec4( lightIntensity * lightColor * max( dot( lightVector, normal ), 0.0 ) * ( diffuseColor + specular * specularColor ) * attenuation, 1.0 );"].join("\n")},ShaderDeferredCommon={commonUniforms:{matProjInverse:new Uniform(new Matrix4),viewWidth:new Uniform(800),viewHeight:new Uniform(600)}},ShaderDeferred={normalDepth:{uniforms:{},vertexShader:["varying vec3 vNormal;","varying vec4 vPosition;","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","void main() {","#include <begin_vertex>","#include <beginnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#include <morphtarget_vertex>","#include <skinning_vertex>","#include <project_vertex>","\tvNormal = normalize( transformedNormal );","\tvPosition = gl_Position;","}"].join("\n"),fragmentShader:["varying vec3 vNormal;","varying vec4 vPosition;","void main() {","\tvec3 normal = vNormal;","\tvec4 position = vPosition;",DeferredShaderChunk.packNormalDepth,"\tgl_FragColor = packedNormalDepth;","}"].join("\n")},color:{uniforms:{map:new Uniform(null),offsetRepeat:new Uniform(new Vector4(0,0,1,1)),diffuse:new Uniform(new Color(0)),emissive:new Uniform(new Color(0)),specular:new Uniform(new Color(0)),shininess:new Uniform(30)},vertexShader:["#include <uv_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","void main() {","#include <uv_vertex>","#include <begin_vertex>","#include <beginnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#include <morphtarget_vertex>","#include <skinning_vertex>","#include <project_vertex>","}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;","#include <uv_pars_fragment>","#include <map_pars_fragment>",DeferredShaderChunk.packVector3,"void main() {","\tvec4 diffuseColor = vec4( diffuse, 1.0 );","\tvec3 emissiveColor = emissive;","\tvec3 specularColor = specular;","#include <map_fragment>",DeferredShaderChunk.packColor,"\tgl_FragColor = packedColor;","}"].join("\n")},emissiveLight:{uniforms:Object.assign({samplerColor:new Uniform(null)},ShaderDeferredCommon.commonUniforms),vertexShader:["void main() { ","\tgl_Position = vec4( sign( position.xy ), 0.0, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D samplerColor;","uniform float viewHeight;","uniform float viewWidth;",DeferredShaderChunk.unpackFloat,"void main() {",DeferredShaderChunk.computeTextureCoord,DeferredShaderChunk.unpackColor,"\tgl_FragColor = vec4( emissiveColor, 1.0 );","}"].join("\n")},pointLight:{uniforms:Object.assign({samplerNormalDepth:new Uniform(null),samplerColor:new Uniform(null),lightColor:new Uniform(new Color(0)),lightPositionVS:new Uniform(new Vector3(0,1,0)),lightIntensity:new Uniform(1),lightRadius:new Uniform(1)},ShaderDeferredCommon.commonUniforms),vertexShader:["void main() {","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D samplerNormalDepth;","uniform sampler2D samplerColor;","uniform float viewHeight;","uniform float viewWidth;","uniform vec3 lightColor;","uniform vec3 lightPositionVS;","uniform float lightIntensity;","uniform float lightRadius;","uniform mat4 matProjInverse;",DeferredShaderChunk.unpackFloat,"void main() {",DeferredShaderChunk.computeTextureCoord,DeferredShaderChunk.unpackNormalDepth,DeferredShaderChunk.computeVertexPositionVS,"\tvec3 lightVector = lightPositionVS - vertexPositionVS.xyz;","\tfloat distance = length( lightVector );","\tif ( distance > lightRadius ) discard;","\tlightVector = normalize( lightVector );",DeferredShaderChunk.unpackColor,DeferredShaderChunk.computeSpecular,"\t//float cutoff = 0.3;","\t//float denom = distance / lightRadius + 1.0;","\t//float attenuation = 1.0 / ( denom * denom );","\t//attenuation = ( attenuation - cutoff ) / ( 1.0 - cutoff );","\t//attenuation = max( attenuation, 0.0 );","\t//attenuation *= attenuation;","\t//diffuseColor *= saturate( -distance / lightRadius + 1.0 );","\t//float attenuation = 1.0;","\tfloat attenuation = saturate( -distance / lightRadius + 1.0 );",DeferredShaderChunk.combine,"}"].join("\n")},spotLight:{uniforms:Object.assign({samplerNormalDepth:new Uniform(null),samplerColor:new Uniform(null),lightColor:new Uniform(new Color(0)),lightDirectionVS:new Uniform(new Vector3(0,1,0)),lightPositionVS:new Uniform(new Vector3(0,1,0)),lightAngle:new Uniform(1),lightIntensity:new Uniform(1)},ShaderDeferredCommon.commonUniforms),vertexShader:["void main() { ","\tgl_Position = vec4( sign( position.xy ), 0.0, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D samplerNormalDepth;","uniform sampler2D samplerColor;","uniform float viewHeight;","uniform float viewWidth;","uniform vec3 lightColor;","uniform vec3 lightPositionVS;","uniform vec3 lightDirectionVS;","uniform float lightAngle;","uniform float lightIntensity;","uniform mat4 matProjInverse;",DeferredShaderChunk.unpackFloat,"void main() {",DeferredShaderChunk.computeTextureCoord,DeferredShaderChunk.unpackNormalDepth,DeferredShaderChunk.computeVertexPositionVS,DeferredShaderChunk.unpackColor,"\tvec3 lightVector = normalize( lightPositionVS.xyz - vertexPositionVS.xyz );","\tfloat rho = dot( lightDirectionVS, lightVector );","\tfloat rhoMax = cos( lightAngle );","\tif ( rho <= rhoMax ) discard;","\tfloat theta = rhoMax + 0.0001;","\tfloat phi = rhoMax + 0.05;","\tfloat falloff = 4.0;","\tfloat spot = 0.0;","\tif ( rho >= phi ) {","\t\tspot = 1.0;","\t} else if ( rho <= theta ) {","\t\tspot = 0.0;","\t} else { ","\t\tspot = pow( ( rho - theta ) / ( phi - theta ), falloff );","\t}","\tdiffuseColor *= spot;",DeferredShaderChunk.computeSpecular,"\tconst float attenuation = 1.0;",DeferredShaderChunk.combine,"}"].join("\n")},directionalLight:{uniforms:Object.assign({samplerNormalDepth:new Uniform(null),samplerColor:new Uniform(null),lightColor:new Uniform(new Color(0)),lightDirectionVS:new Uniform(new Vector3(0,1,0)),lightIntensity:new Uniform(1)},ShaderDeferredCommon.commonUniforms),vertexShader:["void main() { ","\tgl_Position = vec4( sign( position.xy ), 0.0, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D samplerNormalDepth;","uniform sampler2D samplerColor;","uniform float viewHeight;","uniform float viewWidth;","uniform vec3 lightColor;","uniform vec3 lightDirectionVS;","uniform float lightIntensity;","uniform mat4 matProjInverse;",DeferredShaderChunk.unpackFloat,"void main() {",DeferredShaderChunk.computeTextureCoord,DeferredShaderChunk.unpackNormalDepth,DeferredShaderChunk.computeVertexPositionVS,DeferredShaderChunk.unpackColor,"\tvec3 lightVector = normalize( lightDirectionVS );",DeferredShaderChunk.computeSpecular,"\tconst float attenuation = 1.0;",DeferredShaderChunk.combine,"}"].join("\n")},normalDepthShininess:{uniforms:{shininess:new Uniform(30)},vertexShader:["varying vec3 vNormal;","varying vec4 vPosition;","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","void main() {","#include <begin_vertex>","#include <beginnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#include <morphtarget_vertex>","#include <skinning_vertex>","#include <project_vertex>","\tvNormal = normalize( transformedNormal );","\tvPosition = gl_Position;","}"].join("\n"),fragmentShader:["varying vec3 vNormal;","varying vec4 vPosition;","uniform float shininess;",DeferredShaderChunk.packNormal,"void main() {","\tvec3 normal = vNormal;","\tvec4 position = vPosition;",DeferredShaderChunk.packNormalDepthShininess,"\tgl_FragColor = packedNormalDepthShininess;","}"].join("\n")},pointLightPre:{uniforms:Object.assign({samplerNormalDepthShininess:new Uniform(null),lightColor:new Uniform(new Color(0)),lightPositionVS:new Uniform(new Vector3(0,1,0)),lightIntensity:new Uniform(1),lightRadius:new Uniform(1)},ShaderDeferredCommon.commonUniforms),vertexShader:["void main() {","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D samplerNormalDepthShininess;","uniform float viewHeight;","uniform float viewWidth;","uniform vec3 lightColor;","uniform vec3 lightPositionVS;","uniform float lightIntensity;","uniform float lightRadius;","uniform mat4 matProjInverse;",DeferredShaderChunk.unpackFloat,DeferredShaderChunk.unpackVector2,"void main() {",DeferredShaderChunk.computeTextureCoord,DeferredShaderChunk.unpackNormalDepthShininess,DeferredShaderChunk.computeVertexPositionVS,"\tvec3 lightVector = lightPositionVS - vertexPositionVS.xyz;","\tfloat distance = length( lightVector );","\tif ( distance > lightRadius ) discard;","\tlightVector = normalize( lightVector );",DeferredShaderChunk.computeSpecular,"\tfloat attenuation = saturate( -distance / lightRadius + 1.0 );",DeferredShaderChunk.packLight,"\tgl_FragColor = packedLight;","}"].join("\n")},spotLightPre:{uniforms:Object.assign({samplerNormalDepthShininess:new Uniform(null),lightColor:new Uniform(new Color(0)),lightDirectionVS:new Uniform(new Vector3(0,1,0)),lightPositionVS:new Uniform(new Vector3(0,1,0)),lightAngle:new Uniform(1),lightIntensity:new Uniform(1)},ShaderDeferredCommon.commonUniforms),vertexShader:["void main() { ","\tgl_Position = vec4( sign( position.xy ), 0.0, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D samplerNormalDepthShininess;","uniform float viewHeight;","uniform float viewWidth;","uniform vec3 lightColor;","uniform vec3 lightPositionVS;","uniform vec3 lightDirectionVS;","uniform float lightAngle;","uniform float lightIntensity;","uniform mat4 matProjInverse;",DeferredShaderChunk.unpackFloat,DeferredShaderChunk.unpackVector2,"void main() {",DeferredShaderChunk.computeTextureCoord,DeferredShaderChunk.unpackNormalDepthShininess,DeferredShaderChunk.computeVertexPositionVS,"\tvec3 lightVector = normalize( lightPositionVS.xyz - vertexPositionVS.xyz );","\tfloat rho = dot( lightDirectionVS, lightVector );","\tfloat rhoMax = cos( lightAngle );","\tif ( rho <= rhoMax ) discard;","\tfloat theta = rhoMax + 0.0001;","\tfloat phi = rhoMax + 0.05;","\tfloat falloff = 4.0;","\tfloat spot = 0.0;","\tif ( rho >= phi ) {","\t\tspot = 1.0;","\t} else if ( rho <= theta ) {","\t\tspot = 0.0;","\t} else { ","\t\tspot = pow( ( rho - theta ) / ( phi - theta ), falloff );","\t}",DeferredShaderChunk.computeSpecular,"\tconst float attenuation = 1.0;",DeferredShaderChunk.packLight,"\tgl_FragColor = spot * packedLight;","}"].join("\n")},directionalLightPre:{uniforms:Object.assign({samplerNormalDepthShininess:new Uniform(null),lightColor:new Uniform(new Color(0)),lightDirectionVS:new Uniform(new Vector3(0,1,0)),lightIntensity:new Uniform(1)},ShaderDeferredCommon.commonUniforms),vertexShader:["void main() { ","\tgl_Position = vec4( sign( position.xy ), 0.0, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D samplerNormalDepthShininess;","uniform float viewHeight;","uniform float viewWidth;","uniform vec3 lightColor;","uniform vec3 lightDirectionVS;","uniform float lightIntensity;","uniform mat4 matProjInverse;",DeferredShaderChunk.unpackFloat,DeferredShaderChunk.unpackVector2,"void main() {",DeferredShaderChunk.computeTextureCoord,DeferredShaderChunk.unpackNormalDepthShininess,DeferredShaderChunk.computeVertexPositionVS,"\tvec3 lightVector = normalize( lightDirectionVS );",DeferredShaderChunk.computeSpecular,"\tconst float attenuation = 1.0;",DeferredShaderChunk.packLight,"\tgl_FragColor = packedLight;","}"].join("\n")},reconstruction:{uniforms:Object.assign({samplerLight:new Uniform(null),map:new Uniform(null),offsetRepeat:new Uniform(new Vector4(0,0,1,1)),diffuse:new Uniform(new Color(0)),emissive:new Uniform(new Color(0)),specular:new Uniform(new Color(0)),shininess:new Uniform(30)},ShaderDeferredCommon.commonUniforms),vertexShader:["#include <uv_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","void main() {","#include <uv_vertex>","#include <begin_vertex>","#include <beginnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#include <morphtarget_vertex>","#include <skinning_vertex>","#include <project_vertex>","}"].join("\n"),fragmentShader:["uniform sampler2D samplerLight;","uniform vec3 diffuse;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;","uniform float viewHeight;","uniform float viewWidth;","#include <uv_pars_fragment>","#include <map_pars_fragment>",DeferredShaderChunk.unpackFloat,"void main() {","\tvec4 diffuseColor = vec4( diffuse, 1.0 );","\tvec3 emissiveColor = emissive;","\tvec3 specularColor = specular;",DeferredShaderChunk.computeTextureCoord,"\tvec4 light = texture2D( samplerLight, texCoord );","#include <map_fragment>","\tvec3 diffuseFinal = diffuseColor.rgb * light.rgb;","\tvec3 emissiveFinal = emissiveColor;","\tvec3 specularFinal = specularColor * light.rgb * light.a;","\tgl_FragColor = vec4( diffuseFinal + emissiveFinal + specularFinal, 1.0 );","}"].join("\n")},final:{uniforms:{samplerResult:new Uniform(null)},vertexShader:["varying vec2 texCoord;","void main() {","\tvec4 pos = vec4( sign( position.xy ), 0.0, 1.0 );","\ttexCoord = pos.xy * vec2( 0.5 ) + 0.5;","\tgl_Position = pos;","}"].join("\n"),fragmentShader:["varying vec2 texCoord;","uniform sampler2D samplerResult;","void main() {","\tgl_FragColor = texture2D( samplerResult, texCoord );","}"].join("\n")}};function RollerCoasterGeometry(e,t){BufferGeometry.call(this);var r=[],n=[],i=[],o=[1,1,1],a=[1,1,0],s=new Vector3(0,1,0),l=new Vector3,u=new Vector3,c=new Quaternion,h=new Quaternion;h.setFromAxisAngle(s,Math.PI/2);var p=new Vector3,f=new Vector3;f.copy(e.getPointAt(0));for(var d=[new Vector3(-.225,0,0),new Vector3(0,-.05,0),new Vector3(0,-.175,0),new Vector3(0,-.05,0),new Vector3(.225,0,0),new Vector3(0,-.175,0)],m=2*Math.PI,v=5,g=[],y=0;y<v;y++){var b=y/v*m;g.push(new Vector3(.06*Math.sin(b),.06*Math.cos(b),0))}v=6;var x=[];for(y=0;y<v;y++){b=y/v*m;x.push(new Vector3(.025*Math.sin(b),.025*Math.cos(b),0))}var w=new Vector3,S=new Vector3;function M(e,t){S.set(0,0,-1).applyQuaternion(c);for(var o=0;o<e.length;o++)w.copy(e[o]),w.applyQuaternion(c),w.add(p),r.push(w.x,w.y,w.z),n.push(S.x,S.y,S.z),i.push(t[0],t[1],t[2]);S.set(0,0,1).applyQuaternion(c);for(o=e.length-1;o>=0;o--)w.copy(e[o]),w.applyQuaternion(c),w.add(p),r.push(w.x,w.y,w.z),n.push(S.x,S.y,S.z),i.push(t[0],t[1],t[2])}var _=new Vector3,T=new Vector3,A=new Vector3,C=new Vector3,E=new Vector3,L=new Vector3,N=new Vector3,P=new Vector3;function O(e,t,o){for(var a=0,s=e.length;a<s;a++){var l=e[a],u=e[(a+1)%s];_.copy(l).add(t),_.applyQuaternion(c),_.add(p),T.copy(u).add(t),T.applyQuaternion(c),T.add(p),A.copy(u).add(t),A.applyQuaternion(h),A.add(f),C.copy(l).add(t),C.applyQuaternion(h),C.add(f),r.push(_.x,_.y,_.z),r.push(T.x,T.y,T.z),r.push(C.x,C.y,C.z),r.push(T.x,T.y,T.z),r.push(A.x,A.y,A.z),r.push(C.x,C.y,C.z),E.copy(l),E.applyQuaternion(c),E.normalize(),L.copy(u),L.applyQuaternion(c),L.normalize(),N.copy(u),N.applyQuaternion(h),N.normalize(),P.copy(l),P.applyQuaternion(h),P.normalize(),n.push(E.x,E.y,E.z),n.push(L.x,L.y,L.z),n.push(P.x,P.y,P.z),n.push(L.x,L.y,L.z),n.push(N.x,N.y,N.z),n.push(P.x,P.y,P.z),i.push(o[0],o[1],o[2]),i.push(o[0],o[1],o[2]),i.push(o[0],o[1],o[2]),i.push(o[0],o[1],o[2]),i.push(o[0],o[1],o[2]),i.push(o[0],o[1],o[2])}}var R=new Vector3;for(y=1;y<=t;y++){p.copy(e.getPointAt(y/t)),s.set(0,1,0),l.subVectors(p,f).normalize(),u.crossVectors(s,l).normalize(),s.crossVectors(l,u);b=Math.atan2(l.x,l.z);c.setFromAxisAngle(s,b),y%2===0&&M(d,a),O(g,R.set(0,-.125,0),a),O(x,R.set(.2,0,0),o),O(x,R.set(-.2,0,0),o),f.copy(p),h.copy(c)}this.addAttribute("position",new BufferAttribute(new Float32Array(r),3)),this.addAttribute("normal",new BufferAttribute(new Float32Array(n),3)),this.addAttribute("color",new BufferAttribute(new Float32Array(i),3))}function RollerCoasterLiftersGeometry(e,t){BufferGeometry.call(this);var r=[],n=[],i=new Quaternion,o=new Vector3(0,1,0),a=new Vector3,s=new Vector3,l=[new Vector3(0,.05,-.05),new Vector3(0,.05,.05),new Vector3(0,-.05,0)],u=[new Vector3(-.05,0,.05),new Vector3(-.05,0,-.05),new Vector3(.05,0,0)],c=[new Vector3(.05,0,-.05),new Vector3(.05,0,.05),new Vector3(-.05,0,0)],h=new Vector3,p=new Vector3,f=new Vector3,d=new Vector3,m=new Vector3,v=new Vector3,g=new Vector3,y=new Vector3;function b(e,t,o){for(var a=0,s=e.length;a<s;a++){var l=e[a],u=e[(a+1)%s];h.copy(l),h.applyQuaternion(i),h.add(t),p.copy(u),p.applyQuaternion(i),p.add(t),f.copy(u),f.applyQuaternion(i),f.add(o),d.copy(l),d.applyQuaternion(i),d.add(o),r.push(h.x,h.y,h.z),r.push(p.x,p.y,p.z),r.push(d.x,d.y,d.z),r.push(p.x,p.y,p.z),r.push(f.x,f.y,f.z),r.push(d.x,d.y,d.z),m.copy(l),m.applyQuaternion(i),m.normalize(),v.copy(u),v.applyQuaternion(i),v.normalize(),g.copy(u),g.applyQuaternion(i),g.normalize(),y.copy(l),y.applyQuaternion(i),y.normalize(),n.push(m.x,m.y,m.z),n.push(v.x,v.y,v.z),n.push(y.x,y.y,y.z),n.push(v.x,v.y,v.z),n.push(g.x,g.y,g.z),n.push(y.x,y.y,y.z)}}for(var x=new Vector3,w=new Vector3,S=1;S<=t;S++){a.copy(e.getPointAt(S/t)),s.copy(e.getTangentAt(S/t));var M=Math.atan2(s.x,s.z);i.setFromAxisAngle(o,M),a.y>10?(x.set(-.75,-.35,0),x.applyQuaternion(i),x.add(a),w.set(.75,-.35,0),w.applyQuaternion(i),w.add(a),b(l,x,w),x.set(-.7,-.3,0),x.applyQuaternion(i),x.add(a),w.set(-.7,-a.y,0),w.applyQuaternion(i),w.add(a),b(u,x,w),x.set(.7,-.3,0),x.applyQuaternion(i),x.add(a),w.set(.7,-a.y,0),w.applyQuaternion(i),w.add(a),b(c,x,w)):(x.set(0,-.2,0),x.applyQuaternion(i),x.add(a),w.set(0,-a.y,0),w.applyQuaternion(i),w.add(a),b(c,x,w))}this.addAttribute("position",new BufferAttribute(new Float32Array(r),3)),this.addAttribute("normal",new BufferAttribute(new Float32Array(n),3))}function RollerCoasterShadowGeometry(e,t){BufferGeometry.call(this);var r=[],n=new Vector3(0,1,0),i=new Vector3,o=new Quaternion,a=new Quaternion;a.setFromAxisAngle(n,Math.PI/2);var s=new Vector3,l=new Vector3;l.copy(e.getPointAt(0)),l.y=0;for(var u=new Vector3,c=new Vector3,h=new Vector3,p=new Vector3,f=1;f<=t;f++){s.copy(e.getPointAt(f/t)),s.y=0,i.subVectors(s,l);var d=Math.atan2(i.x,i.z);o.setFromAxisAngle(n,d),u.set(-.3,0,0),u.applyQuaternion(o),u.add(s),c.set(.3,0,0),c.applyQuaternion(o),c.add(s),h.set(.3,0,0),h.applyQuaternion(a),h.add(l),p.set(-.3,0,0),p.applyQuaternion(a),p.add(l),r.push(u.x,u.y,u.z),r.push(c.x,c.y,c.z),r.push(p.x,p.y,p.z),r.push(c.x,c.y,c.z),r.push(h.x,h.y,h.z),r.push(p.x,p.y,p.z),l.copy(s),a.copy(o)}this.addAttribute("position",new BufferAttribute(new Float32Array(r),3))}function SkyGeometry(){BufferGeometry.call(this);for(var e=[],t=0;t<100;t++){var r=800*Math.random()-400,n=50*Math.random()+50,i=800*Math.random()-400,o=40*Math.random()+20;e.push(r-o,n,i-o),e.push(r+o,n,i-o),e.push(r-o,n,i+o),e.push(r+o,n,i-o),e.push(r+o,n,i+o),e.push(r-o,n,i+o)}this.addAttribute("position",new BufferAttribute(new Float32Array(e),3))}function TreesGeometry(e){BufferGeometry.call(this);var t=[],r=[],n=new Raycaster;n.ray.direction.set(0,-1,0);for(var i=0;i<2e3;i++){var o=500*Math.random()-250,a=500*Math.random()-250;n.ray.origin.set(o,50,a);var s=n.intersectObject(e);if(0!==s.length){var l=s[0].point.y,u=5*Math.random()+.5,c=Math.random()*Math.PI*2;t.push(o+Math.sin(c),l,a+Math.cos(c)),t.push(o,l+u,a),t.push(o+Math.sin(c+Math.PI),l,a+Math.cos(c+Math.PI)),c+=Math.PI/2,t.push(o+Math.sin(c),l,a+Math.cos(c)),t.push(o,l+u,a),t.push(o+Math.sin(c+Math.PI),l,a+Math.cos(c+Math.PI));for(var h=.1*Math.random(),p=0;p<6;p++)r.push(.2+h,.4+h,0)}}this.addAttribute("position",new BufferAttribute(new Float32Array(t),3)),this.addAttribute("color",new BufferAttribute(new Float32Array(r),3))}RollerCoasterGeometry.prototype=Object.create(BufferGeometry.prototype),RollerCoasterLiftersGeometry.prototype=Object.create(BufferGeometry.prototype),RollerCoasterShadowGeometry.prototype=Object.create(BufferGeometry.prototype),SkyGeometry.prototype=Object.create(BufferGeometry.prototype),TreesGeometry.prototype=Object.create(BufferGeometry.prototype);var ShaderGodRays={godrays_depthMask:{uniforms:{tInput:{value:null}},vertexShader:["varying vec2 vUv;","void main() {"," vUv = uv;"," gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","uniform sampler2D tInput;","void main() {","\tgl_FragColor = vec4( 1.0 ) - texture2D( tInput, vUv );","}"].join("\n")},godrays_generate:{uniforms:{tInput:{value:null},fStepSize:{value:1},vSunPositionScreenSpace:{value:new Vector2(.5,.5)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define TAPS_PER_PASS 6.0","varying vec2 vUv;","uniform sampler2D tInput;","uniform vec2 vSunPositionScreenSpace;","uniform float fStepSize;","void main() {","vec2 delta = vSunPositionScreenSpace - vUv;","float dist = length( delta );","vec2 stepv = fStepSize * delta / dist;","float iters = dist/fStepSize;","vec2 uv = vUv.xy;","float col = 0.0;","if ( 0.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;","uv += stepv;","if ( 1.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;","uv += stepv;","if ( 2.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;","uv += stepv;","if ( 3.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;","uv += stepv;","if ( 4.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;","uv += stepv;","if ( 5.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;","uv += stepv;","gl_FragColor = vec4( col/TAPS_PER_PASS );","gl_FragColor.a = 1.0;","}"].join("\n")},godrays_combine:{uniforms:{tColors:{value:null},tGodRays:{value:null},fGodRayIntensity:{value:.69},vSunPositionScreenSpace:{value:new Vector2(.5,.5)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","uniform sampler2D tColors;","uniform sampler2D tGodRays;","uniform vec2 vSunPositionScreenSpace;","uniform float fGodRayIntensity;","void main() {","gl_FragColor = texture2D( tColors, vUv ) + fGodRayIntensity * vec4( 1.0 - texture2D( tGodRays, vUv ).r );","gl_FragColor.a = 1.0;","}"].join("\n")},godrays_fake_sun:{uniforms:{vSunPositionScreenSpace:{value:new Vector2(.5,.5)},fAspect:{value:1},sunColor:{value:new Color(16772608)},bgColor:{value:new Color(0)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","uniform vec2 vSunPositionScreenSpace;","uniform float fAspect;","uniform vec3 sunColor;","uniform vec3 bgColor;","void main() {","vec2 diff = vUv - vSunPositionScreenSpace;","diff.x *= fAspect;","float prop = clamp( length( diff ) / 0.5, 0.0, 1.0 );","prop = 0.35 * pow( 1.0 - prop, 3.0 );","gl_FragColor.xyz = mix( sunColor, bgColor, 1.0 - prop );","gl_FragColor.w = 1.0;","}"].join("\n")}},BasicShader={uniforms:{},vertexShader:["void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["void main() {","gl_FragColor = vec4( 1.0, 0.0, 0.0, 0.5 );","}"].join("\n")},BleachBypassShader={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 base = texture2D( tDiffuse, vUv );","vec3 lumCoeff = vec3( 0.25, 0.65, 0.1 );","float lum = dot( lumCoeff, base.rgb );","vec3 blend = vec3( lum );","float L = min( 1.0, max( 0.0, 10.0 * ( lum - 0.45 ) ) );","vec3 result1 = 2.0 * base.rgb * blend;","vec3 result2 = 1.0 - 2.0 * ( 1.0 - blend ) * ( 1.0 - base.rgb );","vec3 newColor = mix( result1, result2, L );","float A2 = opacity * base.a;","vec3 mixRGB = A2 * newColor.rgb;","mixRGB += ( ( 1.0 - A2 ) * base.rgb );","gl_FragColor = vec4( mixRGB, base.a );","}"].join("\n")},BlendShader={uniforms:{tDiffuse1:{value:null},tDiffuse2:{value:null},mixRatio:{value:.5},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform float mixRatio;","uniform sampler2D tDiffuse1;","uniform sampler2D tDiffuse2;","varying vec2 vUv;","void main() {","vec4 texel1 = texture2D( tDiffuse1, vUv );","vec4 texel2 = texture2D( tDiffuse2, vUv );","gl_FragColor = opacity * mix( texel1, texel2, mixRatio );","}"].join("\n")},BrightnessContrastShader={uniforms:{tDiffuse:{value:null},brightness:{value:0},contrast:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float brightness;","uniform float contrast;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D( tDiffuse, vUv );","gl_FragColor.rgb += brightness;","if (contrast > 0.0) {","gl_FragColor.rgb = (gl_FragColor.rgb - 0.5) / (1.0 - contrast) + 0.5;","} else {","gl_FragColor.rgb = (gl_FragColor.rgb - 0.5) * (1.0 + contrast) + 0.5;","}","}"].join("\n")},ColorCorrectionShader={uniforms:{tDiffuse:{value:null},powRGB:{value:new Vector3(2,2,2)},mulRGB:{value:new Vector3(1,1,1)},addRGB:{value:new Vector3(0,0,0)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec3 powRGB;","uniform vec3 mulRGB;","uniform vec3 addRGB;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D( tDiffuse, vUv );","gl_FragColor.rgb = mulRGB * pow( ( gl_FragColor.rgb + addRGB ), powRGB );","}"].join("\n")},ColorifyShader={uniforms:{tDiffuse:{value:null},color:{value:new Color(16777215)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec3 luma = vec3( 0.299, 0.587, 0.114 );","float v = dot( texel.xyz, luma );","gl_FragColor = vec4( v * color, texel.w );","}"].join("\n")},DOFMipMapShader={uniforms:{tColor:{value:null},tDepth:{value:null},focus:{value:1},maxblur:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float focus;","uniform float maxblur;","uniform sampler2D tColor;","uniform sampler2D tDepth;","varying vec2 vUv;","void main() {","vec4 depth = texture2D( tDepth, vUv );","float factor = depth.x - focus;","vec4 col = texture2D( tColor, vUv, 2.0 * maxblur * abs( focus - depth.x ) );","gl_FragColor = col;","gl_FragColor.a = 1.0;","}"].join("\n")},FocusShader={uniforms:{tDiffuse:{value:null},screenWidth:{value:1024},screenHeight:{value:1024},sampleDistance:{value:.94},waveFactor:{value:.00125}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float screenWidth;","uniform float screenHeight;","uniform float sampleDistance;","uniform float waveFactor;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 color, org, tmp, add;","float sample_dist, f;","vec2 vin;","vec2 uv = vUv;","add = color = org = texture2D( tDiffuse, uv );","vin = ( uv - vec2( 0.5 ) ) * vec2( 1.4 );","sample_dist = dot( vin, vin ) * 2.0;","f = ( waveFactor * 100.0 + sample_dist ) * sampleDistance * 4.0;","vec2 sampleSize = vec2(  1.0 / screenWidth, 1.0 / screenHeight ) * vec2( f );","add += tmp = texture2D( tDiffuse, uv + vec2( 0.111964, 0.993712 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","add += tmp = texture2D( tDiffuse, uv + vec2( 0.846724, 0.532032 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","add += tmp = texture2D( tDiffuse, uv + vec2( 0.943883, -0.330279 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","add += tmp = texture2D( tDiffuse, uv + vec2( 0.330279, -0.943883 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","add += tmp = texture2D( tDiffuse, uv + vec2( -0.532032, -0.846724 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","add += tmp = texture2D( tDiffuse, uv + vec2( -0.993712, -0.111964 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","add += tmp = texture2D( tDiffuse, uv + vec2( -0.707107, 0.707107 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","color = color * vec4( 2.0 ) - ( add / vec4( 8.0 ) );","color = color + ( add / vec4( 8.0 ) - color ) * ( vec4( 1.0 ) - vec4( sample_dist * 0.5 ) );","gl_FragColor = vec4( color.rgb * color.rgb * vec3( 0.95 ) + color.rgb, 1.0 );","}"].join("\n")},FreiChenShader={uniforms:{tDiffuse:{value:null},aspect:{value:new Vector2(512,512)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","uniform vec2 aspect;","vec2 texel = vec2(1.0 / aspect.x, 1.0 / aspect.y);","mat3 G[9];","const mat3 g0 = mat3( 0.3535533845424652, 0, -0.3535533845424652, 0.5, 0, -0.5, 0.3535533845424652, 0, -0.3535533845424652 );","const mat3 g1 = mat3( 0.3535533845424652, 0.5, 0.3535533845424652, 0, 0, 0, -0.3535533845424652, -0.5, -0.3535533845424652 );","const mat3 g2 = mat3( 0, 0.3535533845424652, -0.5, -0.3535533845424652, 0, 0.3535533845424652, 0.5, -0.3535533845424652, 0 );","const mat3 g3 = mat3( 0.5, -0.3535533845424652, 0, -0.3535533845424652, 0, 0.3535533845424652, 0, 0.3535533845424652, -0.5 );","const mat3 g4 = mat3( 0, -0.5, 0, 0.5, 0, 0.5, 0, -0.5, 0 );","const mat3 g5 = mat3( -0.5, 0, 0.5, 0, 0, 0, 0.5, 0, -0.5 );","const mat3 g6 = mat3( 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.6666666865348816, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204 );","const mat3 g7 = mat3( -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, 0.6666666865348816, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408 );","const mat3 g8 = mat3( 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408 );","void main(void)","{","G[0] = g0,","G[1] = g1,","G[2] = g2,","G[3] = g3,","G[4] = g4,","G[5] = g5,","G[6] = g6,","G[7] = g7,","G[8] = g8;","mat3 I;","float cnv[9];","vec3 sample;","for (float i=0.0; i<3.0; i++) {","for (float j=0.0; j<3.0; j++) {","sample = texture2D(tDiffuse, vUv + texel * vec2(i-1.0,j-1.0) ).rgb;","I[int(i)][int(j)] = length(sample);","}","}","for (int i=0; i<9; i++) {","float dp3 = dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);","cnv[i] = dp3 * dp3;","}","float M = (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]);","float S = (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + (cnv[8] + M);","gl_FragColor = vec4(vec3(sqrt(M/S)), 1.0);","}"].join("\n")},FresnelShader={uniforms:{mRefractionRatio:{value:1.02},mFresnelBias:{value:.1},mFresnelPower:{value:2},mFresnelScale:{value:1},tCube:{value:null}},vertexShader:["uniform float mRefractionRatio;","uniform float mFresnelBias;","uniform float mFresnelScale;","uniform float mFresnelPower;","varying vec3 vReflect;","varying vec3 vRefract[3];","varying float vReflectionFactor;","void main() {","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vec3 worldNormal = normalize( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal );","vec3 I = worldPosition.xyz - cameraPosition;","vReflect = reflect( I, worldNormal );","vRefract[0] = refract( normalize( I ), worldNormal, mRefractionRatio );","vRefract[1] = refract( normalize( I ), worldNormal, mRefractionRatio * 0.99 );","vRefract[2] = refract( normalize( I ), worldNormal, mRefractionRatio * 0.98 );","vReflectionFactor = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( I ), worldNormal ), mFresnelPower );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform samplerCube tCube;","varying vec3 vReflect;","varying vec3 vRefract[3];","varying float vReflectionFactor;","void main() {","vec4 reflectedColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );","vec4 refractedColor = vec4( 1.0 );","refractedColor.r = textureCube( tCube, vec3( -vRefract[0].x, vRefract[0].yz ) ).r;","refractedColor.g = textureCube( tCube, vec3( -vRefract[1].x, vRefract[1].yz ) ).g;","refractedColor.b = textureCube( tCube, vec3( -vRefract[2].x, vRefract[2].yz ) ).b;","gl_FragColor = mix( refractedColor, reflectedColor, clamp( vReflectionFactor, 0.0, 1.0 ) );","}"].join("\n")},GammaCorrectionShader={uniforms:{tDiffuse:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 tex = texture2D( tDiffuse, vec2( vUv.x, vUv.y ) );","gl_FragColor = LinearToGamma( tex, float( GAMMA_FACTOR ) );","}"].join("\n")},HorizontalBlurShader={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float h;","varying vec2 vUv;","void main() {","vec4 sum = vec4( 0.0 );","sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;","sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;","gl_FragColor = sum;","}"].join("\n")},HorizontalTiltShiftShader={uniforms:{tDiffuse:{value:null},h:{value:1/512},r:{value:.35}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float h;","uniform float r;","varying vec2 vUv;","void main() {","vec4 sum = vec4( 0.0 );","float hh = h * abs( r - vUv.y );","sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * hh, vUv.y ) ) * 0.051;","sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * hh, vUv.y ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * hh, vUv.y ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * hh, vUv.y ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * hh, vUv.y ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * hh, vUv.y ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * hh, vUv.y ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * hh, vUv.y ) ) * 0.051;","gl_FragColor = sum;","}"].join("\n")},HueSaturationShader={uniforms:{tDiffuse:{value:null},hue:{value:0},saturation:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float hue;","uniform float saturation;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D( tDiffuse, vUv );","float angle = hue * 3.14159265;","float s = sin(angle), c = cos(angle);","vec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;","float len = length(gl_FragColor.rgb);","gl_FragColor.rgb = vec3(","dot(gl_FragColor.rgb, weights.xyz),","dot(gl_FragColor.rgb, weights.zxy),","dot(gl_FragColor.rgb, weights.yzx)",");","float average = (gl_FragColor.r + gl_FragColor.g + gl_FragColor.b) / 3.0;","if (saturation > 0.0) {","gl_FragColor.rgb += (average - gl_FragColor.rgb) * (1.0 - 1.0 / (1.001 - saturation));","} else {","gl_FragColor.rgb += (average - gl_FragColor.rgb) * (-saturation);","}","}"].join("\n")},KaleidoShader={uniforms:{tDiffuse:{value:null},sides:{value:6},angle:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float sides;","uniform float angle;","varying vec2 vUv;","void main() {","vec2 p = vUv - 0.5;","float r = length(p);","float a = atan(p.y, p.x) + angle;","float tau = 2. * 3.1416 ;","a = mod(a, tau/sides);","a = abs(a - tau/sides/2.) ;","p = r * vec2(cos(a), sin(a));","vec4 color = texture2D(tDiffuse, p + 0.5);","gl_FragColor = color;","}"].join("\n")},MirrorShader={uniforms:{tDiffuse:{value:null},side:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform int side;","varying vec2 vUv;","void main() {","vec2 p = vUv;","if (side == 0){","if (p.x > 0.5) p.x = 1.0 - p.x;","}else if (side == 1){","if (p.x < 0.5) p.x = 1.0 - p.x;","}else if (side == 2){","if (p.y < 0.5) p.y = 1.0 - p.y;","}else if (side == 3){","if (p.y > 0.5) p.y = 1.0 - p.y;","} ","vec4 color = texture2D(tDiffuse, p);","gl_FragColor = color;","}"].join("\n")},NormalMapShader={uniforms:{heightMap:{value:null},resolution:{value:new Vector2(512,512)},scale:{value:new Vector2(1,1)},height:{value:.05}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float height;","uniform vec2 resolution;","uniform sampler2D heightMap;","varying vec2 vUv;","void main() {","float val = texture2D( heightMap, vUv ).x;","float valU = texture2D( heightMap, vUv + vec2( 1.0 / resolution.x, 0.0 ) ).x;","float valV = texture2D( heightMap, vUv + vec2( 0.0, 1.0 / resolution.y ) ).x;","gl_FragColor = vec4( ( 0.5 * normalize( vec3( val - valU, val - valV, height  ) ) + 0.5 ), 1.0 );","}"].join("\n")},ParallaxShader={modes:{none:"NO_PARALLAX",basic:"USE_BASIC_PARALLAX",steep:"USE_STEEP_PARALLAX",occlusion:"USE_OCLUSION_PARALLAX",relief:"USE_RELIEF_PARALLAX"},uniforms:{bumpMap:{value:null},map:{value:null},parallaxScale:{value:null},parallaxMinLayers:{value:null},parallaxMaxLayers:{value:null}},vertexShader:["varying vec2 vUv;","varying vec3 vViewPosition;","varying vec3 vNormal;","void main() {","vUv = uv;","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","vViewPosition = -mvPosition.xyz;","vNormal = normalize( normalMatrix * normal );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform sampler2D bumpMap;","uniform sampler2D map;","uniform float parallaxScale;","uniform float parallaxMinLayers;","uniform float parallaxMaxLayers;","varying vec2 vUv;","varying vec3 vViewPosition;","varying vec3 vNormal;","#ifdef USE_BASIC_PARALLAX","vec2 parallaxMap( in vec3 V ) {","float initialHeight = texture2D( bumpMap, vUv ).r;","vec2 texCoordOffset = parallaxScale * V.xy * initialHeight;","return vUv - texCoordOffset;","}","#else","vec2 parallaxMap( in vec3 V ) {","float numLayers = mix( parallaxMaxLayers, parallaxMinLayers, abs( dot( vec3( 0.0, 0.0, 1.0 ), V ) ) );","float layerHeight = 1.0 / numLayers;","float currentLayerHeight = 0.0;","vec2 dtex = parallaxScale * V.xy / V.z / numLayers;","vec2 currentTextureCoords = vUv;","float heightFromTexture = texture2D( bumpMap, currentTextureCoords ).r;","for ( int i = 0; i < 30; i += 1 ) {","if ( heightFromTexture <= currentLayerHeight ) {","break;","}","currentLayerHeight += layerHeight;","currentTextureCoords -= dtex;","heightFromTexture = texture2D( bumpMap, currentTextureCoords ).r;","}","#ifdef USE_STEEP_PARALLAX","return currentTextureCoords;","#elif defined( USE_RELIEF_PARALLAX )","vec2 deltaTexCoord = dtex / 2.0;","float deltaHeight = layerHeight / 2.0;","currentTextureCoords += deltaTexCoord;","currentLayerHeight -= deltaHeight;","const int numSearches = 5;","for ( int i = 0; i < numSearches; i += 1 ) {","deltaTexCoord /= 2.0;","deltaHeight /= 2.0;","heightFromTexture = texture2D( bumpMap, currentTextureCoords ).r;","if( heightFromTexture > currentLayerHeight ) {","currentTextureCoords -= deltaTexCoord;","currentLayerHeight += deltaHeight;","} else {","currentTextureCoords += deltaTexCoord;","currentLayerHeight -= deltaHeight;","}","}","return currentTextureCoords;","#elif defined( USE_OCLUSION_PARALLAX )","vec2 prevTCoords = currentTextureCoords + dtex;","float nextH = heightFromTexture - currentLayerHeight;","float prevH = texture2D( bumpMap, prevTCoords ).r - currentLayerHeight + layerHeight;","float weight = nextH / ( nextH - prevH );","return prevTCoords * weight + currentTextureCoords * ( 1.0 - weight );","#else","return vUv;","#endif","}","#endif","vec2 perturbUv( vec3 surfPosition, vec3 surfNormal, vec3 viewPosition ) {","vec2 texDx = dFdx( vUv );","vec2 texDy = dFdy( vUv );","vec3 vSigmaX = dFdx( surfPosition );","vec3 vSigmaY = dFdy( surfPosition );","vec3 vR1 = cross( vSigmaY, surfNormal );","vec3 vR2 = cross( surfNormal, vSigmaX );","float fDet = dot( vSigmaX, vR1 );","vec2 vProjVscr = ( 1.0 / fDet ) * vec2( dot( vR1, viewPosition ), dot( vR2, viewPosition ) );","vec3 vProjVtex;","vProjVtex.xy = texDx * vProjVscr.x + texDy * vProjVscr.y;","vProjVtex.z = dot( surfNormal, viewPosition );","return parallaxMap( vProjVtex );","}","void main() {","vec2 mapUv = perturbUv( -vViewPosition, normalize( vNormal ), normalize( vViewPosition ) );","gl_FragColor = texture2D( map, mapUv );","}"].join("\n")},PixelShader={uniforms:{tDiffuse:{value:null},resolution:{value:null},pixelSize:{value:1}},vertexShader:["varying highp vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float pixelSize;","uniform vec2 resolution;","varying highp vec2 vUv;","void main(){","vec2 dxy = pixelSize / resolution;","vec2 coord = dxy * floor( vUv / dxy );","gl_FragColor = texture2D(tDiffuse, coord);","}"].join("\n")},RGBShiftShader={uniforms:{tDiffuse:{value:null},amount:{value:.005},angle:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float amount;","uniform float angle;","varying vec2 vUv;","void main() {","vec2 offset = amount * vec2( cos(angle), sin(angle));","vec4 cr = texture2D(tDiffuse, vUv + offset);","vec4 cga = texture2D(tDiffuse, vUv);","vec4 cb = texture2D(tDiffuse, vUv - offset);","gl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);","}"].join("\n")},SepiaShader={uniforms:{tDiffuse:{value:null},amount:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float amount;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 color = texture2D( tDiffuse, vUv );","vec3 c = color.rgb;","color.r = dot( c, vec3( 1.0 - 0.607 * amount, 0.769 * amount, 0.189 * amount ) );","color.g = dot( c, vec3( 0.349 * amount, 1.0 - 0.314 * amount, 0.168 * amount ) );","color.b = dot( c, vec3( 0.272 * amount, 0.534 * amount, 1.0 - 0.869 * amount ) );","gl_FragColor = vec4( min( vec3( 1.0 ), color.rgb ), color.a );","}"].join("\n")},SobelOperatorShader={uniforms:{tDiffuse:{value:null},resolution:{value:new Vector2}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec2 resolution;","varying vec2 vUv;","void main() {","vec2 texel = vec2( 1.0 / resolution.x, 1.0 / resolution.y );","const mat3 Gx = mat3( -1, -2, -1, 0, 0, 0, 1, 2, 1 );","const mat3 Gy = mat3( -1, 0, 1, -2, 0, 2, -1, 0, 1 );","float tx0y0 = texture2D( tDiffuse, vUv + texel * vec2( -1, -1 ) ).r;","float tx0y1 = texture2D( tDiffuse, vUv + texel * vec2( -1,  0 ) ).r;","float tx0y2 = texture2D( tDiffuse, vUv + texel * vec2( -1,  1 ) ).r;","float tx1y0 = texture2D( tDiffuse, vUv + texel * vec2(  0, -1 ) ).r;","float tx1y1 = texture2D( tDiffuse, vUv + texel * vec2(  0,  0 ) ).r;","float tx1y2 = texture2D( tDiffuse, vUv + texel * vec2(  0,  1 ) ).r;","float tx2y0 = texture2D( tDiffuse, vUv + texel * vec2(  1, -1 ) ).r;","float tx2y1 = texture2D( tDiffuse, vUv + texel * vec2(  1,  0 ) ).r;","float tx2y2 = texture2D( tDiffuse, vUv + texel * vec2(  1,  1 ) ).r;","float valueGx = Gx[0][0] * tx0y0 + Gx[1][0] * tx1y0 + Gx[2][0] * tx2y0 + ","Gx[0][1] * tx0y1 + Gx[1][1] * tx1y1 + Gx[2][1] * tx2y1 + ","Gx[0][2] * tx0y2 + Gx[1][2] * tx1y2 + Gx[2][2] * tx2y2; ","float valueGy = Gy[0][0] * tx0y0 + Gy[1][0] * tx1y0 + Gy[2][0] * tx2y0 + ","Gy[0][1] * tx0y1 + Gy[1][1] * tx1y1 + Gy[2][1] * tx2y1 + ","Gy[0][2] * tx0y2 + Gy[1][2] * tx1y2 + Gy[2][2] * tx2y2; ","float G = sqrt( ( valueGx * valueGx ) + ( valueGy * valueGy ) );","gl_FragColor = vec4( vec3( G ), 1 );","}"].join("\n")},TechnicolorShader={uniforms:{tDiffuse:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 tex = texture2D( tDiffuse, vec2( vUv.x, vUv.y ) );","vec4 newTex = vec4(tex.r, (tex.g + tex.b) * .5, (tex.g + tex.b) * .5, 1.0);","gl_FragColor = newTex;","}"].join("\n")},TriangleBlurShader={uniforms:{texture:{value:null},delta:{value:new Vector2(1,1)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","#define ITERATIONS 10.0","uniform sampler2D texture;","uniform vec2 delta;","varying vec2 vUv;","void main() {","vec4 color = vec4( 0.0 );","float total = 0.0;","float offset = rand( vUv );","for ( float t = -ITERATIONS; t <= ITERATIONS; t ++ ) {","float percent = ( t + offset - 0.5 ) / ITERATIONS;","float weight = 1.0 - abs( percent );","color += texture2D( texture, vUv + delta * percent ) * weight;","total += weight;","}","gl_FragColor = color / total;","}"].join("\n")},VerticalBlurShader={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float v;","varying vec2 vUv;","void main() {","vec4 sum = vec4( 0.0 );","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;","gl_FragColor = sum;","}"].join("\n")},VerticalTiltShiftShader={uniforms:{tDiffuse:{value:null},v:{value:1/512},r:{value:.35}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float v;","uniform float r;","varying vec2 vUv;","void main() {","vec4 sum = vec4( 0.0 );","float vv = v * abs( r - vUv.y );","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * vv ) ) * 0.051;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * vv ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * vv ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * vv ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * vv ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * vv ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * vv ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * vv ) ) * 0.051;","gl_FragColor = sum;","}"].join("\n")},VignetteShader={uniforms:{tDiffuse:{value:null},offset:{value:1},darkness:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float offset;","uniform float darkness;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec2 uv = ( vUv - vec2( 0.5 ) ) * vec2( offset );","gl_FragColor = vec4( mix( texel.rgb, vec3( 1.0 - darkness ), dot( uv, uv ) ), texel.a );","}"].join("\n")},VolumeRenderShader1={uniforms:{u_size:{value:new Vector3(1,1,1)},u_renderstyle:{value:0},u_renderthreshold:{value:.5},u_clim:{value:new Vector2(1,1)},u_data:{value:null},u_cmdata:{value:null}},vertexShader:["varying vec4 v_nearpos;","varying vec4 v_farpos;","varying vec3 v_position;","mat4 inversemat(mat4 m) {","float","a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],","a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],","a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],","a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],","b00 = a00 * a11 - a01 * a10,","b01 = a00 * a12 - a02 * a10,","b02 = a00 * a13 - a03 * a10,","b03 = a01 * a12 - a02 * a11,","b04 = a01 * a13 - a03 * a11,","b05 = a02 * a13 - a03 * a12,","b06 = a20 * a31 - a21 * a30,","b07 = a20 * a32 - a22 * a30,","b08 = a20 * a33 - a23 * a30,","b09 = a21 * a32 - a22 * a31,","b10 = a21 * a33 - a23 * a31,","b11 = a22 * a33 - a23 * a32,","det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;","return mat4(","a11 * b11 - a12 * b10 + a13 * b09,","a02 * b10 - a01 * b11 - a03 * b09,","a31 * b05 - a32 * b04 + a33 * b03,","a22 * b04 - a21 * b05 - a23 * b03,","a12 * b08 - a10 * b11 - a13 * b07,","a00 * b11 - a02 * b08 + a03 * b07,","a32 * b02 - a30 * b05 - a33 * b01,","a20 * b05 - a22 * b02 + a23 * b01,","a10 * b10 - a11 * b08 + a13 * b06,","a01 * b08 - a00 * b10 - a03 * b06,","a30 * b04 - a31 * b02 + a33 * b00,","a21 * b02 - a20 * b04 - a23 * b00,","a11 * b07 - a10 * b09 - a12 * b06,","a00 * b09 - a01 * b07 + a02 * b06,","a31 * b01 - a30 * b03 - a32 * b00,","a20 * b03 - a21 * b01 + a22 * b00) / det;","}","void main() {","mat4 viewtransformf = viewMatrix;","mat4 viewtransformi = inversemat(viewMatrix);","vec4 position4 = vec4(position, 1.0);","vec4 pos_in_cam = viewtransformf * position4;","pos_in_cam.z = -pos_in_cam.w;","v_nearpos = viewtransformi * pos_in_cam;","pos_in_cam.z = pos_in_cam.w;","v_farpos = viewtransformi * pos_in_cam;","v_position = position;","gl_Position = projectionMatrix * viewMatrix * modelMatrix * position4;","}"].join("\n"),fragmentShader:["precision highp float;","precision mediump sampler3D;","uniform vec3 u_size;","uniform int u_renderstyle;","uniform float u_renderthreshold;","uniform vec2 u_clim;","uniform sampler3D u_data;","uniform sampler2D u_cmdata;","varying vec3 v_position;","varying vec4 v_nearpos;","varying vec4 v_farpos;","const int MAX_STEPS = 887;  // 887 for 512^3, 1774 for 1024^3","const int REFINEMENT_STEPS = 4;","const float relative_step_size = 1.0;","const vec4 ambient_color = vec4(0.2, 0.4, 0.2, 1.0);","const vec4 diffuse_color = vec4(0.8, 0.2, 0.2, 1.0);","const vec4 specular_color = vec4(1.0, 1.0, 1.0, 1.0);","const float shininess = 40.0;","void cast_mip(vec3 start_loc, vec3 step, int nsteps, vec3 view_ray);","void cast_iso(vec3 start_loc, vec3 step, int nsteps, vec3 view_ray);","float sample1(vec3 texcoords);","vec4 apply_colormap(float val);","vec4 add_lighting(float val, vec3 loc, vec3 step, vec3 view_ray);","void main() {","vec3 farpos = v_farpos.xyz / v_farpos.w;","vec3 nearpos = v_nearpos.xyz / v_nearpos.w;","vec3 view_ray = normalize(nearpos.xyz - farpos.xyz);","float distance = dot(nearpos - v_position, view_ray);","distance = max(distance, min((-0.5 - v_position.x) / view_ray.x,","(u_size.x - 0.5 - v_position.x) / view_ray.x));","distance = max(distance, min((-0.5 - v_position.y) / view_ray.y,","(u_size.y - 0.5 - v_position.y) / view_ray.y));","distance = max(distance, min((-0.5 - v_position.z) / view_ray.z,","(u_size.z - 0.5 - v_position.z) / view_ray.z));","vec3 front = v_position + view_ray * distance;","int nsteps = int(-distance / relative_step_size + 0.5);","if ( nsteps < 1 )","discard;","vec3 step = ((v_position - front) / u_size) / float(nsteps);","vec3 start_loc = front / u_size;","if (u_renderstyle == 0)","cast_mip(start_loc, step, nsteps, view_ray);","else if (u_renderstyle == 1)","cast_iso(start_loc, step, nsteps, view_ray);","if (gl_FragColor.a < 0.05)","discard;","}","float sample1(vec3 texcoords) {","","return texture(u_data, texcoords.xyz).r;","}","vec4 apply_colormap(float val) {","val = (val - u_clim[0]) / (u_clim[1] - u_clim[0]);","return texture2D(u_cmdata, vec2(val, 0.5));","}","void cast_mip(vec3 start_loc, vec3 step, int nsteps, vec3 view_ray) {","float max_val = -1e6;","int max_i = 100;","vec3 loc = start_loc;","for (int iter=0; iter<MAX_STEPS; iter++) {","if (iter >= nsteps)","break;","float val = sample1(loc);","if (val > max_val) {","max_val = val;","max_i = iter;","}","loc += step;","}","vec3 iloc = start_loc + step * (float(max_i) - 0.5);","vec3 istep = step / float(REFINEMENT_STEPS);","for (int i=0; i<REFINEMENT_STEPS; i++) {","max_val = max(max_val, sample1(iloc));","iloc += istep;","}","gl_FragColor = apply_colormap(max_val);","}","void cast_iso(vec3 start_loc, vec3 step, int nsteps, vec3 view_ray) {","gl_FragColor = vec4(0.0);  // init transparent","vec4 color3 = vec4(0.0);  // final color","vec3 dstep = 1.5 / u_size;  // step to sample derivative","vec3 loc = start_loc;","float low_threshold = u_renderthreshold - 0.02 * (u_clim[1] - u_clim[0]);","for (int iter=0; iter<MAX_STEPS; iter++) {","if (iter >= nsteps)","break;","float val = sample1(loc);","if (val > low_threshold) {","vec3 iloc = loc - 0.5 * step;","vec3 istep = step / float(REFINEMENT_STEPS);","for (int i=0; i<REFINEMENT_STEPS; i++) {","val = sample1(iloc);","if (val > u_renderthreshold) {","gl_FragColor = add_lighting(val, iloc, dstep, view_ray);","return;","}","iloc += istep;","}","}","loc += step;","}","}","vec4 add_lighting(float val, vec3 loc, vec3 step, vec3 view_ray)","{","vec3 V = normalize(view_ray);","vec3 N;","float val1, val2;","val1 = sample1(loc + vec3(-step[0], 0.0, 0.0));","val2 = sample1(loc + vec3(+step[0], 0.0, 0.0));","N[0] = val1 - val2;","val = max(max(val1, val2), val);","val1 = sample1(loc + vec3(0.0, -step[1], 0.0));","val2 = sample1(loc + vec3(0.0, +step[1], 0.0));","N[1] = val1 - val2;","val = max(max(val1, val2), val);","val1 = sample1(loc + vec3(0.0, 0.0, -step[2]));","val2 = sample1(loc + vec3(0.0, 0.0, +step[2]));","N[2] = val1 - val2;","val = max(max(val1, val2), val);","float gm = length(N); // gradient magnitude","N = normalize(N);","float Nselect = float(dot(N, V) > 0.0);","N = (2.0 * Nselect - 1.0) * N;  // ==  Nselect * N - (1.0-Nselect)*N;","vec4 ambient_color = vec4(0.0, 0.0, 0.0, 0.0);","vec4 diffuse_color = vec4(0.0, 0.0, 0.0, 0.0);","vec4 specular_color = vec4(0.0, 0.0, 0.0, 0.0);","for (int i=0; i<1; i++)","{","vec3 L = normalize(view_ray);  //lightDirs[i];","float lightEnabled = float( length(L) > 0.0 );","L = normalize(L + (1.0 - lightEnabled));","float lambertTerm = clamp(dot(N, L), 0.0, 1.0);","vec3 H = normalize(L+V); // Halfway vector","float specularTerm = pow(max(dot(H, N), 0.0), shininess);","float mask1 = lightEnabled;","ambient_color +=  mask1 * ambient_color;  // * gl_LightSource[i].ambient;","diffuse_color +=  mask1 * lambertTerm;","specular_color += mask1 * specularTerm * specular_color;","}","vec4 final_color;","vec4 color = apply_colormap(val);","final_color = color * (ambient_color + diffuse_color) + specular_color;","final_color.a = color.a;","return final_color;","}"].join("\n")},WaterRefractionShader={uniforms:{color:{type:"c",value:null},time:{type:"f",value:0},tDiffuse:{type:"t",value:null},tDudv:{type:"t",value:null},textureMatrix:{type:"m4",value:null}},vertexShader:["uniform mat4 textureMatrix;","varying vec2 vUv;","varying vec4 vUvRefraction;","void main() {","\tvUv = uv;","\tvUvRefraction = textureMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform float time;","uniform sampler2D tDiffuse;","uniform sampler2D tDudv;","varying vec2 vUv;","varying vec4 vUvRefraction;","float blendOverlay( float base, float blend ) {","\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ),blendOverlay( base.b, blend.b ) );","}","void main() {"," float waveStrength = 0.1;"," float waveSpeed = 0.03;","\tvec2 distortedUv = texture2D( tDudv, vec2( vUv.x + time * waveSpeed, vUv.y ) ).rg * waveStrength;","\tdistortedUv = vUv.xy + vec2( distortedUv.x, distortedUv.y + time * waveSpeed );","\tvec2 distortion = ( texture2D( tDudv, distortedUv ).rg * 2.0 - 1.0 ) * waveStrength;"," vec4 uv = vec4( vUvRefraction );"," uv.xy += distortion;","\tvec4 base = texture2DProj( tDiffuse, uv );","\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")},ShaderSkin={skinSimple:{uniforms:UniformsUtils.merge([UniformsLib.fog,UniformsLib.lights,{enableBump:{value:0},enableSpecular:{value:0},tDiffuse:{value:null},tBeckmann:{value:null},diffuse:{value:new Color(15658734)},specular:{value:new Color(1118481)},opacity:{value:1},uRoughness:{value:.15},uSpecularBrightness:{value:.75},bumpMap:{value:null},bumpScale:{value:1},specularMap:{value:null},offsetRepeat:{value:new Vector4(0,0,1,1)},uWrapRGB:{value:new Vector3(.75,.375,.1875)}}]),fragmentShader:["#define USE_BUMPMAP","uniform bool enableBump;","uniform bool enableSpecular;","uniform vec3 diffuse;","uniform vec3 specular;","uniform float opacity;","uniform float uRoughness;","uniform float uSpecularBrightness;","uniform vec3 uWrapRGB;","uniform sampler2D tDiffuse;","uniform sampler2D tBeckmann;","uniform sampler2D specularMap;","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vViewPosition;",ShaderChunk.common,ShaderChunk.bsdfs,ShaderChunk.packing,ShaderChunk.lights_pars_begin,ShaderChunk.fog_pars_fragment,ShaderChunk.bumpmap_pars_fragment,"float fresnelReflectance( vec3 H, vec3 V, float F0 ) {","float base = 1.0 - dot( V, H );","float exponential = pow( base, 5.0 );","return exponential + F0 * ( 1.0 - exponential );","}","float KS_Skin_Specular( vec3 N,","vec3 L,","vec3 V,","float m,","float rho_s",") {","float result = 0.0;","float ndotl = dot( N, L );","if( ndotl > 0.0 ) {","vec3 h = L + V;","vec3 H = normalize( h );","float ndoth = dot( N, H );","float PH = pow( 2.0 * texture2D( tBeckmann, vec2( ndoth, m ) ).x, 10.0 );","float F = fresnelReflectance( H, V, 0.028 );","float frSpec = max( PH * F / dot( h, h ), 0.0 );","result = ndotl * rho_s * frSpec;","}","return result;","}","void main() {","vec3 outgoingLight = vec3( 0.0 );","vec4 diffuseColor = vec4( diffuse, opacity );","vec4 colDiffuse = texture2D( tDiffuse, vUv );","colDiffuse.rgb *= colDiffuse.rgb;","diffuseColor = diffuseColor * colDiffuse;","vec3 normal = normalize( vNormal );","vec3 viewerDirection = normalize( vViewPosition );","float specularStrength;","if ( enableSpecular ) {","vec4 texelSpecular = texture2D( specularMap, vUv );","specularStrength = texelSpecular.r;","} else {","specularStrength = 1.0;","}","#ifdef USE_BUMPMAP","if ( enableBump ) normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );","#endif","vec3 totalSpecularLight = vec3( 0.0 );","vec3 totalDiffuseLight = vec3( 0.0 );","#if NUM_POINT_LIGHTS > 0","for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {","vec3 lVector = pointLights[ i ].position + vViewPosition.xyz;","float attenuation = calcLightAttenuation( length( lVector ), pointLights[ i ].distance, pointLights[ i ].decay );","lVector = normalize( lVector );","float pointDiffuseWeightFull = max( dot( normal, lVector ), 0.0 );","float pointDiffuseWeightHalf = max( 0.5 * dot( normal, lVector ) + 0.5, 0.0 );","vec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), uWrapRGB );","float pointSpecularWeight = KS_Skin_Specular( normal, lVector, viewerDirection, uRoughness, uSpecularBrightness );","totalDiffuseLight += pointLight[ i ].color * ( pointDiffuseWeight * attenuation );","totalSpecularLight += pointLight[ i ].color * specular * ( pointSpecularWeight * specularStrength * attenuation );","}","#endif","#if NUM_DIR_LIGHTS > 0","for( int i = 0; i < NUM_DIR_LIGHTS; i++ ) {","vec3 dirVector = directionalLights[ i ].direction;","float dirDiffuseWeightFull = max( dot( normal, dirVector ), 0.0 );","float dirDiffuseWeightHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );","vec3 dirDiffuseWeight = mix( vec3 ( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), uWrapRGB );","float dirSpecularWeight = KS_Skin_Specular( normal, dirVector, viewerDirection, uRoughness, uSpecularBrightness );","totalDiffuseLight += directionalLights[ i ].color * dirDiffuseWeight;","totalSpecularLight += directionalLights[ i ].color * ( dirSpecularWeight * specularStrength );","}","#endif","#if NUM_HEMI_LIGHTS > 0","for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {","vec3 lVector = hemisphereLightDirection[ i ];","float dotProduct = dot( normal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","totalDiffuseLight += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","float hemiSpecularWeight = 0.0;","hemiSpecularWeight += KS_Skin_Specular( normal, lVector, viewerDirection, uRoughness, uSpecularBrightness );","vec3 lVectorGround = -lVector;","hemiSpecularWeight += KS_Skin_Specular( normal, lVectorGround, viewerDirection, uRoughness, uSpecularBrightness );","vec3 hemiSpecularColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","totalSpecularLight += hemiSpecularColor * specular * ( hemiSpecularWeight * specularStrength );","}","#endif","outgoingLight += diffuseColor.xyz * ( totalDiffuseLight + ambientLightColor * diffuse ) + totalSpecularLight;","gl_FragColor = linearToOutputTexel( vec4( outgoingLight, diffuseColor.a ) );",ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:["uniform vec4 offsetRepeat;","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vViewPosition;",ShaderChunk.common,ShaderChunk.lights_pars_begin,ShaderChunk.fog_pars_vertex,"void main() {","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vViewPosition = -mvPosition.xyz;","vNormal = normalize( normalMatrix * normal );","vUv = uv * offsetRepeat.zw + offsetRepeat.xy;","gl_Position = projectionMatrix * mvPosition;",ShaderChunk.fog_vertex,"}"].join("\n")},skin:{uniforms:UniformsUtils.merge([UniformsLib.fog,UniformsLib.lights,{passID:{value:0},tDiffuse:{value:null},tNormal:{value:null},tBlur1:{value:null},tBlur2:{value:null},tBlur3:{value:null},tBlur4:{value:null},tBeckmann:{value:null},uNormalScale:{value:1},diffuse:{value:new Color(15658734)},specular:{value:new Color(1118481)},opacity:{value:1},uRoughness:{value:.15},uSpecularBrightness:{value:.75}}]),fragmentShader:["uniform vec3 diffuse;","uniform vec3 specular;","uniform float opacity;","uniform float uRoughness;","uniform float uSpecularBrightness;","uniform int passID;","uniform sampler2D tDiffuse;","uniform sampler2D tNormal;","uniform sampler2D tBlur1;","uniform sampler2D tBlur2;","uniform sampler2D tBlur3;","uniform sampler2D tBlur4;","uniform sampler2D tBeckmann;","uniform float uNormalScale;","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vViewPosition;",ShaderChunk.common,ShaderChunk.lights_pars_begin,ShaderChunk.fog_pars_fragment,"float fresnelReflectance( vec3 H, vec3 V, float F0 ) {","float base = 1.0 - dot( V, H );","float exponential = pow( base, 5.0 );","return exponential + F0 * ( 1.0 - exponential );","}","float KS_Skin_Specular( vec3 N,","vec3 L,","vec3 V,","float m,","float rho_s",") {","float result = 0.0;","float ndotl = dot( N, L );","if( ndotl > 0.0 ) {","vec3 h = L + V;","vec3 H = normalize( h );","float ndoth = dot( N, H );","float PH = pow( 2.0 * texture2D( tBeckmann, vec2( ndoth, m ) ).x, 10.0 );","float F = fresnelReflectance( H, V, 0.028 );","float frSpec = max( PH * F / dot( h, h ), 0.0 );","result = ndotl * rho_s * frSpec;","}","return result;","}","void main() {","vec3 outgoingLight = vec3( 0.0 );","vec4 diffuseColor = vec4( diffuse, opacity );","vec4 mSpecular = vec4( specular, opacity );","vec4 colDiffuse = texture2D( tDiffuse, vUv );","colDiffuse *= colDiffuse;","diffuseColor *= colDiffuse;","vec4 posAndU = vec4( -vViewPosition, vUv.x );","vec4 posAndU_dx = dFdx( posAndU ),  posAndU_dy = dFdy( posAndU );","vec3 tangent = posAndU_dx.w * posAndU_dx.xyz + posAndU_dy.w * posAndU_dy.xyz;","vec3 normal = normalize( vNormal );","vec3 binormal = normalize( cross( tangent, normal ) );","tangent = cross( normal, binormal );","mat3 tsb = mat3( tangent, binormal, normal );","vec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;","normalTex.xy *= uNormalScale;","normalTex = normalize( normalTex );","vec3 finalNormal = tsb * normalTex;","normal = normalize( finalNormal );","vec3 viewerDirection = normalize( vViewPosition );","vec3 totalDiffuseLight = vec3( 0.0 );","vec3 totalSpecularLight = vec3( 0.0 );","#if NUM_POINT_LIGHTS > 0","for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {","vec3 pointVector = normalize( pointLights[ i ].direction );","float attenuation = calcLightAttenuation( length( lVector ), pointLights[ i ].distance, pointLights[ i ].decay );","float pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );","totalDiffuseLight += pointLightColor[ i ] * ( pointDiffuseWeight * attenuation );","if ( passID == 1 ) {","float pointSpecularWeight = KS_Skin_Specular( normal, pointVector, viewerDirection, uRoughness, uSpecularBrightness );","totalSpecularLight += pointLightColor[ i ] * mSpecular.xyz * ( pointSpecularWeight * attenuation );","}","}","#endif","#if NUM_DIR_LIGHTS > 0","for( int i = 0; i < NUM_DIR_LIGHTS; i++ ) {","vec3 dirVector = directionalLights[ i ].direction;","float dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );","totalDiffuseLight += directionalLights[ i ].color * dirDiffuseWeight;","if ( passID == 1 ) {","float dirSpecularWeight = KS_Skin_Specular( normal, dirVector, viewerDirection, uRoughness, uSpecularBrightness );","totalSpecularLight += directionalLights[ i ].color * mSpecular.xyz * dirSpecularWeight;","}","}","#endif","outgoingLight += diffuseColor.rgb * ( totalDiffuseLight + totalSpecularLight );","if ( passID == 0 ) {","outgoingLight = sqrt( outgoingLight );","} else if ( passID == 1 ) {","#ifdef VERSION1","vec3 nonblurColor = sqrt(outgoingLight );","#else","vec3 nonblurColor = outgoingLight;","#endif","vec3 blur1Color = texture2D( tBlur1, vUv ).xyz;","vec3 blur2Color = texture2D( tBlur2, vUv ).xyz;","vec3 blur3Color = texture2D( tBlur3, vUv ).xyz;","vec3 blur4Color = texture2D( tBlur4, vUv ).xyz;","outgoingLight = vec3( vec3( 0.22,  0.437, 0.635 ) * nonblurColor + ","vec3( 0.101, 0.355, 0.365 ) * blur1Color + ","vec3( 0.119, 0.208, 0.0 )   * blur2Color + ","vec3( 0.114, 0.0,   0.0 )   * blur3Color + ","vec3( 0.444, 0.0,   0.0 )   * blur4Color );","outgoingLight *= sqrt( colDiffuse.xyz );","outgoingLight += ambientLightColor * diffuse * colDiffuse.xyz + totalSpecularLight;","#ifndef VERSION1","outgoingLight = sqrt( outgoingLight );","#endif","}","gl_FragColor = vec4( outgoingLight, diffuseColor.a );",ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:["#ifdef VERTEX_TEXTURES","uniform sampler2D tDisplacement;","uniform float uDisplacementScale;","uniform float uDisplacementBias;","#endif","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vViewPosition;",ShaderChunk.common,ShaderChunk.fog_pars_vertex,"void main() {","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","vViewPosition = -mvPosition.xyz;","vNormal = normalize( normalMatrix * normal );","vUv = uv;","#ifdef VERTEX_TEXTURES","vec3 dv = texture2D( tDisplacement, uv ).xyz;","float df = uDisplacementScale * dv.x + uDisplacementBias;","vec4 displacedPosition = vec4( vNormal.xyz * df, 0.0 ) + mvPosition;","gl_Position = projectionMatrix * displacedPosition;","#else","gl_Position = projectionMatrix * mvPosition;","#endif",ShaderChunk.fog_vertex,"}"].join("\n"),vertexShaderUV:["varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vViewPosition;",ShaderChunk.common,"void main() {","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","vViewPosition = -mvPosition.xyz;","vNormal = normalize( normalMatrix * normal );","vUv = uv;","gl_Position = vec4( uv.x * 2.0 - 1.0, uv.y * 2.0 - 1.0, 0.0, 1.0 );","}"].join("\n")},beckmann:{uniforms:{},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","float PHBeckmann( float ndoth, float m ) {","float alpha = acos( ndoth );","float ta = tan( alpha );","float val = 1.0 / ( m * m * pow( ndoth, 4.0 ) ) * exp( -( ta * ta ) / ( m * m ) );","return val;","}","float KSTextureCompute( vec2 tex ) {","return 0.5 * pow( PHBeckmann( tex.x, tex.y ), 0.1 );","}","void main() {","float x = KSTextureCompute( vUv );","gl_FragColor = vec4( x, x, x, 1.0 );","}"].join("\n")}},ShaderTerrain={terrain:{uniforms:UniformsUtils.merge([UniformsLib.fog,UniformsLib.lights,{enableDiffuse1:{value:0},enableDiffuse2:{value:0},enableSpecular:{value:0},enableReflection:{value:0},tDiffuse1:{value:null},tDiffuse2:{value:null},tDetail:{value:null},tNormal:{value:null},tSpecular:{value:null},tDisplacement:{value:null},uNormalScale:{value:1},uDisplacementBias:{value:0},uDisplacementScale:{value:1},diffuse:{value:new Color(15658734)},specular:{value:new Color(1118481)},shininess:{value:30},opacity:{value:1},uRepeatBase:{value:new Vector2(1,1)},uRepeatOverlay:{value:new Vector2(1,1)},uOffset:{value:new Vector2(0,0)}}]),fragmentShader:["uniform vec3 diffuse;","uniform vec3 specular;","uniform float shininess;","uniform float opacity;","uniform bool enableDiffuse1;","uniform bool enableDiffuse2;","uniform bool enableSpecular;","uniform sampler2D tDiffuse1;","uniform sampler2D tDiffuse2;","uniform sampler2D tDetail;","uniform sampler2D tNormal;","uniform sampler2D tSpecular;","uniform sampler2D tDisplacement;","uniform float uNormalScale;","uniform vec2 uRepeatOverlay;","uniform vec2 uRepeatBase;","uniform vec2 uOffset;","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vViewPosition;",ShaderChunk.common,ShaderChunk.bsdfs,ShaderChunk.lights_pars_begin,ShaderChunk.shadowmap_pars_fragment,ShaderChunk.fog_pars_fragment,"float calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {","if ( decayExponent > 0.0 ) {","return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );","}","return 1.0;","}","void main() {","vec3 outgoingLight = vec3( 0.0 );","vec4 diffuseColor = vec4( diffuse, opacity );","vec3 specularTex = vec3( 1.0 );","vec2 uvOverlay = uRepeatOverlay * vUv + uOffset;","vec2 uvBase = uRepeatBase * vUv;","vec3 normalTex = texture2D( tDetail, uvOverlay ).xyz * 2.0 - 1.0;","normalTex.xy *= uNormalScale;","normalTex = normalize( normalTex );","if( enableDiffuse1 && enableDiffuse2 ) {","vec4 colDiffuse1 = texture2D( tDiffuse1, uvOverlay );","vec4 colDiffuse2 = texture2D( tDiffuse2, uvOverlay );","colDiffuse1 = GammaToLinear( colDiffuse1, float( GAMMA_FACTOR ) );","colDiffuse2 = GammaToLinear( colDiffuse2, float( GAMMA_FACTOR ) );","diffuseColor *= mix ( colDiffuse1, colDiffuse2, 1.0 - texture2D( tDisplacement, uvBase ) );"," } else if( enableDiffuse1 ) {","diffuseColor *= texture2D( tDiffuse1, uvOverlay );","} else if( enableDiffuse2 ) {","diffuseColor *= texture2D( tDiffuse2, uvOverlay );","}","if( enableSpecular )","specularTex = texture2D( tSpecular, uvOverlay ).xyz;","mat3 tsb = mat3( vTangent, vBinormal, vNormal );","vec3 finalNormal = tsb * normalTex;","vec3 normal = normalize( finalNormal );","vec3 viewPosition = normalize( vViewPosition );","vec3 totalDiffuseLight = vec3( 0.0 );","vec3 totalSpecularLight = vec3( 0.0 );","#if NUM_POINT_LIGHTS > 0","for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {","vec3 lVector = pointLights[ i ].position + vViewPosition.xyz;","float attenuation = calcLightAttenuation( length( lVector ), pointLights[ i ].distance, pointLights[ i ].decay );","lVector = normalize( lVector );","vec3 pointHalfVector = normalize( lVector + viewPosition );","float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );","float pointDiffuseWeight = max( dot( normal, lVector ), 0.0 );","float pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, shininess ), 0.0 );","totalDiffuseLight += attenuation * pointLights[ i ].color * pointDiffuseWeight;","totalSpecularLight += attenuation * pointLights[ i ].color * specular * pointSpecularWeight * pointDiffuseWeight;","}","#endif","#if NUM_DIR_LIGHTS > 0","vec3 dirDiffuse = vec3( 0.0 );","vec3 dirSpecular = vec3( 0.0 );","for( int i = 0; i < NUM_DIR_LIGHTS; i++ ) {","vec3 dirVector = directionalLights[ i ].direction;","vec3 dirHalfVector = normalize( dirVector + viewPosition );","float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );","float dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );","float dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, shininess ), 0.0 );","totalDiffuseLight += directionalLights[ i ].color * dirDiffuseWeight;","totalSpecularLight += directionalLights[ i ].color * specular * dirSpecularWeight * dirDiffuseWeight;","}","#endif","#if NUM_HEMI_LIGHTS > 0","vec3 hemiDiffuse  = vec3( 0.0 );","vec3 hemiSpecular = vec3( 0.0 );","for( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {","vec3 lVector = hemisphereLightDirection[ i ];","float dotProduct = dot( normal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","totalDiffuseLight += mix( hemisphereLights[ i ].groundColor, hemisphereLights[ i ].skyColor, hemiDiffuseWeight );","float hemiSpecularWeight = 0.0;","vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );","float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;","hemiSpecularWeight += specularTex.r * max( pow( hemiDotNormalHalfSky, shininess ), 0.0 );","vec3 lVectorGround = -lVector;","vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );","float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;","hemiSpecularWeight += specularTex.r * max( pow( hemiDotNormalHalfGround, shininess ), 0.0 );","totalSpecularLight += specular * mix( hemisphereLights[ i ].groundColor, hemisphereLights[ i ].skyColor, hemiDiffuseWeight ) * hemiSpecularWeight * hemiDiffuseWeight;","}","#endif","outgoingLight += diffuseColor.xyz * ( totalDiffuseLight + ambientLightColor + totalSpecularLight );","gl_FragColor = vec4( outgoingLight, diffuseColor.a );",ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:["attribute vec4 tangent;","uniform vec2 uRepeatBase;","uniform sampler2D tNormal;","#ifdef VERTEX_TEXTURES","uniform sampler2D tDisplacement;","uniform float uDisplacementScale;","uniform float uDisplacementBias;","#endif","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vViewPosition;",ShaderChunk.shadowmap_pars_vertex,ShaderChunk.fog_pars_vertex,"void main() {","vNormal = normalize( normalMatrix * normal );","vTangent = normalize( normalMatrix * tangent.xyz );","vBinormal = cross( vNormal, vTangent ) * tangent.w;","vBinormal = normalize( vBinormal );","vUv = uv;","vec2 uvBase = uv * uRepeatBase;","#ifdef VERTEX_TEXTURES","vec3 dv = texture2D( tDisplacement, uvBase ).xyz;","float df = uDisplacementScale * dv.x + uDisplacementBias;","vec3 displacedPosition = normal * df + position;","vec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );","vec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );","#else","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","#endif","gl_Position = projectionMatrix * mvPosition;","vViewPosition = -mvPosition.xyz;","vec3 normalTex = texture2D( tNormal, uvBase ).xyz * 2.0 - 1.0;","vNormal = normalMatrix * normalTex;",ShaderChunk.shadowmap_vertex,ShaderChunk.fog_vertex,"}"].join("\n")}},ShaderToon={toon1:{uniforms:{uDirLightPos:{value:new Vector3},uDirLightColor:{value:new Color(15658734)},uAmbientLightColor:{value:new Color(328965)},uBaseColor:{value:new Color(16777215)}},vertexShader:["varying vec3 vNormal;","varying vec3 vRefract;","void main() {","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","vec3 worldNormal = normalize ( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal );","vNormal = normalize( normalMatrix * normal );","vec3 I = worldPosition.xyz - cameraPosition;","vRefract = refract( normalize( I ), worldNormal, 1.02 );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform vec3 uBaseColor;","uniform vec3 uDirLightPos;","uniform vec3 uDirLightColor;","uniform vec3 uAmbientLightColor;","varying vec3 vNormal;","varying vec3 vRefract;","void main() {","float directionalLightWeighting = max( dot( normalize( vNormal ), uDirLightPos ), 0.0);","vec3 lightWeighting = uAmbientLightColor + uDirLightColor * directionalLightWeighting;","float intensity = smoothstep( - 0.5, 1.0, pow( length(lightWeighting), 20.0 ) );","intensity += length(lightWeighting) * 0.2;","float cameraWeighting = dot( normalize( vNormal ), vRefract );","intensity += pow( 1.0 - length( cameraWeighting ), 6.0 );","intensity = intensity * 0.2 + 0.3;","if ( intensity < 0.50 ) {","gl_FragColor = vec4( 2.0 * intensity * uBaseColor, 1.0 );","} else {","gl_FragColor = vec4( 1.0 - 2.0 * ( 1.0 - intensity ) * ( 1.0 - uBaseColor ), 1.0 );","}","}"].join("\n")},toon2:{uniforms:{uDirLightPos:{value:new Vector3},uDirLightColor:{value:new Color(15658734)},uAmbientLightColor:{value:new Color(328965)},uBaseColor:{value:new Color(15658734)},uLineColor1:{value:new Color(8421504)},uLineColor2:{value:new Color(0)},uLineColor3:{value:new Color(0)},uLineColor4:{value:new Color(0)}},vertexShader:["varying vec3 vNormal;","void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","vNormal = normalize( normalMatrix * normal );","}"].join("\n"),fragmentShader:["uniform vec3 uBaseColor;","uniform vec3 uLineColor1;","uniform vec3 uLineColor2;","uniform vec3 uLineColor3;","uniform vec3 uLineColor4;","uniform vec3 uDirLightPos;","uniform vec3 uDirLightColor;","uniform vec3 uAmbientLightColor;","varying vec3 vNormal;","void main() {","float camera = max( dot( normalize( vNormal ), vec3( 0.0, 0.0, 1.0 ) ), 0.4);","float light = max( dot( normalize( vNormal ), uDirLightPos ), 0.0);","gl_FragColor = vec4( uBaseColor, 1.0 );","if ( length(uAmbientLightColor + uDirLightColor * light) < 1.00 ) {","gl_FragColor *= vec4( uLineColor1, 1.0 );","}","if ( length(uAmbientLightColor + uDirLightColor * camera) < 0.50 ) {","gl_FragColor *= vec4( uLineColor2, 1.0 );","}","}"].join("\n")},hatching:{uniforms:{uDirLightPos:{value:new Vector3},uDirLightColor:{value:new Color(15658734)},uAmbientLightColor:{value:new Color(328965)},uBaseColor:{value:new Color(16777215)},uLineColor1:{value:new Color(0)},uLineColor2:{value:new Color(0)},uLineColor3:{value:new Color(0)},uLineColor4:{value:new Color(0)}},vertexShader:["varying vec3 vNormal;","void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","vNormal = normalize( normalMatrix * normal );","}"].join("\n"),fragmentShader:["uniform vec3 uBaseColor;","uniform vec3 uLineColor1;","uniform vec3 uLineColor2;","uniform vec3 uLineColor3;","uniform vec3 uLineColor4;","uniform vec3 uDirLightPos;","uniform vec3 uDirLightColor;","uniform vec3 uAmbientLightColor;","varying vec3 vNormal;","void main() {","float directionalLightWeighting = max( dot( normalize(vNormal), uDirLightPos ), 0.0);","vec3 lightWeighting = uAmbientLightColor + uDirLightColor * directionalLightWeighting;","gl_FragColor = vec4( uBaseColor, 1.0 );","if ( length(lightWeighting) < 1.00 ) {","if ( mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0) {","gl_FragColor = vec4( uLineColor1, 1.0 );","}","}","if ( length(lightWeighting) < 0.75 ) {","if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0) {","gl_FragColor = vec4( uLineColor2, 1.0 );","}","}","if ( length(lightWeighting) < 0.50 ) {","if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0) {","gl_FragColor = vec4( uLineColor3, 1.0 );","}","}","if ( length(lightWeighting) < 0.3465 ) {","if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0) {","gl_FragColor = vec4( uLineColor4, 1.0 );","}","}","}"].join("\n")},dotted:{uniforms:{uDirLightPos:{value:new Vector3},uDirLightColor:{value:new Color(15658734)},uAmbientLightColor:{value:new Color(328965)},uBaseColor:{value:new Color(16777215)},uLineColor1:{value:new Color(0)}},vertexShader:["varying vec3 vNormal;","void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","vNormal = normalize( normalMatrix * normal );","}"].join("\n"),fragmentShader:["uniform vec3 uBaseColor;","uniform vec3 uLineColor1;","uniform vec3 uLineColor2;","uniform vec3 uLineColor3;","uniform vec3 uLineColor4;","uniform vec3 uDirLightPos;","uniform vec3 uDirLightColor;","uniform vec3 uAmbientLightColor;","varying vec3 vNormal;","void main() {","float directionalLightWeighting = max( dot( normalize(vNormal), uDirLightPos ), 0.0);","vec3 lightWeighting = uAmbientLightColor + uDirLightColor * directionalLightWeighting;","gl_FragColor = vec4( uBaseColor, 1.0 );","if ( length(lightWeighting) < 1.00 ) {","if ( ( mod(gl_FragCoord.x, 4.001) + mod(gl_FragCoord.y, 4.0) ) > 6.00 ) {","gl_FragColor = vec4( uLineColor1, 1.0 );","}","}","if ( length(lightWeighting) < 0.50 ) {","if ( ( mod(gl_FragCoord.x + 2.0, 4.001) + mod(gl_FragCoord.y + 2.0, 4.0) ) > 6.00 ) {","gl_FragColor = vec4( uLineColor1, 1.0 );","}","}","}"].join("\n")}},TranslucentShader=function(){this.uniforms=UniformsUtils.merge([UniformsLib.common,UniformsLib.lights,{color:{value:new Color(16777215)},diffuse:{value:new Color(16777215)},specular:{value:new Color(16777215)},emissive:{value:new Color(0)},opacity:{value:1},shininess:{value:1},thicknessMap:{value:null},thicknessColor:{value:new Color(16777215)},thicknessDistortion:{value:.1},thicknessAmbient:{value:0},thicknessAttenuation:{value:.1},thicknessPower:{value:2},thicknessScale:{value:10}}]),this.fragmentShader=["#define USE_MAP","#define PHONG","#define TRANSLUCENT","#include <common>","#include <bsdfs>","#include <uv_pars_fragment>","#include <map_pars_fragment>","#include <lights_phong_pars_fragment>","varying vec3 vColor;","uniform vec3 diffuse;","uniform vec3 specular;","uniform vec3 emissive;","uniform float opacity;","uniform float shininess;","uniform sampler2D thicknessMap;","uniform float thicknessPower;","uniform float thicknessScale;","uniform float thicknessDistortion;","uniform float thicknessAmbient;","uniform float thicknessAttenuation;","uniform vec3 thicknessColor;",ShaderChunk.lights_pars_begin,"void RE_Direct_Scattering(const in IncidentLight directLight, const in vec2 uv, const in GeometricContext geometry, inout ReflectedLight reflectedLight) {","\tvec3 thickness = thicknessColor * texture2D(thicknessMap, uv).r;","\tvec3 scatteringHalf = normalize(directLight.direction + (geometry.normal * thicknessDistortion));","\tfloat scatteringDot = pow(saturate(dot(geometry.viewDir, -scatteringHalf)), thicknessPower) * thicknessScale;","\tvec3 scatteringIllu = (scatteringDot + thicknessAmbient) * thickness;","\treflectedLight.directDiffuse += scatteringIllu * thicknessAttenuation * directLight.color;","}","void main() {","\tvec3 normal = normalize( vNormal );","\tvec3 viewerDirection = normalize( vViewPosition );","\tvec4 diffuseColor = vec4( diffuse, opacity );","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",ShaderChunk.map_fragment,ShaderChunk.color_fragment,ShaderChunk.specularmap_fragment,"\tvec3 totalEmissiveRadiance = emissive;",ShaderChunk.lights_phong_fragment,"\tGeometricContext geometry;","\tgeometry.position = - vViewPosition;","\tgeometry.normal = normal;","\tgeometry.viewDir = normalize( vViewPosition );","\tIncidentLight directLight;","\t#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )","\t\tPointLight pointLight;","\t\t#pragma unroll_loop","\t\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {","\t\t \tpointLight = pointLights[ i ];","\t\t \tgetPointDirectLightIrradiance( pointLight, geometry, directLight );","\t\t\t#ifdef USE_SHADOWMAP","\t\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;","\t\t\t#endif","\t\t\tRE_Direct( directLight, geometry, material, reflectedLight );","\t\t\t#if defined( TRANSLUCENT ) && defined( USE_MAP )","\t\t\tRE_Direct_Scattering(directLight, vUv, geometry, reflectedLight);","\t\t\t#endif","\t\t}","\t\t#endif","\t#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )","\t\tDirectionalLight directionalLight;","\t\t#pragma unroll_loop","\t\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {","\t\t\tdirectionalLight = directionalLights[ i ];","\t\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );","\t\t\t#ifdef USE_SHADOWMAP","\t\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;","\t\t\t#endif","\t\t\tRE_Direct( directLight, geometry, material, reflectedLight );","\t\t\t#if defined( TRANSLUCENT ) && defined( USE_MAP )","\t\t\tRE_Direct_Scattering(directLight, vUv, geometry, reflectedLight);","\t\t\t#endif","\t\t}","\t#endif","\t#if defined( RE_IndirectDiffuse )","\t\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );","\t\t#if ( NUM_HEMI_LIGHTS > 0 )","\t\t\t#pragma unroll_loop","\t\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {","\t\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );","\t\t\t}","\t\t#endif","\t#endif","\t#if defined( RE_IndirectSpecular )","\t\tvec3 radiance = vec3( 0.0 );","\t\tvec3 clearCoatRadiance = vec3( 0.0 );","\t#endif",ShaderChunk.lights_fragment_end,"\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;","\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );",ShaderChunk.encodings_fragment,"}"].join("\n"),this.vertexShader=["varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vViewPosition;",ShaderChunk.common,"void main() {","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","\tvViewPosition = -mvPosition.xyz;","\tvNormal = normalize( normalMatrix * normal );","\tvUv = uv;","\tgl_Position = projectionMatrix * mvPosition;","}"].join("\n")},TimelinerController=function(e,t,r){this._scene=e,this._trackInfo=t,this._onUpdate=r,this._mixer=new AnimationMixer(e),this._clip=null,this._action=null,this._tracks={},this._propRefs={},this._channelNames=[]};TimelinerController.prototype={constructor:TimelinerController,init:function(e){for(var t=[],r=this._trackInfo,n=0,i=r.length;n!==i;++n){var o=r[n];t.push(this._addTrack(o.type,o.propertyPath,o.initialValue,o.interpolation))}this._clip=new AnimationClip("editclip",0,t),this._action=this._mixer.clipAction(this._clip).play()},setDisplayTime:function(e){this._action.time=e,this._mixer.update(0),this._onUpdate()},setDuration:function(e){this._clip.duration=e},getChannelNames:function(){return this._channelNames},getChannelKeyTimes:function(e){return this._tracks[e].times},setKeyframe:function(e,t){var r=this._tracks[e],n=r.times,i=Timeliner.binarySearch(n,t),o=r.values,a=r.getValueSize(),s=i*a;if(i<0){s=(i=~i)*a;for(var l=n.length+1,u=o.length+a,c=l-1;c!==i;--c)n[c]=n[c-1];c=u-1;for(var h=s+a-1;c!==h;--c)o[c]=o[c-a]}n[i]=t,this._propRefs[e].getValue(o,s)},delKeyframe:function(e,t){var r=this._tracks[e],n=r.times,i=Timeliner.binarySearch(n,t);if(n.length>1&&i>=0){for(var o=n.length-1,a=r.values,s=r.getValueSize(),l=a.length-s,u=i;u!==o;++u)n[u]=n[u+1];n.pop();for(var c=i*s;c!==l;++c)a[c]=a[c+s];a.length=l}},moveKeyframe:function(e,t,r,n){var i=this._tracks[e],o=i.times,a=Timeliner.binarySearch(o,t);if(a>=0){for(var s=n?o.length:a+1,l=o[a-1]<=t||!n&&t>=o[a+1];a!==s;)o[a++]+=r;l&&this._sort(i)}},serialize:function(){for(var e={duration:this._clip.duration,channels:{}},t=this._channelNames,r=this._tracks,n=e.channels,i=0,o=t.length;i!==o;++i){var a=t[i],s=r[a];n[a]={times:s.times,values:s.values}}return e},deserialize:function(e){var t=this._channelNames,r=this._tracks,n=e.channels;this.setDuration(e.duration);for(var i=0,o=t.length;i!==o;++i){var a=t[i],s=r[a],l=n[a];this._setArray(s.times,l.times),this._setArray(s.values,l.values)}this.setDisplayTime(this._mixer.time)},_sort:function(e){var t=e.times,r=AnimationUtils.getKeyframeOrder(t);this._setArray(t,AnimationUtils.sortedArray(t,1,r));var n=e.values,i=e.getValueSize();this._setArray(n,AnimationUtils.sortedArray(n,i,r))},_setArray:function(e,t){e.length=0,e.push.apply(e,t)},_addTrack:function(e,t,r,n){var i=new e(t,[0],r,n);return i.times=Array.prototype.slice.call(i.times),i.values=Array.prototype.slice.call(i.values),this._channelNames.push(t),this._tracks[t]=i,this._propRefs[t]=new PropertyBinding(this._scene,t),i}};var TypedArrayUtils={quicksortIP:function(e,t,r){for(var n,i,o=[],a=-1,s=0,l=e.length/t-1,u=0,c=0,h=0,p=function(r,n){for(r*=t,n*=t,h=0;h<t;h++)u=e[r+h],e[r+h]=e[n+h],e[n+h]=u},f=new Float32Array(t),d=new Float32Array(t);;)if(l-s<=25){for(i=s+1;i<=l;i++){for(c=0;c<t;c++)f[c]=e[i*t+c];for(n=i-1;n>=s&&e[n*t+r]>f[r];){for(c=0;c<t;c++)e[(n+1)*t+c]=e[n*t+c];n--}for(c=0;c<t;c++)e[(n+1)*t+c]=f[c]}if(-1==a)break;l=o[a--],s=o[a--]}else{for(i=l,p(s+l>>1,n=s+1),e[s*t+r]>e[l*t+r]&&p(s,l),e[n*t+r]>e[l*t+r]&&p(n,l),e[s*t+r]>e[n*t+r]&&p(s,n),c=0;c<t;c++)d[c]=e[n*t+c];for(;;){do{n++}while(e[n*t+r]<d[r]);do{i--}while(e[i*t+r]>d[r]);if(i<n)break;p(n,i)}for(c=0;c<t;c++)e[(s+1)*t+c]=e[i*t+c],e[i*t+c]=d[c];l-n+1>=i-s?(o[++a]=n,o[++a]=l,l=i-1):(o[++a]=s,o[++a]=i-1,s=n)}return e},Kdtree:function(e,t,r){var n=this,i=0,o=function(e,t){return e.subarray(t*r,t*r+r)};this.root=function e(t,a,s,l){var u,c,h=a%r,p=t.length/r;return a>i&&(i=a),0===p?null:1===p?new n.Node(o(t,0),a,s,l):(TypedArrayUtils.quicksortIP(t,r,h),u=Math.floor(p/2),(c=new n.Node(o(t,u),a,s,u+l)).left=e(t.subarray(0,u*r),a+1,c,l),c.right=e(t.subarray((u+1)*r,t.length),a+1,c,l+u+1),c)}(e,0,null,0),this.getMaxDepth=function(){return i},this.nearest=function(e,i,o){var a,s,l;if(l=new TypedArrayUtils.Kdtree.BinaryHeap(function(e){return-e[1]}),o)for(a=0;a<i;a+=1)l.push([null,o]);for(function n(o){var a,s,u,c,h=o.depth%r,p=t(e,o.obj),f=[];function d(e,t){l.push([e,t]),l.size()>i&&l.pop()}for(c=0;c<r;c+=1)c===o.depth%r?f[c]=e[c]:f[c]=o.obj[c];s=t(f,o.obj),null!==o.right||null!==o.left?(n(a=null===o.right?o.left:null===o.left?o.right:e[h]<o.obj[h]?o.left:o.right),(l.size()<i||p<l.peek()[1])&&d(o,p),(l.size()<i||Math.abs(s)<l.peek()[1])&&null!==(u=a===o.left?o.right:o.left)&&n(u)):(l.size()<i||p<l.peek()[1])&&d(o,p)}(n.root),s=[],a=0;a<i;a+=1)l.content[a][0]&&s.push([l.content[a][0],l.content[a][1]]);return s}}};TypedArrayUtils.Kdtree.prototype.Node=function(e,t,r,n){this.obj=e,this.left=null,this.right=null,this.parent=r,this.depth=t,this.pos=n},TypedArrayUtils.Kdtree.BinaryHeap=function(e){this.content=[],this.scoreFunction=e},TypedArrayUtils.Kdtree.BinaryHeap.prototype={push:function(e){this.content.push(e),this.bubbleUp(this.content.length-1)},pop:function(){var e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.sinkDown(0)),e},peek:function(){return this.content[0]},remove:function(e){for(var t=this.content.length,r=0;r<t;r++)if(this.content[r]==e){var n=this.content.pop();return void(r!=t-1&&(this.content[r]=n,this.scoreFunction(n)<this.scoreFunction(e)?this.bubbleUp(r):this.sinkDown(r)))}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(e){for(var t=this.content[e];e>0;){var r=Math.floor((e+1)/2)-1,n=this.content[r];if(!(this.scoreFunction(t)<this.scoreFunction(n)))break;this.content[r]=t,this.content[e]=n,e=r}},sinkDown:function(e){for(var t=this.content.length,r=this.content[e],n=this.scoreFunction(r);;){var i=2*(e+1),o=i-1,a=null;if(o<t){var s=this.content[o],l=this.scoreFunction(s);l<n&&(a=o)}if(i<t){var u=this.content[i];this.scoreFunction(u)<(null===a?n:l)&&(a=i)}if(null===a)break;this.content[e]=this.content[a],this.content[a]=r,e=a}}};var GeometryUtils={merge:function(e,t,r){var n;console.warn("GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t instanceof Mesh&&(t.matrixAutoUpdate&&t.updateMatrix(),n=t.matrix,t=t.geometry),e.merge(t,n,r)},randomPointInTriangle:function(){var e=new Vector3;return function(t,r,n){var i=new Vector3,o=Math.random(),a=Math.random();o+a>1&&(o=1-o,a=1-a);var s=1-o-a;return i.copy(t),i.multiplyScalar(o),e.copy(r),e.multiplyScalar(a),i.add(e),e.copy(n),e.multiplyScalar(s),i.add(e),i}}(),randomPointInFace:function(e,t){var r,n,i;return r=t.vertices[e.a],n=t.vertices[e.b],i=t.vertices[e.c],GeometryUtils.randomPointInTriangle(r,n,i)},randomPointsInGeometry:function(e,t){var r,n,i,o,a,s=e.faces,l=e.vertices,u=s.length,c=0,h=[];for(n=0;n<u;n++)i=l[(r=s[n]).a],o=l[r.b],a=l[r.c],r._area=GeometryUtils.triangleArea(i,o,a),c+=r._area,h[n]=c;function p(e){return function t(r,n){if(n<r)return r;var i=r+Math.floor((n-r)/2);return h[i]>e?t(r,i-1):h[i]<e?t(i+1,n):i}(0,h.length-1)}var f,d=[];for(n=0;n<t;n++)f=p(Math.random()*c),d[n]=GeometryUtils.randomPointInFace(s[f],e);return d},randomPointsInBufferGeometry:function(e,t){var r,n,i,o,a=e.attributes.position.array,s=0,l=[];n=new Vector3,i=new Vector3,o=new Vector3;var u=a.length/9;for(r=0;r<u;r++)n.set(a[9*r+0],a[9*r+1],a[9*r+2]),i.set(a[9*r+3],a[9*r+4],a[9*r+5]),o.set(a[9*r+6],a[9*r+7],a[9*r+8]),s+=GeometryUtils.triangleArea(n,i,o),l.push(s);function c(e){return function t(r,n){if(n<r)return r;var i=r+Math.floor((n-r)/2);return l[i]>e?t(r,i-1):l[i]<e?t(i+1,n):i}(0,l.length-1)}var h,p=[];for(r=0;r<t;r++)h=c(Math.random()*s),n.set(a[9*h+0],a[9*h+1],a[9*h+2]),i.set(a[9*h+3],a[9*h+4],a[9*h+5]),o.set(a[9*h+6],a[9*h+7],a[9*h+8]),p[r]=GeometryUtils.randomPointInTriangle(n,i,o);return p},triangleArea:function(){var e=new Vector3,t=new Vector3;return function(r,n,i){return e.subVectors(n,r),t.subVectors(i,r),e.cross(t),.5*e.length()}}(),center:function(e){return console.warn("GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},MathUtils={setQuaternionFromProperEuler:function(e,t,r,n,i){var o=Math.cos,a=Math.sin,s=o(r/2),l=a(r/2),u=o((t+n)/2),c=a((t+n)/2),h=o((t-n)/2),p=a((t-n)/2),f=o((n-t)/2),d=a((n-t)/2);"XYX"===i?e.set(s*c,l*h,l*p,s*u):"YZY"===i?e.set(l*p,s*c,l*h,s*u):"ZXZ"===i?e.set(l*h,l*p,s*c,s*u):"XZX"===i?e.set(s*c,l*d,l*f,s*u):"YXY"===i?e.set(l*f,s*c,l*d,s*u):"ZYZ"===i?e.set(l*d,l*f,s*c,s*u):console.warn("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}},SceneUtils={createMultiMaterialObject:function(e,t){for(var r=new Group,n=0,i=t.length;n<i;n++)r.add(new Mesh(e,t[n]));return r},detach:function(e,t,r){e.applyMatrix(t.matrixWorld),t.remove(e),r.add(e)},attach:function(e,t,r){e.applyMatrix((new Matrix4).getInverse(r.matrixWorld)),t.remove(e),r.add(e)}},ShadowMapViewer=function(e){var t,r=this,n=void 0!==e.name&&""!==e.name,i=10,o=10,a=256,s=256,l=new OrthographicCamera(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,1,10);l.position.set(0,0,2);var u,c,h=new Scene,p=UnpackDepthRGBAShader,f=new UniformsUtils.clone(p.uniforms),d=new ShaderMaterial({uniforms:f,vertexShader:p.vertexShader,fragmentShader:p.fragmentShader}),m=new Mesh(new PlaneBufferGeometry(a,s),d);if(h.add(m),n){var v=(u=document.createElement("canvas")).getContext("2d");v.font="Bold 20px Arial";var g=v.measureText(e.name).width;u.width=g,u.height=25,v.font="Bold 20px Arial",v.fillStyle="rgba( 255, 0, 0, 1 )",v.fillText(e.name,0,20);var y=new Texture(u);y.magFilter=LinearFilter,y.minFilter=LinearFilter,y.needsUpdate=!0;var b=new MeshBasicMaterial({map:y,side:DoubleSide});b.transparent=!0;var x=new PlaneBufferGeometry(u.width,u.height);c=new Mesh(x,b),h.add(c)}this.enabled=!0,this.size={width:a,height:s,set:function(e,t){this.width=e,this.height=t,m.scale.set(this.width/a,this.height/s,1),r.position.set(r.position.x,r.position.y)}},this.position={x:i,y:o,set:function(e,t){this.x=e,this.y=t;var i=r.size.width,o=r.size.height;m.position.set(-window.innerWidth/2+i/2+this.x,window.innerHeight/2-o/2-this.y,0),n&&c.position.set(m.position.x,m.position.y-r.size.height/2+u.height/2,0)}},this.render=function(r){this.enabled&&(f.tDiffuse.value=e.shadow.map.texture,t=r.autoClear,r.autoClear=!1,r.clearDepth(),r.render(h,l),r.autoClear=t)},this.updateForWindowResize=function(){this.enabled&&(l.left=window.innerWidth/-2,l.right=window.innerWidth/2,l.top=window.innerHeight/2,l.bottom=window.innerHeight/-2,l.updateProjectionMatrix(),this.update())},this.update=function(){this.position.set(this.position.x,this.position.y),this.size.set(this.size.width,this.size.height)},this.update()};function getBoneList(e){var t=[];e&&e.isBone&&t.push(e);for(var r=0;r<e.children.length;r++)t.push.apply(t,getBoneList(e.children[r]));return t}function SkeletonHelper(e){for(var t=getBoneList(e),r=new BufferGeometry,n=[],i=[],o=new Color(0,0,1),a=new Color(0,1,0),s=0;s<t.length;s++){var l=t[s];l.parent&&l.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),i.push(o.r,o.g,o.b),i.push(a.r,a.g,a.b))}r.addAttribute("position",new Float32BufferAttribute(n,3)),r.addAttribute("color",new Float32BufferAttribute(i,3));var u=new LineBasicMaterial({vertexColors:VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});LineSegments.call(this,r,u),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}ShadowMapViewer.prototype.constructor=ShadowMapViewer,SkeletonHelper.prototype=Object.create(LineSegments.prototype),SkeletonHelper.prototype.constructor=SkeletonHelper,SkeletonHelper.prototype.updateMatrixWorld=function(){var e=new Vector3,t=new Matrix4,r=new Matrix4;return function(n){var i=this.bones,o=this.geometry,a=o.getAttribute("position");r.getInverse(this.root.matrixWorld);for(var s=0,l=0;s<i.length;s++){var u=i[s];u.parent&&u.parent.isBone&&(t.multiplyMatrices(r,u.matrixWorld),e.setFromMatrixPosition(t),a.setXYZ(l,e.x,e.y,e.z),t.multiplyMatrices(r,u.parent.matrixWorld),e.setFromMatrixPosition(t),a.setXYZ(l+1,e.x,e.y,e.z),l+=2)}o.getAttribute("position").needsUpdate=!0,Object3D.prototype.updateMatrixWorld.call(this,n)}}();var SkeletonUtils={retarget:function(){var e=new Vector3,t=new Quaternion,r=new Vector3,n=new Matrix4,i=new Matrix4,o=new Matrix4;return function(a,s,l){(l=l||{}).preserveMatrix=void 0===l.preserveMatrix||l.preserveMatrix,l.preservePosition=void 0===l.preservePosition||l.preservePosition,l.preserveHipPosition=void 0!==l.preserveHipPosition&&l.preserveHipPosition,l.useTargetMatrix=void 0!==l.useTargetMatrix&&l.useTargetMatrix,l.hip=void 0!==l.hip?l.hip:"hip",l.names=l.names||{};var u,c,h,p,f,d,m=s.isObject3D?s.skeleton.bones:this.getBones(s),v=a.isObject3D?a.skeleton.bones:this.getBones(a);if(a.isObject3D?a.skeleton.pose():(l.useTargetMatrix=!0,l.preserveMatrix=!1),l.preservePosition)for(f=[],d=0;d<v.length;d++)f.push(v[d].position.clone());if(l.preserveMatrix)for(a.updateMatrixWorld(),a.matrixWorld.identity(),d=0;d<a.children.length;++d)a.children[d].updateMatrixWorld(!0);if(l.offsets)for(u=[],d=0;d<v.length;++d)c=v[d],h=l.names[c.name]||c.name,l.offsets&&l.offsets[h]&&(c.matrix.multiply(l.offsets[h]),c.matrix.decompose(c.position,c.quaternion,c.scale),c.updateMatrixWorld()),u.push(c.matrixWorld.clone());for(d=0;d<v.length;++d){if(c=v[d],h=l.names[c.name]||c.name,p=this.getBoneByName(h,m),o.copy(c.matrixWorld),p){if(p.updateMatrixWorld(),l.useTargetMatrix?i.copy(p.matrixWorld):(i.getInverse(a.matrixWorld),i.multiply(p.matrixWorld)),r.setFromMatrixScale(i),i.scale(r.set(1/r.x,1/r.y,1/r.z)),o.makeRotationFromQuaternion(t.setFromRotationMatrix(i)),a.isObject3D){var g=v.indexOf(c),y=u?u[g]:n.getInverse(a.skeleton.boneInverses[g]);o.multiply(y)}o.copyPosition(i)}c.parent&&c.parent.isBone?(c.matrix.getInverse(c.parent.matrixWorld),c.matrix.multiply(o)):c.matrix.copy(o),l.preserveHipPosition&&h===l.hip&&c.matrix.setPosition(e.set(0,c.position.y,0)),c.matrix.decompose(c.position,c.quaternion,c.scale),c.updateMatrixWorld()}if(l.preservePosition)for(d=0;d<v.length;++d)c=v[d],(h=l.names[c.name]||c.name)!==l.hip&&c.position.copy(f[d]);l.preserveMatrix&&a.updateMatrixWorld(!0)}}(),retargetClip:function(e,t,r,n){(n=n||{}).useFirstFramePosition=void 0!==n.useFirstFramePosition&&n.useFirstFramePosition,n.fps=void 0!==n.fps?n.fps:30,n.names=n.names||[],t.isObject3D||(t=this.getHelperFromSkeleton(t));var i,o,a,s,l,u,c=Math.round(r.duration*(n.fps/1e3)*1e3),h=1/n.fps,p=[],f=new AnimationMixer(t),d=this.getBones(e.skeleton),m=[];for(f.clipAction(r).play(),f.update(0),t.updateMatrixWorld(),l=0;l<c;++l){var v=l*h;for(this.retarget(e,t,n),u=0;u<d.length;++u)s=n.names[d[u].name]||d[u].name,this.getBoneByName(s,t.skeleton)&&(o=d[u],a=m[u]=m[u]||{bone:o},n.hip===s&&(a.pos||(a.pos={times:new Float32Array(c),values:new Float32Array(3*c)}),n.useFirstFramePosition&&(0===l&&(i=o.position.clone()),o.position.sub(i)),a.pos.times[l]=v,o.position.toArray(a.pos.values,3*l)),a.quat||(a.quat={times:new Float32Array(c),values:new Float32Array(4*c)}),a.quat.times[l]=v,o.quaternion.toArray(a.quat.values,4*l));f.update(h),t.updateMatrixWorld()}for(l=0;l<m.length;++l)(a=m[l])&&(a.pos&&p.push(new VectorKeyframeTrack(".bones["+a.bone.name+"].position",a.pos.times,a.pos.values)),p.push(new QuaternionKeyframeTrack(".bones["+a.bone.name+"].quaternion",a.quat.times,a.quat.values)));return f.uncacheAction(r),new AnimationClip(r.name,-1,p)},getHelperFromSkeleton:function(e){var t=new SkeletonHelper(e.bones[0]);return t.skeleton=e,t},getSkeletonOffsets:function(){var e=new Vector3,t=new Vector3,r=new Vector3,n=new Vector3,i=new Vector2,o=new Vector2;return function(a,s,l){(l=l||{}).hip=void 0!==l.hip?l.hip:"hip",l.names=l.names||{},s.isObject3D||(s=this.getHelperFromSkeleton(s));var u,c,h,p,f=Object.keys(l.names),d=Object.values(l.names),m=s.isObject3D?s.skeleton.bones:this.getBones(s),v=a.isObject3D?a.skeleton.bones:this.getBones(a),g=[];for(a.skeleton.pose(),p=0;p<v.length;++p)if(u=v[p],h=l.names[u.name]||u.name,(c=this.getBoneByName(h,m))&&h!==l.hip){var y=this.getNearestBone(u.parent,f),b=this.getNearestBone(c.parent,d);y.updateMatrixWorld(),b.updateMatrixWorld(),e.setFromMatrixPosition(y.matrixWorld),t.setFromMatrixPosition(u.matrixWorld),r.setFromMatrixPosition(b.matrixWorld),n.setFromMatrixPosition(c.matrixWorld),i.subVectors(new Vector2(t.x,t.y),new Vector2(e.x,e.y)).normalize(),o.subVectors(new Vector2(n.x,n.y),new Vector2(r.x,r.y)).normalize();var x=i.angle()-o.angle(),w=(new Matrix4).makeRotationFromEuler(new Euler(0,0,x));u.matrix.multiply(w),u.matrix.decompose(u.position,u.quaternion,u.scale),u.updateMatrixWorld(),g[h]=w}return g}}(),renameBones:function(e,t){for(var r=this.getBones(e),n=0;n<r.length;++n){var i=r[n];t[i.name]&&(i.name=t[i.name])}return this},getBones:function(e){return Array.isArray(e)?e:e.bones},getBoneByName:function(e,t){for(var r=0,n=this.getBones(t);r<n.length;r++)if(e===n[r].name)return n[r]},getNearestBone:function(e,t){for(;e.isBone;){if(-1!==t.indexOf(e.name))return e;e=e.parent}},findBoneTrackData:function(e,t){for(var r=/\[(.*)\]\.(.*)/,n={name:e},i=0;i<t.length;++i){var o=r.exec(t[i].name);o&&e===o[1]&&(n[o[2]]=i)}return n},getEqualsBonesNames:function(e,t){var r=this.getBones(e),n=this.getBones(t),i=[];e:for(var o=0;o<r.length;o++)for(var a=r[o].name,s=0;s<n.length;s++)if(a===n[s].name){i.push(a);continue e}return i}},UVsDebug=function(e,t){var r="abc",n=new Vector2,i=new Vector2,o=[new Vector2,new Vector2,new Vector2],a=[],s=document.createElement("canvas"),l=t||1024,u=t||1024;s.width=l,s.height=u;var c=s.getContext("2d");if(c.lineWidth=2,c.strokeStyle="rgba( 0, 0, 0, 1.0 )",c.textAlign="center",c.fillStyle="rgba( 255, 255, 255, 1.0 )",c.fillRect(0,0,l,u),e.isGeometry)for(var h=e.faces,p=e.faceVertexUvs[0],f=0,d=p.length;f<d;f++){a=h[f];var m=p[f];a[0]=a.a,a[1]=a.b,a[2]=a.c,o[0].copy(m[0]),o[1].copy(m[1]),o[2].copy(m[2]),y(a,o,f)}else{var v=e.index,g=e.attributes.uv;if(v)for(f=0,d=v.count;f<d;f+=3)a[0]=v.getX(f),a[1]=v.getX(f+1),a[2]=v.getX(f+2),o[0].fromBufferAttribute(g,a[0]),o[1].fromBufferAttribute(g,a[1]),o[2].fromBufferAttribute(g,a[2]),y(a,o,f);else for(f=0,d=g.count;f<d;f+=3)a[0]=f,a[1]=f+1,a[2]=f+2,o[0].fromBufferAttribute(g,a[0]),o[1].fromBufferAttribute(g,a[1]),o[2].fromBufferAttribute(g,a[2]),y(a,o,f)}return s;function y(e,t,o){c.beginPath(),n.set(0,0);for(var a=0,s=t.length;a<s;a++){var h=t[a];n.x+=h.x,n.y+=h.y,0===a?c.moveTo(h.x*l,(1-h.y)*u):c.lineTo(h.x*l,(1-h.y)*u)}for(c.closePath(),c.stroke(),n.divideScalar(t.length),c.font="12pt Arial bold",c.fillStyle="rgba( 0, 0, 0, 1.0 )",c.fillText(o,n.x*l,(1-n.y)*u),n.x>.95&&c.fillText(o,n.x%1*l,(1-n.y)*u),c.font="8pt Arial bold",c.fillStyle="rgba( 0, 0, 0, 1.0 )",a=0,s=t.length;a<s;a++){h=t[a];i.addVectors(n,h).divideScalar(2);var p=e[a];c.fillText(r[a]+p,i.x*l,(1-i.y)*u),i.x>.95&&c.fillText(r[a]+p,i.x%1*l,(1-i.y)*u)}}},VolumeSlice=function(e,t,r){var n=this;this.volume=e,t=t||0,Object.defineProperty(this,"index",{get:function(){return t},set:function(e){return t=e,n.geometryNeedsUpdate=!0,t}}),this.axis=r||"z",this.canvas=document.createElement("canvas"),this.canvasBuffer=document.createElement("canvas"),this.updateGeometry();var i=new Texture(this.canvas);i.minFilter=LinearFilter,i.wrapS=i.wrapT=ClampToEdgeWrapping;var o=new MeshBasicMaterial({map:i,side:DoubleSide,transparent:!0});this.mesh=new Mesh(this.geometry,o),this.geometryNeedsUpdate=!0,this.repaint()};VolumeSlice.prototype={constructor:VolumeSlice,repaint:function(){this.geometryNeedsUpdate&&this.updateGeometry();var e=this.iLength,t=this.jLength,r=this.sliceAccess,n=this.volume,i=this.canvasBuffer,o=this.ctxBuffer,a=o.getImageData(0,0,e,t),s=a.data,l=n.data,u=n.upperThreshold,c=n.lowerThreshold,h=n.windowLow,p=n.windowHigh,f=0;if("label"===n.dataType)for(var d=0;d<t;d++)for(var m=0;m<e;m++){var v=l[r(m,d)];v=v>=this.colorMap.length?v%this.colorMap.length+1:v;var g=this.colorMap[v];s[4*f]=g>>24&255,s[4*f+1]=g>>16&255,s[4*f+2]=g>>8&255,s[4*f+3]=255&g,f++}else for(d=0;d<t;d++)for(m=0;m<e;m++){var y=l[r(m,d)],b=255;b=u>=y&&c<=y?b:0,y=(y=Math.floor(255*(y-h)/(p-h)))>255?255:y<0?0:0|y,s[4*f]=y,s[4*f+1]=y,s[4*f+2]=y,s[4*f+3]=b,f++}o.putImageData(a,0,0),this.ctx.drawImage(i,0,0,e,t,0,0,this.canvas.width,this.canvas.height),this.mesh.material.map.needsUpdate=!0},updateGeometry:function(){var e=this.volume.extractPerpendicularPlane(this.axis,this.index);this.sliceAccess=e.sliceAccess,this.jLength=e.jLength,this.iLength=e.iLength,this.matrix=e.matrix,this.canvas.width=e.planeWidth,this.canvas.height=e.planeHeight,this.canvasBuffer.width=this.iLength,this.canvasBuffer.height=this.jLength,this.ctx=this.canvas.getContext("2d"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.geometry&&this.geometry.dispose(),this.geometry=new PlaneBufferGeometry(e.planeWidth,e.planeHeight),this.mesh&&(this.mesh.geometry=this.geometry,this.mesh.matrix.identity(),this.mesh.applyMatrix(this.matrix)),this.geometryNeedsUpdate=!1}};var DaydreamController=function(){Object3D.call(this);var e,t=this,r=[0,0],n=!1,i=new Vector3;this.matrixAutoUpdate=!1,this.getGamepad=function(){return e},this.getTouchpadState=function(){return n},this.update=function(){if(void 0!==(e=function(){for(var e=navigator.getGamepads&&navigator.getGamepads(),t=0;t<4;t++){var r=e[t];if(r&&"Daydream Controller"===r.id)return r}}())&&void 0!==e.pose){var o=e.pose;if(null===o)return;null!==o.orientation&&t.quaternion.fromArray(o.orientation),t.updateMatrix(),t.visible=!0,null===o.angularVelocity||i.equals(o.angularVelocity)||(i.fromArray(o.angularVelocity),t.dispatchEvent({type:"angularvelocitychanged",angularVelocity:i})),r[0]===e.axes[0]&&r[1]===e.axes[1]||(r[0]=e.axes[0],r[1]=e.axes[1],t.dispatchEvent({type:"axischanged",axes:r})),n!==e.buttons[0].pressed&&(n=e.buttons[0].pressed,t.dispatchEvent({type:n?"touchpaddown":"touchpadup"}))}else t.visible=!1},this.getTouchPadState=function(){return console.warn("DaydreamController: getTouchPadState() is now getTouchpadState()"),n}};DaydreamController.prototype=Object.create(Object3D.prototype),DaydreamController.prototype.constructor=DaydreamController;var GearVRController=function(){Object3D.call(this);var e,t=this,r=[0,0],n=!1,i=!1,o=new Vector3;this.matrixAutoUpdate=!0,this.getGamepad=function(){return e},this.getTouchpadState=function(){return n},this.update=function(){if(void 0!==(e=function(){for(var e=navigator.getGamepads&&navigator.getGamepads(),t=0;t<4;t++){var r=e[t];if(r&&("Gear VR Controller"===r.id||"Oculus Go Controller"===r.id))return r}}())&&void 0!==e.pose){var a=e.pose;if(null===a)return;null!==a.orientation&&t.quaternion.fromArray(a.orientation),t.updateMatrix(),t.visible=!0,null===a.angularVelocity||o.equals(a.angularVelocity)||(o.fromArray(a.angularVelocity),t.dispatchEvent({type:"angularvelocitychanged",angularVelocity:o})),r[0]===e.axes[0]&&r[1]===e.axes[1]||(r[0]=e.axes[0],r[1]=e.axes[1],t.dispatchEvent({type:"axischanged",axes:r})),n!==e.buttons[0].pressed&&(n=e.buttons[0].pressed,t.dispatchEvent({type:n?"touchpaddown":"touchpadup",axes:r})),i!==e.buttons[1].pressed&&(i=e.buttons[1].pressed,t.dispatchEvent({type:i?"triggerdown":"triggerup"}))}else t.visible=!1},this.getTouchPadState=function(){return console.warn("GearVRController: getTouchPadState() is now getTouchpadState()"),n},this.setHand=function(){console.warn("GearVRController: setHand() has been removed.")}};GearVRController.prototype=Object.create(Object3D.prototype),GearVRController.prototype.constructor=GearVRController;var ViveController=function(e){Object3D.call(this);var t,r=this,n=[0,0],i=!1,o=!1,a=!1,s=!1;this.matrixAutoUpdate=!1,this.standingMatrix=new Matrix4,this.getGamepad=function(){return t},this.getButtonState=function(e){return"thumbpad"===e?i:"trigger"===e?o:"grips"===e?a:"menu"===e?s:void 0},this.update=function(){if(void 0!==(t=function(e){for(var t=navigator.getGamepads&&navigator.getGamepads(),r=0,n=0;r<t.length;r++){var i=t[r];if(i&&("OpenVR Gamepad"===i.id||i.id.startsWith("Oculus Touch")||i.id.startsWith("Spatial Controller"))){if(n===e)return i;n++}}}(e))&&void 0!==t.pose){if(null===t.pose)return;var l=t.pose;null!==l.position&&r.position.fromArray(l.position),null!==l.orientation&&r.quaternion.fromArray(l.orientation),r.matrix.compose(r.position,r.quaternion,r.scale),r.matrix.premultiply(r.standingMatrix),r.matrixWorldNeedsUpdate=!0,r.visible=!0,n[0]===t.axes[0]&&n[1]===t.axes[1]||(n[0]=t.axes[0],n[1]=t.axes[1],r.dispatchEvent({type:"axischanged",axes:n})),i!==t.buttons[0].pressed&&(i=t.buttons[0].pressed,r.dispatchEvent({type:i?"thumbpaddown":"thumbpadup",axes:n})),o!==t.buttons[1].pressed&&(o=t.buttons[1].pressed,r.dispatchEvent({type:o?"triggerdown":"triggerup"})),a!==t.buttons[2].pressed&&(a=t.buttons[2].pressed,r.dispatchEvent({type:a?"gripsdown":"gripsup"})),s!==t.buttons[3].pressed&&(s=t.buttons[3].pressed,r.dispatchEvent({type:s?"menudown":"menuup"}))}else r.visible=!1}};function CircleGeometry(e,t,r,n){Geometry.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:n},this.fromBufferGeometry(new CircleBufferGeometry(e,t,r,n)),this.mergeVertices()}function CircleBufferGeometry(e,t,r,n){BufferGeometry.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:n},e=e||1,t=void 0!==t?Math.max(3,t):8,r=void 0!==r?r:0,n=void 0!==n?n:2*Math.PI;var i,o,a=[],s=[],l=[],u=[],c=new Vector3,h=new Vector2;for(s.push(0,0,0),l.push(0,0,1),u.push(.5,.5),o=0,i=3;o<=t;o++,i+=3){var p=r+o/t*n;c.x=e*Math.cos(p),c.y=e*Math.sin(p),s.push(c.x,c.y,c.z),l.push(0,0,1),h.x=(s[i]/e+1)/2,h.y=(s[i+1]/e+1)/2,u.push(h.x,h.y)}for(i=1;i<=t;i++)a.push(i,i+1,0);this.setIndex(a),this.addAttribute("position",new Float32BufferAttribute(s,3)),this.addAttribute("normal",new Float32BufferAttribute(l,3)),this.addAttribute("uv",new Float32BufferAttribute(u,2))}function IcosahedronGeometry(e,t){Geometry.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new IcosahedronBufferGeometry(e,t)),this.mergeVertices()}function IcosahedronBufferGeometry(e,t){var r=(1+Math.sqrt(5))/2,n=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1];PolyhedronBufferGeometry.call(this,n,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function ShapeGeometry(e,t){Geometry.call(this),this.type="ShapeGeometry","object"===typeof t&&(console.warn("ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new ShapeBufferGeometry(e,t)),this.mergeVertices()}function ShapeBufferGeometry(e,t){BufferGeometry.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;var r=[],n=[],i=[],o=[],a=0,s=0;if(!1===Array.isArray(e))u(e);else for(var l=0;l<e.length;l++)u(e[l]),this.addGroup(a,s,l),a+=s,s=0;function u(e){var a,l,u,c=n.length/3,h=e.extractPoints(t),p=h.shape,f=h.holes;for(!1===ShapeUtils.isClockWise(p)&&(p=p.reverse()),a=0,l=f.length;a<l;a++)u=f[a],!0===ShapeUtils.isClockWise(u)&&(f[a]=u.reverse());var d=ShapeUtils.triangulateShape(p,f);for(a=0,l=f.length;a<l;a++)u=f[a],p=p.concat(u);for(a=0,l=p.length;a<l;a++){var m=p[a];n.push(m.x,m.y,0),i.push(0,0,1),o.push(m.x,m.y)}for(a=0,l=d.length;a<l;a++){var v=d[a],g=v[0]+c,y=v[1]+c,b=v[2]+c;r.push(g,y,b),s+=3}}this.setIndex(r),this.addAttribute("position",new Float32BufferAttribute(n,3)),this.addAttribute("normal",new Float32BufferAttribute(i,3)),this.addAttribute("uv",new Float32BufferAttribute(o,2))}function toJSON(e,t){if(t.shapes=[],Array.isArray(e))for(var r=0,n=e.length;r<n;r++){var i=e[r];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}ViveController.prototype=Object.create(Object3D.prototype),ViveController.prototype.constructor=ViveController,CircleGeometry.prototype=Object.create(Geometry.prototype),CircleGeometry.prototype.constructor=CircleGeometry,CircleBufferGeometry.prototype=Object.create(BufferGeometry.prototype),CircleBufferGeometry.prototype.constructor=CircleBufferGeometry,IcosahedronGeometry.prototype=Object.create(Geometry.prototype),IcosahedronGeometry.prototype.constructor=IcosahedronGeometry,IcosahedronBufferGeometry.prototype=Object.create(PolyhedronBufferGeometry.prototype),IcosahedronBufferGeometry.prototype.constructor=IcosahedronBufferGeometry,ShapeGeometry.prototype=Object.create(Geometry.prototype),ShapeGeometry.prototype.constructor=ShapeGeometry,ShapeGeometry.prototype.toJSON=function(){var e=Geometry.prototype.toJSON.call(this);return toJSON(this.parameters.shapes,e)},ShapeBufferGeometry.prototype=Object.create(BufferGeometry.prototype),ShapeBufferGeometry.prototype.constructor=ShapeBufferGeometry,ShapeBufferGeometry.prototype.toJSON=function(){var e=BufferGeometry.prototype.toJSON.call(this);return toJSON(this.parameters.shapes,e)};var PaintViveController=function(e){ViveController.call(this,e);var t=2*Math.PI,r={COLOR:0,SIZE:1},n=r.COLOR,i=new Color(1,1,1),o=1;var a=new Mesh(s=new CircleBufferGeometry(1,32),p=new MeshBasicMaterial({map:function(){var e=document.createElement("canvas");e.width=256,e.height=256;for(var r=e.getContext("2d"),n=r.getImageData(0,0,256,256),i=n.data,o=new Color,a=0,s=0;a<i.length;a+=4,s++){var l=s%256/256-.5,u=Math.floor(s/256)/256-.5;o.setHSL(Math.atan2(u,l)/t,1,2*(.5-Math.sqrt(l*l+u*u))),i[a+0]=256*o.r,i[a+1]=256*o.g,i[a+2]=256*o.b,i[a+3]=256}return r.putImageData(n,0,0),new CanvasTexture(e)}()}));a.position.set(0,.005,.0495),a.rotation.x=-1.45,a.scale.setScalar(.02),this.add(a);var s=new IcosahedronBufferGeometry(.1,2);(p=new MeshBasicMaterial).color=i;var l=new Mesh(s,p);a.add(l);var u=new Group;u.position.set(0,.005,.0495),u.rotation.x=-1.45,u.scale.setScalar(.02),this.add(u);var c=new Shape;c.moveTo(0,-1),c.lineTo(1,1),c.lineTo(-1,1);var h=new Mesh(s=new ShapeBufferGeometry(c),p=new MeshBasicMaterial({color:2236962,wireframe:!0}));h.position.z=.001,d(h.geometry,1),u.add(h);var p;s=new ShapeBufferGeometry(c);(p=new MeshBasicMaterial({side:DoubleSide})).color=i;var f=new Mesh(s,p);function d(e,t){var r=Math.atan(.25),n=1.5*t,i=Math.tan(r)*n*2,o=e.attributes.position;o.setXYZ(0,0,-.75,0),o.setXYZ(1,0+i/2,-.75+n,0),o.setXYZ(2,0-i/2,-.75+n,0),o.needsUpdate=!0}f.position.z=.0011,d(f.geometry,.5),u.add(f),u.visible=!1,this.getColor=function(){return i},this.getSize=function(){return o},this.addEventListener("axischanged",function(e){if(!1!==this.getButtonState("thumbpad")){var a=e.axes[0]/2,s=-e.axes[1]/2;if(n===r.COLOR&&(i.setHSL(Math.atan2(s,a)/t,1,2*(.5-Math.sqrt(a*a+s*s))),l.position.set(e.axes[0],e.axes[1],0)),n===r.SIZE){var u=.5-s;o=2*u,d(f.geometry,u)}}}),this.addEventListener("gripsdown",function(){return n===r.COLOR?(n=r.SIZE,a.visible=!1,void(u.visible=!0)):n===r.SIZE?(n=r.COLOR,a.visible=!0,void(u.visible=!1)):void 0})};PaintViveController.prototype=Object.create(ViveController.prototype),PaintViveController.prototype.constructor=PaintViveController;var WebVR={createButton:function(e,t){function r(t){o.style.display="",o.style.cursor="pointer",o.style.left="calc(50% - 50px)",o.style.width="100px",o.textContent="ENTER VR",o.onmouseenter=function(){o.style.opacity="1.0"},o.onmouseleave=function(){o.style.opacity="0.5"},o.onclick=function(){t.isPresenting?t.exitPresent():t.requestPresent([{source:e.domElement}])},e.vr.setDevice(t)}function n(){o.style.display="",o.style.cursor="auto",o.style.left="calc(50% - 75px)",o.style.width="150px",o.textContent="VR NOT FOUND",o.onmouseenter=null,o.onmouseleave=null,o.onclick=null,e.vr.setDevice(null)}function i(e){e.style.position="absolute",e.style.bottom="20px",e.style.padding="12px 6px",e.style.border="1px solid #fff",e.style.borderRadius="4px",e.style.background="rgba(0,0,0,0.1)",e.style.color="#fff",e.style.font="normal 13px sans-serif",e.style.textAlign="center",e.style.opacity="0.5",e.style.outline="none",e.style.zIndex="999"}var o;if(t&&t.frameOfReferenceType&&e.vr.setFrameOfReferenceType(t.frameOfReferenceType),"xr"in navigator)return(o=document.createElement("button")).style.display="none",i(o),navigator.xr.requestDevice().then(function(t){t.supportsSession({immersive:!0,exclusive:!0}).then(function(){!function(t){var r=null;function n(t){t.addEventListener("end",i),e.vr.setSession(t),o.textContent="EXIT VR",r=t}function i(t){r.removeEventListener("end",i),e.vr.setSession(null),o.textContent="ENTER VR",r=null}o.style.display="",o.style.cursor="pointer",o.style.left="calc(50% - 50px)",o.style.width="100px",o.textContent="ENTER VR",o.onmouseenter=function(){o.style.opacity="1.0"},o.onmouseleave=function(){o.style.opacity="0.5"},o.onclick=function(){null===r?t.requestSession({immersive:!0,exclusive:!0}).then(n):r.end()},e.vr.setDevice(t)}(t)}).catch(n)}).catch(n),o;if("getVRDisplays"in navigator)return(o=document.createElement("button")).style.display="none",i(o),window.addEventListener("vrdisplayconnect",function(e){r(e.display)},!1),window.addEventListener("vrdisplaydisconnect",function(e){n()},!1),window.addEventListener("vrdisplaypresentchange",function(e){o.textContent=e.display.isPresenting?"EXIT VR":"ENTER VR"},!1),window.addEventListener("vrdisplayactivate",function(t){t.display.requestPresent([{source:e.domElement}])},!1),navigator.getVRDisplays().then(function(e){e.length>0?r(e[0]):n()}).catch(n),o;var a=document.createElement("a");return a.href="https://webvr.info",a.innerHTML="WEBVR NOT SUPPORTED",a.style.left="calc(50% - 90px)",a.style.width="180px",a.style.textDecoration="none",i(a),a},checkAvailability:function(){return console.warn("WEBVR.checkAvailability has been deprecated."),new Promise(function(){})},getMessageContainer:function(){return console.warn("WEBVR.getMessageContainer has been deprecated."),document.createElement("div")},getButton:function(){return console.warn("WEBVR.getButton has been deprecated."),document.createElement("div")},getVRDisplay:function(){console.warn("WEBVR.getVRDisplay has been deprecated.")}},WebGL={isWebGLAvailable:function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(t){return!1}},isWebGL2Available:function(){try{var e=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!e.getContext("webgl2"))}catch(t){return!1}},getWebGLErrorMessage:function(){return this.getErrorMessage(1)},getWebGL2ErrorMessage:function(){return this.getErrorMessage(2)},getErrorMessage:function(e){var t={1:window.WebGLRenderingContext,2:window.WebGL2RenderingContext},r='Your $0 does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">$1</a>',n=document.createElement("div");return n.id="webglmessage",n.style.fontFamily="monospace",n.style.fontSize="13px",n.style.fontWeight="normal",n.style.textAlign="center",n.style.background="#fff",n.style.color="#000",n.style.padding="1.5em",n.style.width="400px",n.style.margin="5em auto 0",r=(r=t[e]?r.replace("$0","graphics card"):r.replace("$0","browser")).replace("$1",{1:"WebGL",2:"WebGL 2"}[e]),n.innerHTML=r,n}},context;function AnimationObjectGroup(){var e=arguments;this.uuid=_Math.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var r=0,n=arguments.length;r!==n;++r)t[e[r].uuid]=r;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}function Audio(e){Object3D.call(this),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function AudioAnalyser(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}Object.assign(AnimationObjectGroup.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=arguments,t=this._objects,r=t.length,n=this.nCachedObjects_,i=this._indicesByUUID,o=this._paths,a=this._parsedPaths,s=this._bindings,l=s.length,u=void 0,c=0,h=arguments.length;c!==h;++c){var p=e[c],f=p.uuid,d=i[f];if(void 0===d){d=r++,i[f]=d,t.push(p);for(var m=0,v=l;m!==v;++m)s[m].push(new PropertyBinding(p,o[m],a[m]))}else if(d<n){u=t[d];var g=--n,y=t[g];i[y.uuid]=d,t[d]=y,i[f]=g,t[g]=p;for(m=0,v=l;m!==v;++m){var b=s[m],x=b[g],w=b[d];b[d]=x,void 0===w&&(w=new PropertyBinding(p,o[m],a[m])),b[g]=w}}else t[d]!==u&&console.error("AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var e=arguments,t=this._objects,r=this.nCachedObjects_,n=this._indicesByUUID,i=this._bindings,o=i.length,a=0,s=arguments.length;a!==s;++a){var l=e[a],u=l.uuid,c=n[u];if(void 0!==c&&c>=r){var h=r++,p=t[h];n[p.uuid]=c,t[c]=p,n[u]=h,t[h]=l;for(var f=0,d=o;f!==d;++f){var m=i[f],v=m[h],g=m[c];m[c]=v,m[h]=g}}}this.nCachedObjects_=r},uncache:function(){for(var e=arguments,t=this._objects,r=t.length,n=this.nCachedObjects_,i=this._indicesByUUID,o=this._bindings,a=o.length,s=0,l=arguments.length;s!==l;++s){var u=e[s].uuid,c=i[u];if(void 0!==c)if(delete i[u],c<n){var h=--n,p=t[h],f=t[y=--r];i[p.uuid]=c,t[c]=p,i[f.uuid]=h,t[h]=f,t.pop();for(var d=0,m=a;d!==m;++d){var v=(b=o[d])[h],g=b[y];b[c]=v,b[h]=g,b.pop()}}else{var y;i[(f=t[y=--r]).uuid]=c,t[c]=f,t.pop();for(d=0,m=a;d!==m;++d){var b;(b=o[d])[c]=b[y],b.pop()}}}this.nCachedObjects_=n},subscribe_:function(e,t){var r=this._bindingsIndicesByPath,n=r[e],i=this._bindings;if(void 0!==n)return i[n];var o=this._paths,a=this._parsedPaths,s=this._objects,l=s.length,u=this.nCachedObjects_,c=new Array(l);n=i.length,r[e]=n,o.push(e),a.push(t),i.push(c);for(var h=u,p=s.length;h!==p;++h){var f=s[h];c[h]=new PropertyBinding(f,e,t)}return c},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,r=t[e];if(void 0!==r){var n=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];t[e[a]]=r,o[r]=s,o.pop(),i[r]=i[a],i.pop(),n[r]=n[a],n.pop()}}}),Audio.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Audio,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.onended=this.onEnded.bind(this),this.startTime=this.context.currentTime,e.start(this.startTime,this.offset),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("Audio: this Audio has no playback control.")}else console.warn("Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.source.onended=null,this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.source.onended=null,this.offset=0,this.isPlaying=!1,this;console.warn("Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},setDetune:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}),Object.assign(AudioAnalyser.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),r=0;r<t.length;r++)e+=t[r];return e/t.length}});var AudioContext={getContext:function(){return void 0===context&&(context=new(window.AudioContext||window.webkitAudioContext)),context},setContext:function(e){context=e}};function AudioListener(){Object3D.call(this),this.type="AudioListener",this.context=AudioContext.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0}function PositionalAudio(e){Audio.call(this,e),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function InstancedBufferAttribute(e,t,r,n){"number"===typeof r&&(n=r,r=!1,console.error("InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),BufferAttribute.call(this,e,t,r),this.meshPerAttribute=n||1}function Font(e){this.type="Font",this.data=e}function createPaths(e,t,r){for(var n=Array.from?Array.from(e):String(e).split(""),i=t/r.resolution,o=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*i,a=[],s=0,l=0,u=0;u<n.length;u++){var c=n[u];if("\n"===c)s=0,l-=o;else{var h=createPath(c,i,s,l,r);s+=h.offsetX,a.push(h.path)}}return a}function createPath(e,t,r,n,i){var o=i.glyphs[e]||i.glyphs["?"];if(o){var a,s,l,u,c,h,p,f,d=new ShapePath;if(o.o)for(var m=o._cachedOutline||(o._cachedOutline=o.o.split(" ")),v=0,g=m.length;v<g;){switch(m[v++]){case"m":a=m[v++]*t+r,s=m[v++]*t+n,d.moveTo(a,s);break;case"l":a=m[v++]*t+r,s=m[v++]*t+n,d.lineTo(a,s);break;case"q":l=m[v++]*t+r,u=m[v++]*t+n,c=m[v++]*t+r,h=m[v++]*t+n,d.quadraticCurveTo(c,h,l,u);break;case"b":l=m[v++]*t+r,u=m[v++]*t+n,c=m[v++]*t+r,h=m[v++]*t+n,p=m[v++]*t+r,f=m[v++]*t+n,d.bezierCurveTo(c,h,p,f,l,u)}}return{offsetX:o.ha*t,path:d}}}function ConeGeometry(e,t,r,n,i,o,a){CylinderGeometry.call(this,0,e,t,r,n,i,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:o,thetaLength:a}}function ConeBufferGeometry(e,t,r,n,i,o,a){CylinderBufferGeometry.call(this,0,e,t,r,n,i,o,a),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:o,thetaLength:a}}function DodecahedronGeometry(e,t){Geometry.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new DodecahedronBufferGeometry(e,t)),this.mergeVertices()}function DodecahedronBufferGeometry(e,t){var r=(1+Math.sqrt(5))/2,n=1/r,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-r,0,-n,r,0,n,-r,0,n,r,-n,-r,0,-n,r,0,n,-r,0,n,r,0,-r,0,-n,r,0,-n,-r,0,n,r,0,n];PolyhedronBufferGeometry.call(this,i,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function EdgesGeometry(e,t){BufferGeometry.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;var r,n,i,o,a=[],s=Math.cos(_Math.DEG2RAD*t),l=[0,0],u={},c=["a","b","c"];e.isBufferGeometry?(o=new Geometry).fromBufferGeometry(e):o=e.clone(),o.mergeVertices(),o.computeFaceNormals();for(var h=o.vertices,p=o.faces,f=0,d=p.length;f<d;f++)for(var m=p[f],v=0;v<3;v++)r=m[c[v]],n=m[c[(v+1)%3]],l[0]=Math.min(r,n),l[1]=Math.max(r,n),void 0===u[i=l[0]+","+l[1]]?u[i]={index1:l[0],index2:l[1],face1:f,face2:void 0}:u[i].face2=f;for(i in u){var g=u[i];if(void 0===g.face2||p[g.face1].normal.dot(p[g.face2].normal)<=s){var y=h[g.index1];a.push(y.x,y.y,y.z),y=h[g.index2],a.push(y.x,y.y,y.z)}}this.addAttribute("position",new Float32BufferAttribute(a,3))}function ExtrudeGeometry(e,t){Geometry.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new ExtrudeBufferGeometry(e,t)),this.mergeVertices()}function ExtrudeBufferGeometry(e,t){BufferGeometry.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];for(var r=this,n=[],i=[],o=0,a=e.length;o<a;o++){s(e[o])}function s(e){var o=[],a=void 0!==t.curveSegments?t.curveSegments:12,s=void 0!==t.steps?t.steps:1,l=void 0!==t.depth?t.depth:100,u=void 0===t.bevelEnabled||t.bevelEnabled,c=void 0!==t.bevelThickness?t.bevelThickness:6,h=void 0!==t.bevelSize?t.bevelSize:c-2,p=void 0!==t.bevelSegments?t.bevelSegments:3,f=t.extrudePath,d=void 0!==t.UVGenerator?t.UVGenerator:WorldUVGenerator;void 0!==t.amount&&(console.warn("ExtrudeBufferGeometry: amount has been renamed to depth."),l=t.amount);var m,v,g,y,b,x,w,S,M=!1;f&&(m=f.getSpacedPoints(s),M=!0,u=!1,v=f.computeFrenetFrames(s,!1),g=new Vector3,y=new Vector3,b=new Vector3),u||(p=0,c=0,h=0);var _=e.extractPoints(a),T=_.shape,A=_.holes;if(!ShapeUtils.isClockWise(T))for(T=T.reverse(),w=0,S=A.length;w<S;w++)x=A[w],ShapeUtils.isClockWise(x)&&(A[w]=x.reverse());var C=ShapeUtils.triangulateShape(T,A),E=T;for(w=0,S=A.length;w<S;w++)x=A[w],T=T.concat(x);function L(e,t,r){return t||console.error("ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(r).add(e)}var N,P,O,R,D,F,k=T.length,I=C.length;function B(e,t,r){var n,i,o,a=e.x-t.x,s=e.y-t.y,l=r.x-e.x,u=r.y-e.y,c=a*a+s*s,h=a*u-s*l;if(Math.abs(h)>Number.EPSILON){var p=Math.sqrt(c),f=Math.sqrt(l*l+u*u),d=t.x-s/p,m=t.y+a/p,v=((r.x-u/f-d)*u-(r.y+l/f-m)*l)/(a*u-s*l),g=(n=d+a*v-e.x)*n+(i=m+s*v-e.y)*i;if(g<=2)return new Vector2(n,i);o=Math.sqrt(g/2)}else{var y=!1;a>Number.EPSILON?l>Number.EPSILON&&(y=!0):a<-Number.EPSILON?l<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(u)&&(y=!0),y?(n=-s,i=a,o=Math.sqrt(c)):(n=a,i=s,o=Math.sqrt(c/2))}return new Vector2(n/o,i/o)}for(var U=[],V=0,j=E.length,z=j-1,G=V+1;V<j;V++,z++,G++)z===j&&(z=0),G===j&&(G=0),U[V]=B(E[V],E[z],E[G]);var W,H,X=[],q=U.concat();for(w=0,S=A.length;w<S;w++){for(x=A[w],W=[],V=0,z=(j=x.length)-1,G=V+1;V<j;V++,z++,G++)z===j&&(z=0),G===j&&(G=0),W[V]=B(x[V],x[z],x[G]);X.push(W),q=q.concat(W)}for(N=0;N<p;N++){for(O=N/p,R=c*Math.cos(O*Math.PI/2),P=h*Math.sin(O*Math.PI/2),V=0,j=E.length;V<j;V++)K((D=L(E[V],U[V],P)).x,D.y,-R);for(w=0,S=A.length;w<S;w++)for(x=A[w],W=X[w],V=0,j=x.length;V<j;V++)K((D=L(x[V],W[V],P)).x,D.y,-R)}for(P=h,V=0;V<k;V++)D=u?L(T[V],q[V],P):T[V],M?(y.copy(v.normals[0]).multiplyScalar(D.x),g.copy(v.binormals[0]).multiplyScalar(D.y),b.copy(m[0]).add(y).add(g),K(b.x,b.y,b.z)):K(D.x,D.y,0);for(H=1;H<=s;H++)for(V=0;V<k;V++)D=u?L(T[V],q[V],P):T[V],M?(y.copy(v.normals[H]).multiplyScalar(D.x),g.copy(v.binormals[H]).multiplyScalar(D.y),b.copy(m[H]).add(y).add(g),K(b.x,b.y,b.z)):K(D.x,D.y,l/s*H);for(N=p-1;N>=0;N--){for(O=N/p,R=c*Math.cos(O*Math.PI/2),P=h*Math.sin(O*Math.PI/2),V=0,j=E.length;V<j;V++)K((D=L(E[V],U[V],P)).x,D.y,l+R);for(w=0,S=A.length;w<S;w++)for(x=A[w],W=X[w],V=0,j=x.length;V<j;V++)D=L(x[V],W[V],P),M?K(D.x,D.y+m[s-1].y,m[s-1].x+R):K(D.x,D.y,l+R)}function Y(e,t){var r,n;for(V=e.length;--V>=0;){r=V,(n=V-1)<0&&(n=e.length-1);var i=0,o=s+2*p;for(i=0;i<o;i++){var a=k*i,l=k*(i+1);J(t+r+a,t+n+a,t+n+l,t+r+l)}}}function K(e,t,r){o.push(e),o.push(t),o.push(r)}function Q(e,t,i){Z(e),Z(t),Z(i);var o=n.length/3,a=d.generateTopUV(r,n,o-3,o-2,o-1);$(a[0]),$(a[1]),$(a[2])}function J(e,t,i,o){Z(e),Z(t),Z(o),Z(t),Z(i),Z(o);var a=n.length/3,s=d.generateSideWallUV(r,n,a-6,a-3,a-2,a-1);$(s[0]),$(s[1]),$(s[3]),$(s[1]),$(s[2]),$(s[3])}function Z(e){n.push(o[3*e+0]),n.push(o[3*e+1]),n.push(o[3*e+2])}function $(e){i.push(e.x),i.push(e.y)}!function(){var e=n.length/3;if(u){var t=0,i=k*t;for(V=0;V<I;V++)Q((F=C[V])[2]+i,F[1]+i,F[0]+i);for(i=k*(t=s+2*p),V=0;V<I;V++)Q((F=C[V])[0]+i,F[1]+i,F[2]+i)}else{for(V=0;V<I;V++)Q((F=C[V])[2],F[1],F[0]);for(V=0;V<I;V++)Q((F=C[V])[0]+k*s,F[1]+k*s,F[2]+k*s)}r.addGroup(e,n.length/3-e,0)}(),function(){var e=n.length/3,t=0;for(Y(E,t),t+=E.length,w=0,S=A.length;w<S;w++)Y(x=A[w],t),t+=x.length;r.addGroup(e,n.length/3-e,1)}()}this.addAttribute("position",new Float32BufferAttribute(n,3)),this.addAttribute("uv",new Float32BufferAttribute(i,2)),this.computeVertexNormals()}AudioListener.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:AudioListener,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(){var e=new Vector3,t=new Quaternion,r=new Vector3,n=new Vector3,i=new Clock;return function(o){Object3D.prototype.updateMatrixWorld.call(this,o);var a=this.context.listener,s=this.up;if(this.timeDelta=i.getDelta(),this.matrixWorld.decompose(e,t,r),n.set(0,0,-1).applyQuaternion(t),a.positionX){var l=this.context.currentTime+this.timeDelta;a.positionX.linearRampToValueAtTime(e.x,l),a.positionY.linearRampToValueAtTime(e.y,l),a.positionZ.linearRampToValueAtTime(e.z,l),a.forwardX.linearRampToValueAtTime(n.x,l),a.forwardY.linearRampToValueAtTime(n.y,l),a.forwardZ.linearRampToValueAtTime(n.z,l),a.upX.linearRampToValueAtTime(s.x,l),a.upY.linearRampToValueAtTime(s.y,l),a.upZ.linearRampToValueAtTime(s.z,l)}else a.setPosition(e.x,e.y,e.z),a.setOrientation(n.x,n.y,n.z,s.x,s.y,s.z)}}()}),PositionalAudio.prototype=Object.assign(Object.create(Audio.prototype),{constructor:PositionalAudio,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,t,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=r,this},updateMatrixWorld:function(){var e=new Vector3,t=new Quaternion,r=new Vector3,n=new Vector3;return function(i){if(Object3D.prototype.updateMatrixWorld.call(this,i),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(e,t,r),n.set(0,0,1).applyQuaternion(t);var o=this.panner;if(o.positionX){var a=this.context.currentTime+this.listener.timeDelta;o.positionX.linearRampToValueAtTime(e.x,a),o.positionY.linearRampToValueAtTime(e.y,a),o.positionZ.linearRampToValueAtTime(e.z,a),o.orientationX.linearRampToValueAtTime(n.x,a),o.orientationY.linearRampToValueAtTime(n.y,a),o.orientationZ.linearRampToValueAtTime(n.z,a)}else o.setPosition(e.x,e.y,e.z),o.setOrientation(n.x,n.y,n.z)}}}()}),InstancedBufferAttribute.prototype=Object.assign(Object.create(BufferAttribute.prototype),{constructor:InstancedBufferAttribute,isInstancedBufferAttribute:!0,copy:function(e){return BufferAttribute.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(Font.prototype,{isFont:!0,generateShapes:function(e,t){void 0===t&&(t=100);for(var r=[],n=createPaths(e,t,this.data),i=0,o=n.length;i<o;i++)Array.prototype.push.apply(r,n[i].toShapes());return r}}),ConeGeometry.prototype=Object.create(CylinderGeometry.prototype),ConeGeometry.prototype.constructor=ConeGeometry,ConeBufferGeometry.prototype=Object.create(CylinderBufferGeometry.prototype),ConeBufferGeometry.prototype.constructor=ConeBufferGeometry,DodecahedronGeometry.prototype=Object.create(Geometry.prototype),DodecahedronGeometry.prototype.constructor=DodecahedronGeometry,DodecahedronBufferGeometry.prototype=Object.create(PolyhedronBufferGeometry.prototype),DodecahedronBufferGeometry.prototype.constructor=DodecahedronBufferGeometry,EdgesGeometry.prototype=Object.create(BufferGeometry.prototype),EdgesGeometry.prototype.constructor=EdgesGeometry,ExtrudeGeometry.prototype=Object.create(Geometry.prototype),ExtrudeGeometry.prototype.constructor=ExtrudeGeometry,ExtrudeGeometry.prototype.toJSON=function(){var e=Geometry.prototype.toJSON.call(this);return toJSON$1(this.parameters.shapes,this.parameters.options,e)},ExtrudeBufferGeometry.prototype=Object.create(BufferGeometry.prototype),ExtrudeBufferGeometry.prototype.constructor=ExtrudeBufferGeometry,ExtrudeBufferGeometry.prototype.toJSON=function(){var e=BufferGeometry.prototype.toJSON.call(this);return toJSON$1(this.parameters.shapes,this.parameters.options,e)};var WorldUVGenerator={generateTopUV:function(e,t,r,n,i){var o=t[3*r],a=t[3*r+1],s=t[3*n],l=t[3*n+1],u=t[3*i],c=t[3*i+1];return[new Vector2(o,a),new Vector2(s,l),new Vector2(u,c)]},generateSideWallUV:function(e,t,r,n,i,o){var a=t[3*r],s=t[3*r+1],l=t[3*r+2],u=t[3*n],c=t[3*n+1],h=t[3*n+2],p=t[3*i],f=t[3*i+1],d=t[3*i+2],m=t[3*o],v=t[3*o+1],g=t[3*o+2];return Math.abs(s-c)<.01?[new Vector2(a,1-l),new Vector2(u,1-h),new Vector2(p,1-d),new Vector2(m,1-g)]:[new Vector2(s,1-l),new Vector2(c,1-h),new Vector2(f,1-d),new Vector2(v,1-g)]}},lineGeometry,coneGeometry;function toJSON$1(e,t,r){if(r.shapes=[],Array.isArray(e))for(var n=0,i=e.length;n<i;n++){var o=e[n];r.shapes.push(o.uuid)}else r.shapes.push(e.uuid);return void 0!==t.extrudePath&&(r.options.extrudePath=t.extrudePath.toJSON()),r}function LatheGeometry(e,t,r,n){Geometry.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:n},this.fromBufferGeometry(new LatheBufferGeometry(e,t,r,n)),this.mergeVertices()}function LatheBufferGeometry(e,t,r,n){BufferGeometry.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:n},t=Math.floor(t)||12,r=r||0,n=n||2*Math.PI,n=_Math.clamp(n,0,2*Math.PI);var i,o,a,s=[],l=[],u=[],c=1/t,h=new Vector3,p=new Vector2;for(o=0;o<=t;o++){var f=r+o*c*n,d=Math.sin(f),m=Math.cos(f);for(a=0;a<=e.length-1;a++)h.x=e[a].x*d,h.y=e[a].y,h.z=e[a].x*m,l.push(h.x,h.y,h.z),p.x=o/t,p.y=a/(e.length-1),u.push(p.x,p.y)}for(o=0;o<t;o++)for(a=0;a<e.length-1;a++){var v=i=a+o*e.length,g=i+e.length,y=i+e.length+1,b=i+1;s.push(v,g,b),s.push(g,y,b)}if(this.setIndex(s),this.addAttribute("position",new Float32BufferAttribute(l,3)),this.addAttribute("uv",new Float32BufferAttribute(u,2)),this.computeVertexNormals(),n===2*Math.PI){var x=this.attributes.normal.array,w=new Vector3,S=new Vector3,M=new Vector3;for(i=t*e.length*3,o=0,a=0;o<e.length;o++,a+=3)w.x=x[a+0],w.y=x[a+1],w.z=x[a+2],S.x=x[i+a+0],S.y=x[i+a+1],S.z=x[i+a+2],M.addVectors(w,S).normalize(),x[a+0]=x[i+a+0]=M.x,x[a+1]=x[i+a+1]=M.y,x[a+2]=x[i+a+2]=M.z}}function ParametricGeometry(e,t,r){Geometry.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:r},this.fromBufferGeometry(new ParametricBufferGeometry(e,t,r)),this.mergeVertices()}function ParametricBufferGeometry(e,t,r){BufferGeometry.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:r};var n,i,o=[],a=[],s=[],l=[],u=new Vector3,c=new Vector3,h=new Vector3,p=new Vector3,f=new Vector3;e.length<3&&console.error("ParametricGeometry: Function must now modify a Vector3 as third parameter.");var d=t+1;for(n=0;n<=r;n++){var m=n/r;for(i=0;i<=t;i++){var v=i/t;e(v,m,c),a.push(c.x,c.y,c.z),v-1e-5>=0?(e(v-1e-5,m,h),p.subVectors(c,h)):(e(v+1e-5,m,h),p.subVectors(h,c)),m-1e-5>=0?(e(v,m-1e-5,h),f.subVectors(c,h)):(e(v,m+1e-5,h),f.subVectors(h,c)),u.crossVectors(p,f).normalize(),s.push(u.x,u.y,u.z),l.push(v,m)}}for(n=0;n<r;n++)for(i=0;i<t;i++){var g=n*d+i,y=n*d+i+1,b=(n+1)*d+i+1,x=(n+1)*d+i;o.push(g,y,x),o.push(y,b,x)}this.setIndex(o),this.addAttribute("position",new Float32BufferAttribute(a,3)),this.addAttribute("normal",new Float32BufferAttribute(s,3)),this.addAttribute("uv",new Float32BufferAttribute(l,2))}function RingGeometry(e,t,r,n,i,o){Geometry.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:o},this.fromBufferGeometry(new RingBufferGeometry(e,t,r,n,i,o)),this.mergeVertices()}function RingBufferGeometry(e,t,r,n,i,o){BufferGeometry.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:o},e=e||.5,t=t||1,i=void 0!==i?i:0,o=void 0!==o?o:2*Math.PI,r=void 0!==r?Math.max(3,r):8;var a,s,l,u=[],c=[],h=[],p=[],f=e,d=(t-e)/(n=void 0!==n?Math.max(1,n):1),m=new Vector3,v=new Vector2;for(s=0;s<=n;s++){for(l=0;l<=r;l++)a=i+l/r*o,m.x=f*Math.cos(a),m.y=f*Math.sin(a),c.push(m.x,m.y,m.z),h.push(0,0,1),v.x=(m.x/t+1)/2,v.y=(m.y/t+1)/2,p.push(v.x,v.y);f+=d}for(s=0;s<n;s++){var g=s*(r+1);for(l=0;l<r;l++){var y=a=l+g,b=a+r+1,x=a+r+2,w=a+1;u.push(y,b,w),u.push(b,x,w)}}this.setIndex(u),this.addAttribute("position",new Float32BufferAttribute(c,3)),this.addAttribute("normal",new Float32BufferAttribute(h,3)),this.addAttribute("uv",new Float32BufferAttribute(p,2))}function TetrahedronGeometry(e,t){Geometry.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new TetrahedronBufferGeometry(e,t)),this.mergeVertices()}function TetrahedronBufferGeometry(e,t){PolyhedronBufferGeometry.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function TextGeometry(e,t){Geometry.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new TextBufferGeometry(e,t)),this.mergeVertices()}function TextBufferGeometry(e,t){var r=(t=t||{}).font;if(!r||!r.isFont)return console.error("TextGeometry: font parameter is not an instance of Font."),new Geometry;var n=r.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),ExtrudeBufferGeometry.call(this,n,t),this.type="TextBufferGeometry"}function TorusKnotGeometry(e,t,r,n,i,o,a){Geometry.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:n,p:i,q:o},void 0!==a&&console.warn("TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new TorusKnotBufferGeometry(e,t,r,n,i,o)),this.mergeVertices()}function TorusKnotBufferGeometry(e,t,r,n,i,o){BufferGeometry.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:n,p:i,q:o},e=e||1,t=t||.4,r=Math.floor(r)||64,n=Math.floor(n)||8,i=i||2,o=o||3;var a,s,l=[],u=[],c=[],h=[],p=new Vector3,f=new Vector3,d=new Vector3,m=new Vector3,v=new Vector3,g=new Vector3,y=new Vector3;for(a=0;a<=r;++a){var b=a/r*i*Math.PI*2;for(C(b,i,o,e,d),C(b+.01,i,o,e,m),g.subVectors(m,d),y.addVectors(m,d),v.crossVectors(g,y),y.crossVectors(v,g),v.normalize(),y.normalize(),s=0;s<=n;++s){var x=s/n*Math.PI*2,w=-t*Math.cos(x),S=t*Math.sin(x);p.x=d.x+(w*y.x+S*v.x),p.y=d.y+(w*y.y+S*v.y),p.z=d.z+(w*y.z+S*v.z),u.push(p.x,p.y,p.z),f.subVectors(p,d).normalize(),c.push(f.x,f.y,f.z),h.push(a/r),h.push(s/n)}}for(s=1;s<=r;s++)for(a=1;a<=n;a++){var M=(n+1)*(s-1)+(a-1),_=(n+1)*s+(a-1),T=(n+1)*s+a,A=(n+1)*(s-1)+a;l.push(M,_,A),l.push(_,T,A)}function C(e,t,r,n,i){var o=Math.cos(e),a=Math.sin(e),s=r/t*e,l=Math.cos(s);i.x=n*(2+l)*.5*o,i.y=n*(2+l)*a*.5,i.z=n*Math.sin(s)*.5}this.setIndex(l),this.addAttribute("position",new Float32BufferAttribute(u,3)),this.addAttribute("normal",new Float32BufferAttribute(c,3)),this.addAttribute("uv",new Float32BufferAttribute(h,2))}function TubeGeometry(e,t,r,n,i,o){Geometry.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:n,closed:i},void 0!==o&&console.warn("TubeGeometry: taper has been removed.");var a=new TubeBufferGeometry(e,t,r,n,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function TubeBufferGeometry(e,t,r,n,i){BufferGeometry.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:n,closed:i},t=t||64,r=r||1,n=n||8,i=i||!1;var o=e.computeFrenetFrames(t,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;var a,s,l=new Vector3,u=new Vector3,c=new Vector2,h=new Vector3,p=[],f=[],d=[],m=[];function v(i){h=e.getPointAt(i/t,h);var a=o.normals[i],c=o.binormals[i];for(s=0;s<=n;s++){var d=s/n*Math.PI*2,m=Math.sin(d),v=-Math.cos(d);u.x=v*a.x+m*c.x,u.y=v*a.y+m*c.y,u.z=v*a.z+m*c.z,u.normalize(),f.push(u.x,u.y,u.z),l.x=h.x+r*u.x,l.y=h.y+r*u.y,l.z=h.z+r*u.z,p.push(l.x,l.y,l.z)}}!function(){for(a=0;a<t;a++)v(a);v(!1===i?t:0),function(){for(a=0;a<=t;a++)for(s=0;s<=n;s++)c.x=a/t,c.y=s/n,d.push(c.x,c.y)}(),function(){for(s=1;s<=t;s++)for(a=1;a<=n;a++){var e=(n+1)*(s-1)+(a-1),r=(n+1)*s+(a-1),i=(n+1)*s+a,o=(n+1)*(s-1)+a;m.push(e,r,o),m.push(r,i,o)}}()}(),this.setIndex(m),this.addAttribute("position",new Float32BufferAttribute(p,3)),this.addAttribute("normal",new Float32BufferAttribute(f,3)),this.addAttribute("uv",new Float32BufferAttribute(d,2))}function ArrowHelper(e,t,r,n,i,o){Object3D.call(this),void 0===e&&(e=new Vector3(0,0,1)),void 0===t&&(t=new Vector3(0,0,0)),void 0===r&&(r=1),void 0===n&&(n=16776960),void 0===i&&(i=.2*r),void 0===o&&(o=.2*i),void 0===lineGeometry&&((lineGeometry=new BufferGeometry).addAttribute("position",new Float32BufferAttribute([0,0,0,0,1,0],3)),(coneGeometry=new CylinderBufferGeometry(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new Line(lineGeometry,new LineBasicMaterial({color:n})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Mesh(coneGeometry,new MeshBasicMaterial({color:n})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,i,o)}function AxesHelper(e){var t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=new BufferGeometry;r.addAttribute("position",new Float32BufferAttribute(t,3)),r.addAttribute("color",new Float32BufferAttribute([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var n=new LineBasicMaterial({vertexColors:VertexColors});LineSegments.call(this,r,n)}function Box3Helper(e,t){this.type="Box3Helper",this.box=e;var r=void 0!==t?t:16776960,n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new BufferGeometry;i.setIndex(new BufferAttribute(n,1)),i.addAttribute("position",new Float32BufferAttribute([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),LineSegments.call(this,i,new LineBasicMaterial({color:r})),this.geometry.computeBoundingSphere()}function BoxHelper(e,t){this.object=e,void 0===t&&(t=16776960);var r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),i=new BufferGeometry;i.setIndex(new BufferAttribute(r,1)),i.addAttribute("position",new BufferAttribute(n,3)),LineSegments.call(this,i,new LineBasicMaterial({color:t})),this.matrixAutoUpdate=!1,this.update()}function CameraHelper(e){var t=new BufferGeometry,r=new LineBasicMaterial({color:16777215,vertexColors:FaceColors}),n=[],i=[],o={},a=new Color(16755200),s=new Color(16711680),l=new Color(43775),u=new Color(16777215),c=new Color(3355443);function h(e,t,r){p(e,r),p(t,r)}function p(e,t){n.push(0,0,0),i.push(t.r,t.g,t.b),void 0===o[e]&&(o[e]=[]),o[e].push(n.length/3-1)}h("n1","n2",a),h("n2","n4",a),h("n4","n3",a),h("n3","n1",a),h("f1","f2",a),h("f2","f4",a),h("f4","f3",a),h("f3","f1",a),h("n1","f1",a),h("n2","f2",a),h("n3","f3",a),h("n4","f4",a),h("p","n1",s),h("p","n2",s),h("p","n3",s),h("p","n4",s),h("u1","u2",l),h("u2","u3",l),h("u3","u1",l),h("c","t",u),h("p","c",c),h("cn1","cn2",c),h("cn3","cn4",c),h("cf1","cf2",c),h("cf3","cf4",c),t.addAttribute("position",new Float32BufferAttribute(n,3)),t.addAttribute("color",new Float32BufferAttribute(i,3)),LineSegments.call(this,t,r),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}function DirectionalLightHelper(e,t,r){Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,void 0===t&&(t=1);var n=new BufferGeometry;n.addAttribute("position",new Float32BufferAttribute([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var i=new LineBasicMaterial({fog:!1});this.lightPlane=new Line(n,i),this.add(this.lightPlane),(n=new BufferGeometry).addAttribute("position",new Float32BufferAttribute([0,0,0,0,0,1],3)),this.targetLine=new Line(n,i),this.add(this.targetLine),this.update()}function FaceNormalsHelper(e,t,r,n){this.object=e,this.size=void 0!==t?t:1;var i=void 0!==r?r:16776960,o=void 0!==n?n:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=s.faces.length:console.warn("FaceNormalsHelper: only Geometry is supported. Use VertexNormalsHelper, instead.");var l=new BufferGeometry,u=new Float32BufferAttribute(2*a*3,3);l.addAttribute("position",u),LineSegments.call(this,l,new LineBasicMaterial({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function GridHelper(e,t,r,n){e=e||10,t=t||10,r=new Color(void 0!==r?r:4473924),n=new Color(void 0!==n?n:8947848);for(var i=t/2,o=e/t,a=e/2,s=[],l=[],u=0,c=0,h=-a;u<=t;u++,h+=o){s.push(-a,0,h,a,0,h),s.push(h,0,-a,h,0,a);var p=u===i?r:n;p.toArray(l,c),c+=3,p.toArray(l,c),c+=3,p.toArray(l,c),c+=3,p.toArray(l,c),c+=3}var f=new BufferGeometry;f.addAttribute("position",new Float32BufferAttribute(s,3)),f.addAttribute("color",new Float32BufferAttribute(l,3));var d=new LineBasicMaterial({vertexColors:VertexColors});LineSegments.call(this,f,d)}function HemisphereLightHelper(e,t,r){Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r;var n=new OctahedronBufferGeometry(t);n.rotateY(.5*Math.PI),this.material=new MeshBasicMaterial({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=VertexColors);var i=n.getAttribute("position"),o=new Float32Array(3*i.count);n.addAttribute("color",new BufferAttribute(o,3)),this.add(new Mesh(n,this.material)),this.update()}function PlaneHelper(e,t,r){this.type="PlaneHelper",this.plane=e,this.size=void 0===t?1:t;var n=void 0!==r?r:16776960,i=new BufferGeometry;i.addAttribute("position",new Float32BufferAttribute([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),Line.call(this,i,new LineBasicMaterial({color:n}));var o=new BufferGeometry;o.addAttribute("position",new Float32BufferAttribute([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),o.computeBoundingSphere(),this.add(new Mesh(o,new MeshBasicMaterial({color:n,opacity:.2,transparent:!0,depthWrite:!1})))}function PointLightHelper(e,t,r){this.light=e,this.light.updateMatrixWorld(),this.color=r;var n=new SphereBufferGeometry(t,4,2),i=new MeshBasicMaterial({wireframe:!0,fog:!1});Mesh.call(this,n,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function PolarGridHelper(e,t,r,n,i,o){e=e||10,t=t||16,r=r||8,n=n||64,i=new Color(void 0!==i?i:4473924),o=new Color(void 0!==o?o:8947848);var a,s,l,u,c,h,p,f=[],d=[];for(u=0;u<=t;u++)l=u/t*(2*Math.PI),a=Math.sin(l)*e,s=Math.cos(l)*e,f.push(0,0,0),f.push(a,0,s),p=1&u?i:o,d.push(p.r,p.g,p.b),d.push(p.r,p.g,p.b);for(u=0;u<=r;u++)for(p=1&u?i:o,h=e-e/r*u,c=0;c<n;c++)l=c/n*(2*Math.PI),a=Math.sin(l)*h,s=Math.cos(l)*h,f.push(a,0,s),d.push(p.r,p.g,p.b),l=(c+1)/n*(2*Math.PI),a=Math.sin(l)*h,s=Math.cos(l)*h,f.push(a,0,s),d.push(p.r,p.g,p.b);var m=new BufferGeometry;m.addAttribute("position",new Float32BufferAttribute(f,3)),m.addAttribute("color",new Float32BufferAttribute(d,3));var v=new LineBasicMaterial({vertexColors:VertexColors});LineSegments.call(this,m,v)}function PositionalAudioHelper(e,t,r,n){this.audio=e,this.range=t||1,this.divisionsInnerAngle=r||16,this.divisionsOuterAngle=n||2;var i=new BufferGeometry,o=this.divisionsInnerAngle+2*this.divisionsOuterAngle,a=new Float32Array(3*(3*o+3));i.addAttribute("position",new BufferAttribute(a,3));var s=new LineBasicMaterial({color:65280}),l=new LineBasicMaterial({color:16776960});Line.call(this,i,[l,s]),this.update()}function RectAreaLightHelper(e,t){this.type="RectAreaLightHelper",this.light=e,this.color=t;var r=new BufferGeometry;r.addAttribute("position",new Float32BufferAttribute([1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),r.computeBoundingSphere();var n=new LineBasicMaterial({fog:!1});Line.call(this,r,n);var i=new BufferGeometry;i.addAttribute("position",new Float32BufferAttribute([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),i.computeBoundingSphere(),this.add(new Mesh(i,new MeshBasicMaterial({side:BackSide,fog:!1}))),this.update()}function SpotLightHelper(e,t){Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;for(var r=new BufferGeometry,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,o=1;i<32;i++,o++){var a=i/32*Math.PI*2,s=o/32*Math.PI*2;n.push(Math.cos(a),Math.sin(a),1,Math.cos(s),Math.sin(s),1)}r.addAttribute("position",new Float32BufferAttribute(n,3));var l=new LineBasicMaterial({fog:!1});this.cone=new LineSegments(r,l),this.add(this.cone),this.update()}function VertexNormalsHelper(e,t,r,n){this.object=e,this.size=void 0!==t?t:1;var i=void 0!==r?r:16711680,o=void 0!==n?n:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=3*s.faces.length:s&&s.isBufferGeometry&&(a=s.attributes.normal.count);var l=new BufferGeometry,u=new Float32BufferAttribute(2*a*3,3);l.addAttribute("position",u),LineSegments.call(this,l,new LineBasicMaterial({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function RectAreaLight(e,t,r,n){Light.call(this,e,t),this.type="RectAreaLight",this.width=void 0!==r?r:10,this.height=void 0!==n?n:10}function AnimationLoader(e){this.manager=void 0!==e?e:DefaultLoadingManager}function AudioLoader(e){this.manager=void 0!==e?e:DefaultLoadingManager}function BufferGeometryLoader(e){this.manager=void 0!==e?e:DefaultLoadingManager}LatheGeometry.prototype=Object.create(Geometry.prototype),LatheGeometry.prototype.constructor=LatheGeometry,LatheBufferGeometry.prototype=Object.create(BufferGeometry.prototype),LatheBufferGeometry.prototype.constructor=LatheBufferGeometry,ParametricGeometry.prototype=Object.create(Geometry.prototype),ParametricGeometry.prototype.constructor=ParametricGeometry,ParametricBufferGeometry.prototype=Object.create(BufferGeometry.prototype),ParametricBufferGeometry.prototype.constructor=ParametricBufferGeometry,RingGeometry.prototype=Object.create(Geometry.prototype),RingGeometry.prototype.constructor=RingGeometry,RingBufferGeometry.prototype=Object.create(BufferGeometry.prototype),RingBufferGeometry.prototype.constructor=RingBufferGeometry,TetrahedronGeometry.prototype=Object.create(Geometry.prototype),TetrahedronGeometry.prototype.constructor=TetrahedronGeometry,TetrahedronBufferGeometry.prototype=Object.create(PolyhedronBufferGeometry.prototype),TetrahedronBufferGeometry.prototype.constructor=TetrahedronBufferGeometry,TextGeometry.prototype=Object.create(Geometry.prototype),TextGeometry.prototype.constructor=TextGeometry,TextBufferGeometry.prototype=Object.create(ExtrudeBufferGeometry.prototype),TextBufferGeometry.prototype.constructor=TextBufferGeometry,TorusKnotGeometry.prototype=Object.create(Geometry.prototype),TorusKnotGeometry.prototype.constructor=TorusKnotGeometry,TorusKnotBufferGeometry.prototype=Object.create(BufferGeometry.prototype),TorusKnotBufferGeometry.prototype.constructor=TorusKnotBufferGeometry,TubeGeometry.prototype=Object.create(Geometry.prototype),TubeGeometry.prototype.constructor=TubeGeometry,TubeBufferGeometry.prototype=Object.create(BufferGeometry.prototype),TubeBufferGeometry.prototype.constructor=TubeBufferGeometry,TubeBufferGeometry.prototype.toJSON=function(){var e=BufferGeometry.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e},ArrowHelper.prototype=Object.create(Object3D.prototype),ArrowHelper.prototype.constructor=ArrowHelper,ArrowHelper.prototype.setDirection=function(){var e,t=new Vector3;return function(r){r.y>.99999?this.quaternion.set(0,0,0,1):r.y<-.99999?this.quaternion.set(1,0,0,0):(t.set(r.z,0,-r.x).normalize(),e=Math.acos(r.y),this.quaternion.setFromAxisAngle(t,e))}}(),ArrowHelper.prototype.setLength=function(e,t,r){void 0===t&&(t=.2*e),void 0===r&&(r=.2*t),this.line.scale.set(1,Math.max(0,e-t),1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()},ArrowHelper.prototype.setColor=function(e){this.line.material.color.copy(e),this.cone.material.color.copy(e)},ArrowHelper.prototype.copy=function(e){return Object3D.prototype.copy.call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this},ArrowHelper.prototype.clone=function(){return(new this.constructor).copy(this)},AxesHelper.prototype=Object.create(LineSegments.prototype),AxesHelper.prototype.constructor=AxesHelper,Box3Helper.prototype=Object.create(LineSegments.prototype),Box3Helper.prototype.constructor=Box3Helper,Box3Helper.prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),Object3D.prototype.updateMatrixWorld.call(this,e))},BoxHelper.prototype=Object.create(LineSegments.prototype),BoxHelper.prototype.constructor=BoxHelper,BoxHelper.prototype.update=function(){var e=new Box3;return function(t){if(void 0!==t&&console.warn("BoxHelper: .update() has no longer arguments."),void 0!==this.object&&e.setFromObject(this.object),!e.isEmpty()){var r=e.min,n=e.max,i=this.geometry.attributes.position,o=i.array;o[0]=n.x,o[1]=n.y,o[2]=n.z,o[3]=r.x,o[4]=n.y,o[5]=n.z,o[6]=r.x,o[7]=r.y,o[8]=n.z,o[9]=n.x,o[10]=r.y,o[11]=n.z,o[12]=n.x,o[13]=n.y,o[14]=r.z,o[15]=r.x,o[16]=n.y,o[17]=r.z,o[18]=r.x,o[19]=r.y,o[20]=r.z,o[21]=n.x,o[22]=r.y,o[23]=r.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),BoxHelper.prototype.setFromObject=function(e){return this.object=e,this.update(),this},BoxHelper.prototype.copy=function(e){return LineSegments.prototype.copy.call(this,e),this.object=e.object,this},BoxHelper.prototype.clone=function(){return(new this.constructor).copy(this)},CameraHelper.prototype=Object.create(LineSegments.prototype),CameraHelper.prototype.constructor=CameraHelper,CameraHelper.prototype.update=function(){var e,t,r=new Vector3,n=new Camera;function i(i,o,a,s){r.set(o,a,s).unproject(n);var l=t[i];if(void 0!==l)for(var u=e.getAttribute("position"),c=0,h=l.length;c<h;c++)u.setXYZ(l[c],r.x,r.y,r.z)}return function(){e=this.geometry,t=this.pointMap;n.projectionMatrix.copy(this.camera.projectionMatrix),i("c",0,0,-1),i("t",0,0,1),i("n1",-1,-1,-1),i("n2",1,-1,-1),i("n3",-1,1,-1),i("n4",1,1,-1),i("f1",-1,-1,1),i("f2",1,-1,1),i("f3",-1,1,1),i("f4",1,1,1),i("u1",.7,1.1,-1),i("u2",-.7,1.1,-1),i("u3",0,2,-1),i("cf1",-1,0,1),i("cf2",1,0,1),i("cf3",0,-1,1),i("cf4",0,1,1),i("cn1",-1,0,-1),i("cn2",1,0,-1),i("cn3",0,-1,-1),i("cn4",0,1,-1),e.getAttribute("position").needsUpdate=!0}}(),DirectionalLightHelper.prototype=Object.create(Object3D.prototype),DirectionalLightHelper.prototype.constructor=DirectionalLightHelper,DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},DirectionalLightHelper.prototype.update=function(){var e=new Vector3,t=new Vector3,r=new Vector3;return function(){e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),r.subVectors(t,e),this.lightPlane.lookAt(t),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(t),this.targetLine.scale.z=r.length()}}(),FaceNormalsHelper.prototype=Object.create(LineSegments.prototype),FaceNormalsHelper.prototype.constructor=FaceNormalsHelper,FaceNormalsHelper.prototype.update=function(){var e=new Vector3,t=new Vector3,r=new Matrix3;return function(){this.object.updateMatrixWorld(!0),r.getNormalMatrix(this.object.matrixWorld);for(var n=this.object.matrixWorld,i=this.geometry.attributes.position,o=this.object.geometry,a=o.vertices,s=o.faces,l=0,u=0,c=s.length;u<c;u++){var h=s[u],p=h.normal;e.copy(a[h.a]).add(a[h.b]).add(a[h.c]).divideScalar(3).applyMatrix4(n),t.copy(p).applyMatrix3(r).normalize().multiplyScalar(this.size).add(e),i.setXYZ(l,e.x,e.y,e.z),l+=1,i.setXYZ(l,t.x,t.y,t.z),l+=1}i.needsUpdate=!0}}(),GridHelper.prototype=Object.create(LineSegments.prototype),GridHelper.prototype.constructor=GridHelper,HemisphereLightHelper.prototype=Object.create(Object3D.prototype),HemisphereLightHelper.prototype.constructor=HemisphereLightHelper,HemisphereLightHelper.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},HemisphereLightHelper.prototype.update=function(){var e=new Vector3,t=new Color,r=new Color;return function(){var n=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var i=n.geometry.getAttribute("color");t.copy(this.light.color),r.copy(this.light.groundColor);for(var o=0,a=i.count;o<a;o++){var s=o<a/2?t:r;i.setXYZ(o,s.r,s.g,s.b)}i.needsUpdate=!0}n.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),PlaneHelper.prototype=Object.create(Line.prototype),PlaneHelper.prototype.constructor=PlaneHelper,PlaneHelper.prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?BackSide:FrontSide,this.lookAt(this.plane.normal),Object3D.prototype.updateMatrixWorld.call(this,e)},PointLightHelper.prototype=Object.create(Mesh.prototype),PointLightHelper.prototype.constructor=PointLightHelper,PointLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},PointLightHelper.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},PolarGridHelper.prototype=Object.create(LineSegments.prototype),PolarGridHelper.prototype.constructor=PolarGridHelper,PositionalAudioHelper.prototype=Object.create(Line.prototype),PositionalAudioHelper.prototype.constructor=PositionalAudioHelper,PositionalAudioHelper.prototype.update=function(){var e,t,r=this.audio,n=this.range,i=this.divisionsInnerAngle,o=this.divisionsOuterAngle,a=_Math.degToRad(r.panner.coneInnerAngle),s=_Math.degToRad(r.panner.coneOuterAngle),l=a/2,u=s/2,c=0,h=0,p=this.geometry,f=p.attributes.position;function d(r,i,o,a){var s=(i-r)/o;for(f.setXYZ(c,0,0,0),h++,e=r;e<i;e+=s)t=c+h,f.setXYZ(t,Math.sin(e)*n,0,Math.cos(e)*n),f.setXYZ(t+1,Math.sin(Math.min(e+s,i))*n,0,Math.cos(Math.min(e+s,i))*n),f.setXYZ(t+2,0,0,0),h+=3;p.addGroup(c,h,a),c+=h,h=0}p.clearGroups(),d(-u,-l,o,0),d(-l,l,i,1),d(l,u,o,0),f.needsUpdate=!0,a===s&&(this.material[0].visible=!1)},PositionalAudioHelper.prototype.dispose=function(){this.geometry.dispose(),this.material[0].dispose(),this.material[1].dispose()},RectAreaLightHelper.prototype=Object.create(Line.prototype),RectAreaLightHelper.prototype.constructor=RectAreaLightHelper,RectAreaLightHelper.prototype.update=function(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),void 0!==this.color)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);var e=this.material.color,t=Math.max(e.r,e.g,e.b);t>1&&e.multiplyScalar(1/t),this.children[0].material.color.copy(this.material.color)}},RectAreaLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()},SpotLightHelper.prototype=Object.create(Object3D.prototype),SpotLightHelper.prototype.constructor=SpotLightHelper,SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},SpotLightHelper.prototype.update=function(){var e=new Vector3;return function(){this.light.updateMatrixWorld();var t=this.light.distance?this.light.distance:1e3,r=t*Math.tan(this.light.angle);this.cone.scale.set(r,r,t),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}(),VertexNormalsHelper.prototype=Object.create(LineSegments.prototype),VertexNormalsHelper.prototype.constructor=VertexNormalsHelper,VertexNormalsHelper.prototype.update=function(){var e=new Vector3,t=new Vector3,r=new Matrix3;return function(){var n=["a","b","c"];this.object.updateMatrixWorld(!0),r.getNormalMatrix(this.object.matrixWorld);var i=this.object.matrixWorld,o=this.geometry.attributes.position,a=this.object.geometry;if(a&&a.isGeometry)for(var s=a.vertices,l=a.faces,u=0,c=0,h=l.length;c<h;c++)for(var p=l[c],f=0,d=p.vertexNormals.length;f<d;f++){var m=s[p[n[f]]],v=p.vertexNormals[f];e.copy(m).applyMatrix4(i),t.copy(v).applyMatrix3(r).normalize().multiplyScalar(this.size).add(e),o.setXYZ(u,e.x,e.y,e.z),u+=1,o.setXYZ(u,t.x,t.y,t.z),u+=1}else if(a&&a.isBufferGeometry){var g=a.attributes.position,y=a.attributes.normal;for(u=0,f=0,d=g.count;f<d;f++)e.set(g.getX(f),g.getY(f),g.getZ(f)).applyMatrix4(i),t.set(y.getX(f),y.getY(f),y.getZ(f)),t.applyMatrix3(r).normalize().multiplyScalar(this.size).add(e),o.setXYZ(u,e.x,e.y,e.z),u+=1,o.setXYZ(u,t.x,t.y,t.z),u+=1}o.needsUpdate=!0}}(),RectAreaLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:RectAreaLight,isRectAreaLight:!0,copy:function(e){return Light.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=Light.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}),Object.assign(AnimationLoader.prototype,{load:function(e,t,r,n){var i=this,o=new FileLoader(i.manager);o.setPath(i.path),o.load(e,function(e){t(i.parse(JSON.parse(e)))},r,n)},parse:function(e,t){for(var r=[],n=0;n<e.length;n++){var i=AnimationClip.parse(e[n]);r.push(i)}t(r)},setPath:function(e){return this.path=e,this}}),Object.assign(AudioLoader.prototype,{load:function(e,t,r,n){var i=new FileLoader(this.manager);i.setResponseType("arraybuffer"),i.setPath(this.path),i.load(e,function(e){var r=e.slice(0);AudioContext.getContext().decodeAudioData(r,function(e){t(e)})},r,n)},setPath:function(e){return this.path=e,this}}),Object.assign(BufferGeometryLoader.prototype,{load:function(e,t,r,n){var i=this,o=new FileLoader(i.manager);o.setPath(i.path),o.load(e,function(e){t(i.parse(JSON.parse(e)))},r,n)},parse:function(e){var t=new BufferGeometry,r=e.data.index;if(void 0!==r){var n=new TYPED_ARRAYS[r.type](r.array);t.setIndex(new BufferAttribute(n,1))}var i=e.data.attributes;for(var o in i){var a=i[o],s=new BufferAttribute(n=new TYPED_ARRAYS[a.type](a.array),a.itemSize,a.normalized);void 0!==a.name&&(s.name=a.name),t.addAttribute(o,s)}var l=e.data.morphAttributes;if(l)for(var o in l){for(var u=l[o],c=[],h=0,p=u.length;h<p;h++){a=u[h],s=new BufferAttribute(n=new TYPED_ARRAYS[a.type](a.array),a.itemSize,a.normalized);void 0!==a.name&&(s.name=a.name),c.push(s)}t.morphAttributes[o]=c}var f=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==f){h=0;for(var d=f.length;h!==d;++h){var m=f[h];t.addGroup(m.start,m.count,m.materialIndex)}}var v=e.data.boundingSphere;if(void 0!==v){var g=new Vector3;void 0!==v.center&&g.fromArray(v.center),t.boundingSphere=new Sphere(g,v.radius)}return e.name&&(t.name=e.name),e.userData&&(t.userData=e.userData),t},setPath:function(e){return this.path=e,this}});var TYPED_ARRAYS={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!==typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function CubeTextureLoader(e){this.manager=void 0!==e?e:DefaultLoadingManager}function FontLoader(e){this.manager=void 0!==e?e:DefaultLoadingManager}function ImageBitmapLoader(e){"undefined"===typeof createImageBitmap&&console.warn("ImageBitmapLoader: createImageBitmap() not supported."),"undefined"===typeof fetch&&console.warn("ImageBitmapLoader: fetch() not supported."),this.manager=void 0!==e?e:DefaultLoadingManager,this.options=void 0}function LOD(){Object3D.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function Fog(e,t,r){this.name="",this.color=new Color(e),this.near=void 0!==t?t:1,this.far=void 0!==r?r:1e3}function FogExp2(e,t){this.name="",this.color=new Color(e),this.density=void 0!==t?t:25e-5}Object.assign(CubeTextureLoader.prototype,{crossOrigin:"anonymous",load:function(e,t,r,n){var i=new CubeTexture,o=new ImageLoader(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;function s(r){o.load(e[r],function(e){i.images[r]=e,6===++a&&(i.needsUpdate=!0,t&&t(i))},void 0,n)}for(var l=0;l<e.length;++l)s(l);return i},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(FontLoader.prototype,{load:function(e,t,r,n){var i=this,o=new FileLoader(this.manager);o.setPath(this.path),o.load(e,function(e){var r;try{r=JSON.parse(e)}catch(o){console.warn("FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),r=JSON.parse(e.substring(65,e.length-2))}var n=i.parse(r);t&&t(n)},r,n)},parse:function(e){return new Font(e)},setPath:function(e){return this.path=e,this}}),ImageBitmapLoader.prototype={constructor:ImageBitmapLoader,setOptions:function(e){return this.options=e,this},load:function(e,t,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=Cache.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout(function(){t&&t(o),i.manager.itemEnd(e)},0),o;fetch(e).then(function(e){return e.blob()}).then(function(e){return createImageBitmap(e,i.options)}).then(function(r){Cache.add(e,r),t&&t(r),i.manager.itemEnd(e)}).catch(function(t){n&&n(t),i.manager.itemError(e),i.manager.itemEnd(e)}),i.manager.itemStart(e)},setCrossOrigin:function(){return this},setPath:function(e){return this.path=e,this}},LOD.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:LOD,copy:function(e){Object3D.prototype.copy.call(this,e,!1);for(var t=e.levels,r=0,n=t.length;r<n;r++){var i=t[r];this.addLevel(i.object.clone(),i.distance)}return this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var r=this.levels,n=0;n<r.length&&!(t<r[n].distance);n++);r.splice(n,0,{distance:t,object:e}),this.add(e)},getObjectForDistance:function(e){for(var t=this.levels,r=1,n=t.length;r<n&&!(e<t[r].distance);r++);return t[r-1].object},raycast:function(){var e=new Vector3;return function(t,r){e.setFromMatrixPosition(this.matrixWorld);var n=t.ray.origin.distanceTo(e);this.getObjectForDistance(n).raycast(t,r)}}(),update:function(){var e=new Vector3,t=new Vector3;return function(r){var n=this.levels;if(n.length>1){e.setFromMatrixPosition(r.matrixWorld),t.setFromMatrixPosition(this.matrixWorld);var i=e.distanceTo(t);n[0].object.visible=!0;for(var o=1,a=n.length;o<a&&i>=n[o].distance;o++)n[o-1].object.visible=!1,n[o].object.visible=!0;for(;o<a;o++)n[o].object.visible=!1}}}(),toJSON:function(e){var t=Object3D.prototype.toJSON.call(this,e);t.object.levels=[];for(var r=this.levels,n=0,i=r.length;n<i;n++){var o=r[n];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}),Object.assign(Fog.prototype,{isFog:!0,clone:function(){return new Fog(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.assign(FogExp2.prototype,{isFogExp2:!0,clone:function(){return new FogExp2(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}});var Geometries={WireframeGeometry:WireframeGeometry,TetrahedronGeometry:TetrahedronGeometry,TetrahedronBufferGeometry:TetrahedronBufferGeometry,OctahedronGeometry:OctahedronGeometry,OctahedronBufferGeometry:OctahedronBufferGeometry,IcosahedronGeometry:IcosahedronGeometry,IcosahedronBufferGeometry:IcosahedronBufferGeometry,DodecahedronGeometry:DodecahedronGeometry,DodecahedronBufferGeometry:DodecahedronBufferGeometry,PolyhedronGeometry:PolyhedronGeometry,PolyhedronBufferGeometry:PolyhedronBufferGeometry,TubeGeometry:TubeGeometry,TubeBufferGeometry:TubeBufferGeometry,TorusKnotGeometry:TorusKnotGeometry,TorusGeometry:TorusGeometry,TorusBufferGeometry:TorusBufferGeometry,TextGeometry:TextGeometry,TextBufferGeometry:TextBufferGeometry,SphereGeometry:SphereGeometry,SphereBufferGeometry:SphereBufferGeometry,RingGeometry:RingGeometry,RingBufferGeometry:RingBufferGeometry,PlaneGeometry:PlaneGeometry,PlaneBufferGeometry:PlaneBufferGeometry,LatheGeometry:LatheGeometry,LatheBufferGeometry:LatheBufferGeometry,ShapeGeometry:ShapeGeometry,ShapeBufferGeometry:ShapeBufferGeometry,ExtrudeGeometry:ExtrudeGeometry,ExtrudeBufferGeometry:ExtrudeBufferGeometry,EdgesGeometry:EdgesGeometry,ConeGeometry:ConeGeometry,ConeBufferGeometry:ConeBufferGeometry,CylinderGeometry:CylinderGeometry,CylinderBufferGeometry:CylinderBufferGeometry,CircleGeometry:CircleGeometry,CircleBufferGeometry:CircleBufferGeometry,BoxGeometry:BoxGeometry,BoxBufferGeometry:BoxBufferGeometry};function ObjectLoader(e){this.manager=void 0!==e?e:DefaultLoadingManager,this.resourcePath=""}Object.assign(ObjectLoader.prototype,{crossOrigin:"anonymous",load:function(e,t,r,n){var i=this,o=void 0===this.path?LoaderUtils.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;var a=new FileLoader(i.manager);a.setPath(this.path),a.load(e,function(r){var o=null;try{o=JSON.parse(r)}catch(s){return void 0!==n&&n(s),void console.error("THREE:ObjectLoader: Can't parse "+e+".",s.message)}var a=o.metadata;void 0!==a&&void 0!==a.type&&"geometry"!==a.type.toLowerCase()?i.parse(o,t):console.error("ObjectLoader: Can't load "+e)},r,n)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,t){var r=this.parseShape(e.shapes),n=this.parseGeometries(e.geometries,r),i=this.parseImages(e.images,function(){void 0!==t&&t(s)}),o=this.parseTextures(e.textures,i),a=this.parseMaterials(e.materials,o),s=this.parseObject(e.object,n,a);return e.animations&&(s.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(s),s},parseShape:function(e){var t={};if(void 0!==e)for(var r=0,n=e.length;r<n;r++){var i=(new Shape).fromJSON(e[r]);t[i.uuid]=i}return t},parseGeometries:function(e,t){var r={};if(void 0!==e)for(var n=new BufferGeometryLoader,i=0,o=e.length;i<o;i++){var a,s=e[i];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new Geometries[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new Geometries[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new Geometries[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new Geometries[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":a=new Geometries[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new Geometries[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":a=new Geometries[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new Geometries[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new Geometries[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new Geometries[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":a=new Geometries[s.type]((new Curves[s.path.type]).fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":a=new Geometries[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":a=new Geometries[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var l=[],u=0,c=s.shapes.length;u<c;u++){var h=t[s.shapes[u]];l.push(h)}a=new Geometries[s.type](l,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(l=[],u=0,c=s.shapes.length;u<c;u++){h=t[s.shapes[u]];l.push(h)}var p=s.options.extrudePath;void 0!==p&&(s.options.extrudePath=(new Curves[p.type]).fromJSON(p)),a=new Geometries[s.type](l,s.options);break;case"BufferGeometry":a=n.parse(s);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE)a=(new LegacyJSONLoader).parse(s,this.resourcePath).geometry;else console.error('ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:console.warn('ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),!0===a.isBufferGeometry&&void 0!==s.userData&&(a.userData=s.userData),r[s.uuid]=a}return r},parseMaterials:function(e,t){var r={},n={};if(void 0!==e){var i=new MaterialLoader;i.setTextures(t);for(var o=0,a=e.length;o<a;o++){var s=e[o];if("MultiMaterial"===s.type){for(var l=[],u=0;u<s.materials.length;u++){var c=s.materials[u];void 0===r[c.uuid]&&(r[c.uuid]=i.parse(c)),l.push(r[c.uuid])}n[s.uuid]=l}else void 0===r[s.uuid]&&(r[s.uuid]=i.parse(s)),n[s.uuid]=r[s.uuid]}}return n},parseAnimations:function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r],i=AnimationClip.parse(n);void 0!==n.uuid&&(i.uuid=n.uuid),t.push(i)}return t},parseImages:function(e,t){var r=this,n={};function i(e){return r.manager.itemStart(e),o.load(e,function(){r.manager.itemEnd(e)},void 0,function(){r.manager.itemError(e),r.manager.itemEnd(e)})}if(void 0!==e&&e.length>0){var o=new ImageLoader(new LoadingManager(t));o.setCrossOrigin(this.crossOrigin);for(var a=0,s=e.length;a<s;a++){var l=e[a],u=l.url;if(Array.isArray(u)){n[l.uuid]=[];for(var c=0,h=u.length;c<h;c++){var p=u[c],f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(p)?p:r.resourcePath+p;n[l.uuid].push(i(f))}}else{f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l.url)?l.url:r.resourcePath+l.url;n[l.uuid]=i(f)}}}return n},parseTextures:function(e,t){function r(e,t){return"number"===typeof e?e:(console.warn("ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var n={};if(void 0!==e)for(var i=0,o=e.length;i<o;i++){var a,s=e[i];void 0===s.image&&console.warn('ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&console.warn("ObjectLoader: Undefined image",s.image),(a=Array.isArray(t[s.image])?new CubeTexture(t[s.image]):new Texture(t[s.image])).needsUpdate=!0,a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),void 0!==s.mapping&&(a.mapping=r(s.mapping,TEXTURE_MAPPING)),void 0!==s.offset&&a.offset.fromArray(s.offset),void 0!==s.repeat&&a.repeat.fromArray(s.repeat),void 0!==s.center&&a.center.fromArray(s.center),void 0!==s.rotation&&(a.rotation=s.rotation),void 0!==s.wrap&&(a.wrapS=r(s.wrap[0],TEXTURE_WRAPPING),a.wrapT=r(s.wrap[1],TEXTURE_WRAPPING)),void 0!==s.format&&(a.format=s.format),void 0!==s.type&&(a.type=s.type),void 0!==s.encoding&&(a.encoding=s.encoding),void 0!==s.minFilter&&(a.minFilter=r(s.minFilter,TEXTURE_FILTER)),void 0!==s.magFilter&&(a.magFilter=r(s.magFilter,TEXTURE_FILTER)),void 0!==s.anisotropy&&(a.anisotropy=s.anisotropy),void 0!==s.flipY&&(a.flipY=s.flipY),void 0!==s.premultiplyAlpha&&(a.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(a.unpackAlignment=s.unpackAlignment),n[s.uuid]=a}return n},parseObject:function(e,t,r){var n;function i(e){return void 0===t[e]&&console.warn("ObjectLoader: Undefined geometry",e),t[e]}function o(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],n=0,i=e.length;n<i;n++){var o=e[n];void 0===r[o]&&console.warn("ObjectLoader: Undefined material",o),t.push(r[o])}return t}return void 0===r[e]&&console.warn("ObjectLoader: Undefined material",e),r[e]}}switch(e.type){case"Scene":n=new Scene,void 0!==e.background&&Number.isInteger(e.background)&&(n.background=new Color(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?n.fog=new Fog(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(n.fog=new FogExp2(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":n=new PerspectiveCamera(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(n.focus=e.focus),void 0!==e.zoom&&(n.zoom=e.zoom),void 0!==e.filmGauge&&(n.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(n.filmOffset=e.filmOffset),void 0!==e.view&&(n.view=Object.assign({},e.view));break;case"OrthographicCamera":n=new OrthographicCamera(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(n.zoom=e.zoom),void 0!==e.view&&(n.view=Object.assign({},e.view));break;case"AmbientLight":n=new AmbientLight(e.color,e.intensity);break;case"DirectionalLight":n=new DirectionalLight(e.color,e.intensity);break;case"PointLight":n=new PointLight(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":n=new RectAreaLight(e.color,e.intensity,e.width,e.height);break;case"SpotLight":n=new SpotLight(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":n=new HemisphereLight(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var a=i(e.geometry),s=o(e.material);n=a.bones&&a.bones.length>0?new SkinnedMesh(a,s):new Mesh(a,s),void 0!==e.drawMode&&n.setDrawMode(e.drawMode);break;case"LOD":n=new LOD;break;case"Line":n=new Line(i(e.geometry),o(e.material),e.mode);break;case"LineLoop":n=new LineLoop(i(e.geometry),o(e.material));break;case"LineSegments":n=new LineSegments(i(e.geometry),o(e.material));break;case"PointCloud":case"Points":n=new Points(i(e.geometry),o(e.material));break;case"Sprite":n=new Sprite(o(e.material));break;case"Group":n=new Group;break;default:n=new Object3D}if(n.uuid=e.uuid,void 0!==e.name&&(n.name=e.name),void 0!==e.matrix?(n.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(n.matrixAutoUpdate=e.matrixAutoUpdate),n.matrixAutoUpdate&&n.matrix.decompose(n.position,n.quaternion,n.scale)):(void 0!==e.position&&n.position.fromArray(e.position),void 0!==e.rotation&&n.rotation.fromArray(e.rotation),void 0!==e.quaternion&&n.quaternion.fromArray(e.quaternion),void 0!==e.scale&&n.scale.fromArray(e.scale)),void 0!==e.castShadow&&(n.castShadow=e.castShadow),void 0!==e.receiveShadow&&(n.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(n.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(n.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&n.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(n.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(n.visible=e.visible),void 0!==e.frustumCulled&&(n.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(n.renderOrder=e.renderOrder),void 0!==e.userData&&(n.userData=e.userData),void 0!==e.layers&&(n.layers.mask=e.layers),void 0!==e.children)for(var l=e.children,u=0;u<l.length;u++)n.add(this.parseObject(l[u],t,r));if("LOD"===e.type)for(var c=e.levels,h=0;h<c.length;h++){var p=c[h],f=n.getObjectByProperty("uuid",p.object);void 0!==f&&n.addLevel(f,p.distance)}return n}});var TEXTURE_MAPPING={UVMapping:UVMapping,CubeReflectionMapping:CubeReflectionMapping,CubeRefractionMapping:CubeRefractionMapping,EquirectangularReflectionMapping:EquirectangularReflectionMapping,EquirectangularRefractionMapping:EquirectangularRefractionMapping,SphericalReflectionMapping:SphericalReflectionMapping,CubeUVReflectionMapping:CubeUVReflectionMapping,CubeUVRefractionMapping:CubeUVRefractionMapping},TEXTURE_WRAPPING={RepeatWrapping:RepeatWrapping,ClampToEdgeWrapping:ClampToEdgeWrapping,MirroredRepeatWrapping:MirroredRepeatWrapping},TEXTURE_FILTER={NearestFilter:NearestFilter,NearestMipMapNearestFilter:NearestMipMapNearestFilter,NearestMipMapLinearFilter:NearestMipMapLinearFilter,LinearFilter:LinearFilter,LinearMipMapNearestFilter:LinearMipMapNearestFilter,LinearMipMapLinearFilter:LinearMipMapLinearFilter};function MeshMatcapMaterial(e){Material$1.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Color(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.lights=!1,this.setValues(e)}function Cylindrical(e,t,r){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==r?r:0,this}function WebGL2Renderer(e){console.log("WebGL2Renderer",REVISION);var t,r=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==e.context?e.context:null,i=void 0!==e.alpha&&e.alpha,o=void 0===e.depth||e.depth,a=void 0===e.stencil||e.stencil,s=void 0!==e.antialias&&e.antialias,l=void 0===e.premultipliedAlpha||e.premultipliedAlpha,u=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,c=void 0!==e.powerPreference?e.powerPreference:"default";try{var h={alpha:i,depth:o,stencil:a,antialias:s,premultipliedAlpha:l,preserveDrawingBuffer:u,powerPreference:c};if(r.addEventListener("webglcontextlost",function(e){e.preventDefault()},!1),r.addEventListener("webglcontextrestored",function(){}),null===(t=n||r.getContext("webgl2",h)))throw null!==r.getContext("webgl2")?new Error("Error creating WebGL2 context with your selected attributes."):new Error("Error creating WebGL2 context.")}catch(_){console.error("WebGL2Renderer: "+_.message)}var p=!0,f=!0,d=!0,m=new Color(0),v=0,g=r.width,y=r.height,b=1,x=new Vector4(0,0,g,y),w=new WebGLExtensions(t),S=new WebGLState(t,w,function(){});function M(e,t,n){g=e,y=t,r.width=e*b,r.height=t*b,!1!==n&&(r.style.width=e+"px",r.style.height=t+"px"),function(e,t,r,n){S.viewport(x.set(e,t,r,n))}(0,0,e,t)}return{domElement:r,clear:function(e,r,n){var i=0;(void 0===e||e)&&(i|=t.COLOR_BUFFER_BIT),(void 0===r||r)&&(i|=t.DEPTH_BUFFER_BIT),(void 0===n||n)&&(i|=t.STENCIL_BUFFER_BIT),t.clear(i)},setPixelRatio:function(e){void 0!==e&&(b=e,M(x.z,x.w,!1))},setSize:M,render:function(e,t){if(void 0===t||!0===t.isCamera){var r=e.background;null===r?S.buffers.color.setClear(m.r,m.g,m.b,v,l):r&&r.isColor&&S.buffers.color.setClear(r.r,r.g,r.b,1,l),this.clear(p,f,d)}else console.error("WebGL2Renderer.render: camera is not an instance of Camera.")}}}function WebGLMultisampleRenderTarget(e,t,r){WebGLRenderTarget.call(this,e,t,r),this.samples=4}function VideoTexture(e,t,r,n,i,o,a,s,l){Texture.call(this,e,t,r,n,i,o,a,s,l),this.format=void 0!==a?a:RGBFormat,this.minFilter=void 0!==o?o:LinearFilter,this.magFilter=void 0!==i?i:LinearFilter,this.generateMipmaps=!1}MeshMatcapMaterial.prototype=Object.create(Material$1.prototype),MeshMatcapMaterial.prototype.constructor=MeshMatcapMaterial,MeshMatcapMaterial.prototype.isMeshMatcapMaterial=!0,MeshMatcapMaterial.prototype.copy=function(e){return Material$1.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Object.assign(Cylindrical.prototype,{set:function(e,t,r){return this.radius=e,this.theta=t,this.y=r,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,r){return this.radius=Math.sqrt(e*e+r*r),this.theta=Math.atan2(e,r),this.y=t,this}}),WebGLMultisampleRenderTarget.prototype=Object.assign(Object.create(WebGLRenderTarget.prototype),{constructor:WebGLMultisampleRenderTarget,isWebGLMultisampleRenderTarget:!0,copy:function(e){return WebGLRenderTarget.prototype.copy.call(this,e),this.samples=e.samples,this}}),VideoTexture.prototype=Object.assign(Object.create(Texture.prototype),{constructor:VideoTexture,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}})},function(e,t,r){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,r){"use strict";t.__esModule=!0;var n=a(r(416)),i=a(r(420)),o=a(r(121));function a(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"===typeof t?"undefined":(0,o.default)(t)));e.prototype=(0,i.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(n.default?(0,n.default)(e,t):e.__proto__=t)}},function(e,t,r){"use strict";function n(e){return e.charAt(0).toUpperCase()+e.slice(1)}function i(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce(function(e,t){return null==t?e:function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n),t.apply(this,n)}},function(){})}r.d(t,"a",function(){return n}),r.d(t,"b",function(){return i})},function(e,t,r){"use strict";e.exports=function(e,t,r,n,i,o,a,s){if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[r,n,i,o,a,s],c=0;(l=new Error(t.replace(/%s/g,function(){return u[c++]}))).name="Invariant Violation"}throw l.framesToPop=1,l}}},function(e,t,r){e.exports=r(450)()},function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,"a",function(){return n})},function(e,t,r){"use strict";var n=r(1),i=r(9),o=r(10),a=r.n(o),s=r(0),l=r.n(s),u=r(17),c=["xl","lg","md","sm","xs"],h=l.a.forwardRef(function(e,t){var r=e.bsPrefix,o=e.className,s=e.as,h=void 0===s?"div":s,p=Object(i.a)(e,["bsPrefix","className","as"]),f=Object(u.a)(r,"col"),d=[],m=[];return c.forEach(function(e){var t,r,n,i=p[e];if(delete p[e],null!=i&&"object"===typeof i){var o=i.span;t=void 0===o||o,r=i.offset,n=i.order}else t=i;var a="xs"!==e?"-"+e:"";null!=t&&d.push(!0===t?""+f+a:""+f+a+"-"+t),null!=n&&m.push("order"+a+"-"+n),null!=r&&m.push("offset"+a+"-"+r)}),d.length||d.push(f),l.a.createElement(h,Object(n.a)({},p,{ref:t,className:a.a.apply(void 0,[o].concat(d,m))}))});h.displayName="Col",t.a=h},function(e,t,r){"use strict";r.d(t,"b",function(){return o});var n=r(5),i={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},o={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195},a=function(e){return"".concat(Math.round(e),"ms")};t.a={easing:i,duration:o,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.duration,s=void 0===r?o.standard:r,l=t.easing,u=void 0===l?i.easeInOut:l,c=t.delay,h=void 0===c?0:c;Object(n.a)(t,["duration","easing","delay"]);return(Array.isArray(e)?e:[e]).map(function(e){return"".concat(e," ").concat("string"===typeof s?s:a(s)," ").concat(u," ").concat("string"===typeof h?h:a(h))}).join(",")},getAutoHeightDuration:function(e){if(!e)return 0;var t=e/36;return Math.round(10*(4+15*Math.pow(t,.25)+t/5))}}},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(24);function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},i=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),i.forEach(function(t){Object(n.a)(e,t,r[t])})}return e}},function(e,t,r){"use strict";t.__esModule=!0;var n,i=r(202),o=(n=i)&&n.__esModule?n:{default:n};t.default=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,o.default)(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}()},function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,"a",function(){return n})},function(e,t,r){"use strict";r.d(t,"b",function(){return n}),r.d(t,"c",function(){return i}),r.d(t,"a",function(){return o});var n="@@router/LOCATION_CHANGE",i=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{type:n,payload:{location:e,action:t,isFirstRendering:r}}},o="@@router/CALL_HISTORY_METHOD",a=function(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return{type:o,payload:{method:e,args:r}}}};a("push"),a("replace"),a("go"),a("goBack"),a("goForward")},function(e,t,r){e.exports=r(448)()},,function(e,t,r){"use strict";r.d(t,"b",function(){return n}),r.d(t,"a",function(){return i});var n=function(e){return e.scrollTop};function i(e,t){var r=e.timeout,n=e.style,i=void 0===n?{}:n;return{duration:i.transitionDuration||"number"===typeof r?r:r[t.mode]||0,delay:i.transitionDelay}}},function(e,t,r){"use strict";function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e<t?t:e>r?r:e}function i(e){if(e.type)return e;if("#"===e.charAt(0))return i(function(e){e=e.substr(1);var t=new RegExp(".{1,".concat(e.length/3,"}"),"g"),r=e.match(t);return r&&1===r[0].length&&(r=r.map(function(e){return e+e})),r?"rgb(".concat(r.map(function(e){return parseInt(e,16)}).join(", "),")"):""}(e));var t=e.indexOf("("),r=e.substring(0,t);if(-1===["rgb","rgba","hsl","hsla"].indexOf(r))throw new Error(["Material-UI: unsupported `".concat(e,"` color."),"We support the following formats: #nnn, #nnnnnn, rgb(), rgba(), hsl(), hsla()."].join("\n"));var n=e.substring(t+1,e.length-1).split(",");return{type:r,values:n=n.map(function(e){return parseFloat(e)})}}function o(e){var t=e.type,r=e.values;return-1!==t.indexOf("rgb")?r=r.map(function(e,t){return t<3?parseInt(e,10):e}):-1!==t.indexOf("hsl")&&(r[1]="".concat(r[1],"%"),r[2]="".concat(r[2],"%")),"".concat(t,"(").concat(r.join(", "),")")}function a(e,t){var r=s(e),n=s(t);return(Math.max(r,n)+.05)/(Math.min(r,n)+.05)}function s(e){var t="hsl"===(e=i(e)).type?i(function(e){var t=(e=i(e)).values,r=t[0],n=t[1]/100,a=t[2]/100,s=n*Math.min(a,1-a),l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e+r/30)%12;return a-s*Math.max(Math.min(t-3,9-t,1),-1)},u="rgb",c=[Math.round(255*l(0)),Math.round(255*l(8)),Math.round(255*l(4))];return"hsla"===e.type&&(u+="a",c.push(t[3])),o({type:u,values:c})}(e)).values:e.values;return t=t.map(function(e){return(e/=255)<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.15;return s(e)>.5?c(e,t):h(e,t)}function u(e,t){return e=i(e),t=n(t),"rgb"!==e.type&&"hsl"!==e.type||(e.type+="a"),e.values[3]=t,o(e)}function c(e,t){if(e=i(e),t=n(t),-1!==e.type.indexOf("hsl"))e.values[2]*=1-t;else if(-1!==e.type.indexOf("rgb"))for(var r=0;r<3;r+=1)e.values[r]*=1-t;return o(e)}function h(e,t){if(e=i(e),t=n(t),-1!==e.type.indexOf("hsl"))e.values[2]+=(100-e.values[2])*t;else if(-1!==e.type.indexOf("rgb"))for(var r=0;r<3;r+=1)e.values[r]+=(255-e.values[r])*t;return o(e)}r.d(t,"d",function(){return a}),r.d(t,"b",function(){return l}),r.d(t,"c",function(){return u}),r.d(t,"a",function(){return c}),r.d(t,"e",function(){return h})},function(e,t,r){"use strict";e.exports=function(e){return null!=e&&"object"===typeof e&&!1===Array.isArray(e)}},function(e,t){var r=e.exports={version:"2.6.1"};"number"==typeof __e&&(__e=r)},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.d(t,"a",function(){return n})},function(e,t,r){e.exports=r(446)()},function(e,t,r){"use strict";var n=r(163),i=r(92),o=Object.prototype.toString;function a(e){return"[object Array]"===o.call(e)}function s(e){return null!==e&&"object"===typeof e}function l(e){return"[object Function]"===o.call(e)}function u(e,t){if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),a(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:a,isArrayBuffer:function(e){return"[object ArrayBuffer]"===o.call(e)},isBuffer:i,isFormData:function(e){return"undefined"!==typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"===typeof e},isNumber:function(e){return"number"===typeof e},isObject:s,isUndefined:function(e){return"undefined"===typeof e},isDate:function(e){return"[object Date]"===o.call(e)},isFile:function(e){return"[object File]"===o.call(e)},isBlob:function(e){return"[object Blob]"===o.call(e)},isFunction:l,isStream:function(e){return s(e)&&l(e.pipe)},isURLSearchParams:function(e){return"undefined"!==typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"===typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!==typeof window&&"undefined"!==typeof document},forEach:u,merge:function e(){var t={};function r(r,n){"object"===typeof t[n]&&"object"===typeof r?t[n]=e(t[n],r):t[n]=r}for(var n=0,i=arguments.length;n<i;n++)u(arguments[n],r);return t},extend:function(e,t,r){return u(t,function(t,i){e[i]=r&&"function"===typeof t?n(t,r):t}),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}r.d(t,"a",function(){return i})},function(e,t,r){"use strict";r.d(t,"e",function(){return s}),r.d(t,"c",function(){return u}),r.d(t,"b",function(){return h}),r.d(t,"a",function(){return d}),r.d(t,"d",function(){return f});var n=r(156),i=function(){return Math.random().toString(36).substring(7).split("").join(".")},o={INIT:"@@redux/INIT"+i(),REPLACE:"@@redux/REPLACE"+i(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+i()}};function a(e){if("object"!==typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function s(e,t,r){var i;if("function"===typeof t&&"function"===typeof r||"function"===typeof r&&"function"===typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function");if("function"===typeof t&&"undefined"===typeof r&&(r=t,t=void 0),"undefined"!==typeof r){if("function"!==typeof r)throw new Error("Expected the enhancer to be a function.");return r(s)(e,t)}if("function"!==typeof e)throw new Error("Expected the reducer to be a function.");var l=e,u=t,c=[],h=c,p=!1;function f(){h===c&&(h=c.slice())}function d(){if(p)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return u}function m(e){if("function"!==typeof e)throw new Error("Expected the listener to be a function.");if(p)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");var t=!0;return f(),h.push(e),function(){if(t){if(p)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");t=!1,f();var r=h.indexOf(e);h.splice(r,1)}}}function v(e){if(!a(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if("undefined"===typeof e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(p)throw new Error("Reducers may not dispatch actions.");try{p=!0,u=l(u,e)}finally{p=!1}for(var t=c=h,r=0;r<t.length;r++){(0,t[r])()}return e}return v({type:o.INIT}),(i={dispatch:v,subscribe:m,getState:d,replaceReducer:function(e){if("function"!==typeof e)throw new Error("Expected the nextReducer to be a function.");l=e,v({type:o.REPLACE})}})[n.a]=function(){var e,t=m;return(e={subscribe:function(e){if("object"!==typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function r(){e.next&&e.next(d())}return r(),{unsubscribe:t(r)}}})[n.a]=function(){return this},e},i}function l(e,t){var r=t&&t.type;return"Given "+(r&&'action "'+String(r)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function u(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++){var i=t[n];0,"function"===typeof e[i]&&(r[i]=e[i])}var a,s=Object.keys(r);try{!function(e){Object.keys(e).forEach(function(t){var r=e[t];if("undefined"===typeof r(void 0,{type:o.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if("undefined"===typeof r(void 0,{type:o.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+o.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')})}(r)}catch(u){a=u}return function(e,t){if(void 0===e&&(e={}),a)throw a;for(var n=!1,i={},o=0;o<s.length;o++){var u=s[o],c=r[u],h=e[u],p=c(h,t);if("undefined"===typeof p){var f=l(u,t);throw new Error(f)}i[u]=p,n=n||p!==h}return n?i:e}}function c(e,t){return function(){return t(e.apply(this,arguments))}}function h(e,t){if("function"===typeof e)return c(e,t);if("object"!==typeof e||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var r=Object.keys(e),n={},i=0;i<r.length;i++){var o=r[i],a=e[o];"function"===typeof a&&(n[o]=c(a,t))}return n}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}function d(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return function(){var r=e.apply(void 0,arguments),n=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},i={getState:r.getState,dispatch:function(){return n.apply(void 0,arguments)}},o=t.map(function(e){return e(i)});return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){p(e,t,r[t])})}return e}({},r,{dispatch:n=f.apply(void 0,o)(r.dispatch)})}}}},function(e,t,r){"use strict";r.d(t,"a",function(){return a});var n=r(0),i=r.n(n),o="undefined"!==typeof window?i.a.useLayoutEffect:i.a.useEffect;function a(e){var t=i.a.useRef(e);return o(function(){t.current=e}),i.a.useCallback(function(e){return(0,t.current)(e)},[])}},function(e,t,r){"use strict";t.a=function(e){if("object"!==typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}},function(e,t,r){"use strict";t.__esModule=!0,t.default=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}},function(e,t,r){"use strict";t.a=function(e){return e&&e.ownerDocument||document}},function(e,t,r){"use strict";r.d(t,"b",function(){return n}),r.d(t,"a",function(){return i});var n="/",i="||"},function(e,t,r){"use strict";var n=r(1),i=r(9),o=r(10),a=r.n(o),s=r(0),l=r.n(s),u=(r(456),r(159)),c=r.n(u),h={type:c.a.string.isRequired,as:c.a.elementType},p=l.a.forwardRef(function(e,t){var r=e.as,o=void 0===r?"div":r,s=e.className,u=e.type,c=Object(i.a)(e,["as","className","type"]);return l.a.createElement(o,Object(n.a)({},c,{ref:t,className:a()(s,u&&u+"-feedback")}))});p.displayName="Feedback",p.propTypes=h,p.defaultProps={type:"valid"};var f=p,d=l.a.createContext({controlId:void 0}),m=r(17),v=l.a.forwardRef(function(e,t){var r=e.id,o=e.bsPrefix,u=e.bsCustomPrefix,c=e.className,h=e.isValid,p=e.isInvalid,f=e.isStatic,v=e.as,g=void 0===v?"input":v,y=Object(i.a)(e,["id","bsPrefix","bsCustomPrefix","className","isValid","isInvalid","isStatic","as"]),b=Object(s.useContext)(d),x=b.controlId;return o=b.custom?Object(m.a)(u,"custom-control-input"):Object(m.a)(o,"form-check-input"),l.a.createElement(g,Object(n.a)({},y,{ref:t,id:r||x,className:a()(c,o,h&&"is-valid",p&&"is-invalid",f&&"position-static")}))});v.displayName="FormCheckInput",v.defaultProps={type:"checkbox"};var g=v,y=l.a.forwardRef(function(e,t){var r=e.bsPrefix,o=e.bsCustomPrefix,u=e.className,c=e.htmlFor,h=Object(i.a)(e,["bsPrefix","bsCustomPrefix","className","htmlFor"]),p=Object(s.useContext)(d),f=p.controlId;return r=p.custom?Object(m.a)(o,"custom-control-label"):Object(m.a)(r,"form-check-label"),l.a.createElement("label",Object(n.a)({},h,{ref:t,htmlFor:c||f,className:a()(u,r)}))});y.displayName="FormCheckLabel";var b=y,x=l.a.forwardRef(function(e,t){var r=e.id,o=e.bsPrefix,u=e.bsCustomPrefix,c=e.inline,h=e.disabled,p=e.isValid,v=e.isInvalid,y=e.feedback,x=e.className,w=e.style,S=e.title,M=e.type,_=e.label,T=e.children,A=e.custom,C=e.as,E=void 0===C?"input":C,L=Object(i.a)(e,["id","bsPrefix","bsCustomPrefix","inline","disabled","isValid","isInvalid","feedback","className","style","title","type","label","children","custom","as"]),N="switch"===M||A;o=N?Object(m.a)(u,"custom-control"):Object(m.a)(o,"form-check");var P=Object(s.useContext)(d).controlId,O=Object(s.useMemo)(function(){return{controlId:r||P,custom:N}},[P,N,r]),R=null!=_&&!1!==_&&!T,D=l.a.createElement(g,Object(n.a)({},L,{type:"switch"===M?"checkbox":M,ref:t,isValid:p,isInvalid:v,isStatic:!R,disabled:h,as:E}));return l.a.createElement(d.Provider,{value:O},l.a.createElement("div",{style:w,className:a()(x,o,N&&"custom-"+M,c&&o+"-inline")},T||l.a.createElement(l.a.Fragment,null,D,R&&l.a.createElement(b,{title:S},_),(p||v)&&l.a.createElement(f,{type:p?"valid":"invalid"},y))))});x.displayName="FormCheck",x.defaultProps={type:"checkbox",inline:!1,disabled:!1,isValid:!1,isInvalid:!1,title:""},x.Input=g,x.Label=b;var w=x,S=(r(56),l.a.forwardRef(function(e,t){var r,o,u=e.bsPrefix,c=e.type,h=e.size,p=e.id,f=e.className,v=e.isValid,g=e.isInvalid,y=e.plaintext,b=e.readOnly,x=e.as,w=void 0===x?"input":x,S=Object(i.a)(e,["bsPrefix","type","size","id","className","isValid","isInvalid","plaintext","readOnly","as"]),M=Object(s.useContext)(d).controlId;if(u=Object(m.a)(u,"form-control"),y)(o={})[u+"-plaintext"]=!0,r=o;else if("file"===c){var _;(_={})[u+"-file"]=!0,r=_}else{var T;(T={})[u]=!0,T[u+"-"+h]=h,r=T}return l.a.createElement(w,Object(n.a)({},S,{type:c,ref:t,readOnly:b,id:p||M,className:a()(f,r,v&&"is-valid",g&&"is-invalid")}))}));S.displayName="FormControl",S.Feedback=f;var M=S,_=l.a.forwardRef(function(e,t){var r=e.bsPrefix,o=e.className,u=e.children,c=e.controlId,h=e.as,p=void 0===h?"div":h,f=Object(i.a)(e,["bsPrefix","className","children","controlId","as"]);r=Object(m.a)(r,"form-group");var v=Object(s.useMemo)(function(){return{controlId:c}},[c]);return l.a.createElement(d.Provider,{value:v},l.a.createElement(p,Object(n.a)({},f,{ref:t,className:a()(o,r)}),u))});_.displayName="FormGroup";var T=_,A=r(25),C=l.a.forwardRef(function(e,t){var r=e.bsPrefix,o=e.column,u=e.srOnly,c=e.className,h=e.htmlFor,p=Object(i.a)(e,["bsPrefix","column","srOnly","className","htmlFor"]),f=Object(s.useContext)(d).controlId;r=Object(m.a)(r,"form-label");var v=a()(c,r,u&&"sr-only",o&&"col-form-label");return h=h||f,o?l.a.createElement(A.a,Object(n.a)({as:"label",className:v,htmlFor:h},p)):l.a.createElement("label",Object(n.a)({ref:t,className:v,htmlFor:h},p))});C.displayName="FormLabel",C.defaultProps={column:!1,srOnly:!1};var E=C,L=l.a.forwardRef(function(e,t){var r=e.bsPrefix,o=e.className,s=e.as,u=void 0===s?"small":s,c=e.muted,h=Object(i.a)(e,["bsPrefix","className","as","muted"]);return r=Object(m.a)(r,"form-text"),l.a.createElement(u,Object(n.a)({},h,{ref:t,className:a()(o,r,c&&"text-muted")}))});L.displayName="FormText";var N=L,P=l.a.forwardRef(function(e,t){return l.a.createElement(w,Object(n.a)({},e,{ref:t,type:"switch"}))});P.displayName="Switch",P.Input=w.Input,P.Label=w.Label;var O=P,R=r(236),D=r.n(R),F=function(e){return e[0].toUpperCase()+D()(e).slice(1)};var k=l.a.forwardRef(function(e,t){var r=e.bsPrefix,o=e.inline,s=e.className,u=e.validated,c=e.as,h=void 0===c?"form":c,p=Object(i.a)(e,["bsPrefix","inline","className","validated","as"]);return r=Object(m.a)(r,"form"),l.a.createElement(h,Object(n.a)({},p,{ref:t,className:a()(s,u&&"was-validated",o&&r+"-inline")}))});k.displayName="Form",k.defaultProps={inline:!1},k.Row=function(e,t){var r=void 0===t?{}:t,o=r.displayName,s=void 0===o?F(e):o,u=r.Component,c=void 0===u?"div":u,h=r.defaultProps,p=l.a.forwardRef(function(t,r){var o=t.className,s=t.bsPrefix,u=t.as,h=void 0===u?c:u,p=Object(i.a)(t,["className","bsPrefix","as"]),f=Object(m.a)(s,e);return l.a.createElement(h,Object(n.a)({ref:r,className:a()(o,f)},p))});return p.defaultProps=h,p.displayName=s,p}("form-row"),k.Group=T,k.Control=M,k.Check=w,k.Switch=O,k.Label=E,k.Text=N;t.a=k},function(e,t){var r,n,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"===typeof setTimeout?setTimeout:o}catch(e){r=o}try{n="function"===typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var l,u=[],c=!1,h=-1;function p(){c&&l&&(c=!1,l.length?u=l.concat(u):h=-1,u.length&&f())}function f(){if(!c){var e=s(p);c=!0;for(var t=u.length;t;){for(l=u,u=[];++h<t;)l&&l[h].run();h=-1,t=u.length}l=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new d(e,t)),1!==u.length||c||s(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,r){"use strict";var n=r(106);function i(e,t){for(var r in t)o(t,r)&&(e[r]=t[r])}function o(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e){n(e)||(e={});for(var t=arguments.length,r=1;r<t;r++){var o=arguments[r];n(o)&&i(e,o)}return e}},function(e,t,r){var n=r(144)("wks"),i=r(114),o=r(64).Symbol,a="function"==typeof o;(e.exports=function(e){return n[e]||(n[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=n},function(e,t,r){"use strict";r.d(t,"a",function(){return o});var n=r(539),i=r(86);function o(){return Object(n.a)()||i.a}},function(e,t,r){"use strict";var n=r(0),i=r.n(n).a.createContext({});t.a=i},function(e,t,r){"use strict";t.a=function(e){return"function"===typeof e}},function(e,t,r){"use strict";t.a=function(e){return e}},function(e,t,r){"use strict";var n=r(335);e.exports=function(e,t,r){if("object"!==typeof e&&"function"!==typeof e)throw new TypeError("expected an object or function.");if("string"!==typeof t)throw new TypeError("expected `prop` to be a string.");return n(r)&&("set"in r||"get"in r)?Object.defineProperty(e,t,r):Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:r})}},function(e,t,r){"use strict";var n=function(){};e.exports=n},function(e,t,r){"use strict";function n(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}r.d(t,"a",function(){return n})},function(e,t,r){"use strict";function n(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var i=r(0),o=r.n(i),a=r(7),s=r.n(a),l=o.a.createContext(null),u=function(e){function t(t){var r;r=e.call(this,t)||this;var n=t.store;return r.state={storeState:n.getState(),store:n},r}n(t,e);var r=t.prototype;return r.componentDidMount=function(){this._isMounted=!0,this.subscribe()},r.componentWillUnmount=function(){this.unsubscribe&&this.unsubscribe(),this._isMounted=!1},r.componentDidUpdate=function(e){this.props.store!==e.store&&(this.unsubscribe&&this.unsubscribe(),this.subscribe())},r.subscribe=function(){var e=this,t=this.props.store;this.unsubscribe=t.subscribe(function(){var r=t.getState();e._isMounted&&e.setState(function(e){return e.storeState===r?null:{storeState:r}})});var r=t.getState();r!==this.state.storeState&&this.setState({storeState:r})},r.render=function(){var e=this.props.context||l;return o.a.createElement(e.Provider,{value:this.state},this.props.children)},t}(i.Component);u.propTypes={store:s.a.shape({subscribe:s.a.func.isRequired,dispatch:s.a.func.isRequired,getState:s.a.func.isRequired}),context:s.a.object,children:s.a.any};var c=u;function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function f(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}var d=r(101),m=r.n(d),v=r(22),g=r.n(v);r(160);function y(e,t){void 0===t&&(t={});var r=t,a=r.getDisplayName,s=void 0===a?function(e){return"ConnectAdvanced("+e+")"}:a,u=r.methodName,c=void 0===u?"connectAdvanced":u,d=r.renderCountProp,v=void 0===d?void 0:d,y=r.shouldHandleStateChanges,b=void 0===y||y,x=r.storeKey,w=void 0===x?"store":x,S=r.withRef,M=void 0!==S&&S,_=r.forwardRef,T=void 0!==_&&_,A=r.context,C=void 0===A?l:A,E=f(r,["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"]);g()(void 0===v,"renderCountProp is removed. render counting is built into the latest React dev tools profiling extension"),g()(!M,"withRef is removed. To access the wrapped instance, use a ref on the connected component");var L="To use a custom Redux store for specific components,  create a custom React context with React.createContext(), and pass the context object to React-Redux's Provider and specific components like:  <Provider context={MyContext}><ConnectedComponent context={MyContext} /></Provider>. You may also pass a {context : MyContext} option to connect";g()("store"===w,"storeKey has been removed and does not do anything. "+L);var N=C;return function(t){var r=t.displayName||t.name||"Component",a=s(r),l=p({},E,{getDisplayName:s,methodName:c,renderCountProp:v,shouldHandleStateChanges:b,storeKey:w,displayName:a,wrappedComponentName:r,WrappedComponent:t}),u=E.pure,f=i.Component,d=t;u&&(f=i.PureComponent);var y=function(t){function r(r){var n;return n=t.call(this,r)||this,g()(T?!r.wrapperProps[w]:!r[w],"Passing redux store in props has been removed and does not do anything. "+L),n.selectDerivedProps=function(){var t,r,n,i,o;return function(a,s,c){if(u&&t===s&&r===a)return n;c!==i&&(i=c,o=e(c.dispatch,l)),t=s,r=a;var h=o(a,s);return n===h?n:n=h}}(),n.selectChildElement=function(){var e,t,r;return function(n,i){return n===e&&i===t||(e=n,t=i,r=o.a.createElement(d,p({},n,{ref:i}))),r}}(),n.renderWrappedComponent=n.renderWrappedComponent.bind(h(h(n))),n}n(r,t);var i=r.prototype;return i.renderWrappedComponent=function(e){g()(e,'Could not find "store" in the context of "'+a+'". Either wrap the root component in a <Provider>, or pass a custom React context provider to <Provider> and the corresponding React context consumer to '+a+" in connect options.");var t,r=e.storeState,n=e.store,i=this.props;T&&(i=this.props.wrapperProps,t=this.props.forwardedRef);var o=this.selectDerivedProps(r,i,n);return this.selectChildElement(o,t)},i.render=function(){var e=this.props.context||N;return o.a.createElement(e.Consumer,null,this.renderWrappedComponent)},r}(f);if(y.WrappedComponent=t,y.displayName=a,T){var x=o.a.forwardRef(function(e,t){return o.a.createElement(y,{wrapperProps:e,forwardedRef:t})});return x.displayName=a,x.WrappedComponent=t,m()(x,t)}return m()(y,t)}}var b=Object.prototype.hasOwnProperty;function x(e,t){return e===t?0!==e||0!==t||1/e===1/t:e!==e&&t!==t}function w(e,t){if(x(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var i=0;i<r.length;i++)if(!b.call(t,r[i])||!x(e[r[i]],t[r[i]]))return!1;return!0}var S=r(41);function M(e){return function(t,r){var n=e(t,r);function i(){return n}return i.dependsOnOwnProps=!1,i}}function _(e){return null!==e.dependsOnOwnProps&&void 0!==e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}function T(e,t){return function(t,r){r.displayName;var n=function(e,t){return n.dependsOnOwnProps?n.mapToProps(e,t):n.mapToProps(e)};return n.dependsOnOwnProps=!0,n.mapToProps=function(t,r){n.mapToProps=e,n.dependsOnOwnProps=_(e);var i=n(t,r);return"function"===typeof i&&(n.mapToProps=i,n.dependsOnOwnProps=_(i),i=n(t,r)),i},n}}var A=[function(e){return"function"===typeof e?T(e):void 0},function(e){return e?void 0:M(function(e){return{dispatch:e}})},function(e){return e&&"object"===typeof e?M(function(t){return Object(S.b)(e,t)}):void 0}];var C=[function(e){return"function"===typeof e?T(e):void 0},function(e){return e?void 0:M(function(){return{}})}];function E(e,t,r){return p({},r,e,t)}var L=[function(e){return"function"===typeof e?function(e){return function(t,r){r.displayName;var n,i=r.pure,o=r.areMergedPropsEqual,a=!1;return function(t,r,s){var l=e(t,r,s);return a?i&&o(l,n)||(n=l):(a=!0,n=l),n}}}(e):void 0},function(e){return e?void 0:function(){return E}}];function N(e,t,r,n){return function(i,o){return r(e(i,o),t(n,o),o)}}function P(e,t,r,n,i){var o,a,s,l,u,c=i.areStatesEqual,h=i.areOwnPropsEqual,p=i.areStatePropsEqual,f=!1;function d(i,f){var d=!h(f,a),m=!c(i,o);return o=i,a=f,d&&m?(s=e(o,a),t.dependsOnOwnProps&&(l=t(n,a)),u=r(s,l,a)):d?(e.dependsOnOwnProps&&(s=e(o,a)),t.dependsOnOwnProps&&(l=t(n,a)),u=r(s,l,a)):m?function(){var t=e(o,a),n=!p(t,s);return s=t,n&&(u=r(s,l,a)),u}():u}return function(i,c){return f?d(i,c):(s=e(o=i,a=c),l=t(n,a),u=r(s,l,a),f=!0,u)}}function O(e,t){var r=t.initMapStateToProps,n=t.initMapDispatchToProps,i=t.initMergeProps,o=f(t,["initMapStateToProps","initMapDispatchToProps","initMergeProps"]),a=r(e,o),s=n(e,o),l=i(e,o);return(o.pure?P:N)(a,s,l,e,o)}function R(e,t,r){for(var n=t.length-1;n>=0;n--){var i=t[n](e);if(i)return i}return function(t,n){throw new Error("Invalid value of type "+typeof e+" for "+r+" argument when connecting component "+n.wrappedComponentName+".")}}function D(e,t){return e===t}var F=function(e){var t=void 0===e?{}:e,r=t.connectHOC,n=void 0===r?y:r,i=t.mapStateToPropsFactories,o=void 0===i?C:i,a=t.mapDispatchToPropsFactories,s=void 0===a?A:a,l=t.mergePropsFactories,u=void 0===l?L:l,c=t.selectorFactory,h=void 0===c?O:c;return function(e,t,r,i){void 0===i&&(i={});var a=i,l=a.pure,c=void 0===l||l,d=a.areStatesEqual,m=void 0===d?D:d,v=a.areOwnPropsEqual,g=void 0===v?w:v,y=a.areStatePropsEqual,b=void 0===y?w:y,x=a.areMergedPropsEqual,S=void 0===x?w:x,M=f(a,["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"]),_=R(e,o,"mapStateToProps"),T=R(t,s,"mapDispatchToProps"),A=R(r,u,"mergeProps");return n(h,p({methodName:"connect",getDisplayName:function(e){return"Connect("+e+")"},shouldHandleStateChanges:Boolean(e),initMapStateToProps:_,initMapDispatchToProps:T,initMergeProps:A,pure:c,areStatesEqual:m,areOwnPropsEqual:g,areStatePropsEqual:b,areMergedPropsEqual:S},M))}}();r.d(t,"a",function(){return c}),r.d(t,"b",function(){return l}),r.d(t,"c",function(){return F})},function(e,t,r){(function(e,n){var i=/%[sdj%]/g;t.format=function(e){if(!g(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(s(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,o=n.length,a=String(e).replace(i,function(e){if("%%"===e)return"%";if(r>=o)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(t){return"[Circular]"}default:return e}}),l=n[r];r<o;l=n[++r])m(l)||!x(l)?a+=" "+l:a+=" "+s(l);return a},t.deprecate=function(r,i){if(y(e.process))return function(){return t.deprecate(r,i).apply(this,arguments)};if(!0===n.noDeprecation)return r;var o=!1;return function(){if(!o){if(n.throwDeprecation)throw new Error(i);n.traceDeprecation?console.trace(i):console.error(i),o=!0}return r.apply(this,arguments)}};var o,a={};function s(e,r){var n={seen:[],stylize:u};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),d(r)?n.showHidden=r:r&&t._extend(n,r),y(n.showHidden)&&(n.showHidden=!1),y(n.depth)&&(n.depth=2),y(n.colors)&&(n.colors=!1),y(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=l),c(n,e,n.depth)}function l(e,t){var r=s.styles[t];return r?"\x1b["+s.colors[r][0]+"m"+e+"\x1b["+s.colors[r][1]+"m":e}function u(e,t){return e}function c(e,r,n){if(e.customInspect&&r&&M(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var i=r.inspect(n,e);return g(i)||(i=c(e,i,n)),i}var o=function(e,t){if(y(t))return e.stylize("undefined","undefined");if(g(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(v(t))return e.stylize(""+t,"number");if(d(t))return e.stylize(""+t,"boolean");if(m(t))return e.stylize("null","null")}(e,r);if(o)return o;var a=Object.keys(r),s=function(e){var t={};return e.forEach(function(e,r){t[e]=!0}),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(r)),S(r)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return h(r);if(0===a.length){if(M(r)){var l=r.name?": "+r.name:"";return e.stylize("[Function"+l+"]","special")}if(b(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(w(r))return e.stylize(Date.prototype.toString.call(r),"date");if(S(r))return h(r)}var u,x="",_=!1,T=["{","}"];(f(r)&&(_=!0,T=["[","]"]),M(r))&&(x=" [Function"+(r.name?": "+r.name:"")+"]");return b(r)&&(x=" "+RegExp.prototype.toString.call(r)),w(r)&&(x=" "+Date.prototype.toUTCString.call(r)),S(r)&&(x=" "+h(r)),0!==a.length||_&&0!=r.length?n<0?b(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),u=_?function(e,t,r,n,i){for(var o=[],a=0,s=t.length;a<s;++a)C(t,String(a))?o.push(p(e,t,r,n,String(a),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(p(e,t,r,n,i,!0))}),o}(e,r,n,s,a):a.map(function(t){return p(e,r,n,s,t,_)}),e.seen.pop(),function(e,t,r){if(e.reduce(function(e,t){return 0,t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(u,x,T)):T[0]+x+T[1]}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,r,n,i,o){var a,s,l;if((l=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(s=e.stylize("[Setter]","special")),C(n,i)||(a="["+i+"]"),s||(e.seen.indexOf(l.value)<0?(s=m(r)?c(e,l.value,null):c(e,l.value,r-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")):s=e.stylize("[Circular]","special")),y(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function f(e){return Array.isArray(e)}function d(e){return"boolean"===typeof e}function m(e){return null===e}function v(e){return"number"===typeof e}function g(e){return"string"===typeof e}function y(e){return void 0===e}function b(e){return x(e)&&"[object RegExp]"===_(e)}function x(e){return"object"===typeof e&&null!==e}function w(e){return x(e)&&"[object Date]"===_(e)}function S(e){return x(e)&&("[object Error]"===_(e)||e instanceof Error)}function M(e){return"function"===typeof e}function _(e){return Object.prototype.toString.call(e)}function T(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(y(o)&&(o=Object({NODE_ENV:"production",PUBLIC_URL:""}).NODE_DEBUG||""),e=e.toUpperCase(),!a[e])if(new RegExp("\\b"+e+"\\b","i").test(o)){var r=n.pid;a[e]=function(){var n=t.format.apply(t,arguments);console.error("%s %d: %s",e,r,n)}}else a[e]=function(){};return a[e]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=f,t.isBoolean=d,t.isNull=m,t.isNullOrUndefined=function(e){return null==e},t.isNumber=v,t.isString=g,t.isSymbol=function(e){return"symbol"===typeof e},t.isUndefined=y,t.isRegExp=b,t.isObject=x,t.isDate=w,t.isError=S,t.isFunction=M,t.isPrimitive=function(e){return null===e||"boolean"===typeof e||"number"===typeof e||"string"===typeof e||"symbol"===typeof e||"undefined"===typeof e},t.isBuffer=r(289);var A=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function C(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",function(){var e=new Date,t=[T(e.getHours()),T(e.getMinutes()),T(e.getSeconds())].join(":");return[e.getDate(),A[e.getMonth()],t].join(" ")}(),t.format.apply(t,arguments))},t.inherits=r(290),t._extend=function(e,t){if(!t||!x(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}}).call(this,r(72),r(48))},function(e,t,r){"use strict";var n=r(169),i=r(295),o=r(301),a=r(94),s=65536,l={};function u(e,t){if(e instanceof RegExp)return e;if("string"!==typeof e)throw new TypeError("expected a string");if(e.length>s)throw new Error("expected pattern to be less than "+s+" characters");var r=e;if((!t||t&&!1!==t.cache)&&(r=function(e,t){if(!t)return e;var r=e;for(var n in t)t.hasOwnProperty(n)&&(r+=";"+n+"="+String(t[n]));return r}(e,t),l.hasOwnProperty(r)))return l[r];var u=o({},t);!0===u.contains&&(!0===u.negate?u.strictNegate=!1:u.strict=!1),!1===u.strict&&(u.strictOpen=!1,u.strictClose=!1);var c,h=!1!==u.strictOpen?"^":"",p=!1!==u.strictClose?"$":"",f=u.flags||"";!0!==u.nocase||/i/.test(f)||(f+="i");try{if((u.negate||"boolean"===typeof u.strictNegate)&&(e=a.create(e,u)),c=new RegExp(h+"(?:"+e+")"+p,f),!0===u.safe&&!1===n(c))throw new Error("potentially unsafe regular expression: "+c.source)}catch(d){if(!0===u.strictErrors||!0===u.safe)throw d.key=r,d.pattern=e,d.originalOptions=t,d.createdOptions=u,d;try{c=new RegExp("^"+e.replace(/(\W)/g,"\\$1")+"$")}catch(d){c=/.^/}}return!1!==u.cache&&function(e,t,r,n){i(e,"cached",!0),i(e,"pattern",r),i(e,"options",n),i(e,"key",t),l[t]=e}(c,r,e,u),c}e.exports=function(e,t){return Array.isArray(e)?u(e.join("|"),t):u(e,t)},e.exports.makeRe=u},function(e,t,r){"use strict";var n=r(35);function i(e){return!0===n(e)&&"[object Object]"===Object.prototype.toString.call(e)}e.exports=function(e){var t,r;return!1!==i(e)&&("function"===typeof(t=e.constructor)&&(!1!==i(r=t.prototype)&&!1!==r.hasOwnProperty("isPrototypeOf")))}},function(e,t,r){function n(e){if(e)return function(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}(e)}e.exports=n,n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},n.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<n.length;i++)if((r=n[i])===t||r.fn===t){n.splice(i,1);break}return this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),r=this._callbacks["$"+e];if(r)for(var n=0,i=(r=r.slice(0)).length;n<i;++n)r[n].apply(this,t);return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,r){var n=r(64),i=r(36),o=r(138),a=r(79),s=r(74),l=function e(t,r,l){var u,c,h,p=t&e.F,f=t&e.G,d=t&e.S,m=t&e.P,v=t&e.B,g=t&e.W,y=f?i:i[r]||(i[r]={}),b=y.prototype,x=f?n:d?n[r]:(n[r]||{}).prototype;for(u in f&&(l=r),l)(c=!p&&x&&void 0!==x[u])&&s(y,u)||(h=c?x[u]:l[u],y[u]=f&&"function"!=typeof x[u]?l[u]:v&&c?o(h,n):g&&x[u]==h?function(e){var t=function(t,r,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,n)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(h):m&&"function"==typeof h?o(Function.call,h):h,m&&((y.virtual||(y.virtual={}))[u]=h,t&e.R&&b&&!b[u]&&a(b,u,h)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t){var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(e,t,r){var n=r(80),i=r(197),o=r(139),a=Object.defineProperty;t.f=r(73)?Object.defineProperty:function(e,t,r){if(n(e),t=o(t,!0),n(r),i)try{return a(e,t,r)}catch(s){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){"use strict";t.a=function(e){return"undefined"!==typeof Map&&e instanceof Map}},function(e,t,r){"use strict";function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r.d(t,"a",function(){return n})},function(e,t,r){"use strict";var n=function(e){return function(e){return!!e&&"object"===typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===i}(e)}(e)};var i="function"===typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function o(e,t){return!1!==t.clone&&t.isMergeableObject(e)?u((r=e,Array.isArray(r)?[]:{}),e,t):e;var r}function a(e,t,r){return e.concat(t).map(function(e){return o(e,r)})}function s(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return e.propertyIsEnumerable(t)}):[]}(e))}function l(e,t,r){var n={};return r.isMergeableObject(e)&&s(e).forEach(function(t){n[t]=o(e[t],r)}),s(t).forEach(function(i){r.isMergeableObject(t[i])&&e[i]?n[i]=function(e,t){if(!t.customMerge)return u;var r=t.customMerge(e);return"function"===typeof r?r:u}(i,r)(e[i],t[i],r):n[i]=o(t[i],r)}),n}function u(e,t,r){(r=r||{}).arrayMerge=r.arrayMerge||a,r.isMergeableObject=r.isMergeableObject||n;var i=Array.isArray(t);return i===Array.isArray(e)?i?r.arrayMerge(e,t,r):l(e,t,r):o(t,r)}u.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce(function(e,r){return u(e,r,t)},{})};var c=u;e.exports=c},function(e,t,r){"use strict";function n(e){return(n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"===typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}var o=r(76);function a(e,t){return!t||"object"!==i(t)&&"function"!==typeof t?Object(o.a)(e):t}r.d(t,"a",function(){return a})},function(e,t,r){"use strict";function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}r.d(t,"a",function(){return i})},function(e,t,r){"use strict";var n=function(){};e.exports=n},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(n){"object"===typeof window&&(r=window)}e.exports=r},function(e,t,r){e.exports=!r(82)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t,r){var n=r(200),i=r(141);e.exports=function(e){return n(i(e))}},function(e,t,r){"use strict";function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}r.d(t,"a",function(){return n})},function(e,t,r){"use strict";var n=r(0),i=r.n(n);t.a=i.a.createContext(null)},function(e,t,r){"use strict";var n=r(296),i=r(297),o=r(299);e.exports=function(e,t){return"object"===n(e)&&("get"in e?i(e,t):o(e,t))}},function(e,t,r){var n=r(65),i=r(98);e.exports=r(73)?function(e,t,r){return n.f(e,t,i(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t,r){var n=r(81);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"===typeof e?null!==e:"function"===typeof e}},function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},function(e,t,r){var n,i=r(471),o=r(216),a=r(473),s=r(474),l=r(475);"undefined"!==typeof ArrayBuffer&&(n=r(476));var u="undefined"!==typeof navigator&&/Android/i.test(navigator.userAgent),c="undefined"!==typeof navigator&&/PhantomJS/i.test(navigator.userAgent),h=u||c;t.protocol=3;var p=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},f=i(p),d={type:"error",data:"parser error"},m=r(477);function v(e,t,r){for(var n=new Array(e.length),i=s(e.length,r),o=function(e,r,i){t(r,function(t,r){n[e]=r,i(t,n)})},a=0;a<e.length;a++)o(a,e[a],i)}t.encodePacket=function(e,r,n,i){"function"===typeof r&&(i=r,r=!1),"function"===typeof n&&(i=n,n=null);var o=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!==typeof ArrayBuffer&&o instanceof ArrayBuffer)return function(e,r,n){if(!r)return t.encodeBase64Packet(e,n);var i=e.data,o=new Uint8Array(i),a=new Uint8Array(1+i.byteLength);a[0]=p[e.type];for(var s=0;s<o.length;s++)a[s+1]=o[s];return n(a.buffer)}(e,r,i);if("undefined"!==typeof m&&o instanceof m)return function(e,r,n){if(!r)return t.encodeBase64Packet(e,n);if(h)return function(e,r,n){if(!r)return t.encodeBase64Packet(e,n);var i=new FileReader;return i.onload=function(){t.encodePacket({type:e.type,data:i.result},r,!0,n)},i.readAsArrayBuffer(e.data)}(e,r,n);var i=new Uint8Array(1);i[0]=p[e.type];var o=new m([i.buffer,e.data]);return n(o)}(e,r,i);if(o&&o.base64)return function(e,r){var n="b"+t.packets[e.type]+e.data.data;return r(n)}(e,i);var a=p[e.type];return void 0!==e.data&&(a+=n?l.encode(String(e.data),{strict:!1}):String(e.data)),i(""+a)},t.encodeBase64Packet=function(e,r){var n,i="b"+t.packets[e.type];if("undefined"!==typeof m&&e.data instanceof m){var o=new FileReader;return o.onload=function(){var e=o.result.split(",")[1];r(i+e)},o.readAsDataURL(e.data)}try{n=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(u){for(var a=new Uint8Array(e.data),s=new Array(a.length),l=0;l<a.length;l++)s[l]=a[l];n=String.fromCharCode.apply(null,s)}return i+=btoa(n),r(i)},t.decodePacket=function(e,r,n){if(void 0===e)return d;if("string"===typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),r);if(n&&!1===(e=function(e){try{e=l.decode(e,{strict:!1})}catch(t){return!1}return e}(e)))return d;var i=e.charAt(0);return Number(i)==i&&f[i]?e.length>1?{type:f[i],data:e.substring(1)}:{type:f[i]}:d}i=new Uint8Array(e)[0];var o=a(e,1);return m&&"blob"===r&&(o=new m([o])),{type:f[i],data:o}},t.decodeBase64Packet=function(e,t){var r=f[e.charAt(0)];if(!n)return{type:r,data:{base64:!0,data:e.substr(1)}};var i=n.decode(e.substr(1));return"blob"===t&&m&&(i=new m([i])),{type:r,data:i}},t.encodePayload=function(e,r,n){"function"===typeof r&&(n=r,r=null);var i=o(e);if(r&&i)return m&&!h?t.encodePayloadAsBlob(e,n):t.encodePayloadAsArrayBuffer(e,n);if(!e.length)return n("0:");v(e,function(e,n){t.encodePacket(e,!!i&&r,!1,function(e){n(null,function(e){return e.length+":"+e}(e))})},function(e,t){return n(t.join(""))})},t.decodePayload=function(e,r,n){if("string"!==typeof e)return t.decodePayloadAsBinary(e,r,n);var i;if("function"===typeof r&&(n=r,r=null),""===e)return n(d,0,1);for(var o,a,s="",l=0,u=e.length;l<u;l++){var c=e.charAt(l);if(":"===c){if(""===s||s!=(o=Number(s)))return n(d,0,1);if(s!=(a=e.substr(l+1,o)).length)return n(d,0,1);if(a.length){if(i=t.decodePacket(a,r,!1),d.type===i.type&&d.data===i.data)return n(d,0,1);if(!1===n(i,l+o,u))return}l+=o,s=""}else s+=c}return""!==s?n(d,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,r){if(!e.length)return r(new ArrayBuffer(0));v(e,function(e,r){t.encodePacket(e,!0,!0,function(e){return r(null,e)})},function(e,t){var n=t.reduce(function(e,t){var r;return e+(r="string"===typeof t?t.length:t.byteLength).toString().length+r+2},0),i=new Uint8Array(n),o=0;return t.forEach(function(e){var t="string"===typeof e,r=e;if(t){for(var n=new Uint8Array(e.length),a=0;a<e.length;a++)n[a]=e.charCodeAt(a);r=n.buffer}i[o++]=t?0:1;var s=r.byteLength.toString();for(a=0;a<s.length;a++)i[o++]=parseInt(s[a]);i[o++]=255;for(n=new Uint8Array(r),a=0;a<n.length;a++)i[o++]=n[a]}),r(i.buffer)})},t.encodePayloadAsBlob=function(e,r){v(e,function(e,r){t.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"===typeof e){for(var n=new Uint8Array(e.length),i=0;i<e.length;i++)n[i]=e.charCodeAt(i);e=n.buffer,t[0]=0}var o=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),a=new Uint8Array(o.length+1);for(i=0;i<o.length;i++)a[i]=parseInt(o[i]);if(a[o.length]=255,m){var s=new m([t.buffer,a.buffer,e]);r(null,s)}})},function(e,t){return r(new m(t))})},t.decodePayloadAsBinary=function(e,r,n){"function"===typeof r&&(n=r,r=null);for(var i=e,o=[];i.byteLength>0;){for(var s=new Uint8Array(i),l=0===s[0],u="",c=1;255!==s[c];c++){if(u.length>310)return n(d,0,1);u+=s[c]}i=a(i,2+u.length),u=parseInt(u);var h=a(i,0,u);if(l)try{h=String.fromCharCode.apply(null,new Uint8Array(h))}catch(m){var p=new Uint8Array(h);h="";for(c=0;c<p.length;c++)h+=String.fromCharCode(p[c])}o.push(h),i=a(i,u)}var f=o.length;o.forEach(function(e,i){n(t.decodePacket(e,r,!0),i,f)})}},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(66);function i(e){if(Object(n.a)(e))return Array.from(e.keys());if("undefined"!==typeof Reflect&&"function"===typeof Reflect.ownKeys)return Reflect.ownKeys(e);var t=Object.getOwnPropertyNames(e);return"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(e))),t}},function(e,t,r){"use strict";function n(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);null!==e&&void 0!==e&&this.setState(e)}function i(e){this.setState(function(t){var r=this.constructor.getDerivedStateFromProps(e,t);return null!==r&&void 0!==r?r:null}.bind(this))}function o(e,t){try{var r=this.props,n=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(r,n)}finally{this.props=r,this.state=n}}function a(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if("function"!==typeof e.getDerivedStateFromProps&&"function"!==typeof t.getSnapshotBeforeUpdate)return e;var r=null,a=null,s=null;if("function"===typeof t.componentWillMount?r="componentWillMount":"function"===typeof t.UNSAFE_componentWillMount&&(r="UNSAFE_componentWillMount"),"function"===typeof t.componentWillReceiveProps?a="componentWillReceiveProps":"function"===typeof t.UNSAFE_componentWillReceiveProps&&(a="UNSAFE_componentWillReceiveProps"),"function"===typeof t.componentWillUpdate?s="componentWillUpdate":"function"===typeof t.UNSAFE_componentWillUpdate&&(s="UNSAFE_componentWillUpdate"),null!==r||null!==a||null!==s){var l=e.displayName||e.name,u="function"===typeof e.getDerivedStateFromProps?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error("Unsafe legacy lifecycles will not be called for components using new component APIs.\n\n"+l+" uses "+u+" but also contains the following legacy lifecycles:"+(null!==r?"\n  "+r:"")+(null!==a?"\n  "+a:"")+(null!==s?"\n  "+s:"")+"\n\nThe above lifecycles should be removed. Learn more about this warning here:\nhttps://fb.me/react-async-component-lifecycle-hooks")}if("function"===typeof e.getDerivedStateFromProps&&(t.componentWillMount=n,t.componentWillReceiveProps=i),"function"===typeof t.getSnapshotBeforeUpdate){if("function"!==typeof t.componentDidUpdate)throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=o;var c=t.componentDidUpdate;t.componentDidUpdate=function(e,t,r){var n=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:r;c.call(this,e,t,n)}}return e}r.d(t,"a",function(){return a}),n.__suppressDeprecationWarning=!0,i.__suppressDeprecationWarning=!0,o.__suppressDeprecationWarning=!0},function(e,t,r){"use strict";var n=r(29),i=r(1),o=r(5),a=r(68),s=r.n(a);function l(e){return!0===(null!=(t=e)&&"object"===typeof t&&!1===Array.isArray(t))&&"[object Object]"===Object.prototype.toString.call(e);var t}function u(e){var t,r;return!1!==l(e)&&("function"===typeof(t=e.constructor)&&(!1!==l(r=t.prototype)&&!1!==r.hasOwnProperty("isPrototypeOf")))}var c=["xs","sm","md","lg","xl"];function h(e,t,r){var o;return Object(i.a)({gutters:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i.a)({paddingLeft:t(2),paddingRight:t(2)},r,Object(n.a)({},e.up("sm"),Object(i.a)({paddingLeft:t(3),paddingRight:t(3)},r[e.up("sm")])))},toolbar:(o={minHeight:56},Object(n.a)(o,"".concat(e.up("xs")," and (orientation: landscape)"),{minHeight:48}),Object(n.a)(o,e.up("sm"),{minHeight:64}),o)},r)}var p={50:"#e8eaf6",100:"#c5cae9",200:"#9fa8da",300:"#7986cb",400:"#5c6bc0",500:"#3f51b5",600:"#3949ab",700:"#303f9f",800:"#283593",900:"#1a237e",A100:"#8c9eff",A200:"#536dfe",A400:"#3d5afe",A700:"#304ffe"},f={50:"#fce4ec",100:"#f8bbd0",200:"#f48fb1",300:"#f06292",400:"#ec407a",500:"#e91e63",600:"#d81b60",700:"#c2185b",800:"#ad1457",900:"#880e4f",A100:"#ff80ab",A200:"#ff4081",A400:"#f50057",A700:"#c51162"},d={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#d5d5d5",A200:"#aaaaaa",A400:"#303030",A700:"#616161"},m={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},v={black:"#000",white:"#fff"},g=r(34),y={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.54)",disabled:"rgba(0, 0, 0, 0.38)",hint:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:v.white,default:d[50]},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.08)",hoverOpacity:.08,selected:"rgba(0, 0, 0, 0.14)",disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)"}},b={text:{primary:v.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",hint:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:d[800],default:"#303030"},action:{active:v.white,hover:"rgba(255, 255, 255, 0.1)",hoverOpacity:.1,selected:"rgba(255, 255, 255, 0.2)",disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)"}};function x(e,t,r,n){e[t]||(e.hasOwnProperty(r)?e[t]=e[r]:"light"===t?e.light=Object(g.e)(e.main,n):"dark"===t&&(e.dark=Object(g.a)(e.main,1.5*n)))}function w(e){return Math.round(1e5*e)/1e5}var S={textTransform:"uppercase"},M='"Roboto", "Helvetica", "Arial", sans-serif';function _(e,t){var r="function"===typeof t?t(e):t,n=r.fontFamily,a=void 0===n?M:n,l=r.fontSize,u=void 0===l?14:l,c=r.fontWeightLight,h=void 0===c?300:c,p=r.fontWeightRegular,f=void 0===p?400:p,d=r.fontWeightMedium,m=void 0===d?500:d,v=r.fontWeightBold,g=void 0===v?700:v,y=r.htmlFontSize,b=void 0===y?16:y,x=r.allVariants,_=r.pxToRem,T=Object(o.a)(r,["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"]);var A=u/14,C=_||function(e){return"".concat(e/b*A,"rem")},E=function(e,t,r,n,o){return Object(i.a)({fontFamily:a,fontWeight:e,fontSize:C(t),lineHeight:r},a===M?{letterSpacing:"".concat(w(n/t),"em")}:{},{},o,{},x)},L={h1:E(h,96,1,-1.5),h2:E(h,60,1,-.5),h3:E(f,48,1.04,0),h4:E(f,34,1.17,.25),h5:E(f,24,1.33,0),h6:E(m,20,1.6,.15),subtitle1:E(f,16,1.75,.15),subtitle2:E(m,14,1.57,.1),body1:E(f,16,1.5,.15),body2:E(f,14,1.43,.15),button:E(m,14,1.75,.4,S),caption:E(f,12,1.66,.4),overline:E(f,12,2.66,1,S)};return s()(Object(i.a)({htmlFontSize:b,pxToRem:C,round:w,fontFamily:a,fontSize:u,fontWeightLight:h,fontWeightRegular:f,fontWeightMedium:m,fontWeightBold:g},L),T,{clone:!1})}var T=.2,A=.14,C=.12;function E(){return["".concat(arguments.length<=0?void 0:arguments[0],"px ").concat(arguments.length<=1?void 0:arguments[1],"px ").concat(arguments.length<=2?void 0:arguments[2],"px ").concat(arguments.length<=3?void 0:arguments[3],"px rgba(0,0,0,").concat(T,")"),"".concat(arguments.length<=4?void 0:arguments[4],"px ").concat(arguments.length<=5?void 0:arguments[5],"px ").concat(arguments.length<=6?void 0:arguments[6],"px ").concat(arguments.length<=7?void 0:arguments[7],"px rgba(0,0,0,").concat(A,")"),"".concat(arguments.length<=8?void 0:arguments[8],"px ").concat(arguments.length<=9?void 0:arguments[9],"px ").concat(arguments.length<=10?void 0:arguments[10],"px ").concat(arguments.length<=11?void 0:arguments[11],"px rgba(0,0,0,").concat(C,")")].join(",")}var L=["none",E(0,1,3,0,0,1,1,0,0,2,1,-1),E(0,1,5,0,0,2,2,0,0,3,1,-2),E(0,1,8,0,0,3,4,0,0,3,3,-2),E(0,2,4,-1,0,4,5,0,0,1,10,0),E(0,3,5,-1,0,5,8,0,0,1,14,0),E(0,3,5,-1,0,6,10,0,0,1,18,0),E(0,4,5,-2,0,7,10,1,0,2,16,1),E(0,5,5,-3,0,8,10,1,0,3,14,2),E(0,5,6,-3,0,9,12,1,0,3,16,2),E(0,6,6,-3,0,10,14,1,0,4,18,3),E(0,6,7,-4,0,11,15,1,0,4,20,3),E(0,7,8,-4,0,12,17,2,0,5,22,4),E(0,7,8,-4,0,13,19,2,0,5,24,4),E(0,7,9,-4,0,14,21,2,0,5,26,4),E(0,8,9,-5,0,15,22,2,0,6,28,5),E(0,8,10,-5,0,16,24,2,0,6,30,5),E(0,8,11,-5,0,17,26,2,0,6,32,5),E(0,9,11,-5,0,18,28,2,0,7,34,6),E(0,9,12,-6,0,19,29,2,0,7,36,6),E(0,10,13,-6,0,20,31,3,0,8,38,7),E(0,10,13,-6,0,21,33,3,0,8,40,7),E(0,10,14,-6,0,22,35,3,0,8,42,7),E(0,11,14,-7,0,23,36,3,0,9,44,8),E(0,11,15,-7,0,24,38,3,0,9,46,8)],N={borderRadius:4};var P=r(26),O=r(125);var R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.breakpoints,r=void 0===t?{}:t,n=e.mixins,a=void 0===n?{}:n,l=e.palette,w=void 0===l?{}:l,S=e.shadows,M=e.spacing,T=e.typography,A=void 0===T?{}:T,C=Object(o.a)(e,["breakpoints","mixins","palette","shadows","spacing","typography"]),E=function(e){var t=e.primary,r=void 0===t?{light:p[300],main:p[500],dark:p[700]}:t,n=e.secondary,a=void 0===n?{light:f.A200,main:f.A400,dark:f.A700}:n,l=e.error,u=void 0===l?{light:m[300],main:m[500],dark:m[700]}:l,c=e.type,h=void 0===c?"light":c,w=e.contrastThreshold,S=void 0===w?3:w,M=e.tonalOffset,_=void 0===M?.2:M,T=Object(o.a)(e,["primary","secondary","error","type","contrastThreshold","tonalOffset"]);function A(e){return Object(g.d)(e,b.text.primary)>=S?b.text.primary:y.text.primary}function C(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:300,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:700;return!(e=Object(i.a)({},e)).main&&e[t]&&(e.main=e[t]),x(e,"light",r,_),x(e,"dark",n,_),e.contrastText||(e.contrastText=A(e.main)),e}var E={dark:b,light:y};return s()(Object(i.a)({common:v,type:h,primary:C(r),secondary:C(a,"A400","A200","A700"),error:C(u),grey:d,contrastThreshold:S,getContrastText:A,augmentColor:C,tonalOffset:_},E[h]),T,{clone:!1})}(w),R=function(e){var t=e.values,r=void 0===t?{xs:0,sm:600,md:960,lg:1280,xl:1920}:t,n=e.unit,a=void 0===n?"px":n,s=e.step,l=void 0===s?5:s,u=Object(o.a)(e,["values","unit","step"]);function h(e){var t="number"===typeof r[e]?r[e]:e;return"@media (min-width:".concat(t).concat(a,")")}function p(e,t){var n=c.indexOf(t)+1;return n===c.length?h(e):"@media (min-width:".concat(r[e]).concat(a,") and ")+"(max-width:".concat(r[c[n]]-l/100).concat(a,")")}return Object(i.a)({keys:c,values:r,up:h,down:function(e){var t=c.indexOf(e)+1,n=r[c[t]];return t===c.length?h("xs"):"@media (max-width:".concat(("number"===typeof n&&t>0?n:e)-l/100).concat(a,")")},between:p,only:function(e){return p(e,e)},width:function(e){return r[e]}},u)}(r),D=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;if(t.mui)return t;e="function"===typeof t?t:function(e){return t*e};var r=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return 0===r.length?e(1):1===r.length?e(r[0]):r.map(function(t){var r=e(t);return"number"===typeof r?"".concat(r,"px"):r}).join(" ")};return Object.defineProperty(r,"unit",{get:function(){return t}}),r.mui=!0,r}(M);return Object(i.a)({breakpoints:R,direction:"ltr",mixins:h(R,D,a),overrides:{},palette:E,props:{},shadows:S||L,typography:_(E,A),spacing:D},s()({shape:N,transitions:P.a,zIndex:O.a},C,{isMergeableObject:u}))}();t.a=R},function(e,t,r){"use strict";function n(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}r.d(t,"a",function(){return n})},function(e,t,r){"use strict";function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}r.d(t,"a",function(){return n})},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}r.d(t,"a",function(){return i})},function(e,t,r){"use strict";t.__esModule=!0;var n,i=r(433),o=(n=i)&&n.__esModule?n:{default:n};t.default=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return(0,o.default)(e)}},function(e,t,r){"use strict";var n=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},i=function(e){var t;return 1===e.length&&(t=e,e=function(e,r){return n(t(e),r)}),{left:function(t,r,n,i){for(null==n&&(n=0),null==i&&(i=t.length);n<i;){var o=n+i>>>1;e(t[o],r)<0?n=o+1:i=o}return n},right:function(t,r,n,i){for(null==n&&(n=0),null==i&&(i=t.length);n<i;){var o=n+i>>>1;e(t[o],r)>0?i=o:n=o+1}return n}}};var o=i(n);o.right,o.left;var a=Array.prototype;a.slice,a.map,Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);var s=function(e){for(var t,r,n,i=e.length,o=-1,a=0;++o<i;)a+=e[o].length;for(r=new Array(a);--i>=0;)for(t=(n=e[i]).length;--t>=0;)r[--a]=n[t];return r};Array.prototype.slice;var l={value:function(){}};function u(){for(var e,t=0,r=arguments.length,n={};t<r;++t){if(!(e=arguments[t]+"")||e in n)throw new Error("illegal type: "+e);n[e]=[]}return new c(n)}function c(e){this._=e}function h(e,t){for(var r,n=0,i=e.length;n<i;++n)if((r=e[n]).name===t)return r.value}function p(e,t,r){for(var n=0,i=e.length;n<i;++n)if(e[n].name===t){e[n]=l,e=e.slice(0,n).concat(e.slice(n+1));break}return null!=r&&e.push({name:t,value:r}),e}c.prototype=u.prototype={constructor:c,on:function(e,t){var r,n,i=this._,o=(n=i,(e+"").trim().split(/^|\s+/).map(function(e){var t="",r=e.indexOf(".");if(r>=0&&(t=e.slice(r+1),e=e.slice(0,r)),e&&!n.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:t}})),a=-1,s=o.length;if(!(arguments.length<2)){if(null!=t&&"function"!==typeof t)throw new Error("invalid callback: "+t);for(;++a<s;)if(r=(e=o[a]).type)i[r]=p(i[r],e.name,t);else if(null==t)for(r in i)i[r]=p(i[r],e.name,null);return this}for(;++a<s;)if((r=(e=o[a]).type)&&(r=h(i[r],e.name)))return r},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new c(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var r,n,i=new Array(r),o=0;o<r;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=0,r=(n=this._[e]).length;o<r;++o)n[o].value.apply(t,i)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],i=0,o=n.length;i<o;++i)n[i].value.apply(t,r)}};var f=u,d="http://www.w3.org/1999/xhtml",m={svg:"http://www.w3.org/2000/svg",xhtml:d,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},v=function(e){var t=e+="",r=t.indexOf(":");return r>=0&&"xmlns"!==(t=e.slice(0,r))&&(e=e.slice(r+1)),m.hasOwnProperty(t)?{space:m[t],local:e}:e};var g=function(e){var t=v(e);return(t.local?function(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}:function(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===d&&t.documentElement.namespaceURI===d?t.createElement(e):t.createElementNS(r,e)}})(t)};function y(){}var b=function(e){return null==e?y:function(){return this.querySelector(e)}};function x(){return[]}var w=function(e){return null==e?x:function(){return this.querySelectorAll(e)}},S=function(e){return function(){return this.matches(e)}},M=function(e){return new Array(e.length)};function _(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}_.prototype={constructor:_,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var T="$";function A(e,t,r,n,i,o){for(var a,s=0,l=t.length,u=o.length;s<u;++s)(a=t[s])?(a.__data__=o[s],n[s]=a):r[s]=new _(e,o[s]);for(;s<l;++s)(a=t[s])&&(i[s]=a)}function C(e,t,r,n,i,o,a){var s,l,u,c={},h=t.length,p=o.length,f=new Array(h);for(s=0;s<h;++s)(l=t[s])&&(f[s]=u=T+a.call(l,l.__data__,s,t),u in c?i[s]=l:c[u]=l);for(s=0;s<p;++s)(l=c[u=T+a.call(e,o[s],s,o)])?(n[s]=l,l.__data__=o[s],c[u]=null):r[s]=new _(e,o[s]);for(s=0;s<h;++s)(l=t[s])&&c[f[s]]===l&&(i[s]=l)}function E(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}var L=function(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView};function N(e,t){return e.style.getPropertyValue(t)||L(e).getComputedStyle(e,null).getPropertyValue(t)}function P(e){return e.trim().split(/^|\s+/)}function O(e){return e.classList||new R(e)}function R(e){this._node=e,this._names=P(e.getAttribute("class")||"")}function D(e,t){for(var r=O(e),n=-1,i=t.length;++n<i;)r.add(t[n])}function F(e,t){for(var r=O(e),n=-1,i=t.length;++n<i;)r.remove(t[n])}R.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function k(){this.textContent=""}function I(){this.innerHTML=""}function B(){this.nextSibling&&this.parentNode.appendChild(this)}function U(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function V(){return null}function j(){var e=this.parentNode;e&&e.removeChild(this)}function z(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function G(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}var W={},H=null;"undefined"!==typeof document&&("onmouseenter"in document.documentElement||(W={mouseenter:"mouseover",mouseleave:"mouseout"}));function X(e,t,r){return e=q(e,t,r),function(t){var r=t.relatedTarget;r&&(r===this||8&r.compareDocumentPosition(this))||e.call(this,t)}}function q(e,t,r){return function(n){var i=H;H=n;try{e.call(this,this.__data__,t,r)}finally{H=i}}}function Y(e){return function(){var t=this.__on;if(t){for(var r,n=0,i=-1,o=t.length;n<o;++n)r=t[n],e.type&&r.type!==e.type||r.name!==e.name?t[++i]=r:this.removeEventListener(r.type,r.listener,r.capture);++i?t.length=i:delete this.__on}}}function K(e,t,r){var n=W.hasOwnProperty(e.type)?X:q;return function(i,o,a){var s,l=this.__on,u=n(t,o,a);if(l)for(var c=0,h=l.length;c<h;++c)if((s=l[c]).type===e.type&&s.name===e.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=u,s.capture=r),void(s.value=t);this.addEventListener(e.type,u,r),s={type:e.type,name:e.name,value:t,listener:u,capture:r},l?l.push(s):this.__on=[s]}}function Q(e,t,r,n){var i=H;e.sourceEvent=H,H=e;try{return t.apply(r,n)}finally{H=i}}function J(e,t,r){var n=L(e),i=n.CustomEvent;"function"===typeof i?i=new i(t,r):(i=n.document.createEvent("Event"),r?(i.initEvent(t,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}var Z=[null];function $(e,t){this._groups=e,this._parents=t}function ee(){return new $([[document.documentElement]],Z)}$.prototype=ee.prototype={constructor:$,select:function(e){"function"!==typeof e&&(e=b(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var o,a,s=t[i],l=s.length,u=n[i]=new Array(l),c=0;c<l;++c)(o=s[c])&&(a=e.call(o,o.__data__,c,s))&&("__data__"in o&&(a.__data__=o.__data__),u[c]=a);return new $(n,this._parents)},selectAll:function(e){"function"!==typeof e&&(e=w(e));for(var t=this._groups,r=t.length,n=[],i=[],o=0;o<r;++o)for(var a,s=t[o],l=s.length,u=0;u<l;++u)(a=s[u])&&(n.push(e.call(a,a.__data__,u,s)),i.push(a));return new $(n,i)},filter:function(e){"function"!==typeof e&&(e=S(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var o,a=t[i],s=a.length,l=n[i]=[],u=0;u<s;++u)(o=a[u])&&e.call(o,o.__data__,u,a)&&l.push(o);return new $(n,this._parents)},data:function(e,t){if(!e)return d=new Array(this.size()),c=-1,this.each(function(e){d[++c]=e}),d;var r,n=t?C:A,i=this._parents,o=this._groups;"function"!==typeof e&&(r=e,e=function(){return r});for(var a=o.length,s=new Array(a),l=new Array(a),u=new Array(a),c=0;c<a;++c){var h=i[c],p=o[c],f=p.length,d=e.call(h,h&&h.__data__,c,i),m=d.length,v=l[c]=new Array(m),g=s[c]=new Array(m);n(h,p,v,g,u[c]=new Array(f),d,t);for(var y,b,x=0,w=0;x<m;++x)if(y=v[x]){for(x>=w&&(w=x+1);!(b=g[w])&&++w<m;);y._next=b||null}}return(s=new $(s,i))._enter=l,s._exit=u,s},enter:function(){return new $(this._enter||this._groups.map(M),this._parents)},exit:function(){return new $(this._exit||this._groups.map(M),this._parents)},join:function(e,t,r){var n=this.enter(),i=this,o=this.exit();return n="function"===typeof e?e(n):n.append(e+""),null!=t&&(i=t(i)),null==r?o.remove():r(o),n&&i?n.merge(i).order():i},merge:function(e){for(var t=this._groups,r=e._groups,n=t.length,i=r.length,o=Math.min(n,i),a=new Array(n),s=0;s<o;++s)for(var l,u=t[s],c=r[s],h=u.length,p=a[s]=new Array(h),f=0;f<h;++f)(l=u[f]||c[f])&&(p[f]=l);for(;s<n;++s)a[s]=t[s];return new $(a,this._parents)},order:function(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var n,i=e[t],o=i.length-1,a=i[o];--o>=0;)(n=i[o])&&(a&&4^n.compareDocumentPosition(a)&&a.parentNode.insertBefore(n,a),a=n);return this},sort:function(e){function t(t,r){return t&&r?e(t.__data__,r.__data__):!t-!r}e||(e=E);for(var r=this._groups,n=r.length,i=new Array(n),o=0;o<n;++o){for(var a,s=r[o],l=s.length,u=i[o]=new Array(l),c=0;c<l;++c)(a=s[c])&&(u[c]=a);u.sort(t)}return new $(i,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){var e=new Array(this.size()),t=-1;return this.each(function(){e[++t]=this}),e},node:function(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],i=0,o=n.length;i<o;++i){var a=n[i];if(a)return a}return null},size:function(){var e=0;return this.each(function(){++e}),e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,r=0,n=t.length;r<n;++r)for(var i,o=t[r],a=0,s=o.length;a<s;++a)(i=o[a])&&e.call(i,i.__data__,a,o);return this},attr:function(e,t){var r=v(e);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((null==t?r.local?function(e){return function(){this.removeAttributeNS(e.space,e.local)}}:function(e){return function(){this.removeAttribute(e)}}:"function"===typeof t?r.local?function(e,t){return function(){var r=t.apply(this,arguments);null==r?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}:function(e,t){return function(){var r=t.apply(this,arguments);null==r?this.removeAttribute(e):this.setAttribute(e,r)}}:r.local?function(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}:function(e,t){return function(){this.setAttribute(e,t)}})(r,t))},style:function(e,t,r){return arguments.length>1?this.each((null==t?function(e){return function(){this.style.removeProperty(e)}}:"function"===typeof t?function(e,t,r){return function(){var n=t.apply(this,arguments);null==n?this.style.removeProperty(e):this.style.setProperty(e,n,r)}}:function(e,t,r){return function(){this.style.setProperty(e,t,r)}})(e,t,null==r?"":r)):N(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?function(e){return function(){delete this[e]}}:"function"===typeof t?function(e,t){return function(){var r=t.apply(this,arguments);null==r?delete this[e]:this[e]=r}}:function(e,t){return function(){this[e]=t}})(e,t)):this.node()[e]},classed:function(e,t){var r=P(e+"");if(arguments.length<2){for(var n=O(this.node()),i=-1,o=r.length;++i<o;)if(!n.contains(r[i]))return!1;return!0}return this.each(("function"===typeof t?function(e,t){return function(){(t.apply(this,arguments)?D:F)(this,e)}}:t?function(e){return function(){D(this,e)}}:function(e){return function(){F(this,e)}})(r,t))},text:function(e){return arguments.length?this.each(null==e?k:("function"===typeof e?function(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}:function(e){return function(){this.textContent=e}})(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?I:("function"===typeof e?function(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}:function(e){return function(){this.innerHTML=e}})(e)):this.node().innerHTML},raise:function(){return this.each(B)},lower:function(){return this.each(U)},append:function(e){var t="function"===typeof e?e:g(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var r="function"===typeof e?e:g(e),n=null==t?V:"function"===typeof t?t:b(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})},remove:function(){return this.each(j)},clone:function(e){return this.select(e?G:z)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,r){var n,i,o=function(e){return e.trim().split(/^|\s+/).map(function(e){var t="",r=e.indexOf(".");return r>=0&&(t=e.slice(r+1),e=e.slice(0,r)),{type:e,name:t}})}(e+""),a=o.length;if(!(arguments.length<2)){for(s=t?K:Y,null==r&&(r=!1),n=0;n<a;++n)this.each(s(o[n],t,r));return this}var s=this.node().__on;if(s)for(var l,u=0,c=s.length;u<c;++u)for(n=0,l=s[u];n<a;++n)if((i=o[n]).type===l.type&&i.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"===typeof t?function(e,t){return function(){return J(this,e,t.apply(this,arguments))}}:function(e,t){return function(){return J(this,e,t)}})(e,t))}};var te=ee,re=function(e){return"string"===typeof e?new $([[document.querySelector(e)]],[document.documentElement]):new $([[e]],Z)},ne=0;function ie(){this._="@"+(++ne).toString(36)}ie.prototype=function(){return new ie}.prototype={constructor:ie,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}};var oe=function(){for(var e,t=H;e=t.sourceEvent;)t=e;return t},ae=function(e,t){var r=e.ownerSVGElement||e;if(r.createSVGPoint){var n=r.createSVGPoint();return n.x=t.clientX,n.y=t.clientY,[(n=n.matrixTransform(e.getScreenCTM().inverse())).x,n.y]}var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]},se=function(e){var t=oe();return t.changedTouches&&(t=t.changedTouches[0]),ae(e,t)},le=function(e,t,r){arguments.length<3&&(r=t,t=oe().changedTouches);for(var n,i=0,o=t?t.length:0;i<o;++i)if((n=t[i]).identifier===r)return ae(e,n);return null};var ue=function(){H.preventDefault(),H.stopImmediatePropagation()},ce=function(e){var t=e.document.documentElement,r=re(e).on("dragstart.drag",ue,!0);"onselectstart"in t?r.on("selectstart.drag",ue,!0):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")};function he(e,t){var r=e.document.documentElement,n=re(e).on("dragstart.drag",null);t&&(n.on("click.drag",ue,!0),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in r?n.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}function pe(e,t,r,n,i,o,a,s,l,u){this.target=e,this.type=t,this.subject=r,this.identifier=n,this.active=i,this.x=o,this.y=a,this.dx=s,this.dy=l,this._=u}pe.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};var fe=function(e,t,r){e.prototype=t.prototype=r,r.constructor=e};function de(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function me(){}var ve="\\s*([+-]?\\d+)\\s*",ge="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ye="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",be=/^#([0-9a-f]{3})$/,xe=/^#([0-9a-f]{6})$/,we=new RegExp("^rgb\\("+[ve,ve,ve]+"\\)$"),Se=new RegExp("^rgb\\("+[ye,ye,ye]+"\\)$"),Me=new RegExp("^rgba\\("+[ve,ve,ve,ge]+"\\)$"),_e=new RegExp("^rgba\\("+[ye,ye,ye,ge]+"\\)$"),Te=new RegExp("^hsl\\("+[ge,ye,ye]+"\\)$"),Ae=new RegExp("^hsla\\("+[ge,ye,ye,ge]+"\\)$"),Ce={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ee(){return this.rgb().formatHex()}function Le(){return this.rgb().formatRgb()}function Ne(e){var t;return e=(e+"").trim().toLowerCase(),(t=be.exec(e))?new Fe((t=parseInt(t[1],16))>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):(t=xe.exec(e))?Pe(parseInt(t[1],16)):(t=we.exec(e))?new Fe(t[1],t[2],t[3],1):(t=Se.exec(e))?new Fe(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Me.exec(e))?Oe(t[1],t[2],t[3],t[4]):(t=_e.exec(e))?Oe(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Te.exec(e))?Ue(t[1],t[2]/100,t[3]/100,1):(t=Ae.exec(e))?Ue(t[1],t[2]/100,t[3]/100,t[4]):Ce.hasOwnProperty(e)?Pe(Ce[e]):"transparent"===e?new Fe(NaN,NaN,NaN,0):null}function Pe(e){return new Fe(e>>16&255,e>>8&255,255&e,1)}function Oe(e,t,r,n){return n<=0&&(e=t=r=NaN),new Fe(e,t,r,n)}function Re(e){return e instanceof me||(e=Ne(e)),e?new Fe((e=e.rgb()).r,e.g,e.b,e.opacity):new Fe}function De(e,t,r,n){return 1===arguments.length?Re(e):new Fe(e,t,r,null==n?1:n)}function Fe(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}function ke(){return"#"+Be(this.r)+Be(this.g)+Be(this.b)}function Ie(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function Be(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function Ue(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new ze(e,t,r,n)}function Ve(e){if(e instanceof ze)return new ze(e.h,e.s,e.l,e.opacity);if(e instanceof me||(e=Ne(e)),!e)return new ze;if(e instanceof ze)return e;var t=(e=e.rgb()).r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),o=Math.max(t,r,n),a=NaN,s=o-i,l=(o+i)/2;return s?(a=t===o?(r-n)/s+6*(r<n):r===o?(n-t)/s+2:(t-r)/s+4,s/=l<.5?o+i:2-o-i,a*=60):s=l>0&&l<1?0:a,new ze(a,s,l,e.opacity)}function je(e,t,r,n){return 1===arguments.length?Ve(e):new ze(e,t,r,null==n?1:n)}function ze(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}function Ge(e,t,r){return 255*(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)}fe(me,Ne,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:Ee,formatHex:Ee,formatHsl:function(){return Ve(this).formatHsl()},formatRgb:Le,toString:Le}),fe(Fe,De,de(me,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new Fe(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new Fe(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ke,formatHex:ke,formatRgb:Ie,toString:Ie})),fe(ze,je,de(me,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new ze(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new ze(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new Fe(Ge(e>=240?e-240:e+120,i,n),Ge(e,i,n),Ge(e<120?e+240:e-120,i,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var We=Math.PI/180,He=180/Math.PI,Xe=.96422,qe=1,Ye=.82521,Ke=4/29,Qe=6/29,Je=3*Qe*Qe,Ze=Qe*Qe*Qe;function $e(e){if(e instanceof tt)return new tt(e.l,e.a,e.b,e.opacity);if(e instanceof lt)return ut(e);e instanceof Fe||(e=Re(e));var t,r,n=ot(e.r),i=ot(e.g),o=ot(e.b),a=rt((.2225045*n+.7168786*i+.0606169*o)/qe);return n===i&&i===o?t=r=a:(t=rt((.4360747*n+.3850649*i+.1430804*o)/Xe),r=rt((.0139322*n+.0971045*i+.7141733*o)/Ye)),new tt(116*a-16,500*(t-a),200*(a-r),e.opacity)}function et(e,t,r,n){return 1===arguments.length?$e(e):new tt(e,t,r,null==n?1:n)}function tt(e,t,r,n){this.l=+e,this.a=+t,this.b=+r,this.opacity=+n}function rt(e){return e>Ze?Math.pow(e,1/3):e/Je+Ke}function nt(e){return e>Qe?e*e*e:Je*(e-Ke)}function it(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function ot(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function at(e){if(e instanceof lt)return new lt(e.h,e.c,e.l,e.opacity);if(e instanceof tt||(e=$e(e)),0===e.a&&0===e.b)return new lt(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*He;return new lt(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function st(e,t,r,n){return 1===arguments.length?at(e):new lt(e,t,r,null==n?1:n)}function lt(e,t,r,n){this.h=+e,this.c=+t,this.l=+r,this.opacity=+n}function ut(e){if(isNaN(e.h))return new tt(e.l,0,0,e.opacity);var t=e.h*We;return new tt(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}fe(tt,et,de(me,{brighter:function(e){return new tt(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new tt(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,r=isNaN(this.b)?e:e-this.b/200;return new Fe(it(3.1338561*(t=Xe*nt(t))-1.6168667*(e=qe*nt(e))-.4906146*(r=Ye*nt(r))),it(-.9787684*t+1.9161415*e+.033454*r),it(.0719453*t-.2289914*e+1.4052427*r),this.opacity)}})),fe(lt,st,de(me,{brighter:function(e){return new lt(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new lt(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return ut(this).rgb()}}));var ct=-.29227,ht=-.90649,pt=1.97294,ft=pt*ht,dt=1.78277*pt,mt=1.78277*ct- -.14861*ht;function vt(e,t,r,n){return 1===arguments.length?function(e){if(e instanceof gt)return new gt(e.h,e.s,e.l,e.opacity);e instanceof Fe||(e=Re(e));var t=e.r/255,r=e.g/255,n=e.b/255,i=(mt*n+ft*t-dt*r)/(mt+ft-dt),o=n-i,a=(pt*(r-i)-ct*o)/ht,s=Math.sqrt(a*a+o*o)/(pt*i*(1-i)),l=s?Math.atan2(a,o)*He-120:NaN;return new gt(l<0?l+360:l,s,i,e.opacity)}(e):new gt(e,t,r,null==n?1:n)}function gt(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}function yt(e,t,r,n,i){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*r+(1+3*e+3*o-3*a)*n+a*i)/6}fe(gt,vt,de(me,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new gt(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new gt(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*We,t=+this.l,r=isNaN(this.s)?0:this.s*t*(1-t),n=Math.cos(e),i=Math.sin(e);return new Fe(255*(t+r*(-.14861*n+1.78277*i)),255*(t+r*(ct*n+ht*i)),255*(t+r*(pt*n)),this.opacity)}}));var bt=function(e){return function(){return e}};function xt(e,t){return function(r){return e+r*t}}function wt(e,t){var r=t-e;return r?xt(e,r>180||r<-180?r-360*Math.round(r/360):r):bt(isNaN(e)?t:e)}function St(e){return 1===(e=+e)?Mt:function(t,r){return r-t?function(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}(t,r,e):bt(isNaN(t)?r:t)}}function Mt(e,t){var r=t-e;return r?xt(e,r):bt(isNaN(e)?t:e)}var _t=function e(t){var r=St(t);function n(e,t){var n=r((e=De(e)).r,(t=De(t)).r),i=r(e.g,t.g),o=r(e.b,t.b),a=Mt(e.opacity,t.opacity);return function(t){return e.r=n(t),e.g=i(t),e.b=o(t),e.opacity=a(t),e+""}}return n.gamma=e,n}(1);function Tt(e){return function(t){var r,n,i=t.length,o=new Array(i),a=new Array(i),s=new Array(i);for(r=0;r<i;++r)n=De(t[r]),o[r]=n.r||0,a[r]=n.g||0,s[r]=n.b||0;return o=e(o),a=e(a),s=e(s),n.opacity=1,function(e){return n.r=o(e),n.g=a(e),n.b=s(e),n+""}}}Tt(function(e){var t=e.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),i=e[n],o=e[n+1],a=n>0?e[n-1]:2*i-o,s=n<t-1?e[n+2]:2*o-i;return yt((r-n/t)*t,a,i,o,s)}}),Tt(function(e){var t=e.length;return function(r){var n=Math.floor(((r%=1)<0?++r:r)*t),i=e[(n+t-1)%t],o=e[n%t],a=e[(n+1)%t],s=e[(n+2)%t];return yt((r-n/t)*t,i,o,a,s)}});var At=function(e,t){return t-=e=+e,function(r){return e+t*r}},Ct=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Et=new RegExp(Ct.source,"g");var Lt,Nt,Pt,Ot,Rt=function(e,t){var r,n,i,o=Ct.lastIndex=Et.lastIndex=0,a=-1,s=[],l=[];for(e+="",t+="";(r=Ct.exec(e))&&(n=Et.exec(t));)(i=n.index)>o&&(i=t.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(r=r[0])===(n=n[0])?s[a]?s[a]+=n:s[++a]=n:(s[++a]=null,l.push({i:a,x:At(r,n)})),o=Et.lastIndex;return o<t.length&&(i=t.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var r,n=0;n<t;++n)s[(r=l[n]).i]=r.x(e);return s.join("")})},Dt=180/Math.PI,Ft={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},kt=function(e,t,r,n,i,o){var a,s,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*r+t*n)&&(r-=e*l,n-=t*l),(s=Math.sqrt(r*r+n*n))&&(r/=s,n/=s,l/=s),e*n<t*r&&(e=-e,t=-t,l=-l,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*Dt,skewX:Math.atan(l)*Dt,scaleX:a,scaleY:s}};function It(e,t,r,n){function i(e){return e.length?e.pop()+" ":""}return function(o,a){var s=[],l=[];return o=e(o),a=e(a),function(e,n,i,o,a,s){if(e!==i||n!==o){var l=a.push("translate(",null,t,null,r);s.push({i:l-4,x:At(e,i)},{i:l-2,x:At(n,o)})}else(i||o)&&a.push("translate("+i+t+o+r)}(o.translateX,o.translateY,a.translateX,a.translateY,s,l),function(e,t,r,o){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),o.push({i:r.push(i(r)+"rotate(",null,n)-2,x:At(e,t)})):t&&r.push(i(r)+"rotate("+t+n)}(o.rotate,a.rotate,s,l),function(e,t,r,o){e!==t?o.push({i:r.push(i(r)+"skewX(",null,n)-2,x:At(e,t)}):t&&r.push(i(r)+"skewX("+t+n)}(o.skewX,a.skewX,s,l),function(e,t,r,n,o,a){if(e!==r||t!==n){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:At(e,r)},{i:s-2,x:At(t,n)})}else 1===r&&1===n||o.push(i(o)+"scale("+r+","+n+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,l),o=a=null,function(e){for(var t,r=-1,n=l.length;++r<n;)s[(t=l[r]).i]=t.x(e);return s.join("")}}}var Bt=It(function(e){return"none"===e?Ft:(Lt||(Lt=document.createElement("DIV"),Nt=document.documentElement,Pt=document.defaultView),Lt.style.transform=e,e=Pt.getComputedStyle(Nt.appendChild(Lt),null).getPropertyValue("transform"),Nt.removeChild(Lt),e=e.slice(7,-1).split(","),kt(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5]))},"px, ","px)","deg)"),Ut=It(function(e){return null==e?Ft:(Ot||(Ot=document.createElementNS("http://www.w3.org/2000/svg","g")),Ot.setAttribute("transform",e),(e=Ot.transform.baseVal.consolidate())?(e=e.matrix,kt(e.a,e.b,e.c,e.d,e.e,e.f)):Ft)},", ",")",")"),Vt=Math.SQRT2;function jt(e){return((e=Math.exp(e))+1/e)/2}var zt=function(e,t){var r,n,i=e[0],o=e[1],a=e[2],s=t[0],l=t[1],u=t[2],c=s-i,h=l-o,p=c*c+h*h;if(p<1e-12)n=Math.log(u/a)/Vt,r=function(e){return[i+e*c,o+e*h,a*Math.exp(Vt*e*n)]};else{var f=Math.sqrt(p),d=(u*u-a*a+4*p)/(2*a*2*f),m=(u*u-a*a-4*p)/(2*u*2*f),v=Math.log(Math.sqrt(d*d+1)-d),g=Math.log(Math.sqrt(m*m+1)-m);n=(g-v)/Vt,r=function(e){var t,r=e*n,s=jt(v),l=a/(2*f)*(s*(t=Vt*r+v,((t=Math.exp(2*t))-1)/(t+1))-function(e){return((e=Math.exp(e))-1/e)/2}(v));return[i+l*c,o+l*h,a*s/jt(Vt*r+v)]}}return r.duration=1e3*n,r};function Gt(e){return function(t,r){var n=e((t=je(t)).h,(r=je(r)).h),i=Mt(t.s,r.s),o=Mt(t.l,r.l),a=Mt(t.opacity,r.opacity);return function(e){return t.h=n(e),t.s=i(e),t.l=o(e),t.opacity=a(e),t+""}}}Gt(wt),Gt(Mt);function Wt(e){return function(t,r){var n=e((t=st(t)).h,(r=st(r)).h),i=Mt(t.c,r.c),o=Mt(t.l,r.l),a=Mt(t.opacity,r.opacity);return function(e){return t.h=n(e),t.c=i(e),t.l=o(e),t.opacity=a(e),t+""}}}Wt(wt),Wt(Mt);function Ht(e){return function t(r){function n(t,n){var i=e((t=vt(t)).h,(n=vt(n)).h),o=Mt(t.s,n.s),a=Mt(t.l,n.l),s=Mt(t.opacity,n.opacity);return function(e){return t.h=i(e),t.s=o(e),t.l=a(Math.pow(e,r)),t.opacity=s(e),t+""}}return r=+r,n.gamma=t,n}(1)}Ht(wt),Ht(Mt);var Xt,qt,Yt=0,Kt=0,Qt=0,Jt=1e3,Zt=0,$t=0,er=0,tr="object"===typeof performance&&performance.now?performance:Date,rr="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function nr(){return $t||(rr(ir),$t=tr.now()+er)}function ir(){$t=0}function or(){this._call=this._time=this._next=null}function ar(e,t,r){var n=new or;return n.restart(e,t,r),n}function sr(){$t=(Zt=tr.now())+er,Yt=Kt=0;try{!function(){nr(),++Yt;for(var e,t=Xt;t;)(e=$t-t._time)>=0&&t._call.call(null,e),t=t._next;--Yt}()}finally{Yt=0,function(){var e,t,r=Xt,n=1/0;for(;r;)r._call?(n>r._time&&(n=r._time),e=r,r=r._next):(t=r._next,r._next=null,r=e?e._next=t:Xt=t);qt=e,ur(n)}(),$t=0}}function lr(){var e=tr.now(),t=e-Zt;t>Jt&&(er-=t,Zt=e)}function ur(e){Yt||(Kt&&(Kt=clearTimeout(Kt)),e-$t>24?(e<1/0&&(Kt=setTimeout(sr,e-tr.now()-er)),Qt&&(Qt=clearInterval(Qt))):(Qt||(Zt=tr.now(),Qt=setInterval(lr,Jt)),Yt=1,rr(sr)))}or.prototype=ar.prototype={constructor:or,restart:function(e,t,r){if("function"!==typeof e)throw new TypeError("callback is not a function");r=(null==r?nr():+r)+(null==t?0:+t),this._next||qt===this||(qt?qt._next=this:Xt=this,qt=this),this._call=e,this._time=r,ur()},stop:function(){this._call&&(this._call=null,this._time=1/0,ur())}};var cr=function(e,t,r){var n=new or;return t=null==t?0:+t,n.restart(function(r){n.stop(),e(r+t)},t,r),n},hr=f("start","end","cancel","interrupt"),pr=[],fr=0,dr=1,mr=2,vr=3,gr=4,yr=5,br=6,xr=function(e,t,r,n,i,o){var a=e.__transition;if(a){if(r in a)return}else e.__transition={};!function(e,t,r){var n,i=e.__transition;function o(l){var u,c,h,p;if(r.state!==dr)return s();for(u in i)if((p=i[u]).name===r.name){if(p.state===vr)return cr(o);p.state===gr?(p.state=br,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete i[u]):+u<t&&(p.state=br,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete i[u])}if(cr(function(){r.state===vr&&(r.state=gr,r.timer.restart(a,r.delay,r.time),a(l))}),r.state=mr,r.on.call("start",e,e.__data__,r.index,r.group),r.state===mr){for(r.state=vr,n=new Array(h=r.tween.length),u=0,c=-1;u<h;++u)(p=r.tween[u].value.call(e,e.__data__,r.index,r.group))&&(n[++c]=p);n.length=c+1}}function a(t){for(var i=t<r.duration?r.ease.call(null,t/r.duration):(r.timer.restart(s),r.state=yr,1),o=-1,a=n.length;++o<a;)n[o].call(e,i);r.state===yr&&(r.on.call("end",e,e.__data__,r.index,r.group),s())}function s(){for(var n in r.state=br,r.timer.stop(),delete i[t],i)return;delete e.__transition}i[t]=r,r.timer=ar(function(e){r.state=dr,r.timer.restart(o,r.delay,r.time),r.delay<=e&&o(e-r.delay)},0,r.time)}(e,r,{name:t,index:n,group:i,on:hr,tween:pr,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:fr})};function wr(e,t){var r=Mr(e,t);if(r.state>fr)throw new Error("too late; already scheduled");return r}function Sr(e,t){var r=Mr(e,t);if(r.state>vr)throw new Error("too late; already running");return r}function Mr(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}var _r=function(e,t){var r,n,i,o=e.__transition,a=!0;if(o){for(i in t=null==t?null:t+"",o)(r=o[i]).name===t?(n=r.state>mr&&r.state<yr,r.state=br,r.timer.stop(),r.on.call(n?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete o[i]):a=!1;a&&delete e.__transition}};function Tr(e,t,r){var n=e._id;return e.each(function(){var e=Sr(this,n);(e.value||(e.value={}))[t]=r.apply(this,arguments)}),function(e){return Mr(e,n).value[t]}}var Ar=function(e,t){var r;return("number"===typeof t?At:t instanceof Ne?_t:(r=Ne(t))?(t=r,_t):Rt)(e,t)};var Cr=te.prototype.constructor;function Er(e){return function(){this.style.removeProperty(e)}}var Lr=0;function Nr(e,t,r,n){this._groups=e,this._parents=t,this._name=r,this._id=n}function Pr(){return++Lr}var Or=te.prototype;Nr.prototype=function(e){return te().transition(e)}.prototype={constructor:Nr,select:function(e){var t=this._name,r=this._id;"function"!==typeof e&&(e=b(e));for(var n=this._groups,i=n.length,o=new Array(i),a=0;a<i;++a)for(var s,l,u=n[a],c=u.length,h=o[a]=new Array(c),p=0;p<c;++p)(s=u[p])&&(l=e.call(s,s.__data__,p,u))&&("__data__"in s&&(l.__data__=s.__data__),h[p]=l,xr(h[p],t,r,p,h,Mr(s,r)));return new Nr(o,this._parents,t,r)},selectAll:function(e){var t=this._name,r=this._id;"function"!==typeof e&&(e=w(e));for(var n=this._groups,i=n.length,o=[],a=[],s=0;s<i;++s)for(var l,u=n[s],c=u.length,h=0;h<c;++h)if(l=u[h]){for(var p,f=e.call(l,l.__data__,h,u),d=Mr(l,r),m=0,v=f.length;m<v;++m)(p=f[m])&&xr(p,t,r,m,f,d);o.push(f),a.push(l)}return new Nr(o,a,t,r)},filter:function(e){"function"!==typeof e&&(e=S(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var o,a=t[i],s=a.length,l=n[i]=[],u=0;u<s;++u)(o=a[u])&&e.call(o,o.__data__,u,a)&&l.push(o);return new Nr(n,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,n=t.length,i=r.length,o=Math.min(n,i),a=new Array(n),s=0;s<o;++s)for(var l,u=t[s],c=r[s],h=u.length,p=a[s]=new Array(h),f=0;f<h;++f)(l=u[f]||c[f])&&(p[f]=l);for(;s<n;++s)a[s]=t[s];return new Nr(a,this._parents,this._name,this._id)},selection:function(){return new Cr(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,r=Pr(),n=this._groups,i=n.length,o=0;o<i;++o)for(var a,s=n[o],l=s.length,u=0;u<l;++u)if(a=s[u]){var c=Mr(a,t);xr(a,e,r,u,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Nr(n,this._parents,e,r)},call:Or.call,nodes:Or.nodes,node:Or.node,size:Or.size,empty:Or.empty,each:Or.each,on:function(e,t){var r=this._id;return arguments.length<2?Mr(this.node(),r).on.on(e):this.each(function(e,t,r){var n,i,o=function(e){return(e+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e})}(t)?wr:Sr;return function(){var a=o(this,e),s=a.on;s!==n&&(i=(n=s).copy()).on(t,r),a.on=i}}(r,e,t))},attr:function(e,t){var r=v(e),n="transform"===r?Ut:Ar;return this.attrTween(e,"function"===typeof t?(r.local?function(e,t,r){var n,i,o;return function(){var a,s,l=r(this);if(null!=l)return(a=this.getAttributeNS(e.space,e.local))===(s=l+"")?null:a===n&&s===i?o:(i=s,o=t(n=a,l));this.removeAttributeNS(e.space,e.local)}}:function(e,t,r){var n,i,o;return function(){var a,s,l=r(this);if(null!=l)return(a=this.getAttribute(e))===(s=l+"")?null:a===n&&s===i?o:(i=s,o=t(n=a,l));this.removeAttribute(e)}})(r,n,Tr(this,"attr."+e,t)):null==t?(r.local?function(e){return function(){this.removeAttributeNS(e.space,e.local)}}:function(e){return function(){this.removeAttribute(e)}})(r):(r.local?function(e,t,r){var n,i,o=r+"";return function(){var a=this.getAttributeNS(e.space,e.local);return a===o?null:a===n?i:i=t(n=a,r)}}:function(e,t,r){var n,i,o=r+"";return function(){var a=this.getAttribute(e);return a===o?null:a===n?i:i=t(n=a,r)}})(r,n,t))},attrTween:function(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!==typeof t)throw new Error;var n=v(e);return this.tween(r,(n.local?function(e,t){var r,n;function i(){var i=t.apply(this,arguments);return i!==n&&(r=(n=i)&&function(e,t){return function(r){this.setAttributeNS(e.space,e.local,t(r))}}(e,i)),r}return i._value=t,i}:function(e,t){var r,n;function i(){var i=t.apply(this,arguments);return i!==n&&(r=(n=i)&&function(e,t){return function(r){this.setAttribute(e,t(r))}}(e,i)),r}return i._value=t,i})(n,t))},style:function(e,t,r){var n="transform"===(e+="")?Bt:Ar;return null==t?this.styleTween(e,function(e,t){var r,n,i;return function(){var o=N(this,e),a=(this.style.removeProperty(e),N(this,e));return o===a?null:o===r&&a===n?i:i=t(r=o,n=a)}}(e,n)).on("end.style."+e,Er(e)):"function"===typeof t?this.styleTween(e,function(e,t,r){var n,i,o;return function(){var a=N(this,e),s=r(this),l=s+"";return null==s&&(this.style.removeProperty(e),l=s=N(this,e)),a===l?null:a===n&&l===i?o:(i=l,o=t(n=a,s))}}(e,n,Tr(this,"style."+e,t))).each(function(e,t){var r,n,i,o,a="style."+t,s="end."+a;return function(){var l=Sr(this,e),u=l.on,c=null==l.value[a]?o||(o=Er(t)):void 0;u===r&&i===c||(n=(r=u).copy()).on(s,i=c),l.on=n}}(this._id,e)):this.styleTween(e,function(e,t,r){var n,i,o=r+"";return function(){var a=N(this,e);return a===o?null:a===n?i:i=t(n=a,r)}}(e,n,t),r).on("end.style."+e,null)},styleTween:function(e,t,r){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!==typeof t)throw new Error;return this.tween(n,function(e,t,r){var n,i;function o(){var o=t.apply(this,arguments);return o!==i&&(n=(i=o)&&function(e,t,r){return function(n){this.style.setProperty(e,t(n),r)}}(e,o,r)),n}return o._value=t,o}(e,t,null==r?"":r))},text:function(e){return this.tween("text","function"===typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(Tr(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},remove:function(){return this.on("end.remove",(e=this._id,function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}));var e},tween:function(e,t){var r=this._id;if(e+="",arguments.length<2){for(var n,i=Mr(this.node(),r).tween,o=0,a=i.length;o<a;++o)if((n=i[o]).name===e)return n.value;return null}return this.each((null==t?function(e,t){var r,n;return function(){var i=Sr(this,e),o=i.tween;if(o!==r)for(var a=0,s=(n=r=o).length;a<s;++a)if(n[a].name===t){(n=n.slice()).splice(a,1);break}i.tween=n}}:function(e,t,r){var n,i;if("function"!==typeof r)throw new Error;return function(){var o=Sr(this,e),a=o.tween;if(a!==n){i=(n=a).slice();for(var s={name:t,value:r},l=0,u=i.length;l<u;++l)if(i[l].name===t){i[l]=s;break}l===u&&i.push(s)}o.tween=i}})(r,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"===typeof e?function(e,t){return function(){wr(this,e).delay=+t.apply(this,arguments)}}:function(e,t){return t=+t,function(){wr(this,e).delay=t}})(t,e)):Mr(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"===typeof e?function(e,t){return function(){Sr(this,e).duration=+t.apply(this,arguments)}}:function(e,t){return t=+t,function(){Sr(this,e).duration=t}})(t,e)):Mr(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(function(e,t){if("function"!==typeof t)throw new Error;return function(){Sr(this,e).ease=t}}(t,e)):Mr(this.node(),t).ease},end:function(){var e,t,r=this,n=r._id,i=r.size();return new Promise(function(o,a){var s={value:a},l={value:function(){0===--i&&o()}};r.each(function(){var r=Sr(this,n),i=r.on;i!==e&&((t=(e=i).copy())._.cancel.push(s),t._.interrupt.push(s),t._.end.push(l)),r.on=t})})}};(function e(t){function r(e){return Math.pow(e,t)}return t=+t,r.exponent=e,r})(3),function e(t){function r(e){return 1-Math.pow(1-e,t)}return t=+t,r.exponent=e,r}(3),function e(t){function r(e){return((e*=2)<=1?Math.pow(e,t):2-Math.pow(2-e,t))/2}return t=+t,r.exponent=e,r}(3),Math.PI;(function e(t){function r(e){return e*e*((t+1)*e-t)}return t=+t,r.overshoot=e,r})(1.70158),function e(t){function r(e){return--e*e*((t+1)*e+t)+1}return t=+t,r.overshoot=e,r}(1.70158),function e(t){function r(e){return((e*=2)<1?e*e*((t+1)*e-t):(e-=2)*e*((t+1)*e+t)+2)/2}return t=+t,r.overshoot=e,r}(1.70158);var Rr=2*Math.PI,Dr=(function e(t,r){var n=Math.asin(1/(t=Math.max(1,t)))*(r/=Rr);function i(e){return t*Math.pow(2,10*--e)*Math.sin((n-e)/r)}return i.amplitude=function(t){return e(t,r*Rr)},i.period=function(r){return e(t,r)},i}(1,.3),function e(t,r){var n=Math.asin(1/(t=Math.max(1,t)))*(r/=Rr);function i(e){return 1-t*Math.pow(2,-10*(e=+e))*Math.sin((e+n)/r)}return i.amplitude=function(t){return e(t,r*Rr)},i.period=function(r){return e(t,r)},i}(1,.3),function e(t,r){var n=Math.asin(1/(t=Math.max(1,t)))*(r/=Rr);function i(e){return((e=2*e-1)<0?t*Math.pow(2,10*e)*Math.sin((n-e)/r):2-t*Math.pow(2,-10*e)*Math.sin((n+e)/r))/2}return i.amplitude=function(t){return e(t,r*Rr)},i.period=function(r){return e(t,r)},i}(1,.3),{time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}});function Fr(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))return Dr.time=nr(),Dr;return r}te.prototype.interrupt=function(e){return this.each(function(){_r(this,e)})},te.prototype.transition=function(e){var t,r;e instanceof Nr?(t=e._id,e=e._name):(t=Pr(),(r=Dr).time=nr(),e=null==e?null:e+"");for(var n=this._groups,i=n.length,o=0;o<i;++o)for(var a,s=n[o],l=s.length,u=0;u<l;++u)(a=s[u])&&xr(a,e,t,u,s,r||Fr(a,t));return new Nr(n,this._parents,e,t)};function kr(e){return[+e[0],+e[1]]}function Ir(e){return[kr(e[0]),kr(e[1])]}["w","e"].map(Br),["n","s"].map(Br),["n","w","e","s","nw","ne","sw","se"].map(Br);function Br(e){return{type:e}}Math.cos,Math.sin,Math.PI,Math.max;Array.prototype.slice;var Ur=Math.PI,Vr=2*Ur,jr=Vr-1e-6;function zr(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Gr(){return new zr}zr.prototype=Gr.prototype={constructor:zr,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,r,n){this._+="Q"+ +e+","+ +t+","+(this._x1=+r)+","+(this._y1=+n)},bezierCurveTo:function(e,t,r,n,i,o){this._+="C"+ +e+","+ +t+","+ +r+","+ +n+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(e,t,r,n,i){e=+e,t=+t,r=+r,n=+n,i=+i;var o=this._x1,a=this._y1,s=r-e,l=n-t,u=o-e,c=a-t,h=u*u+c*c;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(h>1e-6)if(Math.abs(c*s-l*u)>1e-6&&i){var p=r-o,f=n-a,d=s*s+l*l,m=p*p+f*f,v=Math.sqrt(d),g=Math.sqrt(h),y=i*Math.tan((Ur-Math.acos((d+h-m)/(2*v*g)))/2),b=y/g,x=y/v;Math.abs(b-1)>1e-6&&(this._+="L"+(e+b*u)+","+(t+b*c)),this._+="A"+i+","+i+",0,0,"+ +(c*p>u*f)+","+(this._x1=e+x*s)+","+(this._y1=t+x*l)}else this._+="L"+(this._x1=e)+","+(this._y1=t);else;},arc:function(e,t,r,n,i,o){e=+e,t=+t,o=!!o;var a=(r=+r)*Math.cos(n),s=r*Math.sin(n),l=e+a,u=t+s,c=1^o,h=o?n-i:i-n;if(r<0)throw new Error("negative radius: "+r);null===this._x1?this._+="M"+l+","+u:(Math.abs(this._x1-l)>1e-6||Math.abs(this._y1-u)>1e-6)&&(this._+="L"+l+","+u),r&&(h<0&&(h=h%Vr+Vr),h>jr?this._+="A"+r+","+r+",0,1,"+c+","+(e-a)+","+(t-s)+"A"+r+","+r+",0,1,"+c+","+(this._x1=l)+","+(this._y1=u):h>1e-6&&(this._+="A"+r+","+r+",0,"+ +(h>=Ur)+","+c+","+(this._x1=e+r*Math.cos(i))+","+(this._y1=t+r*Math.sin(i))))},rect:function(e,t,r,n){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +r+"v"+ +n+"h"+-r+"Z"},toString:function(){return this._}};function Wr(){}function Hr(e,t){var r=new Wr;if(e instanceof Wr)e.each(function(e,t){r.set(t,e)});else if(Array.isArray(e)){var n,i=-1,o=e.length;if(null==t)for(;++i<o;)r.set(i,e[i]);else for(;++i<o;)r.set(t(n=e[i],i,e),n)}else if(e)for(var a in e)r.set(a,e[a]);return r}Wr.prototype=Hr.prototype={constructor:Wr,has:function(e){return"$"+e in this},get:function(e){return this["$"+e]},set:function(e,t){return this["$"+e]=t,this},remove:function(e){var t="$"+e;return t in this&&delete this[t]},clear:function(){for(var e in this)"$"===e[0]&&delete this[e]},keys:function(){var e=[];for(var t in this)"$"===t[0]&&e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)"$"===t[0]&&e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)"$"===t[0]&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var t in this)"$"===t[0]&&++e;return e},empty:function(){for(var e in this)if("$"===e[0])return!1;return!0},each:function(e){for(var t in this)"$"===t[0]&&e(this[t],t.slice(1),this)}};var Xr=Hr;function qr(){}var Yr=Xr.prototype;function Kr(e,t){var r=new qr;if(e instanceof qr)e.each(function(e){r.add(e)});else if(e){var n=-1,i=e.length;if(null==t)for(;++n<i;)r.add(e[n]);else for(;++n<i;)r.add(t(e[n],n,e))}return r}qr.prototype=Kr.prototype={constructor:qr,has:Yr.has,add:function(e){return this["$"+(e+="")]=e,this},remove:Yr.remove,clear:Yr.clear,values:Yr.keys,size:Yr.size,empty:Yr.empty,each:Yr.each};Array.prototype.slice;var Qr={},Jr={},Zr=34,$r=10,en=13;function tn(e){return new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+"]"}).join(",")+"}")}function rn(e){var t=Object.create(null),r=[];return e.forEach(function(e){for(var n in e)n in t||r.push(t[n]=n)}),r}function nn(e,t){var r=e+"",n=r.length;return n<t?new Array(t-n+1).join(0)+r:r}function on(e){var t,r=e.getUTCHours(),n=e.getUTCMinutes(),i=e.getUTCSeconds(),o=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":((t=e.getUTCFullYear())<0?"-"+nn(-t,6):t>9999?"+"+nn(t,6):nn(t,4))+"-"+nn(e.getUTCMonth()+1,2)+"-"+nn(e.getUTCDate(),2)+(o?"T"+nn(r,2)+":"+nn(n,2)+":"+nn(i,2)+"."+nn(o,3)+"Z":i?"T"+nn(r,2)+":"+nn(n,2)+":"+nn(i,2)+"Z":n||r?"T"+nn(r,2)+":"+nn(n,2)+"Z":"")}var an=function(e){var t=new RegExp('["'+e+"\n\r]"),r=e.charCodeAt(0);function n(e,t){var n,i=[],o=e.length,a=0,s=0,l=o<=0,u=!1;function c(){if(l)return Jr;if(u)return u=!1,Qr;var t,n,i=a;if(e.charCodeAt(i)===Zr){for(;a++<o&&e.charCodeAt(a)!==Zr||e.charCodeAt(++a)===Zr;);return(t=a)>=o?l=!0:(n=e.charCodeAt(a++))===$r?u=!0:n===en&&(u=!0,e.charCodeAt(a)===$r&&++a),e.slice(i+1,t-1).replace(/""/g,'"')}for(;a<o;){if((n=e.charCodeAt(t=a++))===$r)u=!0;else if(n===en)u=!0,e.charCodeAt(a)===$r&&++a;else if(n!==r)continue;return e.slice(i,t)}return l=!0,e.slice(i,o)}for(e.charCodeAt(o-1)===$r&&--o,e.charCodeAt(o-1)===en&&--o;(n=c())!==Jr;){for(var h=[];n!==Qr&&n!==Jr;)h.push(n),n=c();t&&null==(h=t(h,s++))||i.push(h)}return i}function i(t,r){return t.map(function(t){return r.map(function(e){return a(t[e])}).join(e)})}function o(t){return t.map(a).join(e)}function a(e){return null==e?"":e instanceof Date?on(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var r,i,o=n(e,function(e,n){if(r)return r(e,n-1);i=e,r=t?function(e,t){var r=tn(e);return function(n,i){return t(r(n),i,e)}}(e,t):tn(e)});return o.columns=i||[],o},parseRows:n,format:function(t,r){return null==r&&(r=rn(t)),[r.map(a).join(e)].concat(i(t,r)).join("\n")},formatBody:function(e,t){return null==t&&(t=rn(e)),i(e,t).join("\n")},formatRows:function(e){return e.map(o).join("\n")}}},sn=an(","),ln=sn.parse,un=(sn.parseRows,sn.format,sn.formatBody,sn.formatRows,an("\t")),cn=un.parse;un.parseRows,un.format,un.formatBody,un.formatRows;function hn(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}var pn=function(e,t){return fetch(e,t).then(hn)};function fn(e){return function(t,r,n){return 2===arguments.length&&"function"===typeof r&&(n=r,r=void 0),pn(t,r).then(function(t){return e(t,n)})}}fn(ln),fn(cn);function dn(e){return function(t,r){return pn(t,r).then(function(t){return(new DOMParser).parseFromString(t,e)})}}dn("application/xml"),dn("text/html"),dn("image/svg+xml");function mn(e,t,r,n){if(isNaN(t)||isNaN(r))return e;var i,o,a,s,l,u,c,h,p,f=e._root,d={data:n},m=e._x0,v=e._y0,g=e._x1,y=e._y1;if(!f)return e._root=d,e;for(;f.length;)if((u=t>=(o=(m+g)/2))?m=o:g=o,(c=r>=(a=(v+y)/2))?v=a:y=a,i=f,!(f=f[h=c<<1|u]))return i[h]=d,e;if(s=+e._x.call(null,f.data),l=+e._y.call(null,f.data),t===s&&r===l)return d.next=f,i?i[h]=d:e._root=d,e;do{i=i?i[h]=new Array(4):e._root=new Array(4),(u=t>=(o=(m+g)/2))?m=o:g=o,(c=r>=(a=(v+y)/2))?v=a:y=a}while((h=c<<1|u)===(p=(l>=a)<<1|s>=o));return i[p]=f,i[h]=d,e}var vn=function(e,t,r,n,i){this.node=e,this.x0=t,this.y0=r,this.x1=n,this.y1=i};function gn(e){return e[0]}function yn(e){return e[1]}function bn(e,t,r){var n=new xn(null==t?gn:t,null==r?yn:r,NaN,NaN,NaN,NaN);return null==e?n:n.addAll(e)}function xn(e,t,r,n,i,o){this._x=e,this._y=t,this._x0=r,this._y0=n,this._x1=i,this._y1=o,this._root=void 0}function wn(e){for(var t={data:e.data},r=t;e=e.next;)r=r.next={data:e.data};return t}var Sn=bn.prototype=xn.prototype;Sn.copy=function(){var e,t,r=new xn(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return r;if(!n.length)return r._root=wn(n),r;for(e=[{source:n,target:r._root=new Array(4)}];n=e.pop();)for(var i=0;i<4;++i)(t=n.source[i])&&(t.length?e.push({source:t,target:n.target[i]=new Array(4)}):n.target[i]=wn(t));return r},Sn.add=function(e){var t=+this._x.call(null,e),r=+this._y.call(null,e);return mn(this.cover(t,r),t,r,e)},Sn.addAll=function(e){var t,r,n,i,o=e.length,a=new Array(o),s=new Array(o),l=1/0,u=1/0,c=-1/0,h=-1/0;for(r=0;r<o;++r)isNaN(n=+this._x.call(null,t=e[r]))||isNaN(i=+this._y.call(null,t))||(a[r]=n,s[r]=i,n<l&&(l=n),n>c&&(c=n),i<u&&(u=i),i>h&&(h=i));if(l>c||u>h)return this;for(this.cover(l,u).cover(c,h),r=0;r<o;++r)mn(this,a[r],s[r],e[r]);return this},Sn.cover=function(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var r=this._x0,n=this._y0,i=this._x1,o=this._y1;if(isNaN(r))i=(r=Math.floor(e))+1,o=(n=Math.floor(t))+1;else{for(var a,s,l=i-r,u=this._root;r>e||e>=i||n>t||t>=o;)switch(s=(t<n)<<1|e<r,(a=new Array(4))[s]=u,u=a,l*=2,s){case 0:i=r+l,o=n+l;break;case 1:r=i-l,o=n+l;break;case 2:i=r+l,n=o-l;break;case 3:r=i-l,n=o-l}this._root&&this._root.length&&(this._root=u)}return this._x0=r,this._y0=n,this._x1=i,this._y1=o,this},Sn.data=function(){var e=[];return this.visit(function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)}),e},Sn.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Sn.find=function(e,t,r){var n,i,o,a,s,l,u,c=this._x0,h=this._y0,p=this._x1,f=this._y1,d=[],m=this._root;for(m&&d.push(new vn(m,c,h,p,f)),null==r?r=1/0:(c=e-r,h=t-r,p=e+r,f=t+r,r*=r);l=d.pop();)if(!(!(m=l.node)||(i=l.x0)>p||(o=l.y0)>f||(a=l.x1)<c||(s=l.y1)<h))if(m.length){var v=(i+a)/2,g=(o+s)/2;d.push(new vn(m[3],v,g,a,s),new vn(m[2],i,g,v,s),new vn(m[1],v,o,a,g),new vn(m[0],i,o,v,g)),(u=(t>=g)<<1|e>=v)&&(l=d[d.length-1],d[d.length-1]=d[d.length-1-u],d[d.length-1-u]=l)}else{var y=e-+this._x.call(null,m.data),b=t-+this._y.call(null,m.data),x=y*y+b*b;if(x<r){var w=Math.sqrt(r=x);c=e-w,h=t-w,p=e+w,f=t+w,n=m.data}}return n},Sn.remove=function(e){if(isNaN(o=+this._x.call(null,e))||isNaN(a=+this._y.call(null,e)))return this;var t,r,n,i,o,a,s,l,u,c,h,p,f=this._root,d=this._x0,m=this._y0,v=this._x1,g=this._y1;if(!f)return this;if(f.length)for(;;){if((u=o>=(s=(d+v)/2))?d=s:v=s,(c=a>=(l=(m+g)/2))?m=l:g=l,t=f,!(f=f[h=c<<1|u]))return this;if(!f.length)break;(t[h+1&3]||t[h+2&3]||t[h+3&3])&&(r=t,p=h)}for(;f.data!==e;)if(n=f,!(f=f.next))return this;return(i=f.next)&&delete f.next,n?(i?n.next=i:delete n.next,this):t?(i?t[h]=i:delete t[h],(f=t[0]||t[1]||t[2]||t[3])&&f===(t[3]||t[2]||t[1]||t[0])&&!f.length&&(r?r[p]=f:this._root=f),this):(this._root=i,this)},Sn.removeAll=function(e){for(var t=0,r=e.length;t<r;++t)this.remove(e[t]);return this},Sn.root=function(){return this._root},Sn.size=function(){var e=0;return this.visit(function(t){if(!t.length)do{++e}while(t=t.next)}),e},Sn.visit=function(e){var t,r,n,i,o,a,s=[],l=this._root;for(l&&s.push(new vn(l,this._x0,this._y0,this._x1,this._y1));t=s.pop();)if(!e(l=t.node,n=t.x0,i=t.y0,o=t.x1,a=t.y1)&&l.length){var u=(n+o)/2,c=(i+a)/2;(r=l[3])&&s.push(new vn(r,u,c,o,a)),(r=l[2])&&s.push(new vn(r,n,c,u,a)),(r=l[1])&&s.push(new vn(r,u,i,o,c)),(r=l[0])&&s.push(new vn(r,n,i,u,c))}return this},Sn.visitAfter=function(e){var t,r=[],n=[];for(this._root&&r.push(new vn(this._root,this._x0,this._y0,this._x1,this._y1));t=r.pop();){var i=t.node;if(i.length){var o,a=t.x0,s=t.y0,l=t.x1,u=t.y1,c=(a+l)/2,h=(s+u)/2;(o=i[0])&&r.push(new vn(o,a,s,c,h)),(o=i[1])&&r.push(new vn(o,c,s,l,h)),(o=i[2])&&r.push(new vn(o,a,h,c,u)),(o=i[3])&&r.push(new vn(o,c,h,l,u))}n.push(t)}for(;t=n.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this},Sn.x=function(e){return arguments.length?(this._x=e,this):this._x},Sn.y=function(e){return arguments.length?(this._y=e,this):this._y};Math.PI,Math.sqrt(5);var Mn=function(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]},_n=function(e){return(e=Mn(Math.abs(e)))?e[1]:NaN},Tn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function An(e){if(!(t=Tn.exec(e)))throw new Error("invalid format: "+e);var t;return new Cn({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Cn(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}An.prototype=Cn.prototype,Cn.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var En,Ln,Nn=function(e){e:for(var t,r=e.length,n=1,i=-1;n<r;++n)switch(e[n]){case".":i=t=n;break;case"0":0===i&&(i=n),t=n;break;default:if(i>0){if(!+e[n])break e;i=0}}return i>0?e.slice(0,i)+e.slice(t+1):e},Pn=function(e,t){var r=Mn(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")},On={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return Pn(100*e,t)},r:Pn,s:function(e,t){var r=Mn(e,t);if(!r)return e+"";var n=r[0],i=r[1],o=i-(En=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=n.length;return o===a?n:o>a?n+new Array(o-a+1).join("0"):o>0?n.slice(0,o)+"."+n.slice(o):"0."+new Array(1-o).join("0")+Mn(e,Math.max(0,t+o-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}},Rn=function(e){return e},Dn=Array.prototype.map,Fn=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];Ln=function(e){var t,r,n=void 0===e.grouping||void 0===e.thousands?Rn:(t=Dn.call(e.grouping,Number),r=e.thousands+"",function(e,n){for(var i=e.length,o=[],a=0,s=t[0],l=0;i>0&&s>0&&(l+s+1>n&&(s=Math.max(1,n-l)),o.push(e.substring(i-=s,i+s)),!((l+=s+1)>n));)s=t[a=(a+1)%t.length];return o.reverse().join(r)}),i=void 0===e.currency?"":e.currency[0]+"",o=void 0===e.currency?"":e.currency[1]+"",a=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?Rn:function(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}(Dn.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",u=void 0===e.minus?"-":e.minus+"",c=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=An(e)).fill,r=e.align,h=e.sign,p=e.symbol,f=e.zero,d=e.width,m=e.comma,v=e.precision,g=e.trim,y=e.type;"n"===y?(m=!0,y="g"):On[y]||(void 0===v&&(v=12),g=!0,y="g"),(f||"0"===t&&"="===r)&&(f=!0,t="0",r="=");var b="$"===p?i:"#"===p&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x="$"===p?o:/[%p]/.test(y)?l:"",w=On[y],S=/[defgprs%]/.test(y);function M(e){var i,o,l,p=b,M=x;if("c"===y)M=w(e)+M,e="";else{var _=(e=+e)<0;if(e=isNaN(e)?c:w(Math.abs(e),v),g&&(e=Nn(e)),_&&0===+e&&(_=!1),p=(_?"("===h?h:u:"-"===h||"("===h?"":h)+p,M=("s"===y?Fn[8+En/3]:"")+M+(_&&"("===h?")":""),S)for(i=-1,o=e.length;++i<o;)if(48>(l=e.charCodeAt(i))||l>57){M=(46===l?a+e.slice(i+1):e.slice(i))+M,e=e.slice(0,i);break}}m&&!f&&(e=n(e,1/0));var T=p.length+e.length+M.length,A=T<d?new Array(d-T+1).join(t):"";switch(m&&f&&(e=n(A+e,A.length?d-M.length:1/0),A=""),r){case"<":e=p+e+M+A;break;case"=":e=p+A+e+M;break;case"^":e=A.slice(0,T=A.length>>1)+p+e+M+A.slice(T);break;default:e=A+p+e+M}return s(e)}return v=void 0===v?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),M.toString=function(){return e+""},M}return{format:h,formatPrefix:function(e,t){var r=h(((e=An(e)).type="f",e)),n=3*Math.max(-8,Math.min(8,Math.floor(_n(t)/3))),i=Math.pow(10,-n),o=Fn[8+n/3];return function(e){return r(i*e)+o}}}}({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),Ln.format,Ln.formatPrefix;var kn=function(){return new In};function In(){this.reset()}In.prototype={constructor:In,reset:function(){this.s=this.t=0},add:function(e){Un(Bn,e,this.t),Un(this,Bn.s,this.s),this.s?this.t+=Bn.t:this.s=Bn.t},valueOf:function(){return this.s}};var Bn=new In;function Un(e,t,r){var n=e.s=t+r,i=n-t,o=n-i;e.t=t-o+(r-i)}var Vn=1e-6,jn=1e-12,zn=Math.PI,Gn=zn/2,Wn=zn/4,Hn=2*zn,Xn=zn/180,qn=Math.abs,Yn=Math.atan,Kn=Math.atan2,Qn=Math.cos,Jn=(Math.ceil,Math.exp),Zn=(Math.floor,Math.log),$n=(Math.pow,Math.sin),ei=Math.sign||function(e){return e>0?1:e<0?-1:0},ti=Math.sqrt,ri=Math.tan;function ni(e){return e>1?0:e<-1?zn:Math.acos(e)}function ii(e){return e>1?Gn:e<-1?-Gn:Math.asin(e)}function oi(){}kn(),kn();function ai(e){var t=e[0],r=e[1],n=Qn(r);return[n*Qn(t),n*$n(t),$n(r)]}function si(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function li(e){var t=ti(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}kn();function ui(e,t){return[qn(e)>zn?e+Math.round(-e/Hn)*Hn:e,t]}ui.invert=ui;var ci=function(){var e,t=[];return{point:function(t,r){e.push([t,r])},lineStart:function(){t.push(e=[])},lineEnd:oi,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var r=t;return t=[],e=null,r}}},hi=function(e,t){return qn(e[0]-t[0])<Vn&&qn(e[1]-t[1])<Vn};function pi(e,t,r,n){this.x=e,this.z=t,this.o=r,this.e=n,this.v=!1,this.n=this.p=null}var fi=function(e,t,r,n,i){var o,a,s=[],l=[];if(e.forEach(function(e){if(!((t=e.length-1)<=0)){var t,r,n=e[0],a=e[t];if(hi(n,a)){for(i.lineStart(),o=0;o<t;++o)i.point((n=e[o])[0],n[1]);i.lineEnd()}else s.push(r=new pi(n,e,null,!0)),l.push(r.o=new pi(n,null,r,!1)),s.push(r=new pi(a,e,null,!1)),l.push(r.o=new pi(a,null,r,!0))}}),s.length){for(l.sort(t),di(s),di(l),o=0,a=l.length;o<a;++o)l[o].e=r=!r;for(var u,c,h=s[0];;){for(var p=h,f=!0;p.v;)if((p=p.n)===h)return;u=p.z,i.lineStart();do{if(p.v=p.o.v=!0,p.e){if(f)for(o=0,a=u.length;o<a;++o)i.point((c=u[o])[0],c[1]);else n(p.x,p.n.x,1,i);p=p.n}else{if(f)for(u=p.p.z,o=u.length-1;o>=0;--o)i.point((c=u[o])[0],c[1]);else n(p.x,p.p.x,-1,i);p=p.p}u=(p=p.o).z,f=!f}while(!p.v);i.lineEnd()}}};function di(e){if(t=e.length){for(var t,r,n=0,i=e[0];++n<t;)i.n=r=e[n],r.p=i,i=r;i.n=r=e[0],r.p=i}}var mi=kn();function vi(e){return qn(e[0])<=zn?e[0]:ei(e[0])*((qn(e[0])+zn)%Hn-zn)}var gi=function(e,t){var r=vi(t),n=t[1],i=$n(n),o=[$n(r),-Qn(r),0],a=0,s=0;mi.reset(),1===i?n=Gn+Vn:-1===i&&(n=-Gn-Vn);for(var l=0,u=e.length;l<u;++l)if(h=(c=e[l]).length)for(var c,h,p=c[h-1],f=vi(p),d=p[1]/2+Wn,m=$n(d),v=Qn(d),g=0;g<h;++g,f=b,m=w,v=S,p=y){var y=c[g],b=vi(y),x=y[1]/2+Wn,w=$n(x),S=Qn(x),M=b-f,_=M>=0?1:-1,T=_*M,A=T>zn,C=m*w;if(mi.add(Kn(C*_*$n(T),v*S+C*Qn(T))),a+=A?M+_*Hn:M,A^f>=r^b>=r){var E=si(ai(p),ai(y));li(E);var L=si(o,E);li(L);var N=(A^M>=0?-1:1)*ii(L[2]);(n>N||n===N&&(E[0]||E[1]))&&(s+=A^M>=0?1:-1)}}return(a<-Vn||a<Vn&&mi<-Vn)^1&s},yi=function(e,t,r,n){return function(i){var o,a,l,u=t(i),c=ci(),h=t(c),p=!1,f={point:d,lineStart:v,lineEnd:g,polygonStart:function(){f.point=y,f.lineStart=b,f.lineEnd=x,a=[],o=[]},polygonEnd:function(){f.point=d,f.lineStart=v,f.lineEnd=g,a=s(a);var e=gi(o,n);a.length?(p||(i.polygonStart(),p=!0),fi(a,xi,e,r,i)):e&&(p||(i.polygonStart(),p=!0),i.lineStart(),r(null,null,1,i),i.lineEnd()),p&&(i.polygonEnd(),p=!1),a=o=null},sphere:function(){i.polygonStart(),i.lineStart(),r(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(t,r){e(t,r)&&i.point(t,r)}function m(e,t){u.point(e,t)}function v(){f.point=m,u.lineStart()}function g(){f.point=d,u.lineEnd()}function y(e,t){l.push([e,t]),h.point(e,t)}function b(){h.lineStart(),l=[]}function x(){y(l[0][0],l[0][1]),h.lineEnd();var e,t,r,n,s=h.clean(),u=c.result(),f=u.length;if(l.pop(),o.push(l),l=null,f)if(1&s){if((t=(r=u[0]).length-1)>0){for(p||(i.polygonStart(),p=!0),i.lineStart(),e=0;e<t;++e)i.point((n=r[e])[0],n[1]);i.lineEnd()}}else f>1&&2&s&&u.push(u.pop().concat(u.shift())),a.push(u.filter(bi))}return f}};function bi(e){return e.length>1}function xi(e,t){return((e=e.x)[0]<0?e[1]-Gn-Vn:Gn-e[1])-((t=t.x)[0]<0?t[1]-Gn-Vn:Gn-t[1])}yi(function(){return!0},function(e){var t,r=NaN,n=NaN,i=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(o,a){var s=o>0?zn:-zn,l=qn(o-r);qn(l-zn)<Vn?(e.point(r,n=(n+a)/2>0?Gn:-Gn),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(s,n),e.point(o,n),t=0):i!==s&&l>=zn&&(qn(r-i)<Vn&&(r-=i*Vn),qn(o-s)<Vn&&(o-=s*Vn),n=function(e,t,r,n){var i,o,a=$n(e-r);return qn(a)>Vn?Yn(($n(t)*(o=Qn(n))*$n(r)-$n(n)*(i=Qn(t))*$n(e))/(i*o*a)):(t+n)/2}(r,n,o,a),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(s,n),t=0),e.point(r=o,n=a),i=s},lineEnd:function(){e.lineEnd(),r=n=NaN},clean:function(){return 2-t}}},function(e,t,r,n){var i;if(null==e)i=r*Gn,n.point(-zn,i),n.point(0,i),n.point(zn,i),n.point(zn,0),n.point(zn,-i),n.point(0,-i),n.point(-zn,-i),n.point(-zn,0),n.point(-zn,i);else if(qn(e[0]-t[0])>Vn){var o=e[0]<t[0]?zn:-zn;i=r*o/2,n.point(-o,i),n.point(0,i),n.point(o,i)}else n.point(t[0],t[1])},[-zn,-Gn]);kn();kn(),kn();function wi(e){this._context=e}wi.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._context.moveTo(e,t),this._point=1;break;case 1:this._context.lineTo(e,t);break;default:this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Hn)}},result:oi};kn();function Si(){this._string=[]}function Mi(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}Si.prototype={_radius:4.5,_circle:Mi(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._string.push("M",e,",",t),this._point=1;break;case 1:this._string.push("L",e,",",t);break;default:null==this._circle&&(this._circle=Mi(this._radius)),this._string.push("M",e,",",t,this._circle)}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}return null}};function _i(e){return function(t){var r=new Ti;for(var n in e)r[n]=e[n];return r.stream=t,r}}function Ti(){}Ti.prototype={constructor:Ti,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};Qn(30*Xn);_i({point:function(e,t){this.stream.point(e*Xn,t*Xn)}});function Ai(e){return function(t,r){var n=Qn(t),i=Qn(r),o=e(n*i);return[o*i*$n(t),o*$n(r)]}}function Ci(e){return function(t,r){var n=ti(t*t+r*r),i=e(n),o=$n(i),a=Qn(i);return[Kn(t*o,n*a),ii(n&&r*o/n)]}}var Ei=Ai(function(e){return ti(2/(1+e))});Ei.invert=Ci(function(e){return 2*ii(e/2)});var Li=Ai(function(e){return(e=ni(e))&&e/$n(e)});Li.invert=Ci(function(e){return e});function Ni(e,t){return[e,Zn(ri((Gn+t)/2))]}Ni.invert=function(e,t){return[e,2*Yn(Jn(t))-Gn]};function Pi(e,t){return[e,t]}Pi.invert=Pi;var Oi=1.340264,Ri=-.081106,Di=893e-6,Fi=.003796,ki=ti(3)/2;function Ii(e,t){var r=ii(ki*$n(t)),n=r*r,i=n*n*n;return[e*Qn(r)/(ki*(Oi+3*Ri*n+i*(7*Di+9*Fi*n))),r*(Oi+Ri*n+i*(Di+Fi*n))]}Ii.invert=function(e,t){for(var r,n=t,i=n*n,o=i*i*i,a=0;a<12&&(o=(i=(n-=r=(n*(Oi+Ri*i+o*(Di+Fi*i))-t)/(Oi+3*Ri*i+o*(7*Di+9*Fi*i)))*n)*i*i,!(qn(r)<jn));++a);return[ki*e*(Oi+3*Ri*i+o*(7*Di+9*Fi*i))/Qn(n),ii($n(n)/ki)]};function Bi(e,t){var r=Qn(t),n=Qn(e)*r;return[r*$n(e)/n,$n(t)/n]}Bi.invert=Ci(Yn);function Ui(e,t){var r=t*t,n=r*r;return[e*(.8707-.131979*r+n*(n*(.003971*r-.001529*n)-.013791)),t*(1.007226+r*(.015085+n*(.028874*r-.044475-.005916*n)))]}Ui.invert=function(e,t){var r,n=t,i=25;do{var o=n*n,a=o*o;n-=r=(n*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))-t)/(1.007226+o*(.045255+a*(.259866*o-.311325-.005916*11*a)))}while(qn(r)>Vn&&--i>0);return[e/(.8707+(o=n*n)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),n]};function Vi(e,t){return[Qn(t)*$n(e),$n(t)]}Vi.invert=Ci(ii);function ji(e,t){var r=Qn(t),n=1+Qn(e)*r;return[r*$n(e)/n,$n(t)/n]}ji.invert=Ci(function(e){return 2*Yn(e)});function zi(e,t){return[Zn(ri((Gn+t)/2)),-e]}zi.invert=function(e,t){return[-t,2*Yn(Jn(e))-Gn]};function Gi(e){var t=0,r=e.children,n=r&&r.length;if(n)for(;--n>=0;)t+=r[n].value;else t=1;e.value=t}function Wi(e,t){var r,n,i,o,a,s=new Yi(e),l=+e.value&&(s.value=e.value),u=[s];for(null==t&&(t=Hi);r=u.pop();)if(l&&(r.value=+r.data.value),(i=t(r.data))&&(a=i.length))for(r.children=new Array(a),o=a-1;o>=0;--o)u.push(n=r.children[o]=new Yi(i[o])),n.parent=r,n.depth=r.depth+1;return s.eachBefore(qi)}function Hi(e){return e.children}function Xi(e){e.data=e.data.data}function qi(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function Yi(e){this.data=e,this.depth=this.height=0,this.parent=null}Yi.prototype=Wi.prototype={constructor:Yi,count:function(){return this.eachAfter(Gi)},each:function(e){var t,r,n,i,o=this,a=[o];do{for(t=a.reverse(),a=[];o=t.pop();)if(e(o),r=o.children)for(n=0,i=r.length;n<i;++n)a.push(r[n])}while(a.length);return this},eachAfter:function(e){for(var t,r,n,i=this,o=[i],a=[];i=o.pop();)if(a.push(i),t=i.children)for(r=0,n=t.length;r<n;++r)o.push(t[r]);for(;i=a.pop();)e(i);return this},eachBefore:function(e){for(var t,r,n=this,i=[n];n=i.pop();)if(e(n),t=n.children)for(r=t.length-1;r>=0;--r)i.push(t[r]);return this},sum:function(e){return this.eachAfter(function(t){for(var r=+e(t.data)||0,n=t.children,i=n&&n.length;--i>=0;)r+=n[i].value;t.value=r})},sort:function(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})},path:function(e){for(var t=this,r=function(e,t){if(e===t)return e;var r=e.ancestors(),n=t.ancestors(),i=null;for(e=r.pop(),t=n.pop();e===t;)i=e,e=r.pop(),t=n.pop();return i}(t,e),n=[t];t!==r;)t=t.parent,n.push(t);for(var i=n.length;e!==r;)n.splice(i,0,e),e=e.parent;return n},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){var e=[];return this.each(function(t){e.push(t)}),e},leaves:function(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e},links:function(){var e=this,t=[];return e.each(function(r){r!==e&&t.push({source:r.parent,target:r})}),t},copy:function(){return Wi(this).eachBefore(Xi)}};Array.prototype.slice;var Ki=function(e,t,r,n,i){for(var o,a=e.children,s=-1,l=a.length,u=e.value&&(n-t)/e.value;++s<l;)(o=a[s]).y0=r,o.y1=i,o.x0=t,o.x1=t+=o.value*u};function Qi(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}Qi.prototype=Object.create(Yi.prototype);var Ji=function(e,t,r,n,i){for(var o,a=e.children,s=-1,l=a.length,u=e.value&&(i-r)/e.value;++s<l;)(o=a[s]).x0=t,o.x1=n,o.y0=r,o.y1=r+=o.value*u},Zi=(1+Math.sqrt(5))/2;function $i(e,t,r,n,i,o){for(var a,s,l,u,c,h,p,f,d,m,v,g=[],y=t.children,b=0,x=0,w=y.length,S=t.value;b<w;){l=i-r,u=o-n;do{c=y[x++].value}while(!c&&x<w);for(h=p=c,v=c*c*(m=Math.max(u/l,l/u)/(S*e)),d=Math.max(p/v,v/h);x<w;++x){if(c+=s=y[x].value,s<h&&(h=s),s>p&&(p=s),v=c*c*m,(f=Math.max(p/v,v/h))>d){c-=s;break}d=f}g.push(a={value:c,dice:l<u,children:y.slice(b,x)}),a.dice?Ki(a,r,n,i,S?n+=u*c/S:o):Ji(a,r,n,S?r+=l*c/S:i,o),S-=c,b=x}return g}(function e(t){function r(e,r,n,i,o){$i(t,e,r,n,i,o)}return r.ratio=function(t){return e((t=+t)>1?t:1)},r})(Zi),function e(t){function r(e,r,n,i,o){if((a=e._squarify)&&a.ratio===t)for(var a,s,l,u,c,h=-1,p=a.length,f=e.value;++h<p;){for(l=(s=a[h]).children,u=s.value=0,c=l.length;u<c;++u)s.value+=l[u].value;s.dice?Ki(s,r,n,i,n+=(o-n)*s.value/f):Ji(s,r,n,r+=(i-r)*s.value/f,o),f-=s.value}else e._squarify=a=$i(t,e,r,n,i,o),a.ratio=t}return r.ratio=function(t){return e((t=+t)>1?t:1)},r}(Zi);var eo=function(){return Math.random()},to=(function e(t){function r(e,r){return e=null==e?0:+e,r=null==r?1:+r,1===arguments.length?(r=e,e=0):r-=e,function(){return t()*r+e}}return r.source=e,r}(eo),function e(t){function r(e,r){var n,i;return e=null==e?0:+e,r=null==r?1:+r,function(){var o;if(null!=n)o=n,n=null;else do{n=2*t()-1,o=2*t()-1,i=n*n+o*o}while(!i||i>1);return e+r*o*Math.sqrt(-2*Math.log(i)/i)}}return r.source=e,r}(eo)),ro=(function e(t){function r(){var e=to.source(t).apply(this,arguments);return function(){return Math.exp(e())}}return r.source=e,r}(eo),function e(t){function r(e){return function(){for(var r=0,n=0;n<e;++n)r+=t();return r}}return r.source=e,r}(eo));(function e(t){function r(e){var r=ro.source(t)(e);return function(){return r()/e}}return r.source=e,r})(eo),function e(t){function r(e){return function(){return-Math.log(1-t())/e}}return r.source=e,r}(eo);var no=Array.prototype;no.map,no.slice;var io=new Date,oo=new Date;function ao(e,t,r,n){function i(t){return e(t=new Date(+t)),t}return i.floor=i,i.ceil=function(r){return e(r=new Date(r-1)),t(r,1),e(r),r},i.round=function(e){var t=i(e),r=i.ceil(e);return e-t<r-e?t:r},i.offset=function(e,r){return t(e=new Date(+e),null==r?1:Math.floor(r)),e},i.range=function(r,n,o){var a,s=[];if(r=i.ceil(r),o=null==o?1:Math.floor(o),!(r<n)||!(o>0))return s;do{s.push(a=new Date(+r)),t(r,o),e(r)}while(a<r&&r<n);return s},i.filter=function(r){return ao(function(t){if(t>=t)for(;e(t),!r(t);)t.setTime(t-1)},function(e,n){if(e>=e)if(n<0)for(;++n<=0;)for(;t(e,-1),!r(e););else for(;--n>=0;)for(;t(e,1),!r(e););})},r&&(i.count=function(t,n){return io.setTime(+t),oo.setTime(+n),e(io),e(oo),Math.floor(r(io,oo))},i.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(n?function(t){return n(t)%e===0}:function(t){return i.count(0,t)%e===0}):i:null}),i}var so=ao(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});so.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?ao(function(t){t.setTime(Math.floor(t/e)*e)},function(t,r){t.setTime(+t+r*e)},function(t,r){return(r-t)/e}):so:null};so.range;var lo=6e4,uo=6048e5,co=ao(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+1e3*t)},function(e,t){return(t-e)/1e3},function(e){return e.getUTCSeconds()}),ho=(co.range,ao(function(e){e.setTime(e-e.getMilliseconds()-1e3*e.getSeconds())},function(e,t){e.setTime(+e+t*lo)},function(e,t){return(t-e)/lo},function(e){return e.getMinutes()})),po=(ho.range,ao(function(e){e.setTime(e-e.getMilliseconds()-1e3*e.getSeconds()-e.getMinutes()*lo)},function(e,t){e.setTime(+e+36e5*t)},function(e,t){return(t-e)/36e5},function(e){return e.getHours()})),fo=(po.range,ao(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*lo)/864e5},function(e){return e.getDate()-1})),mo=fo;fo.range;function vo(e){return ao(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+7*t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*lo)/uo})}var go=vo(0),yo=vo(1),bo=vo(2),xo=vo(3),wo=vo(4),So=vo(5),Mo=vo(6),_o=(go.range,yo.range,bo.range,xo.range,wo.range,So.range,Mo.range,ao(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())},function(e){return e.getMonth()})),To=(_o.range,ao(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()}));To.every=function(e){return isFinite(e=Math.floor(e))&&e>0?ao(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,r){t.setFullYear(t.getFullYear()+r*e)}):null};var Ao=To,Co=(To.range,ao(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*lo)},function(e,t){return(t-e)/lo},function(e){return e.getUTCMinutes()})),Eo=(Co.range,ao(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+36e5*t)},function(e,t){return(t-e)/36e5},function(e){return e.getUTCHours()})),Lo=(Eo.range,ao(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/864e5},function(e){return e.getUTCDate()-1})),No=Lo;Lo.range;function Po(e){return ao(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+7*t)},function(e,t){return(t-e)/uo})}var Oo=Po(0),Ro=Po(1),Do=Po(2),Fo=Po(3),ko=Po(4),Io=Po(5),Bo=Po(6),Uo=(Oo.range,Ro.range,Do.range,Fo.range,ko.range,Io.range,Bo.range,ao(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()})),Vo=(Uo.range,ao(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()}));Vo.every=function(e){return isFinite(e=Math.floor(e))&&e>0?ao(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,r){t.setUTCFullYear(t.getUTCFullYear()+r*e)}):null};var jo=Vo;Vo.range;function zo(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Go(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Wo(e){return{y:e,m:0,d:1,H:0,M:0,S:0,L:0}}var Ho,Xo,qo,Yo={"-":"",_:" ",0:"0"},Ko=/^\s*\d+/,Qo=/^%/,Jo=/[\\^$*+?|[\]().{}]/g;function Zo(e,t,r){var n=e<0?"-":"",i=(n?-e:e)+"",o=i.length;return n+(o<r?new Array(r-o+1).join(t)+i:i)}function $o(e){return e.replace(Jo,"\\$&")}function ea(e){return new RegExp("^(?:"+e.map($o).join("|")+")","i")}function ta(e){for(var t={},r=-1,n=e.length;++r<n;)t[e[r].toLowerCase()]=r;return t}function ra(e,t,r){var n=Ko.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function na(e,t,r){var n=Ko.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function ia(e,t,r){var n=Ko.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function oa(e,t,r){var n=Ko.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function aa(e,t,r){var n=Ko.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function sa(e,t,r){var n=Ko.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function la(e,t,r){var n=Ko.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function ua(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function ca(e,t,r){var n=Ko.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function ha(e,t,r){var n=Ko.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function pa(e,t,r){var n=Ko.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function fa(e,t,r){var n=Ko.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function da(e,t,r){var n=Ko.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function ma(e,t,r){var n=Ko.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function va(e,t,r){var n=Ko.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function ga(e,t,r){var n=Ko.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function ya(e,t,r){var n=Qo.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function ba(e,t,r){var n=Ko.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function xa(e,t,r){var n=Ko.exec(t.slice(r));return n?(e.Q=1e3*+n[0],r+n[0].length):-1}function wa(e,t){return Zo(e.getDate(),t,2)}function Sa(e,t){return Zo(e.getHours(),t,2)}function Ma(e,t){return Zo(e.getHours()%12||12,t,2)}function _a(e,t){return Zo(1+mo.count(Ao(e),e),t,3)}function Ta(e,t){return Zo(e.getMilliseconds(),t,3)}function Aa(e,t){return Ta(e,t)+"000"}function Ca(e,t){return Zo(e.getMonth()+1,t,2)}function Ea(e,t){return Zo(e.getMinutes(),t,2)}function La(e,t){return Zo(e.getSeconds(),t,2)}function Na(e){var t=e.getDay();return 0===t?7:t}function Pa(e,t){return Zo(go.count(Ao(e),e),t,2)}function Oa(e,t){var r=e.getDay();return e=r>=4||0===r?wo(e):wo.ceil(e),Zo(wo.count(Ao(e),e)+(4===Ao(e).getDay()),t,2)}function Ra(e){return e.getDay()}function Da(e,t){return Zo(yo.count(Ao(e),e),t,2)}function Fa(e,t){return Zo(e.getFullYear()%100,t,2)}function ka(e,t){return Zo(e.getFullYear()%1e4,t,4)}function Ia(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Zo(t/60|0,"0",2)+Zo(t%60,"0",2)}function Ba(e,t){return Zo(e.getUTCDate(),t,2)}function Ua(e,t){return Zo(e.getUTCHours(),t,2)}function Va(e,t){return Zo(e.getUTCHours()%12||12,t,2)}function ja(e,t){return Zo(1+No.count(jo(e),e),t,3)}function za(e,t){return Zo(e.getUTCMilliseconds(),t,3)}function Ga(e,t){return za(e,t)+"000"}function Wa(e,t){return Zo(e.getUTCMonth()+1,t,2)}function Ha(e,t){return Zo(e.getUTCMinutes(),t,2)}function Xa(e,t){return Zo(e.getUTCSeconds(),t,2)}function qa(e){var t=e.getUTCDay();return 0===t?7:t}function Ya(e,t){return Zo(Oo.count(jo(e),e),t,2)}function Ka(e,t){var r=e.getUTCDay();return e=r>=4||0===r?ko(e):ko.ceil(e),Zo(ko.count(jo(e),e)+(4===jo(e).getUTCDay()),t,2)}function Qa(e){return e.getUTCDay()}function Ja(e,t){return Zo(Ro.count(jo(e),e),t,2)}function Za(e,t){return Zo(e.getUTCFullYear()%100,t,2)}function $a(e,t){return Zo(e.getUTCFullYear()%1e4,t,4)}function es(){return"+0000"}function ts(){return"%"}function rs(e){return+e}function ns(e){return Math.floor(+e/1e3)}!function(e){Ho=function(e){var t=e.dateTime,r=e.date,n=e.time,i=e.periods,o=e.days,a=e.shortDays,s=e.months,l=e.shortMonths,u=ea(i),c=ta(i),h=ea(o),p=ta(o),f=ea(a),d=ta(a),m=ea(s),v=ta(s),g=ea(l),y=ta(l),b={a:function(e){return a[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return l[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:wa,e:wa,f:Aa,H:Sa,I:Ma,j:_a,L:Ta,m:Ca,M:Ea,p:function(e){return i[+(e.getHours()>=12)]},Q:rs,s:ns,S:La,u:Na,U:Pa,V:Oa,w:Ra,W:Da,x:null,X:null,y:Fa,Y:ka,Z:Ia,"%":ts},x={a:function(e){return a[e.getUTCDay()]},A:function(e){return o[e.getUTCDay()]},b:function(e){return l[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:Ba,e:Ba,f:Ga,H:Ua,I:Va,j:ja,L:za,m:Wa,M:Ha,p:function(e){return i[+(e.getUTCHours()>=12)]},Q:rs,s:ns,S:Xa,u:qa,U:Ya,V:Ka,w:Qa,W:Ja,x:null,X:null,y:Za,Y:$a,Z:es,"%":ts},w={a:function(e,t,r){var n=f.exec(t.slice(r));return n?(e.w=d[n[0].toLowerCase()],r+n[0].length):-1},A:function(e,t,r){var n=h.exec(t.slice(r));return n?(e.w=p[n[0].toLowerCase()],r+n[0].length):-1},b:function(e,t,r){var n=g.exec(t.slice(r));return n?(e.m=y[n[0].toLowerCase()],r+n[0].length):-1},B:function(e,t,r){var n=m.exec(t.slice(r));return n?(e.m=v[n[0].toLowerCase()],r+n[0].length):-1},c:function(e,r,n){return _(e,t,r,n)},d:ha,e:ha,f:ga,H:fa,I:fa,j:pa,L:va,m:ca,M:da,p:function(e,t,r){var n=u.exec(t.slice(r));return n?(e.p=c[n[0].toLowerCase()],r+n[0].length):-1},Q:ba,s:xa,S:ma,u:na,U:ia,V:oa,w:ra,W:aa,x:function(e,t,n){return _(e,r,t,n)},X:function(e,t,r){return _(e,n,t,r)},y:la,Y:sa,Z:ua,"%":ya};function S(e,t){return function(r){var n,i,o,a=[],s=-1,l=0,u=e.length;for(r instanceof Date||(r=new Date(+r));++s<u;)37===e.charCodeAt(s)&&(a.push(e.slice(l,s)),null!=(i=Yo[n=e.charAt(++s)])?n=e.charAt(++s):i="e"===n?" ":"0",(o=t[n])&&(n=o(r,i)),a.push(n),l=s+1);return a.push(e.slice(l,s)),a.join("")}}function M(e,t){return function(r){var n,i,o=Wo(1900);if(_(o,e,r+="",0)!=r.length)return null;if("Q"in o)return new Date(o.Q);if("p"in o&&(o.H=o.H%12+12*o.p),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(n=Go(Wo(o.y))).getUTCDay(),n=i>4||0===i?Ro.ceil(n):Ro(n),n=No.offset(n,7*(o.V-1)),o.y=n.getUTCFullYear(),o.m=n.getUTCMonth(),o.d=n.getUTCDate()+(o.w+6)%7):(i=(n=t(Wo(o.y))).getDay(),n=i>4||0===i?yo.ceil(n):yo(n),n=mo.offset(n,7*(o.V-1)),o.y=n.getFullYear(),o.m=n.getMonth(),o.d=n.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?Go(Wo(o.y)).getUTCDay():t(Wo(o.y)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,Go(o)):t(o)}}function _(e,t,r,n){for(var i,o,a=0,s=t.length,l=r.length;a<s;){if(n>=l)return-1;if(37===(i=t.charCodeAt(a++))){if(i=t.charAt(a++),!(o=w[i in Yo?t.charAt(a++):i])||(n=o(e,r,n))<0)return-1}else if(i!=r.charCodeAt(n++))return-1}return n}return b.x=S(r,b),b.X=S(n,b),b.c=S(t,b),x.x=S(r,x),x.X=S(n,x),x.c=S(t,x),{format:function(e){var t=S(e+="",b);return t.toString=function(){return e},t},parse:function(e){var t=M(e+="",zo);return t.toString=function(){return e},t},utcFormat:function(e){var t=S(e+="",x);return t.toString=function(){return e},t},utcParse:function(e){var t=M(e,Go);return t.toString=function(){return e},t}}}(e),Ho.format,Ho.parse,Xo=Ho.utcFormat,qo=Ho.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});Date.prototype.toISOString||Xo("%Y-%m-%dT%H:%M:%S.%LZ");+new Date("2000-01-01T00:00:00.000Z")||qo("%Y-%m-%dT%H:%M:%S.%LZ");Math.abs,Math.atan2,Math.cos,Math.max,Math.min,Math.sin,Math.sqrt;var is=1e-12,os=Math.PI,as=2*os;function ss(e){this._context=e}ss.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};var ls=function(e){return new ss(e)};cs(ls);function us(e){this._curve=e}function cs(e){function t(t){return new us(e(t))}return t._curve=e,t}us.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(e,t){this._curve.point(t*Math.sin(e),t*-Math.cos(e))}};Array.prototype.slice;Math.sqrt(1/3);var hs=Math.sin(os/10)/Math.sin(7*os/10),ps=(Math.sin(as/10),Math.cos(as/10),Math.sqrt(3),Math.sqrt(3),Math.sqrt(12),function(){});function fs(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function ds(e){this._context=e}ds.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:fs(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:fs(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ms(e){this._context=e}ms.prototype={areaStart:ps,areaEnd:ps,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:fs(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function vs(e){this._context=e}vs.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:fs(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function gs(e,t){this._basis=new ds(e),this._beta=t}gs.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,r=e.length-1;if(r>0)for(var n,i=e[0],o=t[0],a=e[r]-i,s=t[r]-o,l=-1;++l<=r;)n=l/r,this._basis.point(this._beta*e[l]+(1-this._beta)*(i+n*a),this._beta*t[l]+(1-this._beta)*(o+n*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};(function e(t){function r(e){return 1===t?new ds(e):new gs(e,t)}return r.beta=function(t){return e(+t)},r})(.85);function ys(e,t,r){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-r),e._x2,e._y2)}function bs(e,t){this._context=e,this._k=(1-t)/6}bs.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:ys(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:ys(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function e(t){function r(e){return new bs(e,t)}return r.tension=function(t){return e(+t)},r})(0);function xs(e,t){this._context=e,this._k=(1-t)/6}xs.prototype={areaStart:ps,areaEnd:ps,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:ys(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function e(t){function r(e){return new xs(e,t)}return r.tension=function(t){return e(+t)},r})(0);function ws(e,t){this._context=e,this._k=(1-t)/6}ws.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:ys(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function e(t){function r(e){return new ws(e,t)}return r.tension=function(t){return e(+t)},r})(0);function Ss(e,t,r){var n=e._x1,i=e._y1,o=e._x2,a=e._y2;if(e._l01_a>is){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);n=(n*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>is){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*u+e._x1*e._l23_2a-t*e._l12_2a)/c,a=(a*u+e._y1*e._l23_2a-r*e._l12_2a)/c}e._context.bezierCurveTo(n,i,o,a,e._x2,e._y2)}function Ms(e,t){this._context=e,this._alpha=t}Ms.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var r=this._x2-e,n=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+n*n,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Ss(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function e(t){function r(e){return t?new Ms(e,t):new bs(e,0)}return r.alpha=function(t){return e(+t)},r})(.5);function _s(e,t){this._context=e,this._alpha=t}_s.prototype={areaStart:ps,areaEnd:ps,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var r=this._x2-e,n=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+n*n,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Ss(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function e(t){function r(e){return t?new _s(e,t):new xs(e,0)}return r.alpha=function(t){return e(+t)},r})(.5);function Ts(e,t){this._context=e,this._alpha=t}Ts.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var r=this._x2-e,n=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+n*n,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ss(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function e(t){function r(e){return t?new Ts(e,t):new ws(e,0)}return r.alpha=function(t){return e(+t)},r})(.5);function As(e){this._context=e}As.prototype={areaStart:ps,areaEnd:ps,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Cs(e){return e<0?-1:1}function Es(e,t,r){var n=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(n||i<0&&-0),a=(r-e._y1)/(i||n<0&&-0),s=(o*i+a*n)/(n+i);return(Cs(o)+Cs(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function Ls(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Ns(e,t,r){var n=e._x0,i=e._y0,o=e._x1,a=e._y1,s=(o-n)/3;e._context.bezierCurveTo(n+s,i+s*t,o-s,a-s*r,o,a)}function Ps(e){this._context=e}function Os(e){this._context=new Rs(e)}function Rs(e){this._context=e}function Ds(e){this._context=e}function Fs(e){var t,r,n=e.length-1,i=new Array(n),o=new Array(n),a=new Array(n);for(i[0]=0,o[0]=2,a[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,o[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,o[n-1]=7,a[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/o[t-1],o[t]-=r,a[t]-=r*a[t-1];for(i[n-1]=a[n-1]/o[n-1],t=n-2;t>=0;--t)i[t]=(a[t]-i[t+1])/o[t];for(o[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}Ps.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Ns(this,this._t0,Ls(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Ns(this,Ls(this,r=Es(this,e,t)),r);break;default:Ns(this,this._t0,r=Es(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}},(Os.prototype=Object.create(Ps.prototype)).point=function(e,t){Ps.prototype.point.call(this,t,e)},Rs.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,i,o){this._context.bezierCurveTo(t,e,n,r,o,i)}},Ds.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===r)this._context.lineTo(e[1],t[1]);else for(var n=Fs(e),i=Fs(t),o=0,a=1;a<r;++o,++a)this._context.bezierCurveTo(n[0][o],i[0][o],n[1][o],i[1][o],e[a],t[a]);(this._line||0!==this._line&&1===r)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function ks(e,t){this._context=e,this._t=t}ks.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}}this._x=e,this._y=t}};function Is(){this._=null}function Bs(e){e.U=e.C=e.L=e.R=e.P=e.N=null}function Us(e,t){var r=t,n=t.R,i=r.U;i?i.L===r?i.L=n:i.R=n:e._=n,n.U=i,r.U=n,r.R=n.L,r.R&&(r.R.U=r),n.L=r}function Vs(e,t){var r=t,n=t.L,i=r.U;i?i.L===r?i.L=n:i.R=n:e._=n,n.U=i,r.U=n,r.L=n.R,r.L&&(r.L.U=r),n.R=r}function js(e){for(;e.L;)e=e.L;return e}Is.prototype={constructor:Is,insert:function(e,t){var r,n,i;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;r=e}else this._?(e=js(this._),t.P=null,t.N=e,e.P=e.L=t,r=e):(t.P=t.N=null,this._=t,r=null);for(t.L=t.R=null,t.U=r,t.C=!0,e=t;r&&r.C;)r===(n=r.U).L?(i=n.R)&&i.C?(r.C=i.C=!1,n.C=!0,e=n):(e===r.R&&(Us(this,r),r=(e=r).U),r.C=!1,n.C=!0,Vs(this,n)):(i=n.L)&&i.C?(r.C=i.C=!1,n.C=!0,e=n):(e===r.L&&(Vs(this,r),r=(e=r).U),r.C=!1,n.C=!0,Us(this,n)),r=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t,r,n,i=e.U,o=e.L,a=e.R;if(r=o?a?js(a):o:a,i?i.L===e?i.L=r:i.R=r:this._=r,o&&a?(n=r.C,r.C=e.C,r.L=o,o.U=r,r!==a?(i=r.U,r.U=e.U,e=r.R,i.L=e,r.R=a,a.U=r):(r.U=i,i=r,e=r.R)):(n=e.C,e=r),e&&(e.U=i),!n)if(e&&e.C)e.C=!1;else{do{if(e===this._)break;if(e===i.L){if((t=i.R).C&&(t.C=!1,i.C=!0,Us(this,i),t=i.R),t.L&&t.L.C||t.R&&t.R.C){t.R&&t.R.C||(t.L.C=!1,t.C=!0,Vs(this,t),t=i.R),t.C=i.C,i.C=t.R.C=!1,Us(this,i),e=this._;break}}else if((t=i.L).C&&(t.C=!1,i.C=!0,Vs(this,i),t=i.L),t.L&&t.L.C||t.R&&t.R.C){t.L&&t.L.C||(t.R.C=!1,t.C=!0,Us(this,t),t=i.L),t.C=i.C,i.C=t.L.C=!1,Vs(this,i),e=this._;break}t.C=!0,e=i,i=i.U}while(!e.C);e&&(e.C=!1)}}};var zs=Is;function Gs(e,t,r,n){var i=[null,null],o=fl.push(i)-1;return i.left=e,i.right=t,r&&Hs(i,e,t,r),n&&Hs(i,t,e,n),hl[e.index].halfedges.push(o),hl[t.index].halfedges.push(o),i}function Ws(e,t,r){var n=[t,r];return n.left=e,n}function Hs(e,t,r,n){e[0]||e[1]?e.left===r?e[1]=n:e[0]=n:(e[0]=n,e.left=t,e.right=r)}function Xs(e,t,r,n,i){var o,a=e[0],s=e[1],l=a[0],u=a[1],c=0,h=1,p=s[0]-l,f=s[1]-u;if(o=t-l,p||!(o>0)){if(o/=p,p<0){if(o<c)return;o<h&&(h=o)}else if(p>0){if(o>h)return;o>c&&(c=o)}if(o=n-l,p||!(o<0)){if(o/=p,p<0){if(o>h)return;o>c&&(c=o)}else if(p>0){if(o<c)return;o<h&&(h=o)}if(o=r-u,f||!(o>0)){if(o/=f,f<0){if(o<c)return;o<h&&(h=o)}else if(f>0){if(o>h)return;o>c&&(c=o)}if(o=i-u,f||!(o<0)){if(o/=f,f<0){if(o>h)return;o>c&&(c=o)}else if(f>0){if(o<c)return;o<h&&(h=o)}return!(c>0||h<1)||(c>0&&(e[0]=[l+c*p,u+c*f]),h<1&&(e[1]=[l+h*p,u+h*f]),!0)}}}}}function qs(e,t,r,n,i){var o=e[1];if(o)return!0;var a,s,l=e[0],u=e.left,c=e.right,h=u[0],p=u[1],f=c[0],d=c[1],m=(h+f)/2,v=(p+d)/2;if(d===p){if(m<t||m>=n)return;if(h>f){if(l){if(l[1]>=i)return}else l=[m,r];o=[m,i]}else{if(l){if(l[1]<r)return}else l=[m,i];o=[m,r]}}else if(s=v-(a=(h-f)/(d-p))*m,a<-1||a>1)if(h>f){if(l){if(l[1]>=i)return}else l=[(r-s)/a,r];o=[(i-s)/a,i]}else{if(l){if(l[1]<r)return}else l=[(i-s)/a,i];o=[(r-s)/a,r]}else if(p<d){if(l){if(l[0]>=n)return}else l=[t,a*t+s];o=[n,a*n+s]}else{if(l){if(l[0]<t)return}else l=[n,a*n+s];o=[t,a*t+s]}return e[0]=l,e[1]=o,!0}function Ys(e,t){var r=e.site,n=t.left,i=t.right;return r===i&&(i=n,n=r),i?Math.atan2(i[1]-n[1],i[0]-n[0]):(r===n?(n=t[1],i=t[0]):(n=t[0],i=t[1]),Math.atan2(n[0]-i[0],i[1]-n[1]))}function Ks(e,t){return t[+(t.left!==e.site)]}function Qs(e,t){return t[+(t.left===e.site)]}var Js,Zs=[];function $s(){Bs(this),this.x=this.y=this.arc=this.site=this.cy=null}function el(e){var t=e.P,r=e.N;if(t&&r){var n=t.site,i=e.site,o=r.site;if(n!==o){var a=i[0],s=i[1],l=n[0]-a,u=n[1]-s,c=o[0]-a,h=o[1]-s,p=2*(l*h-u*c);if(!(p>=-ml)){var f=l*l+u*u,d=c*c+h*h,m=(h*f-u*d)/p,v=(l*d-c*f)/p,g=Zs.pop()||new $s;g.arc=e,g.site=i,g.x=m+a,g.y=(g.cy=v+s)+Math.sqrt(m*m+v*v),e.circle=g;for(var y=null,b=pl._;b;)if(g.y<b.y||g.y===b.y&&g.x<=b.x){if(!b.L){y=b.P;break}b=b.L}else{if(!b.R){y=b;break}b=b.R}pl.insert(y,g),y||(Js=g)}}}}function tl(e){var t=e.circle;t&&(t.P||(Js=t.N),pl.remove(t),Zs.push(t),Bs(t),e.circle=null)}var rl=[];function nl(){Bs(this),this.edge=this.site=this.circle=null}function il(e){var t=rl.pop()||new nl;return t.site=e,t}function ol(e){tl(e),cl.remove(e),rl.push(e),Bs(e)}function al(e){var t=e.circle,r=t.x,n=t.cy,i=[r,n],o=e.P,a=e.N,s=[e];ol(e);for(var l=o;l.circle&&Math.abs(r-l.circle.x)<dl&&Math.abs(n-l.circle.cy)<dl;)o=l.P,s.unshift(l),ol(l),l=o;s.unshift(l),tl(l);for(var u=a;u.circle&&Math.abs(r-u.circle.x)<dl&&Math.abs(n-u.circle.cy)<dl;)a=u.N,s.push(u),ol(u),u=a;s.push(u),tl(u);var c,h=s.length;for(c=1;c<h;++c)u=s[c],l=s[c-1],Hs(u.edge,l.site,u.site,i);l=s[0],(u=s[h-1]).edge=Gs(l.site,u.site,null,i),el(l),el(u)}function sl(e){for(var t,r,n,i,o=e[0],a=e[1],s=cl._;s;)if((n=ll(s,a)-o)>dl)s=s.L;else{if(!((i=o-ul(s,a))>dl)){n>-dl?(t=s.P,r=s):i>-dl?(t=s,r=s.N):t=r=s;break}if(!s.R){t=s;break}s=s.R}!function(e){hl[e.index]={site:e,halfedges:[]}}(e);var l=il(e);if(cl.insert(t,l),t||r){if(t===r)return tl(t),r=il(t.site),cl.insert(l,r),l.edge=r.edge=Gs(t.site,l.site),el(t),void el(r);if(r){tl(t),tl(r);var u=t.site,c=u[0],h=u[1],p=e[0]-c,f=e[1]-h,d=r.site,m=d[0]-c,v=d[1]-h,g=2*(p*v-f*m),y=p*p+f*f,b=m*m+v*v,x=[(v*y-f*b)/g+c,(p*b-m*y)/g+h];Hs(r.edge,u,d,x),l.edge=Gs(u,e,null,x),r.edge=Gs(e,d,null,x),el(t),el(r)}else l.edge=Gs(t.site,l.site)}}function ll(e,t){var r=e.site,n=r[0],i=r[1],o=i-t;if(!o)return n;var a=e.P;if(!a)return-1/0;var s=(r=a.site)[0],l=r[1],u=l-t;if(!u)return s;var c=s-n,h=1/o-1/u,p=c/u;return h?(-p+Math.sqrt(p*p-2*h*(c*c/(-2*u)-l+u/2+i-o/2)))/h+n:(n+s)/2}function ul(e,t){var r=e.N;if(r)return ll(r,t);var n=e.site;return n[1]===t?n[0]:1/0}var cl,hl,pl,fl,dl=1e-6,ml=1e-12;function vl(e,t){return t[1]-e[1]||t[0]-e[0]}function gl(e,t){var r,n,i,o=e.sort(vl).pop();for(fl=[],hl=new Array(e.length),cl=new zs,pl=new zs;;)if(i=Js,o&&(!i||o[1]<i.y||o[1]===i.y&&o[0]<i.x))o[0]===r&&o[1]===n||(sl(o),r=o[0],n=o[1]),o=e.pop();else{if(!i)break;al(i.arc)}if(function(){for(var e,t,r,n,i=0,o=hl.length;i<o;++i)if((e=hl[i])&&(n=(t=e.halfedges).length)){var a=new Array(n),s=new Array(n);for(r=0;r<n;++r)a[r]=r,s[r]=Ys(e,fl[t[r]]);for(a.sort(function(e,t){return s[t]-s[e]}),r=0;r<n;++r)s[r]=t[a[r]];for(r=0;r<n;++r)t[r]=s[r]}}(),t){var a=+t[0][0],s=+t[0][1],l=+t[1][0],u=+t[1][1];!function(e,t,r,n){for(var i,o=fl.length;o--;)qs(i=fl[o],e,t,r,n)&&Xs(i,e,t,r,n)&&(Math.abs(i[0][0]-i[1][0])>dl||Math.abs(i[0][1]-i[1][1])>dl)||delete fl[o]}(a,s,l,u),function(e,t,r,n){var i,o,a,s,l,u,c,h,p,f,d,m,v=hl.length,g=!0;for(i=0;i<v;++i)if(o=hl[i]){for(a=o.site,s=(l=o.halfedges).length;s--;)fl[l[s]]||l.splice(s,1);for(s=0,u=l.length;s<u;)d=(f=Qs(o,fl[l[s]]))[0],m=f[1],h=(c=Ks(o,fl[l[++s%u]]))[0],p=c[1],(Math.abs(d-h)>dl||Math.abs(m-p)>dl)&&(l.splice(s,0,fl.push(Ws(a,f,Math.abs(d-e)<dl&&n-m>dl?[e,Math.abs(h-e)<dl?p:n]:Math.abs(m-n)<dl&&r-d>dl?[Math.abs(p-n)<dl?h:r,n]:Math.abs(d-r)<dl&&m-t>dl?[r,Math.abs(h-r)<dl?p:t]:Math.abs(m-t)<dl&&d-e>dl?[Math.abs(p-t)<dl?h:e,t]:null))-1),++u);u&&(g=!1)}if(g){var y,b,x,w=1/0;for(i=0,g=null;i<v;++i)(o=hl[i])&&(x=(y=(a=o.site)[0]-e)*y+(b=a[1]-t)*b)<w&&(w=x,g=o);if(g){var S=[e,t],M=[e,n],_=[r,n],T=[r,t];g.halfedges.push(fl.push(Ws(a=g.site,S,M))-1,fl.push(Ws(a,M,_))-1,fl.push(Ws(a,_,T))-1,fl.push(Ws(a,T,S))-1)}}for(i=0;i<v;++i)(o=hl[i])&&(o.halfedges.length||delete hl[i])}(a,s,l,u)}this.edges=fl,this.cells=hl,cl=pl=fl=hl=null}gl.prototype={constructor:gl,polygons:function(){var e=this.edges;return this.cells.map(function(t){var r=t.halfedges.map(function(r){return Ks(t,e[r])});return r.data=t.site.data,r})},triangles:function(){var e=[],t=this.edges;return this.cells.forEach(function(r,n){if(o=(i=r.halfedges).length)for(var i,o,a,s,l,u,c=r.site,h=-1,p=t[i[o-1]],f=p.left===c?p.right:p.left;++h<o;)a=f,f=(p=t[i[h]]).left===c?p.right:p.left,a&&f&&n<a.index&&n<f.index&&(l=a,u=f,((s=c)[0]-u[0])*(l[1]-s[1])-(s[0]-l[0])*(u[1]-s[1])<0)&&e.push([c.data,a.data,f.data])}),e},links:function(){return this.edges.filter(function(e){return e.right}).map(function(e){return{source:e.left.data,target:e.right.data}})},find:function(e,t,r){for(var n,i,o=this,a=o._found||0,s=o.cells.length;!(i=o.cells[a]);)if(++a>=s)return null;var l=e-i.site[0],u=t-i.site[1],c=l*l+u*u;do{i=o.cells[n=a],a=null,i.halfedges.forEach(function(r){var n=o.edges[r],s=n.left;if(s!==i.site&&s||(s=n.right)){var l=e-s[0],u=t-s[1],h=l*l+u*u;h<c&&(c=h,a=s.index)}})}while(null!==a);return o._found=n,null==r||c<=r*r?i.site:null}};var yl=function(e){return function(){return e}};function bl(e,t,r){this.target=e,this.type=t,this.transform=r}function xl(e,t,r){this.k=e,this.x=t,this.y=r}xl.prototype={constructor:xl,scale:function(e){return 1===e?this:new xl(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new xl(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var wl=new xl(1,0,0);function Sl(){H.stopImmediatePropagation()}xl.prototype;var Ml=function(){H.preventDefault(),H.stopImmediatePropagation()};function _l(){return!H.ctrlKey&&!H.button}function Tl(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e).hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]:[[0,0],[e.clientWidth,e.clientHeight]]}function Al(){return this.__zoom||wl}function Cl(){return-H.deltaY*(1===H.deltaMode?.05:H.deltaMode?1:.002)}function El(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ll(e,t,r){var n=e.invertX(t[0][0])-r[0][0],i=e.invertX(t[1][0])-r[1][0],o=e.invertY(t[0][1])-r[0][1],a=e.invertY(t[1][1])-r[1][1];return e.translate(i>n?(n+i)/2:Math.min(0,n)||Math.max(0,i),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}var Nl=function(){var e,t,r=_l,n=Tl,i=Ll,o=Cl,a=El,s=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],u=250,c=zt,h=f("start","zoom","end"),p=500,d=150,m=0;function v(e){e.property("__zoom",Al).on("wheel.zoom",M).on("mousedown.zoom",_).on("dblclick.zoom",T).filter(a).on("touchstart.zoom",A).on("touchmove.zoom",C).on("touchend.zoom touchcancel.zoom",E).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(e,t){return(t=Math.max(s[0],Math.min(s[1],t)))===e.k?e:new xl(t,e.x,e.y)}function y(e,t,r){var n=t[0]-r[0]*e.k,i=t[1]-r[1]*e.k;return n===e.x&&i===e.y?e:new xl(e.k,n,i)}function b(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function x(e,t,r){e.on("start.zoom",function(){w(this,arguments).start()}).on("interrupt.zoom end.zoom",function(){w(this,arguments).end()}).tween("zoom",function(){var e=arguments,i=w(this,e),o=n.apply(this,e),a=null==r?b(o):"function"===typeof r?r.apply(this,e):r,s=Math.max(o[1][0]-o[0][0],o[1][1]-o[0][1]),l=this.__zoom,u="function"===typeof t?t.apply(this,e):t,h=c(l.invert(a).concat(s/l.k),u.invert(a).concat(s/u.k));return function(e){if(1===e)e=u;else{var t=h(e),r=s/t[2];e=new xl(r,a[0]-t[0]*r,a[1]-t[1]*r)}i.zoom(null,e)}})}function w(e,t,r){return!r&&e.__zooming||new S(e,t)}function S(e,t){this.that=e,this.args=t,this.active=0,this.extent=n.apply(e,t),this.taps=0}function M(){if(r.apply(this,arguments)){var e=w(this,arguments),t=this.__zoom,n=Math.max(s[0],Math.min(s[1],t.k*Math.pow(2,o.apply(this,arguments)))),a=se(this);if(e.wheel)e.mouse[0][0]===a[0]&&e.mouse[0][1]===a[1]||(e.mouse[1]=t.invert(e.mouse[0]=a)),clearTimeout(e.wheel);else{if(t.k===n)return;e.mouse=[a,t.invert(a)],_r(this),e.start()}Ml(),e.wheel=setTimeout(function(){e.wheel=null,e.end()},d),e.zoom("mouse",i(y(g(t,n),e.mouse[0],e.mouse[1]),e.extent,l))}}function _(){if(!t&&r.apply(this,arguments)){var e=w(this,arguments,!0),n=re(H.view).on("mousemove.zoom",function(){if(Ml(),!e.moved){var t=H.clientX-a,r=H.clientY-s;e.moved=t*t+r*r>m}e.zoom("mouse",i(y(e.that.__zoom,e.mouse[0]=se(e.that),e.mouse[1]),e.extent,l))},!0).on("mouseup.zoom",function(){n.on("mousemove.zoom mouseup.zoom",null),he(H.view,e.moved),Ml(),e.end()},!0),o=se(this),a=H.clientX,s=H.clientY;ce(H.view),Sl(),e.mouse=[o,this.__zoom.invert(o)],_r(this),e.start()}}function T(){if(r.apply(this,arguments)){var e=this.__zoom,t=se(this),o=e.invert(t),a=e.k*(H.shiftKey?.5:2),s=i(y(g(e,a),t,o),n.apply(this,arguments),l);Ml(),u>0?re(this).transition().duration(u).call(x,s,t):re(this).call(v.transform,s)}}function A(){if(r.apply(this,arguments)){var t,n,i,o,a=H.touches,s=a.length,l=w(this,arguments,H.changedTouches.length===s);for(Sl(),n=0;n<s;++n)i=a[n],o=[o=le(this,a,i.identifier),this.__zoom.invert(o),i.identifier],l.touch0?l.touch1||l.touch0[2]===o[2]||(l.touch1=o,l.taps=0):(l.touch0=o,t=!0,l.taps=1+!!e);e&&(e=clearTimeout(e)),t&&(l.taps<2&&(e=setTimeout(function(){e=null},p)),_r(this),l.start())}}function C(){if(this.__zooming){var t,r,n,o,a=w(this,arguments),s=H.changedTouches,u=s.length;for(Ml(),e&&(e=clearTimeout(e)),a.taps=0,t=0;t<u;++t)r=s[t],n=le(this,s,r.identifier),a.touch0&&a.touch0[2]===r.identifier?a.touch0[0]=n:a.touch1&&a.touch1[2]===r.identifier&&(a.touch1[0]=n);if(r=a.that.__zoom,a.touch1){var c=a.touch0[0],h=a.touch0[1],p=a.touch1[0],f=a.touch1[1],d=(d=p[0]-c[0])*d+(d=p[1]-c[1])*d,m=(m=f[0]-h[0])*m+(m=f[1]-h[1])*m;r=g(r,Math.sqrt(d/m)),n=[(c[0]+p[0])/2,(c[1]+p[1])/2],o=[(h[0]+f[0])/2,(h[1]+f[1])/2]}else{if(!a.touch0)return;n=a.touch0[0],o=a.touch0[1]}a.zoom("touch",i(y(r,n,o),a.extent,l))}}function E(){if(this.__zooming){var e,r,n=w(this,arguments),i=H.changedTouches,o=i.length;for(Sl(),t&&clearTimeout(t),t=setTimeout(function(){t=null},p),e=0;e<o;++e)r=i[e],n.touch0&&n.touch0[2]===r.identifier?delete n.touch0:n.touch1&&n.touch1[2]===r.identifier&&delete n.touch1;if(n.touch1&&!n.touch0&&(n.touch0=n.touch1,delete n.touch1),n.touch0)n.touch0[1]=this.__zoom.invert(n.touch0[0]);else if(n.end(),2===n.taps){var a=re(this).on("dblclick.zoom");a&&a.apply(this,arguments)}}}return v.transform=function(e,t,r){var n=e.selection?e.selection():e;n.property("__zoom",Al),e!==n?x(e,t,r):n.interrupt().each(function(){w(this,arguments).start().zoom(null,"function"===typeof t?t.apply(this,arguments):t).end()})},v.scaleBy=function(e,t,r){v.scaleTo(e,function(){return this.__zoom.k*("function"===typeof t?t.apply(this,arguments):t)},r)},v.scaleTo=function(e,t,r){v.transform(e,function(){var e=n.apply(this,arguments),o=this.__zoom,a=null==r?b(e):"function"===typeof r?r.apply(this,arguments):r,s=o.invert(a),u="function"===typeof t?t.apply(this,arguments):t;return i(y(g(o,u),a,s),e,l)},r)},v.translateBy=function(e,t,r){v.transform(e,function(){return i(this.__zoom.translate("function"===typeof t?t.apply(this,arguments):t,"function"===typeof r?r.apply(this,arguments):r),n.apply(this,arguments),l)})},v.translateTo=function(e,t,r,o){v.transform(e,function(){var e=n.apply(this,arguments),a=this.__zoom,s=null==o?b(e):"function"===typeof o?o.apply(this,arguments):o;return i(wl.translate(s[0],s[1]).scale(a.k).translate("function"===typeof t?-t.apply(this,arguments):-t,"function"===typeof r?-r.apply(this,arguments):-r),e,l)},o)},S.prototype={start:function(){return 1===++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(e,t){return this.mouse&&"mouse"!==e&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&"touch"!==e&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&"touch"!==e&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit("zoom"),this},end:function(){return 0===--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(e){Q(new bl(v,e,this.that.__zoom),h.apply,h,[e,this.that,this.args])}},v.wheelDelta=function(e){return arguments.length?(o="function"===typeof e?e:yl(+e),v):o},v.filter=function(e){return arguments.length?(r="function"===typeof e?e:yl(!!e),v):r},v.touchable=function(e){return arguments.length?(a="function"===typeof e?e:yl(!!e),v):a},v.extent=function(e){return arguments.length?(n="function"===typeof e?e:yl([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),v):n},v.scaleExtent=function(e){return arguments.length?(s[0]=+e[0],s[1]=+e[1],v):[s[0],s[1]]},v.translateExtent=function(e){return arguments.length?(l[0][0]=+e[0][0],l[1][0]=+e[1][0],l[0][1]=+e[0][1],l[1][1]=+e[1][1],v):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},v.constrain=function(e){return arguments.length?(i=e,v):i},v.duration=function(e){return arguments.length?(u=+e,v):u},v.interpolate=function(e){return arguments.length?(c=e,v):c},v.on=function(){var e=h.on.apply(h,arguments);return e===h?v:e},v.clickDistance=function(e){return arguments.length?(m=(e=+e)*e,v):Math.sqrt(m)},v};r.d(t,"b",function(){return re}),r.d(t,"a",function(){return H}),r.d(t,"c",function(){return Nl})},function(e,t){function r(e){return!!e.constructor&&"function"===typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(r(e)||function(e){return"function"===typeof e.readFloatLE&&"function"===typeof e.slice&&r(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t,r){"use strict";e.exports=function(e,t){if(null===e||"undefined"===typeof e)throw new TypeError("expected first argument to be an object.");if("undefined"===typeof t||"undefined"===typeof Symbol)return e;if("function"!==typeof Object.getOwnPropertySymbols)return e;for(var r=Object.prototype.propertyIsEnumerable,n=Object(e),i=arguments.length,o=0;++o<i;)for(var a=Object(arguments[o]),s=Object.getOwnPropertySymbols(a),l=0;l<s.length;l++){var u=s[l];r.call(a,u)&&(n[u]=a[u])}return n}},function(e,t,r){"use strict";var n=r(303),i=r(169);function o(e,t){return new RegExp(o.create(e,t))}o.create=function(e,t){if("string"!==typeof e)throw new TypeError("expected a string");var r=n({},t);!0===r.contains&&(r.strictNegate=!1);var o=!1!==r.strictOpen?"^":"",a=!1!==r.strictClose?"$":"",s=r.endChar?r.endChar:"+",l=o+(!1===r.strictNegate?"(?:(?!(?:"+e+")).)"+s:"(?:(?!^(?:"+e+")$).)"+s)+a;if(!0===r.safe&&!1===i(l))throw new Error("potentially unsafe regular expression: "+l);return l},e.exports=o},function(e,t,r){"use strict";e.exports=function(e){if(!Array.isArray(e))throw new TypeError("array-unique expects an array.");for(var t=e.length,r=-1;r++<t;)for(var n=r+1;n<e.length;++n)e[r]===e[n]&&e.splice(n--,1);return e},e.exports.immutable=function(t){if(!Array.isArray(t))throw new TypeError("array-unique expects an array.");for(var r=t.length,n=new Array(r),i=0;i<r;i++)n[i]=t[i];return e.exports(n)}},function(e,t,r){"use strict";var n=r(315),i=r(55),o=r(344),a=r(360),s=r(111);function l(e){n.call(this,null,e),this.options=s.extend({source:"string"},this.options),this.compiler=new o(this.options),this.parser=new a(this.options),Object.defineProperty(this,"compilers",{get:function(){return this.compiler.compilers}}),Object.defineProperty(this,"parsers",{get:function(){return this.parser.parsers}}),Object.defineProperty(this,"regex",{get:function(){return this.parser.regex}})}n.extend(l),l.prototype.capture=function(){return this.parser.capture.apply(this.parser,arguments)},l.prototype.use=function(e){return e.call(this,this),this},l.prototype.parse=function(e,t){this.options=s.extend({},this.options,t);var r=this.parser.parse(e,this.options);return i(r,"parser",this.parser),r},l.prototype.compile=function(e,t){this.options=s.extend({},this.options,t);var r=this.compiler.compile(e,this.options);return i(r,"compiler",this.compiler),r},e.exports=l,e.exports.Compiler=o,e.exports.Parser=a},function(e,t){t.getArg=function(e,t,r){if(t in e)return e[t];if(3===arguments.length)return r;throw new Error('"'+t+'" is a required argument.')};var r=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.]*)(?::(\d+))?(\S*)$/,n=/^data:.+\,.+$/;function i(e){var t=e.match(r);return t?{scheme:t[1],auth:t[2],host:t[3],port:t[4],path:t[5]}:null}function o(e){var t="";return e.scheme&&(t+=e.scheme+":"),t+="//",e.auth&&(t+=e.auth+"@"),e.host&&(t+=e.host),e.port&&(t+=":"+e.port),e.path&&(t+=e.path),t}function a(e){var r=e,n=i(e);if(n){if(!n.path)return e;r=n.path}for(var a,s=t.isAbsolute(r),l=r.split(/\/+/),u=0,c=l.length-1;c>=0;c--)"."===(a=l[c])?l.splice(c,1):".."===a?u++:u>0&&(""===a?(l.splice(c+1,u),u=0):(l.splice(c,2),u--));return""===(r=l.join("/"))&&(r=s?"/":"."),n?(n.path=r,o(n)):r}t.urlParse=i,t.urlGenerate=o,t.normalize=a,t.join=function(e,t){""===e&&(e="."),""===t&&(t=".");var r=i(t),s=i(e);if(s&&(e=s.path||"/"),r&&!r.scheme)return s&&(r.scheme=s.scheme),o(r);if(r||t.match(n))return t;if(s&&!s.host&&!s.path)return s.host=t,o(s);var l="/"===t.charAt(0)?t:a(e.replace(/\/+$/,"")+"/"+t);return s?(s.path=l,o(s)):l},t.isAbsolute=function(e){return"/"===e.charAt(0)||!!e.match(r)},t.relative=function(e,t){""===e&&(e="."),e=e.replace(/\/$/,"");for(var r=0;0!==t.indexOf(e+"/");){var n=e.lastIndexOf("/");if(n<0)return t;if((e=e.slice(0,n)).match(/^([^\/]+:\/)?\/*$/))return t;++r}return Array(r+1).join("../")+t.substr(e.length+1)};var s=!("__proto__"in Object.create(null));function l(e){return e}function u(e){if(!e)return!1;var t=e.length;if(t<9)return!1;if(95!==e.charCodeAt(t-1)||95!==e.charCodeAt(t-2)||111!==e.charCodeAt(t-3)||116!==e.charCodeAt(t-4)||111!==e.charCodeAt(t-5)||114!==e.charCodeAt(t-6)||112!==e.charCodeAt(t-7)||95!==e.charCodeAt(t-8)||95!==e.charCodeAt(t-9))return!1;for(var r=t-10;r>=0;r--)if(36!==e.charCodeAt(r))return!1;return!0}function c(e,t){return e===t?0:e>t?1:-1}t.toSetString=s?l:function(e){return u(e)?"$"+e:e},t.fromSetString=s?l:function(e){return u(e)?e.slice(1):e},t.compareByOriginalPositions=function(e,t,r){var n=e.source-t.source;return 0!==n?n:0!==(n=e.originalLine-t.originalLine)?n:0!==(n=e.originalColumn-t.originalColumn)||r?n:0!==(n=e.generatedColumn-t.generatedColumn)?n:0!==(n=e.generatedLine-t.generatedLine)?n:e.name-t.name},t.compareByGeneratedPositionsDeflated=function(e,t,r){var n=e.generatedLine-t.generatedLine;return 0!==n?n:0!==(n=e.generatedColumn-t.generatedColumn)||r?n:0!==(n=e.source-t.source)?n:0!==(n=e.originalLine-t.originalLine)?n:0!==(n=e.originalColumn-t.originalColumn)?n:e.name-t.name},t.compareByGeneratedPositionsInflated=function(e,t){var r=e.generatedLine-t.generatedLine;return 0!==r?r:0!==(r=e.generatedColumn-t.generatedColumn)?r:0!==(r=c(e.source,t.source))?r:0!==(r=e.originalLine-t.originalLine)?r:0!==(r=e.originalColumn-t.originalColumn)?r:c(e.name,t.name)}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){e.exports={}},function(e,t,r){"use strict";var n=r(0),i=r.n(n),o=r(7),a=r.n(o),s=r(58),l=r(71),u=r.n(l),c=r(22),h=r.n(c),p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var d=function(e){function t(){var r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return r=n=f(this,e.call.apply(e,[this].concat(o))),n.state={match:n.computeMatch(n.props.history.location.pathname)},f(n,r)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getChildContext=function(){return{router:p({},this.context.router,{history:this.props.history,route:{location:this.props.history.location,match:this.state.match}})}},t.prototype.computeMatch=function(e){return{path:"/",url:"/",params:{},isExact:"/"===e}},t.prototype.componentWillMount=function(){var e=this,t=this.props,r=t.children,n=t.history;h()(null==r||1===i.a.Children.count(r),"A <Router> may have only one child element"),this.unlisten=n.listen(function(){e.setState({match:e.computeMatch(n.location.pathname)})})},t.prototype.componentWillReceiveProps=function(e){u()(this.props.history===e.history,"You cannot change <Router history>")},t.prototype.componentWillUnmount=function(){this.unlisten()},t.prototype.render=function(){var e=this.props.children;return e?i.a.Children.only(e):null},t}(i.a.Component);d.propTypes={history:a.a.object.isRequired,children:a.a.node},d.contextTypes={router:a.a.object},d.childContextTypes={router:a.a.object.isRequired};var m=d,v=r(30),g=r(226);function y(e){return(y="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var b=function(e){var t=e.getIn,r=e.toJS,n=function(e){var n,i=r(t(e,["router"]));if(null==(n=i)||"object"!==y(n)||!t(n,["location"])||!t(n,["action"]))throw'Could not find router reducer in state tree, it must be mounted under "router"';return i},i=function(e){return r(t(n(e),["location"]))};return{getLocation:i,getAction:function(e){return r(t(n(e),["action"]))},getRouter:n,createMatchSelector:function(e){var t=null,r=null;return function(n){var o=(i(n)||{}).pathname;if(o===t)return r;t=o;var a=Object(g.a)(o,e);return a&&r&&a.url===r.url||(r=a),r}}}};function x(e){return(x="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(){return(w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function S(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function M(e,t){return!t||"object"!==x(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var A=function(e){var t=b(e).getLocation,r=function(e){function r(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),M(this,_(r).apply(this,arguments))}var o,a,s;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(r,n.PureComponent),o=r,(a=[{key:"componentDidMount",value:function(){var e=this,r=this.props,n=r.store,i=r.history,o=r.onLocationChanged;this.inTimeTravelling=!1,this.unsubscribe=n.subscribe(function(){var r=t(n.getState()),o=r.pathname,a=r.search,s=r.hash,l=i.location,u=l.pathname,c=l.search,h=l.hash;u===o&&c===a&&h===s||(e.inTimeTravelling=!0,i.push({pathname:o,search:a,hash:s}))});var a=function(t,r){e.inTimeTravelling?e.inTimeTravelling=!1:o(t,r)};this.unlisten=i.listen(a),a(i.location,i.action)}},{key:"componentWillUnmount",value:function(){this.unlisten(),this.unsubscribe()}},{key:"render",value:function(){var e=this.props,t=e.history,r=e.children;return i.a.createElement(m,{history:t},r)}}])&&S(o.prototype,a),s&&S(o,s),r}();r.propTypes={store:a.a.shape({getState:a.a.func.isRequired,subscribe:a.a.func.isRequired}).isRequired,history:a.a.shape({action:a.a.string.isRequired,listen:a.a.func.isRequired,location:a.a.object.isRequired,push:a.a.func.isRequired}).isRequired,basename:a.a.string,children:a.a.oneOfType([a.a.func,a.a.node]),onLocationChanged:a.a.func.isRequired};var o=function(e){var t=e.context||s.b;if(null==t)throw"Please upgrade to react-redux v6";return i.a.createElement(t.Consumer,null,function(t){var n=t.store;return i.a.createElement(r,w({store:n},e))})};return o.propTypes={context:a.a.object},Object(s.c)(null,function(e){return{onLocationChanged:function(t,r){return e(Object(v.c)(t,r))}}})(o)},C=function(e){var t=e.fromJS,r=e.merge;return function(e){var n=t({location:e.location,action:e.action});return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.type,o=t.payload;if(i===v.b){var a=o.location,s=o.action;return o.isFirstRendering?e:r(e,{location:a,action:s})}return e}}};function E(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var L={fromJS:function(e){return e},getIn:function(e,t){if(!e)return e;var r=t.length;if(r){for(var n=e,i=0;i<r&&n;++i)n=n[t[i]];return n}},merge:function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){E(e,t,r[t])})}return e}({},e,t)},toJS:function(e){return e}};r.d(t,"a",function(){return N}),r.d(t,"b",function(){return P});var N=A(L),P=C(L),O=b(L);O.getLocation,O.getAction,O.createMatchSelector},function(e,t,r){"use strict";var n=r(160),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={};a[n.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0};var s=Object.defineProperty,l=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,c=Object.getOwnPropertyDescriptor,h=Object.getPrototypeOf,p=Object.prototype;e.exports=function e(t,r,n){if("string"!==typeof r){if(p){var f=h(r);f&&f!==p&&e(t,f,n)}var d=l(r);u&&(d=d.concat(u(r)));for(var m=a[t.$$typeof]||i,v=a[r.$$typeof]||i,g=0;g<d.length;++g){var y=d[g];if(!o[y]&&(!n||!n[y])&&(!v||!v[y])&&(!m||!m[y])){var b=c(r,y);try{s(t,y,b)}catch(x){}}}return t}return t}},function(e,t,r){e.exports=r(268)},function(e,t,r){"use strict";var n=r(1),i=r(9),o=r(10),a=r.n(o),s=r(0),l=r.n(s);r(22);function u(e,t){return void 0!==e[t]}function c(e){return"default"+e.charAt(0).toUpperCase()+e.substr(1)}function h(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}r(57),r(85);var p=r(17),f=r(235),d=r.n(f);var m=function(e){return e&&"function"!==typeof e?function(t){e.current=t}:e};var v=function(e,t){return Object(s.useMemo)(function(){return function(e,t){var r=m(e),n=m(t);return function(e){r&&r(e),n&&n(e)}}(e,t)},[e,t])},g=l.a.createContext(null),y=l.a.createContext(),b=function(e,t){return null!=e?String(e):t||null},x=y,w=l.a.createContext(null),S=function(){},M=l.a.forwardRef(function(e,t){var r,o,a=e.as,u=void 0===a?"ul":a,c=e.onSelect,h=e.activeKey,p=e.role,f=e.onKeyDown,m=Object(i.a)(e,["as","onSelect","activeKey","role","onKeyDown"]),y=Object(s.useReducer)(function(e){return!e},!1)[1],M=Object(s.useRef)(!1),_=Object(s.useContext)(x),T=Object(s.useContext)(w);T&&(p=p||"tablist",h=T.activeKey,r=T.getControlledId,o=T.getControllerId);var A=Object(s.useRef)(null),C=function(e){if(!A.current)return null;var t=d()(A.current,"[data-rb-event-key]:not(.disabled)"),r=A.current.querySelector(".active"),n=t.indexOf(r);if(-1===n)return null;var i=n+e;return i>=t.length&&(i=0),i<0&&(i=t.length-1),t[i]},E=function(e,t){null!=e&&(c&&c(e,t),_&&_(e,t))};Object(s.useEffect)(function(){if(A.current&&M.current){var e=A.current.querySelector("[data-rb-event-key].active");e&&e.focus()}M.current=!1});var L=v(t,A);return l.a.createElement(x.Provider,{value:E},l.a.createElement(g.Provider,{value:{role:p,activeKey:b(h),getControlledId:r||S,getControllerId:o||S}},l.a.createElement(u,Object(n.a)({},m,{onKeyDown:function(e){var t;switch(f&&f(e),e.key){case"ArrowLeft":case"ArrowUp":t=C(-1);break;case"ArrowRight":case"ArrowDown":t=C(1);break;default:return}t&&(e.preventDefault(),E(t.dataset.rbEventKey,e),M.current=!0,y())},ref:L,role:p}))))});var _=function(e){var t=Object(s.useRef)(e);return Object(s.useEffect)(function(){t.current=e},[e]),t};var T=l.a.forwardRef(function(e,t){var r=e.active,o=e.className,u=e.tabIndex,c=e.eventKey,h=e.onSelect,p=e.onClick,f=e.as,d=Object(i.a)(e,["active","className","tabIndex","eventKey","onSelect","onClick","as"]),m=b(c,d.href),v=Object(s.useContext)(x),y=Object(s.useContext)(g),w=r;y&&(d.role||"tablist"!==y.role||(d.role="tab"),d["data-rb-event-key"]=m,d.id=y.getControllerId(m),d["aria-controls"]=y.getControlledId(m),w=null==r&&null!=m?y.activeKey===m:r),"tab"===d.role&&(d.tabIndex=w?u:-1,d["aria-selected"]=w);var S=function(e){var t=_(e);return Object(s.useCallback)(function(){return t.current&&t.current.apply(t,arguments)},[t])}(function(e){p&&p(e),null!=m&&(h&&h(m,e),v&&v(m,e))});return l.a.createElement(f,Object(n.a)({},d,{ref:t,onClick:S,className:a()(o,w&&"active")}))});T.defaultProps={disabled:!1};var A=T,C=l.a.forwardRef(function(e,t){var r=e.bsPrefix,o=e.active,u=e.disabled,c=e.className,h=e.variant,f=e.action,d=e.as,m=e.eventKey,v=e.onClick,g=Object(i.a)(e,["bsPrefix","active","disabled","className","variant","action","as","eventKey","onClick"]);r=Object(p.a)(r,"list-group-item");var y=Object(s.useCallback)(function(e){if(u)return e.preventDefault(),void e.stopPropagation();v&&v(e)},[u,v]);return l.a.createElement(A,Object(n.a)({ref:t},g,{eventKey:b(m,g.href),as:d||(f?g.href?"a":"button":"div"),onClick:y,className:a()(c,r,o&&"active",u&&"disabled",h&&r+"-"+h,f&&r+"-action")}))});C.defaultProps={variant:null,active:!1,disabled:!1},C.displayName="ListGroupItem";var E=C,L=l.a.forwardRef(function(e,t){var r=function(e,t){return Object.keys(t).reduce(function(r,o){var a,l=r[c(o)],p=r[o],f=Object(i.a)(r,[c(o),o].map(h)),d=t[o],m=Object(s.useRef)({}),v=Object(s.useState)(l),g=v[0],y=v[1],b=u(e,o),x=u(m.current,o);m.current=e,!b&&x&&y(l);var w=e[d],S=Object(s.useCallback)(function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];w&&w.apply(void 0,[e].concat(r)),y(e)},[y,w]);return Object(n.a)({},f,((a={})[o]=b?p:g,a[d]=S,a))},e)}(e,{activeKey:"onSelect"}),o=r.className,f=r.bsPrefix,d=r.variant,m=r.as,v=void 0===m?"div":m,g=Object(i.a)(r,["className","bsPrefix","variant","as"]);return f=Object(p.a)(f,"list-group"),l.a.createElement(M,Object(n.a)({ref:t},g,{as:v,className:a()(o,f,d&&f+"-"+d)}))});L.defaultProps={variant:null},L.displayName="ListGroup",L.Item=E;t.a=L},function(e,t,r){"use strict";var n=r(0),i={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},o=n.createContext&&n.createContext(i),a=function(){return(a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&(r[n[i]]=e[n[i]])}return r};function l(e){return function(t){return n.createElement(u,a({attr:a({},e.attr)},t),function e(t){return t&&t.map(function(t,r){return n.createElement(t.tag,a({key:r},t.attr),e(t.child))})}(e.child))}}function u(e){var t=function(t){var r,i=e.size||t.size||"1em";t.className&&(r=t.className),e.className&&(r=(r?r+" ":"")+e.className);var o=e.attr,l=e.title,u=s(e,["attr","title"]);return n.createElement("svg",a({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,o,u,{className:r,style:a({color:e.color||t.color},t.style,e.style),height:i,width:i,xmlns:"http://www.w3.org/2000/svg"}),l&&n.createElement("title",null,l),e.children)};return void 0!==o?n.createElement(o.Consumer,null,function(e){return t(e)}):t(i)}r.d(t,"a",function(){return c}),r.d(t,"b",function(){return h}),r.d(t,"c",function(){return p}),r.d(t,"d",function(){return f});var c=function(e){return l({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 56c110.532 0 200 89.451 200 200 0 110.532-89.451 200-200 200-110.532 0-200-89.451-200-200 0-110.532 89.451-200 200-200m0-48C119.033 8 8 119.033 8 256s111.033 248 248 248 248-111.033 248-248S392.967 8 256 8zm0 168c-44.183 0-80 35.817-80 80s35.817 80 80 80 80-35.817 80-80-35.817-80-80-80z"}}]})(e)};c.displayName="FaRegDotCircle";var h=function(e){return l({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M108 284c-6.6 0-12-5.4-12-12v-32c0-6.6 5.4-12 12-12h232c6.6 0 12 5.4 12 12v32c0 6.6-5.4 12-12 12H108zM448 80v352c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V80c0-26.5 21.5-48 48-48h352c26.5 0 48 21.5 48 48zm-48 346V86c0-3.3-2.7-6-6-6H54c-3.3 0-6 2.7-6 6v340c0 3.3 2.7 6 6 6h340c3.3 0 6-2.7 6-6z"}}]})(e)};h.displayName="FaRegMinusSquare";var p=function(e){return l({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M352 240v32c0 6.6-5.4 12-12 12h-88v88c0 6.6-5.4 12-12 12h-32c-6.6 0-12-5.4-12-12v-88h-88c-6.6 0-12-5.4-12-12v-32c0-6.6 5.4-12 12-12h88v-88c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v88h88c6.6 0 12 5.4 12 12zm96-160v352c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V80c0-26.5 21.5-48 48-48h352c26.5 0 48 21.5 48 48zm-48 346V86c0-3.3-2.7-6-6-6H54c-3.3 0-6 2.7-6 6v340c0 3.3 2.7 6 6 6h340c3.3 0 6-2.7 6-6z"}}]})(e)};p.displayName="FaRegPlusSquare";var f=function(e){return l({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M494.2 221.9l-59.8-40.5 13.7-71c2.6-13.2-1.6-26.8-11.1-36.4-9.6-9.5-23.2-13.7-36.2-11.1l-70.9 13.7-40.4-59.9c-15.1-22.3-51.9-22.3-67 0l-40.4 59.9-70.8-13.7C98 60.4 84.5 64.5 75 74.1c-9.5 9.6-13.7 23.1-11.1 36.3l13.7 71-59.8 40.5C6.6 229.5 0 242 0 255.5s6.7 26 17.8 33.5l59.8 40.5-13.7 71c-2.6 13.2 1.6 26.8 11.1 36.3 9.5 9.5 22.9 13.7 36.3 11.1l70.8-13.7 40.4 59.9C230 505.3 242.6 512 256 512s26-6.7 33.5-17.8l40.4-59.9 70.9 13.7c13.4 2.7 26.8-1.6 36.3-11.1 9.5-9.5 13.6-23.1 11.1-36.3l-13.7-71 59.8-40.5c11.1-7.5 17.8-20.1 17.8-33.5-.1-13.6-6.7-26.1-17.9-33.7zm-112.9 85.6l17.6 91.2-91-17.6L256 458l-51.9-77-90.9 17.6 17.6-91.2-76.8-52 76.8-52-17.6-91.2 91 17.6L256 53l51.9 76.9 91-17.6-17.6 91.1 76.8 52-76.8 52.1zM256 152c-57.3 0-104 46.7-104 104s46.7 104 104 104 104-46.7 104-104-46.7-104-104-104zm0 160c-30.9 0-56-25.1-56-56s25.1-56 56-56 56 25.1 56 56-25.1 56-56 56z"}}]})(e)};f.displayName="FaRegSun"},function(e,t){e.exports={ROOT:0,GROUP:1,POSITION:2,SET:3,RANGE:4,REPETITION:5,REFERENCE:6,CHAR:7}},function(e,t,r){"use strict";e.exports=function(e){return"undefined"!==typeof e&&null!==e&&("object"===typeof e||"function"===typeof e)}},function(e,t,r){"use strict";var n=r(172),i=e.exports;i.extend=r(49),i.flatten=r(307),i.isObject=r(35),i.fillRange=r(308),i.repeat=r(310),i.unique=r(95),i.define=function(e,t,r){Object.defineProperty(e,t,{writable:!0,configurable:!0,enumerable:!1,value:r})},i.isEmptySets=function(e){return/^(?:\{,\})+$/.test(e)},i.isQuotedString=function(e){var t=e.charAt(0);return("'"===t||'"'===t||"`"===t)&&e.slice(-1)===t},i.createKey=function(e,t){var r=e;if("undefined"===typeof t)return r;for(var n=Object.keys(t),i=0;i<n.length;i++){var o=n[i];r+=";"+o+"="+String(t[o])}return r},i.createOptions=function(e){var t=i.extend.apply(null,arguments);return"boolean"===typeof t.expand&&(t.optimize=!t.expand),"boolean"===typeof t.optimize&&(t.expand=!t.optimize),!0===t.optimize&&(t.makeRe=!0),t},i.join=function(e,t,r){if(r=r||{},e=i.arrayify(e),t=i.arrayify(t),!e.length)return t;if(!t.length)return e;for(var n=e.length,o=-1,a=[];++o<n;){var s=e[o];if(Array.isArray(s)){for(var l=0;l<s.length;l++)s[l]=i.join(s[l],t,r);a.push(s)}else for(var u=0;u<t.length;u++){var c=t[u];Array.isArray(c)?a.push(i.join(s,c,r)):a.push(s+c)}}return a},i.split=function(e,t){var r=i.extend({sep:","},t);return"boolean"!==typeof r.keepQuotes&&(r.keepQuotes=!0),!1===r.unescape&&(r.keepEscaping=!0),n(e,r,i.escapeBrackets(r))},i.expand=function(e,t){var r=i.extend({rangeLimit:1e4},t),n=i.split(e,r),o={segs:n};if(i.isQuotedString(e))return o;if(!0===r.rangeLimit&&(r.rangeLimit=1e4),n.length>1){if(!1===r.optimize)return o.val=n[0],o;o.segs=i.stringifyArray(o.segs)}else if(1===n.length){var a=e.split("..");if(1===a.length)return o.val=o.segs[o.segs.length-1]||o.val||e,o.segs=[],o;if(2===a.length&&a[0]===a[1])return o.escaped=!0,o.val=a[0],o.segs=[],o;if(a.length>1){if(!1!==r.optimize&&(r.optimize=!0,delete r.expand),!0!==r.optimize){var s=Math.min(a[0],a[1]),l=Math.max(a[0],a[1]),u=a[2]||1;if(!1!==r.rangeLimit&&(l-s)/u>=r.rangeLimit)throw new RangeError("expanded array length exceeds range limit. Use options.rangeLimit to increase or disable the limit.")}return a.push(r),o.segs=i.fillRange.apply(null,a),o.segs.length?(!0===r.optimize&&(o.segs=i.stringifyArray(o.segs)),""===o.segs?o.val=e:o.val=o.segs[0],o):(o.escaped=!0,o.val=e,o)}}else o.val=e;return o},i.escapeBrackets=function(e){return function(t){if(t.escaped&&"b"===t.val)t.val="\\b";else if("("===t.val||"["===t.val){for(var r=i.extend({},e),n=[],o=[],a=[],s=t.val,l=t.str,u=t.idx-1;++u<l.length;){var c=l[u];if("\\"!==c){if("("===c&&(o.push(c),a.push(c)),"["===c&&(n.push(c),a.push(c)),")"===c&&(o.pop(),a.pop(),!a.length)){s+=c;break}if("]"===c&&(n.pop(),a.pop(),!a.length)){s+=c;break}s+=c}else s+=(!1===r.keepEscaping?"":c)+l[++u]}t.split=!1,t.val=s.slice(1),t.idx=u}}},i.isQuantifier=function(e){return/^(?:[0-9]?,[0-9]|[0-9],)$/.test(e)},i.stringifyArray=function(e){return[i.arrayify(e).join("|")]},i.arrayify=function(e){return"undefined"===typeof e?[]:"string"===typeof e?[e]:e},i.isString=function(e){return null!=e&&"string"===typeof e},i.last=function(e,t){return e[e.length-(t||1)]},i.escapeRegex=function(e){return e.replace(/\\?([!^*?()[\]{}+?\/])/g,"\\$1")}},function(e,t,r){var n=r(92),i=Object.prototype.toString;e.exports=function(e){if("undefined"===typeof e)return"undefined";if(null===e)return"null";if(!0===e||!1===e||e instanceof Boolean)return"boolean";if("string"===typeof e||e instanceof String)return"string";if("number"===typeof e||e instanceof Number)return"number";if("function"===typeof e||e instanceof Function)return"function";if("undefined"!==typeof Array.isArray&&Array.isArray(e))return"array";if(e instanceof RegExp)return"regexp";if(e instanceof Date)return"date";var t=i.call(e);return"[object RegExp]"===t?"regexp":"[object Date]"===t?"date":"[object Arguments]"===t?"arguments":"[object Error]"===t?"error":n(e)?"buffer":"[object Set]"===t?"set":"[object WeakSet]"===t?"weakset":"[object Map]"===t?"map":"[object WeakMap]"===t?"weakmap":"[object Symbol]"===t?"symbol":"[object Int8Array]"===t?"int8array":"[object Uint8Array]"===t?"uint8array":"[object Uint8ClampedArray]"===t?"uint8clampedarray":"[object Int16Array]"===t?"int16array":"[object Uint16Array]"===t?"uint16array":"[object Int32Array]"===t?"int32array":"[object Uint32Array]"===t?"uint32array":"[object Float32Array]"===t?"float32array":"[object Float64Array]"===t?"float64array":"object"}},function(e,t){function r(e){return e?Array.isArray(e)?e.join("."):e:""}e.exports=function(e,t,n,i,o){if(null===(a=e)||"object"!==typeof a&&"function"!==typeof a||!t)return e;var a;if(t=r(t),n&&(t+="."+r(n)),i&&(t+="."+r(i)),o&&(t+="."+r(o)),t in e)return e[t];for(var s=t.split("."),l=s.length,u=-1;e&&++u<l;){for(var c=s[u];"\\"===c[c.length-1];)c=c.slice(0,-1)+"."+s[++u];e=e[c]}return e}},function(e,t){var r=1e3,n=60*r,i=60*n,o=24*i,a=365.25*o;function s(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}e.exports=function(e,t){t=t||{};var l,u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var s=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return s*a;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*i;case"minutes":case"minute":case"mins":case"min":case"m":return s*n;case"seconds":case"second":case"secs":case"sec":case"s":return s*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(e);if("number"===u&&!1===isNaN(e))return t.long?s(l=e,o,"day")||s(l,i,"hour")||s(l,n,"minute")||s(l,r,"second")||l+" ms":function(e){if(e>=o)return Math.round(e/o)+"d";if(e>=i)return Math.round(e/i)+"h";if(e>=n)return Math.round(e/n)+"m";if(e>=r)return Math.round(e/r)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,r){"use strict";t.extend=r(49),t.SourceMap=r(346),t.sourceMapResolve=r(353),t.unixify=function(e){return e.split(/\\+/).join("/")},t.isString=function(e){return e&&"string"===typeof e},t.arrayify=function(e){return"string"===typeof e?[e]:e?Array.isArray(e)?e:[e]:[]},t.last=function(e,t){return e[e.length-(t||1)]}},function(e,t,r){var n=r(199),i=r(145);e.exports=Object.keys||function(e){return n(e,i)}},function(e,t){e.exports=!0},function(e,t){var r=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+n).toString(36))}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,r){var n=r(141);e.exports=function(e){return Object(n(e))}},function(e,t,r){(function(n){function i(){var e;try{e=t.storage.debug}catch(r){}return!e&&"undefined"!==typeof n&&"env"in n&&(e=Object({NODE_ENV:"production",PUBLIC_URL:""}).DEBUG),e}(t=e.exports=r(461)).log=function(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),!r)return;var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var i=0,o=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))}),e.splice(o,0,n)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(r){}},t.load=i,t.useColors=function(){if("undefined"!==typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},t.enable(i())}).call(this,r(48))},function(e,t){t.encode=function(e){var t="";for(var r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t},t.decode=function(e){for(var t={},r=e.split("&"),n=0,i=r.length;n<i;n++){var o=r[n].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}},function(e,t){e.exports=function(e,t){var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},function(e,t,r){(function(n){function i(){var e;try{e=t.storage.debug}catch(r){}return!e&&"undefined"!==typeof n&&"env"in n&&(e=Object({NODE_ENV:"production",PUBLIC_URL:""}).DEBUG),e}(t=e.exports=r(478)).log=function(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),!r)return;var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var i=0,o=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))}),e.splice(o,0,n)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(r){}},t.load=i,t.useColors=function(){if("undefined"!==typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},t.enable(i())}).call(this,r(48))},function(e,t,r){"use strict";t.__esModule=!0;var n=a(r(396)),i=a(r(406)),o="function"===typeof i.default&&"symbol"===typeof n.default?function(e){return typeof e}:function(e){return e&&"function"===typeof i.default&&e.constructor===i.default&&e!==i.default.prototype?"symbol":typeof e};function a(e){return e&&e.__esModule?e:{default:e}}t.default="function"===typeof i.default&&"symbol"===o(n.default)?function(e){return"undefined"===typeof e?"undefined":o(e)}:function(e){return e&&"function"===typeof i.default&&e.constructor===i.default&&e!==i.default.prototype?"symbol":"undefined"===typeof e?"undefined":o(e)}},function(e,t,r){"use strict";var n=r(46),i=r(84),o=r(123);t.a=function(e){return function t(r,a,s,l){var u=void 0===a?{}:a,c=u.namespace,h=void 0===c?n.b:c,p=u.prefix;return void 0===s&&(s={}),void 0===l&&(l=""),Object(i.a)(r).forEach(function(i){var a=function(e){return l||!p||p&&new RegExp("^"+p+h).test(e)?e:""+p+h+e}(function(e){var t;if(!l)return e;var r=e.toString().split(n.a),i=l.split(n.a);return(t=[]).concat.apply(t,i.map(function(e){return r.map(function(t){return""+e+h+t})})).join(n.a)}(i)),u=Object(o.a)(i,r);e(u)?t(u,{namespace:h,prefix:p},s,a):s[a]=u}),s}}},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(66);function i(e,t){return Object(n.a)(t)?t.get(e):t[e]}},function(e,t,r){"use strict";t.a=function(e){return null===e||void 0===e}},function(e,t,r){"use strict";t.a={mobileStepper:1e3,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500}},function(e,t,r){"use strict";function n(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:166;function n(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];var a=this;clearTimeout(t),t=setTimeout(function(){e.apply(a,i)},r)}return n.clear=function(){clearTimeout(t)},n}r.d(t,"a",function(){return n})},function(e,t,r){"use strict";t.__esModule=!0;var n=o(r(425)),i=o(r(428));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function e(t,r,o){null===t&&(t=Function.prototype);var a=(0,i.default)(t,r);if(void 0===a){var s=(0,n.default)(t);return null===s?void 0:e(s,r,o)}if("value"in a)return a.value;var l=a.get;return void 0!==l?l.call(o):void 0}},function(e,t,r){"use strict";var n=r(1),i=r(9),o=r(10),a=r.n(o),s=r(0),l=r.n(s),u=r(17),c=l.a.forwardRef(function(e,t){var r=e.bsPrefix,o=e.noGutters,s=e.as,c=void 0===s?"div":s,h=e.className,p=Object(i.a)(e,["bsPrefix","noGutters","as","className"]),f=Object(u.a)(r,"row");return l.a.createElement(c,Object(n.a)({ref:t},p,{className:a()(h,f,o&&"no-gutters")}))});c.defaultProps={noGutters:!1},t.a=c},,,function(e,t,r){"use strict";var n=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(i){return!1}}()?Object.assign:function(e,t){for(var r,a,s=function(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),l=1;l<arguments.length;l++){for(var u in r=Object(arguments[l]))i.call(r,u)&&(s[u]=r[u]);if(n){a=n(r);for(var c=0;c<a.length;c++)o.call(r,a[c])&&(s[a[c]]=r[a[c]])}}return s}},function(e,t,r){"use strict";(function(t){var n=r(39),i=r(270),o={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!n.isUndefined(e)&&n.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var s={adapter:function(){var e;return"undefined"!==typeof XMLHttpRequest?e=r(164):"undefined"!==typeof t&&(e=r(164)),e}(),transformRequest:[function(e,t){return i(t,"Content-Type"),n.isFormData(e)||n.isArrayBuffer(e)||n.isBuffer(e)||n.isStream(e)||n.isFile(e)||n.isBlob(e)?e:n.isArrayBufferView(e)?e.buffer:n.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):n.isObject(e)?(a(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"===typeof e)try{e=JSON.parse(e)}catch(t){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};n.forEach(["delete","get","head"],function(e){s.headers[e]={}}),n.forEach(["post","put","patch"],function(e){s.headers[e]=n.merge(o)}),e.exports=s}).call(this,r(48))},function(e,t,r){"use strict";var n=r(108);e.exports=function(e){var t=n(e);if("string"===t){if(!e.trim())return!1}else if("number"!==t)return!1;return e-e+1>=0}},function(e,t,r){(function(n){function i(){var e;try{e=t.storage.debug}catch(r){}return!e&&"undefined"!==typeof n&&"env"in n&&(e=Object({NODE_ENV:"production",PUBLIC_URL:""}).DEBUG),e}(t=e.exports=r(345)).log=function(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),!r)return;var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var i=0,o=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))}),e.splice(o,0,n)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(r){}},t.load=i,t.useColors=function(){if("undefined"!==typeof window&&window.process&&"renderer"===window.process.type)return!0;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},t.enable(i())}).call(this,r(48))},function(e,t,r){(function(e){function r(e,t){for(var r=0,n=e.length-1;n>=0;n--){var i=e[n];"."===i?e.splice(n,1):".."===i?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}var n=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i=function(e){return n.exec(e).slice(1)};function o(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}t.resolve=function(){for(var t="",n=!1,i=arguments.length-1;i>=-1&&!n;i--){var a=i>=0?arguments[i]:e.cwd();if("string"!==typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(t=a+"/"+t,n="/"===a.charAt(0))}return(n?"/":"")+(t=r(o(t.split("/"),function(e){return!!e}),!n).join("/"))||"."},t.normalize=function(e){var n=t.isAbsolute(e),i="/"===a(e,-1);return(e=r(o(e.split("/"),function(e){return!!e}),!n).join("/"))||n||(e="."),e&&i&&(e+="/"),(n?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(o(e,function(e,t){if("string"!==typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},t.relative=function(e,r){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=t.resolve(e).substr(1),r=t.resolve(r).substr(1);for(var i=n(e.split("/")),o=n(r.split("/")),a=Math.min(i.length,o.length),s=a,l=0;l<a;l++)if(i[l]!==o[l]){s=l;break}var u=[];for(l=s;l<i.length;l++)u.push("..");return(u=u.concat(o.slice(s))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){var t=i(e),r=t[0],n=t[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},t.basename=function(e,t){var r=i(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},t.extname=function(e){return i(e)[3]};var a="b"==="ab".substr(-1)?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)}}).call(this,r(48))},function(e,t,r){"use strict";var n=r(183);function i(e){this.caches=e||{}}i.prototype={cache:function(e){return this.caches[e]||(this.caches[e]=new n)},set:function(e,t,r){var n=this.cache(e);return n.set(t,r),n},has:function(e,t){return"undefined"!==typeof this.get(e,t)},get:function(e,t){var r=this.cache(e);return"string"===typeof t?r.get(t):r}},e.exports=i},function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){var n=r(390);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}}},function(e,t,r){var n=r(81);e.exports=function(e,t){if(!n(e))return e;var r,i;if(t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;if("function"==typeof(r=e.valueOf)&&!n(i=r.call(e)))return i;if(!t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t){var r=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:r)(e)}},function(e,t,r){var n=r(144)("keys"),i=r(114);e.exports=function(e){return n[e]||(n[e]=i(e))}},function(e,t,r){var n=r(36),i=r(64),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:n.version,mode:r(113)?"pure":"global",copyright:"\xa9 2018 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,r){var n=r(80),i=r(400),o=r(145),a=r(143)("IE_PROTO"),s=function(){},l=function(){var e,t=r(198)("iframe"),n=o.length;for(t.style.display="none",r(401).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;n--;)delete l.prototype[o[n]];return l()};e.exports=Object.create||function(e,t){var r;return null!==e?(s.prototype=n(e),r=new s,s.prototype=null,r[a]=e):r=l(),void 0===t?r:i(r,t)}},function(e,t,r){var n=r(65).f,i=r(74),o=r(50)("toStringTag");e.exports=function(e,t,r){e&&!i(e=r?e:e.prototype,o)&&n(e,o,{configurable:!0,value:t})}},function(e,t,r){t.f=r(50)},function(e,t,r){var n=r(64),i=r(36),o=r(113),a=r(149),s=r(65).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=o?{}:n.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},function(e,t,r){var n=r(115),i=r(98),o=r(75),a=r(139),s=r(74),l=r(197),u=Object.getOwnPropertyDescriptor;t.f=r(73)?u:function(e,t){if(e=o(e),t=a(t,!0),l)try{return u(e,t)}catch(r){}if(s(e,t))return i(!n.f.call(e,t),e[t])}},function(e,t,r){var n=r(462)("socket.io-parser"),i=r(62),o=r(464),a=r(211),s=r(212);function l(){}t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=l,t.Decoder=h;var u=t.ERROR+'"encode error"';function c(e){var r=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(r+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(r+=e.nsp+","),null!=e.id&&(r+=e.id),null!=e.data){var i=function(e){try{return JSON.stringify(e)}catch(t){return!1}}(e.data);if(!1===i)return u;r+=i}return n("encoded %j as %s",e,r),r}function h(){this.reconstructor=null}function p(e){this.reconPack=e,this.buffers=[]}function f(e){return{type:t.ERROR,data:"parser error: "+e}}l.prototype.encode=function(e,r){(n("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type)?function(e,t){o.removeBlobs(e,function(e){var r=o.deconstructPacket(e),n=c(r.packet),i=r.buffers;i.unshift(n),t(i)})}(e,r):r([c(e)])},i(h.prototype),h.prototype.add=function(e){var r;if("string"===typeof e)r=function(e){var r=0,i={type:Number(e.charAt(0))};if(null==t.types[i.type])return f("unknown packet type "+i.type);if(t.BINARY_EVENT===i.type||t.BINARY_ACK===i.type){for(var o="";"-"!==e.charAt(++r)&&(o+=e.charAt(r),r!=e.length););if(o!=Number(o)||"-"!==e.charAt(r))throw new Error("Illegal attachments");i.attachments=Number(o)}if("/"===e.charAt(r+1))for(i.nsp="";++r;){var s=e.charAt(r);if(","===s)break;if(i.nsp+=s,r===e.length)break}else i.nsp="/";var l=e.charAt(r+1);if(""!==l&&Number(l)==l){for(i.id="";++r;){var s=e.charAt(r);if(null==s||Number(s)!=s){--r;break}if(i.id+=e.charAt(r),r===e.length)break}i.id=Number(i.id)}if(e.charAt(++r)){var u=function(e){try{return JSON.parse(e)}catch(t){return!1}}(e.substr(r)),c=!1!==u&&(i.type===t.ERROR||a(u));if(!c)return f("invalid payload");i.data=u}return n("decoded %s as %j",e,i),i}(e),t.BINARY_EVENT===r.type||t.BINARY_ACK===r.type?(this.reconstructor=new p(r),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",r)):this.emit("decoded",r);else{if(!s(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(r=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",r))}},h.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},p.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=o.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},p.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t,r){"use strict";(function(e){var n=r(465),i=r(466),o=r(178);function a(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,r){if(!l.TYPED_ARRAY_SUPPORT&&!(this instanceof l))return new l(e,t,r);if("number"===typeof e){if("string"===typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return u(this,e,t,r)}function u(e,t,r,n){if("number"===typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!==typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=p(e,t);return e}(e,t,r,n):"string"===typeof t?function(e,t,r){"string"===typeof r&&""!==r||(r="utf8");if(!l.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|d(t,r),i=(e=s(e,n)).write(t,r);i!==n&&(e=e.slice(0,i));return e}(e,t,r):function(e,t){if(l.isBuffer(t)){var r=0|f(t.length);return 0===(e=s(e,r)).length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!==typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!==typeof t.length||(n=t.length)!==n?s(e,0):p(e,t);if("Buffer"===t.type&&o(t.data))return p(e,t.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function c(e){if("number"!==typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(c(t),e=s(e,t<0?0:0|f(t)),!l.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function p(e,t){var r=t.length<0?0:0|f(t.length);e=s(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function f(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function d(e,t){if(l.isBuffer(e))return e.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!==typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return V(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return j(e).length;default:if(n)return V(e).length;t=(""+t).toLowerCase(),n=!0}}function m(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function v(e,t,r,n,i){if(0===e.length)return-1;if("string"===typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"===typeof t&&(t=l.from(t,n)),l.isBuffer(t))return 0===t.length?-1:g(e,t,r,n,i);if("number"===typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):g(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function g(e,t,r,n,i){var o,a=1,s=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,r/=2}function u(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var c=-1;for(o=r;o<s;o++)if(u(e,o)===u(t,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===l)return c*a}else-1!==c&&(o-=o-c),c=-1}else for(r+l>s&&(r=s-l),o=r;o>=0;o--){for(var h=!0,p=0;p<l;p++)if(u(e,o+p)!==u(t,p)){h=!1;break}if(h)return o}return-1}function y(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!==0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var a=0;a<n;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[r+a]=s}return a}function b(e,t,r,n){return z(V(t,e.length-r),e,r,n)}function x(e,t,r,n){return z(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function w(e,t,r,n){return x(e,t,r,n)}function S(e,t,r,n){return z(j(t),e,r,n)}function M(e,t,r,n){return z(function(e,t){for(var r,n,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function _(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function T(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,a,s,l,u=e[i],c=null,h=u>239?4:u>223?3:u>191?2:1;if(i+h<=r)switch(h){case 1:u<128&&(c=u);break;case 2:128===(192&(o=e[i+1]))&&(l=(31&u)<<6|63&o)>127&&(c=l);break;case 3:o=e[i+1],a=e[i+2],128===(192&o)&&128===(192&a)&&(l=(15&u)<<12|(63&o)<<6|63&a)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128===(192&o)&&128===(192&a)&&128===(192&s)&&(l=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(c=l)}null===c?(c=65533,h=1):c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),i+=h}return function(e){var t=e.length;if(t<=A)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=A));return r}(n)}t.Buffer=l,t.SlowBuffer=function(e){+e!=e&&(e=0);return l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"===typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return!1}}(),t.kMaxLength=a(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,r){return u(null,e,t,r)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,r){return function(e,t,r,n){return c(t),t<=0?s(e,t):void 0!==r?"string"===typeof n?s(e,t).fill(r,n):s(e,t).fill(r):s(e,t)}(null,e,t,r)},l.allocUnsafe=function(e){return h(null,e)},l.allocUnsafeSlow=function(e){return h(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=l.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var a=e[r];if(!l.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(n,i),i+=a.length}return n},l.byteLength=d,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?T(this,0,e):function(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return L(this,t,r);case"utf8":case"utf-8":return T(this,t,r);case"ascii":return C(this,t,r);case"latin1":case"binary":return E(this,t,r);case"base64":return _(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,r,n,i){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0),s=Math.min(o,a),u=this.slice(n,i),c=e.slice(t,r),h=0;h<s;++h)if(u[h]!==c[h]){o=u[h],a=c[h];break}return o<a?-1:a<o?1:0},l.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},l.prototype.indexOf=function(e,t,r){return v(this,e,t,r,!0)},l.prototype.lastIndexOf=function(e,t,r){return v(this,e,t,r,!1)},l.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"===typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return y(this,e,t,r);case"utf8":case"utf-8":return b(this,e,t,r);case"ascii":return x(this,e,t,r);case"latin1":case"binary":return w(this,e,t,r);case"base64":return S(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var A=4096;function C(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function E(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function L(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=U(e[o]);return i}function N(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function P(e,t,r){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function O(e,t,r,n,i,o){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function R(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function D(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function F(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function k(e,t,r,n,o){return o||F(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function I(e,t,r,n,o){return o||F(e,0,r,8),i.write(e,t,r,n,52,8),r+8}l.prototype.slice=function(e,t){var r,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=l.prototype;else{var i=t-e;r=new l(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+e]}return r},l.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||P(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},l.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||P(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},l.prototype.readUInt8=function(e,t){return t||P(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||P(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||P(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||P(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||P(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||P(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},l.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||P(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},l.prototype.readInt8=function(e,t){return t||P(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||P(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt16BE=function(e,t){t||P(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt32LE=function(e,t){return t||P(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||P(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||P(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||P(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||P(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||O(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},l.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||O(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},l.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):D(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);O(this,e,t,r,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<r&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},l.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);O(this,e,t,r,i-1,-i)}var o=r-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},l.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):D(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,r){return k(this,e,t,!0,r)},l.prototype.writeFloatBE=function(e,t,r){return k(this,e,t,!1,r)},l.prototype.writeDoubleLE=function(e,t,r){return I(this,e,t,!0,r)},l.prototype.writeDoubleBE=function(e,t,r){return I(this,e,t,!1,r)},l.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,o=n-r;if(this===e&&r<t&&t<n)for(i=o-1;i>=0;--i)e[i+t]=this[i+r];else if(o<1e3||!l.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},l.prototype.fill=function(e,t,r,n){if("string"===typeof e){if("string"===typeof t?(n=t,t=0,r=this.length):"string"===typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!==typeof n)throw new TypeError("encoding must be a string");if("string"===typeof n&&!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"===typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"===typeof e)for(o=t;o<r;++o)this[o]=e;else{var a=l.isBuffer(e)?e:V(new l(e,n).toString()),s=a.length;for(o=0;o<r-t;++o)this[o+t]=a[o%s]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function U(e){return e<16?"0"+e.toString(16):e.toString(16)}function V(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function j(e){return n.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(B,"")).length<2)return"";for(;e.length%4!==0;)e+="=";return e}(e))}function z(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}}).call(this,r(72))},function(e,t,r){var n=r(469);e.exports=function(e){var t=e.xdomain,r=e.xscheme,i=e.enablesXDR;try{if("undefined"!==typeof XMLHttpRequest&&(!t||n))return new XMLHttpRequest}catch(o){}try{if("undefined"!==typeof XDomainRequest&&!r&&i)return new XDomainRequest}catch(o){}if(!t)try{return new(self[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(o){}}},function(e,t,r){var n=r(83),i=r(62);function o(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}e.exports=o,i(o.prototype),o.prototype.onError=function(e,t){var r=new Error(e);return r.type="TransportError",r.description=t,this.emit("error",r),this},o.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},o.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},o.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},o.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},o.prototype.onData=function(e){var t=n.decodePacket(e,this.socket.binaryType);this.onPacket(t)},o.prototype.onPacket=function(e){this.emit("packet",e)},o.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,r){"use strict";(function(e,n){var i,o=r(222);i="undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof e?e:n;var a=Object(o.a)(i);t.a=a}).call(this,r(72),r(262)(e))},function(e,t,r){var n=r(285);e.exports=function(e){return n(e).replace(/\s(\w)/g,function(e,t){return t.toUpperCase()})}},function(e,t,r){e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}return r.m=e,r.c=t,r.p="",r(0)}([function(e,t,r){"use strict";var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(1),a=l(o),s=l(r(2));function l(e){return e&&e.__esModule?e:{default:e}}var u="undefined"!=typeof document,c=/^[+-]?((\.\d+)|(\d+(\.\d+)?))$/,h=/^([+-]|\.0*|[+-]\.0*|[+-]?\d+\.)?$/;function p(e,t,r){var n=e[t];if("function"==typeof n){for(var i=arguments.length,o=Array(i>3?i-3:0),a=3;a<i;a++)o[a-3]=arguments[a];n=n.apply(void 0,o)}return void 0===n?r:n}var f=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));return a._isStrict=!!a.props.strict,a.state=n({btnDownHover:!1,btnDownActive:!1,btnUpHover:!1,btnUpActive:!1,stringValue:""},a._propsToState(a.props)),a.stop=a.stop.bind(a),a.onTouchEnd=a.onTouchEnd.bind(a),a.refsInput={},a.refsWrapper={},a}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),i(t,[{key:"_propsToState",value:function(e){var t={};return e.hasOwnProperty("value")?(t.stringValue=String(e.value||0===e.value?e.value:"").trim(),t.value=""!==t.stringValue?this._parse(e.value):null):!this._isMounted&&e.hasOwnProperty("defaultValue")&&(t.stringValue=String(e.defaultValue||0===e.defaultValue?e.defaultValue:"").trim(),t.value=""!==e.defaultValue?this._parse(e.defaultValue):null),t}},{key:"componentWillReceiveProps",value:function(e){var t=this;this._isStrict=!!e.strict;var r=this._propsToState(e);Object.keys(r).length&&(this._ignoreValueChange=!0,this.setState(r,function(){t._ignoreValueChange=!1}))}},{key:"componentWillUpdate",value:function(){this.saveSelection()}},{key:"componentDidUpdate",value:function(e,t){this._ignoreValueChange||t.value===this.state.value||isNaN(this.state.value)&&null!==this.state.value||this._invokeEventCallback("onChange",this.state.value,this.refsInput.value,this.refsInput),this._inputFocus&&(this.refsInput.focus(),(this.state.selectionStart||0===this.state.selectionStart)&&(this.refsInput.selectionStart=this.state.selectionStart),(this.state.selectionEnd||0===this.state.selectionEnd)&&(this.refsInput.selectionEnd=this.state.selectionEnd)),this.checkValidity()}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,this.stop()}},{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,this.refsInput.getValueAsNumber=function(){return e.state.value||0},this.refsInput.setValue=function(t){e.setState({value:e._parse(t),stringValue:t})},!this._inputFocus&&u&&document.activeElement===this.refsInput&&(this._inputFocus=!0,this.refsInput.focus(),this._invokeEventCallback("onFocus",{target:this.refsInput,type:"focus"})),this.checkValidity()}},{key:"saveSelection",value:function(){this.state.selectionStart=this.refsInput.selectionStart,this.state.selectionEnd=this.refsInput.selectionEnd}},{key:"checkValidity",value:function(){var e=void 0,t="",r=!!this.refsInput.checkValidity,n=!(!this.props.noValidate||"false"==this.props.noValidate);this.refsInput.noValidate=n,(e=n||!r)?t="":(""===this.refsInput.pattern&&(this.refsInput.pattern=this.props.required?".+":".*"),r&&(this.refsInput.checkValidity(),(e=this.refsInput.validity.valid)||(t=this.refsInput.validationMessage)),e&&r&&this.props.maxLength&&this.refsInput.value.length>this.props.maxLength&&(t="This value is too long")),t=t||(e?"":this.refsInput.validationMessage||"Unknown Error");var i=this._valid!==t;this._valid=t,t?(!function(e,t){if(e.classList)return e.classList.add(t);e.className.search(new RegExp("\\b"+t+"\\b"))||(e.className=" "+t)}(this.refsWrapper,"has-error"),i&&this._invokeEventCallback("onInvalid",t,this.state.value,this.refsInput.value)):(!function(e,t){if(e.className){if(e.classList)return e.classList.remove(t);e.className=e.className.replace(new RegExp("\\b"+t+"\\b","g"),"")}}(this.refsWrapper,"has-error"),i&&this._invokeEventCallback("onValid",this.state.value,this.refsInput.value))}},{key:"_toNumber",value:function(e){var r=parseFloat(e);if(!isNaN(r)&&isFinite(r)||(r=0),this._isStrict){var n=p(this.props,"precision",null,this),i=Math.pow(10,null===n?10:n),o=+p(this.props,"min",t.defaultProps.min,this),a=+p(this.props,"max",t.defaultProps.max,this);r=Math.min(Math.max(r,o),a),r=Math.round(r*i)/i}return r}},{key:"_parse",value:function(e){return e=String(e),"function"==typeof this.props.parse?parseFloat(this.props.parse(e)):parseFloat(e)}},{key:"_format",value:function(e){var t=this._toNumber(e),r=p(this.props,"precision",null,this);return null!==r&&(t=e.toFixed(r)),t+="",this.props.format?this.props.format(t):t}},{key:"_step",value:function(e,r){var n=this._isStrict;this._isStrict=!0;var i=+p(this.props,"step",t.defaultProps.step,this,e>0?t.DIRECTION_UP:t.DIRECTION_DOWN),o=this._toNumber((this.state.value||0)+i*e);return this.props.snap&&(o=Math.round(o/i)*i),this._isStrict=n,o!==this.state.value&&(this.setState({value:o,stringValue:o+""},r),!0)}},{key:"_onKeyDown",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];t[0].persist(),this._invokeEventCallback.apply(this,["onKeyDown"].concat(t));var n=t[0];if(!n.isDefaultPrevented())if(38===n.keyCode)n.preventDefault(),this._step(n.ctrlKey||n.metaKey?.1:n.shiftKey?10:1);else if(40===n.keyCode)n.preventDefault(),this._step(n.ctrlKey||n.metaKey?-.1:n.shiftKey?-10:-1);else{var i=this.refsInput.value,o=i.length;8===n.keyCode?this.refsInput.selectionStart==this.refsInput.selectionEnd&&this.refsInput.selectionEnd>0&&i.length&&"."===i.charAt(this.refsInput.selectionEnd-1)&&(n.preventDefault(),this.refsInput.selectionStart=this.refsInput.selectionEnd=this.refsInput.selectionEnd-1):46===n.keyCode&&this.refsInput.selectionStart==this.refsInput.selectionEnd&&this.refsInput.selectionEnd<o+1&&i.length&&"."===i.charAt(this.refsInput.selectionEnd)&&(n.preventDefault(),this.refsInput.selectionStart=this.refsInput.selectionEnd=this.refsInput.selectionEnd+1)}}},{key:"stop",value:function(){this._timer&&clearTimeout(this._timer)}},{key:"increase",value:function(){var e=this,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments[1];this.stop(),this._step(1,n);var i=+p(this.props,"max",t.defaultProps.max,this);(isNaN(this.state.value)||+this.state.value<i)&&(this._timer=setTimeout(function(){e.increase(!0)},r?t.SPEED:t.DELAY))}},{key:"decrease",value:function(){var e=this,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments[1];this.stop(),this._step(-1,n);var i=+p(this.props,"min",t.defaultProps.min,this);(isNaN(this.state.value)||+this.state.value>i)&&(this._timer=setTimeout(function(){e.decrease(!0)},r?t.SPEED:t.DELAY))}},{key:"onMouseDown",value:function(e,t){"down"==e?this.decrease(!1,t):"up"==e&&this.increase(!1,t)}},{key:"onTouchStart",value:function(e,t){t.preventDefault(),"down"==e?this.decrease():"up"==e&&this.increase()}},{key:"onTouchEnd",value:function(e){e.preventDefault(),this.stop()}},{key:"_invokeEventCallback",value:function(e){if("function"==typeof this.props[e]){for(var t,r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];(t=this.props[e]).call.apply(t,[null].concat(n))}}},{key:"render",value:function(){var e=this,r=this.props,i=this.state,o={},s=this.props,l=(s.step,s.min,s.max,s.precision,s.parse,s.format,s.mobile),p=(s.snap,s.componentClass),f=(s.value,s.type,s.style),d=(s.defaultValue,s.onInvalid,s.onValid,s.strict,s.noStyle),m=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(s,["step","min","max","precision","parse","format","mobile","snap","componentClass","value","type","style","defaultValue","onInvalid","onValid","strict","noStyle"]);for(var v in d=d||!1===f,t.style)o[v]=n({},t.style[v],f&&f[v]||{});var g=r.className&&/\bform-control\b/.test(r.className);"auto"==l&&(l=u&&"ontouchstart"in document),"function"==typeof l&&(l=l.call(this)),l=!!l;var y={wrap:{style:d?null:o.wrap,className:"react-numeric-input",ref:function(t){null!=t&&void 0!=t&&(e.refsWrapper=t)},onMouseUp:void 0,onMouseLeave:void 0},input:n({ref:function(t){null!=t&&void 0!=t&&(e.refsInput=t)},type:"text",style:d?null:n({},o.input,g?{}:o["input:not(.form-control)"],this._inputFocus?o["input:focus"]:{})},m),btnUp:{onMouseEnter:void 0,onMouseDown:void 0,onMouseUp:void 0,onMouseLeave:void 0,onTouchStart:void 0,onTouchEnd:void 0,style:d?null:n({},o.btn,o.btnUp,r.disabled||r.readOnly?o["btn:disabled"]:i.btnUpActive?o["btn:active"]:i.btnUpHover?o["btn:hover"]:{})},btnDown:{onMouseEnter:void 0,onMouseDown:void 0,onMouseUp:void 0,onMouseLeave:void 0,onTouchStart:void 0,onTouchEnd:void 0,style:d?null:n({},o.btn,o.btnDown,r.disabled||r.readOnly?o["btn:disabled"]:i.btnDownActive?o["btn:active"]:i.btnDownHover?o["btn:hover"]:{})}},b=String(i.stringValue||(i.value||0===i.value?i.value:"")||""),x=!this._isStrict&&(this._inputFocus||!this._isMounted);x&&h.test(b)?y.input.value=b:x&&b&&!c.test(b)?y.input.value=b:i.value||0===i.value?y.input.value=this._format(i.value):y.input.value="",g&&!d&&n(y.wrap.style,o["wrap.hasFormControl"]),l&&!d&&(n(y.input.style,o["input.mobile"]),n(y.btnUp.style,o["btnUp.mobile"]),n(y.btnDown.style,o["btnDown.mobile"])),r.disabled||r.readOnly?!d&&r.disabled&&n(y.input.style,o["input:disabled"]):(n(y.wrap,{onMouseUp:this.stop,onMouseLeave:this.stop}),n(y.btnUp,{onTouchStart:this.onTouchStart.bind(this,"up"),onTouchEnd:this.onTouchEnd,onMouseEnter:function(){e.setState({btnUpHover:!0})},onMouseLeave:function(){e.stop(),e.setState({btnUpHover:!1,btnUpActive:!1})},onMouseUp:function(){e.setState({btnUpHover:!0,btnUpActive:!1})},onMouseDown:function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];r[0].preventDefault(),r[0].persist(),e._inputFocus=!0,e.setState({btnUpHover:!0,btnUpActive:!0},function(){e._invokeEventCallback.apply(e,["onFocus"].concat(r)),e.onMouseDown("up")})}}),n(y.btnDown,{onTouchStart:this.onTouchStart.bind(this,"down"),onTouchEnd:this.onTouchEnd,onMouseEnter:function(){e.setState({btnDownHover:!0})},onMouseLeave:function(){e.stop(),e.setState({btnDownHover:!1,btnDownActive:!1})},onMouseUp:function(){e.setState({btnDownHover:!0,btnDownActive:!1})},onMouseDown:function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];r[0].preventDefault(),r[0].persist(),e._inputFocus=!0,e.setState({btnDownHover:!0,btnDownActive:!0},function(){e._invokeEventCallback.apply(e,["onFocus"].concat(r)),e.onMouseDown("down")})}}),n(y.input,{onChange:function(t){var r=t.target.value,n=e._parse(r);isNaN(n)&&(n=null),e.setState({value:e._isStrict?e._toNumber(n):n,stringValue:r})},onKeyDown:this._onKeyDown.bind(this),onInput:function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];e.saveSelection(),e._invokeEventCallback.apply(e,["onInput"].concat(r))},onSelect:function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];e.saveSelection(),e._invokeEventCallback.apply(e,["onSelect"].concat(r))},onFocus:function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];r[0].persist(),e._inputFocus=!0;var i=e._parse(r[0].target.value);e.setState({value:i,stringValue:i||0===i?i+"":""},function(){e._invokeEventCallback.apply(e,["onFocus"].concat(r))})},onBlur:function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=e._isStrict;e._isStrict=!0,r[0].persist(),e._inputFocus=!1;var o=e._parse(r[0].target.value);e.setState({value:o},function(){e._invokeEventCallback.apply(e,["onBlur"].concat(r)),e._isStrict=i})}}));var w=p||"input";return l?a.default.createElement("span",y.wrap,a.default.createElement(w,y.input),a.default.createElement("b",y.btnUp,a.default.createElement("i",{style:d?null:o.minus}),a.default.createElement("i",{style:d?null:o.plus})),a.default.createElement("b",y.btnDown,a.default.createElement("i",{style:d?null:o.minus}))):a.default.createElement("span",y.wrap,a.default.createElement(w,y.input),a.default.createElement("b",y.btnUp,a.default.createElement("i",{style:d?null:o.arrowUp})),a.default.createElement("b",y.btnDown,a.default.createElement("i",{style:d?null:o.arrowDown})))}}]),t}();f.propTypes={step:s.default.oneOfType([s.default.number,s.default.func]),min:s.default.oneOfType([s.default.number,s.default.func]),max:s.default.oneOfType([s.default.number,s.default.func]),precision:s.default.oneOfType([s.default.number,s.default.func]),maxLength:s.default.number,parse:s.default.func,format:s.default.func,className:s.default.string,disabled:s.default.bool,readOnly:s.default.bool,required:s.default.bool,snap:s.default.bool,noValidate:s.default.oneOfType([s.default.bool,s.default.string]),style:s.default.oneOfType([s.default.object,s.default.bool]),noStyle:s.default.bool,type:s.default.string,pattern:s.default.string,onFocus:s.default.func,onBlur:s.default.func,onKeyDown:s.default.func,onChange:s.default.func,onInvalid:s.default.func,onValid:s.default.func,onInput:s.default.func,onSelect:s.default.func,size:s.default.oneOfType([s.default.number,s.default.string]),value:s.default.oneOfType([s.default.number,s.default.string]),defaultValue:s.default.oneOfType([s.default.number,s.default.string]),strict:s.default.bool,componentClass:s.default.string,mobile:function(e,t){var r=e[t];if(!0!==r&&!1!==r&&"auto"!==r&&"function"!=typeof r)return new Error('The "mobile" prop must be true, false, "auto" or a function')}},f.defaultProps={step:1,min:Number.MIN_SAFE_INTEGER||-9007199254740991,max:Number.MAX_SAFE_INTEGER||9007199254740991,precision:null,parse:null,format:null,mobile:"auto",strict:!1,componentClass:"input",style:{}},f.style={wrap:{position:"relative",display:"inline-block"},"wrap.hasFormControl":{display:"block"},arrowUp:{position:"absolute",top:"50%",left:"50%",width:0,height:0,borderWidth:"0 0.6ex 0.6ex 0.6ex",borderColor:"transparent transparent rgba(0, 0, 0, 0.7)",borderStyle:"solid",margin:"-0.3ex 0 0 -0.56ex"},arrowDown:{position:"absolute",top:"50%",left:"50%",width:0,height:0,borderWidth:"0.6ex 0.6ex 0 0.6ex",borderColor:"rgba(0, 0, 0, 0.7) transparent transparent",borderStyle:"solid",margin:"-0.3ex 0 0 -0.56ex"},plus:{position:"absolute",top:"50%",left:"50%",width:2,height:10,background:"rgba(0,0,0,.7)",margin:"-5px 0 0 -1px"},minus:{position:"absolute",top:"50%",left:"50%",width:10,height:2,background:"rgba(0,0,0,.7)",margin:"-1px 0 0 -5px"},btn:{position:"absolute",right:2,width:"2.26ex",borderColor:"rgba(0,0,0,.1)",borderStyle:"solid",textAlign:"center",cursor:"default",transition:"all 0.1s",background:"rgba(0,0,0,.1)",boxShadow:"-1px -1px 3px rgba(0,0,0,.1) inset,1px 1px 3px rgba(255,255,255,.7) inset"},btnUp:{top:2,bottom:"50%",borderRadius:"2px 2px 0 0",borderWidth:"1px 1px 0 1px"},"btnUp.mobile":{width:"3.3ex",bottom:2,boxShadow:"none",borderRadius:2,borderWidth:1},btnDown:{top:"50%",bottom:2,borderRadius:"0 0 2px 2px",borderWidth:"0 1px 1px 1px"},"btnDown.mobile":{width:"3.3ex",bottom:2,left:2,top:2,right:"auto",boxShadow:"none",borderRadius:2,borderWidth:1},"btn:hover":{background:"rgba(0,0,0,.2)"},"btn:active":{background:"rgba(0,0,0,.3)",boxShadow:"0 1px 3px rgba(0,0,0,.2) inset,-1px -1px 4px rgba(255,255,255,.5) inset"},"btn:disabled":{opacity:.5,boxShadow:"none",cursor:"not-allowed"},input:{paddingRight:"3ex",boxSizing:"border-box",fontSize:"inherit"},"input:not(.form-control)":{border:"1px solid #ccc",borderRadius:2,paddingLeft:4,display:"block",WebkitAppearance:"none",lineHeight:"normal"},"input.mobile":{paddingLeft:" 3.4ex",paddingRight:"3.4ex",textAlign:"center"},"input:focus":{},"input:disabled":{color:"rgba(0, 0, 0, 0.3)",textShadow:"0 1px 0 rgba(255, 255, 255, 0.8)"}},f.SPEED=50,f.DELAY=500,f.DIRECTION_UP="up",f.DIRECTION_DOWN="down",e.exports=f},function(e,t){e.exports=r(0)},function(e,t){e.exports=r(7)}])},function(e,t,r){e.exports=r(454)()},function(e,t,r){"use strict";e.exports=r(261)},function(e,t,r){"use strict";e.exports=function(){}},function(e,t,r){"use strict";t.__esModule=!0;t.addLeadingSlash=function(e){return"/"===e.charAt(0)?e:"/"+e},t.stripLeadingSlash=function(e){return"/"===e.charAt(0)?e.substr(1):e};var n=t.hasBasename=function(e,t){return new RegExp("^"+t+"(\\/|\\?|#|$)","i").test(e)};t.stripBasename=function(e,t){return n(e,t)?e.substr(t.length):e},t.stripTrailingSlash=function(e){return"/"===e.charAt(e.length-1)?e.slice(0,-1):e},t.parsePath=function(e){var t=e||"/",r="",n="",i=t.indexOf("#");-1!==i&&(n=t.substr(i),t=t.substr(0,i));var o=t.indexOf("?");return-1!==o&&(r=t.substr(o),t=t.substr(0,o)),{pathname:t,search:"?"===r?"":r,hash:"#"===n?"":n}},t.createPath=function(e){var t=e.pathname,r=e.search,n=e.hash,i=t||"/";return r&&"?"!==r&&(i+="?"===r.charAt(0)?r:"?"+r),n&&"#"!==n&&(i+="#"===n.charAt(0)?n:"#"+n),i}},function(e,t,r){"use strict";e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}}},function(e,t,r){"use strict";var n=r(39),i=r(271),o=r(273),a=r(274),s=r(275),l=r(165),u="undefined"!==typeof window&&window.btoa&&window.btoa.bind(window)||r(276);e.exports=function(e){return new Promise(function(t,c){var h=e.data,p=e.headers;n.isFormData(h)&&delete p["Content-Type"];var f=new XMLHttpRequest,d="onreadystatechange",m=!1;if("undefined"===typeof window||!window.XDomainRequest||"withCredentials"in f||s(e.url)||(f=new window.XDomainRequest,d="onload",m=!0,f.onprogress=function(){},f.ontimeout=function(){}),e.auth){var v=e.auth.username||"",g=e.auth.password||"";p.Authorization="Basic "+u(v+":"+g)}if(f.open(e.method.toUpperCase(),o(e.url,e.params,e.paramsSerializer),!0),f.timeout=e.timeout,f[d]=function(){if(f&&(4===f.readyState||m)&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in f?a(f.getAllResponseHeaders()):null,n={data:e.responseType&&"text"!==e.responseType?f.response:f.responseText,status:1223===f.status?204:f.status,statusText:1223===f.status?"No Content":f.statusText,headers:r,config:e,request:f};i(t,c,n),f=null}},f.onerror=function(){c(l("Network Error",e,null,f)),f=null},f.ontimeout=function(){c(l("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",f)),f=null},n.isStandardBrowserEnv()){var y=r(277),b=(e.withCredentials||s(e.url))&&e.xsrfCookieName?y.read(e.xsrfCookieName):void 0;b&&(p[e.xsrfHeaderName]=b)}if("setRequestHeader"in f&&n.forEach(p,function(e,t){"undefined"===typeof h&&"content-type"===t.toLowerCase()?delete p[t]:f.setRequestHeader(t,e)}),e.withCredentials&&(f.withCredentials=!0),e.responseType)try{f.responseType=e.responseType}catch(x){if("json"!==e.responseType)throw x}"function"===typeof e.onDownloadProgress&&f.addEventListener("progress",e.onDownloadProgress),"function"===typeof e.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){f&&(f.abort(),c(e),f=null)}),void 0===h&&(h=null),f.send(h)})}},function(e,t,r){"use strict";var n=r(272);e.exports=function(e,t,r,i,o){var a=new Error(e);return n(a,t,r,i,o)}},function(e,t,r){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,r){"use strict";function n(e){this.message=e}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,e.exports=n},function(e,t,r){"use strict";var n=r(30);function i(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}t.a=function(e){return function(t){return function(t){return function(r){if(r.type!==n.a)return t(r);var o=r.payload,a=o.method,s=o.args;e[a].apply(e,i(s))}}}}},function(e,t,r){var n=r(292),i=n.types;e.exports=function(e,t){t||(t={});var r,o=void 0===t.limit?25:t.limit;r=e,"[object RegExp]"==={}.toString.call(r)?e=e.source:"string"!==typeof e&&(e=String(e));try{e=n(e)}catch(s){return!1}var a=0;return function e(t,r){if(t.type===i.REPETITION){if(a++,++r>1)return!1;if(a>o)return!1}if(t.options)for(var n=0,s=t.options.length;n<s;n++){if(!e({stack:t.options[n]},r))return!1}var l=t.stack||t.value&&t.value.stack;if(!l)return!0;for(n=0;n<l.length;n++){if(!e(l[n],r))return!1}return!0}(e,0)}},function(e,t,r){var n=r(105),i=function(){return[{type:n.RANGE,from:48,to:57}]},o=function(){return[{type:n.CHAR,value:95},{type:n.RANGE,from:97,to:122},{type:n.RANGE,from:65,to:90}].concat(i())},a=function(){return[{type:n.CHAR,value:9},{type:n.CHAR,value:10},{type:n.CHAR,value:11},{type:n.CHAR,value:12},{type:n.CHAR,value:13},{type:n.CHAR,value:32},{type:n.CHAR,value:160},{type:n.CHAR,value:5760},{type:n.CHAR,value:6158},{type:n.CHAR,value:8192},{type:n.CHAR,value:8193},{type:n.CHAR,value:8194},{type:n.CHAR,value:8195},{type:n.CHAR,value:8196},{type:n.CHAR,value:8197},{type:n.CHAR,value:8198},{type:n.CHAR,value:8199},{type:n.CHAR,value:8200},{type:n.CHAR,value:8201},{type:n.CHAR,value:8202},{type:n.CHAR,value:8232},{type:n.CHAR,value:8233},{type:n.CHAR,value:8239},{type:n.CHAR,value:8287},{type:n.CHAR,value:12288},{type:n.CHAR,value:65279}]};t.words=function(){return{type:n.SET,set:o(),not:!1}},t.notWords=function(){return{type:n.SET,set:o(),not:!0}},t.ints=function(){return{type:n.SET,set:i(),not:!1}},t.notInts=function(){return{type:n.SET,set:i(),not:!0}},t.whitespace=function(){return{type:n.SET,set:a(),not:!1}},t.notWhitespace=function(){return{type:n.SET,set:a(),not:!0}},t.anyChar=function(){return{type:n.SET,set:[{type:n.CHAR,value:10},{type:n.CHAR,value:13},{type:n.CHAR,value:8232},{type:n.CHAR,value:8233}],not:!0}}},function(e,t,r){"use strict";var n=r(107);function i(e,t,r){return n.flatten(n.repeat(n.arrayify(e),t))}function o(e){return!0===e.escaped}function a(e,t){return"undefined"!==typeof e&&e.type===t}e.exports=function(e,t){e.compiler.set("bos",function(){this.output||(this.ast.queue=o(this.ast)?[this.ast.val]:[],this.ast.count=1)}).set("bracket",function(e){var t=e.close,r=e.escaped?"\\[":"[",i=e.negated,o=e.inner;"]-"===(o=o.replace(/\\(?=[\\\w]|$)/g,"\\\\"))&&(o="\\]\\-"),i&&-1===o.indexOf(".")&&(o+="."),i&&-1===o.indexOf("/")&&(o+="/");var a=r+i+o+t,s=e.parent.queue,l=n.arrayify(s.pop());s.push(n.join(l,a)),s.push.apply(s,[])}).set("brace",function(e){return e.queue=o(e)?[e.val]:[],e.count=1,this.mapVisit(e.nodes)}).set("brace.open",function(e){e.parent.open=e.val}).set("text",function(e){var r=e.parent.queue,s=e.escaped,l=[e.val];if(!1===e.optimize&&(t=n.extend({},t,{optimize:!1})),e.multiplier>1&&(e.parent.count*=e.multiplier),!0===t.quantifiers&&n.isQuantifier(e.val))s=!0;else if(e.val.length>1){if(a(e.parent,"brace")&&!o(e)){var u=n.expand(e.val,t);if(l=u.segs,u.isOptimized&&(e.parent.isOptimized=!0),!l.length){var c=u.val||e.val;!1!==t.unescape&&(c=(c=c.replace(/\\([,.])/g,"$1")).replace(/["'`]/g,"")),l=[c],s=!0}}}else","===e.val?t.expand?(e.parent.queue.push([""]),l=[""]):l=["|"]:s=!0;if(s&&a(e.parent,"brace")&&(e.parent.nodes.length<=4&&1===e.parent.count?e.parent.escaped=!0:e.parent.length<=3&&(e.parent.escaped=!0)),function(e){return Array.isArray(e.queue)&&e.queue.length}(e.parent)){var h=n.arrayify(r.pop());e.parent.count>1&&t.expand&&(h=i(h,e.parent.count),e.parent.count=1),r.push(n.join(n.flatten(h),l.shift())),r.push.apply(r,l)}else e.parent.queue=l}).set("brace.close",function(e){var r=e.parent.queue,s=e.parent.parent,l=s.queue.pop(),u=e.parent.open,c=e.val;u&&c&&function(e,t){return!!e.parent.isOptimized||a(e.parent,"brace")&&!o(e.parent)&&!0!==t.expand}(e,t)&&(u="(",c=")");var h=n.last(r);e.parent.count>1&&t.expand&&(h=i(r.pop(),e.parent.count),e.parent.count=1,r.push(h)),c&&"string"===typeof h&&1===h.length&&(u="",c=""),!function(e,t){return o(e.parent)||!1!==t.optimize}(e,t)&&!function(e,t){if(1===e.parent.queue.length)return!0;var r=e.parent.nodes;return 3===r.length&&a(r[0],"brace.open")&&!a(r[1],"text")&&a(r[2],"brace.close")}(e)||e.parent.hasEmpty||(r.push(n.join(u,r.pop()||"")),r=n.flatten(n.join(r,c))),"undefined"===typeof l?s.queue=[r]:s.queue.push(n.flatten(n.join(l,r)))}).set("eos",function(e){this.input||(!1!==t.optimize?this.output=n.last(n.flatten(this.ast.queue)):Array.isArray(n.last(this.ast.queue))?this.output=n.flatten(this.ast.queue.pop()):this.output=n.flatten(this.ast.queue),e.parent.count>1&&t.expand&&(this.output=i(this.output,e.parent.count)),this.output=n.arrayify(this.output),this.ast.queue=[])})}},function(e,t,r){"use strict";var n=r(305);function i(e,t,r,n){var o=e.indexOf(t,r);return"\\"===e.charAt(o-1)?i(e,t,o+1):o}function o(e,t){return!0===t.keepDoubleQuotes&&'"'===e||(!0===t.keepSingleQuotes&&"'"===e||t.keepQuotes)}function a(e,t,r){return"function"===typeof e.keepEscaping?e.keepEscaping(t,r):!0===e.keepEscaping||"\\"===t[r+1]}e.exports=function(e,t,r){if("string"!==typeof e)throw new TypeError("expected a string");"function"===typeof t&&(r=t,t=null),"string"===typeof t&&(t={sep:t});var s,l=n({sep:"."},t),u=l.quotes||['"',"'","`"];!0===l.brackets?s={"<":">","(":")","[":"]","{":"}"}:l.brackets&&(s=l.brackets);var c,h=[],p=[],f=[""],d=l.sep,m=e.length,v=-1;function g(){if(s&&p.length)return s[p[p.length-1]]}for(;++v<m;){var y=e[v],b=e[v+1],x={val:y,idx:v,arr:f,str:e};if(h.push(x),"\\"!==y){if(s&&s[y]){p.push(y);var w=g(),S=v+1;if(-1!==e.indexOf(w,S+1))for(;p.length&&S<m;){var M=e[++S];if("\\"!==M)if(-1===u.indexOf(M)){if(w=g(),p.length&&-1===e.indexOf(w,S+1))break;s[M]?p.push(M):w===M&&p.pop()}else S=i(e,M,S+1);else M++}if(-1===(c=S)){f[f.length-1]+=y;continue}y=e.slice(v,c+1),x.val=y,x.idx=v=c}if(-1!==u.indexOf(y)){if(-1===(c=i(e,y,v+1))){f[f.length-1]+=y;continue}y=!0===o(y,l)?e.slice(v,c+1):e.slice(v+1,c),x.val=y,x.idx=v=c}"function"===typeof r&&(r(x,h),y=x.val,v=x.idx),x.val!==d||!1===x.split?f[f.length-1]+=x.val:f.push("")}else x.val=!0===a(l,e,v)?y+b:b,x.escaped=!0,"function"===typeof r&&r(x),f[f.length-1]+=x.val,v++}return f}},function(e,t,r){"use strict";var n,i="";e.exports=function(e,t){if("string"!==typeof e)throw new TypeError("expected a string");if(1===t)return e;if(2===t)return e+e;var r=e.length*t;if(n!==e||"undefined"===typeof n)n=e,i="";else if(i.length>=r)return i.substr(0,r);for(;r>i.length&&t>1;)1&t&&(i+=e),t>>=1,e+=e;return i=(i+=e).substr(0,r)}},function(e,t,r){"use strict";var n=r(311),i=r(107);function o(e,t,r,n){t.orig=t.val;var o=this.prev(),a=i.last(o.nodes),s=!1;if(t.val.length>1){var l=t.val.charAt(0),u=t.val.slice(-1);s='"'===l&&'"'===u||"'"===l&&"'"===u||"`"===l&&"`"===u}if(s&&!1!==n.unescape&&(t.val=t.val.slice(1,t.val.length-1),t.escaped=!0),t.match){var c=t.match[1];c&&-1!==c.indexOf("}")||(c=t.match[0]);var h=c.replace(/\{/g,",").replace(/\}/g,"");t.multiplier*=h.length,t.val=""}"text"===a.type&&1===a.multiplier&&1===t.multiplier&&t.val?a.val+=t.val:o.push(t)}e.exports=function(e,t){e.parser.set("bos",function(){this.parsed||(this.ast=this.nodes[0]=new n(this.ast))}).set("escape",function(){var e=this.position(),r=this.match(/^(?:\\(.)|\$\{)/);if(r){var a=this.prev(),s=i.last(a.nodes),l=e(new n({type:"text",multiplier:1,val:r[0]}));if("\\\\"===l.val)return l;if("${"===l.val)for(var u,c=this.input,h=-1;u=c[++h];)if(this.consume(1),l.val+=u,"\\"!==u){if("}"===u)break}else l.val+=c[++h];return!1!==this.options.unescape&&(l.val=l.val.replace(/\\([{}])/g,"$1")),'"'===s.val&&'"'===this.input.charAt(0)?(s.val=l.val,void this.consume(1)):o.call(this,e,l,a,t)}}).set("bracket",function(){var e=this.isInside("brace"),t=this.position(),r=this.match(/^(?:\[([!^]?)([^\]]{2,}|\]-)(\]|[^*+?]+)|\[)/);if(r){var i=this.prev(),o=r[0],a=r[1]?"^":"",s=r[2]||"",l=r[3]||"";e&&"brace"===i.type&&(i.text=i.text||"",i.text+=o);var u=this.input.slice(0,2);if(""===s&&"\\]"===u){s+=u,this.consume(2);for(var c,h=this.input,p=-1;c=h[++p];){if(this.consume(1),"]"===c){l=c;break}s+=c}}return t(new n({type:"bracket",val:o,escaped:"]"!==l,negated:a,inner:s,close:l}))}}).set("multiplier",function(){var e=this.isInside("brace"),r=this.position(),i=this.match(/^\{((?:,|\{,+\})+)\}/);if(i){this.multiplier=!0;var a=this.prev(),s=i[0];e&&"brace"===a.type&&(a.text=a.text||"",a.text+=s);var l=r(new n({type:"text",multiplier:1,match:i,val:s}));return o.call(this,r,l,a,t)}}).set("brace.open",function(){var e=this.position(),t=this.match(/^\{(?!(?:[^\\}]?|,+)\})/);if(t){var r,o=this.prev(),a=i.last(o.nodes);a&&a.val&&("!"===(r=a.val.slice(-1))||"@"===r||"*"===r||"?"===r||"+"===r)&&(a.optimize=!1);var s=e(new n({type:"brace.open",val:t[0]})),l=e(new n({type:"brace",nodes:[]}));l.push(s),o.push(l),this.push("brace",l)}}).set("brace.close",function(){var e=this.position(),t=this.match(/^\}/);if(t&&t[0]){var r=this.pop("brace"),o=e(new n({type:"brace.close",val:t[0]}));if(!this.isType(r,"brace")){if(this.options.strict)throw new Error('missing opening "{"');return o.type="text",o.multiplier=0,o.escaped=!0,o}var a=this.prev(),s=i.last(a.nodes);if(s.text)if(")"===i.last(s.nodes).val&&/[!@*?+]\(/.test(s.text)){var l=s.nodes[0],u=s.nodes[1];"brace.open"===l.type&&u&&"text"===u.type&&(u.optimize=!1)}if(r.nodes.length>2){var c=r.nodes[1];"text"===c.type&&","===c.val&&(r.nodes.splice(1,1),r.nodes.push(c))}r.push(o)}}).set("boundary",function(){var e=this.position(),t=this.match(/^[$^](?!\{)/);if(t)return e(new n({type:"text",val:t[0]}))}).set("nobrace",function(){var e=this.isInside("brace"),t=this.position(),r=this.match(/^\{[^,]?\}/);if(r){var i=this.prev(),o=r[0];return e&&"brace"===i.type&&(i.text=i.text||"",i.text+=o),t(new n({type:"text",multiplier:0,val:o}))}}).set("text",function(){var e=this.isInside("brace"),r=this.position(),i=this.match(/^((?!\\)[^${}[\]])+/);if(i){var a=this.prev(),s=i[0];e&&"brace"===a.type&&(a.text=a.text||"",a.text+=s);var l=r(new n({type:"text",multiplier:1,val:s}));return o.call(this,r,l,a,t)}})}},function(e,t,r){"use strict";var n=r(35);e.exports=function(e,t,r,i){if(!n(e)&&"function"!==typeof e)throw new Error("object-visit expects `thisArg` to be an object.");if("string"!==typeof t)throw new Error("object-visit expects `method` name to be a string");if("function"!==typeof e[t])return e;var o=[].slice.call(arguments,3);for(var a in r=r||{}){var s=[a,r[a]].concat(o);e[t].apply(e,s)}return e}},function(e,t,r){"use strict";var n=r(108);e.exports=function(e){return"arguments"!==n(e)&&(e=arguments),function e(t){var r=t.length;var i=-1;var o=[];for(;++i<r;){var a=t[i];"arguments"===n(a)||Array.isArray(a)?o.push.apply(o,e(a)):"string"===typeof a&&o.push(a)}return o}(e).join(".")}},function(e,t,r){"use strict";e.exports=function(e){if(!Array.isArray(e))throw new TypeError("arr-union expects the first argument to be an array.");for(var t=arguments.length,r=0;++r<t;){var n=arguments[r];if(n){Array.isArray(n)||(n=[n]);for(var i=0;i<n.length;i++){var o=n[i];e.indexOf(o)>=0||e.push(o)}}}return e}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){"use strict";function n(e){return e&&"object"===typeof e&&!Array.isArray(e)}function i(e,t,r){Object.defineProperty(e,t,{configurable:!0,writable:!0,value:r})}e.exports=function e(t,r){if(!n(t)&&"function"!==typeof t)throw new TypeError("expected an object or function");var o=n(r)?r:{},a="string"===typeof o.prop?o.prop:"fns";function s(e,r,n){var i=1;if("string"===typeof e||Array.isArray(e)?(r=function(e,t){return function r(){return this.type===e?t.apply(this,arguments):r}}(e,r),i++):(n=r,r=e),"function"!==typeof r)throw new TypeError("expected a function");var s=this||t,l=s[a],u=[].slice.call(arguments,i);u.unshift(s),"function"===typeof o.hook&&o.hook.apply(s,u);var c=r.apply(s,u);return"function"===typeof c&&-1===l.indexOf(c)&&l.push(c),s}return Array.isArray(t[a])||i(t,a,[]),i(t,"use",s),i(t,"run",function(r){if(n(r)){r.use&&r.run||(i(r,a,r[a]||[]),i(r,"use",s)),r[a]&&-1!==r[a].indexOf(e)||r.use(e);for(var o=(this||t)[a],l=o.length,u=-1;++u<l;)r.use(o[u]);return r}}),t}},function(e,t,r){var n=r(181),i=r(97),o=r(182).ArraySet,a=r(348).MappingList;function s(e){e||(e={}),this._file=i.getArg(e,"file",null),this._sourceRoot=i.getArg(e,"sourceRoot",null),this._skipValidation=i.getArg(e,"skipValidation",!1),this._sources=new o,this._names=new o,this._mappings=new a,this._sourcesContents=null}s.prototype._version=3,s.fromSourceMap=function(e){var t=e.sourceRoot,r=new s({file:e.file,sourceRoot:t});return e.eachMapping(function(e){var n={generated:{line:e.generatedLine,column:e.generatedColumn}};null!=e.source&&(n.source=e.source,null!=t&&(n.source=i.relative(t,n.source)),n.original={line:e.originalLine,column:e.originalColumn},null!=e.name&&(n.name=e.name)),r.addMapping(n)}),e.sources.forEach(function(t){var n=e.sourceContentFor(t);null!=n&&r.setSourceContent(t,n)}),r},s.prototype.addMapping=function(e){var t=i.getArg(e,"generated"),r=i.getArg(e,"original",null),n=i.getArg(e,"source",null),o=i.getArg(e,"name",null);this._skipValidation||this._validateMapping(t,r,n,o),null!=n&&(n=String(n),this._sources.has(n)||this._sources.add(n)),null!=o&&(o=String(o),this._names.has(o)||this._names.add(o)),this._mappings.add({generatedLine:t.line,generatedColumn:t.column,originalLine:null!=r&&r.line,originalColumn:null!=r&&r.column,source:n,name:o})},s.prototype.setSourceContent=function(e,t){var r=e;null!=this._sourceRoot&&(r=i.relative(this._sourceRoot,r)),null!=t?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[i.toSetString(r)]=t):this._sourcesContents&&(delete this._sourcesContents[i.toSetString(r)],0===Object.keys(this._sourcesContents).length&&(this._sourcesContents=null))},s.prototype.applySourceMap=function(e,t,r){var n=t;if(null==t){if(null==e.file)throw new Error('SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map\'s "file" property. Both were omitted.');n=e.file}var a=this._sourceRoot;null!=a&&(n=i.relative(a,n));var s=new o,l=new o;this._mappings.unsortedForEach(function(t){if(t.source===n&&null!=t.originalLine){var o=e.originalPositionFor({line:t.originalLine,column:t.originalColumn});null!=o.source&&(t.source=o.source,null!=r&&(t.source=i.join(r,t.source)),null!=a&&(t.source=i.relative(a,t.source)),t.originalLine=o.line,t.originalColumn=o.column,null!=o.name&&(t.name=o.name))}var u=t.source;null==u||s.has(u)||s.add(u);var c=t.name;null==c||l.has(c)||l.add(c)},this),this._sources=s,this._names=l,e.sources.forEach(function(t){var n=e.sourceContentFor(t);null!=n&&(null!=r&&(t=i.join(r,t)),null!=a&&(t=i.relative(a,t)),this.setSourceContent(t,n))},this)},s.prototype._validateMapping=function(e,t,r,n){if(t&&"number"!==typeof t.line&&"number"!==typeof t.column)throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if((!(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0)||t||r||n)&&!(e&&"line"in e&&"column"in e&&t&&"line"in t&&"column"in t&&e.line>0&&e.column>=0&&t.line>0&&t.column>=0&&r))throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:r,original:t,name:n}))},s.prototype._serializeMappings=function(){for(var e,t,r,o,a=0,s=1,l=0,u=0,c=0,h=0,p="",f=this._mappings.toArray(),d=0,m=f.length;d<m;d++){if(e="",(t=f[d]).generatedLine!==s)for(a=0;t.generatedLine!==s;)e+=";",s++;else if(d>0){if(!i.compareByGeneratedPositionsInflated(t,f[d-1]))continue;e+=","}e+=n.encode(t.generatedColumn-a),a=t.generatedColumn,null!=t.source&&(o=this._sources.indexOf(t.source),e+=n.encode(o-h),h=o,e+=n.encode(t.originalLine-1-u),u=t.originalLine-1,e+=n.encode(t.originalColumn-l),l=t.originalColumn,null!=t.name&&(r=this._names.indexOf(t.name),e+=n.encode(r-c),c=r)),p+=e}return p},s.prototype._generateSourcesContent=function(e,t){return e.map(function(e){if(!this._sourcesContents)return null;null!=t&&(e=i.relative(t,e));var r=i.toSetString(e);return Object.prototype.hasOwnProperty.call(this._sourcesContents,r)?this._sourcesContents[r]:null},this)},s.prototype.toJSON=function(){var e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return null!=this._file&&(e.file=this._file),null!=this._sourceRoot&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e},s.prototype.toString=function(){return JSON.stringify(this.toJSON())},t.SourceMapGenerator=s},function(e,t,r){var n=r(347);t.encode=function(e){var t,r="",i=function(e){return e<0?1+(-e<<1):0+(e<<1)}(e);do{t=31&i,(i>>>=5)>0&&(t|=32),r+=n.encode(t)}while(i>0);return r},t.decode=function(e,t,r){var i,o,a=e.length,s=0,l=0;do{if(t>=a)throw new Error("Expected more digits in base 64 VLQ value.");if(-1===(o=n.decode(e.charCodeAt(t++))))throw new Error("Invalid base64 digit: "+e.charAt(t-1));i=!!(32&o),s+=(o&=31)<<l,l+=5}while(i);r.value=function(e){var t=e>>1;return 1===(1&e)?-t:t}(s),r.rest=t}},function(e,t,r){var n=r(97),i=Object.prototype.hasOwnProperty,o="undefined"!==typeof Map;function a(){this._array=[],this._set=o?new Map:Object.create(null)}a.fromArray=function(e,t){for(var r=new a,n=0,i=e.length;n<i;n++)r.add(e[n],t);return r},a.prototype.size=function(){return o?this._set.size:Object.getOwnPropertyNames(this._set).length},a.prototype.add=function(e,t){var r=o?e:n.toSetString(e),a=o?this.has(e):i.call(this._set,r),s=this._array.length;a&&!t||this._array.push(e),a||(o?this._set.set(e,s):this._set[r]=s)},a.prototype.has=function(e){if(o)return this._set.has(e);var t=n.toSetString(e);return i.call(this._set,t)},a.prototype.indexOf=function(e){if(o){var t=this._set.get(e);if(t>=0)return t}else{var r=n.toSetString(e);if(i.call(this._set,r))return this._set[r]}throw new Error('"'+e+'" is not in the set.')},a.prototype.at=function(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)},a.prototype.toArray=function(){return this._array.slice()},t.ArraySet=a},function(e,t,r){"use strict";var n=Object.prototype.hasOwnProperty;function i(e){this.__data__=e||{}}e.exports=i,i.prototype.set=function(e,t){return"__proto__"!==e&&(this.__data__[e]=t),this},i.prototype.get=function(e){return"__proto__"===e?void 0:this.__data__[e]},i.prototype.has=function(e){return"__proto__"!==e&&n.call(this.__data__,e)},i.prototype.del=function(e){return this.has(e)&&delete this.__data__[e]}},function(e,t,r){"use strict";var n=r(362),i=r(93);function o(e,t){for(var r in t)u(t,r)&&(e[r]=t[r])}function a(e){return e&&"string"===typeof e}function s(e){var t={};for(var r in e)t[r]=e[r];return t}function l(e){return e&&"object"===typeof e||n(e)}function u(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=Object.assign||function(e){if(null===e||"undefined"===typeof e)throw new TypeError("Cannot convert undefined or null to object");l(e)||(e={});for(var t=1;t<arguments.length;t++){var r=arguments[t];a(r)&&(r=s(r)),l(r)&&(o(e,r),i(e,r))}return e}},function(e,t,r){"use strict";var n=r(59),i=r(60),o=r(186),a=r(365),s=r(366),l=r(367),u=r(368);function c(e,t,r){t=u.arrayify(t),e=u.arrayify(e);var n=t.length;if(0===e.length||0===n)return[];if(1===n)return c.match(e,t[0],r);for(var i=!1,o=[],a=[],s=-1;++s<n;){var l=t[s];"string"===typeof l&&33===l.charCodeAt(0)?(o.push.apply(o,c.match(e,l.slice(1),r)),i=!0):a.push.apply(a,c.match(e,l,r))}if(i&&0===a.length)if(r&&!1===r.unixify)a=e.slice();else for(var h=u.unixify(r),p=0;p<e.length;p++)a.push(h(e[p]));var f=u.diff(a,o);return r&&!1===r.nodupes?f:u.unique(f)}function h(e,t,r,n){var i=u.createKey(e+"="+t,r);if(r&&!1===r.cache)return n(t,r);if(l.has(e,i))return l.get(e,i);var o=n(t,r);return l.set(e,i,o),o}c.match=function(e,t,r){if(Array.isArray(t))throw new TypeError("expected pattern to be a string");for(var n=u.unixify(r),i=h("match",t,r,c.matcher),o=[],a=(e=u.arrayify(e)).length,s=-1;++s<a;){var l=e[s];(l===t||i(l))&&o.push(u.value(l,n,r))}if("undefined"===typeof r)return u.unique(o);if(0===o.length){if(!0===r.failglob)throw new Error('no matches found for "'+t+'"');if(!0===r.nonull||!0===r.nullglob)return[r.unescape?u.unescape(t):t]}return r.ignore&&(o=c.not(o,r.ignore,r)),!1!==r.nodupes?u.unique(o):o},c.isMatch=function(e,t,r){if("string"!==typeof e)throw new TypeError('expected a string: "'+n.inspect(e)+'"');return!u.isEmptyString(e)&&!u.isEmptyString(t)&&(!!u.equalsPattern(r)(e)||h("isMatch",t,r,c.matcher)(e))},c.some=function(e,t,r){"string"===typeof e&&(e=[e]);for(var n=0;n<e.length;n++)if(1===c(e[n],t,r).length)return!0;return!1},c.every=function(e,t,r){"string"===typeof e&&(e=[e]);for(var n=0;n<e.length;n++)if(1!==c(e[n],t,r).length)return!1;return!0},c.any=function(e,t,r){if("string"!==typeof e)throw new TypeError('expected a string: "'+n.inspect(e)+'"');if(u.isEmptyString(e)||u.isEmptyString(t))return!1;"string"===typeof t&&(t=[t]);for(var i=0;i<t.length;i++)if(c.isMatch(e,t[i],r))return!0;return!1},c.all=function(e,t,r){if("string"!==typeof e)throw new TypeError('expected a string: "'+n.inspect(e)+'"');"string"===typeof t&&(t=[t]);for(var i=0;i<t.length;i++)if(!c.isMatch(e,t[i],r))return!1;return!0},c.not=function(e,t,r){var n=o({},r),i=n.ignore;delete n.ignore,e=u.arrayify(e);var a=u.diff(e,c(e,t,n));return i&&(a=u.diff(a,c(e,i))),!1!==n.nodupes?u.unique(a):a},c.contains=function(e,t,r){if("string"!==typeof e)throw new TypeError('expected a string: "'+n.inspect(e)+'"');if("string"===typeof t){if(u.isEmptyString(e)||u.isEmptyString(t))return!1;if(u.equalsPattern(t,r)(e))return!0;if(u.containsPattern(t,r)(e))return!0}var i=o({},r,{contains:!0});return c.any(e,t,i)},c.matchBase=function(e,t){return!(e&&-1!==e.indexOf("/")||!t)&&(!0===t.basename||!0===t.matchBase)},c.matchKeys=function(e,t,r){if(!u.isObject(e))throw new TypeError("expected the first argument to be an object");var n=c(Object.keys(e),t,r);return u.pick(e,n)},c.matcher=function e(t,r){if(u.isEmptyString(t))return function(){return!1};if(Array.isArray(t))return function(e,t,r){var n;return h("compose",String(e),t,function(){return function(i){if(!n){n=[];for(var o=0;o<e.length;o++)n.push(r(e[o],t))}for(var a=n.length;a--;)if(!0===n[a](i))return!0;return!1}})}(t,r,e);if(t instanceof RegExp)return i(t);if(!u.isString(t))throw new TypeError("expected pattern to be an array, string or regex");if(!u.hasSpecialChars(t))return r&&!0===r.nocase&&(t=t.toLowerCase()),u.matchPath(t,r);var n=c.makeRe(t,r);if(c.matchBase(t,r))return u.matchBasename(n,r);function i(e){var t=u.equalsPattern(r),n=u.unixify(r);return function(r){return!!t(r)||!!e.test(n(r))}}var o=i(n);return u.define(o,"result",n.result),o},c.capture=function(e,t,r){var n=c.makeRe(e,o({capture:!0},r)),i=u.unixify(r);return h("capture",e,r,function(){return function(e){var t=n.exec(i(e));return t?t.slice(1):null}})(t)},c.makeRe=function(e,t){if(e instanceof RegExp)return e;if("string"!==typeof e)throw new TypeError("expected pattern to be a string");if(e.length>65536)throw new Error("expected pattern to be less than 65536 characters");return h("makeRe",e,t,function(){var r=u.extend({wrap:!1},t),n=c.create(e,r),o=i(n.output,r);return u.define(o,"result",n),o})},c.create=function(e,t){if("string"!==typeof e)throw new TypeError("expected a string");return h("create",e,t,function(){return c.compile(c.parse(e,t),t)})},c.parse=function(e,t){if("string"!==typeof e)throw new TypeError("expected a string");return h("parse",e,t,function(){var r=u.instantiate(null,t);s(r,t);var n=r.parse(e,t);return u.define(n,"snapdragon",r),n.input=e,n})},c.compile=function(e,t){return"string"===typeof e&&(e=c.parse(e,t)),h("compile",e.input,t,function(){var r=u.instantiate(e,t);return a(r,t),r.compile(e,t)})},c.clearCache=function(){c.cache.__data__={}},c.compilers=a,c.parsers=s,c.cache=l,e.exports=c},function(e,t,r){"use strict";var n=r(364),i=r(93);function o(e,t){for(var r in t)u(t,r)&&(e[r]=t[r])}function a(e){return e&&"string"===typeof e}function s(e){var t={};for(var r in e)t[r]=e[r];return t}function l(e){return e&&"object"===typeof e||n(e)}function u(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=Object.assign||function(e){if(null===e||"undefined"===typeof e)throw new TypeError("Cannot convert undefined or null to object");l(e)||(e={});for(var t=1;t<arguments.length;t++){var r=arguments[t];a(r)&&(r=s(r)),l(r)&&(o(e,r),i(e,r))}return e}},function(e,t,r){"use strict";function n(e,t){if(!Array.isArray(t))return e.slice();for(var r=t.length,n=e.length,i=-1,o=[];++i<n;){for(var a=e[i],s=!1,l=0;l<r;l++){if(a===t[l]){s=!0;break}}!1===s&&o.push(a)}return o}e.exports=function(e){for(var t=arguments.length,r=0;++r<t;)e=n(e,arguments[r]);return e}},function(e,t,r){"use strict";var n=r(35);e.exports=function(e,t){if(!n(e)&&"function"!==typeof e)return{};var r={};if("string"===typeof t)return t in e&&(r[t]=e[t]),r;for(var i=t.length,o=-1;++o<i;){var a=t[o];a in e&&(r[a]=e[a])}return r}},function(e,t,r){"use strict";var n=r(49),i=r(95),o=r(60),a=r(190),s=r(192),l=r(376),u=r(194);function c(e,t){return c.create(e,t).output}c.match=function(e,t,r){if("string"!==typeof t)throw new TypeError("expected pattern to be a string");e=u.arrayify(e);for(var n=c.matcher(t,r),o=e.length,a=-1,s=[];++a<o;){var l=e[a];n(l)&&s.push(l)}if("undefined"===typeof r)return i(s);if(0===s.length){if(!0===r.failglob)throw new Error('no matches found for "'+t+'"');if(!0===r.nonull||!0===r.nullglob)return[t.split("\\").join("")]}return!1!==r.nodupes?i(s):s},c.isMatch=function(e,t,r){if("string"!==typeof t)throw new TypeError("expected pattern to be a string");if("string"!==typeof e)throw new TypeError("expected a string");return t===e||(""===t||" "===t||"."===t?t===e:u.memoize("isMatch",t,r,c.matcher)(e))},c.contains=function(e,t,r){if("string"!==typeof e)throw new TypeError("expected a string");if(""===t||" "===t||"."===t)return t===e;var i=n({},r,{contains:!0});return i.strictClose=!1,i.strictOpen=!1,c.isMatch(e,t,i)},c.matcher=function(e,t){if("string"!==typeof e)throw new TypeError("expected pattern to be a string");return u.memoize("matcher",e,t,function(){var r=c.makeRe(e,t);return function(e){return r.test(e)}})},c.create=function(e,t){if("string"!==typeof e)throw new TypeError("expected pattern to be a string");return u.memoize("create",e,t,function(){var r=new l(t),n=r.parse(e,t);return r.compile(n,t)})},c.capture=function(e,t,r){var i=c.makeRe(e,n({capture:!0},r));return u.memoize("capture",e,r,function(){return function(e){var t=i.exec(e);return t?t.slice(1):null}})(t)},c.makeRe=function(e,t){if(e instanceof RegExp)return e;if("string"!==typeof e)throw new TypeError("expected pattern to be a string");if(e.length>65536)throw new Error("expected pattern to be less than 65536 characters");var r=u.memoize("makeRe",e,t,function(){var r=n({strictErrors:!1},t);!0===r.strictErrors&&(r.strict=!0);var i=c.create(e,r);return o(i.output,r)});if(r.source.length>65536)throw new SyntaxError("potentially malicious regex detected");return r},c.cache=u.cache,c.clearCache=function(){c.cache.__data__={}},c.Extglob=l,c.compilers=a,c.parsers=s,e.exports=c},function(e,t,r){"use strict";var n=r(191);e.exports=function(e){function t(){return"function"===typeof e.options.star?e.options.star.apply(this,arguments):"string"===typeof e.options.star?e.options.star:".*?"}e.use(n.compilers),e.compiler.set("escape",function(e){return this.emit(e.val,e)}).set("dot",function(e){return this.emit("\\"+e.val,e)}).set("qmark",function(e){var t="[^\\\\/.]",r=this.prev();if("("===e.parsed.slice(-1)){var n=e.rest.charAt(0);return"!"!==n&&"="!==n&&":"!==n?this.emit(t,e):this.emit(e.val,e)}return"text"===r.type&&r.val?this.emit(t,e):(e.val.length>1&&(t+="{"+e.val.length+"}"),this.emit(t,e))}).set("plus",function(e){var t=e.parsed.slice(-1);if("]"===t||")"===t)return this.emit(e.val,e);var r=this.output.slice(-1);return!this.output||/[?*+]/.test(r)&&"bracket"!==e.parent.type?this.emit("\\+",e):/\w/.test(r)&&!e.inside?this.emit("+\\+?",e):this.emit("+",e)}).set("star",function(e){var r=this.prev(),n="text"!==r.type&&"escape"!==r.type?"(?!\\.)":"";return this.emit(n+t.call(this,e),e)}).set("paren",function(e){return this.mapVisit(e.nodes)}).set("paren.open",function(e){var t=this.options.capture?"(":"";switch(e.parent.prefix){case"!":case"^":return this.emit(t+"(?:(?!(?:",e);case"*":case"+":case"?":case"@":return this.emit(t+"(?:",e);default:var r=e.val;return!0===this.options.bash?r="\\"+r:this.options.capture||"("!==r||"?"===e.parent.rest[0]||(r+="?:"),this.emit(r,e)}}).set("paren.close",function(e){var r=this.options.capture?")":"";switch(e.prefix){case"!":case"^":var n=/^(\)|$)/.test(e.rest)?"$":"",i=t.call(this,e);return e.parent.hasSlash&&!this.options.star&&!1!==this.options.slash&&(i=".*?"),this.emit(n+"))"+i+")"+r,e);case"*":case"+":case"?":return this.emit(")"+e.prefix+r,e);case"@":return this.emit(")"+r,e);default:var o=(!0===this.options.bash?"\\":"")+")";return this.emit(o,e)}}).set("text",function(e){var t=e.val.replace(/[\[\]]/g,"\\$&");return this.emit(t,e)})}},function(e,t,r){"use strict";(function(t){var n=r(372),i=r(374),o=r(134)("expand-brackets"),a=r(49),s=r(96),l=r(60);function u(e,r){return o("initializing from <%s>",t),u.create(e,r).output}u.match=function(e,t,r){e=[].concat(e);for(var n=a({},r),i=u.matcher(t,n),o=e.length,s=-1,l=[];++s<o;){var c=e[s];i(c)&&l.push(c)}if(0===l.length){if(!0===n.failglob)throw new Error('no matches found for "'+t+'"');if(!0===n.nonull||!0===n.nullglob)return[t.split("\\").join("")]}return l},u.isMatch=function(e,t,r){return u.matcher(t,r)(e)},u.matcher=function(e,t){var r=u.makeRe(e,t);return function(e){return r.test(e)}},u.makeRe=function(e,t){var r=u.create(e,t),n=a({strictErrors:!1},t);return l(r.output,n)},u.create=function(e,t){var r=t&&t.snapdragon||new s(t);n(r),i(r);var o=r.parse(e,t);o.input=e;var a=r.compile(o,t);return a.input=e,a},u.compilers=n,u.parsers=i,e.exports=u}).call(this,"/index.js")},function(e,t,r){"use strict";var n=r(191),i=r(193),o="([!@*?+]?\\(|\\)|[*?.+\\\\]|\\[:?(?=.*\\])|:?\\])+",a=r(194).createRegex(o);e.exports.TEXT_REGEX=o,e.exports=function(e){e.state=e.state||{},e.use(n.parsers),e.parser.sets.paren=e.parser.sets.paren||[],e.parser.capture("paren.open",function(){var e=this.parsed,t=this.position(),r=this.match(/^([!@*?+])?\(/);if(r){var n=this.prev(),o=r[1],a=t({type:"paren.open",parsed:e,val:r[0]}),s=t({type:"paren",prefix:o,nodes:[a]});"!"===o&&"paren"===n.type&&"!"===n.prefix&&(n.prefix="@",s.prefix="@"),i(s,"rest",this.input),i(s,"parsed",e),i(s,"parent",n),i(a,"parent",s),this.push("paren",s),n.nodes.push(s)}}).capture("paren.close",function(){var e=this.parsed,t=this.position(),r=this.match(/^\)/);if(r){var n=this.pop("paren"),o=t({type:"paren.close",rest:this.input,parsed:e,val:r[0]});if(!this.isType(n,"paren")){if(this.options.strict)throw new Error('missing opening paren: "("');return o.escaped=!0,o}o.prefix=n.prefix,n.nodes.push(o),i(o,"parent",n)}}).capture("escape",function(){var e=this.position(),t=this.match(/^\\(.)/);if(t)return e({type:"escape",val:t[0],ch:t[1]})}).capture("qmark",function(){var t=this.parsed,r=this.position(),n=this.match(/^\?+(?!\()/);if(n)return e.state.metachar=!0,r({type:"qmark",rest:this.input,parsed:t,val:n[0]})}).capture("star",/^\*(?!\()/).capture("plus",/^\+(?!\()/).capture("dot",/^\./).capture("text",a)}},function(e,t,r){"use strict";var n=r(78);e.exports=function(e,t,r){if("object"!==typeof e&&"function"!==typeof e)throw new TypeError("expected an object or function.");if("string"!==typeof t)throw new TypeError("expected `prop` to be a string.");return n(r)&&("set"in r||"get"in r)?Object.defineProperty(e,t,r):Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:r})}},function(e,t,r){"use strict";var n=r(94),i=r(136),o=e.exports,a=o.cache=new i;o.arrayify=function(e){return Array.isArray(e)?e:[e]},o.memoize=function(e,t,r,n){var i=o.createKey(e+t,r);if(a.has(e,i))return a.get(e,i);var s=n(t,r);return r&&!1===r.cache?s:(a.set(e,i,s),s)},o.createKey=function(e,t){var r=e;if("undefined"===typeof t)return r;for(var n in t)r+=";"+n+"="+String(t[n]);return r},o.createRegex=function(e){return n(e,{contains:!0,strictClose:!1})}},function(e,t,r){e.exports=r(384)()},function(e,t,r){"use strict";var n=r(137);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=o.default.memo(o.default.forwardRef(function(t,r){return o.default.createElement(a.default,(0,i.default)({ref:r},t),e)}));0;return r.muiName=a.default.muiName,r};var i=n(r(386)),o=n(r(0)),a=n(r(489))},function(e,t,r){e.exports=!r(73)&&!r(82)(function(){return 7!=Object.defineProperty(r(198)("div"),"a",{get:function(){return 7}}).a})},function(e,t,r){var n=r(81),i=r(64).document,o=n(i)&&n(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,r){var n=r(74),i=r(75),o=r(392)(!1),a=r(143)("IE_PROTO");e.exports=function(e,t){var r,s=i(e),l=0,u=[];for(r in s)r!=a&&n(s,r)&&u.push(r);for(;t.length>l;)n(s,r=t[l++])&&(~o(u,r)||u.push(r));return u}},function(e,t,r){var n=r(140);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},function(e,t,r){var n=r(142),i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},function(e,t,r){e.exports={default:r(394),__esModule:!0}},function(e,t,r){"use strict";var n=r(398)(!0);r(204)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=n(t,r),this._i+=e.length,{value:e,done:!1})})},function(e,t,r){"use strict";var n=r(113),i=r(63),o=r(205),a=r(79),s=r(99),l=r(399),u=r(148),c=r(206),h=r(50)("iterator"),p=!([].keys&&"next"in[].keys()),f=function(){return this};e.exports=function(e,t,r,d,m,v,g){l(r,t,d);var y,b,x,w=function(e){if(!p&&e in T)return T[e];switch(e){case"keys":case"values":return function(){return new r(this,e)}}return function(){return new r(this,e)}},S=t+" Iterator",M="values"==m,_=!1,T=e.prototype,A=T[h]||T["@@iterator"]||m&&T[m],C=A||w(m),E=m?M?w("entries"):C:void 0,L="Array"==t&&T.entries||A;if(L&&(x=c(L.call(new e)))!==Object.prototype&&x.next&&(u(x,S,!0),n||"function"==typeof x[h]||a(x,h,f)),M&&A&&"values"!==A.name&&(_=!0,C=function(){return A.call(this)}),n&&!g||!p&&!_&&T[h]||a(T,h,C),s[t]=C,s[S]=f,m)if(y={values:M?C:w("values"),keys:v?C:w("keys"),entries:E},g)for(b in y)b in T||o(T,b,y[b]);else i(i.P+i.F*(p||_),t,y);return y}},function(e,t,r){e.exports=r(79)},function(e,t,r){var n=r(74),i=r(116),o=r(143)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),n(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,r){var n=r(199),i=r(145).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,i)}},function(e,t,r){var n=r(63),i=r(36),o=r(82);e.exports=function(e,t){var r=(i.Object||{})[e]||Object[e],a={};a[e]=t(r),n(n.S+n.F*o(function(){r(1)}),"Object",a)}},function(e,t){e.exports=function(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}},function(e,t){var r=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,i=e.indexOf("["),o=e.indexOf("]");-1!=i&&-1!=o&&(e=e.substring(0,i)+e.substring(i,o).replace(/:/g,";")+e.substring(o,e.length));for(var a=r.exec(e||""),s={},l=14;l--;)s[n[l]]=a[l]||"";return-1!=i&&-1!=o&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){(function(t){e.exports=function(e){return r&&t.isBuffer(e)||n&&(e instanceof ArrayBuffer||i(e))};var r="function"===typeof t&&"function"===typeof t.isBuffer,n="function"===typeof ArrayBuffer,i=function(e){return"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}}).call(this,r(153).Buffer)},function(e,t,r){var n=r(467),i=r(219),o=r(62),a=r(152),s=r(220),l=r(221),u=r(117)("socket.io-client:manager"),c=r(218),h=r(483),p=Object.prototype.hasOwnProperty;function f(e,t){if(!(this instanceof f))return new f(e,t);e&&"object"===typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new h({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var r=t.parser||a;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}e.exports=f,f.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)p.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},f.prototype.updateSocketIds=function(){for(var e in this.nsps)p.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},f.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},o(f.prototype),f.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},f.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},f.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},f.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},f.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},f.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},f.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},f.prototype.open=f.prototype.connect=function(e,t){if(u("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;u("opening %s",this.uri),this.engine=n(this.uri,this.opts);var r=this.engine,i=this;this.readyState="opening",this.skipReconnect=!1;var o=s(r,"open",function(){i.onopen(),e&&e()}),a=s(r,"error",function(t){if(u("connect_error"),i.cleanup(),i.readyState="closed",i.emitAll("connect_error",t),e){var r=new Error("Connection error");r.data=t,e(r)}else i.maybeReconnectOnOpen()});if(!1!==this._timeout){var l=this._timeout;u("connect attempt will timeout after %d",l);var c=setTimeout(function(){u("connect attempt timed out after %d",l),o.destroy(),r.close(),r.emit("error","timeout"),i.emitAll("connect_timeout",l)},l);this.subs.push({destroy:function(){clearTimeout(c)}})}return this.subs.push(o),this.subs.push(a),this},f.prototype.onopen=function(){u("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(s(e,"data",l(this,"ondata"))),this.subs.push(s(e,"ping",l(this,"onping"))),this.subs.push(s(e,"pong",l(this,"onpong"))),this.subs.push(s(e,"error",l(this,"onerror"))),this.subs.push(s(e,"close",l(this,"onclose"))),this.subs.push(s(this.decoder,"decoded",l(this,"ondecoded")))},f.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},f.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},f.prototype.ondata=function(e){this.decoder.add(e)},f.prototype.ondecoded=function(e){this.emit("packet",e)},f.prototype.onerror=function(e){u("error",e),this.emitAll("error",e)},f.prototype.socket=function(e,t){var r=this.nsps[e];if(!r){r=new i(this,e,t),this.nsps[e]=r;var n=this;r.on("connecting",o),r.on("connect",function(){r.id=n.generateId(e)}),this.autoConnect&&o()}function o(){~c(n.connecting,r)||n.connecting.push(r)}return r},f.prototype.destroy=function(e){var t=c(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},f.prototype.packet=function(e){u("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(r){for(var n=0;n<r.length;n++)t.engine.write(r[n],e.options);t.encoding=!1,t.processPacketQueue()}))},f.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},f.prototype.cleanup=function(){u("cleanup");for(var e=this.subs.length,t=0;t<e;t++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},f.prototype.close=f.prototype.disconnect=function(){u("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},f.prototype.onclose=function(e){u("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},f.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)u("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();u("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var r=setTimeout(function(){e.skipReconnect||(u("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(u("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(u("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(r)}})}},f.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,r){var n=r(154),i=r(470),o=r(479),a=r(480);t.polling=function(e){var t=!1,r=!1,a=!1!==e.jsonp;if("undefined"!==typeof location){var s="https:"===location.protocol,l=location.port;l||(l=s?443:80),t=e.hostname!==location.hostname||l!==e.port,r=e.secure!==s}if(e.xdomain=t,e.xscheme=r,"open"in new n(e)&&!e.forceJSONP)return new i(e);if(!a)throw new Error("JSONP disabled");return new o(e)},t.websocket=a},function(e,t,r){var n=r(155),i=r(118),o=r(83),a=r(119),s=r(217),l=r(120)("engine.io-client:polling");e.exports=c;var u=null!=new(r(154))({xdomain:!1}).responseType;function c(e){var t=e&&e.forceBase64;u&&!t||(this.supportsBinary=!1),n.call(this,e)}a(c,n),c.prototype.name="polling",c.prototype.doOpen=function(){this.poll()},c.prototype.pause=function(e){var t=this;function r(){l("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){var n=0;this.polling&&(l("we are currently polling - waiting to pause"),n++,this.once("pollComplete",function(){l("pre-pause polling complete"),--n||r()})),this.writable||(l("we are currently writing - waiting to pause"),n++,this.once("drain",function(){l("pre-pause writing complete"),--n||r()}))}else r()},c.prototype.poll=function(){l("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},c.prototype.onData=function(e){var t=this;l("polling got data %s",e);o.decodePayload(e,this.socket.binaryType,function(e,r,n){if("opening"===t.readyState&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():l('ignoring poll - transport state "%s"',this.readyState))},c.prototype.doClose=function(){var e=this;function t(){l("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(l("transport open - closing"),t()):(l("transport not open - deferring close"),this.once("open",t))},c.prototype.write=function(e){var t=this;this.writable=!1;var r=function(){t.writable=!0,t.emit("drain")};o.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,r)})},c.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",r="";return!1!==this.timestampRequests&&(e[this.timestampParam]=s()),this.supportsBinary||e.sid||(e.b64=1),e=i.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(r=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+r+this.path+e}},function(e,t,r){(function(t){var n=r(472),i=Object.prototype.toString,o="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===i.call(Blob),a="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===i.call(File);e.exports=function e(r){if(!r||"object"!==typeof r)return!1;if(n(r)){for(var i=0,s=r.length;i<s;i++)if(e(r[i]))return!0;return!1}if("function"===typeof t&&t.isBuffer&&t.isBuffer(r)||"function"===typeof ArrayBuffer&&r instanceof ArrayBuffer||o&&r instanceof Blob||a&&r instanceof File)return!0;if(r.toJSON&&"function"===typeof r.toJSON&&1===arguments.length)return e(r.toJSON(),!0);for(var l in r)if(Object.prototype.hasOwnProperty.call(r,l)&&e(r[l]))return!0;return!1}}).call(this,r(153).Buffer)},function(e,t,r){"use strict";var n,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),o=64,a={},s=0,l=0;function u(e){var t="";do{t=i[e%o]+t,e=Math.floor(e/o)}while(e>0);return t}function c(){var e=u(+new Date);return e!==n?(s=0,n=e):e+"."+u(s++)}for(;l<o;l++)a[i[l]]=l;c.encode=u,c.decode=function(e){var t=0;for(l=0;l<e.length;l++)t=t*o+a[e.charAt(l)];return t},e.exports=c},function(e,t){var r=[].indexOf;e.exports=function(e,t){if(r)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}},function(e,t,r){var n=r(152),i=r(62),o=r(482),a=r(220),s=r(221),l=r(117)("socket.io-client:socket"),u=r(118),c=r(216);e.exports=f;var h={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},p=i.prototype.emit;function f(e,t,r){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},r&&r.query&&(this.query=r.query),this.io.autoConnect&&this.open()}i(f.prototype),f.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[a(e,"open",s(this,"onopen")),a(e,"packet",s(this,"onpacket")),a(e,"close",s(this,"onclose"))]}},f.prototype.open=f.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},f.prototype.send=function(){var e=o(arguments);return e.unshift("message"),this.emit.apply(this,e),this},f.prototype.emit=function(e){if(h.hasOwnProperty(e))return p.apply(this,arguments),this;var t=o(arguments),r={type:(void 0!==this.flags.binary?this.flags.binary:c(t))?n.BINARY_EVENT:n.EVENT,data:t,options:{}};return r.options.compress=!this.flags||!1!==this.flags.compress,"function"===typeof t[t.length-1]&&(l("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),r.id=this.ids++),this.connected?this.packet(r):this.sendBuffer.push(r),this.flags={},this},f.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},f.prototype.onopen=function(){if(l("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"===typeof this.query?u.encode(this.query):this.query;l("sending connect packet with query %s",e),this.packet({type:n.CONNECT,query:e})}else this.packet({type:n.CONNECT})},f.prototype.onclose=function(e){l("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},f.prototype.onpacket=function(e){var t=e.nsp===this.nsp,r=e.type===n.ERROR&&"/"===e.nsp;if(t||r)switch(e.type){case n.CONNECT:this.onconnect();break;case n.EVENT:case n.BINARY_EVENT:this.onevent(e);break;case n.ACK:case n.BINARY_ACK:this.onack(e);break;case n.DISCONNECT:this.ondisconnect();break;case n.ERROR:this.emit("error",e.data)}},f.prototype.onevent=function(e){var t=e.data||[];l("emitting event %j",t),null!=e.id&&(l("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?p.apply(this,t):this.receiveBuffer.push(t)},f.prototype.ack=function(e){var t=this,r=!1;return function(){if(!r){r=!0;var i=o(arguments);l("sending ack %j",i),t.packet({type:c(i)?n.BINARY_ACK:n.ACK,id:e,data:i})}}},f.prototype.onack=function(e){var t=this.acks[e.id];"function"===typeof t?(l("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):l("bad ack %s",e.id)},f.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},f.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)p.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},f.prototype.ondisconnect=function(){l("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},f.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},f.prototype.close=f.prototype.disconnect=function(){return this.connected&&(l("performing disconnect (%s)",this.nsp),this.packet({type:n.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},f.prototype.compress=function(e){return this.flags.compress=e,this},f.prototype.binary=function(e){return this.flags.binary=e,this}},function(e,t){e.exports=function(e,t,r){return e.on(t,r),{destroy:function(){e.removeListener(t,r)}}}},function(e,t){var r=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var n=r.call(arguments,2);return function(){return t.apply(e,n.concat(r.call(arguments)))}}},function(e,t,r){"use strict";function n(e){var t,r=e.Symbol;return"function"===typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}r.d(t,"a",function(){return n})},function(e,t,r){(function(e){!function(t){"use strict";function r(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function n(e,t){Object.defineProperty(this,"kind",{value:e,enumerable:!0}),t&&t.length&&Object.defineProperty(this,"path",{value:t,enumerable:!0})}function i(e,t,r){i.super_.call(this,"E",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0}),Object.defineProperty(this,"rhs",{value:r,enumerable:!0})}function o(e,t){o.super_.call(this,"N",e),Object.defineProperty(this,"rhs",{value:t,enumerable:!0})}function a(e,t){a.super_.call(this,"D",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0})}function s(e,t,r){s.super_.call(this,"A",e),Object.defineProperty(this,"index",{value:t,enumerable:!0}),Object.defineProperty(this,"item",{value:r,enumerable:!0})}function l(e,t,r){var n=e.slice((r||t)+1||e.length);return e.length=t<0?e.length+t:t,e.push.apply(e,n),e}function u(e){var t="undefined"==typeof e?"undefined":M(e);return"object"!==t?t:e===Math?"math":null===e?"null":Array.isArray(e)?"array":"[object Date]"===Object.prototype.toString.call(e)?"date":"function"==typeof e.toString&&/^\/.*\//.test(e.toString())?"regexp":"object"}function c(e,t,r,n,h,p,f){f=f||[];var d=(h=h||[]).slice(0);if("undefined"!=typeof p){if(n){if("function"==typeof n&&n(d,p))return;if("object"===("undefined"==typeof n?"undefined":M(n))){if(n.prefilter&&n.prefilter(d,p))return;if(n.normalize){var m=n.normalize(d,p,e,t);m&&(e=m[0],t=m[1])}}}d.push(p)}"regexp"===u(e)&&"regexp"===u(t)&&(e=e.toString(),t=t.toString());var v="undefined"==typeof e?"undefined":M(e),g="undefined"==typeof t?"undefined":M(t),y="undefined"!==v||f&&f[f.length-1].lhs&&f[f.length-1].lhs.hasOwnProperty(p),b="undefined"!==g||f&&f[f.length-1].rhs&&f[f.length-1].rhs.hasOwnProperty(p);if(!y&&b)r(new o(d,t));else if(!b&&y)r(new a(d,e));else if(u(e)!==u(t))r(new i(d,e,t));else if("date"===u(e)&&e-t!==0)r(new i(d,e,t));else if("object"===v&&null!==e&&null!==t)if(f.filter(function(t){return t.lhs===e}).length)e!==t&&r(new i(d,e,t));else{if(f.push({lhs:e,rhs:t}),Array.isArray(e)){var x;for(e.length,x=0;x<e.length;x++)x>=t.length?r(new s(d,x,new a(void 0,e[x]))):c(e[x],t[x],r,n,d,x,f);for(;x<t.length;)r(new s(d,x,new o(void 0,t[x++])))}else{var w=Object.keys(e),S=Object.keys(t);w.forEach(function(i,o){var a=S.indexOf(i);a>=0?(c(e[i],t[i],r,n,d,i,f),S=l(S,a)):c(e[i],void 0,r,n,d,i,f)}),S.forEach(function(e){c(void 0,t[e],r,n,d,e,f)})}f.length=f.length-1}else e!==t&&("number"===v&&isNaN(e)&&isNaN(t)||r(new i(d,e,t)))}function h(e,t,r,n){return n=n||[],c(e,t,function(e){e&&n.push(e)},r),n.length?n:void 0}function p(e,t,r){if(e&&t&&r&&r.kind){for(var n=e,i=-1,o=r.path?r.path.length-1:0;++i<o;)"undefined"==typeof n[r.path[i]]&&(n[r.path[i]]="number"==typeof r.path[i]?[]:{}),n=n[r.path[i]];switch(r.kind){case"A":!function e(t,r,n){if(n.path&&n.path.length){var i,o=t[r],a=n.path.length-1;for(i=0;i<a;i++)o=o[n.path[i]];switch(n.kind){case"A":e(o[n.path[i]],n.index,n.item);break;case"D":delete o[n.path[i]];break;case"E":case"N":o[n.path[i]]=n.rhs}}else switch(n.kind){case"A":e(t[r],n.index,n.item);break;case"D":t=l(t,r);break;case"E":case"N":t[r]=n.rhs}return t}(r.path?n[r.path[i]]:n,r.index,r.item);break;case"D":delete n[r.path[i]];break;case"E":case"N":n[r.path[i]]=r.rhs}}}function f(e){return"color: "+A[e].color+"; font-weight: bold"}function d(e,t,r,n){var i=h(e,t);try{n?r.groupCollapsed("diff"):r.group("diff")}catch(e){r.log("diff")}i?i.forEach(function(e){var t=e.kind,n=function(e){var t=e.kind,r=e.path,n=e.lhs,i=e.rhs,o=e.index,a=e.item;switch(t){case"E":return[r.join("."),n,"\u2192",i];case"N":return[r.join("."),i];case"D":return[r.join(".")];case"A":return[r.join(".")+"["+o+"]",a];default:return[]}}(e);r.log.apply(r,["%c "+A[t].text,f(t)].concat(_(n)))}):r.log("\u2014\u2014 no diff \u2014\u2014");try{r.groupEnd()}catch(e){r.log("\u2014\u2014 diff end \u2014\u2014 ")}}function m(e,t,r,n){switch("undefined"==typeof e?"undefined":M(e)){case"object":return"function"==typeof e[n]?e[n].apply(e,_(r)):e[n];case"function":return e(t);default:return e}}function v(e,t){var r=t.logger,n=t.actionTransformer,i=t.titleFormatter,o=void 0===i?function(e){var t=e.timestamp,r=e.duration;return function(e,n,i){var o=["action"];return o.push("%c"+String(e.type)),t&&o.push("%c@ "+n),r&&o.push("%c(in "+i.toFixed(2)+" ms)"),o.join(" ")}}(t):i,a=t.collapsed,s=t.colors,l=t.level,u=t.diff,c="undefined"==typeof t.titleFormatter;e.forEach(function(i,h){var p=i.started,f=i.startedTime,v=i.action,g=i.prevState,y=i.error,b=i.took,x=i.nextState,S=e[h+1];S&&(x=S.prevState,b=S.started-p);var M=n(v),_="function"==typeof a?a(function(){return x},v,i):a,T=w(f),A=s.title?"color: "+s.title(M)+";":"",C=["color: gray; font-weight: lighter;"];C.push(A),t.timestamp&&C.push("color: gray; font-weight: lighter;"),t.duration&&C.push("color: gray; font-weight: lighter;");var E=o(M,T,b);try{_?s.title&&c?r.groupCollapsed.apply(r,["%c "+E].concat(C)):r.groupCollapsed(E):s.title&&c?r.group.apply(r,["%c "+E].concat(C)):r.group(E)}catch(e){r.log(E)}var L=m(l,M,[g],"prevState"),N=m(l,M,[M],"action"),P=m(l,M,[y,g],"error"),O=m(l,M,[x],"nextState");if(L)if(s.prevState){var R="color: "+s.prevState(g)+"; font-weight: bold";r[L]("%c prev state",R,g)}else r[L]("prev state",g);if(N)if(s.action){var D="color: "+s.action(M)+"; font-weight: bold";r[N]("%c action    ",D,M)}else r[N]("action    ",M);if(y&&P)if(s.error){var F="color: "+s.error(y,g)+"; font-weight: bold;";r[P]("%c error     ",F,y)}else r[P]("error     ",y);if(O)if(s.nextState){var k="color: "+s.nextState(x)+"; font-weight: bold";r[O]("%c next state",k,x)}else r[O]("next state",x);u&&d(g,x,r,_);try{r.groupEnd()}catch(e){r.log("\u2014\u2014 log end \u2014\u2014")}})}function g(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},C,e),r=t.logger,n=t.stateTransformer,i=t.errorTransformer,o=t.predicate,a=t.logErrors,s=t.diffPredicate;if("undefined"==typeof r)return function(){return function(e){return function(t){return e(t)}}};if(e.getState&&e.dispatch)return console.error("[redux-logger] redux-logger not installed. Make sure to pass logger instance as middleware:\n// Logger with default options\nimport { logger } from 'redux-logger'\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n// Or you can create your own logger with custom options http://bit.ly/redux-logger-options\nimport createLogger from 'redux-logger'\nconst logger = createLogger({\n  // ...options\n});\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n"),function(){return function(e){return function(t){return e(t)}}};var l=[];return function(e){var r=e.getState;return function(e){return function(u){if("function"==typeof o&&!o(r,u))return e(u);var c={};l.push(c),c.started=S.now(),c.startedTime=new Date,c.prevState=n(r()),c.action=u;var h=void 0;if(a)try{h=e(u)}catch(e){c.error=i(e)}else h=e(u);c.took=S.now()-c.started,c.nextState=n(r());var p=t.diff&&"function"==typeof s?s(r,u):t.diff;if(v(l,Object.assign({},t,{diff:p})),l.length=0,c.error)throw c.error;return h}}}}var y,b,x=function(e,t){return function(e,t){return new Array(t+1).join(e)}("0",t-e.toString().length)+e},w=function(e){return x(e.getHours(),2)+":"+x(e.getMinutes(),2)+":"+x(e.getSeconds(),2)+"."+x(e.getMilliseconds(),3)},S="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance:Date,M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)},T=[];y="object"===("undefined"==typeof e?"undefined":M(e))&&e?e:"undefined"!=typeof window?window:{},(b=y.DeepDiff)&&T.push(function(){"undefined"!=typeof b&&y.DeepDiff===h&&(y.DeepDiff=b,b=void 0)}),r(i,n),r(o,n),r(a,n),r(s,n),Object.defineProperties(h,{diff:{value:h,enumerable:!0},observableDiff:{value:c,enumerable:!0},applyDiff:{value:function(e,t,r){e&&t&&c(e,t,function(n){r&&!r(e,t,n)||p(e,t,n)})},enumerable:!0},applyChange:{value:p,enumerable:!0},revertChange:{value:function(e,t,r){if(e&&t&&r&&r.kind){var n,i,o=e;for(i=r.path.length-1,n=0;n<i;n++)"undefined"==typeof o[r.path[n]]&&(o[r.path[n]]={}),o=o[r.path[n]];switch(r.kind){case"A":!function e(t,r,n){if(n.path&&n.path.length){var i,o=t[r],a=n.path.length-1;for(i=0;i<a;i++)o=o[n.path[i]];switch(n.kind){case"A":e(o[n.path[i]],n.index,n.item);break;case"D":case"E":o[n.path[i]]=n.lhs;break;case"N":delete o[n.path[i]]}}else switch(n.kind){case"A":e(t[r],n.index,n.item);break;case"D":case"E":t[r]=n.lhs;break;case"N":t=l(t,r)}return t}(o[r.path[n]],r.index,r.item);break;case"D":case"E":o[r.path[n]]=r.lhs;break;case"N":delete o[r.path[n]]}}},enumerable:!0},isConflict:{value:function(){return"undefined"!=typeof b},enumerable:!0},noConflict:{value:function(){return T&&(T.forEach(function(e){e()}),T=null),h},enumerable:!0}});var A={E:{color:"#2196F3",text:"CHANGED:"},N:{color:"#4CAF50",text:"ADDED:"},D:{color:"#F44336",text:"DELETED:"},A:{color:"#2196F3",text:"ARRAY:"}},C={level:"log",logger:console,logErrors:!0,collapsed:void 0,predicate:void 0,duration:!1,timestamp:!0,stateTransformer:function(e){return e},actionTransformer:function(e){return e},errorTransformer:function(e){return e},colors:{title:function(){return"inherit"},prevState:function(){return"#9E9E9E"},action:function(){return"#03A9F4"},nextState:function(){return"#4CAF50"},error:function(){return"#F20404"}},diff:!1,diffPredicate:void 0,transformer:void 0},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dispatch,r=e.getState;return"function"==typeof t||"function"==typeof r?g()({dispatch:t,getState:r}):void console.error("\n[redux-logger v3] BREAKING CHANGE\n[redux-logger v3] Since 3.0.0 redux-logger exports by default logger with default settings.\n[redux-logger v3] Change\n[redux-logger v3] import createLogger from 'redux-logger'\n[redux-logger v3] to\n[redux-logger v3] import { createLogger } from 'redux-logger'\n")};t.defaults=C,t.createLogger=g,t.logger=E,t.default=E,Object.defineProperty(t,"__esModule",{value:!0})}(t)}).call(this,r(72))},function(e,t,r){"use strict";function n(e){return function(t){var r=t.dispatch,n=t.getState;return function(t){return function(i){return"function"===typeof i?i(r,n,e):t(i)}}}}var i=n();i.withExtraArgument=n,t.a=i},function(e,t,r){"use strict";t.__esModule=!0;var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=h(r(161)),a=h(r(22)),s=r(263),l=r(162),u=h(r(266)),c=r(267);function h(e){return e&&e.__esModule?e:{default:e}}var p=function(){try{return window.history.state||{}}catch(e){return{}}};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.default)(c.canUseDOM,"Browser history needs a DOM");var t=window.history,r=(0,c.supportsHistory)(),h=!(0,c.supportsPopStateOnHashChange)(),f=e.forceRefresh,d=void 0!==f&&f,m=e.getUserConfirmation,v=void 0===m?c.getConfirmation:m,g=e.keyLength,y=void 0===g?6:g,b=e.basename?(0,l.stripTrailingSlash)((0,l.addLeadingSlash)(e.basename)):"",x=function(e){var t=e||{},r=t.key,n=t.state,i=window.location,a=i.pathname+i.search+i.hash;return(0,o.default)(!b||(0,l.hasBasename)(a,b),'You are attempting to use a basename on a page whose URL path does not begin with the basename. Expected path "'+a+'" to begin with "'+b+'".'),b&&(a=(0,l.stripBasename)(a,b)),(0,s.createLocation)(a,n,r)},w=function(){return Math.random().toString(36).substr(2,y)},S=(0,u.default)(),M=function(e){i(k,e),k.length=t.length,S.notifyListeners(k.location,k.action)},_=function(e){(0,c.isExtraneousPopstateEvent)(e)||C(x(e.state))},T=function(){C(x(p()))},A=!1,C=function(e){A?(A=!1,M()):S.confirmTransitionTo(e,"POP",v,function(t){t?M({action:"POP",location:e}):E(e)})},E=function(e){var t=k.location,r=N.indexOf(t.key);-1===r&&(r=0);var n=N.indexOf(e.key);-1===n&&(n=0);var i=r-n;i&&(A=!0,O(i))},L=x(p()),N=[L.key],P=function(e){return b+(0,l.createPath)(e)},O=function(e){t.go(e)},R=0,D=function(e){1===(R+=e)?((0,c.addEventListener)(window,"popstate",_),h&&(0,c.addEventListener)(window,"hashchange",T)):0===R&&((0,c.removeEventListener)(window,"popstate",_),h&&(0,c.removeEventListener)(window,"hashchange",T))},F=!1,k={length:t.length,action:"POP",location:L,createHref:P,push:function(e,i){(0,o.default)(!("object"===("undefined"===typeof e?"undefined":n(e))&&void 0!==e.state&&void 0!==i),"You should avoid providing a 2nd state argument to push when the 1st argument is a location-like object that already has state; it is ignored");var a=(0,s.createLocation)(e,i,w(),k.location);S.confirmTransitionTo(a,"PUSH",v,function(e){if(e){var n=P(a),i=a.key,s=a.state;if(r)if(t.pushState({key:i,state:s},null,n),d)window.location.href=n;else{var l=N.indexOf(k.location.key),u=N.slice(0,-1===l?0:l+1);u.push(a.key),N=u,M({action:"PUSH",location:a})}else(0,o.default)(void 0===s,"Browser history cannot push state in browsers that do not support HTML5 history"),window.location.href=n}})},replace:function(e,i){(0,o.default)(!("object"===("undefined"===typeof e?"undefined":n(e))&&void 0!==e.state&&void 0!==i),"You should avoid providing a 2nd state argument to replace when the 1st argument is a location-like object that already has state; it is ignored");var a=(0,s.createLocation)(e,i,w(),k.location);S.confirmTransitionTo(a,"REPLACE",v,function(e){if(e){var n=P(a),i=a.key,s=a.state;if(r)if(t.replaceState({key:i,state:s},null,n),d)window.location.replace(n);else{var l=N.indexOf(k.location.key);-1!==l&&(N[l]=a.key),M({action:"REPLACE",location:a})}else(0,o.default)(void 0===s,"Browser history cannot replace state in browsers that do not support HTML5 history"),window.location.replace(n)}})},go:O,goBack:function(){return O(-1)},goForward:function(){return O(1)},block:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=S.setPrompt(e);return F||(D(1),F=!0),function(){return F&&(F=!1,D(-1)),t()}},listen:function(e){var t=S.appendListener(e);return D(1),function(){D(-1),t()}}};return k}},function(e,t,r){"use strict";var n=r(227),i=r.n(n),o={},a=0;t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2];"string"===typeof t&&(t={path:t});var n=t,s=n.path,l=n.exact,u=void 0!==l&&l,c=n.strict,h=void 0!==c&&c,p=n.sensitive;if(null==s)return r;var f=function(e,t){var r=""+t.end+t.strict+t.sensitive,n=o[r]||(o[r]={});if(n[e])return n[e];var s=[],l={re:i()(e,s,t),keys:s};return a<1e4&&(n[e]=l,a++),l}(s,{end:u,strict:h,sensitive:void 0!==p&&p}),d=f.re,m=f.keys,v=d.exec(e);if(!v)return null;var g=v[0],y=v.slice(1),b=e===g;return u&&!b?null:{path:s,url:"/"===s&&""===g?"/":g,isExact:b,params:m.reduce(function(e,t,r){return e[t.name]=y[r],e},{})}}},function(e,t,r){var n=r(287);e.exports=f,e.exports.parse=o,e.exports.compile=function(e,t){return s(o(e,t))},e.exports.tokensToFunction=s,e.exports.tokensToRegExp=p;var i=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function o(e,t){for(var r,n=[],o=0,a=0,s="",c=t&&t.delimiter||"/";null!=(r=i.exec(e));){var h=r[0],p=r[1],f=r.index;if(s+=e.slice(a,f),a=f+h.length,p)s+=p[1];else{var d=e[a],m=r[2],v=r[3],g=r[4],y=r[5],b=r[6],x=r[7];s&&(n.push(s),s="");var w=null!=m&&null!=d&&d!==m,S="+"===b||"*"===b,M="?"===b||"*"===b,_=r[2]||c,T=g||y;n.push({name:v||o++,prefix:m||"",delimiter:_,optional:M,repeat:S,partial:w,asterisk:!!x,pattern:T?u(T):x?".*":"[^"+l(_)+"]+?"})}}return a<e.length&&(s+=e.substr(a)),s&&n.push(s),n}function a(e){return encodeURI(e).replace(/[\/?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function s(e){for(var t=new Array(e.length),r=0;r<e.length;r++)"object"===typeof e[r]&&(t[r]=new RegExp("^(?:"+e[r].pattern+")$"));return function(r,i){for(var o="",s=r||{},l=(i||{}).pretty?a:encodeURIComponent,u=0;u<e.length;u++){var c=e[u];if("string"!==typeof c){var h,p=s[c.name];if(null==p){if(c.optional){c.partial&&(o+=c.prefix);continue}throw new TypeError('Expected "'+c.name+'" to be defined')}if(n(p)){if(!c.repeat)throw new TypeError('Expected "'+c.name+'" to not repeat, but received `'+JSON.stringify(p)+"`");if(0===p.length){if(c.optional)continue;throw new TypeError('Expected "'+c.name+'" to not be empty')}for(var f=0;f<p.length;f++){if(h=l(p[f]),!t[u].test(h))throw new TypeError('Expected all "'+c.name+'" to match "'+c.pattern+'", but received `'+JSON.stringify(h)+"`");o+=(0===f?c.prefix:c.delimiter)+h}}else{if(h=c.asterisk?encodeURI(p).replace(/[?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}):l(p),!t[u].test(h))throw new TypeError('Expected "'+c.name+'" to match "'+c.pattern+'", but received "'+h+'"');o+=c.prefix+h}}else o+=c}return o}}function l(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function u(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function c(e,t){return e.keys=t,e}function h(e){return e.sensitive?"":"i"}function p(e,t,r){n(t)||(r=t||r,t=[]);for(var i=(r=r||{}).strict,o=!1!==r.end,a="",s=0;s<e.length;s++){var u=e[s];if("string"===typeof u)a+=l(u);else{var p=l(u.prefix),f="(?:"+u.pattern+")";t.push(u),u.repeat&&(f+="(?:"+p+f+")*"),a+=f=u.optional?u.partial?p+"("+f+")?":"(?:"+p+"("+f+"))?":p+"("+f+")"}}var d=l(r.delimiter||"/"),m=a.slice(-d.length)===d;return i||(a=(m?a.slice(0,-d.length):a)+"(?:"+d+"(?=$))?"),a+=o?"$":i&&m?"":"(?="+d+"|$)",c(new RegExp("^"+a,h(r)),t)}function f(e,t,r){return n(t)||(r=t||r,t=[]),r=r||{},e instanceof RegExp?function(e,t){var r=e.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)t.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return c(e,t)}(e,t):n(e)?function(e,t,r){for(var n=[],i=0;i<e.length;i++)n.push(f(e[i],t,r).source);return c(new RegExp("(?:"+n.join("|")+")",h(r)),t)}(e,t,r):function(e,t,r){return p(o(e,r),t,r)}(e,t,r)}},function(e,t,r){"use strict";var n=r(137);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(0)),o=(0,n(r(196)).default)(i.default.createElement("path",{d:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"}),"Image");t.default=o},function(e,t,r){"use strict";var n=r(137);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(0)),o=(0,n(r(196)).default)(i.default.createElement("path",{d:"M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"}),"Folder");t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r,n){function i(t){var n=new o.default(t);r.call(e,n)}if(e.addEventListener){var a=function(){var r=!1;return"object"===typeof n?r=n.capture||!1:"boolean"===typeof n&&(r=n),e.addEventListener(t,i,n||!1),{v:{remove:function(){e.removeEventListener(t,i,r)}}}}();if("object"===typeof a)return a.v}else if(e.attachEvent)return e.attachEvent("on"+t,i),{remove:function(){e.detachEvent("on"+t,i)}}};var n,i=r(431),o=(n=i)&&n.__esModule?n:{default:n};e.exports=t.default},function(e,t){e.exports=function(e,t,r,n){var i=r?r.call(n,e,t):void 0;if(void 0!==i)return!!i;if(e===t)return!0;if("object"!==typeof e||!e||"object"!==typeof t||!t)return!1;var o=Object.keys(e),a=Object.keys(t);if(o.length!==a.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(t),l=0;l<o.length;l++){var u=o[l];if(!s(u))return!1;var c=e[u],h=t[u];if(!1===(i=r?r.call(n,c,h,u):void 0)||void 0===i&&c!==h)return!1}return!0}},function(e,t,r){try{var n=r(209)}catch(s){n=r(209)}var i=/\s+/,o=Object.prototype.toString;function a(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}e.exports=function(e){return new a(e)},a.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array();return~n(t,e)||t.push(e),this.el.className=t.join(" "),this},a.prototype.remove=function(e){if("[object RegExp]"==o.call(e))return this.removeMatching(e);if(this.list)return this.list.remove(e),this;var t=this.array(),r=n(t,e);return~r&&t.splice(r,1),this.el.className=t.join(" "),this},a.prototype.removeMatching=function(e){for(var t=this.array(),r=0;r<t.length;r++)e.test(t[r])&&this.remove(t[r]);return this},a.prototype.toggle=function(e,t){return this.list?("undefined"!==typeof t?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):("undefined"!==typeof t?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)},a.prototype.array=function(){var e=(this.el.getAttribute("class")||"").replace(/^\s+|\s+$/g,"").split(i);return""===e[0]&&e.shift(),e},a.prototype.has=a.prototype.contains=function(e){return this.list?this.list.contains(e):!!~n(this.array(),e)}},function(e,t,r){e.exports=function(){var e=function e(){function t(e){return i.appendChild(e.dom),e}function r(e){for(var t=0;t<i.children.length;t++)i.children[t].style.display=t===e?"block":"none";n=e}var n=0,i=document.createElement("div");i.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",i.addEventListener("click",function(e){e.preventDefault(),r(++n%i.children.length)},!1);var o=(performance||Date).now(),a=o,s=0,l=t(new e.Panel("FPS","#0ff","#002")),u=t(new e.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=t(new e.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:i,addPanel:t,showPanel:r,begin:function(){o=(performance||Date).now()},end:function(){s++;var e=(performance||Date).now();if(u.update(e-o,200),e>a+1e3&&(l.update(1e3*s/(e-a),100),a=e,s=0,c)){var t=performance.memory;c.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){o=this.end()},domElement:i,setMode:r}};return e.Panel=function(e,t,r){var n=1/0,i=0,o=Math.round,a=o(window.devicePixelRatio||1),s=80*a,l=48*a,u=3*a,c=2*a,h=3*a,p=15*a,f=74*a,d=30*a,m=document.createElement("canvas");m.width=s,m.height=l,m.style.cssText="width:80px;height:48px";var v=m.getContext("2d");return v.font="bold "+9*a+"px Helvetica,Arial,sans-serif",v.textBaseline="top",v.fillStyle=r,v.fillRect(0,0,s,l),v.fillStyle=t,v.fillText(e,u,c),v.fillRect(h,p,f,d),v.fillStyle=r,v.globalAlpha=.9,v.fillRect(h,p,f,d),{dom:m,update:function(l,g){n=Math.min(n,l),i=Math.max(i,l),v.fillStyle=r,v.globalAlpha=1,v.fillRect(0,0,s,p),v.fillStyle=t,v.fillText(o(l)+" "+e+" ("+o(n)+"-"+o(i)+")",u,c),v.drawImage(m,h+a,p,f-a,d,h,p,f-a,d),v.fillRect(h+f-a,p,a,d),v.fillStyle=r,v.globalAlpha=.9,v.fillRect(h+f-a,p,a,o((1-l/g)*d))}}},e}()},function(e,t,r){"use strict";t.__esModule=!0,t.default=function(e,t){var r=void 0===t?{}:t,n=r.propTypes,o=r.defaultProps,a=r.allowFallback,s=void 0!==a&&a,l=r.displayName,u=void 0===l?e.name||e.displayName:l,c=function(t,r){return e(t,r)};return Object.assign(i.default.forwardRef||!s?i.default.forwardRef(c):function(e){return c(e,null)},{displayName:u,propTypes:n,defaultProps:o})};var n,i=(n=r(0))&&n.__esModule?n:{default:n}},function(e,t,r){"use strict";t.__esModule=!0,t.default=function(e,t){var r,o="#"===t[0],a="."===t[0],s=o||a?t.slice(1):t;if(n.test(s))return o?(e=e.getElementById?e:document,(r=e.getElementById(s))?[r]:[]):e.getElementsByClassName&&a?i(e.getElementsByClassName(s)):i(e.getElementsByTagName(t));return i(e.querySelectorAll(t))};var n=/^[\w-]*$/,i=Function.prototype.bind.call(Function.prototype.call,[].slice);e.exports=t.default},function(e,t,r){"use strict";t.__esModule=!0,t.default=function(e){return e.replace(n,function(e,t){return t.toUpperCase()})};var n=/-(.)/g;e.exports=t.default},function(e,t,r){var n=r(460),i=r(152),o=r(213),a=r(117)("socket.io-client");e.exports=t=l;var s=t.managers={};function l(e,t){"object"===typeof e&&(t=e,e=void 0),t=t||{};var r,i=n(e),l=i.source,u=i.id,c=i.path,h=s[u]&&c in s[u].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||h?(a("ignoring socket cache for %s",l),r=o(l,t)):(s[u]||(a("new io instance for %s",l),s[u]=o(l,t)),r=s[u]),i.query&&!t.query&&(t.query=i.query),r.socket(i.path,t)}t.protocol=i.protocol,t.connect=l,t.Manager=r(213),t.Socket=r(219)},,,function(e,t,r){"use strict";var n=r(11),i=r.n(n),o=r(19),a=r.n(o),s=r(28),l=r.n(s),u=r(14),c=r.n(u),h=r(20),p=r.n(h),f=r(0),d=r.n(f),m=r(3),v=r.n(m),g=r(56),y=r.n(g),b=r(12),x=r.n(b),w=function(e){var t,r,n=e.className,o=e.included,a=e.vertical,s=e.offset,l=e.length,u=e.style,c=e.reverse,h=a?(t={},x()(t,c?"top":"bottom",s+"%"),x()(t,c?"bottom":"top","auto"),x()(t,"height",l+"%"),t):(r={},x()(r,c?"right":"left",s+"%"),x()(r,c?"left":"right","auto"),x()(r,"width",l+"%"),r),p=i()({},u,h);return o?d.a.createElement("div",{className:n,style:p}):null},S=r(44),M=r.n(S),_=r(127),T=r.n(_),A=r(230),C=r.n(A),E=r(8),L=r.n(E);function N(e,t,r,n){var i=L.a.unstable_batchedUpdates?function(e){L.a.unstable_batchedUpdates(r,e)}:r;return C()(e,t,i,n)}var P=r(10),O=r.n(P),R=function(e){var t=e.prefixCls,r=e.vertical,n=e.reverse,o=e.marks,a=e.dots,s=e.step,l=e.included,u=e.lowerBound,c=e.upperBound,h=e.max,p=e.min,f=e.dotStyle,m=e.activeDotStyle,v=h-p,g=function(e,t,r,n,i,o){y()(!r||n>0,"`Slider[step]` should be a positive number in order to make Slider[dots] work.");var a=Object.keys(t).map(parseFloat).sort(function(e,t){return e-t});if(r&&n)for(var s=i;s<=o;s+=n)-1===a.indexOf(s)&&a.push(s);return a}(0,o,a,s,p,h).map(function(e){var o,a=Math.abs(e-p)/v*100+"%",s=!l&&e===c||l&&e<=c&&e>=u,h=r?i()({},f,x()({},n?"top":"bottom",a)):i()({},f,x()({},n?"right":"left",a));s&&(h=i()({},h,m));var g=O()((o={},x()(o,t+"-dot",!0),x()(o,t+"-dot-active",s),x()(o,t+"-dot-reverse",n),o));return d.a.createElement("span",{className:g,style:h,key:e})});return d.a.createElement("div",{className:t+"-step"},g)};R.propTypes={prefixCls:v.a.string,activeDotStyle:v.a.object,dotStyle:v.a.object,min:v.a.number,max:v.a.number,upperBound:v.a.number,lowerBound:v.a.number,included:v.a.bool,dots:v.a.bool,step:v.a.number,marks:v.a.object,vertical:v.a.bool,reverse:v.a.bool};var D=R,F=function(e){var t=e.className,r=e.vertical,n=e.reverse,o=e.marks,a=e.included,s=e.upperBound,l=e.lowerBound,u=e.max,c=e.min,h=e.onClickLabel,p=Object.keys(o),f=u-c,m=p.map(parseFloat).sort(function(e,t){return e-t}).map(function(e){var u,p=o[e],m="object"===typeof p&&!d.a.isValidElement(p),v=m?p.label:p;if(!v&&0!==v)return null;var g=!a&&e===s||a&&e<=s&&e>=l,y=O()((u={},x()(u,t+"-text",!0),x()(u,t+"-text-active",g),u)),b=x()({marginBottom:"-50%"},n?"top":"bottom",(e-c)/f*100+"%"),w=x()({transform:"translateX(-50%)",msTransform:"translateX(-50%)"},n?"right":"left",n?(e-c/4)/f*100+"%":(e-c)/f*100+"%"),S=r?b:w,M=m?i()({},S,p.style):S;return d.a.createElement("span",{className:y,style:M,key:e,onMouseDown:function(t){return h(t,e)},onTouchStart:function(t){return h(t,e)}},v)});return d.a.createElement("div",{className:t},m)};F.propTypes={className:v.a.string,vertical:v.a.bool,reverse:v.a.bool,marks:v.a.object,included:v.a.bool,upperBound:v.a.number,lowerBound:v.a.number,max:v.a.number,min:v.a.number,onClickLabel:v.a.func};var k=F,I=function(e){function t(){var e,r,n,i;a()(this,t);for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];return r=n=c()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),n.state={clickFocused:!1},n.setHandleRef=function(e){n.handle=e},n.handleMouseUp=function(){document.activeElement===n.handle&&n.setClickFocus(!0)},n.handleMouseDown=function(){n.focus()},n.handleBlur=function(){n.setClickFocus(!1)},n.handleKeyDown=function(){n.setClickFocus(!1)},i=r,c()(n,i)}return p()(t,e),l()(t,[{key:"componentDidMount",value:function(){this.onMouseUpListener=N(document,"mouseup",this.handleMouseUp)}},{key:"componentWillUnmount",value:function(){this.onMouseUpListener&&this.onMouseUpListener.remove()}},{key:"setClickFocus",value:function(e){this.setState({clickFocused:e})}},{key:"clickFocus",value:function(){this.setClickFocus(!0),this.focus()}},{key:"focus",value:function(){this.handle.focus()}},{key:"blur",value:function(){this.handle.blur()}},{key:"render",value:function(){var e,t,r=this.props,n=r.prefixCls,o=r.vertical,a=r.reverse,s=r.offset,l=r.style,u=r.disabled,c=r.min,h=r.max,p=r.value,f=r.tabIndex,m=M()(r,["prefixCls","vertical","reverse","offset","style","disabled","min","max","value","tabIndex"]),v=O()(this.props.className,x()({},n+"-handle-click-focused",this.state.clickFocused)),g=o?(e={},x()(e,a?"top":"bottom",s+"%"),x()(e,a?"bottom":"top","auto"),x()(e,"transform","translateY(+50%)"),e):(t={},x()(t,a?"right":"left",s+"%"),x()(t,a?"left":"right","auto"),x()(t,"transform","translateX("+(a?"+":"-")+"50%)"),t),y=i()({},l,g),b=f||0;return(u||null===f)&&(b=null),d.a.createElement("div",i()({ref:this.setHandleRef,tabIndex:b},m,{className:v,style:y,onBlur:this.handleBlur,onKeyDown:this.handleKeyDown,onMouseDown:this.handleMouseDown,role:"slider","aria-valuemin":c,"aria-valuemax":h,"aria-valuenow":p,"aria-disabled":!!u}))}}]),t}(d.a.Component),B=I;I.propTypes={prefixCls:v.a.string,className:v.a.string,vertical:v.a.bool,offset:v.a.number,style:v.a.object,disabled:v.a.bool,min:v.a.number,max:v.a.number,value:v.a.number,tabIndex:v.a.number,reverse:v.a.bool};var U=r(90),V=r.n(U),j={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(e){var t=e.keyCode;if(e.altKey&&!e.ctrlKey||e.metaKey||t>=j.F1&&t<=j.F12)return!1;switch(t){case j.ALT:case j.CAPS_LOCK:case j.CONTEXT_MENU:case j.CTRL:case j.DOWN:case j.END:case j.ESC:case j.HOME:case j.INSERT:case j.LEFT:case j.MAC_FF_META:case j.META:case j.NUMLOCK:case j.NUM_CENTER:case j.PAGE_DOWN:case j.PAGE_UP:case j.PAUSE:case j.PRINT_SCREEN:case j.RIGHT:case j.SHIFT:case j.UP:case j.WIN_KEY:case j.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(e){if(e>=j.ZERO&&e<=j.NINE)return!0;if(e>=j.NUM_ZERO&&e<=j.NUM_MULTIPLY)return!0;if(e>=j.A&&e<=j.Z)return!0;if(-1!==window.navigation.userAgent.indexOf("WebKit")&&0===e)return!0;switch(e){case j.SPACE:case j.QUESTION_MARK:case j.NUM_PLUS:case j.NUM_MINUS:case j.NUM_PERIOD:case j.NUM_DIVISION:case j.SEMICOLON:case j.DASH:case j.EQUALS:case j.COMMA:case j.PERIOD:case j.SLASH:case j.APOSTROPHE:case j.SINGLE_QUOTE:case j.OPEN_SQUARE_BRACKET:case j.BACKSLASH:case j.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},z=j;function G(e,t){try{return Object.keys(t).some(function(r){return e.target===Object(E.findDOMNode)(t[r])})}catch(r){return!1}}function W(e,t){var r=t.min,n=t.max;return e<r||e>n}function H(e){return e.touches.length>1||"touchend"===e.type.toLowerCase()&&e.touches.length>0}function X(e,t){var r=t.marks,n=t.step,i=t.min,o=t.max,a=Object.keys(r).map(parseFloat);if(null!==n){var s=Math.floor((o-i)/n),l=Math.min((e-i)/n,s),u=Math.round(l)*n+i;a.push(u)}var c=a.map(function(t){return Math.abs(e-t)});return a[c.indexOf(Math.min.apply(Math,V()(c)))]}function q(e,t){return e?t.clientY:t.pageX}function Y(e,t){return e?t.touches[0].clientY:t.touches[0].pageX}function K(e,t){var r=t.getBoundingClientRect();return e?r.top+.5*r.height:window.pageXOffset+r.left+.5*r.width}function Q(e,t){var r=t.max,n=t.min;return e<=n?n:e>=r?r:e}function J(e,t){var r=t.step,n=isFinite(X(e,t))?X(e,t):0;return null===r?n:parseFloat(n.toFixed(function(e){var t=e.toString(),r=0;return t.indexOf(".")>=0&&(r=t.length-t.indexOf(".")-1),r}(r)))}function Z(e){e.stopPropagation(),e.preventDefault()}function $(e,t,r){var n="increase";switch(e.keyCode){case z.UP:n=t&&r?"decrease":"increase";break;case z.RIGHT:n=!t&&r?"decrease":"increase";break;case z.DOWN:n=t&&r?"increase":"decrease";break;case z.LEFT:n=!t&&r?"increase":"decrease";break;case z.END:return function(e,t){return t.max};case z.HOME:return function(e,t){return t.min};case z.PAGE_UP:return function(e,t){return e+2*t.step};case z.PAGE_DOWN:return function(e,t){return e-2*t.step};default:return}return function(e,t){return function(e,t,r){var n={increase:function(e,t){return e+t},decrease:function(e,t){return e-t}},i=n[e](Object.keys(r.marks).indexOf(JSON.stringify(t)),1),o=Object.keys(r.marks)[i];return r.step?n[e](t,r.step):Object.keys(r.marks).length&&r.marks[o]?r.marks[o]:t}(n,e,t)}}function ee(){}function te(e){var t,r;return r=t=function(e){function t(e){a()(this,t);var r=c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.onMouseDown=function(e){if(0===e.button){var t=r.props.vertical,n=q(t,e);if(G(e,r.handlesRefs)){var i=K(t,e.target);r.dragOffset=n-i,n=i}else r.dragOffset=0;r.removeDocumentEvents(),r.onStart(n),r.addDocumentMouseEvents()}},r.onTouchStart=function(e){if(!H(e)){var t=r.props.vertical,n=Y(t,e);if(G(e,r.handlesRefs)){var i=K(t,e.target);r.dragOffset=n-i,n=i}else r.dragOffset=0;r.onStart(n),r.addDocumentTouchEvents(),Z(e)}},r.onFocus=function(e){var t=r.props,n=t.onFocus,i=t.vertical;if(G(e,r.handlesRefs)){var o=K(i,e.target);r.dragOffset=0,r.onStart(o),Z(e),n&&n(e)}},r.onBlur=function(e){var t=r.props.onBlur;r.onEnd(),t&&t(e)},r.onMouseUp=function(){r.handlesRefs[r.prevMovedHandleIndex]&&r.handlesRefs[r.prevMovedHandleIndex].clickFocus()},r.onMouseMove=function(e){if(r.sliderRef){var t=q(r.props.vertical,e);r.onMove(e,t-r.dragOffset)}else r.onEnd()},r.onTouchMove=function(e){if(!H(e)&&r.sliderRef){var t=Y(r.props.vertical,e);r.onMove(e,t-r.dragOffset)}else r.onEnd()},r.onKeyDown=function(e){r.sliderRef&&G(e,r.handlesRefs)&&r.onKeyboard(e)},r.onClickMarkLabel=function(e,t){e.stopPropagation(),r.onChange({value:t}),r.setState({value:t},function(){return r.onEnd(!0)})},r.saveSlider=function(e){r.sliderRef=e};var n=e.step,i=e.max,o=e.min,s=!isFinite(i-o)||(i-o)%n===0;return y()(!n||Math.floor(n)!==n||s,"Slider[max] - Slider[min] (%s) should be a multiple of Slider[step] (%s)",i-o,n),r.handlesRefs={},r}return p()(t,e),l()(t,[{key:"componentDidMount",value:function(){this.document=this.sliderRef&&this.sliderRef.ownerDocument;var e=this.props,t=e.autoFocus,r=e.disabled;t&&!r&&this.focus()}},{key:"componentWillUnmount",value:function(){T()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentWillUnmount",this)&&T()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentWillUnmount",this).call(this),this.removeDocumentEvents()}},{key:"getSliderStart",value:function(){var e=this.sliderRef,t=this.props,r=t.vertical,n=t.reverse,i=e.getBoundingClientRect();return r?n?i.bottom:i.top:window.pageXOffset+(n?i.right:i.left)}},{key:"getSliderLength",value:function(){var e=this.sliderRef;if(!e)return 0;var t=e.getBoundingClientRect();return this.props.vertical?t.height:t.width}},{key:"addDocumentTouchEvents",value:function(){this.onTouchMoveListener=N(this.document,"touchmove",this.onTouchMove),this.onTouchUpListener=N(this.document,"touchend",this.onEnd)}},{key:"addDocumentMouseEvents",value:function(){this.onMouseMoveListener=N(this.document,"mousemove",this.onMouseMove),this.onMouseUpListener=N(this.document,"mouseup",this.onEnd)}},{key:"removeDocumentEvents",value:function(){this.onTouchMoveListener&&this.onTouchMoveListener.remove(),this.onTouchUpListener&&this.onTouchUpListener.remove(),this.onMouseMoveListener&&this.onMouseMoveListener.remove(),this.onMouseUpListener&&this.onMouseUpListener.remove()}},{key:"focus",value:function(){this.props.disabled||this.handlesRefs[0].focus()}},{key:"blur",value:function(){var e=this;this.props.disabled||Object.keys(this.handlesRefs).forEach(function(t){e.handlesRefs[t]&&e.handlesRefs[t].blur&&e.handlesRefs[t].blur()})}},{key:"calcValue",value:function(e){var t=this.props,r=t.vertical,n=t.min,i=t.max,o=Math.abs(Math.max(e,0)/this.getSliderLength());return r?(1-o)*(i-n)+n:o*(i-n)+n}},{key:"calcValueByPos",value:function(e){var t=(this.props.reverse?-1:1)*(e-this.getSliderStart());return this.trimAlignValue(this.calcValue(t))}},{key:"calcOffset",value:function(e){var t=this.props,r=t.min;return 100*((e-r)/(t.max-r))}},{key:"saveHandle",value:function(e,t){this.handlesRefs[e]=t}},{key:"render",value:function(){var e,r=this.props,n=r.prefixCls,o=r.className,a=r.marks,s=r.dots,l=r.step,u=r.included,c=r.disabled,h=r.vertical,p=r.reverse,f=r.min,m=r.max,v=r.children,g=r.maximumTrackStyle,y=r.style,b=r.railStyle,w=r.dotStyle,S=r.activeDotStyle,M=T()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).call(this),_=M.tracks,A=M.handles,C=O()(n,(e={},x()(e,n+"-with-marks",Object.keys(a).length),x()(e,n+"-disabled",c),x()(e,n+"-vertical",h),x()(e,o,o),e));return d.a.createElement("div",{ref:this.saveSlider,className:C,onTouchStart:c?ee:this.onTouchStart,onMouseDown:c?ee:this.onMouseDown,onMouseUp:c?ee:this.onMouseUp,onKeyDown:c?ee:this.onKeyDown,onFocus:c?ee:this.onFocus,onBlur:c?ee:this.onBlur,style:y},d.a.createElement("div",{className:n+"-rail",style:i()({},g,b)}),_,d.a.createElement(D,{prefixCls:n,vertical:h,reverse:p,marks:a,dots:s,step:l,included:u,lowerBound:this.getLowerBound(),upperBound:this.getUpperBound(),max:m,min:f,dotStyle:w,activeDotStyle:S}),A,d.a.createElement(k,{className:n+"-mark",onClickLabel:c?ee:this.onClickMarkLabel,vertical:h,marks:a,included:u,lowerBound:this.getLowerBound(),upperBound:this.getUpperBound(),max:m,min:f,reverse:p}),v)}}]),t}(e),t.displayName="ComponentEnhancer("+e.displayName+")",t.propTypes=i()({},e.propTypes,{min:v.a.number,max:v.a.number,step:v.a.number,marks:v.a.object,included:v.a.bool,className:v.a.string,prefixCls:v.a.string,disabled:v.a.bool,children:v.a.any,onBeforeChange:v.a.func,onChange:v.a.func,onAfterChange:v.a.func,handle:v.a.func,dots:v.a.bool,vertical:v.a.bool,style:v.a.object,reverse:v.a.bool,minimumTrackStyle:v.a.object,maximumTrackStyle:v.a.object,handleStyle:v.a.oneOfType([v.a.object,v.a.arrayOf(v.a.object)]),trackStyle:v.a.oneOfType([v.a.object,v.a.arrayOf(v.a.object)]),railStyle:v.a.object,dotStyle:v.a.object,activeDotStyle:v.a.object,autoFocus:v.a.bool,onFocus:v.a.func,onBlur:v.a.func}),t.defaultProps=i()({},e.defaultProps,{prefixCls:"rc-slider",className:"",min:0,max:100,step:1,marks:{},handle:function(e){var t=e.index,r=M()(e,["index"]);return delete r.dragging,null===r.value?null:d.a.createElement(B,i()({},r,{key:t}))},onBeforeChange:ee,onChange:ee,onAfterChange:ee,included:!0,disabled:!1,dots:!1,vertical:!1,reverse:!1,trackStyle:[{}],handleStyle:[{}],railStyle:{},dotStyle:{},activeDotStyle:{}}),r}var re=function(e){function t(e){a()(this,t);var r=c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.onEnd=function(e){var t=r.state.dragging;r.removeDocumentEvents(),(t||e)&&r.props.onAfterChange(r.getValue()),r.setState({dragging:!1})};var n=void 0!==e.defaultValue?e.defaultValue:e.min,i=void 0!==e.value?e.value:n;return r.state={value:r.trimAlignValue(i),dragging:!1},y()(!("minimumTrackStyle"in e),"minimumTrackStyle will be deprecated, please use trackStyle instead."),y()(!("maximumTrackStyle"in e),"maximumTrackStyle will be deprecated, please use railStyle instead."),r}return p()(t,e),l()(t,[{key:"componentDidUpdate",value:function(e,t){if("value"in this.props||"min"in this.props||"max"in this.props){var r=this.props,n=r.value,i=r.onChange,o=void 0!==n?n:t.value,a=this.trimAlignValue(o,this.props);a!==t.value&&(this.setState({value:a}),W(o,this.props)&&i(a))}}},{key:"onChange",value:function(e){var t=this.props,r=!("value"in t),n=e.value>this.props.max?i()({},e,{value:this.props.max}):e;r&&this.setState(n);var o=n.value;t.onChange(o)}},{key:"onStart",value:function(e){this.setState({dragging:!0});var t=this.props,r=this.getValue();t.onBeforeChange(r);var n=this.calcValueByPos(e);this.startValue=n,this.startPosition=e,n!==r&&(this.prevMovedHandleIndex=0,this.onChange({value:n}))}},{key:"onMove",value:function(e,t){Z(e);var r=this.state.value,n=this.calcValueByPos(t);n!==r&&this.onChange({value:n})}},{key:"onKeyboard",value:function(e){var t=this.props,r=t.reverse,n=$(e,t.vertical,r);if(n){Z(e);var i=this.state.value,o=n(i,this.props),a=this.trimAlignValue(o);if(a===i)return;this.onChange({value:a}),this.props.onAfterChange(a),this.onEnd()}}},{key:"getValue",value:function(){return this.state.value}},{key:"getLowerBound",value:function(){return this.props.min}},{key:"getUpperBound",value:function(){return this.state.value}},{key:"trimAlignValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null===e)return null;var r=i()({},this.props,t);return J(Q(e,r),r)}},{key:"render",value:function(){var e=this,t=this.props,r=t.prefixCls,n=t.vertical,o=t.included,a=t.disabled,s=t.minimumTrackStyle,l=t.trackStyle,u=t.handleStyle,c=t.tabIndex,h=t.min,p=t.max,f=t.reverse,m=t.handle,v=this.state,g=v.value,y=v.dragging,b=this.calcOffset(g),x=m({className:r+"-handle",prefixCls:r,vertical:n,offset:b,value:g,dragging:y,disabled:a,min:h,max:p,reverse:f,index:0,tabIndex:c,style:u[0]||u,ref:function(t){return e.saveHandle(0,t)}}),S=l[0]||l;return{tracks:d.a.createElement(w,{className:r+"-track",vertical:n,included:o,offset:0,reverse:f,length:b,style:i()({},s,S)}),handles:x}}}]),t}(d.a.Component);re.propTypes={defaultValue:v.a.number,value:v.a.number,disabled:v.a.bool,autoFocus:v.a.bool,tabIndex:v.a.number,reverse:v.a.bool,min:v.a.number,max:v.a.number};var ne=te(re),ie=r(85),oe=r(231),ae=r.n(oe),se=function(e){var t=e.value,r=e.handle,n=e.bounds,i=e.props,o=i.allowCross,a=i.pushable,s=Number(a),l=Q(t,i),u=l;return o||null==r||void 0===n||(r>0&&l<=n[r-1]+s&&(u=n[r-1]+s),r<n.length-1&&l>=n[r+1]-s&&(u=n[r+1]-s)),J(u,i)},le=function(e){function t(e){a()(this,t);var r=c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.onEnd=function(e){var t=r.state.handle;r.removeDocumentEvents(),(null!==t||e)&&r.props.onAfterChange(r.getValue()),r.setState({handle:null})};var n=e.count,i=e.min,o=e.max,s=Array.apply(void 0,V()(Array(n+1))).map(function(){return i}),l="defaultValue"in e?e.defaultValue:s,u=(void 0!==e.value?e.value:l).map(function(t,r){return se({value:t,handle:r,props:e})}),h=u[0]===o?0:u.length-1;return r.state={handle:null,recent:h,bounds:u},r}return p()(t,e),l()(t,[{key:"componentDidUpdate",value:function(e,t){var r=this;if(("value"in this.props||"min"in this.props||"max"in this.props)&&(this.props.min!==e.min||this.props.max!==e.max||!ae()(this.props.value,e.value))){var n=this.props,i=n.onChange,o=n.value||t.bounds;if(o.some(function(e){return W(e,r.props)}))i(o.map(function(e){return Q(e,r.props)}))}}},{key:"onChange",value:function(e){var t=this.props;if(!("value"in t))this.setState(e);else{var r={};["handle","recent"].forEach(function(t){void 0!==e[t]&&(r[t]=e[t])}),Object.keys(r).length&&this.setState(r)}var n=i()({},this.state,e).bounds;t.onChange(n)}},{key:"onStart",value:function(e){var t=this.props,r=this.state,n=this.getValue();t.onBeforeChange(n);var i=this.calcValueByPos(e);this.startValue=i,this.startPosition=e;var o=this.getClosestBound(i);if(this.prevMovedHandleIndex=this.getBoundNeedMoving(i,o),this.setState({handle:this.prevMovedHandleIndex,recent:this.prevMovedHandleIndex}),i!==n[this.prevMovedHandleIndex]){var a=[].concat(V()(r.bounds));a[this.prevMovedHandleIndex]=i,this.onChange({bounds:a})}}},{key:"onMove",value:function(e,t){Z(e);var r=this.state,n=this.calcValueByPos(t);n!==r.bounds[r.handle]&&this.moveTo(n)}},{key:"onKeyboard",value:function(e){var t=this.props,r=t.reverse,n=$(e,t.vertical,r);if(n){Z(e);var i=this.state,o=this.props,a=i.bounds,s=i.handle,l=a[null===s?i.recent:s],u=n(l,o),c=se({value:u,handle:s,bounds:i.bounds,props:o});if(c===l)return;this.moveTo(c,!0)}}},{key:"getValue",value:function(){return this.state.bounds}},{key:"getClosestBound",value:function(e){for(var t=this.state.bounds,r=0,n=1;n<t.length-1;++n)e>=t[n]&&(r=n);return Math.abs(t[r+1]-e)<Math.abs(t[r]-e)&&(r+=1),r}},{key:"getBoundNeedMoving",value:function(e,t){var r=this.state,n=r.bounds,i=r.recent,o=t,a=n[t+1]===n[t];return a&&n[i]===n[t]&&(o=i),a&&e!==n[t+1]&&(o=e<n[t+1]?t:t+1),o}},{key:"getLowerBound",value:function(){return this.state.bounds[0]}},{key:"getUpperBound",value:function(){var e=this.state.bounds;return e[e.length-1]}},{key:"getPoints",value:function(){var e=this.props,t=e.marks,r=e.step,n=e.min,o=e.max,a=this._getPointsCache;if(!a||a.marks!==t||a.step!==r){var s=i()({},t);if(null!==r)for(var l=n;l<=o;l+=r)s[l]=l;var u=Object.keys(s).map(parseFloat);u.sort(function(e,t){return e-t}),this._getPointsCache={marks:t,step:r,points:u}}return this._getPointsCache.points}},{key:"moveTo",value:function(e,t){var r=this,n=this.state,i=this.props,o=[].concat(V()(n.bounds)),a=null===n.handle?n.recent:n.handle;o[a]=e;var s=a;!1!==i.pushable?this.pushSurroundingHandles(o,s):i.allowCross&&(o.sort(function(e,t){return e-t}),s=o.indexOf(e)),this.onChange({recent:s,handle:s,bounds:o}),t&&(this.props.onAfterChange(o),this.setState({},function(){r.handlesRefs[s].focus()}),this.onEnd())}},{key:"pushSurroundingHandles",value:function(e,t){var r=e[t],n=this.props.pushable;n=Number(n);var i=0;if(e[t+1]-r<n&&(i=1),r-e[t-1]<n&&(i=-1),0!==i){var o=t+i,a=i*(e[o]-r);this.pushHandle(e,o,i,n-a)||(e[t]=e[o]-i*n)}}},{key:"pushHandle",value:function(e,t,r,n){for(var i=e[t],o=e[t];r*(o-i)<n;){if(!this.pushHandleOnePoint(e,t,r))return e[t]=i,!1;o=e[t]}return!0}},{key:"pushHandleOnePoint",value:function(e,t,r){var n=this.getPoints(),i=n.indexOf(e[t])+r;if(i>=n.length||i<0)return!1;var o=t+r,a=n[i],s=this.props.pushable,l=r*(e[o]-a);return!!this.pushHandle(e,o,r,s-l)&&(e[t]=a,!0)}},{key:"trimAlignValue",value:function(e){var t=this.state,r=t.handle,n=t.bounds;return se({value:e,handle:r,bounds:n,props:this.props})}},{key:"render",value:function(){var e=this,t=this.state,r=t.handle,n=t.bounds,i=this.props,o=i.prefixCls,a=i.vertical,s=i.included,l=i.disabled,u=i.min,c=i.max,h=i.reverse,p=i.handle,f=i.trackStyle,m=i.handleStyle,v=i.tabIndex,g=n.map(function(t){return e.calcOffset(t)}),y=o+"-handle",b=n.map(function(t,n){var i,s=v[n]||0;return(l||null===v[n])&&(s=null),p({className:O()((i={},x()(i,y,!0),x()(i,y+"-"+(n+1),!0),i)),prefixCls:o,vertical:a,offset:g[n],value:t,dragging:r===n,index:n,tabIndex:s,min:u,max:c,reverse:h,disabled:l,style:m[n],ref:function(t){return e.saveHandle(n,t)}})});return{tracks:n.slice(0,-1).map(function(e,t){var r,n=t+1,i=O()((r={},x()(r,o+"-track",!0),x()(r,o+"-track-"+n,!0),r));return d.a.createElement(w,{className:i,vertical:a,reverse:h,included:s,offset:g[n-1],length:g[n]-g[n-1],style:f[t],key:n})}),handles:b}}}],[{key:"getDerivedStateFromProps",value:function(e,t){if("value"in e||"min"in e||"max"in e){var r=(e.value||t.bounds).map(function(r,n){return se({value:r,handle:n,bounds:t.bounds,props:e})});return r.length===t.bounds.length&&r.every(function(e,r){return e===t.bounds[r]})?null:i()({},t,{bounds:r})}return null}}]),t}(d.a.Component);le.displayName="Range",le.propTypes={autoFocus:v.a.bool,defaultValue:v.a.arrayOf(v.a.number),value:v.a.arrayOf(v.a.number),count:v.a.number,pushable:v.a.oneOfType([v.a.bool,v.a.number]),allowCross:v.a.bool,disabled:v.a.bool,reverse:v.a.bool,tabIndex:v.a.arrayOf(v.a.number),min:v.a.number,max:v.a.number},le.defaultProps={count:1,allowCross:!0,pushable:!1,tabIndex:[]},Object(ie.a)(le);var ue=te(le),ce=r(16),he=r.n(ce),pe=r(4),fe=r.n(pe);function de(e,t){for(var r=t;r;){if(r===e)return!0;r=r.parentNode}return!1}var me=r(38),ve=r.n(me);function ge(e){return(ge="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ye(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function be(e,t){return!t||"object"!==ge(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xe(e){return(xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function we(e,t){return(we=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Se=function(e){function t(){var e,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(r=be(this,(e=xe(t)).call.apply(e,[this].concat(i)))).removeContainer=function(){r.container&&(L.a.unmountComponentAtNode(r.container),r.container.parentNode.removeChild(r.container),r.container=null)},r.renderComponent=function(e,t){var n=r.props,i=n.visible,o=n.getComponent,a=n.forceRender,s=n.getContainer,l=n.parent;(i||l._component||a)&&(r.container||(r.container=s()),L.a.unstable_renderSubtreeIntoContainer(l,o(e),r.container,function(){t&&t.call(this)}))},r}var r,n,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&we(e,t)}(t,d.a.Component),r=t,(n=[{key:"componentDidMount",value:function(){this.props.autoMount&&this.renderComponent()}},{key:"componentDidUpdate",value:function(){this.props.autoMount&&this.renderComponent()}},{key:"componentWillUnmount",value:function(){this.props.autoDestroy&&this.removeContainer()}},{key:"render",value:function(){return this.props.children({renderComponent:this.renderComponent,removeContainer:this.removeContainer})}}])&&ye(r.prototype,n),i&&ye(r,i),t}();function Me(e){return(Me="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Te(e,t){return!t||"object"!==Me(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ae(e){return(Ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ce(e,t){return(Ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Se.propTypes={autoMount:ve.a.bool,autoDestroy:ve.a.bool,visible:ve.a.bool,forceRender:ve.a.bool,parent:ve.a.any,getComponent:ve.a.func.isRequired,getContainer:ve.a.func.isRequired,children:ve.a.func.isRequired},Se.defaultProps={autoMount:!0,autoDestroy:!0,forceRender:!1};var Ee=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Te(this,Ae(t).apply(this,arguments))}var r,n,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ce(e,t)}(t,d.a.Component),r=t,(n=[{key:"componentDidMount",value:function(){this.createContainer()}},{key:"componentDidUpdate",value:function(e){var t=this.props.didUpdate;t&&t(e)}},{key:"componentWillUnmount",value:function(){this.removeContainer()}},{key:"createContainer",value:function(){this._container=this.props.getContainer(),this.forceUpdate()}},{key:"removeContainer",value:function(){this._container&&this._container.parentNode.removeChild(this._container)}},{key:"render",value:function(){return this._container?L.a.createPortal(this.props.children,this._container):null}}])&&_e(r.prototype,n),i&&_e(r,i),t}();function Le(e,t,r){return r?e[0]===t[0]:e[0]===t[0]&&e[1]===t[1]}function Ne(e,t){this[e]=t}Ee.propTypes={getContainer:ve.a.func.isRequired,children:ve.a.node.isRequired,didUpdate:ve.a.func};var Pe,Oe=r(31),Re=r.n(Oe);function De(e){return(De="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ke(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}var Ie={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-",O:"-o-"};function Be(){if(void 0!==Pe)return Pe;Pe="";var e=document.createElement("p").style;for(var t in Ie)t+"Transform"in e&&(Pe=t);return Pe}function Ue(){return Be()?"".concat(Be(),"TransitionProperty"):"transitionProperty"}function Ve(){return Be()?"".concat(Be(),"Transform"):"transform"}function je(e,t){var r=Ue();r&&(e.style[r]=t,"transitionProperty"!==r&&(e.style.transitionProperty=t))}function ze(e,t){var r=Ve();r&&(e.style[r]=t,"transform"!==r&&(e.style.transform=t))}var Ge,We=/matrix\((.*)\)/,He=/matrix3d\((.*)\)/;function Xe(e){var t=e.style.display;e.style.display="none",e.offsetHeight,e.style.display=t}function qe(e,t,r){var n=r;if("object"!==De(t))return"undefined"!==typeof n?("number"===typeof n&&(n="".concat(n,"px")),void(e.style[t]=n)):Ge(e,t);for(var i in t)t.hasOwnProperty(i)&&qe(e,i,t[i])}function Ye(e,t){var r=e["page".concat(t?"Y":"X","Offset")],n="scroll".concat(t?"Top":"Left");if("number"!==typeof r){var i=e.document;"number"!==typeof(r=i.documentElement[n])&&(r=i.body[n])}return r}function Ke(e){return Ye(e)}function Qe(e){return Ye(e,!0)}function Je(e){var t=function(e){var t,r,n,i=e.ownerDocument,o=i.body,a=i&&i.documentElement;return r=(t=e.getBoundingClientRect()).left,n=t.top,{left:r-=a.clientLeft||o.clientLeft||0,top:n-=a.clientTop||o.clientTop||0}}(e),r=e.ownerDocument,n=r.defaultView||r.parentWindow;return t.left+=Ke(n),t.top+=Qe(n),t}function Ze(e){return null!==e&&void 0!==e&&e==e.window}function $e(e){return Ze(e)?e.document:9===e.nodeType?e:e.ownerDocument}var et=new RegExp("^(".concat(/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,")(?!px)[a-z%]+$"),"i"),tt=/^(top|right|bottom|left)$/,rt="currentStyle",nt="runtimeStyle",it="left",ot="px";function at(e,t){return"left"===e?t.useCssRight?"right":e:t.useCssBottom?"bottom":e}function st(e){return"left"===e?"right":"right"===e?"left":"top"===e?"bottom":"bottom"===e?"top":void 0}function lt(e,t,r){"static"===qe(e,"position")&&(e.style.position="relative");var n=-999,i=-999,o=at("left",r),a=at("top",r),s=st(o),l=st(a);"left"!==o&&(n=999),"top"!==a&&(i=999);var u,c="",h=Je(e);("left"in t||"top"in t)&&(c=(u=e).style.transitionProperty||u.style[Ue()]||"",je(e,"none")),"left"in t&&(e.style[s]="",e.style[o]="".concat(n,"px")),"top"in t&&(e.style[l]="",e.style[a]="".concat(i,"px")),Xe(e);var p=Je(e),f={};for(var d in t)if(t.hasOwnProperty(d)){var m=at(d,r),v="left"===d?n:i,g=h[d]-p[d];f[m]=m===d?v+g:v-g}qe(e,f),Xe(e),("left"in t||"top"in t)&&je(e,c);var y={};for(var b in t)if(t.hasOwnProperty(b)){var x=at(b,r),w=t[b]-h[b];y[x]=b===x?f[x]+w:f[x]-w}qe(e,y)}function ut(e,t){var r=Je(e),n=function(e){var t=window.getComputedStyle(e,null),r=t.getPropertyValue("transform")||t.getPropertyValue(Ve());if(r&&"none"!==r){var n=r.replace(/[^0-9\-.,]/g,"").split(",");return{x:parseFloat(n[12]||n[4],0),y:parseFloat(n[13]||n[5],0)}}return{x:0,y:0}}(e),i={x:n.x,y:n.y};"left"in t&&(i.x=n.x+t.left-r.left),"top"in t&&(i.y=n.y+t.top-r.top),function(e,t){var r=window.getComputedStyle(e,null),n=r.getPropertyValue("transform")||r.getPropertyValue(Ve());if(n&&"none"!==n){var i,o=n.match(We);o?((i=(o=o[1]).split(",").map(function(e){return parseFloat(e,10)}))[4]=t.x,i[5]=t.y,ze(e,"matrix(".concat(i.join(","),")"))):((i=n.match(He)[1].split(",").map(function(e){return parseFloat(e,10)}))[12]=t.x,i[13]=t.y,ze(e,"matrix3d(".concat(i.join(","),")")))}else ze(e,"translateX(".concat(t.x,"px) translateY(").concat(t.y,"px) translateZ(0)"))}(e,i)}function ct(e,t){for(var r=0;r<e.length;r++)t(e[r])}function ht(e){return"border-box"===Ge(e,"boxSizing")}"undefined"!==typeof window&&(Ge=window.getComputedStyle?function(e,t,r){var n=r,i="",o=$e(e);return(n=n||o.defaultView.getComputedStyle(e,null))&&(i=n.getPropertyValue(t)||n[t]),i}:function(e,t){var r=e[rt]&&e[rt][t];if(et.test(r)&&!tt.test(t)){var n=e.style,i=n[it],o=e[nt][it];e[nt][it]=e[rt][it],n[it]="fontSize"===t?"1em":r||0,r=n.pixelLeft+ot,n[it]=i,e[nt][it]=o}return""===r?"auto":r});var pt=["margin","border","padding"],ft=-1,dt=2,mt=1;function vt(e,t,r){var n,i,o,a=0;for(i=0;i<t.length;i++)if(n=t[i])for(o=0;o<r.length;o++){var s=void 0;s="border"===n?"".concat(n).concat(r[o],"Width"):n+r[o],a+=parseFloat(Ge(e,s))||0}return a}var gt={getParent:function(e){var t=e;do{t=11===t.nodeType&&t.host?t.host:t.parentNode}while(t&&1!==t.nodeType&&9!==t.nodeType);return t}};function yt(e,t,r){var n=r;if(Ze(e))return"width"===t?gt.viewportWidth(e):gt.viewportHeight(e);if(9===e.nodeType)return"width"===t?gt.docWidth(e):gt.docHeight(e);var i="width"===t?["Left","Right"]:["Top","Bottom"],o="width"===t?e.getBoundingClientRect().width:e.getBoundingClientRect().height,a=(Ge(e),ht(e)),s=0;(null===o||void 0===o||o<=0)&&(o=void 0,(null===(s=Ge(e,t))||void 0===s||Number(s)<0)&&(s=e.style[t]||0),s=parseFloat(s)||0),void 0===n&&(n=a?mt:ft);var l=void 0!==o||a,u=o||s;return n===ft?l?u-vt(e,["border","padding"],i):s:l?n===mt?u:u+(n===dt?-vt(e,["border"],i):vt(e,["margin"],i)):s+vt(e,pt.slice(n),i)}ct(["Width","Height"],function(e){gt["doc".concat(e)]=function(t){var r=t.document;return Math.max(r.documentElement["scroll".concat(e)],r.body["scroll".concat(e)],gt["viewport".concat(e)](r))},gt["viewport".concat(e)]=function(t){var r="client".concat(e),n=t.document,i=n.body,o=n.documentElement[r];return"CSS1Compat"===n.compatMode&&o||i&&i[r]||o}});var bt={position:"absolute",visibility:"hidden",display:"block"};function xt(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,i=t[0];return 0!==i.offsetWidth?n=yt.apply(void 0,t):function(e,t,r){var n,i={},o=e.style;for(n in t)t.hasOwnProperty(n)&&(i[n]=o[n],o[n]=t[n]);for(n in r.call(e),t)t.hasOwnProperty(n)&&(o[n]=i[n])}(i,bt,function(){n=yt.apply(void 0,t)}),n}function wt(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}ct(["width","height"],function(e){var t=e.charAt(0).toUpperCase()+e.slice(1);gt["outer".concat(t)]=function(t,r){return t&&xt(t,e,r?0:mt)};var r="width"===e?["Left","Right"]:["Top","Bottom"];gt[e]=function(t,n){var i=n;if(void 0===i)return t&&xt(t,e,ft);if(t){Ge(t);return ht(t)&&(i+=vt(t,["padding","border"],r)),qe(t,e,i)}}});var St={getWindow:function(e){if(e&&e.document&&e.setTimeout)return e;var t=e.ownerDocument||e;return t.defaultView||t.parentWindow},getDocument:$e,offset:function(e,t,r){if("undefined"===typeof t)return Je(e);!function(e,t,r){if(r.ignoreShake){var n=Je(e),i=n.left.toFixed(0),o=n.top.toFixed(0),a=t.left.toFixed(0),s=t.top.toFixed(0);if(i===a&&o===s)return}r.useCssRight||r.useCssBottom?lt(e,t,r):r.useCssTransform&&Ve()in document.body.style?ut(e,t):lt(e,t,r)}(e,t,r||{})},isWindow:Ze,each:ct,css:qe,clone:function(e){var t,r={};for(t in e)e.hasOwnProperty(t)&&(r[t]=e[t]);if(e.overflow)for(t in e)e.hasOwnProperty(t)&&(r.overflow[t]=e.overflow[t]);return r},mix:wt,getWindowScrollLeft:function(e){return Ke(e)},getWindowScrollTop:function(e){return Qe(e)},merge:function(){for(var e={},t=0;t<arguments.length;t++)St.mix(e,t<0||arguments.length<=t?void 0:arguments[t]);return e},viewportWidth:0,viewportHeight:0};wt(St,gt);var Mt=St.getParent;function _t(e){if(St.isWindow(e)||9===e.nodeType)return null;var t,r=St.getDocument(e).body,n=St.css(e,"position");if(!("fixed"===n||"absolute"===n))return"html"===e.nodeName.toLowerCase()?null:Mt(e);for(t=Mt(e);t&&t!==r;t=Mt(t))if("static"!==(n=St.css(t,"position")))return t;return null}var Tt=St.getParent;function At(e){for(var t={left:0,right:1/0,top:0,bottom:1/0},r=_t(e),n=St.getDocument(e),i=n.defaultView||n.parentWindow,o=n.body,a=n.documentElement;r;){if(-1!==navigator.userAgent.indexOf("MSIE")&&0===r.clientWidth||r===o||r===a||"visible"===St.css(r,"overflow")){if(r===o||r===a)break}else{var s=St.offset(r);s.left+=r.clientLeft,s.top+=r.clientTop,t.top=Math.max(t.top,s.top),t.right=Math.min(t.right,s.left+r.clientWidth),t.bottom=Math.min(t.bottom,s.top+r.clientHeight),t.left=Math.max(t.left,s.left)}r=_t(r)}var l=null;St.isWindow(e)||9===e.nodeType||(l=e.style.position,"absolute"===St.css(e,"position")&&(e.style.position="fixed"));var u=St.getWindowScrollLeft(i),c=St.getWindowScrollTop(i),h=St.viewportWidth(i),p=St.viewportHeight(i),f=a.scrollWidth,d=a.scrollHeight,m=window.getComputedStyle(o);if("hidden"===m.overflowX&&(f=i.innerWidth),"hidden"===m.overflowY&&(d=i.innerHeight),e.style&&(e.style.position=l),function(e){if(St.isWindow(e)||9===e.nodeType)return!1;var t=St.getDocument(e).body,r=null;for(r=Tt(e);r&&r!==t;r=Tt(r))if("fixed"===St.css(r,"position"))return!0;return!1}(e))t.left=Math.max(t.left,u),t.top=Math.max(t.top,c),t.right=Math.min(t.right,u+h),t.bottom=Math.min(t.bottom,c+p);else{var v=Math.max(f,u+h);t.right=Math.min(t.right,v);var g=Math.max(d,c+p);t.bottom=Math.min(t.bottom,g)}return t.top>=0&&t.left>=0&&t.bottom>t.top&&t.right>t.left?t:null}function Ct(e){var t,r,n;if(St.isWindow(e)||9===e.nodeType){var i=St.getWindow(e);t={left:St.getWindowScrollLeft(i),top:St.getWindowScrollTop(i)},r=St.viewportWidth(i),n=St.viewportHeight(i)}else t=St.offset(e),r=St.outerWidth(e),n=St.outerHeight(e);return t.width=r,t.height=n,t}function Et(e,t){var r=t.charAt(0),n=t.charAt(1),i=e.width,o=e.height,a=e.left,s=e.top;return"c"===r?s+=o/2:"b"===r&&(s+=o),"c"===n?a+=i/2:"r"===n&&(a+=i),{left:a,top:s}}function Lt(e,t,r,n,i){var o=Et(t,r[1]),a=Et(e,r[0]),s=[a.left-o.left,a.top-o.top];return{left:Math.round(e.left-s[0]+n[0]-i[0]),top:Math.round(e.top-s[1]+n[1]-i[1])}}function Nt(e,t,r){return e.left<r.left||e.left+t.width>r.right}function Pt(e,t,r){return e.top<r.top||e.top+t.height>r.bottom}function Ot(e,t,r){var n=[];return St.each(e,function(e){n.push(e.replace(t,function(e){return r[e]}))}),n}function Rt(e,t){return e[t]=-e[t],e}function Dt(e,t){return(/%$/.test(e)?parseInt(e.substring(0,e.length-1),10)/100*t:parseInt(e,10))||0}function Ft(e,t){e[0]=Dt(e[0],t.width),e[1]=Dt(e[1],t.height)}function kt(e,t,r,n){var i=r.points,o=r.offset||[0,0],a=r.targetOffset||[0,0],s=r.overflow,l=r.source||e;o=[].concat(o),a=[].concat(a),s=s||{};var u={},c=0,h=At(l),p=Ct(l);Ft(o,p),Ft(a,t);var f=Lt(p,t,i,o,a),d=St.merge(p,f);if(h&&(s.adjustX||s.adjustY)&&n){if(s.adjustX&&Nt(f,p,h)){var m=Ot(i,/[lr]/gi,{l:"r",r:"l"}),v=Rt(o,0),g=Rt(a,0);(function(e,t,r){return e.left>r.right||e.left+t.width<r.left})(Lt(p,t,m,v,g),p,h)||(c=1,i=m,o=v,a=g)}if(s.adjustY&&Pt(f,p,h)){var y=Ot(i,/[tb]/gi,{t:"b",b:"t"}),b=Rt(o,1),x=Rt(a,1);(function(e,t,r){return e.top>r.bottom||e.top+t.height<r.top})(Lt(p,t,y,b,x),p,h)||(c=1,i=y,o=b,a=x)}c&&(f=Lt(p,t,i,o,a),St.mix(d,f));var w=Nt(f,p,h),S=Pt(f,p,h);(w||S)&&(i=r.points,o=r.offset||[0,0],a=r.targetOffset||[0,0]),u.adjustX=s.adjustX&&w,u.adjustY=s.adjustY&&S,(u.adjustX||u.adjustY)&&(d=function(e,t,r,n){var i=St.clone(e),o={width:t.width,height:t.height};return n.adjustX&&i.left<r.left&&(i.left=r.left),n.resizeWidth&&i.left>=r.left&&i.left+o.width>r.right&&(o.width-=i.left+o.width-r.right),n.adjustX&&i.left+o.width>r.right&&(i.left=Math.max(r.right-o.width,r.left)),n.adjustY&&i.top<r.top&&(i.top=r.top),n.resizeHeight&&i.top>=r.top&&i.top+o.height>r.bottom&&(o.height-=i.top+o.height-r.bottom),n.adjustY&&i.top+o.height>r.bottom&&(i.top=Math.max(r.bottom-o.height,r.top)),St.mix(i,o)}(f,p,h,u))}return d.width!==p.width&&St.css(l,"width",St.width(l)+d.width-p.width),d.height!==p.height&&St.css(l,"height",St.height(l)+d.height-p.height),St.offset(l,{left:d.left,top:d.top},{useCssRight:r.useCssRight,useCssBottom:r.useCssBottom,useCssTransform:r.useCssTransform,ignoreShake:r.ignoreShake}),{points:i,offset:o,targetOffset:a,overflow:u}}function It(e,t,r){var n=r.target||t;return kt(e,Ct(n),r,!function(e){var t=At(e),r=Ct(e);return!t||r.left+r.width<=t.left||r.top+r.height<=t.top||r.left>=t.right||r.top>=t.bottom}(n))}function Bt(e,t,r){var n,i,o=St.getDocument(e),a=o.defaultView||o.parentWindow,s=St.getWindowScrollLeft(a),l=St.getWindowScrollTop(a),u=St.viewportWidth(a),c=St.viewportHeight(a);n="pageX"in t?t.pageX:s+t.clientX,i="pageY"in t?t.pageY:l+t.clientY;var h=n>=0&&n<=s+u&&i>=0&&i<=l+c;return kt(e,{left:n,top:i,width:0,height:0},function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ke(r,!0).forEach(function(t){Fe(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ke(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},r,{points:[r.points[0],"cc"]}),h)}It.__getOffsetParent=_t,It.__getVisibleRectForElement=At;function Ut(e){return e&&"object"===typeof e&&e.window===e}function Vt(e,t){var r=Math.floor(e),n=Math.floor(t);return Math.abs(r-n)<=1}function jt(e){return"function"===typeof e&&e?e():null}function zt(e){return"object"===typeof e&&e?e:null}var Gt=function(e){function t(){var e,r,n,i;a()(this,t);for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];return r=n=c()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),n.forceAlign=function(){var e=n.props,t=e.disabled,r=e.target,i=e.align,o=e.onAlign;if(!t&&r){var a=L.a.findDOMNode(n),s=void 0,l=jt(r),u=zt(r),c=document.activeElement;l?s=It(a,l,i):u&&(s=Bt(a,u,i)),function(e,t){e!==document.activeElement&&de(t,e)&&e.focus()}(c,a),o&&o(a,s)}},i=r,c()(n,i)}return p()(t,e),l()(t,[{key:"componentDidMount",value:function(){var e=this.props;this.forceAlign(),!e.disabled&&e.monitorWindowResize&&this.startMonitorWindowResize()}},{key:"componentDidUpdate",value:function(e){var t,r,n=!1,i=this.props;if(!i.disabled){var o=L.a.findDOMNode(this),a=o?o.getBoundingClientRect():null;if(e.disabled)n=!0;else{var s=jt(e.target),l=jt(i.target),u=zt(e.target),c=zt(i.target);Ut(s)&&Ut(l)?n=!1:(s!==l||s&&!l&&c||u&&c&&l||c&&!((t=u)===(r=c)||t&&r&&("pageX"in r&&"pageY"in r?t.pageX===r.pageX&&t.pageY===r.pageY:"clientX"in r&&"clientY"in r&&t.clientX===r.clientX&&t.clientY===r.clientY)))&&(n=!0);var h=this.sourceRect||{};n||!o||Vt(h.width,a.width)&&Vt(h.height,a.height)||(n=!0)}this.sourceRect=a}n&&this.forceAlign(),i.monitorWindowResize&&!i.disabled?this.startMonitorWindowResize():this.stopMonitorWindowResize()}},{key:"componentWillUnmount",value:function(){this.stopMonitorWindowResize()}},{key:"startMonitorWindowResize",value:function(){this.resizeHandler||(this.bufferMonitor=function(e,t){var r=void 0;function n(){r&&(clearTimeout(r),r=null)}function i(){n(),r=setTimeout(e,t)}return i.clear=n,i}(this.forceAlign,this.props.monitorBufferTime),this.resizeHandler=N(window,"resize",this.bufferMonitor))}},{key:"stopMonitorWindowResize",value:function(){this.resizeHandler&&(this.bufferMonitor.clear(),this.resizeHandler.remove(),this.resizeHandler=null)}},{key:"render",value:function(){var e=this,t=this.props,r=t.childrenProps,n=t.children,i=d.a.Children.only(n);if(r){var o={};return Object.keys(r).forEach(function(t){o[t]=e.props[r[t]]}),d.a.cloneElement(i,o)}return i}}]),t}(f.Component);Gt.propTypes={childrenProps:Re.a.object,align:Re.a.object.isRequired,target:Re.a.oneOfType([Re.a.func,Re.a.shape({clientX:Re.a.number,clientY:Re.a.number,pageX:Re.a.number,pageY:Re.a.number})]),onAlign:Re.a.func,monitorBufferTime:Re.a.number,monitorWindowResize:Re.a.bool,disabled:Re.a.bool,children:Re.a.any},Gt.defaultProps={target:function(){return window},monitorBufferTime:50,monitorWindowResize:!1,disabled:!1};var Wt=Gt,Ht=r(23),Xt=r.n(Ht);function qt(e){var t=[];return d.a.Children.forEach(e,function(e){t.push(e)}),t}function Yt(e,t){var r=null;return e&&e.forEach(function(e){r||e&&e.key===t&&(r=e)}),r}function Kt(e,t,r){var n=null;return e&&e.forEach(function(e){if(e&&e.key===t&&e.props[r]){if(n)throw new Error("two child with same key for <rc-animate> children");n=e}}),n}var Qt=r(121),Jt=r.n(Qt),Zt={transitionstart:{transition:"transitionstart",WebkitTransition:"webkitTransitionStart",MozTransition:"mozTransitionStart",OTransition:"oTransitionStart",msTransition:"MSTransitionStart"},animationstart:{animation:"animationstart",WebkitAnimation:"webkitAnimationStart",MozAnimation:"mozAnimationStart",OAnimation:"oAnimationStart",msAnimation:"MSAnimationStart"}},$t={transitionend:{transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"mozTransitionEnd",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd"},animationend:{animation:"animationend",WebkitAnimation:"webkitAnimationEnd",MozAnimation:"mozAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd"}},er=[],tr=[];function rr(e,t,r){e.addEventListener(t,r,!1)}function nr(e,t,r){e.removeEventListener(t,r,!1)}"undefined"!==typeof window&&"undefined"!==typeof document&&function(){var e=document.createElement("div").style;function t(t,r){for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];for(var o in i)if(o in e){r.push(i[o]);break}}}"AnimationEvent"in window||(delete Zt.animationstart.animation,delete $t.animationend.animation),"TransitionEvent"in window||(delete Zt.transitionstart.transition,delete $t.transitionend.transition),t(Zt,er),t($t,tr)}();var ir={startEvents:er,addStartEventListener:function(e,t){0!==er.length?er.forEach(function(r){rr(e,r,t)}):window.setTimeout(t,0)},removeStartEventListener:function(e,t){0!==er.length&&er.forEach(function(r){nr(e,r,t)})},endEvents:tr,addEndEventListener:function(e,t){0!==tr.length?tr.forEach(function(r){rr(e,r,t)}):window.setTimeout(t,0)},removeEndEventListener:function(e,t){0!==tr.length&&tr.forEach(function(r){nr(e,r,t)})}},or=r(232),ar=r.n(or),sr=0!==ir.endEvents.length,lr=["Webkit","Moz","O","ms"],ur=["-webkit-","-moz-","-o-","ms-",""];function cr(e,t){for(var r=window.getComputedStyle(e,null),n="",i=0;i<ur.length&&!(n=r.getPropertyValue(ur[i]+t));i++);return n}function hr(e){if(sr){var t=parseFloat(cr(e,"transition-delay"))||0,r=parseFloat(cr(e,"transition-duration"))||0,n=parseFloat(cr(e,"animation-delay"))||0,i=parseFloat(cr(e,"animation-duration"))||0,o=Math.max(r+t,i+n);e.rcEndAnimTimeout=setTimeout(function(){e.rcEndAnimTimeout=null,e.rcEndListener&&e.rcEndListener()},1e3*o+200)}}function pr(e){e.rcEndAnimTimeout&&(clearTimeout(e.rcEndAnimTimeout),e.rcEndAnimTimeout=null)}var fr=function(e,t,r){var n="object"===("undefined"===typeof t?"undefined":Jt()(t)),i=n?t.name:t,o=n?t.active:t+"-active",a=r,s=void 0,l=void 0,u=ar()(e);return r&&"[object Object]"===Object.prototype.toString.call(r)&&(a=r.end,s=r.start,l=r.active),e.rcEndListener&&e.rcEndListener(),e.rcEndListener=function(t){t&&t.target!==e||(e.rcAnimTimeout&&(clearTimeout(e.rcAnimTimeout),e.rcAnimTimeout=null),pr(e),u.remove(i),u.remove(o),ir.removeEndEventListener(e,e.rcEndListener),e.rcEndListener=null,a&&a())},ir.addEndEventListener(e,e.rcEndListener),s&&s(),u.add(i),e.rcAnimTimeout=setTimeout(function(){e.rcAnimTimeout=null,u.add(o),l&&setTimeout(l,0),hr(e)},30),{stop:function(){e.rcEndListener&&e.rcEndListener()}}};fr.style=function(e,t,r){e.rcEndListener&&e.rcEndListener(),e.rcEndListener=function(t){t&&t.target!==e||(e.rcAnimTimeout&&(clearTimeout(e.rcAnimTimeout),e.rcAnimTimeout=null),pr(e),ir.removeEndEventListener(e,e.rcEndListener),e.rcEndListener=null,r&&r())},ir.addEndEventListener(e,e.rcEndListener),e.rcAnimTimeout=setTimeout(function(){for(var r in t)t.hasOwnProperty(r)&&(e.style[r]=t[r]);e.rcAnimTimeout=null,hr(e)},0)},fr.setTransition=function(e,t,r){var n=t,i=r;void 0===r&&(i=n,n=""),n=n||"",lr.forEach(function(t){e.style[t+"Transition"+n]=i})},fr.isCssAnimationSupported=sr;var dr=fr,mr={isAppearSupported:function(e){return e.transitionName&&e.transitionAppear||e.animation.appear},isEnterSupported:function(e){return e.transitionName&&e.transitionEnter||e.animation.enter},isLeaveSupported:function(e){return e.transitionName&&e.transitionLeave||e.animation.leave},allowAppearCallback:function(e){return e.transitionAppear||e.animation.appear},allowEnterCallback:function(e){return e.transitionEnter||e.animation.enter},allowLeaveCallback:function(e){return e.transitionLeave||e.animation.leave}},vr={enter:"transitionEnter",appear:"transitionAppear",leave:"transitionLeave"},gr=function(e){function t(){return a()(this,t),c()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),l()(t,[{key:"componentWillUnmount",value:function(){this.stop()}},{key:"componentWillEnter",value:function(e){mr.isEnterSupported(this.props)?this.transition("enter",e):e()}},{key:"componentWillAppear",value:function(e){mr.isAppearSupported(this.props)?this.transition("appear",e):e()}},{key:"componentWillLeave",value:function(e){mr.isLeaveSupported(this.props)?this.transition("leave",e):e()}},{key:"transition",value:function(e,t){var r=this,n=L.a.findDOMNode(this),i=this.props,o=i.transitionName,a="object"===typeof o;this.stop();var s=function(){r.stopper=null,t()};if((sr||!i.animation[e])&&o&&i[vr[e]]){var l=a?o[e]:o+"-"+e,u=l+"-active";a&&o[e+"Active"]&&(u=o[e+"Active"]),this.stopper=dr(n,{name:l,active:u},s)}else this.stopper=i.animation[e](n,s)}},{key:"stop",value:function(){var e=this.stopper;e&&(this.stopper=null,e.stop())}},{key:"render",value:function(){return this.props.children}}]),t}(d.a.Component);gr.propTypes={children:Xt.a.any,animation:Xt.a.any,transitionName:Xt.a.any};var yr=gr,br="rc_animate_"+Date.now();function xr(e){var t=e.children;return d.a.isValidElement(t)&&!t.key?d.a.cloneElement(t,{key:br}):t}function wr(){}var Sr=function(e){function t(e){a()(this,t);var r=c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Mr.call(r),r.currentlyAnimatingKeys={},r.keysToEnter=[],r.keysToLeave=[],r.state={children:qt(xr(e))},r.childrenRefs={},r}return p()(t,e),l()(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.showProp,r=this.state.children;t&&(r=r.filter(function(e){return!!e.props[t]})),r.forEach(function(t){t&&e.performAppear(t.key)})}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.nextProps=e;var r=qt(xr(e)),n=this.props;n.exclusive&&Object.keys(this.currentlyAnimatingKeys).forEach(function(e){t.stop(e)});var i=n.showProp,o=this.currentlyAnimatingKeys,a=n.exclusive?qt(xr(n)):this.state.children,s=[];i?(a.forEach(function(e){var t=e&&Yt(r,e.key),n=void 0;(n=t&&t.props[i]||!e.props[i]?t:d.a.cloneElement(t||e,x()({},i,!0)))&&s.push(n)}),r.forEach(function(e){e&&Yt(a,e.key)||s.push(e)})):s=function(e,t){var r=[],n={},i=[];return e.forEach(function(e){e&&Yt(t,e.key)?i.length&&(n[e.key]=i,i=[]):i.push(e)}),t.forEach(function(e){e&&Object.prototype.hasOwnProperty.call(n,e.key)&&(r=r.concat(n[e.key])),r.push(e)}),r=r.concat(i)}(a,r),this.setState({children:s}),r.forEach(function(e){var r=e&&e.key;if(!e||!o[r]){var n=e&&Yt(a,r);if(i){var s=e.props[i];if(n)!Kt(a,r,i)&&s&&t.keysToEnter.push(r);else s&&t.keysToEnter.push(r)}else n||t.keysToEnter.push(r)}}),a.forEach(function(e){var n=e&&e.key;if(!e||!o[n]){var a=e&&Yt(r,n);if(i){var s=e.props[i];if(a)!Kt(r,n,i)&&s&&t.keysToLeave.push(n);else s&&t.keysToLeave.push(n)}else a||t.keysToLeave.push(n)}})}},{key:"componentDidUpdate",value:function(){var e=this.keysToEnter;this.keysToEnter=[],e.forEach(this.performEnter);var t=this.keysToLeave;this.keysToLeave=[],t.forEach(this.performLeave)}},{key:"isValidChildByKey",value:function(e,t){var r=this.props.showProp;return r?Kt(e,t,r):Yt(e,t)}},{key:"stop",value:function(e){delete this.currentlyAnimatingKeys[e];var t=this.childrenRefs[e];t&&t.stop()}},{key:"render",value:function(){var e=this,t=this.props;this.nextProps=t;var r=this.state.children,n=null;r&&(n=r.map(function(r){if(null===r||void 0===r)return r;if(!r.key)throw new Error("must set key for <rc-animate> children");return d.a.createElement(yr,{key:r.key,ref:function(t){e.childrenRefs[r.key]=t},animation:t.animation,transitionName:t.transitionName,transitionEnter:t.transitionEnter,transitionAppear:t.transitionAppear,transitionLeave:t.transitionLeave},r)}));var o=t.component;if(o){var a=t;return"string"===typeof o&&(a=i()({className:t.className,style:t.style},t.componentProps)),d.a.createElement(o,a,n)}return n[0]||null}}]),t}(d.a.Component);Sr.isAnimate=!0,Sr.propTypes={className:Xt.a.string,style:Xt.a.object,component:Xt.a.any,componentProps:Xt.a.object,animation:Xt.a.object,transitionName:Xt.a.oneOfType([Xt.a.string,Xt.a.object]),transitionEnter:Xt.a.bool,transitionAppear:Xt.a.bool,exclusive:Xt.a.bool,transitionLeave:Xt.a.bool,onEnd:Xt.a.func,onEnter:Xt.a.func,onLeave:Xt.a.func,onAppear:Xt.a.func,showProp:Xt.a.string,children:Xt.a.node},Sr.defaultProps={animation:{},component:"span",componentProps:{},transitionEnter:!0,transitionLeave:!0,transitionAppear:!1,onEnd:wr,onEnter:wr,onLeave:wr,onAppear:wr};var Mr=function(){var e=this;this.performEnter=function(t){e.childrenRefs[t]&&(e.currentlyAnimatingKeys[t]=!0,e.childrenRefs[t].componentWillEnter(e.handleDoneAdding.bind(e,t,"enter")))},this.performAppear=function(t){e.childrenRefs[t]&&(e.currentlyAnimatingKeys[t]=!0,e.childrenRefs[t].componentWillAppear(e.handleDoneAdding.bind(e,t,"appear")))},this.handleDoneAdding=function(t,r){var n=e.props;if(delete e.currentlyAnimatingKeys[t],!n.exclusive||n===e.nextProps){var i=qt(xr(n));e.isValidChildByKey(i,t)?"appear"===r?mr.allowAppearCallback(n)&&(n.onAppear(t),n.onEnd(t,!0)):mr.allowEnterCallback(n)&&(n.onEnter(t),n.onEnd(t,!0)):e.performLeave(t)}},this.performLeave=function(t){e.childrenRefs[t]&&(e.currentlyAnimatingKeys[t]=!0,e.childrenRefs[t].componentWillLeave(e.handleDoneLeaving.bind(e,t)))},this.handleDoneLeaving=function(t){var r=e.props;if(delete e.currentlyAnimatingKeys[t],!r.exclusive||r===e.nextProps){var n=qt(xr(r));if(e.isValidChildByKey(n,t))e.performEnter(t);else{var i=function(){mr.allowLeaveCallback(r)&&(r.onLeave(t),r.onEnd(t,!1))};!function(e,t,r){var n=e.length===t.length;return n&&e.forEach(function(e,i){var o=t[i];e&&o&&(e&&!o||!e&&o?n=!1:e.key!==o.key?n=!1:r&&e.props[r]!==o.props[r]&&(n=!1))}),n}(e.state.children,n,r.showProp)?e.setState({children:n},i):i()}}}},_r=Sr,Tr=function(e){function t(){return a()(this,t),c()(this,e.apply(this,arguments))}return p()(t,e),t.prototype.shouldComponentUpdate=function(e){return e.hiddenClassName||e.visible},t.prototype.render=function(){var e=this.props,t=e.hiddenClassName,r=e.visible,n=M()(e,["hiddenClassName","visible"]);return t||d.a.Children.count(n.children)>1?(!r&&t&&(n.className+=" "+t),d.a.createElement("div",n)):d.a.Children.only(n.children)},t}(f.Component);Tr.propTypes={children:fe.a.any,className:fe.a.string,visible:fe.a.bool,hiddenClassName:fe.a.string};var Ar=Tr,Cr=function(e){function t(){return a()(this,t),c()(this,e.apply(this,arguments))}return p()(t,e),t.prototype.render=function(){var e=this.props,t=e.className;return e.visible||(t+=" "+e.hiddenClassName),d.a.createElement("div",{className:t,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onMouseDown:e.onMouseDown,onTouchStart:e.onTouchStart,style:e.style},d.a.createElement(Ar,{className:e.prefixCls+"-content",visible:e.visible},e.children))},t}(f.Component);Cr.propTypes={hiddenClassName:fe.a.string,className:fe.a.string,prefixCls:fe.a.string,onMouseEnter:fe.a.func,onMouseLeave:fe.a.func,onMouseDown:fe.a.func,onTouchStart:fe.a.func,children:fe.a.any};var Er=Cr,Lr=function(e){function t(r){a()(this,t);var n=c()(this,e.call(this,r));return Nr.call(n),n.state={stretchChecked:!1,targetWidth:void 0,targetHeight:void 0},n.savePopupRef=Ne.bind(n,"popupInstance"),n.saveAlignRef=Ne.bind(n,"alignInstance"),n}return p()(t,e),t.prototype.componentDidMount=function(){this.rootNode=this.getPopupDomNode(),this.setStretchSize()},t.prototype.componentDidUpdate=function(){this.setStretchSize()},t.prototype.getPopupDomNode=function(){return L.a.findDOMNode(this.popupInstance)},t.prototype.getMaskTransitionName=function(){var e=this.props,t=e.maskTransitionName,r=e.maskAnimation;return!t&&r&&(t=e.prefixCls+"-"+r),t},t.prototype.getTransitionName=function(){var e=this.props,t=e.transitionName;return!t&&e.animation&&(t=e.prefixCls+"-"+e.animation),t},t.prototype.getClassName=function(e){return this.props.prefixCls+" "+this.props.className+" "+e},t.prototype.getPopupElement=function(){var e=this,t=this.savePopupRef,r=this.state,n=r.stretchChecked,o=r.targetHeight,a=r.targetWidth,s=this.props,l=s.align,u=s.visible,c=s.prefixCls,h=s.style,p=s.getClassNameFromAlign,f=s.destroyPopupOnHide,m=s.stretch,v=s.children,g=s.onMouseEnter,y=s.onMouseLeave,b=s.onMouseDown,x=s.onTouchStart,w=this.getClassName(this.currentAlignClassName||p(l)),S=c+"-hidden";u||(this.currentAlignClassName=null);var M={};m&&(-1!==m.indexOf("height")?M.height=o:-1!==m.indexOf("minHeight")&&(M.minHeight=o),-1!==m.indexOf("width")?M.width=a:-1!==m.indexOf("minWidth")&&(M.minWidth=a),n||(M.visibility="hidden",setTimeout(function(){e.alignInstance&&e.alignInstance.forceAlign()},0)));var _={className:w,prefixCls:c,ref:t,onMouseEnter:g,onMouseLeave:y,onMouseDown:b,onTouchStart:x,style:i()({},M,h,this.getZIndexStyle())};return f?d.a.createElement(_r,{component:"",exclusive:!0,transitionAppear:!0,transitionName:this.getTransitionName()},u?d.a.createElement(Wt,{target:this.getAlignTarget(),key:"popup",ref:this.saveAlignRef,monitorWindowResize:!0,align:l,onAlign:this.onAlign},d.a.createElement(Er,i()({visible:!0},_),v)):null):d.a.createElement(_r,{component:"",exclusive:!0,transitionAppear:!0,transitionName:this.getTransitionName(),showProp:"xVisible"},d.a.createElement(Wt,{target:this.getAlignTarget(),key:"popup",ref:this.saveAlignRef,monitorWindowResize:!0,xVisible:u,childrenProps:{visible:"xVisible"},disabled:!u,align:l,onAlign:this.onAlign},d.a.createElement(Er,i()({hiddenClassName:S},_),v)))},t.prototype.getZIndexStyle=function(){var e={},t=this.props;return void 0!==t.zIndex&&(e.zIndex=t.zIndex),e},t.prototype.getMaskElement=function(){var e=this.props,t=void 0;if(e.mask){var r=this.getMaskTransitionName();t=d.a.createElement(Ar,{style:this.getZIndexStyle(),key:"mask",className:e.prefixCls+"-mask",hiddenClassName:e.prefixCls+"-mask-hidden",visible:e.visible}),r&&(t=d.a.createElement(_r,{key:"mask",showProp:"visible",transitionAppear:!0,component:"",transitionName:r},t))}return t},t.prototype.render=function(){return d.a.createElement("div",null,this.getMaskElement(),this.getPopupElement())},t}(f.Component);Lr.propTypes={visible:fe.a.bool,style:fe.a.object,getClassNameFromAlign:fe.a.func,onAlign:fe.a.func,getRootDomNode:fe.a.func,align:fe.a.any,destroyPopupOnHide:fe.a.bool,className:fe.a.string,prefixCls:fe.a.string,onMouseEnter:fe.a.func,onMouseLeave:fe.a.func,onMouseDown:fe.a.func,onTouchStart:fe.a.func,stretch:fe.a.string,children:fe.a.node,point:fe.a.shape({pageX:fe.a.number,pageY:fe.a.number})};var Nr=function(){var e=this;this.onAlign=function(t,r){var n=e.props,i=n.getClassNameFromAlign(r);e.currentAlignClassName!==i&&(e.currentAlignClassName=i,t.className=e.getClassName(i)),n.onAlign(t,r)},this.setStretchSize=function(){var t=e.props,r=t.stretch,n=t.getRootDomNode,i=t.visible,o=e.state,a=o.stretchChecked,s=o.targetHeight,l=o.targetWidth;if(r&&i){var u=n();if(u){var c=u.offsetHeight,h=u.offsetWidth;s===c&&l===h&&a||e.setState({stretchChecked:!0,targetHeight:c,targetWidth:h})}}else a&&e.setState({stretchChecked:!1})},this.getTargetElement=function(){return e.props.getRootDomNode()},this.getAlignTarget=function(){var t=e.props.point;return t||e.getTargetElement}},Pr=Lr;function Or(){}var Rr=["onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur","onContextMenu"],Dr=!!E.createPortal,Fr={rcTrigger:fe.a.shape({onPopupMouseDown:fe.a.func})},kr=function(e){function t(r){a()(this,t);var n=c()(this,e.call(this,r));Ir.call(n);var i=void 0;return i="popupVisible"in r?!!r.popupVisible:!!r.defaultPopupVisible,n.state={prevPopupVisible:i,popupVisible:i},Rr.forEach(function(e){n["fire"+e]=function(t){n.fireEvents(e,t)}}),n}return p()(t,e),t.prototype.getChildContext=function(){return{rcTrigger:{onPopupMouseDown:this.onPopupMouseDown}}},t.prototype.componentDidMount=function(){this.componentDidUpdate({},{popupVisible:this.state.popupVisible})},t.prototype.componentDidUpdate=function(e,t){var r=this.props,n=this.state;if(Dr||this.renderComponent(null,function(){t.popupVisible!==n.popupVisible&&r.afterPopupVisibleChange(n.popupVisible)}),n.popupVisible){var i=void 0;return this.clickOutsideHandler||!this.isClickToHide()&&!this.isContextMenuToShow()||(i=r.getDocument(),this.clickOutsideHandler=N(i,"mousedown",this.onDocumentClick)),this.touchOutsideHandler||(i=i||r.getDocument(),this.touchOutsideHandler=N(i,"touchstart",this.onDocumentClick)),!this.contextMenuOutsideHandler1&&this.isContextMenuToShow()&&(i=i||r.getDocument(),this.contextMenuOutsideHandler1=N(i,"scroll",this.onContextMenuClose)),void(!this.contextMenuOutsideHandler2&&this.isContextMenuToShow()&&(this.contextMenuOutsideHandler2=N(window,"blur",this.onContextMenuClose)))}this.clearOutsideHandler()},t.prototype.componentWillUnmount=function(){this.clearDelayTimer(),this.clearOutsideHandler(),clearTimeout(this.mouseDownTimeout)},t.getDerivedStateFromProps=function(e,t){var r=e.popupVisible,n={};return void 0!==r&&t.popupVisible!==r&&(n.popupVisible=r,n.prevPopupVisible=t.popupVisible),n},t.prototype.getPopupDomNode=function(){return this._component&&this._component.getPopupDomNode?this._component.getPopupDomNode():null},t.prototype.getPopupAlign=function(){var e=this.props,t=e.popupPlacement,r=e.popupAlign,n=e.builtinPlacements;return t&&n?function(e,t,r){var n=e[t]||{};return i()({},n,r)}(n,t,r):r},t.prototype.setPopupVisible=function(e,t){var r=this.props.alignPoint,n=this.state.popupVisible;this.clearDelayTimer(),n!==e&&("popupVisible"in this.props||this.setState({popupVisible:e,prevPopupVisible:n}),this.props.onPopupVisibleChange(e)),r&&t&&this.setPoint(t)},t.prototype.delaySetPopupVisible=function(e,t,r){var n=this,i=1e3*t;if(this.clearDelayTimer(),i){var o=r?{pageX:r.pageX,pageY:r.pageY}:null;this.delayTimer=setTimeout(function(){n.setPopupVisible(e,o),n.clearDelayTimer()},i)}else this.setPopupVisible(e,r)},t.prototype.clearDelayTimer=function(){this.delayTimer&&(clearTimeout(this.delayTimer),this.delayTimer=null)},t.prototype.clearOutsideHandler=function(){this.clickOutsideHandler&&(this.clickOutsideHandler.remove(),this.clickOutsideHandler=null),this.contextMenuOutsideHandler1&&(this.contextMenuOutsideHandler1.remove(),this.contextMenuOutsideHandler1=null),this.contextMenuOutsideHandler2&&(this.contextMenuOutsideHandler2.remove(),this.contextMenuOutsideHandler2=null),this.touchOutsideHandler&&(this.touchOutsideHandler.remove(),this.touchOutsideHandler=null)},t.prototype.createTwoChains=function(e){var t=this.props.children.props,r=this.props;return t[e]&&r[e]?this["fire"+e]:t[e]||r[e]},t.prototype.isClickToShow=function(){var e=this.props,t=e.action,r=e.showAction;return-1!==t.indexOf("click")||-1!==r.indexOf("click")},t.prototype.isContextMenuToShow=function(){var e=this.props,t=e.action,r=e.showAction;return-1!==t.indexOf("contextMenu")||-1!==r.indexOf("contextMenu")},t.prototype.isClickToHide=function(){var e=this.props,t=e.action,r=e.hideAction;return-1!==t.indexOf("click")||-1!==r.indexOf("click")},t.prototype.isMouseEnterToShow=function(){var e=this.props,t=e.action,r=e.showAction;return-1!==t.indexOf("hover")||-1!==r.indexOf("mouseEnter")},t.prototype.isMouseLeaveToHide=function(){var e=this.props,t=e.action,r=e.hideAction;return-1!==t.indexOf("hover")||-1!==r.indexOf("mouseLeave")},t.prototype.isFocusToShow=function(){var e=this.props,t=e.action,r=e.showAction;return-1!==t.indexOf("focus")||-1!==r.indexOf("focus")},t.prototype.isBlurToHide=function(){var e=this.props,t=e.action,r=e.hideAction;return-1!==t.indexOf("focus")||-1!==r.indexOf("blur")},t.prototype.forcePopupAlign=function(){this.state.popupVisible&&this._component&&this._component.alignInstance&&this._component.alignInstance.forceAlign()},t.prototype.fireEvents=function(e,t){var r=this.props.children.props[e];r&&r(t);var n=this.props[e];n&&n(t)},t.prototype.close=function(){this.setPopupVisible(!1)},t.prototype.render=function(){var e=this,t=this.state.popupVisible,r=this.props,n=r.children,i=r.forceRender,o=r.alignPoint,a=r.className,s=d.a.Children.only(n),l={key:"trigger"};this.isContextMenuToShow()?l.onContextMenu=this.onContextMenu:l.onContextMenu=this.createTwoChains("onContextMenu"),this.isClickToHide()||this.isClickToShow()?(l.onClick=this.onClick,l.onMouseDown=this.onMouseDown,l.onTouchStart=this.onTouchStart):(l.onClick=this.createTwoChains("onClick"),l.onMouseDown=this.createTwoChains("onMouseDown"),l.onTouchStart=this.createTwoChains("onTouchStart")),this.isMouseEnterToShow()?(l.onMouseEnter=this.onMouseEnter,o&&(l.onMouseMove=this.onMouseMove)):l.onMouseEnter=this.createTwoChains("onMouseEnter"),this.isMouseLeaveToHide()?l.onMouseLeave=this.onMouseLeave:l.onMouseLeave=this.createTwoChains("onMouseLeave"),this.isFocusToShow()||this.isBlurToHide()?(l.onFocus=this.onFocus,l.onBlur=this.onBlur):(l.onFocus=this.createTwoChains("onFocus"),l.onBlur=this.createTwoChains("onBlur"));var u=O()(s&&s.props&&s.props.className,a);u&&(l.className=u);var c=d.a.cloneElement(s,l);if(!Dr)return d.a.createElement(Se,{parent:this,visible:t,autoMount:!1,forceRender:i,getComponent:this.getComponent,getContainer:this.getContainer},function(t){var r=t.renderComponent;return e.renderComponent=r,c});var h=void 0;return(t||this._component||i)&&(h=d.a.createElement(Ee,{key:"portal",getContainer:this.getContainer,didUpdate:this.handlePortalUpdate},this.getComponent())),[c,h]},t}(d.a.Component);kr.propTypes={children:fe.a.any,action:fe.a.oneOfType([fe.a.string,fe.a.arrayOf(fe.a.string)]),showAction:fe.a.any,hideAction:fe.a.any,getPopupClassNameFromAlign:fe.a.any,onPopupVisibleChange:fe.a.func,afterPopupVisibleChange:fe.a.func,popup:fe.a.oneOfType([fe.a.node,fe.a.func]).isRequired,popupStyle:fe.a.object,prefixCls:fe.a.string,popupClassName:fe.a.string,className:fe.a.string,popupPlacement:fe.a.string,builtinPlacements:fe.a.object,popupTransitionName:fe.a.oneOfType([fe.a.string,fe.a.object]),popupAnimation:fe.a.any,mouseEnterDelay:fe.a.number,mouseLeaveDelay:fe.a.number,zIndex:fe.a.number,focusDelay:fe.a.number,blurDelay:fe.a.number,getPopupContainer:fe.a.func,getDocument:fe.a.func,forceRender:fe.a.bool,destroyPopupOnHide:fe.a.bool,mask:fe.a.bool,maskClosable:fe.a.bool,onPopupAlign:fe.a.func,popupAlign:fe.a.object,popupVisible:fe.a.bool,defaultPopupVisible:fe.a.bool,maskTransitionName:fe.a.oneOfType([fe.a.string,fe.a.object]),maskAnimation:fe.a.string,stretch:fe.a.string,alignPoint:fe.a.bool},kr.contextTypes=Fr,kr.childContextTypes=Fr,kr.defaultProps={prefixCls:"rc-trigger-popup",getPopupClassNameFromAlign:function(){return""},getDocument:function(){return window.document},onPopupVisibleChange:Or,afterPopupVisibleChange:Or,onPopupAlign:Or,popupClassName:"",mouseEnterDelay:0,mouseLeaveDelay:.1,focusDelay:0,blurDelay:.15,popupStyle:{},destroyPopupOnHide:!1,popupAlign:{},defaultPopupVisible:!1,mask:!1,maskClosable:!0,action:[],showAction:[],hideAction:[]};var Ir=function(){var e=this;this.onMouseEnter=function(t){var r=e.props.mouseEnterDelay;e.fireEvents("onMouseEnter",t),e.delaySetPopupVisible(!0,r,r?null:t)},this.onMouseMove=function(t){e.fireEvents("onMouseMove",t),e.setPoint(t)},this.onMouseLeave=function(t){e.fireEvents("onMouseLeave",t),e.delaySetPopupVisible(!1,e.props.mouseLeaveDelay)},this.onPopupMouseEnter=function(){e.clearDelayTimer()},this.onPopupMouseLeave=function(t){t.relatedTarget&&!t.relatedTarget.setTimeout&&e._component&&e._component.getPopupDomNode&&de(e._component.getPopupDomNode(),t.relatedTarget)||e.delaySetPopupVisible(!1,e.props.mouseLeaveDelay)},this.onFocus=function(t){e.fireEvents("onFocus",t),e.clearDelayTimer(),e.isFocusToShow()&&(e.focusTime=Date.now(),e.delaySetPopupVisible(!0,e.props.focusDelay))},this.onMouseDown=function(t){e.fireEvents("onMouseDown",t),e.preClickTime=Date.now()},this.onTouchStart=function(t){e.fireEvents("onTouchStart",t),e.preTouchTime=Date.now()},this.onBlur=function(t){e.fireEvents("onBlur",t),e.clearDelayTimer(),e.isBlurToHide()&&e.delaySetPopupVisible(!1,e.props.blurDelay)},this.onContextMenu=function(t){t.preventDefault(),e.fireEvents("onContextMenu",t),e.setPopupVisible(!0,t)},this.onContextMenuClose=function(){e.isContextMenuToShow()&&e.close()},this.onClick=function(t){if(e.fireEvents("onClick",t),e.focusTime){var r=void 0;if(e.preClickTime&&e.preTouchTime?r=Math.min(e.preClickTime,e.preTouchTime):e.preClickTime?r=e.preClickTime:e.preTouchTime&&(r=e.preTouchTime),Math.abs(r-e.focusTime)<20)return;e.focusTime=0}e.preClickTime=0,e.preTouchTime=0,e.isClickToShow()&&(e.isClickToHide()||e.isBlurToHide())&&t&&t.preventDefault&&t.preventDefault();var n=!e.state.popupVisible;(e.isClickToHide()&&!n||n&&e.isClickToShow())&&e.setPopupVisible(!e.state.popupVisible,t)},this.onPopupMouseDown=function(){var t=e.context.rcTrigger,r=void 0===t?{}:t;e.hasPopupMouseDown=!0,clearTimeout(e.mouseDownTimeout),e.mouseDownTimeout=setTimeout(function(){e.hasPopupMouseDown=!1},0),r.onPopupMouseDown&&r.onPopupMouseDown.apply(r,arguments)},this.onDocumentClick=function(t){if(!e.props.mask||e.props.maskClosable){var r=t.target;de(Object(E.findDOMNode)(e),r)||e.hasPopupMouseDown||e.close()}},this.getRootDomNode=function(){return Object(E.findDOMNode)(e)},this.getPopupClassNameFromAlign=function(t){var r=[],n=e.props,i=n.popupPlacement,o=n.builtinPlacements,a=n.prefixCls,s=n.alignPoint,l=n.getPopupClassNameFromAlign;return i&&o&&r.push(function(e,t,r,n){var i=r.points;for(var o in e)if(e.hasOwnProperty(o)&&Le(e[o].points,i,n))return t+"-placement-"+o;return""}(o,a,t,s)),l&&r.push(l(t)),r.join(" ")},this.getComponent=function(){var t=e.props,r=t.prefixCls,n=t.destroyPopupOnHide,o=t.popupClassName,a=t.action,s=t.onPopupAlign,l=t.popupAnimation,u=t.popupTransitionName,c=t.popupStyle,h=t.mask,p=t.maskAnimation,f=t.maskTransitionName,m=t.zIndex,v=t.popup,g=t.stretch,y=t.alignPoint,b=e.state,x=b.popupVisible,w=b.point,S=e.getPopupAlign(),M={};return e.isMouseEnterToShow()&&(M.onMouseEnter=e.onPopupMouseEnter),e.isMouseLeaveToHide()&&(M.onMouseLeave=e.onPopupMouseLeave),M.onMouseDown=e.onPopupMouseDown,M.onTouchStart=e.onPopupMouseDown,d.a.createElement(Pr,i()({prefixCls:r,destroyPopupOnHide:n,visible:x,point:y&&w,className:o,action:a,align:S,onAlign:s,animation:l,getClassNameFromAlign:e.getPopupClassNameFromAlign},M,{stretch:g,getRootDomNode:e.getRootDomNode,style:c,mask:h,zIndex:m,transitionName:u,maskAnimation:p,maskTransitionName:f,ref:e.savePopup}),"function"===typeof v?v():v)},this.getContainer=function(){var t=e.props,r=document.createElement("div");return r.style.position="absolute",r.style.top="0",r.style.left="0",r.style.width="100%",(t.getPopupContainer?t.getPopupContainer(Object(E.findDOMNode)(e)):t.getDocument().body).appendChild(r),r},this.setPoint=function(t){e.props.alignPoint&&t&&e.setState({point:{pageX:t.pageX,pageY:t.pageY}})},this.handlePortalUpdate=function(){e.state.prevPopupVisible!==e.state.popupVisible&&e.props.afterPopupVisibleChange(e.state.popupVisible)},this.savePopup=function(t){e._component=t}};Object(ie.a)(kr);var Br=kr,Ur={adjustX:1,adjustY:1},Vr=[0,0],jr={left:{points:["cr","cl"],overflow:Ur,offset:[-4,0],targetOffset:Vr},right:{points:["cl","cr"],overflow:Ur,offset:[4,0],targetOffset:Vr},top:{points:["bc","tc"],overflow:Ur,offset:[0,-4],targetOffset:Vr},bottom:{points:["tc","bc"],overflow:Ur,offset:[0,4],targetOffset:Vr},topLeft:{points:["bl","tl"],overflow:Ur,offset:[0,-4],targetOffset:Vr},leftTop:{points:["tr","tl"],overflow:Ur,offset:[-4,0],targetOffset:Vr},topRight:{points:["br","tr"],overflow:Ur,offset:[0,-4],targetOffset:Vr},rightTop:{points:["tl","tr"],overflow:Ur,offset:[4,0],targetOffset:Vr},bottomRight:{points:["tr","br"],overflow:Ur,offset:[0,4],targetOffset:Vr},rightBottom:{points:["bl","br"],overflow:Ur,offset:[4,0],targetOffset:Vr},bottomLeft:{points:["tl","bl"],overflow:Ur,offset:[0,4],targetOffset:Vr},leftBottom:{points:["br","bl"],overflow:Ur,offset:[-4,0],targetOffset:Vr}},zr=function(e){function t(){return a()(this,t),c()(this,e.apply(this,arguments))}return p()(t,e),t.prototype.componentDidUpdate=function(){var e=this.props.trigger;e&&e.forcePopupAlign()},t.prototype.render=function(){var e=this.props,t=e.overlay,r=e.prefixCls,n=e.id;return d.a.createElement("div",{className:r+"-inner",id:n,role:"tooltip"},"function"===typeof t?t():t)},t}(d.a.Component);zr.propTypes={prefixCls:he.a.string,overlay:he.a.oneOfType([he.a.node,he.a.func]).isRequired,id:he.a.string,trigger:he.a.any};var Gr=zr,Wr=function(e){function t(){var r,n,i;a()(this,t);for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];return r=n=c()(this,e.call.apply(e,[this].concat(s))),n.getPopupElement=function(){var e=n.props,t=e.arrowContent,r=e.overlay,i=e.prefixCls,o=e.id;return[d.a.createElement("div",{className:i+"-arrow",key:"arrow"},t),d.a.createElement(Gr,{key:"content",trigger:n.trigger,prefixCls:i,id:o,overlay:r})]},n.saveTrigger=function(e){n.trigger=e},i=r,c()(n,i)}return p()(t,e),t.prototype.getPopupDomNode=function(){return this.trigger.getPopupDomNode()},t.prototype.render=function(){var e=this.props,t=e.overlayClassName,r=e.trigger,n=e.mouseEnterDelay,o=e.mouseLeaveDelay,a=e.overlayStyle,s=e.prefixCls,l=e.children,u=e.onVisibleChange,c=e.afterVisibleChange,h=e.transitionName,p=e.animation,f=e.placement,m=e.align,v=e.destroyTooltipOnHide,g=e.defaultVisible,y=e.getTooltipContainer,b=M()(e,["overlayClassName","trigger","mouseEnterDelay","mouseLeaveDelay","overlayStyle","prefixCls","children","onVisibleChange","afterVisibleChange","transitionName","animation","placement","align","destroyTooltipOnHide","defaultVisible","getTooltipContainer"]),x=i()({},b);return"visible"in this.props&&(x.popupVisible=this.props.visible),d.a.createElement(Br,i()({popupClassName:t,ref:this.saveTrigger,prefixCls:s,popup:this.getPopupElement,action:r,builtinPlacements:jr,popupPlacement:f,popupAlign:m,getPopupContainer:y,onPopupVisibleChange:u,afterPopupVisibleChange:c,popupTransitionName:h,popupAnimation:p,defaultPopupVisible:g,destroyPopupOnHide:v,mouseLeaveDelay:o,popupStyle:a,mouseEnterDelay:n},x),l)},t}(f.Component);Wr.propTypes={trigger:he.a.any,children:he.a.any,defaultVisible:he.a.bool,visible:he.a.bool,placement:he.a.string,transitionName:he.a.oneOfType([he.a.string,he.a.object]),animation:he.a.any,onVisibleChange:he.a.func,afterVisibleChange:he.a.func,overlay:he.a.oneOfType([he.a.node,he.a.func]).isRequired,overlayStyle:he.a.object,overlayClassName:he.a.string,prefixCls:he.a.string,mouseEnterDelay:he.a.number,mouseLeaveDelay:he.a.number,getTooltipContainer:he.a.func,destroyTooltipOnHide:he.a.bool,align:he.a.object,arrowContent:he.a.any,id:he.a.string},Wr.defaultProps={prefixCls:"rc-tooltip",mouseEnterDelay:0,destroyTooltipOnHide:!1,mouseLeaveDelay:.1,align:{},placement:"right",trigger:["hover"],arrowContent:null};var Hr=Wr;ne.Range=ue,ne.Handle=B,ne.createSliderWithTooltip=function(e){var t,r;return r=t=function(t){function r(){var e,t,n,o;a()(this,r);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return t=n=c()(this,(e=r.__proto__||Object.getPrototypeOf(r)).call.apply(e,[this].concat(l))),n.state={visibles:{}},n.handleTooltipVisibleChange=function(e,t){n.setState(function(r){return{visibles:i()({},r.visibles,x()({},e,t))}})},n.handleWithTooltip=function(e){var t=e.value,r=e.dragging,o=e.index,a=e.disabled,s=M()(e,["value","dragging","index","disabled"]),l=n.props,u=l.tipFormatter,c=l.tipProps,h=l.handleStyle,p=c.prefixCls,f=void 0===p?"rc-slider-tooltip":p,m=c.overlay,v=void 0===m?u(t):m,g=c.placement,y=void 0===g?"top":g,b=c.visible,x=void 0!==b&&b,w=M()(c,["prefixCls","overlay","placement","visible"]),S=void 0;return S=Array.isArray(h)?h[o]||h[0]:h,d.a.createElement(Hr,i()({},w,{prefixCls:f,overlay:v,placement:y,visible:!a&&(n.state.visibles[o]||r)||x,key:o}),d.a.createElement(B,i()({},s,{style:i()({},S),value:t,onMouseEnter:function(){return n.handleTooltipVisibleChange(o,!0)},onMouseLeave:function(){return n.handleTooltipVisibleChange(o,!1)}})))},o=t,c()(n,o)}return p()(r,t),l()(r,[{key:"render",value:function(){return d.a.createElement(e,i()({},this.props,{handle:this.handleWithTooltip}))}}]),r}(d.a.Component),t.propTypes={tipFormatter:v.a.func,handleStyle:v.a.oneOfType([v.a.object,v.a.arrayOf(v.a.object)]),tipProps:v.a.object},t.defaultProps={tipFormatter:function(e){return e},handleStyle:[{}],tipProps:{}},r};t.a=ne},function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(l){i=!0,o=l}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}r.d(t,"a",function(){return n})},function(e,t,r){"use strict";var n=r(1),i=r(5),o=r(0),a=r.n(o),s=(r(13),r(8)),l=r.n(s),u=r(6),c=r(15),h=r(42),p=r(2),f=r(519),d=!0,m=!1,v=null,g={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function y(){d=!0}function b(){d=!1}function x(){"hidden"===this.visibilityState&&m&&(d=!0)}function w(e){var t=e.target;try{return t.matches(":focus-visible")}catch(r){}return d||function(e){var t=e.type,r=e.tagName;return!("INPUT"!==r||!g[t]||e.readOnly)||"TEXTAREA"===r&&!e.readOnly||!!e.isContentEditable}(t)}function S(){m=!0,window.clearTimeout(v),v=window.setTimeout(function(){m=!1,window.clearTimeout(v)},100)}function M(){return{isFocusVisible:w,onBlurVisible:S,ref:a.a.useCallback(function(e){var t,r=l.a.findDOMNode(e);null!=r&&((t=r.ownerDocument).addEventListener("keydown",y,!0),t.addEventListener("mousedown",b,!0),t.addEventListener("pointerdown",b,!0),t.addEventListener("touchstart",b,!0),t.addEventListener("visibilitychange",x,!0))},[])}}var _=r(87),T=r(9),A=r(57),C=r(88),E=(r(7),r(77));function L(e,t){var r=Object.create(null);return e&&o.Children.map(e,function(e){return e}).forEach(function(e){r[e.key]=function(e){return t&&Object(o.isValidElement)(e)?t(e):e}(e)}),r}function N(e,t,r){return null!=r[t]?r[t]:e.props[t]}function P(e,t,r){var n=L(e.children),i=function(e,t){function r(r){return r in t?t[r]:e[r]}e=e||{},t=t||{};var n,i=Object.create(null),o=[];for(var a in e)a in t?o.length&&(i[a]=o,o=[]):o.push(a);var s={};for(var l in t){if(i[l])for(n=0;n<i[l].length;n++){var u=i[l][n];s[i[l][n]]=r(u)}s[l]=r(l)}for(n=0;n<o.length;n++)s[o[n]]=r(o[n]);return s}(t,n);return Object.keys(i).forEach(function(a){var s=i[a];if(Object(o.isValidElement)(s)){var l=a in t,u=a in n,c=t[a],h=Object(o.isValidElement)(c)&&!c.props.in;!u||l&&!h?u||!l||h?u&&l&&Object(o.isValidElement)(c)&&(i[a]=Object(o.cloneElement)(s,{onExited:r.bind(null,s),in:c.props.in,exit:N(s,"exit",e),enter:N(s,"enter",e)})):i[a]=Object(o.cloneElement)(s,{in:!1}):i[a]=Object(o.cloneElement)(s,{onExited:r.bind(null,s),in:!0,exit:N(s,"exit",e),enter:N(s,"enter",e)})}}),i}var O=Object.values||function(e){return Object.keys(e).map(function(t){return e[t]})},R=function(e){function t(t,r){var n,i=(n=e.call(this,t,r)||this).handleExited.bind(Object(C.a)(Object(C.a)(n)));return n.state={contextValue:{isMounting:!0},handleExited:i,firstRender:!0},n}Object(A.a)(t,e);var r=t.prototype;return r.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},r.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(e,t){var r,n,i=t.children,a=t.handleExited;return{children:t.firstRender?(r=e,n=a,L(r.children,function(e){return Object(o.cloneElement)(e,{onExited:n.bind(null,e),in:!0,appear:N(e,"appear",r),enter:N(e,"enter",r),exit:N(e,"exit",r)})})):P(e,i,a),firstRender:!1}},r.handleExited=function(e,t){var r=L(this.props.children);e.key in r||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState(function(t){var r=Object(n.a)({},t.children);return delete r[e.key],{children:r}}))},r.render=function(){var e=this.props,t=e.component,r=e.childFactory,n=Object(T.a)(e,["component","childFactory"]),i=this.state.contextValue,o=O(this.state.children).map(r);return delete n.appear,delete n.enter,delete n.exit,null===t?a.a.createElement(E.a.Provider,{value:i},o):a.a.createElement(E.a.Provider,{value:i},a.a.createElement(t,n,o))},t}(a.a.Component);R.propTypes={},R.defaultProps={component:"div",childFactory:function(e){return e}};var D=R,F="undefined"===typeof window?a.a.useEffect:a.a.useLayoutEffect;var k=function(e){var t=e.classes,r=e.pulsate,n=void 0!==r&&r,i=e.rippleX,o=e.rippleY,s=e.rippleSize,l=e.in,c=e.onExited,p=void 0===c?function(){}:c,f=e.timeout,d=a.a.useState(!1),m=d[0],v=d[1],g=Object(u.a)(t.ripple,t.rippleVisible,n&&t.ripplePulsate),y={width:s,height:s,top:-s/2+o,left:-s/2+i},b=Object(u.a)(t.child,m&&t.childLeaving,n&&t.childPulsate),x=Object(h.a)(p);return F(function(){if(!l){v(!0);var e=setTimeout(x,f);return function(){clearTimeout(e)}}},[x,l,f]),a.a.createElement("span",{className:g,style:y},a.a.createElement("span",{className:b}))},I=a.a.forwardRef(function(e,t){var r=e.center,o=void 0!==r&&r,s=e.classes,l=e.className,c=Object(i.a)(e,["center","classes","className"]),h=a.a.useState([]),p=h[0],f=h[1],d=a.a.useRef(0),m=a.a.useRef(null);a.a.useEffect(function(){m.current&&(m.current(),m.current=null)},[p]);var v=a.a.useRef(!1),g=a.a.useRef(null),y=a.a.useRef(null),b=a.a.useRef(null);a.a.useEffect(function(){return function(){clearTimeout(g.current)}},[]);var x=a.a.useCallback(function(e){var t=e.pulsate,r=e.rippleX,n=e.rippleY,i=e.rippleSize,o=e.cb;f(function(e){return[].concat(Object(_.a)(e),[a.a.createElement(k,{key:d.current,classes:s,timeout:550,pulsate:t,rippleX:r,rippleY:n,rippleSize:i})])}),d.current+=1,m.current=o},[s]),w=a.a.useCallback(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,n=t.pulsate,i=void 0!==n&&n,a=t.center,s=void 0===a?o||t.pulsate:a,l=t.fakeElement,u=void 0!==l&&l;if("mousedown"===e.type&&v.current)v.current=!1;else{"touchstart"===e.type&&(v.current=!0);var c,h,p,f=u?null:b.current,d=f?f.getBoundingClientRect():{width:0,height:0,left:0,top:0};if(s||0===e.clientX&&0===e.clientY||!e.clientX&&!e.touches)c=Math.round(d.width/2),h=Math.round(d.height/2);else{var m=e.clientX?e.clientX:e.touches[0].clientX,w=e.clientY?e.clientY:e.touches[0].clientY;c=Math.round(m-d.left),h=Math.round(w-d.top)}if(s)(p=Math.sqrt((2*Math.pow(d.width,2)+Math.pow(d.height,2))/3))%2===0&&(p+=1);else{var S=2*Math.max(Math.abs((f?f.clientWidth:0)-c),c)+2,M=2*Math.max(Math.abs((f?f.clientHeight:0)-h),h)+2;p=Math.sqrt(Math.pow(S,2)+Math.pow(M,2))}e.touches?(y.current=function(){x({pulsate:i,rippleX:c,rippleY:h,rippleSize:p,cb:r})},g.current=setTimeout(function(){y.current&&(y.current(),y.current=null)},80)):x({pulsate:i,rippleX:c,rippleY:h,rippleSize:p,cb:r})}},[o,x]),S=a.a.useCallback(function(){w({},{pulsate:!0})},[w]),M=a.a.useCallback(function(e,t){if(clearTimeout(g.current),"touchend"===e.type&&y.current)return e.persist(),y.current(),y.current=null,void(g.current=setTimeout(function(){M(e,t)}));y.current=null,f(function(e){return e.length>0?e.slice(1):e}),m.current=t},[]);return a.a.useImperativeHandle(t,function(){return{pulsate:S,start:w,stop:M}},[S,w,M]),a.a.createElement("span",Object(n.a)({className:Object(u.a)(s.root,l),ref:b},c),a.a.createElement(D,{component:null,exit:!0},p))});var B,U=Object(p.a)(function(e){return{root:{overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"},ripple:{opacity:0,position:"absolute"},rippleVisible:{opacity:.3,transform:"scale(1)",animation:"$enter ".concat(550,"ms ").concat(e.transitions.easing.easeInOut)},ripplePulsate:{animationDuration:"".concat(e.transitions.duration.shorter,"ms")},child:{opacity:1,display:"block",width:"100%",height:"100%",borderRadius:"50%",backgroundColor:"currentColor"},childLeaving:{opacity:0,animation:"$exit ".concat(550,"ms ").concat(e.transitions.easing.easeInOut)},childPulsate:{position:"absolute",left:0,top:0,animation:"$pulsate 2500ms ".concat(e.transitions.easing.easeInOut," 200ms infinite")},"@keyframes enter":{"0%":{transform:"scale(0)",opacity:.1},"100%":{transform:"scale(1)",opacity:.3}},"@keyframes exit":{"0%":{opacity:1},"100%":{opacity:0}},"@keyframes pulsate":{"0%":{transform:"scale(1)"},"50%":{transform:"scale(0.92)"},"100%":{transform:"scale(1)"}}}},{flip:!1,name:"MuiTouchRipple"})(((B=a.a.memo(I)).muiName="MuiTouchRipple",B)),V=a.a.forwardRef(function(e,t){var r=e.action,o=e.buttonRef,s=e.centerRipple,p=void 0!==s&&s,d=e.children,m=e.classes,v=e.className,g=e.component,y=void 0===g?"button":g,b=e.disabled,x=void 0!==b&&b,w=e.disableRipple,S=void 0!==w&&w,_=e.disableTouchRipple,T=void 0!==_&&_,A=e.focusRipple,C=void 0!==A&&A,E=e.focusVisibleClassName,L=e.onBlur,N=e.onClick,P=e.onFocus,O=e.onFocusVisible,R=e.onKeyDown,D=e.onKeyUp,F=e.onMouseDown,k=e.onMouseLeave,I=e.onMouseUp,B=e.onTouchEnd,V=e.onTouchMove,j=e.onTouchStart,z=e.onDragLeave,G=e.tabIndex,W=void 0===G?0:G,H=e.TouchRippleProps,X=e.type,q=void 0===X?"button":X,Y=Object(i.a)(e,["action","buttonRef","centerRipple","children","classes","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","onBlur","onClick","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","onDragLeave","tabIndex","TouchRippleProps","type"]),K=a.a.useRef(null);var Q=a.a.useRef(null),J=a.a.useState(!1),Z=J[0],$=J[1];x&&Z&&$(!1);var ee=M(),te=ee.isFocusVisible,re=ee.onBlurVisible,ne=ee.ref;function ie(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:T;return Object(h.a)(function(n){return t&&t(n),!(n.defaultPrevented||r)&&Q.current&&Q.current[e](n),!0})}a.a.useImperativeHandle(r,function(){return{focusVisible:function(){$(!0),K.current.focus()}}},[]),a.a.useEffect(function(){Z&&C&&!S&&Q.current.pulsate()},[S,C,Z]);var oe=ie("start",F),ae=ie("stop",z),se=ie("stop",I),le=ie("stop",function(e){Z&&e.preventDefault(),k&&k(e)}),ue=ie("start",j),ce=ie("stop",B),he=ie("stop",V),pe=ie("stop",function(e){Z&&(re(e),$(!1)),L&&L(e)},!1),fe=Object(h.a)(function(e){x||(K.current||(K.current=e.currentTarget),te(e)&&($(!0),O&&O(e)),P&&P(e))}),de=a.a.useRef(!1),me=Object(h.a)(function(e){C&&!de.current&&Z&&Q.current&&" "===e.key&&(de.current=!0,e.persist(),Q.current.stop(e,function(){Q.current.start(e)})),R&&R(e);var t=l.a.findDOMNode(K.current);e.target!==e.currentTarget||!y||"button"===y||" "!==e.key&&"Enter"!==e.key||"A"===t.tagName&&t.href||(e.preventDefault(),N&&N(e))}),ve=Object(h.a)(function(e){C&&" "===e.key&&Q.current&&Z&&(de.current=!1,e.persist(),Q.current.stop(e,function(){Q.current.pulsate(e)})),D&&D(e)}),ge=y;"button"===ge&&Y.href&&(ge="a");var ye={};"button"===ge?(ye.type=q,ye.disabled=x):("a"===ge&&Y.href||(ye.role="button"),ye["aria-disabled"]=x);var be=Object(c.c)(o,t),xe=Object(c.c)(ne,K),we=Object(c.c)(be,xe);return a.a.createElement(ge,Object(n.a)({className:Object(u.a)(m.root,v,Z&&[m.focusVisible,E],x&&m.disabled),onBlur:pe,onClick:N,onFocus:fe,onKeyDown:me,onKeyUp:ve,onMouseDown:oe,onMouseLeave:le,onMouseUp:se,onDragLeave:ae,onTouchEnd:ce,onTouchMove:he,onTouchStart:ue,ref:we,tabIndex:x?-1:W},ye,Y),d,S||x?null:a.a.createElement(f.a,null,a.a.createElement(U,Object(n.a)({ref:Q,center:p},H))))});t.a=Object(p.a)({root:{display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle","-moz-appearance":"none","-webkit-appearance":"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},"&$disabled":{pointerEvents:"none",cursor:"default"}},disabled:{},focusVisible:{}},{name:"MuiButtonBase"})(V)},,,,,,,,,,,,,function(e,t,r){"use strict";var n=r(131),i="function"===typeof Symbol&&Symbol.for,o=i?Symbol.for("react.element"):60103,a=i?Symbol.for("react.portal"):60106,s=i?Symbol.for("react.fragment"):60107,l=i?Symbol.for("react.strict_mode"):60108,u=i?Symbol.for("react.profiler"):60114,c=i?Symbol.for("react.provider"):60109,h=i?Symbol.for("react.context"):60110,p=i?Symbol.for("react.forward_ref"):60112,f=i?Symbol.for("react.suspense"):60113,d=i?Symbol.for("react.suspense_list"):60120,m=i?Symbol.for("react.memo"):60115,v=i?Symbol.for("react.lazy"):60116;i&&Symbol.for("react.fundamental"),i&&Symbol.for("react.responder");var g="function"===typeof Symbol&&Symbol.iterator;function y(e){for(var t=e.message,r="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)r+="&args[]="+encodeURIComponent(arguments[n]);return e.message="Minified React error #"+t+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",e}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x={};function w(e,t,r){this.props=e,this.context=t,this.refs=x,this.updater=r||b}function S(){}function M(e,t,r){this.props=e,this.context=t,this.refs=x,this.updater=r||b}w.prototype.isReactComponent={},w.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw y(Error(85));this.updater.enqueueSetState(this,e,t,"setState")},w.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},S.prototype=w.prototype;var _=M.prototype=new S;_.constructor=M,n(_,w.prototype),_.isPureReactComponent=!0;var T={current:null},A={suspense:null},C={current:null},E=Object.prototype.hasOwnProperty,L={key:!0,ref:!0,__self:!0,__source:!0};function N(e,t,r){var n=void 0,i={},a=null,s=null;if(null!=t)for(n in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)E.call(t,n)&&!L.hasOwnProperty(n)&&(i[n]=t[n]);var l=arguments.length-2;if(1===l)i.children=r;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];i.children=u}if(e&&e.defaultProps)for(n in l=e.defaultProps)void 0===i[n]&&(i[n]=l[n]);return{$$typeof:o,type:e,key:a,ref:s,props:i,_owner:C.current}}function P(e){return"object"===typeof e&&null!==e&&e.$$typeof===o}var O=/\/+/g,R=[];function D(e,t,r,n){if(R.length){var i=R.pop();return i.result=e,i.keyPrefix=t,i.func=r,i.context=n,i.count=0,i}return{result:e,keyPrefix:t,func:r,context:n,count:0}}function F(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>R.length&&R.push(e)}function k(e,t,r){return null==e?0:function e(t,r,n,i){var s=typeof t;"undefined"!==s&&"boolean"!==s||(t=null);var l=!1;if(null===t)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case o:case a:l=!0}}if(l)return n(i,t,""===r?"."+I(t,0):r),1;if(l=0,r=""===r?".":r+":",Array.isArray(t))for(var u=0;u<t.length;u++){var c=r+I(s=t[u],u);l+=e(s,c,n,i)}else if(c=null===t||"object"!==typeof t?null:"function"===typeof(c=g&&t[g]||t["@@iterator"])?c:null,"function"===typeof c)for(t=c.call(t),u=0;!(s=t.next()).done;)l+=e(s=s.value,c=r+I(s,u++),n,i);else if("object"===s)throw n=""+t,y(Error(31),"[object Object]"===n?"object with keys {"+Object.keys(t).join(", ")+"}":n,"");return l}(e,"",t,r)}function I(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,function(e){return t[e]})}(e.key):t.toString(36)}function B(e,t){e.func.call(e.context,t,e.count++)}function U(e,t,r){var n=e.result,i=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?V(e,n,r,function(e){return e}):null!=e&&(P(e)&&(e=function(e,t){return{$$typeof:o,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(e,i+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(O,"$&/")+"/")+r)),n.push(e))}function V(e,t,r,n,i){var o="";null!=r&&(o=(""+r).replace(O,"$&/")+"/"),k(e,U,t=D(t,o,n,i)),F(t)}function j(){var e=T.current;if(null===e)throw y(Error(321));return e}var z={Children:{map:function(e,t,r){if(null==e)return e;var n=[];return V(e,n,null,t,r),n},forEach:function(e,t,r){if(null==e)return e;k(e,B,t=D(null,null,t,r)),F(t)},count:function(e){return k(e,function(){return null},null)},toArray:function(e){var t=[];return V(e,t,null,function(e){return e}),t},only:function(e){if(!P(e))throw y(Error(143));return e}},createRef:function(){return{current:null}},Component:w,PureComponent:M,createContext:function(e,t){return void 0===t&&(t=null),(e={$$typeof:h,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:c,_context:e},e.Consumer=e},forwardRef:function(e){return{$$typeof:p,render:e}},lazy:function(e){return{$$typeof:v,_ctor:e,_status:-1,_result:null}},memo:function(e,t){return{$$typeof:m,type:e,compare:void 0===t?null:t}},useCallback:function(e,t){return j().useCallback(e,t)},useContext:function(e,t){return j().useContext(e,t)},useEffect:function(e,t){return j().useEffect(e,t)},useImperativeHandle:function(e,t,r){return j().useImperativeHandle(e,t,r)},useDebugValue:function(){},useLayoutEffect:function(e,t){return j().useLayoutEffect(e,t)},useMemo:function(e,t){return j().useMemo(e,t)},useReducer:function(e,t,r){return j().useReducer(e,t,r)},useRef:function(e){return j().useRef(e)},useState:function(e){return j().useState(e)},Fragment:s,Profiler:u,StrictMode:l,Suspense:f,unstable_SuspenseList:d,createElement:N,cloneElement:function(e,t,r){if(null===e||void 0===e)throw y(Error(267),e);var i=void 0,a=n({},e.props),s=e.key,l=e.ref,u=e._owner;if(null!=t){void 0!==t.ref&&(l=t.ref,u=C.current),void 0!==t.key&&(s=""+t.key);var c=void 0;for(i in e.type&&e.type.defaultProps&&(c=e.type.defaultProps),t)E.call(t,i)&&!L.hasOwnProperty(i)&&(a[i]=void 0===t[i]&&void 0!==c?c[i]:t[i])}if(1===(i=arguments.length-2))a.children=r;else if(1<i){c=Array(i);for(var h=0;h<i;h++)c[h]=arguments[h+2];a.children=c}return{$$typeof:o,type:e.type,key:s,ref:l,props:a,_owner:u}},createFactory:function(e){var t=N.bind(null,e);return t.type=e,t},isValidElement:P,version:"16.9.0",unstable_withSuspenseConfig:function(e,t){var r=A.suspense;A.suspense=void 0===t?null:t;try{e()}finally{A.suspense=r}},__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentDispatcher:T,ReactCurrentBatchConfig:A,ReactCurrentOwner:C,IsSomeRendererActing:{current:!1},assign:n}},G={default:z},W=G&&z||G;e.exports=W.default||W},function(e,t,r){"use strict";var n=r(0),i=r(131),o=r(257);function a(e){for(var t=e.message,r="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)r+="&args[]="+encodeURIComponent(arguments[n]);return e.message="Minified React error #"+t+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",e}if(!n)throw a(Error(227));var s=null,l={};function u(){if(s)for(var e in l){var t=l[e],r=s.indexOf(e);if(!(-1<r))throw a(Error(96),e);if(!h[r]){if(!t.extractEvents)throw a(Error(97),e);for(var n in h[r]=t,r=t.eventTypes){var i=void 0,o=r[n],u=t,f=n;if(p.hasOwnProperty(f))throw a(Error(99),f);p[f]=o;var d=o.phasedRegistrationNames;if(d){for(i in d)d.hasOwnProperty(i)&&c(d[i],u,f);i=!0}else o.registrationName?(c(o.registrationName,u,f),i=!0):i=!1;if(!i)throw a(Error(98),n,e)}}}}function c(e,t,r){if(f[e])throw a(Error(100),e);f[e]=t,d[e]=t.eventTypes[r].dependencies}var h=[],p={},f={},d={};var m=!1,v=null,g=!1,y=null,b={onError:function(e){m=!0,v=e}};function x(e,t,r,n,i,o,a,s,l){m=!1,v=null,function(e,t,r,n,i,o,a,s,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(c){this.onError(c)}}.apply(b,arguments)}var w=null,S=null,M=null;function _(e,t,r){var n=e.type||"unknown-event";e.currentTarget=M(r),function(e,t,r,n,i,o,s,l,u){if(x.apply(this,arguments),m){if(!m)throw a(Error(198));var c=v;m=!1,v=null,g||(g=!0,y=c)}}(n,t,void 0,e),e.currentTarget=null}function T(e,t){if(null==t)throw a(Error(30));return null==e?t:Array.isArray(e)?Array.isArray(t)?(e.push.apply(e,t),e):(e.push(t),e):Array.isArray(t)?[e].concat(t):[e,t]}function A(e,t,r){Array.isArray(e)?e.forEach(t,r):e&&t.call(r,e)}var C=null;function E(e){if(e){var t=e._dispatchListeners,r=e._dispatchInstances;if(Array.isArray(t))for(var n=0;n<t.length&&!e.isPropagationStopped();n++)_(e,t[n],r[n]);else t&&_(e,t,r);e._dispatchListeners=null,e._dispatchInstances=null,e.isPersistent()||e.constructor.release(e)}}function L(e){if(null!==e&&(C=T(C,e)),e=C,C=null,e){if(A(e,E),C)throw a(Error(95));if(g)throw e=y,g=!1,y=null,e}}var N={injectEventPluginOrder:function(e){if(s)throw a(Error(101));s=Array.prototype.slice.call(e),u()},injectEventPluginsByName:function(e){var t,r=!1;for(t in e)if(e.hasOwnProperty(t)){var n=e[t];if(!l.hasOwnProperty(t)||l[t]!==n){if(l[t])throw a(Error(102),t);l[t]=n,r=!0}}r&&u()}};function P(e,t){var r=e.stateNode;if(!r)return null;var n=w(r);if(!n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!==typeof r)throw a(Error(231),t,typeof r);return r}var O=Math.random().toString(36).slice(2),R="__reactInternalInstance$"+O,D="__reactEventHandlers$"+O;function F(e){if(e[R])return e[R];for(;!e[R];){if(!e.parentNode)return null;e=e.parentNode}return 5===(e=e[R]).tag||6===e.tag?e:null}function k(e){return!(e=e[R])||5!==e.tag&&6!==e.tag?null:e}function I(e){if(5===e.tag||6===e.tag)return e.stateNode;throw a(Error(33))}function B(e){return e[D]||null}function U(e){do{e=e.return}while(e&&5!==e.tag);return e||null}function V(e,t,r){(t=P(e,r.dispatchConfig.phasedRegistrationNames[t]))&&(r._dispatchListeners=T(r._dispatchListeners,t),r._dispatchInstances=T(r._dispatchInstances,e))}function j(e){if(e&&e.dispatchConfig.phasedRegistrationNames){for(var t=e._targetInst,r=[];t;)r.push(t),t=U(t);for(t=r.length;0<t--;)V(r[t],"captured",e);for(t=0;t<r.length;t++)V(r[t],"bubbled",e)}}function z(e,t,r){e&&r&&r.dispatchConfig.registrationName&&(t=P(e,r.dispatchConfig.registrationName))&&(r._dispatchListeners=T(r._dispatchListeners,t),r._dispatchInstances=T(r._dispatchInstances,e))}function G(e){e&&e.dispatchConfig.registrationName&&z(e._targetInst,null,e)}function W(e){A(e,j)}var H=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement);function X(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var q={animationend:X("Animation","AnimationEnd"),animationiteration:X("Animation","AnimationIteration"),animationstart:X("Animation","AnimationStart"),transitionend:X("Transition","TransitionEnd")},Y={},K={};function Q(e){if(Y[e])return Y[e];if(!q[e])return e;var t,r=q[e];for(t in r)if(r.hasOwnProperty(t)&&t in K)return Y[e]=r[t];return e}H&&(K=document.createElement("div").style,"AnimationEvent"in window||(delete q.animationend.animation,delete q.animationiteration.animation,delete q.animationstart.animation),"TransitionEvent"in window||delete q.transitionend.transition);var J=Q("animationend"),Z=Q("animationiteration"),$=Q("animationstart"),ee=Q("transitionend"),te="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),re=null,ne=null,ie=null;function oe(){if(ie)return ie;var e,t,r=ne,n=r.length,i="value"in re?re.value:re.textContent,o=i.length;for(e=0;e<n&&r[e]===i[e];e++);var a=n-e;for(t=1;t<=a&&r[n-t]===i[o-t];t++);return ie=i.slice(e,1<t?1-t:void 0)}function ae(){return!0}function se(){return!1}function le(e,t,r,n){for(var i in this.dispatchConfig=e,this._targetInst=t,this.nativeEvent=r,e=this.constructor.Interface)e.hasOwnProperty(i)&&((t=e[i])?this[i]=t(r):"target"===i?this.target=n:this[i]=r[i]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?ae:se,this.isPropagationStopped=se,this}function ue(e,t,r,n){if(this.eventPool.length){var i=this.eventPool.pop();return this.call(i,e,t,r,n),i}return new this(e,t,r,n)}function ce(e){if(!(e instanceof this))throw a(Error(279));e.destructor(),10>this.eventPool.length&&this.eventPool.push(e)}function he(e){e.eventPool=[],e.getPooled=ue,e.release=ce}i(le.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=ae)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=ae)},persist:function(){this.isPersistent=ae},isPersistent:se,destructor:function(){var e,t=this.constructor.Interface;for(e in t)this[e]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=se,this._dispatchInstances=this._dispatchListeners=null}}),le.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null},le.extend=function(e){function t(){}function r(){return n.apply(this,arguments)}var n=this;t.prototype=n.prototype;var o=new t;return i(o,r.prototype),r.prototype=o,r.prototype.constructor=r,r.Interface=i({},n.Interface,e),r.extend=n.extend,he(r),r},he(le);var pe=le.extend({data:null}),fe=le.extend({data:null}),de=[9,13,27,32],me=H&&"CompositionEvent"in window,ve=null;H&&"documentMode"in document&&(ve=document.documentMode);var ge=H&&"TextEvent"in window&&!ve,ye=H&&(!me||ve&&8<ve&&11>=ve),be=String.fromCharCode(32),xe={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},we=!1;function Se(e,t){switch(e){case"keyup":return-1!==de.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function Me(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var _e=!1;var Te={eventTypes:xe,extractEvents:function(e,t,r,n){var i=void 0,o=void 0;if(me)e:{switch(e){case"compositionstart":i=xe.compositionStart;break e;case"compositionend":i=xe.compositionEnd;break e;case"compositionupdate":i=xe.compositionUpdate;break e}i=void 0}else _e?Se(e,r)&&(i=xe.compositionEnd):"keydown"===e&&229===r.keyCode&&(i=xe.compositionStart);return i?(ye&&"ko"!==r.locale&&(_e||i!==xe.compositionStart?i===xe.compositionEnd&&_e&&(o=oe()):(ne="value"in(re=n)?re.value:re.textContent,_e=!0)),i=pe.getPooled(i,t,r,n),o?i.data=o:null!==(o=Me(r))&&(i.data=o),W(i),o=i):o=null,(e=ge?function(e,t){switch(e){case"compositionend":return Me(t);case"keypress":return 32!==t.which?null:(we=!0,be);case"textInput":return(e=t.data)===be&&we?null:e;default:return null}}(e,r):function(e,t){if(_e)return"compositionend"===e||!me&&Se(e,t)?(e=oe(),ie=ne=re=null,_e=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ye&&"ko"!==t.locale?null:t.data;default:return null}}(e,r))?((t=fe.getPooled(xe.beforeInput,t,r,n)).data=e,W(t)):t=null,null===o?t:null===t?o:[o,t]}},Ae=null,Ce=null,Ee=null;function Le(e){if(e=S(e)){if("function"!==typeof Ae)throw a(Error(280));var t=w(e.stateNode);Ae(e.stateNode,e.type,t)}}function Ne(e){Ce?Ee?Ee.push(e):Ee=[e]:Ce=e}function Pe(){if(Ce){var e=Ce,t=Ee;if(Ee=Ce=null,Le(e),t)for(e=0;e<t.length;e++)Le(t[e])}}function Oe(e,t){return e(t)}function Re(e,t,r,n){return e(t,r,n)}function De(){}var Fe=Oe,ke=!1;function Ie(){null===Ce&&null===Ee||(De(),Pe())}var Be={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ue(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Be[e.type]:"textarea"===t}function Ve(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}function je(e){if(!H)return!1;var t=(e="on"+e)in document;return t||((t=document.createElement("div")).setAttribute(e,"return;"),t="function"===typeof t[e]),t}function ze(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Ge(e){e._valueTracker||(e._valueTracker=function(e){var t=ze(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var i=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){n=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function We(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=ze(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}var He=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;He.hasOwnProperty("ReactCurrentDispatcher")||(He.ReactCurrentDispatcher={current:null}),He.hasOwnProperty("ReactCurrentBatchConfig")||(He.ReactCurrentBatchConfig={suspense:null});var Xe=/^(.*)[\\\/]/,qe="function"===typeof Symbol&&Symbol.for,Ye=qe?Symbol.for("react.element"):60103,Ke=qe?Symbol.for("react.portal"):60106,Qe=qe?Symbol.for("react.fragment"):60107,Je=qe?Symbol.for("react.strict_mode"):60108,Ze=qe?Symbol.for("react.profiler"):60114,$e=qe?Symbol.for("react.provider"):60109,et=qe?Symbol.for("react.context"):60110,tt=qe?Symbol.for("react.concurrent_mode"):60111,rt=qe?Symbol.for("react.forward_ref"):60112,nt=qe?Symbol.for("react.suspense"):60113,it=qe?Symbol.for("react.suspense_list"):60120,ot=qe?Symbol.for("react.memo"):60115,at=qe?Symbol.for("react.lazy"):60116;qe&&Symbol.for("react.fundamental"),qe&&Symbol.for("react.responder");var st="function"===typeof Symbol&&Symbol.iterator;function lt(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=st&&e[st]||e["@@iterator"])?e:null}function ut(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case Qe:return"Fragment";case Ke:return"Portal";case Ze:return"Profiler";case Je:return"StrictMode";case nt:return"Suspense";case it:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case et:return"Context.Consumer";case $e:return"Context.Provider";case rt:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case ot:return ut(e.type);case at:if(e=1===e._status?e._result:null)return ut(e)}return null}function ct(e){var t="";do{e:switch(e.tag){case 3:case 4:case 6:case 7:case 10:case 9:var r="";break e;default:var n=e._debugOwner,i=e._debugSource,o=ut(e.type);r=null,n&&(r=ut(n.type)),n=o,o="",i?o=" (at "+i.fileName.replace(Xe,"")+":"+i.lineNumber+")":r&&(o=" (created by "+r+")"),r="\n    in "+(n||"Unknown")+o}t+=r,e=e.return}while(e);return t}var ht=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,pt=Object.prototype.hasOwnProperty,ft={},dt={};function mt(e,t,r,n,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=o}var vt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){vt[e]=new mt(e,0,!1,e,null,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];vt[t]=new mt(t,1,!1,e[1],null,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){vt[e]=new mt(e,2,!1,e.toLowerCase(),null,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){vt[e]=new mt(e,2,!1,e,null,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){vt[e]=new mt(e,3,!1,e.toLowerCase(),null,!1)}),["checked","multiple","muted","selected"].forEach(function(e){vt[e]=new mt(e,3,!0,e,null,!1)}),["capture","download"].forEach(function(e){vt[e]=new mt(e,4,!1,e,null,!1)}),["cols","rows","size","span"].forEach(function(e){vt[e]=new mt(e,6,!1,e,null,!1)}),["rowSpan","start"].forEach(function(e){vt[e]=new mt(e,5,!1,e.toLowerCase(),null,!1)});var gt=/[\-:]([a-z])/g;function yt(e){return e[1].toUpperCase()}function bt(e,t,r,n){var i=vt.hasOwnProperty(t)?vt[t]:null;(null!==i?0===i.type:!n&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,r,n){if(null===t||"undefined"===typeof t||function(e,t,r,n){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,r,n))return!0;if(n)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,r,i,n)&&(r=null),n||null===i?function(e){return!!pt.call(dt,e)||!pt.call(ft,e)&&(ht.test(e)?dt[e]=!0:(ft[e]=!0,!1))}(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=null===r?3!==i.type&&"":r:(t=i.attributeName,n=i.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(i=i.type)||4===i&&!0===r?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}function xt(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function wt(e,t){var r=t.checked;return i({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function St(e,t){var r=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;r=xt(null!=t.value?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Mt(e,t){null!=(t=t.checked)&&bt(e,"checked",t,!1)}function _t(e,t){Mt(e,t);var r=xt(t.value),n=t.type;if(null!=r)"number"===n?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?At(e,t.type,r):t.hasOwnProperty("defaultValue")&&At(e,t.type,xt(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Tt(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!e.defaultChecked,e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function At(e,t,r){"number"===t&&e.ownerDocument.activeElement===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(gt,yt);vt[t]=new mt(t,1,!1,e,null,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(gt,yt);vt[t]=new mt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(gt,yt);vt[t]=new mt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1)}),["tabIndex","crossOrigin"].forEach(function(e){vt[e]=new mt(e,1,!1,e.toLowerCase(),null,!1)}),vt.xlinkHref=new mt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0),["src","href","action","formAction"].forEach(function(e){vt[e]=new mt(e,1,!1,e.toLowerCase(),null,!0)});var Ct={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}};function Et(e,t,r){return(e=le.getPooled(Ct.change,e,t,r)).type="change",Ne(r),W(e),e}var Lt=null,Nt=null;function Pt(e){L(e)}function Ot(e){if(We(I(e)))return e}function Rt(e,t){if("change"===e)return t}var Dt=!1;function Ft(){Lt&&(Lt.detachEvent("onpropertychange",kt),Nt=Lt=null)}function kt(e){if("value"===e.propertyName&&Ot(Nt))if(e=Et(Nt,e,Ve(e)),ke)L(e);else{ke=!0;try{Oe(Pt,e)}finally{ke=!1,Ie()}}}function It(e,t,r){"focus"===e?(Ft(),Nt=r,(Lt=t).attachEvent("onpropertychange",kt)):"blur"===e&&Ft()}function Bt(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Ot(Nt)}function Ut(e,t){if("click"===e)return Ot(t)}function Vt(e,t){if("input"===e||"change"===e)return Ot(t)}H&&(Dt=je("input")&&(!document.documentMode||9<document.documentMode));var jt={eventTypes:Ct,_isInputEventSupported:Dt,extractEvents:function(e,t,r,n){var i=t?I(t):window,o=void 0,a=void 0,s=i.nodeName&&i.nodeName.toLowerCase();if("select"===s||"input"===s&&"file"===i.type?o=Rt:Ue(i)?Dt?o=Vt:(o=Bt,a=It):(s=i.nodeName)&&"input"===s.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(o=Ut),o&&(o=o(e,t)))return Et(o,r,n);a&&a(e,i,t),"blur"===e&&(e=i._wrapperState)&&e.controlled&&"number"===i.type&&At(i,"number",i.value)}},zt=le.extend({view:null,detail:null}),Gt={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Wt(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Gt[e])&&!!t[e]}function Ht(){return Wt}var Xt=0,qt=0,Yt=!1,Kt=!1,Qt=zt.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:Ht,button:null,buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)},movementX:function(e){if("movementX"in e)return e.movementX;var t=Xt;return Xt=e.screenX,Yt?"mousemove"===e.type?e.screenX-t:0:(Yt=!0,0)},movementY:function(e){if("movementY"in e)return e.movementY;var t=qt;return qt=e.screenY,Kt?"mousemove"===e.type?e.screenY-t:0:(Kt=!0,0)}}),Jt=Qt.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),Zt={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},$t={eventTypes:Zt,extractEvents:function(e,t,r,n){var i="mouseover"===e||"pointerover"===e,o="mouseout"===e||"pointerout"===e;if(i&&(r.relatedTarget||r.fromElement)||!o&&!i)return null;if(i=n.window===n?n:(i=n.ownerDocument)?i.defaultView||i.parentWindow:window,o?(o=t,t=(t=r.relatedTarget||r.toElement)?F(t):null):o=null,o===t)return null;var a=void 0,s=void 0,l=void 0,u=void 0;"mouseout"===e||"mouseover"===e?(a=Qt,s=Zt.mouseLeave,l=Zt.mouseEnter,u="mouse"):"pointerout"!==e&&"pointerover"!==e||(a=Jt,s=Zt.pointerLeave,l=Zt.pointerEnter,u="pointer");var c=null==o?i:I(o);if(i=null==t?i:I(t),(e=a.getPooled(s,o,r,n)).type=u+"leave",e.target=c,e.relatedTarget=i,(r=a.getPooled(l,t,r,n)).type=u+"enter",r.target=i,r.relatedTarget=c,n=t,o&&n)e:{for(i=n,u=0,a=t=o;a;a=U(a))u++;for(a=0,l=i;l;l=U(l))a++;for(;0<u-a;)t=U(t),u--;for(;0<a-u;)i=U(i),a--;for(;u--;){if(t===i||t===i.alternate)break e;t=U(t),i=U(i)}t=null}else t=null;for(i=t,t=[];o&&o!==i&&(null===(u=o.alternate)||u!==i);)t.push(o),o=U(o);for(o=[];n&&n!==i&&(null===(u=n.alternate)||u!==i);)o.push(n),n=U(n);for(n=0;n<t.length;n++)z(t[n],"bubbled",e);for(n=o.length;0<n--;)z(o[n],"captured",r);return[e,r]}};function er(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t}var tr=Object.prototype.hasOwnProperty;function rr(e,t){if(er(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++)if(!tr.call(t,r[n])||!er(e[r[n]],t[r[n]]))return!1;return!0}function nr(e,t){return{responder:e,props:t}}function ir(e){var t=e;if(e.alternate)for(;t.return;)t=t.return;else{if(0!==(2&t.effectTag))return 1;for(;t.return;)if(0!==(2&(t=t.return).effectTag))return 1}return 3===t.tag?2:3}function or(e){if(2!==ir(e))throw a(Error(188))}function ar(e){if(!(e=function(e){var t=e.alternate;if(!t){if(3===(t=ir(e)))throw a(Error(188));return 1===t?null:e}for(var r=e,n=t;;){var i=r.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(n=i.return)){r=n;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===r)return or(i),e;if(o===n)return or(i),t;o=o.sibling}throw a(Error(188))}if(r.return!==n.return)r=i,n=o;else{for(var s=!1,l=i.child;l;){if(l===r){s=!0,r=i,n=o;break}if(l===n){s=!0,n=i,r=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===r){s=!0,r=o,n=i;break}if(l===n){s=!0,n=o,r=i;break}l=l.sibling}if(!s)throw a(Error(189))}}if(r.alternate!==n)throw a(Error(190))}if(3!==r.tag)throw a(Error(188));return r.stateNode.current===r?e:t}(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}new Map,new Map,new Set,new Map;var sr=le.extend({animationName:null,elapsedTime:null,pseudoElement:null}),lr=le.extend({clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ur=zt.extend({relatedTarget:null});function cr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}for(var hr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},pr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fr=zt.extend({key:function(e){if(e.key){var t=hr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=cr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?pr[e.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:Ht,charCode:function(e){return"keypress"===e.type?cr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?cr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),dr=Qt.extend({dataTransfer:null}),mr=zt.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:Ht}),vr=le.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),gr=Qt.extend({deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null}),yr=[["blur","blur",0],["cancel","cancel",0],["click","click",0],["close","close",0],["contextmenu","contextMenu",0],["copy","copy",0],["cut","cut",0],["auxclick","auxClick",0],["dblclick","doubleClick",0],["dragend","dragEnd",0],["dragstart","dragStart",0],["drop","drop",0],["focus","focus",0],["input","input",0],["invalid","invalid",0],["keydown","keyDown",0],["keypress","keyPress",0],["keyup","keyUp",0],["mousedown","mouseDown",0],["mouseup","mouseUp",0],["paste","paste",0],["pause","pause",0],["play","play",0],["pointercancel","pointerCancel",0],["pointerdown","pointerDown",0],["pointerup","pointerUp",0],["ratechange","rateChange",0],["reset","reset",0],["seeked","seeked",0],["submit","submit",0],["touchcancel","touchCancel",0],["touchend","touchEnd",0],["touchstart","touchStart",0],["volumechange","volumeChange",0],["drag","drag",1],["dragenter","dragEnter",1],["dragexit","dragExit",1],["dragleave","dragLeave",1],["dragover","dragOver",1],["mousemove","mouseMove",1],["mouseout","mouseOut",1],["mouseover","mouseOver",1],["pointermove","pointerMove",1],["pointerout","pointerOut",1],["pointerover","pointerOver",1],["scroll","scroll",1],["toggle","toggle",1],["touchmove","touchMove",1],["wheel","wheel",1],["abort","abort",2],[J,"animationEnd",2],[Z,"animationIteration",2],[$,"animationStart",2],["canplay","canPlay",2],["canplaythrough","canPlayThrough",2],["durationchange","durationChange",2],["emptied","emptied",2],["encrypted","encrypted",2],["ended","ended",2],["error","error",2],["gotpointercapture","gotPointerCapture",2],["load","load",2],["loadeddata","loadedData",2],["loadedmetadata","loadedMetadata",2],["loadstart","loadStart",2],["lostpointercapture","lostPointerCapture",2],["playing","playing",2],["progress","progress",2],["seeking","seeking",2],["stalled","stalled",2],["suspend","suspend",2],["timeupdate","timeUpdate",2],[ee,"transitionEnd",2],["waiting","waiting",2]],br={},xr={},wr=0;wr<yr.length;wr++){var Sr=yr[wr],Mr=Sr[0],_r=Sr[1],Tr=Sr[2],Ar="on"+(_r[0].toUpperCase()+_r.slice(1)),Cr={phasedRegistrationNames:{bubbled:Ar,captured:Ar+"Capture"},dependencies:[Mr],eventPriority:Tr};br[_r]=Cr,xr[Mr]=Cr}var Er={eventTypes:br,getEventPriority:function(e){return void 0!==(e=xr[e])?e.eventPriority:2},extractEvents:function(e,t,r,n){var i=xr[e];if(!i)return null;switch(e){case"keypress":if(0===cr(r))return null;case"keydown":case"keyup":e=fr;break;case"blur":case"focus":e=ur;break;case"click":if(2===r.button)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":e=Qt;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":e=dr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":e=mr;break;case J:case Z:case $:e=sr;break;case ee:e=vr;break;case"scroll":e=zt;break;case"wheel":e=gr;break;case"copy":case"cut":case"paste":e=lr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":e=Jt;break;default:e=le}return W(t=e.getPooled(i,t,r,n)),t}},Lr=Er.getEventPriority,Nr=[];function Pr(e){var t=e.targetInst,r=t;do{if(!r){e.ancestors.push(r);break}var n;for(n=r;n.return;)n=n.return;if(!(n=3!==n.tag?null:n.stateNode.containerInfo))break;e.ancestors.push(r),r=F(n)}while(r);for(r=0;r<e.ancestors.length;r++){t=e.ancestors[r];var i=Ve(e.nativeEvent);n=e.topLevelType;for(var o=e.nativeEvent,a=null,s=0;s<h.length;s++){var l=h[s];l&&(l=l.extractEvents(n,t,o,i))&&(a=T(a,l))}L(a)}}var Or=!0;function Rr(e,t){Dr(t,e,!1)}function Dr(e,t,r){switch(Lr(t)){case 0:var n=function(e,t,r){ke||De();var n=Fr,i=ke;ke=!0;try{Re(n,e,t,r)}finally{(ke=i)||Ie()}}.bind(null,t,1);break;case 1:n=function(e,t,r){Fr(e,t,r)}.bind(null,t,1);break;default:n=Fr.bind(null,t,1)}r?e.addEventListener(t,n,!0):e.addEventListener(t,n,!1)}function Fr(e,t,r){if(Or){if(null===(t=F(t=Ve(r)))||"number"!==typeof t.tag||2===ir(t)||(t=null),Nr.length){var n=Nr.pop();n.topLevelType=e,n.nativeEvent=r,n.targetInst=t,e=n}else e={topLevelType:e,nativeEvent:r,targetInst:t,ancestors:[]};try{if(r=e,ke)Pr(r);else{ke=!0;try{Fe(Pr,r,void 0)}finally{ke=!1,Ie()}}}finally{e.topLevelType=null,e.nativeEvent=null,e.targetInst=null,e.ancestors.length=0,10>Nr.length&&Nr.push(e)}}}var kr=new("function"===typeof WeakMap?WeakMap:Map);function Ir(e){var t=kr.get(e);return void 0===t&&(t=new Set,kr.set(e,t)),t}function Br(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Ur(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Vr(e,t){var r,n=Ur(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ur(n)}}function jr(){for(var e=window,t=Br();t instanceof e.HTMLIFrameElement;){try{var r="string"===typeof t.contentWindow.location.href}catch(n){r=!1}if(!r)break;t=Br((e=t.contentWindow).document)}return t}function zr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var Gr=H&&"documentMode"in document&&11>=document.documentMode,Wr={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},Hr=null,Xr=null,qr=null,Yr=!1;function Kr(e,t){var r=t.window===t?t.document:9===t.nodeType?t:t.ownerDocument;return Yr||null==Hr||Hr!==Br(r)?null:("selectionStart"in(r=Hr)&&zr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},qr&&rr(qr,r)?null:(qr=r,(e=le.getPooled(Wr.select,Xr,e,t)).type="select",e.target=Hr,W(e),e))}var Qr={eventTypes:Wr,extractEvents:function(e,t,r,n){var i,o=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;if(!(i=!o)){e:{o=Ir(o),i=d.onSelect;for(var a=0;a<i.length;a++)if(!o.has(i[a])){o=!1;break e}o=!0}i=!o}if(i)return null;switch(o=t?I(t):window,e){case"focus":(Ue(o)||"true"===o.contentEditable)&&(Hr=o,Xr=t,qr=null);break;case"blur":qr=Xr=Hr=null;break;case"mousedown":Yr=!0;break;case"contextmenu":case"mouseup":case"dragend":return Yr=!1,Kr(r,n);case"selectionchange":if(Gr)break;case"keydown":case"keyup":return Kr(r,n)}return null}};function Jr(e,t){return e=i({children:void 0},t),(t=function(e){var t="";return n.Children.forEach(e,function(e){null!=e&&(t+=e)}),t}(t.children))&&(e.children=t),e}function Zr(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+xt(r),t=null,i=0;i<e.length;i++){if(e[i].value===r)return e[i].selected=!0,void(n&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function $r(e,t){if(null!=t.dangerouslySetInnerHTML)throw a(Error(91));return i({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function en(e,t){var r=t.value;if(null==r){if(r=t.defaultValue,null!=(t=t.children)){if(null!=r)throw a(Error(92));if(Array.isArray(t)){if(!(1>=t.length))throw a(Error(93));t=t[0]}r=t}null==r&&(r="")}e._wrapperState={initialValue:xt(r)}}function tn(e,t){var r=xt(t.value),n=xt(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=n&&(e.defaultValue=""+n)}function rn(e){var t=e.textContent;t===e._wrapperState.initialValue&&(e.value=t)}N.injectEventPluginOrder("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),w=B,S=k,M=I,N.injectEventPluginsByName({SimpleEventPlugin:Er,EnterLeaveEventPlugin:$t,ChangeEventPlugin:jt,SelectEventPlugin:Qr,BeforeInputEventPlugin:Te});var nn={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function on(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function an(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?on(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var sn,ln=void 0,un=(sn=function(e,t){if(e.namespaceURI!==nn.svg||"innerHTML"in e)e.innerHTML=t;else{for((ln=ln||document.createElement("div")).innerHTML="<svg>"+t+"</svg>",t=ln.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction(function(){return sn(e,t)})}:sn);function cn(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var hn={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pn=["Webkit","ms","Moz","O"];function fn(e,t,r){return null==t||"boolean"===typeof t||""===t?"":r||"number"!==typeof t||0===t||hn.hasOwnProperty(e)&&hn[e]?(""+t).trim():t+"px"}function dn(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var n=0===r.indexOf("--"),i=fn(r,t[r],n);"float"===r&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}Object.keys(hn).forEach(function(e){pn.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),hn[t]=hn[e]})});var mn=i({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function vn(e,t){if(t){if(mn[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw a(Error(137),e,"");if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw a(Error(60));if(!("object"===typeof t.dangerouslySetInnerHTML&&"__html"in t.dangerouslySetInnerHTML))throw a(Error(61))}if(null!=t.style&&"object"!==typeof t.style)throw a(Error(62),"")}}function gn(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function yn(e,t){var r=Ir(e=9===e.nodeType||11===e.nodeType?e:e.ownerDocument);t=d[t];for(var n=0;n<t.length;n++){var i=t[n];if(!r.has(i)){switch(i){case"scroll":Dr(e,"scroll",!0);break;case"focus":case"blur":Dr(e,"focus",!0),Dr(e,"blur",!0),r.add("blur"),r.add("focus");break;case"cancel":case"close":je(i)&&Dr(e,i,!0);break;case"invalid":case"submit":case"reset":break;default:-1===te.indexOf(i)&&Rr(i,e)}r.add(i)}}}function bn(){}var xn=null,wn=null;function Sn(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function Mn(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var _n="function"===typeof setTimeout?setTimeout:void 0,Tn="function"===typeof clearTimeout?clearTimeout:void 0;function An(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}new Set;var Cn=[],En=-1;function Ln(e){0>En||(e.current=Cn[En],Cn[En]=null,En--)}function Nn(e,t){Cn[++En]=e.current,e.current=t}var Pn={},On={current:Pn},Rn={current:!1},Dn=Pn;function Fn(e,t){var r=e.type.contextTypes;if(!r)return Pn;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in r)o[i]=t[i];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function kn(e){return null!==(e=e.childContextTypes)&&void 0!==e}function In(e){Ln(Rn),Ln(On)}function Bn(e){Ln(Rn),Ln(On)}function Un(e,t,r){if(On.current!==Pn)throw a(Error(168));Nn(On,t),Nn(Rn,r)}function Vn(e,t,r){var n=e.stateNode;if(e=t.childContextTypes,"function"!==typeof n.getChildContext)return r;for(var o in n=n.getChildContext())if(!(o in e))throw a(Error(108),ut(t)||"Unknown",o);return i({},r,n)}function jn(e){var t=e.stateNode;return t=t&&t.__reactInternalMemoizedMergedChildContext||Pn,Dn=On.current,Nn(On,t),Nn(Rn,Rn.current),!0}function zn(e,t,r){var n=e.stateNode;if(!n)throw a(Error(169));r?(t=Vn(e,t,Dn),n.__reactInternalMemoizedMergedChildContext=t,Ln(Rn),Ln(On),Nn(On,t)):Ln(Rn),Nn(Rn,r)}var Gn=o.unstable_runWithPriority,Wn=o.unstable_scheduleCallback,Hn=o.unstable_cancelCallback,Xn=o.unstable_shouldYield,qn=o.unstable_requestPaint,Yn=o.unstable_now,Kn=o.unstable_getCurrentPriorityLevel,Qn=o.unstable_ImmediatePriority,Jn=o.unstable_UserBlockingPriority,Zn=o.unstable_NormalPriority,$n=o.unstable_LowPriority,ei=o.unstable_IdlePriority,ti={},ri=void 0!==qn?qn:function(){},ni=null,ii=null,oi=!1,ai=Yn(),si=1e4>ai?Yn:function(){return Yn()-ai};function li(){switch(Kn()){case Qn:return 99;case Jn:return 98;case Zn:return 97;case $n:return 96;case ei:return 95;default:throw a(Error(332))}}function ui(e){switch(e){case 99:return Qn;case 98:return Jn;case 97:return Zn;case 96:return $n;case 95:return ei;default:throw a(Error(332))}}function ci(e,t){return e=ui(e),Gn(e,t)}function hi(e,t,r){return e=ui(e),Wn(e,t,r)}function pi(e){return null===ni?(ni=[e],ii=Wn(Qn,di)):ni.push(e),ti}function fi(){null!==ii&&Hn(ii),di()}function di(){if(!oi&&null!==ni){oi=!0;var e=0;try{var t=ni;ci(99,function(){for(;e<t.length;e++){var r=t[e];do{r=r(!0)}while(null!==r)}}),ni=null}catch(r){throw null!==ni&&(ni=ni.slice(e+1)),Wn(Qn,fi),r}finally{oi=!1}}}function mi(e,t){return 1073741823===t?99:1===t?95:0>=(e=10*(1073741821-t)-10*(1073741821-e))?99:250>=e?98:5250>=e?97:95}function vi(e,t){if(e&&e.defaultProps)for(var r in t=i({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}var gi={current:null},yi=null,bi=null,xi=null;function wi(){xi=bi=yi=null}function Si(e,t){var r=e.type._context;Nn(gi,r._currentValue),r._currentValue=t}function Mi(e){var t=gi.current;Ln(gi),e.type._context._currentValue=t}function _i(e,t){for(;null!==e;){var r=e.alternate;if(e.childExpirationTime<t)e.childExpirationTime=t,null!==r&&r.childExpirationTime<t&&(r.childExpirationTime=t);else{if(!(null!==r&&r.childExpirationTime<t))break;r.childExpirationTime=t}e=e.return}}function Ti(e,t){yi=e,xi=bi=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(e.expirationTime>=t&&(ua=!0),e.firstContext=null)}function Ai(e,t){if(xi!==e&&!1!==t&&0!==t)if("number"===typeof t&&1073741823!==t||(xi=e,t=1073741823),t={context:e,observedBits:t,next:null},null===bi){if(null===yi)throw a(Error(308));bi=t,yi.dependencies={expirationTime:0,firstContext:t,responders:null}}else bi=bi.next=t;return e._currentValue}var Ci=!1;function Ei(e){return{baseState:e,firstUpdate:null,lastUpdate:null,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null}}function Li(e){return{baseState:e.baseState,firstUpdate:e.firstUpdate,lastUpdate:e.lastUpdate,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null}}function Ni(e,t){return{expirationTime:e,suspenseConfig:t,tag:0,payload:null,callback:null,next:null,nextEffect:null}}function Pi(e,t){null===e.lastUpdate?e.firstUpdate=e.lastUpdate=t:(e.lastUpdate.next=t,e.lastUpdate=t)}function Oi(e,t){var r=e.alternate;if(null===r){var n=e.updateQueue,i=null;null===n&&(n=e.updateQueue=Ei(e.memoizedState))}else n=e.updateQueue,i=r.updateQueue,null===n?null===i?(n=e.updateQueue=Ei(e.memoizedState),i=r.updateQueue=Ei(r.memoizedState)):n=e.updateQueue=Li(i):null===i&&(i=r.updateQueue=Li(n));null===i||n===i?Pi(n,t):null===n.lastUpdate||null===i.lastUpdate?(Pi(n,t),Pi(i,t)):(Pi(n,t),i.lastUpdate=t)}function Ri(e,t){var r=e.updateQueue;null===(r=null===r?e.updateQueue=Ei(e.memoizedState):Di(e,r)).lastCapturedUpdate?r.firstCapturedUpdate=r.lastCapturedUpdate=t:(r.lastCapturedUpdate.next=t,r.lastCapturedUpdate=t)}function Di(e,t){var r=e.alternate;return null!==r&&t===r.updateQueue&&(t=e.updateQueue=Li(t)),t}function Fi(e,t,r,n,o,a){switch(r.tag){case 1:return"function"===typeof(e=r.payload)?e.call(a,n,o):e;case 3:e.effectTag=-2049&e.effectTag|64;case 0:if(null===(o="function"===typeof(e=r.payload)?e.call(a,n,o):e)||void 0===o)break;return i({},n,o);case 2:Ci=!0}return n}function ki(e,t,r,n,i){Ci=!1;for(var o=(t=Di(e,t)).baseState,a=null,s=0,l=t.firstUpdate,u=o;null!==l;){var c=l.expirationTime;c<i?(null===a&&(a=l,o=u),s<c&&(s=c)):(Vs(c,l.suspenseConfig),u=Fi(e,0,l,u,r,n),null!==l.callback&&(e.effectTag|=32,l.nextEffect=null,null===t.lastEffect?t.firstEffect=t.lastEffect=l:(t.lastEffect.nextEffect=l,t.lastEffect=l))),l=l.next}for(c=null,l=t.firstCapturedUpdate;null!==l;){var h=l.expirationTime;h<i?(null===c&&(c=l,null===a&&(o=u)),s<h&&(s=h)):(u=Fi(e,0,l,u,r,n),null!==l.callback&&(e.effectTag|=32,l.nextEffect=null,null===t.lastCapturedEffect?t.firstCapturedEffect=t.lastCapturedEffect=l:(t.lastCapturedEffect.nextEffect=l,t.lastCapturedEffect=l))),l=l.next}null===a&&(t.lastUpdate=null),null===c?t.lastCapturedUpdate=null:e.effectTag|=32,null===a&&null===c&&(o=u),t.baseState=o,t.firstUpdate=a,t.firstCapturedUpdate=c,e.expirationTime=s,e.memoizedState=u}function Ii(e,t,r){null!==t.firstCapturedUpdate&&(null!==t.lastUpdate&&(t.lastUpdate.next=t.firstCapturedUpdate,t.lastUpdate=t.lastCapturedUpdate),t.firstCapturedUpdate=t.lastCapturedUpdate=null),Bi(t.firstEffect,r),t.firstEffect=t.lastEffect=null,Bi(t.firstCapturedEffect,r),t.firstCapturedEffect=t.lastCapturedEffect=null}function Bi(e,t){for(;null!==e;){var r=e.callback;if(null!==r){e.callback=null;var n=t;if("function"!==typeof r)throw a(Error(191),r);r.call(n)}e=e.nextEffect}}var Ui=He.ReactCurrentBatchConfig,Vi=(new n.Component).refs;function ji(e,t,r,n){r=null===(r=r(n,t=e.memoizedState))||void 0===r?t:i({},t,r),e.memoizedState=r,null!==(n=e.updateQueue)&&0===e.expirationTime&&(n.baseState=r)}var zi={isMounted:function(e){return!!(e=e._reactInternalFiber)&&2===ir(e)},enqueueSetState:function(e,t,r){e=e._reactInternalFiber;var n=Cs(),i=Ui.suspense;(i=Ni(n=Es(n,e,i),i)).payload=t,void 0!==r&&null!==r&&(i.callback=r),Oi(e,i),Ns(e,n)},enqueueReplaceState:function(e,t,r){e=e._reactInternalFiber;var n=Cs(),i=Ui.suspense;(i=Ni(n=Es(n,e,i),i)).tag=1,i.payload=t,void 0!==r&&null!==r&&(i.callback=r),Oi(e,i),Ns(e,n)},enqueueForceUpdate:function(e,t){e=e._reactInternalFiber;var r=Cs(),n=Ui.suspense;(n=Ni(r=Es(r,e,n),n)).tag=2,void 0!==t&&null!==t&&(n.callback=t),Oi(e,n),Ns(e,r)}};function Gi(e,t,r,n,i,o,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,o,a):!t.prototype||!t.prototype.isPureReactComponent||(!rr(r,n)||!rr(i,o))}function Wi(e,t,r){var n=!1,i=Pn,o=t.contextType;return"object"===typeof o&&null!==o?o=Ai(o):(i=kn(t)?Dn:On.current,o=(n=null!==(n=t.contextTypes)&&void 0!==n)?Fn(e,i):Pn),t=new t(r,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=zi,e.stateNode=t,t._reactInternalFiber=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function Hi(e,t,r,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&zi.enqueueReplaceState(t,t.state,null)}function Xi(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs=Vi;var o=t.contextType;"object"===typeof o&&null!==o?i.context=Ai(o):(o=kn(t)?Dn:On.current,i.context=Fn(e,o)),null!==(o=e.updateQueue)&&(ki(e,o,r,i,n),i.state=e.memoizedState),"function"===typeof(o=t.getDerivedStateFromProps)&&(ji(e,t,o,r),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&zi.enqueueReplaceState(i,i.state,null),null!==(o=e.updateQueue)&&(ki(e,o,r,i,n),i.state=e.memoizedState)),"function"===typeof i.componentDidMount&&(e.effectTag|=4)}var qi=Array.isArray;function Yi(e,t,r){if(null!==(e=r.ref)&&"function"!==typeof e&&"object"!==typeof e){if(r._owner){r=r._owner;var n=void 0;if(r){if(1!==r.tag)throw a(Error(309));n=r.stateNode}if(!n)throw a(Error(147),e);var i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:((t=function(e){var t=n.refs;t===Vi&&(t=n.refs={}),null===e?delete t[i]:t[i]=e})._stringRef=i,t)}if("string"!==typeof e)throw a(Error(284));if(!r._owner)throw a(Error(290),e)}return e}function Ki(e,t){if("textarea"!==e.type)throw a(Error(31),"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t,"")}function Qi(e){function t(t,r){if(e){var n=t.lastEffect;null!==n?(n.nextEffect=r,t.lastEffect=r):t.firstEffect=t.lastEffect=r,r.nextEffect=null,r.effectTag=8}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t,r){return(e=el(e,t)).index=0,e.sibling=null,e}function o(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.effectTag=2,r):n:(t.effectTag=2,r):r}function s(t){return e&&null===t.alternate&&(t.effectTag=2),t}function l(e,t,r,n){return null===t||6!==t.tag?((t=nl(r,e.mode,n)).return=e,t):((t=i(t,r)).return=e,t)}function u(e,t,r,n){return null!==t&&t.elementType===r.type?((n=i(t,r.props)).ref=Yi(e,t,r),n.return=e,n):((n=tl(r.type,r.key,r.props,null,e.mode,n)).ref=Yi(e,t,r),n.return=e,n)}function c(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=il(r,e.mode,n)).return=e,t):((t=i(t,r.children||[])).return=e,t)}function h(e,t,r,n,o){return null===t||7!==t.tag?((t=rl(r,e.mode,n,o)).return=e,t):((t=i(t,r)).return=e,t)}function p(e,t,r){if("string"===typeof t||"number"===typeof t)return(t=nl(""+t,e.mode,r)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case Ye:return(r=tl(t.type,t.key,t.props,null,e.mode,r)).ref=Yi(e,null,t),r.return=e,r;case Ke:return(t=il(t,e.mode,r)).return=e,t}if(qi(t)||lt(t))return(t=rl(t,e.mode,r,null)).return=e,t;Ki(e,t)}return null}function f(e,t,r,n){var i=null!==t?t.key:null;if("string"===typeof r||"number"===typeof r)return null!==i?null:l(e,t,""+r,n);if("object"===typeof r&&null!==r){switch(r.$$typeof){case Ye:return r.key===i?r.type===Qe?h(e,t,r.props.children,n,i):u(e,t,r,n):null;case Ke:return r.key===i?c(e,t,r,n):null}if(qi(r)||lt(r))return null!==i?null:h(e,t,r,n,null);Ki(e,r)}return null}function d(e,t,r,n,i){if("string"===typeof n||"number"===typeof n)return l(t,e=e.get(r)||null,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case Ye:return e=e.get(null===n.key?r:n.key)||null,n.type===Qe?h(t,e,n.props.children,i,n.key):u(t,e,n,i);case Ke:return c(t,e=e.get(null===n.key?r:n.key)||null,n,i)}if(qi(n)||lt(n))return h(t,e=e.get(r)||null,n,i,null);Ki(t,n)}return null}function m(i,a,s,l){for(var u=null,c=null,h=a,m=a=0,v=null;null!==h&&m<s.length;m++){h.index>m?(v=h,h=null):v=h.sibling;var g=f(i,h,s[m],l);if(null===g){null===h&&(h=v);break}e&&h&&null===g.alternate&&t(i,h),a=o(g,a,m),null===c?u=g:c.sibling=g,c=g,h=v}if(m===s.length)return r(i,h),u;if(null===h){for(;m<s.length;m++)null!==(h=p(i,s[m],l))&&(a=o(h,a,m),null===c?u=h:c.sibling=h,c=h);return u}for(h=n(i,h);m<s.length;m++)null!==(v=d(h,i,m,s[m],l))&&(e&&null!==v.alternate&&h.delete(null===v.key?m:v.key),a=o(v,a,m),null===c?u=v:c.sibling=v,c=v);return e&&h.forEach(function(e){return t(i,e)}),u}function v(i,s,l,u){var c=lt(l);if("function"!==typeof c)throw a(Error(150));if(null==(l=c.call(l)))throw a(Error(151));for(var h=c=null,m=s,v=s=0,g=null,y=l.next();null!==m&&!y.done;v++,y=l.next()){m.index>v?(g=m,m=null):g=m.sibling;var b=f(i,m,y.value,u);if(null===b){null===m&&(m=g);break}e&&m&&null===b.alternate&&t(i,m),s=o(b,s,v),null===h?c=b:h.sibling=b,h=b,m=g}if(y.done)return r(i,m),c;if(null===m){for(;!y.done;v++,y=l.next())null!==(y=p(i,y.value,u))&&(s=o(y,s,v),null===h?c=y:h.sibling=y,h=y);return c}for(m=n(i,m);!y.done;v++,y=l.next())null!==(y=d(m,i,v,y.value,u))&&(e&&null!==y.alternate&&m.delete(null===y.key?v:y.key),s=o(y,s,v),null===h?c=y:h.sibling=y,h=y);return e&&m.forEach(function(e){return t(i,e)}),c}return function(e,n,o,l){var u="object"===typeof o&&null!==o&&o.type===Qe&&null===o.key;u&&(o=o.props.children);var c="object"===typeof o&&null!==o;if(c)switch(o.$$typeof){case Ye:e:{for(c=o.key,u=n;null!==u;){if(u.key===c){if(7===u.tag?o.type===Qe:u.elementType===o.type){r(e,u.sibling),(n=i(u,o.type===Qe?o.props.children:o.props)).ref=Yi(e,u,o),n.return=e,e=n;break e}r(e,u);break}t(e,u),u=u.sibling}o.type===Qe?((n=rl(o.props.children,e.mode,l,o.key)).return=e,e=n):((l=tl(o.type,o.key,o.props,null,e.mode,l)).ref=Yi(e,n,o),l.return=e,e=l)}return s(e);case Ke:e:{for(u=o.key;null!==n;){if(n.key===u){if(4===n.tag&&n.stateNode.containerInfo===o.containerInfo&&n.stateNode.implementation===o.implementation){r(e,n.sibling),(n=i(n,o.children||[])).return=e,e=n;break e}r(e,n);break}t(e,n),n=n.sibling}(n=il(o,e.mode,l)).return=e,e=n}return s(e)}if("string"===typeof o||"number"===typeof o)return o=""+o,null!==n&&6===n.tag?(r(e,n.sibling),(n=i(n,o)).return=e,e=n):(r(e,n),(n=nl(o,e.mode,l)).return=e,e=n),s(e);if(qi(o))return m(e,n,o,l);if(lt(o))return v(e,n,o,l);if(c&&Ki(e,o),"undefined"===typeof o&&!u)switch(e.tag){case 1:case 0:throw e=e.type,a(Error(152),e.displayName||e.name||"Component")}return r(e,n)}}var Ji=Qi(!0),Zi=Qi(!1),$i={},eo={current:$i},to={current:$i},ro={current:$i};function no(e){if(e===$i)throw a(Error(174));return e}function io(e,t){Nn(ro,t),Nn(to,e),Nn(eo,$i);var r=t.nodeType;switch(r){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:an(null,"");break;default:t=an(t=(r=8===r?t.parentNode:t).namespaceURI||null,r=r.tagName)}Ln(eo),Nn(eo,t)}function oo(e){Ln(eo),Ln(to),Ln(ro)}function ao(e){no(ro.current);var t=no(eo.current),r=an(t,e.type);t!==r&&(Nn(to,e),Nn(eo,r))}function so(e){to.current===e&&(Ln(eo),Ln(to))}var lo=1,uo=1,co=2,ho={current:0};function po(e){for(var t=e;null!==t;){if(13===t.tag){if(null!==t.memoizedState)return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(64&t.effectTag))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var fo=0,mo=2,vo=4,go=8,yo=16,bo=32,xo=64,wo=128,So=He.ReactCurrentDispatcher,Mo=0,_o=null,To=null,Ao=null,Co=null,Eo=null,Lo=null,No=0,Po=null,Oo=0,Ro=!1,Do=null,Fo=0;function ko(){throw a(Error(321))}function Io(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!er(e[r],t[r]))return!1;return!0}function Bo(e,t,r,n,i,o){if(Mo=o,_o=t,Ao=null!==e?e.memoizedState:null,So.current=null===Ao?Jo:Zo,t=r(n,i),Ro){do{Ro=!1,Fo+=1,Ao=null!==e?e.memoizedState:null,Lo=Co,Po=Eo=To=null,So.current=Zo,t=r(n,i)}while(Ro);Do=null,Fo=0}if(So.current=Qo,(e=_o).memoizedState=Co,e.expirationTime=No,e.updateQueue=Po,e.effectTag|=Oo,e=null!==To&&null!==To.next,Mo=0,Lo=Eo=Co=Ao=To=_o=null,No=0,Po=null,Oo=0,e)throw a(Error(300));return t}function Uo(){So.current=Qo,Mo=0,Lo=Eo=Co=Ao=To=_o=null,No=0,Po=null,Oo=0,Ro=!1,Do=null,Fo=0}function Vo(){var e={memoizedState:null,baseState:null,queue:null,baseUpdate:null,next:null};return null===Eo?Co=Eo=e:Eo=Eo.next=e,Eo}function jo(){if(null!==Lo)Lo=(Eo=Lo).next,Ao=null!==(To=Ao)?To.next:null;else{if(null===Ao)throw a(Error(310));var e={memoizedState:(To=Ao).memoizedState,baseState:To.baseState,queue:To.queue,baseUpdate:To.baseUpdate,next:null};Eo=null===Eo?Co=e:Eo.next=e,Ao=To.next}return Eo}function zo(e,t){return"function"===typeof t?t(e):t}function Go(e){var t=jo(),r=t.queue;if(null===r)throw a(Error(311));if(r.lastRenderedReducer=e,0<Fo){var n=r.dispatch;if(null!==Do){var i=Do.get(r);if(void 0!==i){Do.delete(r);var o=t.memoizedState;do{o=e(o,i.action),i=i.next}while(null!==i);return er(o,t.memoizedState)||(ua=!0),t.memoizedState=o,t.baseUpdate===r.last&&(t.baseState=o),r.lastRenderedState=o,[o,n]}}return[t.memoizedState,n]}n=r.last;var s=t.baseUpdate;if(o=t.baseState,null!==s?(null!==n&&(n.next=null),n=s.next):n=null!==n?n.next:null,null!==n){var l=i=null,u=n,c=!1;do{var h=u.expirationTime;h<Mo?(c||(c=!0,l=s,i=o),h>No&&(No=h)):(Vs(h,u.suspenseConfig),o=u.eagerReducer===e?u.eagerState:e(o,u.action)),s=u,u=u.next}while(null!==u&&u!==n);c||(l=s,i=o),er(o,t.memoizedState)||(ua=!0),t.memoizedState=o,t.baseUpdate=l,t.baseState=i,r.lastRenderedState=o}return[t.memoizedState,r.dispatch]}function Wo(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},null===Po?(Po={lastEffect:null}).lastEffect=e.next=e:null===(t=Po.lastEffect)?Po.lastEffect=e.next=e:(r=t.next,t.next=e,e.next=r,Po.lastEffect=e),e}function Ho(e,t,r,n){var i=Vo();Oo|=e,i.memoizedState=Wo(t,r,void 0,void 0===n?null:n)}function Xo(e,t,r,n){var i=jo();n=void 0===n?null:n;var o=void 0;if(null!==To){var a=To.memoizedState;if(o=a.destroy,null!==n&&Io(n,a.deps))return void Wo(fo,r,o,n)}Oo|=e,i.memoizedState=Wo(t,r,o,n)}function qo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Yo(){}function Ko(e,t,r){if(!(25>Fo))throw a(Error(301));var n=e.alternate;if(e===_o||null!==n&&n===_o)if(Ro=!0,e={expirationTime:Mo,suspenseConfig:null,action:r,eagerReducer:null,eagerState:null,next:null},null===Do&&(Do=new Map),void 0===(r=Do.get(t)))Do.set(t,e);else{for(t=r;null!==t.next;)t=t.next;t.next=e}else{var i=Cs(),o=Ui.suspense;o={expirationTime:i=Es(i,e,o),suspenseConfig:o,action:r,eagerReducer:null,eagerState:null,next:null};var s=t.last;if(null===s)o.next=o;else{var l=s.next;null!==l&&(o.next=l),s.next=o}if(t.last=o,0===e.expirationTime&&(null===n||0===n.expirationTime)&&null!==(n=t.lastRenderedReducer))try{var u=t.lastRenderedState,c=n(u,r);if(o.eagerReducer=n,o.eagerState=c,er(c,u))return}catch(h){}Ns(e,i)}}var Qo={readContext:Ai,useCallback:ko,useContext:ko,useEffect:ko,useImperativeHandle:ko,useLayoutEffect:ko,useMemo:ko,useReducer:ko,useRef:ko,useState:ko,useDebugValue:ko,useResponder:ko},Jo={readContext:Ai,useCallback:function(e,t){return Vo().memoizedState=[e,void 0===t?null:t],e},useContext:Ai,useEffect:function(e,t){return Ho(516,wo|xo,e,t)},useImperativeHandle:function(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Ho(4,vo|bo,qo.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Ho(4,vo|bo,e,t)},useMemo:function(e,t){var r=Vo();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Vo();return t=void 0!==r?r(t):t,n.memoizedState=n.baseState=t,e=(e=n.queue={last:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=Ko.bind(null,_o,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},Vo().memoizedState=e},useState:function(e){var t=Vo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={last:null,dispatch:null,lastRenderedReducer:zo,lastRenderedState:e}).dispatch=Ko.bind(null,_o,e),[t.memoizedState,e]},useDebugValue:Yo,useResponder:nr},Zo={readContext:Ai,useCallback:function(e,t){var r=jo();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&Io(t,n[1])?n[0]:(r.memoizedState=[e,t],e)},useContext:Ai,useEffect:function(e,t){return Xo(516,wo|xo,e,t)},useImperativeHandle:function(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Xo(4,vo|bo,qo.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Xo(4,vo|bo,e,t)},useMemo:function(e,t){var r=jo();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&Io(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)},useReducer:Go,useRef:function(){return jo().memoizedState},useState:function(e){return Go(zo)},useDebugValue:Yo,useResponder:nr},$o=null,ea=null,ta=!1;function ra(e,t){var r=Zs(5,null,null,0);r.elementType="DELETED",r.type="DELETED",r.stateNode=t,r.return=e,r.effectTag=8,null!==e.lastEffect?(e.lastEffect.nextEffect=r,e.lastEffect=r):e.firstEffect=e.lastEffect=r}function na(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);case 13:default:return!1}}function ia(e){if(ta){var t=ea;if(t){var r=t;if(!na(e,t)){if(!(t=An(r.nextSibling))||!na(e,t))return e.effectTag|=2,ta=!1,void($o=e);ra($o,r)}$o=e,ea=An(t.firstChild)}else e.effectTag|=2,ta=!1,$o=e}}function oa(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&18!==e.tag;)e=e.return;$o=e}function aa(e){if(e!==$o)return!1;if(!ta)return oa(e),ta=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!Mn(t,e.memoizedProps))for(t=ea;t;)ra(e,t),t=An(t.nextSibling);return oa(e),ea=$o?An(e.stateNode.nextSibling):null,!0}function sa(){ea=$o=null,ta=!1}var la=He.ReactCurrentOwner,ua=!1;function ca(e,t,r,n){t.child=null===e?Zi(t,null,r,n):Ji(t,e.child,r,n)}function ha(e,t,r,n,i){r=r.render;var o=t.ref;return Ti(t,i),n=Bo(e,t,r,n,o,i),null===e||ua?(t.effectTag|=1,ca(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.effectTag&=-517,e.expirationTime<=i&&(e.expirationTime=0),Ma(e,t,i))}function pa(e,t,r,n,i,o){if(null===e){var a=r.type;return"function"!==typeof a||$s(a)||void 0!==a.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=tl(r.type,null,n,null,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,fa(e,t,a,n,i,o))}return a=e.child,i<o&&(i=a.memoizedProps,(r=null!==(r=r.compare)?r:rr)(i,n)&&e.ref===t.ref)?Ma(e,t,o):(t.effectTag|=1,(e=el(a,n)).ref=t.ref,e.return=t,t.child=e)}function fa(e,t,r,n,i,o){return null!==e&&rr(e.memoizedProps,n)&&e.ref===t.ref&&(ua=!1,i<o)?Ma(e,t,o):ma(e,t,r,n,o)}function da(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.effectTag|=128)}function ma(e,t,r,n,i){var o=kn(r)?Dn:On.current;return o=Fn(t,o),Ti(t,i),r=Bo(e,t,r,n,o,i),null===e||ua?(t.effectTag|=1,ca(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.effectTag&=-517,e.expirationTime<=i&&(e.expirationTime=0),Ma(e,t,i))}function va(e,t,r,n,i){if(kn(r)){var o=!0;jn(t)}else o=!1;if(Ti(t,i),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),Wi(t,r,n),Xi(t,r,n,i),n=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var l=a.context,u=r.contextType;"object"===typeof u&&null!==u?u=Ai(u):u=Fn(t,u=kn(r)?Dn:On.current);var c=r.getDerivedStateFromProps,h="function"===typeof c||"function"===typeof a.getSnapshotBeforeUpdate;h||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==n||l!==u)&&Hi(t,a,n,u),Ci=!1;var p=t.memoizedState;l=a.state=p;var f=t.updateQueue;null!==f&&(ki(t,f,n,a,i),l=t.memoizedState),s!==n||p!==l||Rn.current||Ci?("function"===typeof c&&(ji(t,r,c,n),l=t.memoizedState),(s=Ci||Gi(t,r,s,n,p,l,u))?(h||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.effectTag|=4)):("function"===typeof a.componentDidMount&&(t.effectTag|=4),t.memoizedProps=n,t.memoizedState=l),a.props=n,a.state=l,a.context=u,n=s):("function"===typeof a.componentDidMount&&(t.effectTag|=4),n=!1)}else a=t.stateNode,s=t.memoizedProps,a.props=t.type===t.elementType?s:vi(t.type,s),l=a.context,"object"===typeof(u=r.contextType)&&null!==u?u=Ai(u):u=Fn(t,u=kn(r)?Dn:On.current),(h="function"===typeof(c=r.getDerivedStateFromProps)||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==n||l!==u)&&Hi(t,a,n,u),Ci=!1,l=t.memoizedState,p=a.state=l,null!==(f=t.updateQueue)&&(ki(t,f,n,a,i),p=t.memoizedState),s!==n||l!==p||Rn.current||Ci?("function"===typeof c&&(ji(t,r,c,n),p=t.memoizedState),(c=Ci||Gi(t,r,s,n,l,p,u))?(h||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(n,p,u),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(n,p,u)),"function"===typeof a.componentDidUpdate&&(t.effectTag|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.effectTag|=256)):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=256),t.memoizedProps=n,t.memoizedState=p),a.props=n,a.state=p,a.context=u,n=c):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=256),n=!1);return ga(e,t,r,n,o,i)}function ga(e,t,r,n,i,o){da(e,t);var a=0!==(64&t.effectTag);if(!n&&!a)return i&&zn(t,r,!1),Ma(e,t,o);n=t.stateNode,la.current=t;var s=a&&"function"!==typeof r.getDerivedStateFromError?null:n.render();return t.effectTag|=1,null!==e&&a?(t.child=Ji(t,e.child,null,o),t.child=Ji(t,null,s,o)):ca(e,t,s,o),t.memoizedState=n.state,i&&zn(t,r,!0),t.child}function ya(e){var t=e.stateNode;t.pendingContext?Un(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Un(0,t.context,!1),io(e,t.containerInfo)}var ba={};function xa(e,t,r){var n,i=t.mode,o=t.pendingProps,a=ho.current,s=null,l=!1;if((n=0!==(64&t.effectTag))||(n=0!==(a&co)&&(null===e||null!==e.memoizedState)),n?(s=ba,l=!0,t.effectTag&=-65):null!==e&&null===e.memoizedState||void 0===o.fallback||!0===o.unstable_avoidThisFallback||(a|=uo),Nn(ho,a&=lo),null===e)if(l){if(o=o.fallback,(e=rl(null,i,0,null)).return=t,0===(2&t.mode))for(l=null!==t.memoizedState?t.child.child:t.child,e.child=l;null!==l;)l.return=e,l=l.sibling;(r=rl(o,i,r,null)).return=t,e.sibling=r,i=e}else i=r=Zi(t,null,o.children,r);else{if(null!==e.memoizedState)if(i=(a=e.child).sibling,l){if(o=o.fallback,(r=el(a,a.pendingProps)).return=t,0===(2&t.mode)&&(l=null!==t.memoizedState?t.child.child:t.child)!==a.child)for(r.child=l;null!==l;)l.return=r,l=l.sibling;(o=el(i,o,i.expirationTime)).return=t,r.sibling=o,i=r,r.childExpirationTime=0,r=o}else i=r=Ji(t,a.child,o.children,r);else if(a=e.child,l){if(l=o.fallback,(o=rl(null,i,0,null)).return=t,o.child=a,null!==a&&(a.return=o),0===(2&t.mode))for(a=null!==t.memoizedState?t.child.child:t.child,o.child=a;null!==a;)a.return=o,a=a.sibling;(r=rl(l,i,r,null)).return=t,o.sibling=r,r.effectTag|=2,i=o,o.childExpirationTime=0}else r=i=Ji(t,a,o.children,r);t.stateNode=e.stateNode}return t.memoizedState=s,t.child=i,r}function wa(e,t,r,n,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,last:n,tail:r,tailExpiration:0,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.last=n,o.tail=r,o.tailExpiration=0,o.tailMode=i)}function Sa(e,t,r){var n=t.pendingProps,i=n.revealOrder,o=n.tail;if(ca(e,t,n.children,r),0!==((n=ho.current)&co))n=n&lo|co,t.effectTag|=64;else{if(null!==e&&0!==(64&e.effectTag))e:for(e=t.child;null!==e;){if(13===e.tag){if(null!==e.memoizedState){e.expirationTime<r&&(e.expirationTime=r);var a=e.alternate;null!==a&&a.expirationTime<r&&(a.expirationTime=r),_i(e.return,r)}}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=lo}if(Nn(ho,n),0===(2&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;null!==r;)null!==(n=r.alternate)&&null===po(n)&&(i=r),r=r.sibling;null===(r=i)?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),wa(t,!1,i,r,o);break;case"backwards":for(r=null,i=t.child,t.child=null;null!==i;){if(null!==(n=i.alternate)&&null===po(n)){t.child=i;break}n=i.sibling,i.sibling=r,r=i,i=n}wa(t,!0,r,null,o);break;case"together":wa(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ma(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),t.childExpirationTime<r)return null;if(null!==e&&t.child!==e.child)throw a(Error(153));if(null!==t.child){for(r=el(e=t.child,e.pendingProps,e.expirationTime),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=el(e,e.pendingProps,e.expirationTime)).return=t;r.sibling=null}return t.child}function _a(e){e.effectTag|=4}var Ta=void 0,Aa=void 0,Ca=void 0,Ea=void 0;function La(e,t){switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Na(e){switch(e.tag){case 1:kn(e.type)&&In();var t=e.effectTag;return 2048&t?(e.effectTag=-2049&t|64,e):null;case 3:if(oo(),Bn(),0!==(64&(t=e.effectTag)))throw a(Error(285));return e.effectTag=-2049&t|64,e;case 5:return so(e),null;case 13:return Ln(ho),2048&(t=e.effectTag)?(e.effectTag=-2049&t|64,e):null;case 18:return null;case 19:return Ln(ho),null;case 4:return oo(),null;case 10:return Mi(e),null;default:return null}}function Pa(e,t){return{value:e,source:t,stack:ct(t)}}Ta=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(20===r.tag)e.appendChild(r.stateNode.instance);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},Aa=function(){},Ca=function(e,t,r,n,o){var a=e.memoizedProps;if(a!==n){var s=t.stateNode;switch(no(eo.current),e=null,r){case"input":a=wt(s,a),n=wt(s,n),e=[];break;case"option":a=Jr(s,a),n=Jr(s,n),e=[];break;case"select":a=i({},a,{value:void 0}),n=i({},n,{value:void 0}),e=[];break;case"textarea":a=$r(s,a),n=$r(s,n),e=[];break;default:"function"!==typeof a.onClick&&"function"===typeof n.onClick&&(s.onclick=bn)}vn(r,n),s=r=void 0;var l=null;for(r in a)if(!n.hasOwnProperty(r)&&a.hasOwnProperty(r)&&null!=a[r])if("style"===r){var u=a[r];for(s in u)u.hasOwnProperty(s)&&(l||(l={}),l[s]="")}else"dangerouslySetInnerHTML"!==r&&"children"!==r&&"suppressContentEditableWarning"!==r&&"suppressHydrationWarning"!==r&&"autoFocus"!==r&&(f.hasOwnProperty(r)?e||(e=[]):(e=e||[]).push(r,null));for(r in n){var c=n[r];if(u=null!=a?a[r]:void 0,n.hasOwnProperty(r)&&c!==u&&(null!=c||null!=u))if("style"===r)if(u){for(s in u)!u.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(l||(l={}),l[s]="");for(s in c)c.hasOwnProperty(s)&&u[s]!==c[s]&&(l||(l={}),l[s]=c[s])}else l||(e||(e=[]),e.push(r,l)),l=c;else"dangerouslySetInnerHTML"===r?(c=c?c.__html:void 0,u=u?u.__html:void 0,null!=c&&u!==c&&(e=e||[]).push(r,""+c)):"children"===r?u===c||"string"!==typeof c&&"number"!==typeof c||(e=e||[]).push(r,""+c):"suppressContentEditableWarning"!==r&&"suppressHydrationWarning"!==r&&(f.hasOwnProperty(r)?(null!=c&&yn(o,r),e||u===c||(e=[])):(e=e||[]).push(r,c))}l&&(e=e||[]).push("style",l),o=e,(t.updateQueue=o)&&_a(t)}},Ea=function(e,t,r,n){r!==n&&_a(t)};var Oa="function"===typeof WeakSet?WeakSet:Set;function Ra(e,t){var r=t.source,n=t.stack;null===n&&null!==r&&(n=ct(r)),null!==r&&ut(r.type),t=t.value,null!==e&&1===e.tag&&ut(e.type);try{console.error(t)}catch(i){setTimeout(function(){throw i})}}function Da(e){var t=e.ref;if(null!==t)if("function"===typeof t)try{t(null)}catch(r){Xs(e,r)}else t.current=null}function Fa(e,t,r){if(null!==(r=null!==(r=r.updateQueue)?r.lastEffect:null)){var n=r=r.next;do{if((n.tag&e)!==fo){var i=n.destroy;n.destroy=void 0,void 0!==i&&i()}(n.tag&t)!==fo&&(i=n.create,n.destroy=i()),n=n.next}while(n!==r)}}function ka(e,t){switch("function"===typeof Qs&&Qs(e),e.tag){case 0:case 11:case 14:case 15:var r=e.updateQueue;if(null!==r&&null!==(r=r.lastEffect)){var n=r.next;ci(97<t?97:t,function(){var t=n;do{var r=t.destroy;if(void 0!==r){var i=e;try{r()}catch(o){Xs(i,o)}}t=t.next}while(t!==n)})}break;case 1:Da(e),"function"===typeof(t=e.stateNode).componentWillUnmount&&function(e,t){try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(r){Xs(e,r)}}(e,t);break;case 5:Da(e);break;case 4:Va(e,t)}}function Ia(e,t){for(var r=e;;)if(ka(r,t),null!==r.child&&4!==r.tag)r.child.return=r,r=r.child;else{if(r===e)break;for(;null===r.sibling;){if(null===r.return||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}}function Ba(e){return 5===e.tag||3===e.tag||4===e.tag}function Ua(e){e:{for(var t=e.return;null!==t;){if(Ba(t)){var r=t;break e}t=t.return}throw a(Error(160))}switch(t=r.stateNode,r.tag){case 5:var n=!1;break;case 3:case 4:t=t.containerInfo,n=!0;break;default:throw a(Error(161))}16&r.effectTag&&(cn(t,""),r.effectTag&=-17);e:t:for(r=e;;){for(;null===r.sibling;){if(null===r.return||Ba(r.return)){r=null;break e}r=r.return}for(r.sibling.return=r.return,r=r.sibling;5!==r.tag&&6!==r.tag&&18!==r.tag;){if(2&r.effectTag)continue t;if(null===r.child||4===r.tag)continue t;r.child.return=r,r=r.child}if(!(2&r.effectTag)){r=r.stateNode;break e}}for(var i=e;;){var o=5===i.tag||6===i.tag;if(o||20===i.tag){var s=o?i.stateNode:i.stateNode.instance;if(r)if(n){var l=s;s=r,8===(o=t).nodeType?o.parentNode.insertBefore(l,s):o.insertBefore(l,s)}else t.insertBefore(s,r);else n?(8===(l=t).nodeType?(o=l.parentNode).insertBefore(s,l):(o=l).appendChild(s),null!==(l=l._reactRootContainer)&&void 0!==l||null!==o.onclick||(o.onclick=bn)):t.appendChild(s)}else if(4!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===e)break;for(;null===i.sibling;){if(null===i.return||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}}function Va(e,t){for(var r=e,n=!1,i=void 0,o=void 0;;){if(!n){n=r.return;e:for(;;){if(null===n)throw a(Error(160));switch(i=n.stateNode,n.tag){case 5:o=!1;break e;case 3:case 4:i=i.containerInfo,o=!0;break e}n=n.return}n=!0}if(5===r.tag||6===r.tag)if(Ia(r,t),o){var s=i,l=r.stateNode;8===s.nodeType?s.parentNode.removeChild(l):s.removeChild(l)}else i.removeChild(r.stateNode);else if(20===r.tag)l=r.stateNode.instance,Ia(r,t),o?8===(s=i).nodeType?s.parentNode.removeChild(l):s.removeChild(l):i.removeChild(l);else if(4===r.tag){if(null!==r.child){i=r.stateNode.containerInfo,o=!0,r.child.return=r,r=r.child;continue}}else if(ka(r,t),null!==r.child){r.child.return=r,r=r.child;continue}if(r===e)break;for(;null===r.sibling;){if(null===r.return||r.return===e)return;4===(r=r.return).tag&&(n=!1)}r.sibling.return=r.return,r=r.sibling}}function ja(e,t){switch(t.tag){case 0:case 11:case 14:case 15:Fa(vo,go,t);break;case 1:break;case 5:var r=t.stateNode;if(null!=r){var n=t.memoizedProps,i=null!==e?e.memoizedProps:n;e=t.type;var o=t.updateQueue;if(t.updateQueue=null,null!==o){for(r[D]=n,"input"===e&&"radio"===n.type&&null!=n.name&&Mt(r,n),gn(e,i),t=gn(e,n),i=0;i<o.length;i+=2){var s=o[i],l=o[i+1];"style"===s?dn(r,l):"dangerouslySetInnerHTML"===s?un(r,l):"children"===s?cn(r,l):bt(r,s,l,t)}switch(e){case"input":_t(r,n);break;case"textarea":tn(r,n);break;case"select":t=r._wrapperState.wasMultiple,r._wrapperState.wasMultiple=!!n.multiple,null!=(e=n.value)?Zr(r,!!n.multiple,e,!1):t!==!!n.multiple&&(null!=n.defaultValue?Zr(r,!!n.multiple,n.defaultValue,!0):Zr(r,!!n.multiple,n.multiple?[]:"",!1))}}}break;case 6:if(null===t.stateNode)throw a(Error(162));t.stateNode.nodeValue=t.memoizedProps;break;case 3:case 12:break;case 13:if(r=t,null===t.memoizedState?n=!1:(n=!0,r=t.child,fs=si()),null!==r)e:for(e=r;;){if(5===e.tag)o=e.stateNode,n?"function"===typeof(o=o.style).setProperty?o.setProperty("display","none","important"):o.display="none":(o=e.stateNode,i=void 0!==(i=e.memoizedProps.style)&&null!==i&&i.hasOwnProperty("display")?i.display:null,o.style.display=fn("display",i));else if(6===e.tag)e.stateNode.nodeValue=n?"":e.memoizedProps;else{if(13===e.tag&&null!==e.memoizedState){(o=e.child.sibling).return=e,e=o;continue}if(null!==e.child){e.child.return=e,e=e.child;continue}}if(e===r)break e;for(;null===e.sibling;){if(null===e.return||e.return===r)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}za(t);break;case 19:za(t);break;case 17:case 20:break;default:throw a(Error(163))}}function za(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new Oa),t.forEach(function(t){var n=function(e,t){var r=e.stateNode;null!==r&&r.delete(t),r=Cs(),t=Es(r,e,null),r=mi(r,t),null!==(e=Ps(e,t))&&Os(e,r,t)}.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))})}}var Ga="function"===typeof WeakMap?WeakMap:Map;function Wa(e,t,r){(r=Ni(r,null)).tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){vs||(vs=!0,gs=n),Ra(e,t)},r}function Ha(e,t,r){(r=Ni(r,null)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var i=t.value;r.payload=function(){return Ra(e,t),n(i)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(r.callback=function(){"function"!==typeof n&&(null===ys?ys=new Set([this]):ys.add(this),Ra(e,t));var r=t.stack;this.componentDidCatch(t.value,{componentStack:null!==r?r:""})}),r}var Xa=Math.ceil,qa=He.ReactCurrentDispatcher,Ya=He.ReactCurrentOwner,Ka=0,Qa=8,Ja=16,Za=32,$a=0,es=1,ts=2,rs=3,ns=4,is=Ka,os=null,as=null,ss=0,ls=$a,us=1073741823,cs=1073741823,hs=null,ps=!1,fs=0,ds=500,ms=null,vs=!1,gs=null,ys=null,bs=!1,xs=null,ws=90,Ss=0,Ms=null,_s=0,Ts=null,As=0;function Cs(){return(is&(Ja|Za))!==Ka?1073741821-(si()/10|0):0!==As?As:As=1073741821-(si()/10|0)}function Es(e,t,r){if(0===(2&(t=t.mode)))return 1073741823;var n=li();if(0===(4&t))return 99===n?1073741823:1073741822;if((is&Ja)!==Ka)return ss;if(null!==r)e=1073741821-25*(1+((1073741821-e+(0|r.timeoutMs||5e3)/10)/25|0));else switch(n){case 99:e=1073741823;break;case 98:e=1073741821-10*(1+((1073741821-e+15)/10|0));break;case 97:case 96:e=1073741821-25*(1+((1073741821-e+500)/25|0));break;case 95:e=1;break;default:throw a(Error(326))}return null!==os&&e===ss&&--e,e}var Ls=0;function Ns(e,t){if(50<_s)throw _s=0,Ts=null,a(Error(185));if(null!==(e=Ps(e,t))){e.pingTime=0;var r=li();if(1073741823===t)if((is&Qa)!==Ka&&(is&(Ja|Za))===Ka)for(var n=Us(e,1073741823,!0);null!==n;)n=n(!0);else Os(e,99,1073741823),is===Ka&&fi();else Os(e,r,t);(4&is)===Ka||98!==r&&99!==r||(null===Ms?Ms=new Map([[e,t]]):(void 0===(r=Ms.get(e))||r>t)&&Ms.set(e,t))}}function Ps(e,t){e.expirationTime<t&&(e.expirationTime=t);var r=e.alternate;null!==r&&r.expirationTime<t&&(r.expirationTime=t);var n=e.return,i=null;if(null===n&&3===e.tag)i=e.stateNode;else for(;null!==n;){if(r=n.alternate,n.childExpirationTime<t&&(n.childExpirationTime=t),null!==r&&r.childExpirationTime<t&&(r.childExpirationTime=t),null===n.return&&3===n.tag){i=n.stateNode;break}n=n.return}return null!==i&&(t>i.firstPendingTime&&(i.firstPendingTime=t),0===(e=i.lastPendingTime)||t<e)&&(i.lastPendingTime=t),i}function Os(e,t,r){if(e.callbackExpirationTime<r){var n=e.callbackNode;null!==n&&n!==ti&&Hn(n),e.callbackExpirationTime=r,1073741823===r?e.callbackNode=pi(Rs.bind(null,e,Us.bind(null,e,r))):(n=null,1!==r&&(n={timeout:10*(1073741821-r)-si()}),e.callbackNode=hi(t,Rs.bind(null,e,Us.bind(null,e,r)),n))}}function Rs(e,t,r){var n=e.callbackNode,i=null;try{return null!==(i=t(r))?Rs.bind(null,e,i):null}finally{null===i&&n===e.callbackNode&&(e.callbackNode=null,e.callbackExpirationTime=0)}}function Ds(){(is&(1|Ja|Za))===Ka&&(function(){if(null!==Ms){var e=Ms;Ms=null,e.forEach(function(e,t){pi(Us.bind(null,t,e))}),fi()}}(),Ws())}function Fs(e,t){var r=is;is|=1;try{return e(t)}finally{(is=r)===Ka&&fi()}}function ks(e,t,r,n){var i=is;is|=4;try{return ci(98,e.bind(null,t,r,n))}finally{(is=i)===Ka&&fi()}}function Is(e,t){var r=is;is&=-2,is|=Qa;try{return e(t)}finally{(is=r)===Ka&&fi()}}function Bs(e,t){e.finishedWork=null,e.finishedExpirationTime=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,Tn(r)),null!==as)for(r=as.return;null!==r;){var n=r;switch(n.tag){case 1:var i=n.type.childContextTypes;null!==i&&void 0!==i&&In();break;case 3:oo(),Bn();break;case 5:so(n);break;case 4:oo();break;case 13:case 19:Ln(ho);break;case 10:Mi(n)}r=r.return}os=e,as=el(e.current,null),ss=t,ls=$a,cs=us=1073741823,hs=null,ps=!1}function Us(e,t,r){if((is&(Ja|Za))!==Ka)throw a(Error(327));if(e.firstPendingTime<t)return null;if(r&&e.finishedExpirationTime===t)return Gs.bind(null,e);if(Ws(),e!==os||t!==ss)Bs(e,t);else if(ls===rs)if(ps)Bs(e,t);else{var n=e.lastPendingTime;if(n<t)return Us.bind(null,e,n)}if(null!==as){n=is,is|=Ja;var i=qa.current;if(null===i&&(i=Qo),qa.current=Qo,r){if(1073741823!==t){var o=Cs();if(o<t)return is=n,wi(),qa.current=i,Us.bind(null,e,o)}}else As=0;for(;;)try{if(r)for(;null!==as;)as=js(as);else for(;null!==as&&!Xn();)as=js(as);break}catch(m){if(wi(),Uo(),null===(o=as)||null===o.return)throw Bs(e,t),is=n,m;e:{var s=e,l=o.return,u=o,c=m,h=ss;if(u.effectTag|=1024,u.firstEffect=u.lastEffect=null,null!==c&&"object"===typeof c&&"function"===typeof c.then){var p=c,f=0!==(ho.current&uo);c=l;do{var d;if((d=13===c.tag)&&(null!==c.memoizedState?d=!1:d=void 0!==(d=c.memoizedProps).fallback&&(!0!==d.unstable_avoidThisFallback||!f)),d){if(null===(l=c.updateQueue)?((l=new Set).add(p),c.updateQueue=l):l.add(p),0===(2&c.mode)){c.effectTag|=64,u.effectTag&=-1957,1===u.tag&&(null===u.alternate?u.tag=17:((h=Ni(1073741823,null)).tag=2,Oi(u,h))),u.expirationTime=1073741823;break e}u=s,s=h,null===(f=u.pingCache)?(f=u.pingCache=new Ga,l=new Set,f.set(p,l)):void 0===(l=f.get(p))&&(l=new Set,f.set(p,l)),l.has(s)||(l.add(s),u=qs.bind(null,u,p,s),p.then(u,u)),c.effectTag|=2048,c.expirationTime=h;break e}c=c.return}while(null!==c);c=Error((ut(u.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+ct(u))}ls!==ns&&(ls=es),c=Pa(c,u),u=l;do{switch(u.tag){case 3:u.effectTag|=2048,u.expirationTime=h,Ri(u,h=Wa(u,c,h));break e;case 1:if(p=c,s=u.type,l=u.stateNode,0===(64&u.effectTag)&&("function"===typeof s.getDerivedStateFromError||null!==l&&"function"===typeof l.componentDidCatch&&(null===ys||!ys.has(l)))){u.effectTag|=2048,u.expirationTime=h,Ri(u,h=Ha(u,p,h));break e}}u=u.return}while(null!==u)}as=zs(o)}if(is=n,wi(),qa.current=i,null!==as)return Us.bind(null,e,t)}if(e.finishedWork=e.current.alternate,e.finishedExpirationTime=t,function(e,t){var r=e.firstBatch;return!!(null!==r&&r._defer&&r._expirationTime>=t)&&(hi(97,function(){return r._onComplete(),null}),!0)}(e,t))return null;switch(os=null,ls){case $a:throw a(Error(328));case es:return(n=e.lastPendingTime)<t?Us.bind(null,e,n):r?Gs.bind(null,e):(Bs(e,t),pi(Us.bind(null,e,t)),null);case ts:return 1073741823===us&&!r&&10<(r=fs+ds-si())?ps?(Bs(e,t),Us.bind(null,e,t)):(n=e.lastPendingTime)<t?Us.bind(null,e,n):(e.timeoutHandle=_n(Gs.bind(null,e),r),null):Gs.bind(null,e);case rs:if(!r){if(ps)return Bs(e,t),Us.bind(null,e,t);if((r=e.lastPendingTime)<t)return Us.bind(null,e,r);if(1073741823!==cs?r=10*(1073741821-cs)-si():1073741823===us?r=0:(r=10*(1073741821-us)-5e3,0>(r=(n=si())-r)&&(r=0),(t=10*(1073741821-t)-n)<(r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Xa(r/1960))-r)&&(r=t)),10<r)return e.timeoutHandle=_n(Gs.bind(null,e),r),null}return Gs.bind(null,e);case ns:return!r&&1073741823!==us&&null!==hs&&(n=us,0>=(t=0|(i=hs).busyMinDurationMs)?t=0:(r=0|i.busyDelayMs,t=(n=si()-(10*(1073741821-n)-(0|i.timeoutMs||5e3)))<=r?0:r+t-n),10<t)?(e.timeoutHandle=_n(Gs.bind(null,e),t),null):Gs.bind(null,e);default:throw a(Error(329))}}function Vs(e,t){e<us&&1<e&&(us=e),null!==t&&e<cs&&1<e&&(cs=e,hs=t)}function js(e){var t=Ys(e.alternate,e,ss);return e.memoizedProps=e.pendingProps,null===t&&(t=zs(e)),Ya.current=null,t}function zs(e){as=e;do{var t=as.alternate;if(e=as.return,0===(1024&as.effectTag)){e:{var r=t,n=ss,o=(t=as).pendingProps;switch(t.tag){case 2:case 16:break;case 15:case 0:break;case 1:kn(t.type)&&In();break;case 3:oo(),Bn(),(n=t.stateNode).pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==r&&null!==r.child||(aa(t),t.effectTag&=-3),Aa(t);break;case 5:so(t),n=no(ro.current);var s=t.type;if(null!==r&&null!=t.stateNode)Ca(r,t,s,o,n),r.ref!==t.ref&&(t.effectTag|=128);else if(o){var l=no(eo.current);if(aa(t)){o=void 0,s=(r=t).stateNode;var u=r.type,c=r.memoizedProps;switch(s[R]=r,s[D]=c,u){case"iframe":case"object":case"embed":Rr("load",s);break;case"video":case"audio":for(var h=0;h<te.length;h++)Rr(te[h],s);break;case"source":Rr("error",s);break;case"img":case"image":case"link":Rr("error",s),Rr("load",s);break;case"form":Rr("reset",s),Rr("submit",s);break;case"details":Rr("toggle",s);break;case"input":St(s,c),Rr("invalid",s),yn(n,"onChange");break;case"select":s._wrapperState={wasMultiple:!!c.multiple},Rr("invalid",s),yn(n,"onChange");break;case"textarea":en(s,c),Rr("invalid",s),yn(n,"onChange")}for(o in vn(u,c),h=null,c)c.hasOwnProperty(o)&&(l=c[o],"children"===o?"string"===typeof l?s.textContent!==l&&(h=["children",l]):"number"===typeof l&&s.textContent!==""+l&&(h=["children",""+l]):f.hasOwnProperty(o)&&null!=l&&yn(n,o));switch(u){case"input":Ge(s),Tt(s,c,!0);break;case"textarea":Ge(s),rn(s);break;case"select":case"option":break;default:"function"===typeof c.onClick&&(s.onclick=bn)}n=h,r.updateQueue=n,null!==n&&_a(t)}else{c=s,r=o,u=t,h=9===n.nodeType?n:n.ownerDocument,l===nn.html&&(l=on(c)),l===nn.html?"script"===c?((c=h.createElement("div")).innerHTML="<script><\/script>",h=c.removeChild(c.firstChild)):"string"===typeof r.is?h=h.createElement(c,{is:r.is}):(h=h.createElement(c),"select"===c&&(c=h,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):h=h.createElementNS(l,c),(c=h)[R]=u,c[D]=r,Ta(r=c,t,!1,!1),u=r;var p=n,d=gn(s,o);switch(s){case"iframe":case"object":case"embed":Rr("load",u),n=o;break;case"video":case"audio":for(n=0;n<te.length;n++)Rr(te[n],u);n=o;break;case"source":Rr("error",u),n=o;break;case"img":case"image":case"link":Rr("error",u),Rr("load",u),n=o;break;case"form":Rr("reset",u),Rr("submit",u),n=o;break;case"details":Rr("toggle",u),n=o;break;case"input":St(u,o),n=wt(u,o),Rr("invalid",u),yn(p,"onChange");break;case"option":n=Jr(u,o);break;case"select":u._wrapperState={wasMultiple:!!o.multiple},n=i({},o,{value:void 0}),Rr("invalid",u),yn(p,"onChange");break;case"textarea":en(u,o),n=$r(u,o),Rr("invalid",u),yn(p,"onChange");break;default:n=o}vn(s,n),c=void 0,h=s,l=u;var m=n;for(c in m)if(m.hasOwnProperty(c)){var v=m[c];"style"===c?dn(l,v):"dangerouslySetInnerHTML"===c?null!=(v=v?v.__html:void 0)&&un(l,v):"children"===c?"string"===typeof v?("textarea"!==h||""!==v)&&cn(l,v):"number"===typeof v&&cn(l,""+v):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(f.hasOwnProperty(c)?null!=v&&yn(p,c):null!=v&&bt(l,c,v,d))}switch(s){case"input":Ge(u),Tt(u,o,!1);break;case"textarea":Ge(u),rn(u);break;case"option":null!=o.value&&u.setAttribute("value",""+xt(o.value));break;case"select":n=u,u=o,n.multiple=!!u.multiple,null!=(c=u.value)?Zr(n,!!u.multiple,c,!1):null!=u.defaultValue&&Zr(n,!!u.multiple,u.defaultValue,!0);break;default:"function"===typeof n.onClick&&(u.onclick=bn)}Sn(s,o)&&_a(t),t.stateNode=r}null!==t.ref&&(t.effectTag|=128)}else if(null===t.stateNode)throw a(Error(166));break;case 6:if(r&&null!=t.stateNode)Ea(r,t,r.memoizedProps,o);else{if("string"!==typeof o&&null===t.stateNode)throw a(Error(166));r=no(ro.current),no(eo.current),aa(t)?(n=t.stateNode,r=t.memoizedProps,n[R]=t,n.nodeValue!==r&&_a(t)):(n=t,(r=(9===r.nodeType?r:r.ownerDocument).createTextNode(o))[R]=t,n.stateNode=r)}break;case 11:break;case 13:if(Ln(ho),o=t.memoizedState,0!==(64&t.effectTag)){t.expirationTime=n;break e}n=null!==o,o=!1,null===r?aa(t):(o=null!==(s=r.memoizedState),n||null===s||null!==(s=r.child.sibling)&&(null!==(u=t.firstEffect)?(t.firstEffect=s,s.nextEffect=u):(t.firstEffect=t.lastEffect=s,s.nextEffect=null),s.effectTag=8)),n&&!o&&0!==(2&t.mode)&&(null===r&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!==(ho.current&uo)?ls===$a&&(ls=ts):ls!==$a&&ls!==ts||(ls=rs)),(n||o)&&(t.effectTag|=4);break;case 7:case 8:case 12:break;case 4:oo(),Aa(t);break;case 10:Mi(t);break;case 9:case 14:break;case 17:kn(t.type)&&In();break;case 18:break;case 19:if(Ln(ho),null===(o=t.memoizedState))break;if(s=0!==(64&t.effectTag),null===(u=o.rendering)){if(s)La(o,!1);else if(ls!==$a||null!==r&&0!==(64&r.effectTag))for(r=t.child;null!==r;){if(null!==(u=po(r))){for(t.effectTag|=64,La(o,!1),null!==(r=u.updateQueue)&&(t.updateQueue=r,t.effectTag|=4),t.firstEffect=t.lastEffect=null,r=t.child;null!==r;)s=n,(o=r).effectTag&=2,o.nextEffect=null,o.firstEffect=null,o.lastEffect=null,null===(u=o.alternate)?(o.childExpirationTime=0,o.expirationTime=s,o.child=null,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null):(o.childExpirationTime=u.childExpirationTime,o.expirationTime=u.expirationTime,o.child=u.child,o.memoizedProps=u.memoizedProps,o.memoizedState=u.memoizedState,o.updateQueue=u.updateQueue,s=u.dependencies,o.dependencies=null===s?null:{expirationTime:s.expirationTime,firstContext:s.firstContext,responders:s.responders}),r=r.sibling;Nn(ho,ho.current&lo|co),t=t.child;break e}r=r.sibling}}else{if(!s)if(null!==(r=po(u))){if(t.effectTag|=64,s=!0,La(o,!0),null===o.tail&&"hidden"===o.tailMode){null!==(n=r.updateQueue)&&(t.updateQueue=n,t.effectTag|=4),null!==(t=t.lastEffect=o.lastEffect)&&(t.nextEffect=null);break}}else si()>o.tailExpiration&&1<n&&(t.effectTag|=64,s=!0,La(o,!1),t.expirationTime=t.childExpirationTime=n-1);o.isBackwards?(u.sibling=t.child,t.child=u):(null!==(n=o.last)?n.sibling=u:t.child=u,o.last=u)}if(null!==o.tail){0===o.tailExpiration&&(o.tailExpiration=si()+500),n=o.tail,o.rendering=n,o.tail=n.sibling,o.lastEffect=t.lastEffect,n.sibling=null,r=ho.current,Nn(ho,r=s?r&lo|co:r&lo),t=n;break e}break;case 20:break;default:throw a(Error(156))}t=null}if(n=as,1===ss||1!==n.childExpirationTime){for(r=0,o=n.child;null!==o;)(s=o.expirationTime)>r&&(r=s),(u=o.childExpirationTime)>r&&(r=u),o=o.sibling;n.childExpirationTime=r}if(null!==t)return t;null!==e&&0===(1024&e.effectTag)&&(null===e.firstEffect&&(e.firstEffect=as.firstEffect),null!==as.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=as.firstEffect),e.lastEffect=as.lastEffect),1<as.effectTag&&(null!==e.lastEffect?e.lastEffect.nextEffect=as:e.firstEffect=as,e.lastEffect=as))}else{if(null!==(t=Na(as)))return t.effectTag&=1023,t;null!==e&&(e.firstEffect=e.lastEffect=null,e.effectTag|=1024)}if(null!==(t=as.sibling))return t;as=e}while(null!==as);return ls===$a&&(ls=ns),null}function Gs(e){var t=li();return ci(99,function(e,t){if(Ws(),(is&(Ja|Za))!==Ka)throw a(Error(327));var r=e.finishedWork,n=e.finishedExpirationTime;if(null===r)return null;if(e.finishedWork=null,e.finishedExpirationTime=0,r===e.current)throw a(Error(177));e.callbackNode=null,e.callbackExpirationTime=0;var i=r.expirationTime,o=r.childExpirationTime;if(i=o>i?o:i,e.firstPendingTime=i,i<e.lastPendingTime&&(e.lastPendingTime=i),e===os&&(as=os=null,ss=0),1<r.effectTag?null!==r.lastEffect?(r.lastEffect.nextEffect=r,i=r.firstEffect):i=r:i=r.firstEffect,null!==i){o=is,is|=Za,Ya.current=null,xn=Or;var s=jr();if(zr(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{var u=(l=(l=s.ownerDocument)&&l.defaultView||window).getSelection&&l.getSelection();if(u&&0!==u.rangeCount){l=u.anchorNode;var c=u.anchorOffset,h=u.focusNode;u=u.focusOffset;try{l.nodeType,h.nodeType}catch(U){l=null;break e}var p=0,f=-1,d=-1,m=0,v=0,g=s,y=null;t:for(;;){for(var b;g!==l||0!==c&&3!==g.nodeType||(f=p+c),g!==h||0!==u&&3!==g.nodeType||(d=p+u),3===g.nodeType&&(p+=g.nodeValue.length),null!==(b=g.firstChild);)y=g,g=b;for(;;){if(g===s)break t;if(y===l&&++m===c&&(f=p),y===h&&++v===u&&(d=p),null!==(b=g.nextSibling))break;y=(g=y).parentNode}g=b}l=-1===f||-1===d?null:{start:f,end:d}}else l=null}l=l||{start:0,end:0}}else l=null;wn={focusedElem:s,selectionRange:l},Or=!1,ms=i;do{try{for(;null!==ms;){if(0!==(256&ms.effectTag)){var x=ms.alternate;switch((s=ms).tag){case 0:case 11:case 15:Fa(mo,fo,s);break;case 1:if(256&s.effectTag&&null!==x){var w=x.memoizedProps,S=x.memoizedState,M=s.stateNode,_=M.getSnapshotBeforeUpdate(s.elementType===s.type?w:vi(s.type,w),S);M.__reactInternalSnapshotBeforeUpdate=_}break;case 3:case 5:case 6:case 4:case 17:break;default:throw a(Error(163))}}ms=ms.nextEffect}}catch(U){if(null===ms)throw a(Error(330));Xs(ms,U),ms=ms.nextEffect}}while(null!==ms);ms=i;do{try{for(x=t;null!==ms;){var T=ms.effectTag;if(16&T&&cn(ms.stateNode,""),128&T){var A=ms.alternate;if(null!==A){var C=A.ref;null!==C&&("function"===typeof C?C(null):C.current=null)}}switch(14&T){case 2:Ua(ms),ms.effectTag&=-3;break;case 6:Ua(ms),ms.effectTag&=-3,ja(ms.alternate,ms);break;case 4:ja(ms.alternate,ms);break;case 8:Va(w=ms,x),w.return=null,w.child=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null;var E=w.alternate;null!==E&&(E.return=null,E.child=null,E.memoizedState=null,E.updateQueue=null,E.dependencies=null)}ms=ms.nextEffect}}catch(U){if(null===ms)throw a(Error(330));Xs(ms,U),ms=ms.nextEffect}}while(null!==ms);if(C=wn,A=jr(),T=C.focusedElem,x=C.selectionRange,A!==T&&T&&T.ownerDocument&&function e(t,r){return!(!t||!r)&&(t===r||(!t||3!==t.nodeType)&&(r&&3===r.nodeType?e(t,r.parentNode):"contains"in t?t.contains(r):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(r))))}(T.ownerDocument.documentElement,T)){null!==x&&zr(T)&&(A=x.start,void 0===(C=x.end)&&(C=A),"selectionStart"in T?(T.selectionStart=A,T.selectionEnd=Math.min(C,T.value.length)):(C=(A=T.ownerDocument||document)&&A.defaultView||window).getSelection&&(C=C.getSelection(),w=T.textContent.length,E=Math.min(x.start,w),x=void 0===x.end?E:Math.min(x.end,w),!C.extend&&E>x&&(w=x,x=E,E=w),w=Vr(T,E),S=Vr(T,x),w&&S&&(1!==C.rangeCount||C.anchorNode!==w.node||C.anchorOffset!==w.offset||C.focusNode!==S.node||C.focusOffset!==S.offset)&&((A=A.createRange()).setStart(w.node,w.offset),C.removeAllRanges(),E>x?(C.addRange(A),C.extend(S.node,S.offset)):(A.setEnd(S.node,S.offset),C.addRange(A))))),A=[];for(C=T;C=C.parentNode;)1===C.nodeType&&A.push({element:C,left:C.scrollLeft,top:C.scrollTop});for("function"===typeof T.focus&&T.focus(),T=0;T<A.length;T++)(C=A[T]).element.scrollLeft=C.left,C.element.scrollTop=C.top}wn=null,Or=!!xn,xn=null,e.current=r,ms=i;do{try{for(T=n;null!==ms;){var L=ms.effectTag;if(36&L){var N=ms.alternate;switch(C=T,(A=ms).tag){case 0:case 11:case 15:Fa(yo,bo,A);break;case 1:var P=A.stateNode;if(4&A.effectTag)if(null===N)P.componentDidMount();else{var O=A.elementType===A.type?N.memoizedProps:vi(A.type,N.memoizedProps);P.componentDidUpdate(O,N.memoizedState,P.__reactInternalSnapshotBeforeUpdate)}var R=A.updateQueue;null!==R&&Ii(0,R,P);break;case 3:var D=A.updateQueue;if(null!==D){if(E=null,null!==A.child)switch(A.child.tag){case 5:E=A.child.stateNode;break;case 1:E=A.child.stateNode}Ii(0,D,E)}break;case 5:var F=A.stateNode;null===N&&4&A.effectTag&&(C=F,Sn(A.type,A.memoizedProps)&&C.focus());break;case 6:case 4:case 12:break;case 13:case 19:case 17:case 20:break;default:throw a(Error(163))}}if(128&L){var k=ms.ref;if(null!==k){var I=ms.stateNode;switch(ms.tag){case 5:var B=I;break;default:B=I}"function"===typeof k?k(B):k.current=B}}512&L&&(bs=!0),ms=ms.nextEffect}}catch(U){if(null===ms)throw a(Error(330));Xs(ms,U),ms=ms.nextEffect}}while(null!==ms);ms=null,ri(),is=o}else e.current=r;if(bs)bs=!1,xs=e,Ss=n,ws=t;else for(ms=i;null!==ms;)t=ms.nextEffect,ms.nextEffect=null,ms=t;if(0!==(t=e.firstPendingTime)?(L=mi(L=Cs(),t),Os(e,L,t)):ys=null,"function"===typeof Ks&&Ks(r.stateNode,n),1073741823===t?e===Ts?_s++:(_s=0,Ts=e):_s=0,vs)throw vs=!1,e=gs,gs=null,e;return(is&Qa)!==Ka?null:(fi(),null)}.bind(null,e,t)),null!==xs&&hi(97,function(){return Ws(),null}),null}function Ws(){if(null===xs)return!1;var e=xs,t=Ss,r=ws;return xs=null,Ss=0,ws=90,ci(97<r?97:r,function(e){if((is&(Ja|Za))!==Ka)throw a(Error(331));var t=is;for(is|=Za,e=e.current.firstEffect;null!==e;){try{var r=e;if(0!==(512&r.effectTag))switch(r.tag){case 0:case 11:case 15:Fa(wo,fo,r),Fa(fo,xo,r)}}catch(n){if(null===e)throw a(Error(330));Xs(e,n)}r=e.nextEffect,e.nextEffect=null,e=r}return is=t,fi(),!0}.bind(null,e,t))}function Hs(e,t,r){Oi(e,t=Wa(e,t=Pa(r,t),1073741823)),null!==(e=Ps(e,1073741823))&&Os(e,99,1073741823)}function Xs(e,t){if(3===e.tag)Hs(e,e,t);else for(var r=e.return;null!==r;){if(3===r.tag){Hs(r,e,t);break}if(1===r.tag){var n=r.stateNode;if("function"===typeof r.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===ys||!ys.has(n))){Oi(r,e=Ha(r,e=Pa(t,e),1073741823)),null!==(r=Ps(r,1073741823))&&Os(r,99,1073741823);break}}r=r.return}}function qs(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),os===e&&ss===r?ls===rs||ls===ts&&1073741823===us&&si()-fs<ds?Bs(e,ss):ps=!0:e.lastPendingTime<r||(0!==(t=e.pingTime)&&t<r||(e.pingTime=r,e.finishedExpirationTime===r&&(e.finishedExpirationTime=0,e.finishedWork=null),Os(e,t=mi(t=Cs(),r),r)))}var Ys=void 0;Ys=function(e,t,r){var n=t.expirationTime;if(null!==e){var i=t.pendingProps;if(e.memoizedProps!==i||Rn.current)ua=!0;else if(n<r){switch(ua=!1,t.tag){case 3:ya(t),sa();break;case 5:if(ao(t),4&t.mode&&1!==r&&i.hidden)return t.expirationTime=t.childExpirationTime=1,null;break;case 1:kn(t.type)&&jn(t);break;case 4:io(t,t.stateNode.containerInfo);break;case 10:Si(t,t.memoizedProps.value);break;case 13:if(null!==t.memoizedState)return 0!==(n=t.child.childExpirationTime)&&n>=r?xa(e,t,r):(Nn(ho,ho.current&lo),null!==(t=Ma(e,t,r))?t.sibling:null);Nn(ho,ho.current&lo);break;case 19:if(n=t.childExpirationTime>=r,0!==(64&e.effectTag)){if(n)return Sa(e,t,r);t.effectTag|=64}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null),Nn(ho,ho.current),!n)return null}return Ma(e,t,r)}}else ua=!1;switch(t.expirationTime=0,t.tag){case 2:if(n=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),e=t.pendingProps,i=Fn(t,On.current),Ti(t,r),i=Bo(null,t,n,e,i,r),t.effectTag|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof){if(t.tag=1,Uo(),kn(n)){var o=!0;jn(t)}else o=!1;t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null;var s=n.getDerivedStateFromProps;"function"===typeof s&&ji(t,n,s,e),i.updater=zi,t.stateNode=i,i._reactInternalFiber=t,Xi(t,n,e,r),t=ga(null,t,n,!0,o,r)}else t.tag=0,ca(null,t,i,r),t=t.child;return t;case 16:switch(i=t.elementType,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),e=t.pendingProps,i=function(e){var t=e._result;switch(e._status){case 1:return t;case 2:case 0:throw t;default:switch(e._status=0,(t=(t=e._ctor)()).then(function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)},function(t){0===e._status&&(e._status=2,e._result=t)}),e._status){case 1:return e._result;case 2:throw e._result}throw e._result=t,t}}(i),t.type=i,o=t.tag=function(e){if("function"===typeof e)return $s(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===rt)return 11;if(e===ot)return 14}return 2}(i),e=vi(i,e),o){case 0:t=ma(null,t,i,e,r);break;case 1:t=va(null,t,i,e,r);break;case 11:t=ha(null,t,i,e,r);break;case 14:t=pa(null,t,i,vi(i.type,e),n,r);break;default:throw a(Error(306),i,"")}return t;case 0:return n=t.type,i=t.pendingProps,ma(e,t,n,i=t.elementType===n?i:vi(n,i),r);case 1:return n=t.type,i=t.pendingProps,va(e,t,n,i=t.elementType===n?i:vi(n,i),r);case 3:if(ya(t),null===(n=t.updateQueue))throw a(Error(282));return i=null!==(i=t.memoizedState)?i.element:null,ki(t,n,t.pendingProps,null,r),(n=t.memoizedState.element)===i?(sa(),t=Ma(e,t,r)):(i=t.stateNode,(i=(null===e||null===e.child)&&i.hydrate)&&(ea=An(t.stateNode.containerInfo.firstChild),$o=t,i=ta=!0),i?(t.effectTag|=2,t.child=Zi(t,null,n,r)):(ca(e,t,n,r),sa()),t=t.child),t;case 5:return ao(t),null===e&&ia(t),n=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,s=i.children,Mn(n,i)?s=null:null!==o&&Mn(n,o)&&(t.effectTag|=16),da(e,t),4&t.mode&&1!==r&&i.hidden?(t.expirationTime=t.childExpirationTime=1,t=null):(ca(e,t,s,r),t=t.child),t;case 6:return null===e&&ia(t),null;case 13:return xa(e,t,r);case 4:return io(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=Ji(t,null,n,r):ca(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,ha(e,t,n,i=t.elementType===n?i:vi(n,i),r);case 7:return ca(e,t,t.pendingProps,r),t.child;case 8:case 12:return ca(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,Si(t,o=i.value),null!==s){var l=s.value;if(0===(o=er(l,o)?0:0|("function"===typeof n._calculateChangedBits?n._calculateChangedBits(l,o):1073741823))){if(s.children===i.children&&!Rn.current){t=Ma(e,t,r);break e}}else for(null!==(l=t.child)&&(l.return=t);null!==l;){var u=l.dependencies;if(null!==u){s=l.child;for(var c=u.firstContext;null!==c;){if(c.context===n&&0!==(c.observedBits&o)){1===l.tag&&((c=Ni(r,null)).tag=2,Oi(l,c)),l.expirationTime<r&&(l.expirationTime=r),null!==(c=l.alternate)&&c.expirationTime<r&&(c.expirationTime=r),_i(l.return,r),u.expirationTime<r&&(u.expirationTime=r);break}c=c.next}}else s=10===l.tag&&l.type===t.type?null:l.child;if(null!==s)s.return=l;else for(s=l;null!==s;){if(s===t){s=null;break}if(null!==(l=s.sibling)){l.return=s.return,s=l;break}s=s.return}l=s}}ca(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=(o=t.pendingProps).children,Ti(t,r),n=n(i=Ai(i,o.unstable_observedBits)),t.effectTag|=1,ca(e,t,n,r),t.child;case 14:return o=vi(i=t.type,t.pendingProps),pa(e,t,i,o=vi(i.type,o),n,r);case 15:return fa(e,t,t.type,t.pendingProps,n,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:vi(n,i),null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),t.tag=1,kn(n)?(e=!0,jn(t)):e=!1,Ti(t,r),Wi(t,n,i),Xi(t,n,i,r),ga(null,t,n,!0,e,r);case 19:return Sa(e,t,r)}throw a(Error(156))};var Ks=null,Qs=null;function Js(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}function Zs(e,t,r,n){return new Js(e,t,r,n)}function $s(e){return!(!(e=e.prototype)||!e.isReactComponent)}function el(e,t){var r=e.alternate;return null===r?((r=Zs(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.effectTag=0,r.nextEffect=null,r.firstEffect=null,r.lastEffect=null),r.childExpirationTime=e.childExpirationTime,r.expirationTime=e.expirationTime,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{expirationTime:t.expirationTime,firstContext:t.firstContext,responders:t.responders},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function tl(e,t,r,n,i,o){var s=2;if(n=e,"function"===typeof e)$s(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case Qe:return rl(r.children,i,o,t);case tt:s=8,i|=7;break;case Je:s=8,i|=1;break;case Ze:return(e=Zs(12,r,t,8|i)).elementType=Ze,e.type=Ze,e.expirationTime=o,e;case nt:return(e=Zs(13,r,t,i)).type=nt,e.elementType=nt,e.expirationTime=o,e;case it:return(e=Zs(19,r,t,i)).elementType=it,e.expirationTime=o,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case $e:s=10;break e;case et:s=9;break e;case rt:s=11;break e;case ot:s=14;break e;case at:s=16,n=null;break e}throw a(Error(130),null==e?e:typeof e,"")}return(t=Zs(s,r,t,i)).elementType=e,t.type=n,t.expirationTime=o,t}function rl(e,t,r,n){return(e=Zs(7,e,n,t)).expirationTime=r,e}function nl(e,t,r){return(e=Zs(6,e,null,t)).expirationTime=r,e}function il(e,t,r){return(t=Zs(4,null!==e.children?e.children:[],e.key,t)).expirationTime=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function ol(e,t,r){this.tag=t,this.current=null,this.containerInfo=e,this.pingCache=this.pendingChildren=null,this.finishedExpirationTime=0,this.finishedWork=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=r,this.callbackNode=this.firstBatch=null,this.pingTime=this.lastPendingTime=this.firstPendingTime=this.callbackExpirationTime=0}function al(e,t,r){return e=new ol(e,t,r),t=Zs(3,null,null,2===t?7:1===t?3:0),e.current=t,t.stateNode=e}function sl(e,t,r,n,i,o){var s=t.current;e:if(r){t:{if(2!==ir(r=r._reactInternalFiber)||1!==r.tag)throw a(Error(170));var l=r;do{switch(l.tag){case 3:l=l.stateNode.context;break t;case 1:if(kn(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break t}}l=l.return}while(null!==l);throw a(Error(171))}if(1===r.tag){var u=r.type;if(kn(u)){r=Vn(r,u,l);break e}}r=l}else r=Pn;return null===t.context?t.context=r:t.pendingContext=r,t=o,(i=Ni(n,i)).payload={element:e},null!==(t=void 0===t?null:t)&&(i.callback=t),Oi(s,i),Ns(s,n),n}function ll(e,t,r,n){var i=t.current,o=Cs(),a=Ui.suspense;return sl(e,t,r,i=Es(o,i,a),a,n)}function ul(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 5:default:return e.child.stateNode}}function cl(e){var t=1073741821-25*(1+((1073741821-Cs()+500)/25|0));t<=Ls&&--t,this._expirationTime=Ls=t,this._root=e,this._callbacks=this._next=null,this._hasChildren=this._didComplete=!1,this._children=null,this._defer=!0}function hl(){this._callbacks=null,this._didCommit=!1,this._onCommit=this._onCommit.bind(this)}function pl(e,t,r){this._internalRoot=al(e,t,r)}function fl(e,t){this._internalRoot=al(e,2,t)}function dl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function ml(e,t,r,n,i){var o=r._reactRootContainer,a=void 0;if(o){if(a=o._internalRoot,"function"===typeof i){var s=i;i=function(){var e=ul(a);s.call(e)}}ll(t,a,e,i)}else{if(o=r._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var r;r=e.lastChild;)e.removeChild(r);return new pl(e,0,t)}(r,n),a=o._internalRoot,"function"===typeof i){var l=i;i=function(){var e=ul(a);l.call(e)}}Is(function(){ll(t,a,e,i)})}return ul(a)}function vl(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!dl(t))throw a(Error(200));return function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:Ke,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}(e,t,null,r)}Ae=function(e,t,r){switch(t){case"input":if(_t(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=B(n);if(!i)throw a(Error(90));We(n),_t(n,i)}}}break;case"textarea":tn(e,r);break;case"select":null!=(t=r.value)&&Zr(e,!!r.multiple,t,!1)}},cl.prototype.render=function(e){if(!this._defer)throw a(Error(250));this._hasChildren=!0,this._children=e;var t=this._root._internalRoot,r=this._expirationTime,n=new hl;return sl(e,t,null,r,null,n._onCommit),n},cl.prototype.then=function(e){if(this._didComplete)e();else{var t=this._callbacks;null===t&&(t=this._callbacks=[]),t.push(e)}},cl.prototype.commit=function(){var e=this._root._internalRoot,t=e.firstBatch;if(!this._defer||null===t)throw a(Error(251));if(this._hasChildren){var r=this._expirationTime;if(t!==this){this._hasChildren&&(r=this._expirationTime=t._expirationTime,this.render(this._children));for(var n=null,i=t;i!==this;)n=i,i=i._next;if(null===n)throw a(Error(251));n._next=i._next,this._next=t,e.firstBatch=this}if(this._defer=!1,t=r,(is&(Ja|Za))!==Ka)throw a(Error(253));pi(Us.bind(null,e,t)),fi(),t=this._next,this._next=null,null!==(t=e.firstBatch=t)&&t._hasChildren&&t.render(t._children)}else this._next=null,this._defer=!1},cl.prototype._onComplete=function(){if(!this._didComplete){this._didComplete=!0;var e=this._callbacks;if(null!==e)for(var t=0;t<e.length;t++)(0,e[t])()}},hl.prototype.then=function(e){if(this._didCommit)e();else{var t=this._callbacks;null===t&&(t=this._callbacks=[]),t.push(e)}},hl.prototype._onCommit=function(){if(!this._didCommit){this._didCommit=!0;var e=this._callbacks;if(null!==e)for(var t=0;t<e.length;t++){var r=e[t];if("function"!==typeof r)throw a(Error(191),r);r()}}},fl.prototype.render=pl.prototype.render=function(e,t){var r=this._internalRoot,n=new hl;return null!==(t=void 0===t?null:t)&&n.then(t),ll(e,r,null,n._onCommit),n},fl.prototype.unmount=pl.prototype.unmount=function(e){var t=this._internalRoot,r=new hl;return null!==(e=void 0===e?null:e)&&r.then(e),ll(null,t,null,r._onCommit),r},fl.prototype.createBatch=function(){var e=new cl(this),t=e._expirationTime,r=this._internalRoot,n=r.firstBatch;if(null===n)r.firstBatch=e,e._next=null;else{for(r=null;null!==n&&n._expirationTime>=t;)r=n,n=n._next;e._next=n,null!==r&&(r._next=e)}return e},Oe=Fs,Re=ks,De=Ds,Fe=function(e,t){var r=is;is|=2;try{return e(t)}finally{(is=r)===Ka&&fi()}};var gl={createPortal:vl,findDOMNode:function(e){if(null==e)e=null;else if(1!==e.nodeType){var t=e._reactInternalFiber;if(void 0===t){if("function"===typeof e.render)throw a(Error(188));throw a(Error(268),Object.keys(e))}e=null===(e=ar(t))?null:e.stateNode}return e},hydrate:function(e,t,r){if(!dl(t))throw a(Error(200));return ml(null,e,t,!0,r)},render:function(e,t,r){if(!dl(t))throw a(Error(200));return ml(null,e,t,!1,r)},unstable_renderSubtreeIntoContainer:function(e,t,r,n){if(!dl(r))throw a(Error(200));if(null==e||void 0===e._reactInternalFiber)throw a(Error(38));return ml(e,t,r,!1,n)},unmountComponentAtNode:function(e){if(!dl(e))throw a(Error(40));return!!e._reactRootContainer&&(Is(function(){ml(null,null,e,!1,function(){e._reactRootContainer=null})}),!0)},unstable_createPortal:function(){return vl.apply(void 0,arguments)},unstable_batchedUpdates:Fs,unstable_interactiveUpdates:function(e,t,r,n){return Ds(),ks(e,t,r,n)},unstable_discreteUpdates:ks,unstable_flushDiscreteUpdates:Ds,flushSync:function(e,t){if((is&(Ja|Za))!==Ka)throw a(Error(187));var r=is;is|=1;try{return ci(99,e.bind(null,t))}finally{is=r,fi()}},unstable_createRoot:function(e,t){if(!dl(e))throw a(Error(299),"unstable_createRoot");return new fl(e,null!=t&&!0===t.hydrate)},unstable_createSyncRoot:function(e,t){if(!dl(e))throw a(Error(299),"unstable_createRoot");return new pl(e,1,null!=t&&!0===t.hydrate)},unstable_flushControlled:function(e){var t=is;is|=1;try{ci(99,e)}finally{(is=t)===Ka&&fi()}},__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{Events:[k,I,B,N.injectEventPluginsByName,p,W,function(e){A(e,G)},Ne,Pe,Fr,L,Ws,{current:!1}]}};!function(e){var t=e.findFiberByHostInstance;(function(e){if("undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)return!0;try{var r=t.inject(e);Ks=function(e){try{t.onCommitFiberRoot(r,e,void 0,64===(64&e.current.effectTag))}catch(n){}},Qs=function(e){try{t.onCommitFiberUnmount(r,e)}catch(n){}}}catch(n){}})(i({},e,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:He.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=ar(e))?null:e.stateNode},findFiberByHostInstance:function(e){return t?t(e):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))}({findFiberByHostInstance:F,bundleType:0,version:"16.9.0",rendererPackageName:"react-dom"});var yl={default:gl},bl=yl&&gl||yl;e.exports=bl.default||bl},function(e,t,r){"use strict";e.exports=r(258)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=void 0,i=void 0,o=void 0,a=void 0,s=void 0;if(t.unstable_now=void 0,t.unstable_forceFrameRate=void 0,"undefined"===typeof window||"function"!==typeof MessageChannel){var l=null,u=null,c=function e(){if(null!==l)try{var r=t.unstable_now();l(!0,r),l=null}catch(n){throw setTimeout(e,0),n}};t.unstable_now=function(){return Date.now()},n=function(e){null!==l?setTimeout(n,0,e):(l=e,setTimeout(c,0))},i=function(e,t){u=setTimeout(e,t)},o=function(){clearTimeout(u)},a=function(){return!1},s=t.unstable_forceFrameRate=function(){}}else{var h=window.performance,p=window.Date,f=window.setTimeout,d=window.clearTimeout,m=window.requestAnimationFrame,v=window.cancelAnimationFrame;"undefined"!==typeof console&&("function"!==typeof m&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!==typeof v&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills")),t.unstable_now="object"===typeof h&&"function"===typeof h.now?function(){return h.now()}:function(){return p.now()};var g=!1,y=null,b=-1,x=-1,w=33.33,S=-1,M=-1,_=0,T=!1;a=function(){return t.unstable_now()>=_},s=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):0<e?(w=Math.floor(1e3/e),T=!0):(w=33.33,T=!1)};var A=function(){if(null!==y){var e=t.unstable_now(),r=0<_-e;try{y(r,e)||(y=null)}catch(n){throw E.postMessage(null),n}}},C=new MessageChannel,E=C.port2;C.port1.onmessage=A;n=function(e){y=e,g||(g=!0,m(function(e){!function e(r){if(null===y)M=S=-1,g=!1;else{if(g=!0,m(function(t){d(b),e(t)}),b=f(function e(){_=t.unstable_now()+w/2,A(),b=f(e,3*w)},3*w),-1!==S&&.1<r-S){var n=r-S;!T&&-1!==M&&n<w&&M<w&&8.33>(w=n<M?M:n)&&(w=8.33),M=n}S=r,_=r+w,E.postMessage(null)}}(e)}))},i=function(e,r){x=f(function(){e(t.unstable_now())},r)},o=function(){d(x),x=-1}}var L=null,N=null,P=null,O=3,R=!1,D=!1,F=!1;function k(e,t){var r=e.next;if(r===e)L=null;else{e===L&&(L=r);var n=e.previous;n.next=r,r.previous=n}e.next=e.previous=null,r=e.callback,n=O;var i=P;O=e.priorityLevel,P=e;try{var o=e.expirationTime<=t;switch(O){case 1:var a=r(o);break;case 2:case 3:case 4:a=r(o);break;case 5:a=r(o)}}catch(s){throw s}finally{O=n,P=i}if("function"===typeof a)if(t=e.expirationTime,e.callback=a,null===L)L=e.next=e.previous=e;else{a=null,o=L;do{if(t<=o.expirationTime){a=o;break}o=o.next}while(o!==L);null===a?a=L:a===L&&(L=e),(t=a.previous).next=a.previous=e,e.next=a,e.previous=t}}function I(e){if(null!==N&&N.startTime<=e)do{var t=N,r=t.next;if(t===r)N=null;else{N=r;var n=t.previous;n.next=r,r.previous=n}t.next=t.previous=null,j(t,t.expirationTime)}while(null!==N&&N.startTime<=e)}function B(e){F=!1,I(e),D||(null!==L?(D=!0,n(U)):null!==N&&i(B,N.startTime-e))}function U(e,r){D=!1,F&&(F=!1,o()),I(r),R=!0;try{if(e){if(null!==L)do{k(L,r),I(r=t.unstable_now())}while(null!==L&&!a())}else for(;null!==L&&L.expirationTime<=r;)k(L,r),I(r=t.unstable_now());return null!==L||(null!==N&&i(B,N.startTime-r),!1)}finally{R=!1}}function V(e){switch(e){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1e4;default:return 5e3}}function j(e,t){if(null===L)L=e.next=e.previous=e;else{var r=null,n=L;do{if(t<n.expirationTime){r=n;break}n=n.next}while(n!==L);null===r?r=L:r===L&&(L=e),(t=r.previous).next=r.previous=e,e.next=r,e.previous=t}}var z=s;t.unstable_ImmediatePriority=1,t.unstable_UserBlockingPriority=2,t.unstable_NormalPriority=3,t.unstable_IdlePriority=5,t.unstable_LowPriority=4,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=O;O=e;try{return t()}finally{O=r}},t.unstable_next=function(e){switch(O){case 1:case 2:case 3:var t=3;break;default:t=O}var r=O;O=t;try{return e()}finally{O=r}},t.unstable_scheduleCallback=function(e,r,a){var s=t.unstable_now();if("object"===typeof a&&null!==a){var l=a.delay;l="number"===typeof l&&0<l?s+l:s,a="number"===typeof a.timeout?a.timeout:V(e)}else a=V(e),l=s;if(e={callback:r,priorityLevel:e,startTime:l,expirationTime:a=l+a,next:null,previous:null},l>s){if(a=l,null===N)N=e.next=e.previous=e;else{r=null;var u=N;do{if(a<u.startTime){r=u;break}u=u.next}while(u!==N);null===r?r=N:r===N&&(N=e),(a=r.previous).next=r.previous=e,e.next=r,e.previous=a}null===L&&N===e&&(F?o():F=!0,i(B,l-s))}else j(e,a),D||R||(D=!0,n(U));return e},t.unstable_cancelCallback=function(e){var t=e.next;if(null!==t){if(e===t)e===L?L=null:e===N&&(N=null);else{e===L?L=t:e===N&&(N=t);var r=e.previous;r.next=t,t.previous=r}e.next=e.previous=null}},t.unstable_wrapCallback=function(e){var t=O;return function(){var r=O;O=t;try{return e.apply(this,arguments)}finally{O=r}}},t.unstable_getCurrentPriorityLevel=function(){return O},t.unstable_shouldYield=function(){var e=t.unstable_now();return I(e),null!==P&&null!==L&&L.startTime<=e&&L.expirationTime<P.expirationTime||a()},t.unstable_requestPaint=z,t.unstable_continueExecution=function(){D||R||(D=!0,n(U))},t.unstable_pauseExecution=function(){},t.unstable_getFirstCallbackNode=function(){return L}},function(e,t,r){"use strict";var n=r(260);function i(){}e.exports=function(){function e(e,t,r,i,o,a){if(a!==n){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t};return r.checkPropTypes=i,r.PropTypes=r,r}},function(e,t,r){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"===typeof Symbol&&Symbol.for,i=n?Symbol.for("react.element"):60103,o=n?Symbol.for("react.portal"):60106,a=n?Symbol.for("react.fragment"):60107,s=n?Symbol.for("react.strict_mode"):60108,l=n?Symbol.for("react.profiler"):60114,u=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,h=n?Symbol.for("react.async_mode"):60111,p=n?Symbol.for("react.concurrent_mode"):60111,f=n?Symbol.for("react.forward_ref"):60112,d=n?Symbol.for("react.suspense"):60113,m=n?Symbol.for("react.memo"):60115,v=n?Symbol.for("react.lazy"):60116;function g(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case i:switch(e=e.type){case h:case p:case a:case l:case s:case d:return e;default:switch(e=e&&e.$$typeof){case c:case f:case u:return e;default:return t}}case v:case m:case o:return t}}}function y(e){return g(e)===p}t.typeOf=g,t.AsyncMode=h,t.ConcurrentMode=p,t.ContextConsumer=c,t.ContextProvider=u,t.Element=i,t.ForwardRef=f,t.Fragment=a,t.Lazy=v,t.Memo=m,t.Portal=o,t.Profiler=l,t.StrictMode=s,t.Suspense=d,t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===a||e===p||e===l||e===s||e===d||"object"===typeof e&&null!==e&&(e.$$typeof===v||e.$$typeof===m||e.$$typeof===u||e.$$typeof===c||e.$$typeof===f)},t.isAsyncMode=function(e){return y(e)||g(e)===h},t.isConcurrentMode=y,t.isContextConsumer=function(e){return g(e)===c},t.isContextProvider=function(e){return g(e)===u},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===i},t.isForwardRef=function(e){return g(e)===f},t.isFragment=function(e){return g(e)===a},t.isLazy=function(e){return g(e)===v},t.isMemo=function(e){return g(e)===m},t.isPortal=function(e){return g(e)===o},t.isProfiler=function(e){return g(e)===l},t.isStrictMode=function(e){return g(e)===s},t.isSuspense=function(e){return g(e)===d}},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,r){"use strict";t.__esModule=!0,t.locationsAreEqual=t.createLocation=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=s(r(264)),o=s(r(265)),a=r(162);function s(e){return e&&e.__esModule?e:{default:e}}t.createLocation=function(e,t,r,o){var s=void 0;"string"===typeof e?(s=(0,a.parsePath)(e)).state=t:(void 0===(s=n({},e)).pathname&&(s.pathname=""),s.search?"?"!==s.search.charAt(0)&&(s.search="?"+s.search):s.search="",s.hash?"#"!==s.hash.charAt(0)&&(s.hash="#"+s.hash):s.hash="",void 0!==t&&void 0===s.state&&(s.state=t));try{s.pathname=decodeURI(s.pathname)}catch(l){throw l instanceof URIError?new URIError('Pathname "'+s.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):l}return r&&(s.key=r),o?s.pathname?"/"!==s.pathname.charAt(0)&&(s.pathname=(0,i.default)(s.pathname,o.pathname)):s.pathname=o.pathname:s.pathname||(s.pathname="/"),s},t.locationsAreEqual=function(e,t){return e.pathname===t.pathname&&e.search===t.search&&e.hash===t.hash&&e.key===t.key&&(0,o.default)(e.state,t.state)}},function(e,t,r){"use strict";function n(e){return"/"===e.charAt(0)}function i(e,t){for(var r=t,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}r.r(t),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=e&&e.split("/")||[],o=t&&t.split("/")||[],a=e&&n(e),s=t&&n(t),l=a||s;if(e&&n(e)?o=r:r.length&&(o.pop(),o=o.concat(r)),!o.length)return"/";var u=void 0;if(o.length){var c=o[o.length-1];u="."===c||".."===c||""===c}else u=!1;for(var h=0,p=o.length;p>=0;p--){var f=o[p];"."===f?i(o,p):".."===f?(i(o,p),h++):h&&(i(o,p),h--)}if(!l)for(;h--;h)o.unshift("..");!l||""===o[0]||o[0]&&n(o[0])||o.unshift("");var d=o.join("/");return u&&"/"!==d.substr(-1)&&(d+="/"),d}},function(e,t,r){"use strict";r.r(t);var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=function e(t,r){if(t===r)return!0;if(null==t||null==r)return!1;if(Array.isArray(t))return Array.isArray(r)&&t.length===r.length&&t.every(function(t,n){return e(t,r[n])});var i="undefined"===typeof t?"undefined":n(t);if(i!==("undefined"===typeof r?"undefined":n(r)))return!1;if("object"===i){var o=t.valueOf(),a=r.valueOf();if(o!==t||a!==r)return e(o,a);var s=Object.keys(t),l=Object.keys(r);return s.length===l.length&&s.every(function(n){return e(t[n],r[n])})}return!1}},function(e,t,r){"use strict";t.__esModule=!0;var n,i=r(161),o=(n=i)&&n.__esModule?n:{default:n};t.default=function(){var e=null,t=[];return{setPrompt:function(t){return(0,o.default)(null==e,"A history supports only one prompt at a time"),e=t,function(){e===t&&(e=null)}},confirmTransitionTo:function(t,r,n,i){if(null!=e){var a="function"===typeof e?e(t,r):e;"string"===typeof a?"function"===typeof n?n(a,i):((0,o.default)(!1,"A history needs a getUserConfirmation function in order to use a prompt message"),i(!0)):i(!1!==a)}else i(!0)},appendListener:function(e){var r=!0,n=function(){r&&e.apply(void 0,arguments)};return t.push(n),function(){r=!1,t=t.filter(function(e){return e!==n})}},notifyListeners:function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];t.forEach(function(e){return e.apply(void 0,r)})}}}},function(e,t,r){"use strict";t.__esModule=!0;t.canUseDOM=!("undefined"===typeof window||!window.document||!window.document.createElement),t.addEventListener=function(e,t,r){return e.addEventListener?e.addEventListener(t,r,!1):e.attachEvent("on"+t,r)},t.removeEventListener=function(e,t,r){return e.removeEventListener?e.removeEventListener(t,r,!1):e.detachEvent("on"+t,r)},t.getConfirmation=function(e,t){return t(window.confirm(e))},t.supportsHistory=function(){var e=window.navigator.userAgent;return(-1===e.indexOf("Android 2.")&&-1===e.indexOf("Android 4.0")||-1===e.indexOf("Mobile Safari")||-1!==e.indexOf("Chrome")||-1!==e.indexOf("Windows Phone"))&&(window.history&&"pushState"in window.history)},t.supportsPopStateOnHashChange=function(){return-1===window.navigator.userAgent.indexOf("Trident")},t.supportsGoWithoutReloadUsingHash=function(){return-1===window.navigator.userAgent.indexOf("Firefox")},t.isExtraneousPopstateEvent=function(e){return void 0===e.state&&-1===navigator.userAgent.indexOf("CriOS")}},function(e,t,r){"use strict";var n=r(39),i=r(163),o=r(269),a=r(132);function s(e){var t=new o(e),r=i(o.prototype.request,t);return n.extend(r,o.prototype,t),n.extend(r,t),r}var l=s(a);l.Axios=o,l.create=function(e){return s(n.merge(a,e))},l.Cancel=r(167),l.CancelToken=r(283),l.isCancel=r(166),l.all=function(e){return Promise.all(e)},l.spread=r(284),e.exports=l,e.exports.default=l},function(e,t,r){"use strict";var n=r(132),i=r(39),o=r(278),a=r(279);function s(e){this.defaults=e,this.interceptors={request:new o,response:new o}}s.prototype.request=function(e){"string"===typeof e&&(e=i.merge({url:arguments[0]},arguments[1])),(e=i.merge(n,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[a,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)r=r.then(t.shift(),t.shift());return r},i.forEach(["delete","get","head","options"],function(e){s.prototype[e]=function(t,r){return this.request(i.merge(r||{},{method:e,url:t}))}}),i.forEach(["post","put","patch"],function(e){s.prototype[e]=function(t,r,n){return this.request(i.merge(n||{},{method:e,url:t,data:r}))}}),e.exports=s},function(e,t,r){"use strict";var n=r(39);e.exports=function(e,t){n.forEach(e,function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])})}},function(e,t,r){"use strict";var n=r(165);e.exports=function(e,t,r){var i=r.config.validateStatus;r.status&&i&&!i(r.status)?t(n("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},function(e,t,r){"use strict";e.exports=function(e,t,r,n,i){return e.config=t,r&&(e.code=r),e.request=n,e.response=i,e}},function(e,t,r){"use strict";var n=r(39);function i(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var o;if(r)o=r(t);else if(n.isURLSearchParams(t))o=t.toString();else{var a=[];n.forEach(t,function(e,t){null!==e&&"undefined"!==typeof e&&(n.isArray(e)?t+="[]":e=[e],n.forEach(e,function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),a.push(i(t)+"="+i(e))}))}),o=a.join("&")}return o&&(e+=(-1===e.indexOf("?")?"?":"&")+o),e}},function(e,t,r){"use strict";var n=r(39),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,o,a={};return e?(n.forEach(e.split("\n"),function(e){if(o=e.indexOf(":"),t=n.trim(e.substr(0,o)).toLowerCase(),r=n.trim(e.substr(o+1)),t){if(a[t]&&i.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([r]):a[t]?a[t]+", "+r:r}}),a):a}},function(e,t,r){"use strict";var n=r(39);e.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function i(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=i(window.location.href),function(t){var r=n.isString(t)?i(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},function(e,t,r){"use strict";var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function i(){this.message="String contains an invalid character"}i.prototype=new Error,i.prototype.code=5,i.prototype.name="InvalidCharacterError",e.exports=function(e){for(var t,r,o=String(e),a="",s=0,l=n;o.charAt(0|s)||(l="=",s%1);a+=l.charAt(63&t>>8-s%1*8)){if((r=o.charCodeAt(s+=.75))>255)throw new i;t=t<<8|r}return a}},function(e,t,r){"use strict";var n=r(39);e.exports=n.isStandardBrowserEnv()?{write:function(e,t,r,i,o,a){var s=[];s.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),n.isString(i)&&s.push("path="+i),n.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,r){"use strict";var n=r(39);function i(){this.handlers=[]}i.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){n.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=i},function(e,t,r){"use strict";var n=r(39),i=r(280),o=r(166),a=r(132),s=r(281),l=r(282);function u(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return u(e),e.baseURL&&!s(e.url)&&(e.url=l(e.baseURL,e.url)),e.headers=e.headers||{},e.data=i(e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),n.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]}),(e.adapter||a.adapter)(e).then(function(t){return u(e),t.data=i(t.data,t.headers,e.transformResponse),t},function(t){return o(t)||(u(e),t&&t.response&&(t.response.data=i(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e,t,r){"use strict";var n=r(39);e.exports=function(e,t,r){return n.forEach(r,function(r){e=r(e,t)}),e}},function(e,t,r){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,r){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,r){"use strict";var n=r(167);function i(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var r=this;e(function(e){r.reason||(r.reason=new n(e),t(r.reason))})}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var e;return{token:new i(function(t){e=t}),cancel:e}},e.exports=i},function(e,t,r){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,r){var n=r(286);e.exports=function(e){return n(e).replace(/[\W_]+(.|$)/g,function(e,t){return t?" "+t:""}).trim()}},function(e,t){e.exports=function(e){return r.test(e)?e.toLowerCase():n.test(e)?(function(e){return e.replace(o,function(e,t){return t?" "+t:""})}(e)||e).toLowerCase():i.test(e)?function(e){return e.replace(a,function(e,t,r){return t+" "+r.toLowerCase().split("").join(" ")})}(e).toLowerCase():e.toLowerCase()};var r=/\s/,n=/(_|-|\.|:)/,i=/([a-z][A-Z]|[A-Z][a-z])/;var o=/[\W_]+(.|$)/g;var a=/(.)([A-Z]+)/g},function(e,t){e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},function(e,t,r){"use strict";var n=r(59),i=r(291),o=r(60),a=r(184),s=r(363),l=r(377),u=r(378),c=r(379);function h(e,t,r){t=c.arrayify(t),e=c.arrayify(e);var n=t.length;if(0===e.length||0===n)return[];if(1===n)return h.match(e,t[0],r);for(var i=[],o=[],a=-1;++a<n;){var s=t[a];"string"===typeof s&&33===s.charCodeAt(0)?i.push.apply(i,h.match(e,s.slice(1),r)):o.push.apply(o,h.match(e,s,r))}var l=c.diff(o,i);return r&&!1===r.nodupes?l:c.unique(l)}function p(e){return""===String(e)||"./"===String(e)}function f(e,t,r,n){var i=c.createKey(e+"="+t,r);if(r&&!1===r.cache)return n(t,r);if(u.has(e,i))return u.get(e,i);var o=n(t,r);return u.set(e,i,o),o}h.match=function(e,t,r){if(Array.isArray(t))throw new TypeError("expected pattern to be a string");for(var n=c.unixify(r),i=f("match",t,r,h.matcher),o=[],a=(e=c.arrayify(e)).length,s=-1;++s<a;){var l=e[s];(l===t||i(l))&&o.push(c.value(l,n,r))}if("undefined"===typeof r)return c.unique(o);if(0===o.length){if(!0===r.failglob)throw new Error('no matches found for "'+t+'"');if(!0===r.nonull||!0===r.nullglob)return[r.unescape?c.unescape(t):t]}return r.ignore&&(o=h.not(o,r.ignore,r)),!1!==r.nodupes?c.unique(o):o},h.isMatch=function(e,t,r){if("string"!==typeof e)throw new TypeError('expected a string: "'+n.inspect(e)+'"');return!p(e)&&!p(t)&&(!!c.equalsPattern(r)(e)||f("isMatch",t,r,h.matcher)(e))},h.some=function(e,t,r){"string"===typeof e&&(e=[e]);for(var n=0;n<e.length;n++)if(1===h(e[n],t,r).length)return!0;return!1},h.every=function(e,t,r){"string"===typeof e&&(e=[e]);for(var n=0;n<e.length;n++)if(1!==h(e[n],t,r).length)return!1;return!0},h.any=function(e,t,r){if("string"!==typeof e)throw new TypeError('expected a string: "'+n.inspect(e)+'"');if(p(e)||p(t))return!1;"string"===typeof t&&(t=[t]);for(var i=0;i<t.length;i++)if(h.isMatch(e,t[i],r))return!0;return!1},h.all=function(e,t,r){if("string"!==typeof e)throw new TypeError('expected a string: "'+n.inspect(e)+'"');"string"===typeof t&&(t=[t]);for(var i=0;i<t.length;i++)if(!h.isMatch(e,t[i],r))return!1;return!0},h.not=function(e,t,r){var n=a({},r),i=n.ignore;delete n.ignore;var o=c.unixify(n);e=c.arrayify(e).map(o);var s=c.diff(e,h(e,t,n));return i&&(s=c.diff(s,h(e,i))),!1!==n.nodupes?c.unique(s):s},h.contains=function(e,t,r){if("string"!==typeof e)throw new TypeError('expected a string: "'+n.inspect(e)+'"');if("string"===typeof t){if(p(e)||p(t))return!1;if(c.equalsPattern(t,r)(e))return!0;if(c.containsPattern(t,r)(e))return!0}var i=a({},r,{contains:!0});return h.any(e,t,i)},h.matchBase=function(e,t){return!(e&&-1!==e.indexOf("/")||!t)&&(!0===t.basename||!0===t.matchBase)},h.matchKeys=function(e,t,r){if(!c.isObject(e))throw new TypeError("expected the first argument to be an object");var n=h(Object.keys(e),t,r);return c.pick(e,n)},h.matcher=function e(t,r){if(Array.isArray(t))return function(e,t,r){var n;return f("compose",String(e),t,function(){return function(i){if(!n){n=[];for(var o=0;o<e.length;o++)n.push(r(e[o],t))}for(var a=n.length;a--;)if(!0===n[a](i))return!0;return!1}})}(t,r,e);if(t instanceof RegExp)return i(t);if(!c.isString(t))throw new TypeError("expected pattern to be an array, string or regex");if(!c.hasSpecialChars(t))return r&&!0===r.nocase&&(t=t.toLowerCase()),c.matchPath(t,r);var n=h.makeRe(t,r);if(h.matchBase(t,r))return c.matchBasename(n,r);function i(e){var t=c.equalsPattern(r),n=c.unixify(r);return function(r){return!!t(r)||!!e.test(n(r))}}var o=i(n);return Object.defineProperty(o,"result",{configurable:!0,enumerable:!1,value:n.result}),o},h.capture=function(e,t,r){var n=h.makeRe(e,a({capture:!0},r)),i=c.unixify(r);return f("capture",e,r,function(){return function(e){var t=n.exec(i(e));return t?t.slice(1):null}})(t)},h.makeRe=function(e,t){if("string"!==typeof e)throw new TypeError("expected pattern to be a string");if(e.length>65536)throw new Error("expected pattern to be less than 65536 characters");return f("makeRe",e,t,function(){var r=h.create(e,t),n=[],i=r.map(function(e){return e.ast.state=e.state,n.push(e.ast),e.output}),a=o(i.join("|"),t);return Object.defineProperty(a,"result",{configurable:!0,enumerable:!1,value:n}),a})},h.braces=function(e,t){if("string"!==typeof e&&!Array.isArray(e))throw new TypeError("expected pattern to be an array or string");return f("braces",e,t,function(){return t&&!0===t.nobrace||!/\{.*\}/.test(e)?c.arrayify(e):i(e,t)})},h.braceExpand=function(e,t){var r=a({},t,{expand:!0});return h.braces(e,r)},h.create=function(e,t){return f("create",e,t,function(){for(var r,n,i=(e=h.braces(e,t)).length,o=-1,a=[];++o<i;)a.push((r=e[o],n=t,h.compile(h.parse(r,n),n)));return a})},h.parse=function(e,t){if("string"!==typeof e)throw new TypeError("expected a string");return f("parse",e,t,function(){var r=c.instantiate(null,t);l(r,t);var n=r.parse(e,t);return c.define(n,"snapdragon",r),n.input=e,n})},h.compile=function(e,t){return"string"===typeof e&&(e=h.parse(e,t)),f("compile",e.input,t,function(){var r=c.instantiate(e,t);return s(r,t),r.compile(e,t)})},h.clearCache=function(){h.cache.caches={}},h.compilers=s,h.parsers=l,h.caches=u.caches,e.exports=h},function(e,t){e.exports=function(e){return e&&"object"===typeof e&&"function"===typeof e.copy&&"function"===typeof e.fill&&"function"===typeof e.readUInt8}},function(e,t){"function"===typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},function(e,t,r){"use strict";var n=r(60),i=r(95),o=r(49),a=r(171),s=r(174),l=r(314),u=r(107),c={};function h(e,t){var r=u.createKey(String(e),t),n=[],o=t&&!1===t.cache;if(!o&&c.hasOwnProperty(r))return c[r];if(Array.isArray(e))for(var a=0;a<e.length;a++)n.push.apply(n,h.create(e[a],t));else n=h.create(e,t);return t&&!0===t.nodupes&&(n=i(n)),o||(c[r]=n),n}function p(e,t,r,n){var i=u.createKey(e+":"+t,r);if(r&&!1===r.cache)return h.clearCache(),n(t,r);if(c.hasOwnProperty(i))return c[i];var o=n(t,r);return c[i]=o,o}h.expand=function(e,t){return h.create(e,o({},t,{expand:!0}))},h.optimize=function(e,t){return h.create(e,t)},h.create=function(e,t){if("string"!==typeof e)throw new TypeError("expected a string");var r=t&&t.maxLength||65536;if(e.length>=r)throw new Error("expected pattern to be less than "+r+" characters");return p("create",e,t,function(){if(""===e||e.length<3)return[e];if(u.isEmptySets(e))return[];if(u.isQuotedString(e))return[e.slice(1,-1)];var r=new l(t),n=t&&!0===t.expand?r.expand(e,t):r.optimize(e,t),o=n.output;return t&&!0===t.noempty&&(o=o.filter(Boolean)),t&&!0===t.nodupes&&(o=i(o)),Object.defineProperty(o,"result",{enumerable:!1,value:n}),o})},h.makeRe=function(e,t){if("string"!==typeof e)throw new TypeError("expected a string");var r=t&&t.maxLength||65536;if(e.length>=r)throw new Error("expected pattern to be less than "+r+" characters");return p("makeRe",e,t,function(){var r=h(e,t),i=o({strictErrors:!1},t);return n(r,i)})},h.parse=function(e,t){return new l(t).parse(e,t)},h.compile=function(e,t){return new l(t).compile(e,t)},h.clearCache=function(){c=h.cache={}},h.Braces=l,h.compilers=a,h.parsers=s,h.cache=c,e.exports=h},function(e,t,r){var n=r(293),i=r(105),o=r(170),a=r(294);e.exports=function(e){var t,r,s=0,l={type:i.ROOT,stack:[]},u=l,c=l.stack,h=[],p=function(t){n.error(e,"Nothing to repeat at column "+(t-1))},f=n.strToChars(e);for(t=f.length;s<t;)switch(r=f[s++]){case"\\":switch(r=f[s++]){case"b":c.push(a.wordBoundary());break;case"B":c.push(a.nonWordBoundary());break;case"w":c.push(o.words());break;case"W":c.push(o.notWords());break;case"d":c.push(o.ints());break;case"D":c.push(o.notInts());break;case"s":c.push(o.whitespace());break;case"S":c.push(o.notWhitespace());break;default:/\d/.test(r)?c.push({type:i.REFERENCE,value:parseInt(r,10)}):c.push({type:i.CHAR,value:r.charCodeAt(0)})}break;case"^":c.push(a.begin());break;case"$":c.push(a.end());break;case"[":var d;"^"===f[s]?(d=!0,s++):d=!1;var m=n.tokenizeClass(f.slice(s),e);s+=m[1],c.push({type:i.SET,set:m[0],not:d});break;case".":c.push(o.anyChar());break;case"(":var v={type:i.GROUP,stack:[],remember:!0};"?"===(r=f[s])&&(r=f[s+1],s+=2,"="===r?v.followedBy=!0:"!"===r?v.notFollowedBy=!0:":"!==r&&n.error(e,"Invalid group, character '"+r+"' after '?' at column "+(s-1)),v.remember=!1),c.push(v),h.push(u),u=v,c=v.stack;break;case")":0===h.length&&n.error(e,"Unmatched ) at column "+(s-1)),c=(u=h.pop()).options?u.options[u.options.length-1]:u.stack;break;case"|":u.options||(u.options=[u.stack],delete u.stack);var g=[];u.options.push(g),c=g;break;case"{":var y,b,x=/^(\d+)(,(\d+)?)?\}/.exec(f.slice(s));null!==x?(0===c.length&&p(s),y=parseInt(x[1],10),b=x[2]?x[3]?parseInt(x[3],10):1/0:y,s+=x[0].length,c.push({type:i.REPETITION,min:y,max:b,value:c.pop()})):c.push({type:i.CHAR,value:123});break;case"?":0===c.length&&p(s),c.push({type:i.REPETITION,min:0,max:1,value:c.pop()});break;case"+":0===c.length&&p(s),c.push({type:i.REPETITION,min:1,max:1/0,value:c.pop()});break;case"*":0===c.length&&p(s),c.push({type:i.REPETITION,min:0,max:1/0,value:c.pop()});break;default:c.push({type:i.CHAR,value:r.charCodeAt(0)})}return 0!==h.length&&n.error(e,"Unterminated group"),l},e.exports.types=i},function(e,t,r){var n=r(105),i=r(170),o={0:0,t:9,n:10,v:11,f:12,r:13};t.strToChars=function(e){return e=e.replace(/(\[\\b\])|(\\)?\\(?:u([A-F0-9]{4})|x([A-F0-9]{2})|(0?[0-7]{2})|c([@A-Z\[\\\]\^?])|([0tnvfr]))/g,function(e,t,r,n,i,a,s,l){if(r)return e;var u=t?8:n?parseInt(n,16):i?parseInt(i,16):a?parseInt(a,8):s?"@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^ ?".indexOf(s):o[l],c=String.fromCharCode(u);return/[\[\]{}\^$.|?*+()]/.test(c)&&(c="\\"+c),c})},t.tokenizeClass=function(e,r){for(var o,a,s=[],l=/\\(?:(w)|(d)|(s)|(W)|(D)|(S))|((?:(?:\\)(.)|([^\]\\]))-(?:\\)?([^\]]))|(\])|(?:\\)?(.)/g;null!=(o=l.exec(e));)if(o[1])s.push(i.words());else if(o[2])s.push(i.ints());else if(o[3])s.push(i.whitespace());else if(o[4])s.push(i.notWords());else if(o[5])s.push(i.notInts());else if(o[6])s.push(i.notWhitespace());else if(o[7])s.push({type:n.RANGE,from:(o[8]||o[9]).charCodeAt(0),to:o[10].charCodeAt(0)});else{if(!(a=o[12]))return[s,l.lastIndex];s.push({type:n.CHAR,value:a.charCodeAt(0)})}t.error(r,"Unterminated character class")},t.error=function(e,t){throw new SyntaxError("Invalid regular expression: /"+e+"/: "+t)}},function(e,t,r){var n=r(105);t.wordBoundary=function(){return{type:n.POSITION,value:"b"}},t.nonWordBoundary=function(){return{type:n.POSITION,value:"B"}},t.begin=function(){return{type:n.POSITION,value:"^"}},t.end=function(){return{type:n.POSITION,value:"$"}}},function(e,t,r){"use strict";var n=r(35),i=r(78),o="undefined"!==typeof Reflect&&Reflect.defineProperty?Reflect.defineProperty:Object.defineProperty;e.exports=function(e,t,r){if(!n(e)&&"function"!==typeof e&&!Array.isArray(e))throw new TypeError("expected an object, function, or array");if("string"!==typeof t)throw new TypeError('expected "key" to be a string');return i(r)?(o(e,t,r),e):(o(e,t,{configurable:!0,enumerable:!1,writable:!0,value:r}),e)}},function(e,t){var r=Object.prototype.toString;function n(e){return e.constructor?e.constructor.name:null}e.exports=function(e){if(void 0===e)return"undefined";if(null===e)return"null";var t=typeof e;if("boolean"===t)return"boolean";if("string"===t)return"string";if("number"===t)return"number";if("symbol"===t)return"symbol";if("function"===t)return"GeneratorFunction"===n(e)?"generatorfunction":"function";if(function(e){return Array.isArray?Array.isArray(e):e instanceof Array}(e))return"array";if(function(e){if(e.constructor&&"function"===typeof e.constructor.isBuffer)return e.constructor.isBuffer(e);return!1}(e))return"buffer";if(function(e){try{if("number"===typeof e.length&&"function"===typeof e.callee)return!0}catch(t){if(-1!==t.message.indexOf("callee"))return!0}return!1}(e))return"arguments";if(function(e){return e instanceof Date||"function"===typeof e.toDateString&&"function"===typeof e.getDate&&"function"===typeof e.setDate}(e))return"date";if(function(e){return e instanceof Error||"string"===typeof e.message&&e.constructor&&"number"===typeof e.constructor.stackTraceLimit}(e))return"error";if(function(e){return e instanceof RegExp||"string"===typeof e.flags&&"boolean"===typeof e.ignoreCase&&"boolean"===typeof e.multiline&&"boolean"===typeof e.global}(e))return"regexp";switch(n(e)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(function(e){return"function"===typeof e.throw&&"function"===typeof e.return&&"function"===typeof e.next}(e))return"generator";switch(t=r.call(e)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return t.slice(8,-1).toLowerCase().replace(/\s/g,"")}},function(e,t,r){"use strict";var n=r(298),i={get:"function",set:"function",configurable:"boolean",enumerable:"boolean"};function o(e,t){return{}.hasOwnProperty.call(e,t)}e.exports=function(e,t){if("string"===typeof t)return"undefined"!==typeof Object.getOwnPropertyDescriptor(e,t);if("object"!==n(e))return!1;if(o(e,"value")||o(e,"writable"))return!1;if(!o(e,"get")||"function"!==typeof e.get)return!1;if(o(e,"set")&&"function"!==typeof e[r]&&"undefined"!==typeof e[r])return!1;for(var r in e)if(i.hasOwnProperty(r)&&n(e[r])!==i[r]&&"undefined"!==typeof e[r])return!1;return!0}},function(e,t){var r=Object.prototype.toString;function n(e){return e.constructor?e.constructor.name:null}e.exports=function(e){if(void 0===e)return"undefined";if(null===e)return"null";var t=typeof e;if("boolean"===t)return"boolean";if("string"===t)return"string";if("number"===t)return"number";if("symbol"===t)return"symbol";if("function"===t)return"GeneratorFunction"===n(e)?"generatorfunction":"function";if(function(e){return Array.isArray?Array.isArray(e):e instanceof Array}(e))return"array";if(function(e){if(e.constructor&&"function"===typeof e.constructor.isBuffer)return e.constructor.isBuffer(e);return!1}(e))return"buffer";if(function(e){try{if("number"===typeof e.length&&"function"===typeof e.callee)return!0}catch(t){if(-1!==t.message.indexOf("callee"))return!0}return!1}(e))return"arguments";if(function(e){return e instanceof Date||"function"===typeof e.toDateString&&"function"===typeof e.getDate&&"function"===typeof e.setDate}(e))return"date";if(function(e){return e instanceof Error||"string"===typeof e.message&&e.constructor&&"number"===typeof e.constructor.stackTraceLimit}(e))return"error";if(function(e){return e instanceof RegExp||"string"===typeof e.flags&&"boolean"===typeof e.ignoreCase&&"boolean"===typeof e.multiline&&"boolean"===typeof e.global}(e))return"regexp";switch(n(e)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(function(e){return"function"===typeof e.throw&&"function"===typeof e.return&&"function"===typeof e.next}(e))return"generator";switch(t=r.call(e)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return t.slice(8,-1).toLowerCase().replace(/\s/g,"")}},function(e,t,r){"use strict";var n=r(300);e.exports=function(e,t){var r={configurable:"boolean",enumerable:"boolean",writable:"boolean"};if("object"!==n(e))return!1;if("string"===typeof t)return"undefined"!==typeof Object.getOwnPropertyDescriptor(e,t);if(!("value"in e)&&!("writable"in e))return!1;for(var i in e)if("value"!==i&&r.hasOwnProperty(i)&&n(e[i])!==r[i]&&"undefined"!==typeof e[i])return!1;return!0}},function(e,t){var r=Object.prototype.toString;function n(e){return e.constructor?e.constructor.name:null}e.exports=function(e){if(void 0===e)return"undefined";if(null===e)return"null";var t=typeof e;if("boolean"===t)return"boolean";if("string"===t)return"string";if("number"===t)return"number";if("symbol"===t)return"symbol";if("function"===t)return"GeneratorFunction"===n(e)?"generatorfunction":"function";if(function(e){return Array.isArray?Array.isArray(e):e instanceof Array}(e))return"array";if(function(e){if(e.constructor&&"function"===typeof e.constructor.isBuffer)return e.constructor.isBuffer(e);return!1}(e))return"buffer";if(function(e){try{if("number"===typeof e.length&&"function"===typeof e.callee)return!0}catch(t){if(-1!==t.message.indexOf("callee"))return!0}return!1}(e))return"arguments";if(function(e){return e instanceof Date||"function"===typeof e.toDateString&&"function"===typeof e.getDate&&"function"===typeof e.setDate}(e))return"date";if(function(e){return e instanceof Error||"string"===typeof e.message&&e.constructor&&"number"===typeof e.constructor.stackTraceLimit}(e))return"error";if(function(e){return e instanceof RegExp||"string"===typeof e.flags&&"boolean"===typeof e.ignoreCase&&"boolean"===typeof e.multiline&&"boolean"===typeof e.global}(e))return"regexp";switch(n(e)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(function(e){return"function"===typeof e.throw&&"function"===typeof e.return&&"function"===typeof e.next}(e))return"generator";switch(t=r.call(e)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return t.slice(8,-1).toLowerCase().replace(/\s/g,"")}},function(e,t,r){"use strict";var n=r(302),i=r(93);function o(e,t){for(var r in t)u(t,r)&&(e[r]=t[r])}function a(e){return e&&"string"===typeof e}function s(e){var t={};for(var r in e)t[r]=e[r];return t}function l(e){return e&&"object"===typeof e||n(e)}function u(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=Object.assign||function(e){if(null===e||"undefined"===typeof e)throw new TypeError("Cannot convert undefined or null to object");l(e)||(e={});for(var t=1;t<arguments.length;t++){var r=arguments[t];a(r)&&(r=s(r)),l(r)&&(o(e,r),i(e,r))}return e}},function(e,t,r){"use strict";var n=r(61);e.exports=function(e){return n(e)||"function"===typeof e||Array.isArray(e)}},function(e,t,r){"use strict";var n=r(304),i=r(93);function o(e,t){for(var r in t)u(t,r)&&(e[r]=t[r])}function a(e){return e&&"string"===typeof e}function s(e){var t={};for(var r in e)t[r]=e[r];return t}function l(e){return e&&"object"===typeof e||n(e)}function u(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=Object.assign||function(e){if(null===e||"undefined"===typeof e)throw new TypeError("Cannot convert undefined or null to object");l(e)||(e={});for(var t=1;t<arguments.length;t++){var r=arguments[t];a(r)&&(r=s(r)),l(r)&&(o(e,r),i(e,r))}return e}},function(e,t,r){"use strict";var n=r(61);e.exports=function(e){return n(e)||"function"===typeof e||Array.isArray(e)}},function(e,t,r){"use strict";var n=r(306),i=r(93);function o(e,t){for(var r in t)u(t,r)&&(e[r]=t[r])}function a(e){return e&&"string"===typeof e}function s(e){var t={};for(var r in e)t[r]=e[r];return t}function l(e){return e&&"object"===typeof e||n(e)}function u(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=Object.assign||function(e){if(null===e||"undefined"===typeof e)throw new TypeError("Cannot convert undefined or null to object");l(e)||(e={});for(var t=1;t<arguments.length;t++){var r=arguments[t];a(r)&&(r=s(r)),l(r)&&(o(e,r),i(e,r))}return e}},function(e,t,r){"use strict";var n=r(61);e.exports=function(e){return n(e)||"function"===typeof e||Array.isArray(e)}},function(e,t,r){"use strict";e.exports=function(e){return function e(t,r){var n,i=0;var o=t.length;for(;i<o;i++)n=t[i],Array.isArray(n)?e(n,r):r.push(n);return r}(e,[])}},function(e,t,r){"use strict";var n=r(59),i=r(133),o=r(49),a=r(173),s=r(309);function l(e,t){if(t.isPadded){var r=String(e),n=r.length,i="";"-"===r.charAt(0)&&(i="-",r=r.slice(1));var o=t.maxLength-n;e=i+a("0",o)+r}return t.stringify?String(e):e}function u(e){return Number(e)||0}function c(e){return/^-?0\d/.test(e)}function h(e){return"string"===typeof e&&1===e.length&&/^\w+$/.test(e)}function p(e){return i(e)&&!/\./.test(e)}e.exports=function(e,t,r,a){if("undefined"===typeof e)return[];if("undefined"===typeof t||e===t){var f="string"===typeof e;return i(e)&&!u(e)?[f?"0":0]:[e]}"number"!==typeof r&&"string"!==typeof r&&(a=r,r=void 0),"function"===typeof a&&(a={transform:a});var d,m,v=o({step:r},a);if(v.step&&!p(v.step)){if(!0===v.strictRanges)throw new TypeError("expected options.step to be a number");return[]}if(v.isNumber=p(e)&&p(t),!v.isNumber&&(m=t,!p(d=e)&&!h(d)||!p(m)&&!h(m))){if(!0===v.strictRanges)throw new RangeError("invalid range arguments: "+n.inspect([e,t]));return[]}return v.isPadded=c(e)||c(t),v.toString=v.stringify||"string"===typeof v.step||"string"===typeof e||"string"===typeof t||!v.isNumber,v.isPadded&&(v.maxLength=Math.max(String(e).length,String(t).length)),"boolean"===typeof v.optimize&&(v.toRegex=v.optimize),"boolean"===typeof v.makeRe&&(v.toRegex=v.makeRe),function(e,t,r){var n=r.isNumber?u(e):e.charCodeAt(0),i=r.isNumber?u(t):t.charCodeAt(0),o=Math.abs(u(r.step))||1;if(r.toRegex&&1===o)return function(e,t,r,n,i){if(i.isPadded)return s(r,n,i);if(i.isNumber)return s(Math.min(e,t),Math.max(e,t),i);var r=String.fromCharCode(Math.min(e,t)),n=String.fromCharCode(Math.max(e,t));return"["+r+"-"+n+"]"}(n,i,e,t,r);for(var a={greater:[],lesser:[]},c=n<i,h=new Array(Math.round((c?i-n:n-i)/o)),p=0;c?n<=i:n>=i;){var f=r.isNumber?n:String.fromCharCode(n);r.toRegex&&(f>=0||!r.isNumber)?a.greater.push(f):a.lesser.push(Math.abs(f)),r.isPadded&&(f=l(f,r)),r.toString&&(f=String(f)),"function"===typeof r.transform?h[p++]=r.transform(f,n,i,o,p,h,r):h[p++]=f,c?n+=o:n-=o}return!0===r.toRegex?function(e,t,r){var n="",i="";t.greater.length&&(n=t.greater.join("|")),t.lesser.length&&(i="-("+t.lesser.join("|")+")");var o=n&&i?n+"|"+i:n||i;return r.capture?"("+o+")":o}(0,a,r):h}(e,t,v)}},function(e,t,r){"use strict";var n=r(173),i=r(133),o={};function a(e,t,r){if(e===t)return{pattern:String(e),digits:[]};for(var n,i,o=function(e,t){var r=[];for(var n in e)r.push([e[n],t[n]]);return r}(String(e),String(t)),a=o.length,s=-1,l="",u=0;++s<a;){var c=o[s],h=c[0],p=c[1];h===p?l+=h:"0"!==h||"9"!==p?l+="["+(n=h)+((i=p)-n===1?"":"-")+i+"]":u+=1}return u&&(l+=r.shorthand?"\\d":"[0-9]"),{pattern:l,digits:[u]}}function s(e,t,r,n){for(var i,o=function(e,t){e=Number(e);for(var r=1,n=[t=Number(t)],i=+p(e,r);e<=i&&i<=t;)n=c(n,i),i=+p(e,r+=1);var o=1;for(i=f(t+1,o)-1;e<i&&i<=t;)n=c(n,i),i=f(t+1,o+=1)-1;return n.sort(u),n}(e,t),s=o.length,l=-1,h=[],m=e;++l<s;){var g=o[l],y=a(m,g,n),b="";r.isPadded||!i||i.pattern!==y.pattern?(r.isPadded&&(b=v(g,r)),y.string=b+y.pattern+d(y.digits),h.push(y),m=g+1,i=y):(i.digits.length>1&&i.digits.pop(),i.digits.push(y.digits[0]),i.string=i.pattern+d(i.digits),m=g+1)}return h}function l(e,t,r,n,i){for(var o=[],a=0;a<e.length;a++){var s=e[a].string;!1!==i.relaxZeros&&"-"===r&&"0"===s.charAt(0)&&(s="{"===s.charAt(1)?"0*"+s.replace(/^0\{\d+\}/,""):"0*"+s.slice(1)),n||h(t,"string",s)||o.push(r+s),n&&h(t,"string",s)&&o.push(r+s)}return o}function u(e,t){return e>t?1:t>e?-1:0}function c(e,t){return-1===e.indexOf(t)&&e.push(t),e}function h(e,t,r){for(var n=0;n<e.length;n++)if(e[n][t]===r)return!0;return!1}function p(e,t){return String(e).slice(0,-t)+n("9",t)}function f(e,t){return e-e%Math.pow(10,t)}function d(e){var t=e[0],r=e[1]?","+e[1]:"";return r||t&&1!==t?"{"+t+r+"}":""}function m(e){return/^-?(0+)\d/.exec(e)}function v(e,t){if(t.isPadded){var r=Math.abs(t.maxLen-String(e).length);switch(r){case 0:return"";case 1:return"0";default:return"0{"+r+"}"}}return e}e.exports=function(e,t,r){if(!1===i(e))throw new RangeError("toRegexRange: first argument is invalid.");if("undefined"===typeof t||e===t)return String(e);if(!1===i(t))throw new RangeError("toRegexRange: second argument is invalid.");r=r||{};var n=e+":"+t+"="+String(r.relaxZeros)+String(r.shorthand)+String(r.capture);if(o.hasOwnProperty(n))return o[n].result;var a=Math.min(e,t),u=Math.max(e,t);if(1===Math.abs(a-u)){var c=e+"|"+t;return r.capture?"("+c+")":c}var h=m(e)||m(t),p=[],f=[],d={min:e,max:t,a:a,b:u};return h&&(d.isPadded=h,d.maxLen=String(d.max).length),a<0&&(f=s(u<0?Math.abs(u):1,Math.abs(a),d,r),a=d.a=0),u>=0&&(p=s(a,u,d,r)),d.negatives=f,d.positives=p,d.result=function(e,t,r){var n=l(e,t,"-",!1,r)||[],i=l(t,e,"",!1,r)||[],o=l(e,t,"-?",!0,r)||[];return n.concat(o).concat(i).join("|")}(f,p,r),r.capture&&p.length+f.length>1&&(d.result="("+d.result+")"),o[n]=d,d.result}},function(e,t,r){"use strict";e.exports=function(e,t){for(var r=new Array(t),n=0;n<t;n++)r[n]=e;return r}},function(e,t,r){"use strict";var n,i=r(35),o=r(312),a=r(313);function s(e,t,r){if("string"!==typeof t&&(r=t,t=null),o(this,"parent",r),o(this,"isNode",!0),o(this,"expect",null),"string"!==typeof t&&i(e)){n||(n=Object.getOwnPropertyNames(s.prototype));for(var a=Object.keys(e),l=0;l<a.length;l++){var u=a[l];-1===n.indexOf(u)&&(this[u]=e[u])}}else this.type=t,this.val=e}function l(e,t){if(!e)throw new Error(t)}s.isNode=function(e){return a.isNode(e)},s.prototype.define=function(e,t){return o(this,e,t),this},s.prototype.isEmpty=function(e){return a.isEmpty(this,e)},s.prototype.push=function(e){return l(s.isNode(e),"expected node to be an instance of Node"),o(e,"parent",this),this.nodes=this.nodes||[],this.nodes.push(e)},s.prototype.unshift=function(e){return l(s.isNode(e),"expected node to be an instance of Node"),o(e,"parent",this),this.nodes=this.nodes||[],this.nodes.unshift(e)},s.prototype.pop=function(){return this.nodes&&this.nodes.pop()},s.prototype.shift=function(){return this.nodes&&this.nodes.shift()},s.prototype.remove=function(e){l(s.isNode(e),"expected node to be an instance of Node"),this.nodes=this.nodes||[];var t=e.index;return-1!==t?(e.index=-1,this.nodes.splice(t,1)):null},s.prototype.find=function(e){return a.findNode(this.nodes,e)},s.prototype.isType=function(e){return a.isType(this,e)},s.prototype.hasType=function(e){return a.hasType(this,e)},Object.defineProperty(s.prototype,"siblings",{set:function(){throw new Error("node.siblings is a getter and cannot be defined")},get:function(){return this.parent?this.parent.nodes:null}}),Object.defineProperty(s.prototype,"index",{set:function(e){o(this,"idx",e)},get:function(){return Array.isArray(this.siblings)?((-1!==this.idx?this.siblings[this.idx]:null)!==this&&(this.idx=this.siblings.indexOf(this)),this.idx):-1}}),Object.defineProperty(s.prototype,"prev",{set:function(){throw new Error("node.prev is a getter and cannot be defined")},get:function(){return Array.isArray(this.siblings)?this.siblings[this.index-1]||this.parent.prev:null}}),Object.defineProperty(s.prototype,"next",{set:function(){throw new Error("node.next is a getter and cannot be defined")},get:function(){return Array.isArray(this.siblings)?this.siblings[this.index+1]||this.parent.next:null}}),Object.defineProperty(s.prototype,"first",{get:function(){return this.nodes?this.nodes[0]:null}}),Object.defineProperty(s.prototype,"last",{get:function(){return this.nodes?a.last(this.nodes):null}}),Object.defineProperty(s.prototype,"scope",{get:function(){return!0!==this.isScope&&this.parent?this.parent.scope:this}}),e.exports=s},function(e,t,r){"use strict";var n=r(78);e.exports=function(e,t,r){if("object"!==typeof e&&"function"!==typeof e)throw new TypeError("expected an object or function.");if("string"!==typeof t)throw new TypeError("expected `prop` to be a string.");return n(r)&&("set"in r||"get"in r)?Object.defineProperty(e,t,r):Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:r})}},function(e,t,r){"use strict";var n=r(108),i=e.exports;function o(e){return"object"===n(e)}function a(e){return"function"===typeof e}function s(e,t,r){return"function"!==typeof e.append?e.emit(t,r):e.append(t,r)}function l(e,t){if(!e)throw new Error(t)}i.isNode=function(e){return"object"===n(e)&&!0===e.isNode},i.noop=function(e){s(this,"",e)},i.identity=function(e){s(this,e.val,e)},i.append=function(e){return function(t){s(this,e,t)}},i.toNoop=function(e,t){t?e.nodes=t:(delete e.nodes,e.type="text",e.val="")},i.visit=function(e,t){return l(i.isNode(e),"expected node to be an instance of Node"),l(a(t),"expected a visitor function"),t(e),e.nodes?i.mapVisit(e,t):e},i.mapVisit=function(e,t){var r;l(i.isNode(e),"expected node to be an instance of Node"),l((r=e.nodes,Array.isArray(r)),"expected node.nodes to be an array"),l(a(t),"expected a visitor function");for(var n=0;n<e.nodes.length;n++)i.visit(e.nodes[n],t);return e},i.addOpen=function(e,t,r,n){if(l(i.isNode(e),"expected node to be an instance of Node"),l(a(t),"expected Node to be a constructor function"),"function"===typeof r&&(n=r,r=""),"function"!==typeof n||n(e)){var o=new t({type:e.type+".open",val:r}),s=e.unshift||e.unshiftNode;return"function"===typeof s?s.call(e,o):i.unshiftNode(e,o),o}},i.addClose=function(e,t,r,n){if(l(i.isNode(e),"expected node to be an instance of Node"),l(a(t),"expected Node to be a constructor function"),"function"===typeof r&&(n=r,r=""),"function"!==typeof n||n(e)){var o=new t({type:e.type+".close",val:r}),s=e.push||e.pushNode;return"function"===typeof s?s.call(e,o):i.pushNode(e,o),o}},i.wrapNodes=function(e,t,r){return l(i.isNode(e),"expected node to be an instance of Node"),l(a(t),"expected Node to be a constructor function"),i.addOpen(e,t,r),i.addClose(e,t,r),e},i.pushNode=function(e,t){return l(i.isNode(e),"expected parent node to be an instance of Node"),l(i.isNode(t),"expected node to be an instance of Node"),t.define("parent",e),e.nodes=e.nodes||[],e.nodes.push(t),t},i.unshiftNode=function(e,t){l(i.isNode(e),"expected parent node to be an instance of Node"),l(i.isNode(t),"expected node to be an instance of Node"),t.define("parent",e),e.nodes=e.nodes||[],e.nodes.unshift(t)},i.popNode=function(e){return l(i.isNode(e),"expected node to be an instance of Node"),"function"===typeof e.pop?e.pop():e.nodes&&e.nodes.pop()},i.shiftNode=function(e){return l(i.isNode(e),"expected node to be an instance of Node"),"function"===typeof e.shift?e.shift():e.nodes&&e.nodes.shift()},i.removeNode=function(e,t){if(l(i.isNode(e),"expected parent.node to be an instance of Node"),l(i.isNode(t),"expected node to be an instance of Node"),!e.nodes)return null;if("function"===typeof e.remove)return e.remove(t);var r=e.nodes.indexOf(t);return-1!==r?e.nodes.splice(r,1):void 0},i.isType=function(e,t){switch(l(i.isNode(e),"expected node to be an instance of Node"),n(t)){case"array":for(var r=t.slice(),o=0;o<r.length;o++)if(i.isType(e,r[o]))return!0;return!1;case"string":return e.type===t;case"regexp":return t.test(e.type);default:throw new TypeError('expected "type" to be an array, string or regexp')}},i.hasType=function(e,t){if(l(i.isNode(e),"expected node to be an instance of Node"),!Array.isArray(e.nodes))return!1;for(var r=0;r<e.nodes.length;r++)if(i.isType(e.nodes[r],t))return!0;return!1},i.firstOfType=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(i.isType(n,t))return n}},i.findNode=function(e,t){return Array.isArray(e)?"number"===typeof t?e[t]:i.firstOfType(e,t):null},i.isOpen=function(e){return l(i.isNode(e),"expected node to be an instance of Node"),".open"===e.type.slice(-5)},i.isClose=function(e){return l(i.isNode(e),"expected node to be an instance of Node"),".close"===e.type.slice(-6)},i.hasOpen=function(e){l(i.isNode(e),"expected node to be an instance of Node");var t=e.first||e.nodes?e.nodes[0]:null;return!!i.isNode(t)&&t.type===e.type+".open"},i.hasClose=function(e){l(i.isNode(e),"expected node to be an instance of Node");var t=e.last||e.nodes?e.nodes[e.nodes.length-1]:null;return!!i.isNode(t)&&t.type===e.type+".close"},i.hasOpenAndClose=function(e){return i.hasOpen(e)&&i.hasClose(e)},i.addType=function(e,t){l(i.isNode(t),"expected node to be an instance of Node"),l(o(e),"expected state to be an object");var r=t.parent?t.parent.type:t.type.replace(/\.open$/,"");e.hasOwnProperty("inside")||(e.inside={}),e.inside.hasOwnProperty(r)||(e.inside[r]=[]);var n=e.inside[r];return n.push(t),n},i.removeType=function(e,t){l(i.isNode(t),"expected node to be an instance of Node"),l(o(e),"expected state to be an object");var r=t.parent?t.parent.type:t.type.replace(/\.close$/,"");if(e.inside.hasOwnProperty(r))return e.inside[r].pop()},i.isEmpty=function(e,t){if(l(i.isNode(e),"expected node to be an instance of Node"),!Array.isArray(e.nodes))return"text"!==e.type||("function"===typeof t?t(e,e.parent):!i.trim(e.val));for(var r=0;r<e.nodes.length;r++){var n=e.nodes[r];if(!i.isOpen(n)&&!i.isClose(n)&&!i.isEmpty(n,t))return!1}return!0},i.isInsideType=function(e,t){return l(o(e),"expected state to be an object"),l("string"===typeof t,"expected type to be a string"),!!e.hasOwnProperty("inside")&&(!!e.inside.hasOwnProperty(t)&&e.inside[t].length>0)},i.isInside=function(e,t,r){if(l(i.isNode(t),"expected node to be an instance of Node"),l(o(e),"expected state to be an object"),Array.isArray(r)){for(var a=0;a<r.length;a++)if(i.isInside(e,t,r[a]))return!0;return!1}var s=t.parent;if("string"===typeof r)return s&&s.type===r||i.isInsideType(e,r);if("regexp"===n(r)){if(s&&s.type&&r.test(s.type))return!0;for(var u=Object.keys(e.inside),c=u.length,h=-1;++h<c;){var p=u[h],f=e.inside[p];if(Array.isArray(f)&&0!==f.length&&r.test(p))return!0}}return!1},i.last=function(e,t){return e[e.length-(t||1)]},i.arrayify=function(e){return"string"===typeof e&&""!==e?[e]:Array.isArray(e)?e:[]},i.stringify=function(e){return i.arrayify(e).join(",")},i.trim=function(e){return"string"===typeof e?e.trim():""}},function(e,t,r){"use strict";var n=r(49),i=r(96),o=r(171),a=r(174),s=r(107);function l(e){this.options=n({},e)}l.prototype.init=function(e){if(!this.isInitialized){this.isInitialized=!0;var t=s.createOptions({},this.options,e);this.snapdragon=this.options.snapdragon||new i(t),this.compiler=this.snapdragon.compiler,this.parser=this.snapdragon.parser,o(this.snapdragon,t),a(this.snapdragon,t),s.define(this.snapdragon,"parse",function(e,t){var r=i.prototype.parse.apply(this,arguments);this.parser.ast.input=e;for(var n=this.parser.stack;n.length;)o({type:"brace.close",val:""},n.pop());function o(e,t){s.define(e,"parent",t),t.nodes.push(e)}return s.define(r,"parser",this.parser),r})}},l.prototype.parse=function(e,t){return e&&"object"===typeof e&&e.nodes?e:(this.init(t),this.snapdragon.parse(e,t))},l.prototype.compile=function(e,t){return"string"===typeof e?e=this.parse(e,t):this.init(t),this.snapdragon.compile(e,t)},l.prototype.expand=function(e){var t=this.parse(e,{expand:!0});return this.compile(t,{expand:!0})},l.prototype.optimize=function(e){var t=this.parse(e,{optimize:!0});return this.compile(t,{optimize:!0})},e.exports=l},function(e,t,r){"use strict";var n=r(59),i=r(316),o=r(317),a=r(62),s=r(35),l=r(330),u=r(333),c=r(334);function h(e){var t=e?o.namespace(e):o,r=[];function h(e,r){if(!(this instanceof h))return new h(e,r);t.call(this,e),this.is("base"),this.initBase(e,r)}return n.inherits(h,t),a(h),h.prototype.initBase=function(t,n){this.options=l({},this.options,n),this.cache=this.cache||{},this.define("registered",{}),e&&(this[e]={}),this.define("_callbacks",this._callbacks),s(t)&&this.visit("set",t),h.run(this,"use",r)},h.prototype.is=function(e){if("string"!==typeof e)throw new TypeError("expected name to be a string");return this.define("is"+u(e),!0),this.define("_name",e),this.define("_appname",e),this},h.prototype.isRegistered=function(e,t){return!!this.registered.hasOwnProperty(e)||(!1!==t&&(this.registered[e]=!0,this.emit("plugin",e)),!1)},h.prototype.use=function(e){return e.call(this,this),this},h.prototype.define=function(e,t){return s(e)?this.visit("define",e):(i(this,e,t),this)},h.prototype.mixin=function(e,t){return h.prototype[e]=t,this},h.prototype.mixins=h.prototype.mixins||[],Object.defineProperty(h.prototype,"base",{configurable:!0,get:function(){return this.parent?this.parent.base:this}}),i(h,"use",function(e){return r.push(e),h}),i(h,"run",function(e,t,r){for(var n=r.length,i=0;n--;)e[t](r[i++]);return h}),i(h,"extend",c.extend(h,function(e,t){return e.prototype.mixins=e.prototype.mixins||[],i(e,"mixin",function(t){var r=t(e.prototype,e);return"function"===typeof r&&e.prototype.mixins.push(r),e}),i(e,"mixins",function(t){return h.run(t,"mixin",e.prototype.mixins),e}),e.prototype.mixin=function(t,r){return e.prototype[t]=r,this},h})),i(h,"mixin",function(e){var t=e(h.prototype,h);return"function"===typeof t&&h.prototype.mixins.push(t),h}),i(h,"mixins",function(e){return h.run(e,"mixin",h.prototype.mixins),h}),i(h,"inherit",c.inherit),i(h,"bubble",c.bubble),h}e.exports=h(),e.exports.namespace=h},function(e,t,r){"use strict";var n=r(78);e.exports=function(e,t,r){if("object"!==typeof e&&"function"!==typeof e)throw new TypeError("expected an object or function.");if("string"!==typeof t)throw new TypeError("expected `prop` to be a string.");return n(r)&&("set"in r||"get"in r)?Object.defineProperty(e,t,r):Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:r})}},function(e,t,r){"use strict";var n=r(35),i=r(62),o=r(318),a=r(176),s=r(320),l=r(322),u=r(109),c=(r(326),r(329));function h(e){function t(t){e&&(this[e]={}),t&&this.set(t)}return i(t.prototype),t.prototype.set=function(t,r){return Array.isArray(t)&&2===arguments.length&&(t=a(t)),n(t)||Array.isArray(t)?this.visit("set",t):(c(e?this[e]:this,t,r),this.emit("set",t,r)),this},t.prototype.union=function(t,r){Array.isArray(t)&&2===arguments.length&&(t=a(t));var n=e?this[e]:this;return s(n,t,function(e){return e?Array.isArray(e)?e:[e]:[]}(r)),this.emit("union",r),this},t.prototype.get=function(t){t=a(arguments);var r=e?this[e]:this,n=u(r,t);return this.emit("get",t,n),n},t.prototype.has=function(t){t=a(arguments);var r=e?this[e]:this,n="undefined"!==typeof u(r,t);return this.emit("has",t,n),n},t.prototype.del=function(t){return Array.isArray(t)?this.visit("del",t):(l(e?this[e]:this,t),this.emit("del",t)),this},t.prototype.clear=function(){e&&(this[e]={})},t.prototype.visit=function(e,t){return o(this,e,t),this},t}e.exports=h(),e.exports.namespace=h},function(e,t,r){"use strict";var n=r(175),i=r(319);e.exports=function(e,t,r){var o;if("string"===typeof r&&t in e){var a=[].slice.call(arguments,2);o=e[t].apply(e,a)}else o=Array.isArray(r)?i.apply(null,arguments):n.apply(null,arguments);return"undefined"!==typeof o?o:e}},function(e,t,r){"use strict";var n=r(59),i=r(175);function o(e){return e&&("function"===typeof e||!Array.isArray(e)&&"object"===typeof e)}e.exports=function(e,t,r){if(o(r))return i.apply(null,arguments);if(!Array.isArray(r))throw new TypeError("expected an array: "+n.inspect(r));for(var a=[].slice.call(arguments,3),s=0;s<r.length;s++){var l=r[s];o(l)?i.apply(null,[e,t,l].concat(a)):e[t].apply(e,[l].concat(a))}}},function(e,t,r){"use strict";var n=r(106),i=r(177),o=r(109),a=r(321);function s(e){return null===e||"undefined"===typeof e?[]:Array.isArray(e)?e:[e]}e.exports=function(e,t,r){if(!n(e))throw new TypeError("union-value expects the first argument to be an object.");if("string"!==typeof t)throw new TypeError("union-value expects `prop` to be a string.");var l=s(o(e,t));return a(e,t,i(l,s(r))),e}},function(e,t,r){"use strict";var n=r(176),i=r(49),o=r(61),a=r(106);e.exports=function(e,t,r){if(!a(e))return e;if(Array.isArray(t)&&(t=n(t)),"string"!==typeof t)return e;for(var s,l=t.split("."),u=l.length,c=-1,h=e;++c<u;){for(var p=l[c];"\\"===p[p.length-1];)p=p.slice(0,-1)+"."+l[++c];if(c===u-1){s=p;break}a(e[p])||(e[p]={}),e=e[p]}return e.hasOwnProperty(s)&&a(e[s])&&o(r)?i(e[s],r):e[s]=r,h}},function(e,t,r){"use strict";var n=r(35),i=r(323);e.exports=function(e,t){if(!n(e))throw new TypeError("expected an object.");if(e.hasOwnProperty(t))return delete e[t],!0;if(i(e,t)){for(var r=t.split("."),o=r.pop();r.length&&"\\"===r[r.length-1].slice(-1);)o=r.pop().slice(0,-1)+"."+o;for(;r.length;)e=e[t=r.shift()];return delete e[o]}return!0}},function(e,t,r){"use strict";var n=r(324),i=r(325),o=r(109);e.exports=function(e,t,r){return n(e)?i(o(e,t),r):i(e,t)}},function(e,t,r){"use strict";var n=r(178);e.exports=function(e){return null!=e&&"object"===typeof e&&!1===n(e)}},function(e,t,r){"use strict";e.exports=function(e,t){if(null===e||void 0===e)return!1;if("boolean"===typeof e)return!0;if("number"===typeof e)return 0!==e||!0!==t;if(void 0!==e.length)return 0!==e.length;for(var r in e)if(e.hasOwnProperty(r))return!0;return!1}},function(e,t,r){"use strict";var n=r(35),i=r(327),o=r(109);e.exports=function(e,t){return i(n(e)&&t?o(e,t):e)}},function(e,t,r){"use strict";var n=r(328),i=r(133);e.exports=function e(t){if(i(t))return!0;switch(n(t)){case"null":case"boolean":case"function":return!0;case"string":case"arguments":return 0!==t.length;case"error":return""!==t.message;case"array":var r=t.length;if(0===r)return!1;for(var o=0;o<r;o++)if(e(t[o]))return!0;return!1;case"file":case"map":case"set":return 0!==t.size;case"object":var a=Object.keys(t);if(0===a.length)return!1;for(o=0;o<a.length;o++){if(e(t[a[o]]))return!0}return!1;default:return!1}}},function(e,t,r){var n=r(92),i=Object.prototype.toString;e.exports=function(e){if("undefined"===typeof e)return"undefined";if(null===e)return"null";if(!0===e||!1===e||e instanceof Boolean)return"boolean";if("string"===typeof e||e instanceof String)return"string";if("number"===typeof e||e instanceof Number)return"number";if("function"===typeof e||e instanceof Function)return"function";if("undefined"!==typeof Array.isArray&&Array.isArray(e))return"array";if(e instanceof RegExp)return"regexp";if(e instanceof Date)return"date";var t=i.call(e);return"[object RegExp]"===t?"regexp":"[object Date]"===t?"date":"[object Arguments]"===t?"arguments":"[object Error]"===t?"error":"[object Promise]"===t?"promise":n(e)?"buffer":"[object Set]"===t?"set":"[object WeakSet]"===t?"weakset":"[object Map]"===t?"map":"[object WeakMap]"===t?"weakmap":"[object Symbol]"===t?"symbol":"[object Int8Array]"===t?"int8array":"[object Uint8Array]"===t?"uint8array":"[object Uint8ClampedArray]"===t?"uint8clampedarray":"[object Int16Array]"===t?"int16array":"[object Uint16Array]"===t?"uint16array":"[object Int32Array]"===t?"int32array":"[object Uint32Array]"===t?"uint32array":"[object Float32Array]"===t?"float32array":"[object Float64Array]"===t?"float64array":"object"}},function(e,t,r){"use strict";var n=r(172),i=r(49),o=r(61),a=r(106);e.exports=function(e,t,r){if(!a(e))return e;if(Array.isArray(t)&&(t=[].concat.apply([],t).join(".")),"string"!==typeof t)return e;for(var s=n(t,{sep:".",brackets:!0}),l=s.length,u=-1,c=e;++u<l;){var h=s[u];u===l-1?o(c[h])&&o(r)?c[h]=i({},c[h],r):c[h]=r:(a(c[h])||(c[h]={}),c=c[h])}return e}},function(e,t,r){"use strict";var n=r(331),i=r(332);function o(e,t){for(var r=arguments.length,n=0;++n<r;){var o=arguments[n];s(o)&&i(o,a,e)}return e}function a(e,t){if("__proto__"!==t){var r=this[t];s(e)&&s(r)?o(r,e):this[t]=e}}function s(e){return n(e)&&!Array.isArray(e)}e.exports=o},function(e,t,r){"use strict";var n=r(61);e.exports=function(e){return n(e)||"function"===typeof e||Array.isArray(e)}},function(e,t,r){"use strict";e.exports=function(e,t,r){for(var n in e)if(!1===t.call(r,e[n],n,e))break}},function(e,t){e.exports=function(e){if("string"!==typeof e)throw new TypeError("expected a string.");return 1===(e=e.replace(/([A-Z])/g," $1")).length?e.toUpperCase():(e=(e=e.replace(/^[\W_]+|[\W_]+$/g,"").toLowerCase()).charAt(0).toUpperCase()+e.slice(1)).replace(/[\W_]+(\w|$)/g,function(e,t){return t.toUpperCase()})}},function(e,t,r){"use strict";r(59);var n=r(177),i=r(55),o=r(341),a=r(35),s=e.exports;s.isObject=function(e){return a(e)||"function"===typeof e},s.has=function(e,t){var r=(t=s.arrayify(t)).length;if(s.isObject(e)){for(var n in e)if(t.indexOf(n)>-1)return!0;var i=s.nativeKeys(e);return s.has(i,t)}if(Array.isArray(e)){for(var o=e;r--;)if(o.indexOf(t[r])>-1)return!0;return!1}throw new TypeError("expected an array or object.")},s.hasAll=function(e,t){for(var r=(t=s.arrayify(t)).length;r--;)if(!s.has(e,t[r]))return!1;return!0},s.arrayify=function(e){return e?Array.isArray(e)?e:[e]:[]},s.noop=function(){},s.identity=function(e){return e},s.hasConstructor=function(e){return s.isObject(e)&&"undefined"!==typeof e.constructor},s.nativeKeys=function(e){if(!s.hasConstructor(e))return[];var t=Object.getOwnPropertyNames(e);return"caller"in e&&t.push("caller"),t},s.getDescriptor=function(e,t){if(!s.isObject(e))throw new TypeError("expected an object.");if("string"!==typeof t)throw new TypeError("expected key to be a string.");return Object.getOwnPropertyDescriptor(e,t)},s.copyDescriptor=function(e,t,r){if(!s.isObject(e))throw new TypeError("expected receiving object to be an object.");if(!s.isObject(t))throw new TypeError("expected providing object to be an object.");if("string"!==typeof r)throw new TypeError("expected name to be a string.");var n=s.getDescriptor(t,r);n&&Object.defineProperty(e,r,n)},s.copy=function(e,t,r){if(!s.isObject(e))throw new TypeError("expected receiving object to be an object.");if(!s.isObject(t))throw new TypeError("expected providing object to be an object.");var n,o=Object.getOwnPropertyNames(t),a=Object.keys(t),l=o.length;for(r=s.arrayify(r);l--;)n=o[l],s.has(a,n)?i(e,n,t[n]):n in e||s.has(r,n)||s.copyDescriptor(e,t,n)},s.inherit=function(e,t,r){if(!s.isObject(e))throw new TypeError("expected receiving object to be an object.");if(!s.isObject(t))throw new TypeError("expected providing object to be an object.");var n=[];for(var i in t)n.push(i),e[i]=t[i];n=n.concat(s.arrayify(r));var o=t.prototype||t,a=e.prototype||e;s.copy(a,o,n)},s.extend=function(){return o.apply(null,arguments)},s.bubble=function(e,t){t=t||[],e.bubble=function(r,i){Array.isArray(i)&&(t=n([],t,i));for(var o=t.length,a=-1;++a<o;){var l=t[a];e.on(l,r.emit.bind(r,l))}s.bubble(r,t)}}},function(e,t,r){"use strict";var n=r(336),i=r(337),o=r(339);e.exports=function(e,t){return"object"===n(e)&&("get"in e?i(e,t):o(e,t))}},function(e,t){var r=Object.prototype.toString;e.exports=function(e){var t=typeof e;return"undefined"===t?"undefined":null===e?"null":!0===e||!1===e||e instanceof Boolean?"boolean":"string"===t||e instanceof String?"string":"number"===t||e instanceof Number?"number":"function"===t||e instanceof Function?"undefined"!==typeof e.constructor.name&&"Generator"===e.constructor.name.slice(0,9)?"generatorfunction":"function":"undefined"!==typeof Array.isArray&&Array.isArray(e)?"array":e instanceof RegExp?"regexp":e instanceof Date?"date":"[object RegExp]"===(t=r.call(e))?"regexp":"[object Date]"===t?"date":"[object Arguments]"===t?"arguments":"[object Error]"===t?"error":"[object Promise]"===t?"promise":function(e){return e.constructor&&"function"===typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}(e)?"buffer":"[object Set]"===t?"set":"[object WeakSet]"===t?"weakset":"[object Map]"===t?"map":"[object WeakMap]"===t?"weakmap":"[object Symbol]"===t?"symbol":"[object Map Iterator]"===t?"mapiterator":"[object Set Iterator]"===t?"setiterator":"[object String Iterator]"===t?"stringiterator":"[object Array Iterator]"===t?"arrayiterator":"[object Int8Array]"===t?"int8array":"[object Uint8Array]"===t?"uint8array":"[object Uint8ClampedArray]"===t?"uint8clampedarray":"[object Int16Array]"===t?"int16array":"[object Uint16Array]"===t?"uint16array":"[object Int32Array]"===t?"int32array":"[object Uint32Array]"===t?"uint32array":"[object Float32Array]"===t?"float32array":"[object Float64Array]"===t?"float64array":"object"}},function(e,t,r){"use strict";var n=r(338),i={get:"function",set:"function",configurable:"boolean",enumerable:"boolean"};function o(e,t){return{}.hasOwnProperty.call(e,t)}e.exports=function(e,t){if("string"===typeof t)return"undefined"!==typeof Object.getOwnPropertyDescriptor(e,t);if("object"!==n(e))return!1;if(o(e,"value")||o(e,"writable"))return!1;if(!o(e,"get")||"function"!==typeof e.get)return!1;if(o(e,"set")&&"function"!==typeof e[r]&&"undefined"!==typeof e[r])return!1;for(var r in e)if(i.hasOwnProperty(r)&&n(e[r])!==i[r]&&"undefined"!==typeof e[r])return!1;return!0}},function(e,t,r){var n=r(92),i=Object.prototype.toString;e.exports=function(e){if("undefined"===typeof e)return"undefined";if(null===e)return"null";if(!0===e||!1===e||e instanceof Boolean)return"boolean";if("string"===typeof e||e instanceof String)return"string";if("number"===typeof e||e instanceof Number)return"number";if("function"===typeof e||e instanceof Function)return"function";if("undefined"!==typeof Array.isArray&&Array.isArray(e))return"array";if(e instanceof RegExp)return"regexp";if(e instanceof Date)return"date";var t=i.call(e);return"[object RegExp]"===t?"regexp":"[object Date]"===t?"date":"[object Arguments]"===t?"arguments":"[object Error]"===t?"error":n(e)?"buffer":"[object Set]"===t?"set":"[object WeakSet]"===t?"weakset":"[object Map]"===t?"map":"[object WeakMap]"===t?"weakmap":"[object Symbol]"===t?"symbol":"[object Int8Array]"===t?"int8array":"[object Uint8Array]"===t?"uint8array":"[object Uint8ClampedArray]"===t?"uint8clampedarray":"[object Int16Array]"===t?"int16array":"[object Uint16Array]"===t?"uint16array":"[object Int32Array]"===t?"int32array":"[object Uint32Array]"===t?"uint32array":"[object Float32Array]"===t?"float32array":"[object Float64Array]"===t?"float64array":"object"}},function(e,t,r){"use strict";var n=r(340),i={configurable:"boolean",enumerable:"boolean",writable:"boolean"};e.exports=function(e,t){if("object"!==n(e))return!1;if("string"===typeof t)return"undefined"!==typeof Object.getOwnPropertyDescriptor(e,t);if(!("value"in e)&&!("writable"in e))return!1;for(var r in e)if("value"!==r&&i.hasOwnProperty(r)&&n(e[r])!==i[r]&&"undefined"!==typeof e[r])return!1;return!0}},function(e,t,r){var n=r(92),i=Object.prototype.toString;e.exports=function(e){if("undefined"===typeof e)return"undefined";if(null===e)return"null";if(!0===e||!1===e||e instanceof Boolean)return"boolean";if("string"===typeof e||e instanceof String)return"string";if("number"===typeof e||e instanceof Number)return"number";if("function"===typeof e||e instanceof Function)return"function";if("undefined"!==typeof Array.isArray&&Array.isArray(e))return"array";if(e instanceof RegExp)return"regexp";if(e instanceof Date)return"date";var t=i.call(e);return"[object RegExp]"===t?"regexp":"[object Date]"===t?"date":"[object Arguments]"===t?"arguments":"[object Error]"===t?"error":n(e)?"buffer":"[object Set]"===t?"set":"[object WeakSet]"===t?"weakset":"[object Map]"===t?"map":"[object WeakMap]"===t?"weakmap":"[object Symbol]"===t?"symbol":"[object Int8Array]"===t?"int8array":"[object Uint8Array]"===t?"uint8array":"[object Uint8ClampedArray]"===t?"uint8clampedarray":"[object Int16Array]"===t?"int16array":"[object Uint16Array]"===t?"uint16array":"[object Int32Array]"===t?"int32array":"[object Uint32Array]"===t?"uint32array":"[object Float32Array]"===t?"float32array":"[object Float64Array]"===t?"float64array":"object"}},function(e,t,r){"use strict";var n=r(342),i=r(55),o=r(59);e.exports=function e(t,r){if("function"!==typeof t)throw new TypeError("expected Parent to be a function.");return function(a,s){if("function"!==typeof a)throw new TypeError("expected Ctor to be a function.");if(o.inherits(a,t),n(a,t),"object"===typeof s){var l=Object.create(s);for(var u in l)a.prototype[u]=l[u]}i(a.prototype,"_parent_",{configurable:!0,set:function(){},get:function(){return t.prototype}}),"function"===typeof r&&r(a,t),a.extend=e(a,r)}}},function(e,t,r){"use strict";var n=r(108),i=r(343),o=r(55);function a(e){return"object"===n(e)||"function"===typeof e}function s(e,t){var r=(t=l(t)).length;if(a(e)){for(var n in e)if(t.indexOf(n)>-1)return!0;return s(u(e),t)}if(Array.isArray(e)){for(var i=e;r--;)if(i.indexOf(t[r])>-1)return!0;return!1}throw new TypeError("expected an array or object.")}function l(e){return e?Array.isArray(e)?e:[e]:[]}function u(e){return function(e){return a(e)&&"undefined"!==typeof e.constructor}(e)?Object.getOwnPropertyNames(e):[]}e.exports=function(e,t,r){if(!a(e))throw new TypeError("expected receiving object to be an object.");if(!a(t))throw new TypeError("expected providing object to be an object.");var n=u(t),c=Object.keys(t),h=n.length;for(r=l(r);h--;){var p=n[h];s(c,p)?o(e,p,t[p]):p in e||s(r,p)||i(e,t,p)}},e.exports.has=s},function(e,t,r){"use strict";function n(e){return"[object Object]"==={}.toString.call(e)}e.exports=function(e,t,r,i){if(n(t)||"function"===typeof t||(i=r,r=t,t=e),!n(e)&&"function"!==typeof e)throw new TypeError("expected the first argument to be an object");if(!n(t)&&"function"!==typeof t)throw new TypeError("expected provider to be an object");if("string"!==typeof i&&(i=r),"string"!==typeof r)throw new TypeError("expected key to be a string");if(!(r in t))throw new Error('property "'+r+'" does not exist');var o=Object.getOwnPropertyDescriptor(t,r);o&&Object.defineProperty(e,i,o)}},function(e,t,r){"use strict";(function(t){var n=r(179),i=r(55),o=r(134)("snapdragon:compiler"),a=r(111);function s(e,r){o("initializing",t),this.options=a.extend({source:"string"},e),this.state=r||{},this.compilers={},this.output="",this.set("eos",function(e){return this.emit(e.val,e)}),this.set("noop",function(e){return this.emit(e.val,e)}),this.set("bos",function(e){return this.emit(e.val,e)}),n(this)}s.prototype={error:function(e,t){var r=t.position||{start:{column:0}},n=this.options.source+" column:"+r.start.column+": "+e,i=new Error(n);if(i.reason=e,i.column=r.start.column,i.source=this.pattern,!this.options.silent)throw i;this.errors.push(i)},define:function(e,t){return i(this,e,t),this},emit:function(e,t){return this.output+=e,e},set:function(e,t){return this.compilers[e]=t,this},get:function(e){return this.compilers[e]},prev:function(e){return this.ast.nodes[this.idx-(e||1)]||{type:"bos",val:""}},next:function(e){return this.ast.nodes[this.idx+(e||1)]||{type:"eos",val:""}},visit:function(e,t,r){var n=this.compilers[e.type];if(this.idx=r,"function"!==typeof n)throw this.error('compiler "'+e.type+'" is not registered',e);return n.call(this,e,t,r)},mapVisit:function(e){if(!Array.isArray(e))throw new TypeError("expected an array");for(var t=e.length,r=-1;++r<t;)this.visit(e[r],e,r);return this},compile:function(e,t){var n=a.extend({},this.options,t);return this.ast=e,this.parsingErrors=this.ast.errors,this.output="",n.sourcemap?(r(358)(this),this.mapVisit(this.ast.nodes),this.applySourceMaps(),this.map="generator"===n.sourcemap?this.map:this.map.toJSON(),this):(this.mapVisit(this.ast.nodes),this)}},e.exports=s}).call(this,"/index.js")},function(e,t,r){var n;function i(e){function r(){if(r.enabled){var e=r,i=+new Date,o=i-(n||i);e.diff=o,e.prev=n,e.curr=i,n=i;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!==typeof a[0]&&a.unshift("%O");var l=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(r,n){if("%%"===r)return r;l++;var i=t.formatters[n];if("function"===typeof i){var o=a[l];r=i.call(e,o),a.splice(l,1),l--}return r}),t.formatArgs.call(e,a),(r.log||t.log||console.log.bind(console)).apply(e,a)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}(e),"function"===typeof t.init&&t.init(r),r}(t=e.exports=i.debug=i.default=i).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];for(var r=("string"===typeof e?e:"").split(/[\s,]+/),n=r.length,i=0;i<n;i++)r[i]&&("-"===(e=r[i].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(110),t.names=[],t.skips=[],t.formatters={}},function(e,t,r){t.SourceMapGenerator=r(180).SourceMapGenerator,t.SourceMapConsumer=r(349).SourceMapConsumer,t.SourceNode=r(352).SourceNode},function(e,t){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");t.encode=function(e){if(0<=e&&e<r.length)return r[e];throw new TypeError("Must be between 0 and 63: "+e)},t.decode=function(e){return 65<=e&&e<=90?e-65:97<=e&&e<=122?e-97+26:48<=e&&e<=57?e-48+52:43==e?62:47==e?63:-1}},function(e,t,r){var n=r(97);function i(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}i.prototype.unsortedForEach=function(e,t){this._array.forEach(e,t)},i.prototype.add=function(e){!function(e,t){var r=e.generatedLine,i=t.generatedLine,o=e.generatedColumn,a=t.generatedColumn;return i>r||i==r&&a>=o||n.compareByGeneratedPositionsInflated(e,t)<=0}(this._last,e)?(this._sorted=!1,this._array.push(e)):(this._last=e,this._array.push(e))},i.prototype.toArray=function(){return this._sorted||(this._array.sort(n.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},t.MappingList=i},function(e,t,r){var n=r(97),i=r(350),o=r(182).ArraySet,a=r(181),s=r(351).quickSort;function l(e){var t=e;return"string"===typeof e&&(t=JSON.parse(e.replace(/^\)\]\}'/,""))),null!=t.sections?new h(t):new u(t)}function u(e){var t=e;"string"===typeof e&&(t=JSON.parse(e.replace(/^\)\]\}'/,"")));var r=n.getArg(t,"version"),i=n.getArg(t,"sources"),a=n.getArg(t,"names",[]),s=n.getArg(t,"sourceRoot",null),l=n.getArg(t,"sourcesContent",null),u=n.getArg(t,"mappings"),c=n.getArg(t,"file",null);if(r!=this._version)throw new Error("Unsupported version: "+r);i=i.map(String).map(n.normalize).map(function(e){return s&&n.isAbsolute(s)&&n.isAbsolute(e)?n.relative(s,e):e}),this._names=o.fromArray(a.map(String),!0),this._sources=o.fromArray(i,!0),this.sourceRoot=s,this.sourcesContent=l,this._mappings=u,this.file=c}function c(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}function h(e){var t=e;"string"===typeof e&&(t=JSON.parse(e.replace(/^\)\]\}'/,"")));var r=n.getArg(t,"version"),i=n.getArg(t,"sections");if(r!=this._version)throw new Error("Unsupported version: "+r);this._sources=new o,this._names=new o;var a={line:-1,column:0};this._sections=i.map(function(e){if(e.url)throw new Error("Support for url field in sections not implemented.");var t=n.getArg(e,"offset"),r=n.getArg(t,"line"),i=n.getArg(t,"column");if(r<a.line||r===a.line&&i<a.column)throw new Error("Section offsets must be ordered and non-overlapping.");return a=t,{generatedOffset:{generatedLine:r+1,generatedColumn:i+1},consumer:new l(n.getArg(e,"map"))}})}l.fromSourceMap=function(e){return u.fromSourceMap(e)},l.prototype._version=3,l.prototype.__generatedMappings=null,Object.defineProperty(l.prototype,"_generatedMappings",{get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),l.prototype.__originalMappings=null,Object.defineProperty(l.prototype,"_originalMappings",{get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),l.prototype._charIsMappingSeparator=function(e,t){var r=e.charAt(t);return";"===r||","===r},l.prototype._parseMappings=function(e,t){throw new Error("Subclasses must implement _parseMappings")},l.GENERATED_ORDER=1,l.ORIGINAL_ORDER=2,l.GREATEST_LOWER_BOUND=1,l.LEAST_UPPER_BOUND=2,l.prototype.eachMapping=function(e,t,r){var i,o=t||null;switch(r||l.GENERATED_ORDER){case l.GENERATED_ORDER:i=this._generatedMappings;break;case l.ORIGINAL_ORDER:i=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var a=this.sourceRoot;i.map(function(e){var t=null===e.source?null:this._sources.at(e.source);return null!=t&&null!=a&&(t=n.join(a,t)),{source:t,generatedLine:e.generatedLine,generatedColumn:e.generatedColumn,originalLine:e.originalLine,originalColumn:e.originalColumn,name:null===e.name?null:this._names.at(e.name)}},this).forEach(e,o)},l.prototype.allGeneratedPositionsFor=function(e){var t=n.getArg(e,"line"),r={source:n.getArg(e,"source"),originalLine:t,originalColumn:n.getArg(e,"column",0)};if(null!=this.sourceRoot&&(r.source=n.relative(this.sourceRoot,r.source)),!this._sources.has(r.source))return[];r.source=this._sources.indexOf(r.source);var o=[],a=this._findMapping(r,this._originalMappings,"originalLine","originalColumn",n.compareByOriginalPositions,i.LEAST_UPPER_BOUND);if(a>=0){var s=this._originalMappings[a];if(void 0===e.column)for(var l=s.originalLine;s&&s.originalLine===l;)o.push({line:n.getArg(s,"generatedLine",null),column:n.getArg(s,"generatedColumn",null),lastColumn:n.getArg(s,"lastGeneratedColumn",null)}),s=this._originalMappings[++a];else for(var u=s.originalColumn;s&&s.originalLine===t&&s.originalColumn==u;)o.push({line:n.getArg(s,"generatedLine",null),column:n.getArg(s,"generatedColumn",null),lastColumn:n.getArg(s,"lastGeneratedColumn",null)}),s=this._originalMappings[++a]}return o},t.SourceMapConsumer=l,u.prototype=Object.create(l.prototype),u.prototype.consumer=l,u.fromSourceMap=function(e){var t=Object.create(u.prototype),r=t._names=o.fromArray(e._names.toArray(),!0),i=t._sources=o.fromArray(e._sources.toArray(),!0);t.sourceRoot=e._sourceRoot,t.sourcesContent=e._generateSourcesContent(t._sources.toArray(),t.sourceRoot),t.file=e._file;for(var a=e._mappings.toArray().slice(),l=t.__generatedMappings=[],h=t.__originalMappings=[],p=0,f=a.length;p<f;p++){var d=a[p],m=new c;m.generatedLine=d.generatedLine,m.generatedColumn=d.generatedColumn,d.source&&(m.source=i.indexOf(d.source),m.originalLine=d.originalLine,m.originalColumn=d.originalColumn,d.name&&(m.name=r.indexOf(d.name)),h.push(m)),l.push(m)}return s(t.__originalMappings,n.compareByOriginalPositions),t},u.prototype._version=3,Object.defineProperty(u.prototype,"sources",{get:function(){return this._sources.toArray().map(function(e){return null!=this.sourceRoot?n.join(this.sourceRoot,e):e},this)}}),u.prototype._parseMappings=function(e,t){for(var r,i,o,l,u,h=1,p=0,f=0,d=0,m=0,v=0,g=e.length,y=0,b={},x={},w=[],S=[];y<g;)if(";"===e.charAt(y))h++,y++,p=0;else if(","===e.charAt(y))y++;else{for((r=new c).generatedLine=h,l=y;l<g&&!this._charIsMappingSeparator(e,l);l++);if(o=b[i=e.slice(y,l)])y+=i.length;else{for(o=[];y<l;)a.decode(e,y,x),u=x.value,y=x.rest,o.push(u);if(2===o.length)throw new Error("Found a source, but no line and column");if(3===o.length)throw new Error("Found a source and line, but no column");b[i]=o}r.generatedColumn=p+o[0],p=r.generatedColumn,o.length>1&&(r.source=m+o[1],m+=o[1],r.originalLine=f+o[2],f=r.originalLine,r.originalLine+=1,r.originalColumn=d+o[3],d=r.originalColumn,o.length>4&&(r.name=v+o[4],v+=o[4])),S.push(r),"number"===typeof r.originalLine&&w.push(r)}s(S,n.compareByGeneratedPositionsDeflated),this.__generatedMappings=S,s(w,n.compareByOriginalPositions),this.__originalMappings=w},u.prototype._findMapping=function(e,t,r,n,o,a){if(e[r]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[r]);if(e[n]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[n]);return i.search(e,t,o,a)},u.prototype.computeColumnSpans=function(){for(var e=0;e<this._generatedMappings.length;++e){var t=this._generatedMappings[e];if(e+1<this._generatedMappings.length){var r=this._generatedMappings[e+1];if(t.generatedLine===r.generatedLine){t.lastGeneratedColumn=r.generatedColumn-1;continue}}t.lastGeneratedColumn=1/0}},u.prototype.originalPositionFor=function(e){var t={generatedLine:n.getArg(e,"line"),generatedColumn:n.getArg(e,"column")},r=this._findMapping(t,this._generatedMappings,"generatedLine","generatedColumn",n.compareByGeneratedPositionsDeflated,n.getArg(e,"bias",l.GREATEST_LOWER_BOUND));if(r>=0){var i=this._generatedMappings[r];if(i.generatedLine===t.generatedLine){var o=n.getArg(i,"source",null);null!==o&&(o=this._sources.at(o),null!=this.sourceRoot&&(o=n.join(this.sourceRoot,o)));var a=n.getArg(i,"name",null);return null!==a&&(a=this._names.at(a)),{source:o,line:n.getArg(i,"originalLine",null),column:n.getArg(i,"originalColumn",null),name:a}}}return{source:null,line:null,column:null,name:null}},u.prototype.hasContentsOfAllSources=function(){return!!this.sourcesContent&&(this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(e){return null==e}))},u.prototype.sourceContentFor=function(e,t){if(!this.sourcesContent)return null;if(null!=this.sourceRoot&&(e=n.relative(this.sourceRoot,e)),this._sources.has(e))return this.sourcesContent[this._sources.indexOf(e)];var r;if(null!=this.sourceRoot&&(r=n.urlParse(this.sourceRoot))){var i=e.replace(/^file:\/\//,"");if("file"==r.scheme&&this._sources.has(i))return this.sourcesContent[this._sources.indexOf(i)];if((!r.path||"/"==r.path)&&this._sources.has("/"+e))return this.sourcesContent[this._sources.indexOf("/"+e)]}if(t)return null;throw new Error('"'+e+'" is not in the SourceMap.')},u.prototype.generatedPositionFor=function(e){var t=n.getArg(e,"source");if(null!=this.sourceRoot&&(t=n.relative(this.sourceRoot,t)),!this._sources.has(t))return{line:null,column:null,lastColumn:null};var r={source:t=this._sources.indexOf(t),originalLine:n.getArg(e,"line"),originalColumn:n.getArg(e,"column")},i=this._findMapping(r,this._originalMappings,"originalLine","originalColumn",n.compareByOriginalPositions,n.getArg(e,"bias",l.GREATEST_LOWER_BOUND));if(i>=0){var o=this._originalMappings[i];if(o.source===r.source)return{line:n.getArg(o,"generatedLine",null),column:n.getArg(o,"generatedColumn",null),lastColumn:n.getArg(o,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},t.BasicSourceMapConsumer=u,h.prototype=Object.create(l.prototype),h.prototype.constructor=l,h.prototype._version=3,Object.defineProperty(h.prototype,"sources",{get:function(){for(var e=[],t=0;t<this._sections.length;t++)for(var r=0;r<this._sections[t].consumer.sources.length;r++)e.push(this._sections[t].consumer.sources[r]);return e}}),h.prototype.originalPositionFor=function(e){var t={generatedLine:n.getArg(e,"line"),generatedColumn:n.getArg(e,"column")},r=i.search(t,this._sections,function(e,t){var r=e.generatedLine-t.generatedOffset.generatedLine;return r||e.generatedColumn-t.generatedOffset.generatedColumn}),o=this._sections[r];return o?o.consumer.originalPositionFor({line:t.generatedLine-(o.generatedOffset.generatedLine-1),column:t.generatedColumn-(o.generatedOffset.generatedLine===t.generatedLine?o.generatedOffset.generatedColumn-1:0),bias:e.bias}):{source:null,line:null,column:null,name:null}},h.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(e){return e.consumer.hasContentsOfAllSources()})},h.prototype.sourceContentFor=function(e,t){for(var r=0;r<this._sections.length;r++){var n=this._sections[r].consumer.sourceContentFor(e,!0);if(n)return n}if(t)return null;throw new Error('"'+e+'" is not in the SourceMap.')},h.prototype.generatedPositionFor=function(e){for(var t=0;t<this._sections.length;t++){var r=this._sections[t];if(-1!==r.consumer.sources.indexOf(n.getArg(e,"source"))){var i=r.consumer.generatedPositionFor(e);if(i)return{line:i.line+(r.generatedOffset.generatedLine-1),column:i.column+(r.generatedOffset.generatedLine===i.line?r.generatedOffset.generatedColumn-1:0)}}}return{line:null,column:null}},h.prototype._parseMappings=function(e,t){this.__generatedMappings=[],this.__originalMappings=[];for(var r=0;r<this._sections.length;r++)for(var i=this._sections[r],o=i.consumer._generatedMappings,a=0;a<o.length;a++){var l=o[a],u=i.consumer._sources.at(l.source);null!==i.consumer.sourceRoot&&(u=n.join(i.consumer.sourceRoot,u)),this._sources.add(u),u=this._sources.indexOf(u);var c=i.consumer._names.at(l.name);this._names.add(c),c=this._names.indexOf(c);var h={source:u,generatedLine:l.generatedLine+(i.generatedOffset.generatedLine-1),generatedColumn:l.generatedColumn+(i.generatedOffset.generatedLine===l.generatedLine?i.generatedOffset.generatedColumn-1:0),originalLine:l.originalLine,originalColumn:l.originalColumn,name:c};this.__generatedMappings.push(h),"number"===typeof h.originalLine&&this.__originalMappings.push(h)}s(this.__generatedMappings,n.compareByGeneratedPositionsDeflated),s(this.__originalMappings,n.compareByOriginalPositions)},t.IndexedSourceMapConsumer=h},function(e,t){t.GREATEST_LOWER_BOUND=1,t.LEAST_UPPER_BOUND=2,t.search=function(e,r,n,i){if(0===r.length)return-1;var o=function e(r,n,i,o,a,s){var l=Math.floor((n-r)/2)+r,u=a(i,o[l],!0);return 0===u?l:u>0?n-l>1?e(l,n,i,o,a,s):s==t.LEAST_UPPER_BOUND?n<o.length?n:-1:l:l-r>1?e(r,l,i,o,a,s):s==t.LEAST_UPPER_BOUND?l:r<0?-1:r}(-1,r.length,e,r,n,i||t.GREATEST_LOWER_BOUND);if(o<0)return-1;for(;o-1>=0&&0===n(r[o],r[o-1],!0);)--o;return o}},function(e,t){function r(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function n(e,t,i,o){if(i<o){var a=i-1;r(e,(c=i,h=o,Math.round(c+Math.random()*(h-c))),o);for(var s=e[o],l=i;l<o;l++)t(e[l],s)<=0&&r(e,a+=1,l);r(e,a+1,l);var u=a+1;n(e,t,i,u-1),n(e,t,u+1,o)}var c,h}t.quickSort=function(e,t){n(e,t,0,e.length-1)}},function(e,t,r){var n=r(180).SourceMapGenerator,i=r(97),o=/(\r?\n)/,a="$$$isSourceNode$$$";function s(e,t,r,n,i){this.children=[],this.sourceContents={},this.line=null==e?null:e,this.column=null==t?null:t,this.source=null==r?null:r,this.name=null==i?null:i,this[a]=!0,null!=n&&this.add(n)}s.fromStringWithSourceMap=function(e,t,r){var n=new s,a=e.split(o),l=0,u=function(){return e()+(e()||"");function e(){return l<a.length?a[l++]:void 0}},c=1,h=0,p=null;return t.eachMapping(function(e){if(null!==p){if(!(c<e.generatedLine)){var t=(r=a[l]).substr(0,e.generatedColumn-h);return a[l]=r.substr(e.generatedColumn-h),h=e.generatedColumn,f(p,t),void(p=e)}f(p,u()),c++,h=0}for(;c<e.generatedLine;)n.add(u()),c++;if(h<e.generatedColumn){var r=a[l];n.add(r.substr(0,e.generatedColumn)),a[l]=r.substr(e.generatedColumn),h=e.generatedColumn}p=e},this),l<a.length&&(p&&f(p,u()),n.add(a.splice(l).join(""))),t.sources.forEach(function(e){var o=t.sourceContentFor(e);null!=o&&(null!=r&&(e=i.join(r,e)),n.setSourceContent(e,o))}),n;function f(e,t){if(null===e||void 0===e.source)n.add(t);else{var o=r?i.join(r,e.source):e.source;n.add(new s(e.originalLine,e.originalColumn,o,t,e.name))}}},s.prototype.add=function(e){if(Array.isArray(e))e.forEach(function(e){this.add(e)},this);else{if(!e[a]&&"string"!==typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);e&&this.children.push(e)}return this},s.prototype.prepend=function(e){if(Array.isArray(e))for(var t=e.length-1;t>=0;t--)this.prepend(e[t]);else{if(!e[a]&&"string"!==typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);this.children.unshift(e)}return this},s.prototype.walk=function(e){for(var t,r=0,n=this.children.length;r<n;r++)(t=this.children[r])[a]?t.walk(e):""!==t&&e(t,{source:this.source,line:this.line,column:this.column,name:this.name})},s.prototype.join=function(e){var t,r,n=this.children.length;if(n>0){for(t=[],r=0;r<n-1;r++)t.push(this.children[r]),t.push(e);t.push(this.children[r]),this.children=t}return this},s.prototype.replaceRight=function(e,t){var r=this.children[this.children.length-1];return r[a]?r.replaceRight(e,t):"string"===typeof r?this.children[this.children.length-1]=r.replace(e,t):this.children.push("".replace(e,t)),this},s.prototype.setSourceContent=function(e,t){this.sourceContents[i.toSetString(e)]=t},s.prototype.walkSourceContents=function(e){for(var t=0,r=this.children.length;t<r;t++)this.children[t][a]&&this.children[t].walkSourceContents(e);var n=Object.keys(this.sourceContents);for(t=0,r=n.length;t<r;t++)e(i.fromSetString(n[t]),this.sourceContents[n[t]])},s.prototype.toString=function(){var e="";return this.walk(function(t){e+=t}),e},s.prototype.toStringWithSourceMap=function(e){var t={code:"",line:1,column:0},r=new n(e),i=!1,o=null,a=null,s=null,l=null;return this.walk(function(e,n){t.code+=e,null!==n.source&&null!==n.line&&null!==n.column?(o===n.source&&a===n.line&&s===n.column&&l===n.name||r.addMapping({source:n.source,original:{line:n.line,column:n.column},generated:{line:t.line,column:t.column},name:n.name}),o=n.source,a=n.line,s=n.column,l=n.name,i=!0):i&&(r.addMapping({generated:{line:t.line,column:t.column}}),o=null,i=!1);for(var u=0,c=e.length;u<c;u++)10===e.charCodeAt(u)?(t.line++,t.column=0,u+1===c?(o=null,i=!1):i&&r.addMapping({source:n.source,original:{line:n.line,column:n.column},generated:{line:t.line,column:t.column},name:n.name})):t.column++}),this.walkSourceContents(function(e,t){r.setSourceContent(e,t)}),{code:t.code,map:r}},t.SourceNode=s},function(e,t,r){(function(n){var i,o,a;o=[r(356),r(357)],void 0===(a="function"===typeof(i=function(e,t){function r(e,t,r){n(function(){e(t,r)})}function i(e,t){try{return JSON.parse(e.replace(/^\)\]\}'/,""))}catch(r){throw r.sourceMapData=t,r}}function o(e,t,r){var n=t;try{return String(e(n))}catch(i){throw i.sourceMapData=r,i}}function a(e,t,n,o){var a;try{a=c(e,t)}catch(l){return r(o,l)}if(!a||a.map)return r(o,null,a);var s=a.url;n(s,function(e,t){if(e)return e.sourceMapData=a,o(e);a.map=String(t);try{a.map=i(a.map,a)}catch(e){return o(e)}o(null,a)})}function s(e,t,r){var n=c(e,t);return!n||n.map?n:(n.map=o(r,n.url,n),n.map=i(n.map,n),n)}var l=/^data:([^,;]*)(;[^,;]*)*(?:,(.*))?$/,u=/^(?:application|text)\/json$/;function c(r,n){var o=e.getFrom(r);if(!o)return null;var a=o.match(l);if(a){var s=a[1],c=a[2]||"",h=a[3]||"",p={sourceMappingURL:o,url:null,sourcesRelativeTo:n,map:h};if(!u.test(s)){var f=new Error("Unuseful data uri mime type: "+(s||"text/plain"));throw f.sourceMapData=p,f}return p.map=i(";base64"===c?atob(h):decodeURIComponent(h),p),p}var d=t(n,o);return{sourceMappingURL:o,url:d,sourcesRelativeTo:d,map:null}}function h(e,t,n,i,o){"function"===typeof i&&(o=i,i={});var a=e.sources?e.sources.length:0,s={sourcesResolved:[],sourcesContent:[]};if(0!==a){var l=function(){0===--a&&o(null,s)};d(e,t,i,function(e,t,i){if(s.sourcesResolved[i]=e,"string"===typeof t)s.sourcesContent[i]=t,r(l,null);else{var o=e;n(o,function(e,t){s.sourcesContent[i]=e||String(t),l()})}})}else r(o,null,s)}function p(e,t,r,n){var i={sourcesResolved:[],sourcesContent:[]};return e.sources&&0!==e.sources.length?(d(e,t,n,function(e,t,n){if(i.sourcesResolved[n]=e,null!==r)if("string"===typeof t)i.sourcesContent[n]=t;else{var o=e;try{i.sourcesContent[n]=String(r(o))}catch(a){i.sourcesContent[n]=a}}}),i):i}var f=/\/?$/;function d(e,r,n,i){var o,a,s;n=n||{};for(var l=0,u=e.sources.length;l<u;l++)s=null,"string"===typeof n.sourceRoot?s=n.sourceRoot:"string"===typeof e.sourceRoot&&!1!==n.sourceRoot&&(s=e.sourceRoot),o=null===s||""===s?t(r,e.sources[l]):t(r,s.replace(f,"/"),e.sources[l]),a=(e.sourcesContent||[])[l],i(o,a,l)}return{resolveSourceMap:a,resolveSourceMapSync:s,resolveSources:h,resolveSourcesSync:p,resolve:function(e,t,r,n,o){if("function"===typeof n&&(o=n,n={}),null===e){var s=t,l={sourceMappingURL:null,url:s,sourcesRelativeTo:s,map:null},u=s;r(u,function(e,t){if(e)return e.sourceMapData=l,o(e);l.map=String(t);try{l.map=i(l.map,l)}catch(e){return o(e)}c(l)})}else a(e,t,r,function(e,t){return e?o(e):t?void c(t):o(null,null)});function c(e){h(e.map,e.sourcesRelativeTo,r,n,function(t,r){if(t)return o(t);e.sourcesResolved=r.sourcesResolved,e.sourcesContent=r.sourcesContent,o(null,e)})}},resolveSync:function(e,t,r,n){var a;if(null===e){var l=t;(a={sourceMappingURL:null,url:l,sourcesRelativeTo:l,map:null}).map=o(r,l,a),a.map=i(a.map,a)}else if(!(a=s(e,t,r)))return null;var u=p(a.map,a.sourcesRelativeTo,r,n);return a.sourcesResolved=u.sourcesResolved,a.sourcesContent=u.sourcesContent,a},parseMapToJSON:i}})?i.apply(t,o):i)||(e.exports=a)}).call(this,r(354).setImmediate)},function(e,t,r){(function(e){var n="undefined"!==typeof e&&e||"undefined"!==typeof self&&self||window,i=Function.prototype.apply;function o(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new o(i.call(setTimeout,n,arguments),clearTimeout)},t.setInterval=function(){return new o(i.call(setInterval,n,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(n,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},r(355),t.setImmediate="undefined"!==typeof self&&self.setImmediate||"undefined"!==typeof e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!==typeof self&&self.clearImmediate||"undefined"!==typeof e&&e.clearImmediate||this&&this.clearImmediate}).call(this,r(72))},function(e,t,r){(function(e,t){!function(e,r){"use strict";if(!e.setImmediate){var n,i=1,o={},a=!1,s=e.document,l=Object.getPrototypeOf&&Object.getPrototypeOf(e);l=l&&l.setTimeout?l:e,"[object process]"==={}.toString.call(e.process)?n=function(e){t.nextTick(function(){c(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?function(){var t="setImmediate$"+Math.random()+"$",r=function(r){r.source===e&&"string"===typeof r.data&&0===r.data.indexOf(t)&&c(+r.data.slice(t.length))};e.addEventListener?e.addEventListener("message",r,!1):e.attachEvent("onmessage",r),n=function(r){e.postMessage(t+r,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){c(e.data)},n=function(t){e.port2.postMessage(t)}}():s&&"onreadystatechange"in s.createElement("script")?function(){var e=s.documentElement;n=function(t){var r=s.createElement("script");r.onreadystatechange=function(){c(t),r.onreadystatechange=null,e.removeChild(r),r=null},e.appendChild(r)}}():n=function(e){setTimeout(c,0,e)},l.setImmediate=function(e){"function"!==typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var a={callback:e,args:t};return o[i]=a,n(i),i++},l.clearImmediate=u}function u(e){delete o[e]}function c(e){if(a)setTimeout(c,0,e);else{var t=o[e];if(t){a=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(r,n)}}(t)}finally{u(e),a=!1}}}}}("undefined"===typeof self?"undefined"===typeof e?this:e:self)}).call(this,r(72),r(48))},function(e,t,r){var n,i;void 0===(i="function"===typeof(n=function(){var e=/[#@] sourceMappingURL=([^\s'"]*)/,t=RegExp("(?:/\\*(?:\\s*\r?\n(?://)?)?(?:"+e.source+")\\s*\\*/|//(?:"+e.source+"))\\s*");return{regex:t,_innerRegex:e,getFrom:function(e){var r=e.match(t);return r?r[1]||r[2]||"":null},existsIn:function(e){return t.test(e)},removeFrom:function(e){return e.replace(t,"")},insertBefore:function(e,r){var n=e.match(t);return n?e.slice(0,n.index)+r+e.slice(n.index):e+r}}})?n.call(t,r,t,e):n)||(e.exports=i)},function(e,t,r){var n,i;void 0===(i="function"===typeof(n=function(){return function(){var e=arguments.length;if(0===e)throw new Error("resolveUrl requires at least one argument; got none.");var t=document.createElement("base");if(t.href=arguments[0],1===e)return t.href;var r=document.getElementsByTagName("head")[0];r.insertBefore(t,r.firstChild);for(var n,i=document.createElement("a"),o=1;o<e;o++)i.href=arguments[o],n=i.href,t.href=n;return r.removeChild(t),n}})?n.call(t,r,t,e):n)||(e.exports=i)},function(e,t,r){"use strict";var n=r(359),i=r(135),o=r(55),a=r(111);e.exports=function(e){for(var r in o(e,"_comment",e.comment),e.map=new a.SourceMap.SourceMapGenerator,e.position={line:1,column:1},e.content={},e.files={},t)o(e,r,t[r])},t.updatePosition=function(e){var t=e.match(/\n/g);t&&(this.position.line+=t.length);var r=e.lastIndexOf("\n");this.position.column=~r?e.length-r:this.position.column+e.length},t.emit=function(e,t){var r=t.position||{},n=r.source;return n&&(r.filepath&&(n=a.unixify(r.filepath)),this.map.addMapping({source:n,generated:{line:this.position.line,column:Math.max(this.position.column-1,0)},original:{line:r.start.line,column:r.start.column-1}}),r.content&&this.addContent(n,r),r.filepath&&this.addFile(n,r),this.updatePosition(e),this.output+=e),e},t.addFile=function(e,t){"string"===typeof t.content&&(Object.prototype.hasOwnProperty.call(this.files,e)||(this.files[e]=t.content))},t.addContent=function(e,t){"string"===typeof t.content&&(Object.prototype.hasOwnProperty.call(this.content,e)||this.map.setSourceContent(e,t.content))},t.applySourceMaps=function(){Object.keys(this.files).forEach(function(e){var t=this.files[e];if(this.map.setSourceContent(e,t),!0===this.options.inputSourcemaps){var r=a.sourceMapResolve.resolveSync(t,e,n.readFileSync);if(r){var o=new a.SourceMap.SourceMapConsumer(r.map),s=r.sourcesRelativeTo;this.map.applySourceMap(o,e,a.unixify(i.dirname(s)))}}},this)},t.comment=function(e){return/^# sourceMappingURL=/.test(e.comment)?this.emit("",e.position):this._comment(e)}},function(e,t){},function(e,t,r){"use strict";(function(t){var n=r(179),i=r(59),o=r(183),a=r(55),s=r(134)("snapdragon:parser"),l=r(361),u=r(111);function c(e){s("initializing",t),this.options=u.extend({source:"string"},e),this.init(this.options),n(this)}function h(e,t){return e.visited?e:(a(e,"visited",!0),e.nodes?function(e,t){var r=e.length,n=-1;for(;++n<r;)h(e[n],t)}(e.nodes,t):t(e))}function p(e){return function(e){return e.nodes&&e.nodes[0].type===e.type+".open"}(e)&&function(e){return e.nodes&&u.last(e.nodes).type===e.type+".close"}(e)}c.prototype={constructor:c,init:function(e){this.orig="",this.input="",this.parsed="",this.column=1,this.line=1,this.regex=new o,this.errors=this.errors||[],this.parsers=this.parsers||{},this.types=this.types||[],this.sets=this.sets||{},this.fns=this.fns||[],this.currentType="root";var t=this.position();this.bos=t({type:"bos",val:""}),this.ast={type:"root",errors:this.errors,nodes:[this.bos]},a(this.bos,"parent",this.ast),this.nodes=[this.ast],this.count=0,this.setCount=0,this.stack=[]},error:function(e,t){var r=t.position||{start:{column:0,line:0}},n=r.start.line,i=r.start.column,o=this.options.source,a=new Error(o+" <line:"+n+" column:"+i+">: "+e);if(a.source=o,a.reason=e,a.pos=r,!this.options.silent)throw a;this.errors.push(a)},define:function(e,t){return a(this,e,t),this},position:function(){var e={line:this.line,column:this.column},t=this;return function(r){return a(r,"position",new l(e,t)),r}},set:function(e,t){return-1===this.types.indexOf(e)&&this.types.push(e),this.parsers[e]=t.bind(this),this},get:function(e){return this.parsers[e]},push:function(e,t){return this.sets[e]=this.sets[e]||[],this.count++,this.stack.push(t),this.sets[e].push(t)},pop:function(e){return this.sets[e]=this.sets[e]||[],this.count--,this.stack.pop(),this.sets[e].pop()},isInside:function(e){return this.sets[e]=this.sets[e]||[],this.sets[e].length>0},isType:function(e,t){return e&&e.type===t},prev:function(e){return this.stack.length>0?u.last(this.stack,e):u.last(this.nodes,e)},consume:function(e){this.input=this.input.substr(e)},updatePosition:function(e,t){var r=e.match(/\n/g);r&&(this.line+=r.length);var n=e.lastIndexOf("\n");this.column=~n?t-n:this.column+t,this.parsed+=e,this.consume(t)},match:function(e){var t=e.exec(this.input);if(t)return this.updatePosition(t[0],t[0].length),t},capture:function(e,t){return"function"===typeof t?this.set.apply(this,arguments):(this.regex.set(e,t),this.set(e,function(){var r=this.parsed,n=this.position(),i=this.match(t);if(i&&i[0]){var o=this.prev(),s=n({type:e,val:i[0],parsed:r,rest:this.input});i[1]&&(s.inner=i[1]),a(s,"inside",this.stack.length>0),a(s,"parent",o),o.nodes.push(s)}}.bind(this)),this)},capturePair:function(e,t,r,n){return this.sets[e]=this.sets[e]||[],this.set(e+".open",function(){var r=this.parsed,i=this.position(),o=this.match(t);if(o&&o[0]){var s=o[0];this.setCount++,this.specialChars=!0;var l=i({type:e+".open",val:s,rest:this.input});"undefined"!==typeof o[1]&&(l.inner=o[1]);var u=this.prev(),c=i({type:e,nodes:[l]});a(c,"rest",this.input),a(c,"parsed",r),a(c,"prefix",o[1]),a(c,"parent",u),a(l,"parent",c),"function"===typeof n&&n.call(this,l,c),this.push(e,c),u.nodes.push(c)}}),this.set(e+".close",function(){var t=this.position(),n=this.match(r);if(n&&n[0]){var i=this.pop(e),o=t({type:e+".close",rest:this.input,suffix:n[1],val:n[0]});if(!this.isType(i,e)){if(this.options.strict)throw new Error('missing opening "'+e+'"');return this.setCount--,o.escaped=!0,o}"\\"===o.suffix&&(i.escaped=!0,o.escaped=!0),i.nodes.push(o),a(o,"parent",i)}}),this},eos:function(){var e=this.position();if(!this.input){for(var t=this.prev();"root"!==t.type&&!t.visited;){if(!0===this.options.strict)throw new SyntaxError("invalid syntax:"+i.inspect(t,null,2));p(t)||(t.parent.escaped=!0,t.escaped=!0),h(t,function(e){p(e.parent)||(e.parent.escaped=!0,e.escaped=!0)}),t=t.parent}var r=e({type:"eos",val:this.append||""});return a(r,"parent",this.ast),r}},next:function(){for(var e,t=this.parsed,r=this.types.length,n=-1;++n<r;)if(e=this.parsers[this.types[n]].call(this))return a(e,"rest",this.input),a(e,"parsed",t),this.last=e,e},parse:function(e){if("string"!==typeof e)throw new TypeError("expected a string");this.init(this.options),this.orig=e,this.input=e;var t=this;function r(){e=t.input;var r=t.next();if(r){var n=t.prev();n&&(a(r,"parent",n),n.nodes&&n.nodes.push(r)),t.sets.hasOwnProperty(n.type)&&(t.currentType=n.type)}if(t.input&&e===t.input)throw new Error('no parsers registered for: "'+t.input.slice(0,5)+'"')}for(;this.input;)r();if(this.stack.length&&this.options.strict){var n=this.stack.pop();throw this.error("missing opening "+n.type+': "'+this.orig+'"')}var i=this.eos();return"eos"!==this.prev().type&&this.ast.nodes.push(i),this.ast}},e.exports=c}).call(this,"/index.js")},function(e,t,r){"use strict";var n=r(55);e.exports=function(e,t){this.start=e,this.end={line:t.line,column:t.column},n(this,"content",t.orig),n(this,"source",t.options.source)}},function(e,t,r){"use strict";var n=r(61);e.exports=function(e){return n(e)||"function"===typeof e||Array.isArray(e)}},function(e,t,r){"use strict";var n=r(185),i=r(189);function o(e){function t(e,r){return e.nodes?function(e,r){var n=e.length,i=-1;for(;++i<n;)t(e[i],r)}(e.nodes,r):r(e)}e.set("paren",function(e){var r="";return t(e,function(e){e.val&&(r+=(/^\W/.test(e.val)?"\\":"")+e.val)}),this.emit(r,e)})}e.exports=function(e){var t=e.compiler.compilers,r=e.options;e.use(n.compilers);var a=t.escape,s=t.qmark,l=t.slash,u=t.star,c=t.text,h=t.plus,p=t.dot;!1===r.extglob||!0===r.noext?e.compiler.use(o):e.use(i.compilers),e.use(function(){this.options.star=this.options.star||function(){return"[^\\\\/]*?"}}),e.compiler.set("dot",p).set("escape",a).set("plus",h).set("slash",l).set("qmark",s).set("star",u).set("text",c)}},function(e,t,r){"use strict";var n=r(61);e.exports=function(e){return n(e)||"function"===typeof e||Array.isArray(e)}},function(e,t,r){"use strict";e.exports=function(e,t){function r(){return t&&"string"===typeof t.slash?t.slash:t&&"function"===typeof t.slash?t.slash.call(e):"\\\\/"}function n(){return t&&"string"===typeof t.star?t.star:t&&"function"===typeof t.star?t.star.call(e):"[^"+r()+"]*?"}var i=e.ast=e.parser.ast;i.state=e.parser.state,e.compiler.state=i.state,e.compiler.set("not",function(e){var t=this.prev();return!0===this.options.nonegate||"bos"!==t.type?this.emit("\\"+e.val,e):this.emit(e.val,e)}).set("escape",function(e){return this.options.unescape&&/^[-\w_.]/.test(e.val)?this.emit(e.val,e):this.emit("\\"+e.val,e)}).set("quoted",function(e){return this.emit(e.val,e)}).set("dollar",function(e){return"bracket"===e.parent.type?this.emit(e.val,e):this.emit("\\"+e.val,e)}).set("dot",function(e){return!0===e.dotfiles&&(this.dotfiles=!0),this.emit("\\"+e.val,e)}).set("backslash",function(e){return this.emit(e.val,e)}).set("slash",function(e,t,n){for(var i="["+r()+"]",o=e.parent,a=this.prev();"paren"===o.type&&!o.hasSlash;)o.hasSlash=!0,o=o.parent;return a.addQmark&&(i+="?"),"\\b"===e.rest.slice(0,2)?this.emit(i,e):"**"===e.parsed||"./**"===e.parsed?(this.output="(?:"+this.output,this.emit(i+")?",e)):"!**"===e.parsed&&!0!==this.options.nonegate?this.emit(i+"?\\b",e):this.emit(i,e)}).set("bracket",function(e){var t=e.close,r=e.escaped?"\\[":"[",n=e.negated,i=e.inner,o=e.val;return!0===e.escaped&&(i=i.replace(/\\?(\W)/g,"\\$1"),n=""),"]-"===i&&(i="\\]\\-"),n&&-1===i.indexOf(".")&&(i+="."),n&&-1===i.indexOf("/")&&(i+="/"),o=r+n+i+t,this.emit(o,e)}).set("square",function(e){var t=(/^\W/.test(e.val)?"\\":"")+e.val;return this.emit(t,e)}).set("qmark",function(e){var t=this.prev(),r="[^.\\\\/]";if((this.options.dot||"bos"!==t.type&&"slash"!==t.type)&&(r="[^\\\\/]"),"("===e.parsed.slice(-1)){var n=e.rest.charAt(0);if("!"===n||"="===n||":"===n)return this.emit(e.val,e)}return e.val.length>1&&(r+="{"+e.val.length+"}"),this.emit(r,e)}).set("plus",function(e){var t=e.parsed.slice(-1);if("]"===t||")"===t)return this.emit(e.val,e);if(!this.output||/[?*+]/.test(r)&&"bracket"!==e.parent.type)return this.emit("\\+",e);var r=this.output.slice(-1);return/\w/.test(r)&&!e.inside?this.emit("+\\+?",e):this.emit("+",e)}).set("globstar",function(e,t,i){this.output||(this.state.leadingGlobstar=!0);var o=this.prev(),a=this.prev(2),s=this.next(),l=this.next(2),u=o.type,c=e.val;"slash"===o.type&&"slash"===s.type&&"text"===a.type&&(this.output+="?","text"!==l.type&&(this.output+="\\b"));var h=e.parsed;"!"===h.charAt(0)&&(h=h.slice(1));var p=e.isInside.paren||e.isInside.brace;return c=h&&"slash"!==u&&"bos"!==u&&!p?n():!0!==this.options.dot?"(?:(?!(?:["+r()+"]|^)\\.).)*?":"(?:(?!(?:["+r()+"]|^)(?:\\.{1,2})($|["+r()+"]))(?!\\.{2}).)*?","slash"!==u&&"bos"!==u||!0===this.options.dot||(c="(?!\\.)"+c),"slash"===o.type&&"slash"===s.type&&"text"!==a.type&&("text"!==l.type&&"star"!==l.type||(e.addQmark=!0)),this.options.capture&&(c="("+c+")"),this.emit(c,e)}).set("star",function(e,t,i){var o=t[i-2]||{},a=this.prev(),s=this.next(),l=a.type;function u(e){return"bos"===e.type||"slash"===e.type}if(""===this.output&&!0!==this.options.contains&&(this.output="(?!["+r()+"])"),"bracket"===l&&!1===this.options.bash){var c=s&&"bracket"===s.type?n():"*?";if(!a.nodes||"posix"!==a.nodes[1].type)return this.emit(c,e)}var h=this.dotfiles||"text"===l||"escape"===l?"":this.options.dot?"(?!(?:^|["+r()+"])\\.{1,2}(?:$|["+r()+"]))":"(?!\\.)";u(a)||u(o)&&"not"===l?h+="(?!\\.)"!==h?"(?!(\\.{2}|\\.["+r()+"]))(?=.)":"(?=.)":"(?!\\.)"===h&&(h=""),"not"===a.type&&"bos"===o.type&&!0===this.options.dot&&(this.output="(?!\\.)"+this.output);var p=h+n();return this.options.capture&&(p="("+p+")"),this.emit(p,e)}).set("text",function(e){return this.emit(e.val,e)}).set("eos",function(e){var t=this.prev(),n=e.val;return this.output="(?:\\.["+r()+"](?=.))?"+this.output,this.state.metachar&&"qmark"!==t.type&&"slash"!==t.type&&(n+=this.options.contains?"["+r()+"]?":"(?:["+r()+"]|$)"),this.emit(n,e)}),t&&"function"===typeof t.compilers&&t.compilers(e.compiler)}},function(e,t,r){"use strict";var n,i=r(94),o=r(60),a=function(e){if(n)return n;var t={contains:!0,strictClose:!1},r=i.create(e,t),a=o("^(?:[*]\\((?=.)|"+r+")",t);return n=a}("[\\[!*+?$^\"'.\\\\/]+");e.exports=function(e,t){var r=e.parser,n=r.options;r.state={slashes:0,paths:[]},r.ast.state=r.state,r.capture("prefix",function(){this.parsed||this.match(/^\.[\\\/]/)&&(this.state.strictOpen=!!this.options.strictOpen,this.state.addPrefix=!0)}).capture("escape",function(){if(!this.isInside("bracket")){var e=this.position(),t=this.match(/^(?:\\(.)|([$^]))/);if(t)return e({type:"escape",val:t[2]||t[1]})}}).capture("quoted",function(){var e=this.position(),t=this.match(/^["']/);if(t){var r=t[0];if(-1===this.input.indexOf(r))return e({type:"escape",val:r});var n=function(e,t){var r=e.charAt(0),n={len:1,val:"",esc:""},i=0;function o(){"\\"!==r&&(n.esc+="\\"+r,n.val+=r),r=e.charAt(++i),n.len++,"\\"===r&&(o(),o())}for(;r&&r!==t;)o();return n}(this.input,r);return this.consume(n.len),e({type:"quoted",val:n.esc})}}).capture("not",function(){var e=this.parsed,t=this.position(),r=this.match(this.notRegex||/^!+/);if(r){var n=r[0],i=n.length%2===1;return""!==e||i||(n=""),""===e&&i&&!0!==this.options.nonegate&&(this.bos.val="(?!^(?:",this.append=")$).*",n=""),t({type:"not",val:n})}}).capture("dot",function(){var e=this.parsed,t=this.position(),r=this.match(/^\.+/);if(r){var n=r[0];return this.state.dot="."===n&&(""===e||"/"===e.slice(-1)),t({type:"dot",dotfiles:this.state.dot,val:n})}}).capture("plus",/^\+(?!\()/).capture("qmark",function(){var e=this.parsed,t=this.position(),r=this.match(/^\?+(?!\()/);if(r)return this.state.metachar=!0,this.state.qmark=!0,t({type:"qmark",parsed:e,val:r[0]})}).capture("globstar",function(){var e=this.parsed,t=this.position();if(this.match(/^\*{2}(?![*(])(?=[,)\/]|$)/)){var r=!0!==n.noglobstar?"globstar":"star",i=t({type:r,parsed:e});for(this.state.metachar=!0;"/**/"===this.input.slice(0,4);)this.input=this.input.slice(3);return i.isInside={brace:this.isInside("brace"),paren:this.isInside("paren")},"globstar"===r?(this.state.globstar=!0,i.val="**"):(this.state.star=!0,i.val="*"),i}}).capture("star",function(){var e=this.position(),t=this.match(/^(?:\*(?![*(])|[*]{3,}(?!\()|[*]{2}(?![(\/]|$)|\*(?=\*\())/);if(t)return this.state.metachar=!0,this.state.star=!0,e({type:"star",val:t[0]})}).capture("slash",function(){var e=this.position(),t=this.match(/^\//);if(t)return this.state.slashes++,e({type:"slash",val:t[0]})}).capture("backslash",function(){var e=this.position(),t=this.match(/^\\(?![*+?(){}[\]'"])/);if(t){var r=t[0];return this.isInside("bracket")?r="\\":r.length>1&&(r="\\\\"),e({type:"backslash",val:r})}}).capture("square",function(){if(!this.isInside("bracket")){var e=this.position(),t=this.match(/^\[([^!^\\])\]/);if(t)return e({type:"square",val:t[1]})}}).capture("bracket",function(){var e=this.position(),t=this.match(/^(?:\[([!^]?)([^\]]+|\]-)(\]|[^*+?]+)|\[)/);if(t){var r=t[0],n=t[1]?"^":"",i=(t[2]||"").replace(/\\\\+/,"\\\\"),o=t[3]||"";t[2]&&i.length<t[2].length&&(r=r.replace(/\\\\+/,"\\\\"));var a=this.input.slice(0,2);if(""===i&&"\\]"===a){i+=a,this.consume(2);for(var s,l=this.input,u=-1;s=l[++u];){if(this.consume(1),"]"===s){o=s;break}i+=s}}return e({type:"bracket",val:r,escaped:"]"!==o,negated:n,inner:i,close:o})}}).capture("text",function(){if(!this.isInside("bracket")){var e=this.position(),t=this.match(a);if(t&&t[0])return e({type:"text",val:t[0]})}}),t&&"function"===typeof t.parsers&&t.parsers(e.parser)},e.exports.not="[\\[!*+?$^\"'.\\\\/]+"},function(e,t,r){e.exports=new(r(136))},function(e,t,r){"use strict";var n=e.exports,i=r(135),o=r(369)(),a=r(96);n.define=r(370),n.diff=r(187),n.extend=r(186),n.pick=r(188),n.typeOf=r(371),n.unique=r(95),n.isEmptyString=function(e){return""===String(e)||"./"===String(e)},n.isWindows=function(){return"\\"===i.sep||!0===o},n.last=function(e,t){return e[e.length-(t||1)]},n.instantiate=function(e,t){var r;return r="object"===n.typeOf(e)&&e.snapdragon?e.snapdragon:"object"===n.typeOf(t)&&t.snapdragon?t.snapdragon:new a(t),n.define(r,"parse",function(e,t){var r=a.prototype.parse.call(this,e,t);r.input=e;var i=this.parser.stack.pop();if(i&&!0!==this.options.strictErrors){var o=i.nodes[0],s=i.nodes[1];if("bracket"===i.type)"["===s.val.charAt(0)&&(s.val="\\"+s.val);else{o.val="\\"+o.val;var l=o.parent.nodes[1];"star"===l.type&&(l.loose=!0)}}return n.define(r,"parser",this.parser),r}),r},n.createKey=function(e,t){if("undefined"===typeof t)return e;var r=e;for(var n in t)t.hasOwnProperty(n)&&(r+=";"+n+"="+String(t[n]));return r},n.arrayify=function(e){return"string"===typeof e?[e]:e?Array.isArray(e)?e:[e]:[]},n.isString=function(e){return"string"===typeof e},n.isRegex=function(e){return"regexp"===n.typeOf(e)},n.isObject=function(e){return"object"===n.typeOf(e)},n.escapeRegex=function(e){return e.replace(/[-[\]{}()^$|*+?.\\\/\s]/g,"\\$&")},n.combineDupes=function(e,t){var r=(t=(t=n.arrayify(t).join("|").split("|")).map(function(e){return e.replace(/\\?([+*\\\/])/g,"\\$1")})).join("|"),i=new RegExp("("+r+")(?=\\1)","g");return e.replace(i,"")},n.hasSpecialChars=function(e){return/(?:(?:(^|\/)[!.])|[*?+()|[\]{}]|[+@]\()/.test(e)},n.toPosixPath=function(e){return e.replace(/\\+/g,"/")},n.unescape=function(e){return n.toPosixPath(e.replace(/\\(?=[*+?!.])/g,""))},n.stripDrive=function(e){return n.isWindows()?e.replace(/^[a-z]:[\\\/]+?/i,"/"):e},n.stripPrefix=function(e){return"."!==e.charAt(0)||"/"!==e.charAt(1)&&"\\"!==e.charAt(1)?e:e.slice(2)},n.isSimpleChar=function(e){return""===e.trim()||"."===e},n.isSlash=function(e){return"/"===e||"\\/"===e||"\\"===e||"\\\\"===e},n.matchPath=function(e,t){return t&&t.contains?n.containsPattern(e,t):n.equalsPattern(e,t)},n._equals=function(e,t,r){return r===e||r===t},n._contains=function(e,t,r){return-1!==e.indexOf(r)||-1!==t.indexOf(r)},n.equalsPattern=function(e,t){var r=n.unixify(t);return t=t||{},function(i){var o=n._equals(i,r(i),e);if(!0===o||!0!==t.nocase)return o;var a=i.toLowerCase();return n._equals(a,r(a),e)}},n.containsPattern=function(e,t){var r=n.unixify(t);return t=t||{},function(i){var o=n._contains(i,r(i),e);if(!0===o||!0!==t.nocase)return o;var a=i.toLowerCase();return n._contains(a,r(a),e)}},n.matchBasename=function(e){return function(t){return e.test(t)||e.test(i.basename(t))}},n.identity=function(e){return e},n.value=function(e,t,r){return r&&!1===r.unixify?e:r&&"function"===typeof r.unixify?r.unixify(e):t(e)},n.unixify=function(e){var t=e||{};return function(e){return!1!==t.stripPrefix&&(e=n.stripPrefix(e)),!0===t.unescape&&(e=n.unescape(e)),(!0===t.unixify||n.isWindows())&&(e=n.toPosixPath(e)),e}}},function(e,t,r){(function(r){var n,i,o,a;a=function(){"use strict";return function(){return r&&("win32"===r.platform||/^(msys|cygwin)$/.test(Object({NODE_ENV:"production",PUBLIC_URL:""}).OSTYPE))}},t&&"object"===typeof t&&"undefined"!==typeof e?e.exports=a():(i=[],void 0===(o="function"===typeof(n=a)?n.apply(t,i):n)||(e.exports=o))}).call(this,r(48))},function(e,t,r){"use strict";var n=r(35),i=r(78),o="undefined"!==typeof Reflect&&Reflect.defineProperty?Reflect.defineProperty:Object.defineProperty;e.exports=function(e,t,r){if(!n(e)&&"function"!==typeof e&&!Array.isArray(e))throw new TypeError("expected an object, function, or array");if("string"!==typeof t)throw new TypeError('expected "key" to be a string');return i(r)?(o(e,t,r),e):(o(e,t,{configurable:!0,enumerable:!1,writable:!0,value:r}),e)}},function(e,t){var r=Object.prototype.toString;function n(e){return e.constructor?e.constructor.name:null}e.exports=function(e){if(void 0===e)return"undefined";if(null===e)return"null";var t=typeof e;if("boolean"===t)return"boolean";if("string"===t)return"string";if("number"===t)return"number";if("symbol"===t)return"symbol";if("function"===t)return"GeneratorFunction"===n(e)?"generatorfunction":"function";if(function(e){return Array.isArray?Array.isArray(e):e instanceof Array}(e))return"array";if(function(e){if(e.constructor&&"function"===typeof e.constructor.isBuffer)return e.constructor.isBuffer(e);return!1}(e))return"buffer";if(function(e){try{if("number"===typeof e.length&&"function"===typeof e.callee)return!0}catch(t){if(-1!==t.message.indexOf("callee"))return!0}return!1}(e))return"arguments";if(function(e){return e instanceof Date||"function"===typeof e.toDateString&&"function"===typeof e.getDate&&"function"===typeof e.setDate}(e))return"date";if(function(e){return e instanceof Error||"string"===typeof e.message&&e.constructor&&"number"===typeof e.constructor.stackTraceLimit}(e))return"error";if(function(e){return e instanceof RegExp||"string"===typeof e.flags&&"boolean"===typeof e.ignoreCase&&"boolean"===typeof e.multiline&&"boolean"===typeof e.global}(e))return"regexp";switch(n(e)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(function(e){return"function"===typeof e.throw&&"function"===typeof e.return&&"function"===typeof e.next}(e))return"generator";switch(t=r.call(e)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return t.slice(8,-1).toLowerCase().replace(/\s/g,"")}},function(e,t,r){"use strict";var n=r(373);e.exports=function(e){e.compiler.set("escape",function(e){return this.emit("\\"+e.val.replace(/^\\/,""),e)}).set("text",function(e){return this.emit(e.val.replace(/([{}])/g,"\\$1"),e)}).set("posix",function(e){if("[::]"===e.val)return this.emit("\\[::\\]",e);var t=n[e.inner];return"undefined"===typeof t&&(t="["+e.inner+"]"),this.emit(t,e)}).set("bracket",function(e){return this.mapVisit(e.nodes)}).set("bracket.open",function(e){return this.emit(e.val,e)}).set("bracket.inner",function(e){var t=e.val;if("["===t||"]"===t)return this.emit("\\"+e.val,e);if("^]"===t)return this.emit("^\\]",e);if("^"===t)return this.emit("^",e);/-/.test(t)&&!/(\d-\d|\w-\w)/.test(t)&&(t=t.split("-").join("\\-"));var r="^"===t.charAt(0);return r&&-1===t.indexOf("/")&&(t+="/"),r&&-1===t.indexOf(".")&&(t+="."),t=t.replace(/\\([1-9])/g,"$1"),this.emit(t,e)}).set("bracket.close",function(e){var t=e.val.replace(/^\\/,"");return!0===e.parent.escaped?this.emit("\\"+t,e):this.emit(t,e)})}},function(e,t,r){"use strict";e.exports={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"}},function(e,t,r){"use strict";var n=r(375),i=r(55),o=n.createRegex("(\\[(?=.*\\])|\\])+");e.exports=function(e){e.state=e.state||{},e.parser.sets.bracket=e.parser.sets.bracket||[],e.parser.capture("escape",function(){if(!this.isInside("bracket")){var e=this.position(),t=this.match(/^\\(.)/);if(t)return e({type:"escape",val:t[0]})}}).capture("text",function(){if(!this.isInside("bracket")){var e=this.position(),t=this.match(o);if(t&&t[0])return e({type:"text",val:t[0]})}}).capture("posix",function(){var t=this.position(),r=this.match(/^\[:(.*?):\](?=.*\])/);if(r){var n=this.isInside("bracket");return n&&e.posix++,t({type:"posix",insideBracket:n,inner:r[1],val:r[0]})}}).capture("bracket",function(){}).capture("bracket.open",function(){var e=this.parsed,t=this.position(),r=this.match(/^\[(?=.*\])/);if(r){var o=this.prev(),a=n.last(o.nodes);if("\\"===e.slice(-1)&&!this.isInside("bracket"))return a.val=a.val.slice(0,a.val.length-1),t({type:"escape",val:r[0]});var s=t({type:"bracket.open",val:r[0]});if("bracket.open"===a.type||this.isInside("bracket"))return s.val="\\"+s.val,s.type="bracket.inner",s.escaped=!0,s;var l=t({type:"bracket",nodes:[s]});i(l,"parent",o),i(s,"parent",l),this.push("bracket",l),o.nodes.push(l)}}).capture("bracket.inner",function(){if(this.isInside("bracket")){var e=this.position(),t=this.match(o);if(t&&t[0]){var r=this.input.charAt(0),n=t[0],i=e({type:"bracket.inner",val:n});if("\\\\"===n)return i;var a=n.charAt(0),s=n.slice(-1);return"!"===a&&(n="^"+n.slice(1)),("\\"===s||"^"===n&&"]"===r)&&(n+=this.input[0],this.consume(1)),i.val=n,i}}}).capture("bracket.close",function(){var e=this.parsed,t=this.position(),r=this.match(/^\]/);if(r){var o=this.prev(),a=n.last(o.nodes);if("\\"===e.slice(-1)&&!this.isInside("bracket"))return a.val=a.val.slice(0,a.val.length-1),t({type:"escape",val:r[0]});var s=t({type:"bracket.close",rest:this.input,val:r[0]});if("bracket.open"===a.type)return s.type="bracket.inner",s.escaped=!0,s;var l=this.pop("bracket");if(!this.isType(l,"bracket")){if(this.options.strict)throw new Error('missing opening "["');return s.type="bracket.inner",s.escaped=!0,s}l.nodes.push(s),i(s,"parent",l)}})},e.exports.TEXT_REGEX="(\\[(?=.*\\])|\\])+"},function(e,t,r){"use strict";var n,i=r(60),o=r(94);t.last=function(e){return e[e.length-1]},t.createRegex=function(e,t){if(n)return n;var r,a={contains:!0,strictClose:!1},s=o.create(e,a);return r=i("string"===typeof t?"^(?:"+t+"|"+s+")":s,a),n=r}},function(e,t,r){"use strict";var n=r(96),i=r(193),o=r(49),a=r(190),s=r(192);e.exports=function(e){this.options=o({source:"extglob"},e),this.snapdragon=this.options.snapdragon||new n(this.options),this.snapdragon.patterns=this.snapdragon.patterns||{},this.compiler=this.snapdragon.compiler,this.parser=this.snapdragon.parser,a(this.snapdragon),s(this.snapdragon),i(this.snapdragon,"parse",function(e,t){var r=n.prototype.parse.apply(this,arguments);r.input=e;var o=this.parser.stack.pop();if(o&&!0!==this.options.strict){var a=o.nodes[0];a.val="\\"+a.val;var s=a.parent.nodes[1];"star"===s.type&&(s.loose=!0)}return i(r,"parser",this.parser),r}),i(this,"parse",function(e,t){return this.snapdragon.parse.apply(this.snapdragon,arguments)}),i(this,"compile",function(e,t){return this.snapdragon.compile.apply(this.snapdragon,arguments)})}},function(e,t,r){"use strict";var n,i=r(189),o=r(185),a=r(94),s=r(60),l=function(e){return n||(n=function(e){var t=a.create(e,{contains:!0,strictClose:!1});return s("(?:[\\^]|\\\\|"+t+")",{strictClose:!1})}("([!@*?+]?\\(|\\)|\\[:?(?=.*?:?\\])|:?\\]|[*+?!^$.\\\\/])+"))};e.exports=function(e){var t=e.parser.parsers;e.use(o.parsers);var r=t.escape,n=t.slash,a=t.qmark,s=t.plus,u=t.star,c=t.dot;e.use(i.parsers),e.parser.use(function(){this.notRegex=/^\!+(?!\()/}).capture("escape",r).capture("slash",n).capture("qmark",a).capture("star",u).capture("plus",s).capture("dot",c).capture("text",function(){if(!this.isInside("bracket")){var e=this.position(),t=this.match(l(this.options));if(t&&t[0])return e({type:"text",val:t[0].replace(/([[\]^$])/g,"\\$1")})}})}},function(e,t,r){e.exports=new(r(136))},function(e,t,r){"use strict";(function(t){var n=e.exports,i=r(135),o=r(96);n.define=r(380),n.diff=r(187),n.extend=r(184),n.pick=r(188),n.typeOf=r(381),n.unique=r(95),n.isWindows=function(){return"\\"===i.sep||"win32"===t.platform},n.instantiate=function(e,t){var r;return r="object"===n.typeOf(e)&&e.snapdragon?e.snapdragon:"object"===n.typeOf(t)&&t.snapdragon?t.snapdragon:new o(t),n.define(r,"parse",function(e,t){var r=o.prototype.parse.apply(this,arguments);r.input=e;var i=this.parser.stack.pop();if(i&&!0!==this.options.strictErrors){var a=i.nodes[0],s=i.nodes[1];if("bracket"===i.type)"["===s.val.charAt(0)&&(s.val="\\"+s.val);else{a.val="\\"+a.val;var l=a.parent.nodes[1];"star"===l.type&&(l.loose=!0)}}return n.define(r,"parser",this.parser),r}),r},n.createKey=function(e,t){if("object"!==n.typeOf(t))return e;for(var r=e,i=Object.keys(t),o=0;o<i.length;o++){var a=i[o];r+=";"+a+"="+String(t[a])}return r},n.arrayify=function(e){return"string"===typeof e?[e]:e?Array.isArray(e)?e:[e]:[]},n.isString=function(e){return"string"===typeof e},n.isObject=function(e){return"object"===n.typeOf(e)},n.hasSpecialChars=function(e){return/(?:(?:(^|\/)[!.])|[*?+()|\[\]{}]|[+@]\()/.test(e)},n.escapeRegex=function(e){return e.replace(/[-[\]{}()^$|*+?.\\\/\s]/g,"\\$&")},n.toPosixPath=function(e){return e.replace(/\\+/g,"/")},n.unescape=function(e){return n.toPosixPath(e.replace(/\\(?=[*+?!.])/g,""))},n.stripPrefix=function(e){if("."!==e.charAt(0))return e;var t=e.charAt(1);return n.isSlash(t)?e.slice(2):e},n.isSlash=function(e){return"/"===e||"\\/"===e||"\\"===e||"\\\\"===e},n.matchPath=function(e,t){return t&&t.contains?n.containsPattern(e,t):n.equalsPattern(e,t)},n._equals=function(e,t,r){return r===e||r===t},n._contains=function(e,t,r){return-1!==e.indexOf(r)||-1!==t.indexOf(r)},n.equalsPattern=function(e,t){var r=n.unixify(t);return t=t||{},function(i){var o=n._equals(i,r(i),e);if(!0===o||!0!==t.nocase)return o;var a=i.toLowerCase();return n._equals(a,r(a),e)}},n.containsPattern=function(e,t){var r=n.unixify(t);return t=t||{},function(i){var o=n._contains(i,r(i),e);if(!0===o||!0!==t.nocase)return o;var a=i.toLowerCase();return n._contains(a,r(a),e)}},n.matchBasename=function(e){return function(t){return e.test(i.basename(t))}},n.value=function(e,t,r){return r&&!1===r.unixify?e:t(e)},n.unixify=function(e){return e=e||{},function(t){return(n.isWindows()||!0===e.unixify)&&(t=n.toPosixPath(t)),!1!==e.stripPrefix&&(t=n.stripPrefix(t)),!0===e.unescape&&(t=n.unescape(t)),t}}}).call(this,r(48))},function(e,t,r){"use strict";var n=r(35),i=r(78),o="undefined"!==typeof Reflect&&Reflect.defineProperty?Reflect.defineProperty:Object.defineProperty;e.exports=function(e,t,r){if(!n(e)&&"function"!==typeof e&&!Array.isArray(e))throw new TypeError("expected an object, function, or array");if("string"!==typeof t)throw new TypeError('expected "key" to be a string');return i(r)?(o(e,t,r),e):(o(e,t,{configurable:!0,enumerable:!1,writable:!0,value:r}),e)}},function(e,t){var r=Object.prototype.toString;function n(e){return e.constructor?e.constructor.name:null}e.exports=function(e){if(void 0===e)return"undefined";if(null===e)return"null";var t=typeof e;if("boolean"===t)return"boolean";if("string"===t)return"string";if("number"===t)return"number";if("symbol"===t)return"symbol";if("function"===t)return"GeneratorFunction"===n(e)?"generatorfunction":"function";if(function(e){return Array.isArray?Array.isArray(e):e instanceof Array}(e))return"array";if(function(e){if(e.constructor&&"function"===typeof e.constructor.isBuffer)return e.constructor.isBuffer(e);return!1}(e))return"buffer";if(function(e){try{if("number"===typeof e.length&&"function"===typeof e.callee)return!0}catch(t){if(-1!==t.message.indexOf("callee"))return!0}return!1}(e))return"arguments";if(function(e){return e instanceof Date||"function"===typeof e.toDateString&&"function"===typeof e.getDate&&"function"===typeof e.setDate}(e))return"date";if(function(e){return e instanceof Error||"string"===typeof e.message&&e.constructor&&"number"===typeof e.constructor.stackTraceLimit}(e))return"error";if(function(e){return e instanceof RegExp||"string"===typeof e.flags&&"boolean"===typeof e.ignoreCase&&"boolean"===typeof e.multiline&&"boolean"===typeof e.global}(e))return"regexp";switch(n(e)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(function(e){return"function"===typeof e.throw&&"function"===typeof e.return&&"function"===typeof e.next}(e))return"generator";switch(t=r.call(e)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return t.slice(8,-1).toLowerCase().replace(/\s/g,"")}},function(e,t,r){"use strict";var n=r(383);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,r,i,o,a){if(a!==n){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return r.PropTypes=r,r}},function(e,t,r){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,r){"use strict";var n=r(385);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,r,i,o,a){if(a!==n){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return r.PropTypes=r,r}},function(e,t,r){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t){function r(){return e.exports=r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r.apply(this,arguments)}e.exports=r},function(e,t,r){e.exports={default:r(388),__esModule:!0}},function(e,t,r){r(389),e.exports=r(36).Object.assign},function(e,t,r){var n=r(63);n(n.S+n.F,"Object",{assign:r(391)})},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,r){"use strict";var n=r(112),i=r(146),o=r(115),a=r(116),s=r(200),l=Object.assign;e.exports=!l||r(82)(function(){var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(e){t[e]=e}),7!=l({},e)[r]||Object.keys(l({},t)).join("")!=n})?function(e,t){for(var r=a(e),l=arguments.length,u=1,c=i.f,h=o.f;l>u;)for(var p,f=s(arguments[u++]),d=c?n(f).concat(c(f)):n(f),m=d.length,v=0;m>v;)h.call(f,p=d[v++])&&(r[p]=f[p]);return r}:l},function(e,t,r){var n=r(75),i=r(201),o=r(393);e.exports=function(e){return function(t,r,a){var s,l=n(t),u=i(l.length),c=o(a,u);if(e&&r!=r){for(;u>c;)if((s=l[c++])!=s)return!0}else for(;u>c;c++)if((e||c in l)&&l[c]===r)return e||c||0;return!e&&-1}}},function(e,t,r){var n=r(142),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=n(e))<0?i(e+t,0):o(e,t)}},function(e,t,r){r(395);var n=r(36).Object;e.exports=function(e,t,r){return n.defineProperty(e,t,r)}},function(e,t,r){var n=r(63);n(n.S+n.F*!r(73),"Object",{defineProperty:r(65).f})},function(e,t,r){e.exports={default:r(397),__esModule:!0}},function(e,t,r){r(203),r(402),e.exports=r(149).f("iterator")},function(e,t,r){var n=r(142),i=r(141);e.exports=function(e){return function(t,r){var o,a,s=String(i(t)),l=n(r),u=s.length;return l<0||l>=u?e?"":void 0:(o=s.charCodeAt(l))<55296||o>56319||l+1===u||(a=s.charCodeAt(l+1))<56320||a>57343?e?s.charAt(l):o:e?s.slice(l,l+2):a-56320+(o-55296<<10)+65536}}},function(e,t,r){"use strict";var n=r(147),i=r(98),o=r(148),a={};r(79)(a,r(50)("iterator"),function(){return this}),e.exports=function(e,t,r){e.prototype=n(a,{next:i(1,r)}),o(e,t+" Iterator")}},function(e,t,r){var n=r(65),i=r(80),o=r(112);e.exports=r(73)?Object.defineProperties:function(e,t){i(e);for(var r,a=o(t),s=a.length,l=0;s>l;)n.f(e,r=a[l++],t[r]);return e}},function(e,t,r){var n=r(64).document;e.exports=n&&n.documentElement},function(e,t,r){r(403);for(var n=r(64),i=r(79),o=r(99),a=r(50)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),l=0;l<s.length;l++){var u=s[l],c=n[u],h=c&&c.prototype;h&&!h[a]&&i(h,a,u),o[u]=o.Array}},function(e,t,r){"use strict";var n=r(404),i=r(405),o=r(99),a=r(75);e.exports=r(204)(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])},"values"),o.Arguments=o.Array,n("keys"),n("values"),n("entries")},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,r){e.exports={default:r(407),__esModule:!0}},function(e,t,r){r(408),r(413),r(414),r(415),e.exports=r(36).Symbol},function(e,t,r){"use strict";var n=r(64),i=r(74),o=r(73),a=r(63),s=r(205),l=r(409).KEY,u=r(82),c=r(144),h=r(148),p=r(114),f=r(50),d=r(149),m=r(150),v=r(410),g=r(411),y=r(80),b=r(81),x=r(75),w=r(139),S=r(98),M=r(147),_=r(412),T=r(151),A=r(65),C=r(112),E=T.f,L=A.f,N=_.f,P=n.Symbol,O=n.JSON,R=O&&O.stringify,D=f("_hidden"),F=f("toPrimitive"),k={}.propertyIsEnumerable,I=c("symbol-registry"),B=c("symbols"),U=c("op-symbols"),V=Object.prototype,j="function"==typeof P,z=n.QObject,G=!z||!z.prototype||!z.prototype.findChild,W=o&&u(function(){return 7!=M(L({},"a",{get:function(){return L(this,"a",{value:7}).a}})).a})?function(e,t,r){var n=E(V,t);n&&delete V[t],L(e,t,r),n&&e!==V&&L(V,t,n)}:L,H=function(e){var t=B[e]=M(P.prototype);return t._k=e,t},X=j&&"symbol"==typeof P.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof P},q=function(e,t,r){return e===V&&q(U,t,r),y(e),t=w(t,!0),y(r),i(B,t)?(r.enumerable?(i(e,D)&&e[D][t]&&(e[D][t]=!1),r=M(r,{enumerable:S(0,!1)})):(i(e,D)||L(e,D,S(1,{})),e[D][t]=!0),W(e,t,r)):L(e,t,r)},Y=function(e,t){y(e);for(var r,n=v(t=x(t)),i=0,o=n.length;o>i;)q(e,r=n[i++],t[r]);return e},K=function(e){var t=k.call(this,e=w(e,!0));return!(this===V&&i(B,e)&&!i(U,e))&&(!(t||!i(this,e)||!i(B,e)||i(this,D)&&this[D][e])||t)},Q=function(e,t){if(e=x(e),t=w(t,!0),e!==V||!i(B,t)||i(U,t)){var r=E(e,t);return!r||!i(B,t)||i(e,D)&&e[D][t]||(r.enumerable=!0),r}},J=function(e){for(var t,r=N(x(e)),n=[],o=0;r.length>o;)i(B,t=r[o++])||t==D||t==l||n.push(t);return n},Z=function(e){for(var t,r=e===V,n=N(r?U:x(e)),o=[],a=0;n.length>a;)!i(B,t=n[a++])||r&&!i(V,t)||o.push(B[t]);return o};j||(s((P=function(){if(this instanceof P)throw TypeError("Symbol is not a constructor!");var e=p(arguments.length>0?arguments[0]:void 0);return o&&G&&W(V,e,{configurable:!0,set:function t(r){this===V&&t.call(U,r),i(this,D)&&i(this[D],e)&&(this[D][e]=!1),W(this,e,S(1,r))}}),H(e)}).prototype,"toString",function(){return this._k}),T.f=Q,A.f=q,r(207).f=_.f=J,r(115).f=K,r(146).f=Z,o&&!r(113)&&s(V,"propertyIsEnumerable",K,!0),d.f=function(e){return H(f(e))}),a(a.G+a.W+a.F*!j,{Symbol:P});for(var $="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ee=0;$.length>ee;)f($[ee++]);for(var te=C(f.store),re=0;te.length>re;)m(te[re++]);a(a.S+a.F*!j,"Symbol",{for:function(e){return i(I,e+="")?I[e]:I[e]=P(e)},keyFor:function(e){if(!X(e))throw TypeError(e+" is not a symbol!");for(var t in I)if(I[t]===e)return t},useSetter:function(){G=!0},useSimple:function(){G=!1}}),a(a.S+a.F*!j,"Object",{create:function(e,t){return void 0===t?M(e):Y(M(e),t)},defineProperty:q,defineProperties:Y,getOwnPropertyDescriptor:Q,getOwnPropertyNames:J,getOwnPropertySymbols:Z}),O&&a(a.S+a.F*(!j||u(function(){var e=P();return"[null]"!=R([e])||"{}"!=R({a:e})||"{}"!=R(Object(e))})),"JSON",{stringify:function(e){for(var t,r,n=[e],i=1;arguments.length>i;)n.push(arguments[i++]);if(r=t=n[1],(b(t)||void 0!==e)&&!X(e))return g(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!X(t))return t}),n[1]=t,R.apply(O,n)}}),P.prototype[F]||r(79)(P.prototype,F,P.prototype.valueOf),h(P,"Symbol"),h(Math,"Math",!0),h(n.JSON,"JSON",!0)},function(e,t,r){var n=r(114)("meta"),i=r(81),o=r(74),a=r(65).f,s=0,l=Object.isExtensible||function(){return!0},u=!r(82)(function(){return l(Object.preventExtensions({}))}),c=function(e){a(e,n,{value:{i:"O"+ ++s,w:{}}})},h=e.exports={KEY:n,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,n)){if(!l(e))return"F";if(!t)return"E";c(e)}return e[n].i},getWeak:function(e,t){if(!o(e,n)){if(!l(e))return!0;if(!t)return!1;c(e)}return e[n].w},onFreeze:function(e){return u&&h.NEED&&l(e)&&!o(e,n)&&c(e),e}}},function(e,t,r){var n=r(112),i=r(146),o=r(115);e.exports=function(e){var t=n(e),r=i.f;if(r)for(var a,s=r(e),l=o.f,u=0;s.length>u;)l.call(e,a=s[u++])&&t.push(a);return t}},function(e,t,r){var n=r(140);e.exports=Array.isArray||function(e){return"Array"==n(e)}},function(e,t,r){var n=r(75),i=r(207).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"[object Window]"==o.call(e)?function(e){try{return i(e)}catch(t){return a.slice()}}(e):i(n(e))}},function(e,t){},function(e,t,r){r(150)("asyncIterator")},function(e,t,r){r(150)("observable")},function(e,t,r){e.exports={default:r(417),__esModule:!0}},function(e,t,r){r(418),e.exports=r(36).Object.setPrototypeOf},function(e,t,r){var n=r(63);n(n.S,"Object",{setPrototypeOf:r(419).set})},function(e,t,r){var n=r(81),i=r(80),o=function(e,t){if(i(e),!n(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,n){try{(n=r(138)(Function.call,r(151).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(i){t=!0}return function(e,r){return o(e,r),t?e.__proto__=r:n(e,r),e}}({},!1):void 0),check:o}},function(e,t,r){e.exports={default:r(421),__esModule:!0}},function(e,t,r){r(422);var n=r(36).Object;e.exports=function(e,t){return n.create(e,t)}},function(e,t,r){var n=r(63);n(n.S,"Object",{create:r(147)})},function(e,t,r){"use strict";var n=r(424);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,r,i,o,a){if(a!==n){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return r.PropTypes=r,r}},function(e,t,r){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,r){e.exports={default:r(426),__esModule:!0}},function(e,t,r){r(427),e.exports=r(36).Object.getPrototypeOf},function(e,t,r){var n=r(116),i=r(206);r(208)("getPrototypeOf",function(){return function(e){return i(n(e))}})},function(e,t,r){e.exports={default:r(429),__esModule:!0}},function(e,t,r){r(430);var n=r(36).Object;e.exports=function(e,t){return n.getOwnPropertyDescriptor(e,t)}},function(e,t,r){var n=r(75),i=r(151).f;r(208)("getOwnPropertyDescriptor",function(){return function(e,t){return i(n(e),t)}})},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(432)),o=n(r(131)),a=!0,s=!1,l=["altKey","bubbles","cancelable","ctrlKey","currentTarget","eventPhase","metaKey","shiftKey","target","timeStamp","view","type"];function u(e){return null===e||void 0===e}var c=[{reg:/^key/,props:["char","charCode","key","keyCode","which"],fix:function(e,t){u(e.which)&&(e.which=u(t.charCode)?t.keyCode:t.charCode),void 0===e.metaKey&&(e.metaKey=e.ctrlKey)}},{reg:/^touch/,props:["touches","changedTouches","targetTouches"]},{reg:/^hashchange$/,props:["newURL","oldURL"]},{reg:/^gesturechange$/i,props:["rotation","scale"]},{reg:/^(mousewheel|DOMMouseScroll)$/,props:[],fix:function(e,t){var r=void 0,n=void 0,i=void 0,o=t.wheelDelta,a=t.axis,s=t.wheelDeltaY,l=t.wheelDeltaX,u=t.detail;o&&(i=o/120),u&&(i=0-(u%3===0?u/3:u)),void 0!==a&&(a===e.HORIZONTAL_AXIS?(n=0,r=0-i):a===e.VERTICAL_AXIS&&(r=0,n=i)),void 0!==s&&(n=s/120),void 0!==l&&(r=-1*l/120),r||n||(n=i),void 0!==r&&(e.deltaX=r),void 0!==n&&(e.deltaY=n),void 0!==i&&(e.delta=i)}},{reg:/^mouse|contextmenu|click|mspointer|(^DOMMouseScroll$)/i,props:["buttons","clientX","clientY","button","offsetX","relatedTarget","which","fromElement","toElement","offsetY","pageX","pageY","screenX","screenY"],fix:function(e,t){var r=void 0,n=void 0,i=void 0,o=e.target,a=t.button;return o&&u(e.pageX)&&!u(t.clientX)&&(n=(r=o.ownerDocument||document).documentElement,i=r.body,e.pageX=t.clientX+(n&&n.scrollLeft||i&&i.scrollLeft||0)-(n&&n.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(n&&n.scrollTop||i&&i.scrollTop||0)-(n&&n.clientTop||i&&i.clientTop||0)),e.which||void 0===a||(e.which=1&a?1:2&a?3:4&a?2:0),!e.relatedTarget&&e.fromElement&&(e.relatedTarget=e.fromElement===o?e.toElement:e.fromElement),e}}];function h(){return a}function p(){return s}function f(e){var t=e.type,r="function"===typeof e.stopPropagation||"boolean"===typeof e.cancelBubble;i.default.call(this),this.nativeEvent=e;var n=p;"defaultPrevented"in e?n=e.defaultPrevented?h:p:"getPreventDefault"in e?n=e.getPreventDefault()?h:p:"returnValue"in e&&(n=e.returnValue===s?h:p),this.isDefaultPrevented=n;var o=[],a=void 0,u=void 0,f=l.concat();for(c.forEach(function(e){t.match(e.reg)&&(f=f.concat(e.props),e.fix&&o.push(e.fix))}),a=f.length;a;)this[u=f[--a]]=e[u];for(!this.target&&r&&(this.target=e.srcElement||document),this.target&&3===this.target.nodeType&&(this.target=this.target.parentNode),a=o.length;a;)(0,o[--a])(this,e);this.timeStamp=e.timeStamp||Date.now()}var d=i.default.prototype;(0,o.default)(f.prototype,d,{constructor:f,preventDefault:function(){var e=this.nativeEvent;e.preventDefault?e.preventDefault():e.returnValue=s,d.preventDefault.call(this)},stopPropagation:function(){var e=this.nativeEvent;e.stopPropagation?e.stopPropagation():e.cancelBubble=a,d.stopPropagation.call(this)}}),t.default=f,e.exports=t.default},function(e,t,r){"use strict";function n(){return!1}function i(){return!0}function o(){this.timeStamp=Date.now(),this.target=void 0,this.currentTarget=void 0}Object.defineProperty(t,"__esModule",{value:!0}),o.prototype={isEventObject:1,constructor:o,isDefaultPrevented:n,isPropagationStopped:n,isImmediatePropagationStopped:n,preventDefault:function(){this.isDefaultPrevented=i},stopPropagation:function(){this.isPropagationStopped=i},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=i,this.stopPropagation()},halt:function(e){e?this.stopImmediatePropagation():this.stopPropagation(),this.preventDefault()}},t.default=o,e.exports=t.default},function(e,t,r){e.exports={default:r(434),__esModule:!0}},function(e,t,r){r(203),r(435),e.exports=r(36).Array.from},function(e,t,r){"use strict";var n=r(138),i=r(63),o=r(116),a=r(436),s=r(437),l=r(201),u=r(438),c=r(439);i(i.S+i.F*!r(441)(function(e){Array.from(e)}),"Array",{from:function(e){var t,r,i,h,p=o(e),f="function"==typeof this?this:Array,d=arguments.length,m=d>1?arguments[1]:void 0,v=void 0!==m,g=0,y=c(p);if(v&&(m=n(m,d>2?arguments[2]:void 0,2)),void 0==y||f==Array&&s(y))for(r=new f(t=l(p.length));t>g;g++)u(r,g,v?m(p[g],g):p[g]);else for(h=y.call(p),r=new f;!(i=h.next()).done;g++)u(r,g,v?a(h,m,[i.value,g],!0):i.value);return r.length=g,r}})},function(e,t,r){var n=r(80);e.exports=function(e,t,r,i){try{return i?t(n(r)[0],r[1]):t(r)}catch(a){var o=e.return;throw void 0!==o&&n(o.call(e)),a}}},function(e,t,r){var n=r(99),i=r(50)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||o[i]===e)}},function(e,t,r){"use strict";var n=r(65),i=r(98);e.exports=function(e,t,r){t in e?n.f(e,t,i(0,r)):e[t]=r}},function(e,t,r){var n=r(440),i=r(50)("iterator"),o=r(99);e.exports=r(36).getIteratorMethod=function(e){if(void 0!=e)return e[i]||e["@@iterator"]||o[n(e)]}},function(e,t,r){var n=r(140),i=r(50)("toStringTag"),o="Arguments"==n(function(){return arguments}());e.exports=function(e){var t,r,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(r){}}(t=Object(e),i))?r:o?n(t):"Object"==(a=n(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t,r){var n=r(50)("iterator"),i=!1;try{var o=[7][n]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(a){}e.exports=function(e,t){if(!t&&!i)return!1;var r=!1;try{var o=[7],s=o[n]();s.next=function(){return{done:r=!0}},o[n]=function(){return s},e(o)}catch(a){}return r}},function(e,t,r){"use strict";var n=r(443);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,r,i,o,a){if(a!==n){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return r.PropTypes=r,r}},function(e,t,r){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,r){"use strict";var n=r(445);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,r,i,o,a){if(a!==n){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return r.PropTypes=r,r}},function(e,t,r){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,r){"use strict";var n=r(447);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,r,i,o,a){if(a!==n){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return r.PropTypes=r,r}},function(e,t,r){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,r){"use strict";var n=r(449);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,r,i,o,a){if(a!==n){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return r.PropTypes=r,r}},function(e,t,r){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,r){"use strict";var n=r(451);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,r,i,o,a){if(a!==n){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return r.PropTypes=r,r}},function(e,t,r){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,r){},,function(e,t,r){"use strict";var n=r(455);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,r,i,o,a){if(a!==n){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return r.PropTypes=r,r}},function(e,t,r){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,o.default)(function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=null;return t.forEach(function(e){if(null==i){var t=e.apply(void 0,r);null!=t&&(i=t)}}),i})};var n,i=r(457),o=(n=i)&&n.__esModule?n:{default:n};e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){function t(t,r,n,i,o,a){var s=i||"<<anonymous>>",l=a||n;if(null==r[n])return t?new Error("Required "+o+" `"+l+"` was not specified in `"+s+"`."):null;for(var u=arguments.length,c=Array(u>6?u-6:0),h=6;h<u;h++)c[h-6]=arguments[h];return e.apply(void 0,[r,n,s,o,l].concat(c))}var r=t.bind(null,!1);return r.isRequired=t.bind(null,!0),r},e.exports=t.default},,,function(e,t,r){var n=r(210),i=r(117)("socket.io-client:url");e.exports=function(e,t){var r=e;t=t||"undefined"!==typeof location&&location,null==e&&(e=t.protocol+"//"+t.host);"string"===typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(i("protocol-less url %s",e),e="undefined"!==typeof t?t.protocol+"//"+e:"https://"+e),i("parse %s",e),r=n(e));r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443"));r.path=r.path||"/";var o=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+o+":"+r.port,r.href=r.protocol+"://"+o+(t&&t.port===r.port?"":":"+r.port),r}},function(e,t,r){function n(e){var r;function n(){if(n.enabled){var e=n,i=+new Date,o=i-(r||i);e.diff=o,e.prev=r,e.curr=i,r=i;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!==typeof a[0]&&a.unshift("%O");var l=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(r,n){if("%%"===r)return r;l++;var i=t.formatters[n];if("function"===typeof i){var o=a[l];r=i.call(e,o),a.splice(l,1),l--}return r}),t.formatArgs.call(e,a),(n.log||t.log||console.log.bind(console)).apply(e,a)}}return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=function(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}(e),n.destroy=i,"function"===typeof t.init&&t.init(n),t.instances.push(n),n}function i(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=n.debug=n.default=n).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var r;t.save(e),t.names=[],t.skips=[];var n=("string"===typeof e?e:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(r=0;r<t.instances.length;r++){var o=t.instances[r];o.enabled=t.enabled(o.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(110),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t,r){(function(n){function i(){var e;try{e=t.storage.debug}catch(r){}return!e&&"undefined"!==typeof n&&"env"in n&&(e=Object({NODE_ENV:"production",PUBLIC_URL:""}).DEBUG),e}(t=e.exports=r(463)).log=function(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),!r)return;var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var i=0,o=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))}),e.splice(o,0,n)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(r){}},t.load=i,t.useColors=function(){if("undefined"!==typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},t.enable(i())}).call(this,r(48))},function(e,t,r){function n(e){var r;function n(){if(n.enabled){var e=n,i=+new Date,o=i-(r||i);e.diff=o,e.prev=r,e.curr=i,r=i;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!==typeof a[0]&&a.unshift("%O");var l=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(r,n){if("%%"===r)return r;l++;var i=t.formatters[n];if("function"===typeof i){var o=a[l];r=i.call(e,o),a.splice(l,1),l--}return r}),t.formatArgs.call(e,a),(n.log||t.log||console.log.bind(console)).apply(e,a)}}return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=function(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}(e),n.destroy=i,"function"===typeof t.init&&t.init(n),t.instances.push(n),n}function i(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=n.debug=n.default=n).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var r;t.save(e),t.names=[],t.skips=[];var n=("string"===typeof e?e:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(r=0;r<t.instances.length;r++){var o=t.instances[r];o.enabled=t.enabled(o.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(110),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t,r){var n=r(211),i=r(212),o=Object.prototype.toString,a="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===o.call(Blob),s="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===o.call(File);t.deconstructPacket=function(e){var t=[],r=e.data,o=e;return o.data=function e(t,r){if(!t)return t;if(i(t)){var o={_placeholder:!0,num:r.length};return r.push(t),o}if(n(t)){for(var a=new Array(t.length),s=0;s<t.length;s++)a[s]=e(t[s],r);return a}if("object"===typeof t&&!(t instanceof Date)){var a={};for(var l in t)a[l]=e(t[l],r);return a}return t}(r,t),o.attachments=t.length,{packet:o,buffers:t}},t.reconstructPacket=function(e,t){return e.data=function e(t,r){if(!t)return t;if(t&&t._placeholder)return r[t.num];if(n(t))for(var i=0;i<t.length;i++)t[i]=e(t[i],r);else if("object"===typeof t)for(var o in t)t[o]=e(t[o],r);return t}(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var r=0,o=e;!function e(l,u,c){if(!l)return l;if(a&&l instanceof Blob||s&&l instanceof File){r++;var h=new FileReader;h.onload=function(){c?c[u]=this.result:o=this.result,--r||t(o)},h.readAsArrayBuffer(l)}else if(n(l))for(var p=0;p<l.length;p++)e(l[p],p,l);else if("object"===typeof l&&!i(l))for(var f in l)e(l[f],f,l)}(o),r||t(o)}},function(e,t,r){"use strict";t.byteLength=function(e){var t=u(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){for(var t,r=u(e),n=r[0],a=r[1],s=new o(function(e,t,r){return 3*(t+r)/4-r}(0,n,a)),l=0,c=a>0?n-4:n,h=0;h<c;h+=4)t=i[e.charCodeAt(h)]<<18|i[e.charCodeAt(h+1)]<<12|i[e.charCodeAt(h+2)]<<6|i[e.charCodeAt(h+3)],s[l++]=t>>16&255,s[l++]=t>>8&255,s[l++]=255&t;2===a&&(t=i[e.charCodeAt(h)]<<2|i[e.charCodeAt(h+1)]>>4,s[l++]=255&t);1===a&&(t=i[e.charCodeAt(h)]<<10|i[e.charCodeAt(h+1)]<<4|i[e.charCodeAt(h+2)]>>2,s[l++]=t>>8&255,s[l++]=255&t);return s},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],a=0,s=r-i;a<s;a+=16383)o.push(c(e,a,a+16383>s?s:a+16383));1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return o.join("")};for(var n=[],i=[],o="undefined"!==typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=a.length;s<l;++s)n[s]=a[s],i[a.charCodeAt(s)]=s;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function c(e,t,r){for(var i,o,a=[],s=t;s<r;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,r,n,i){var o,a,s=8*i-n-1,l=(1<<s)-1,u=l>>1,c=-7,h=r?i-1:0,p=r?-1:1,f=e[t+h];for(h+=p,o=f&(1<<-c)-1,f>>=-c,c+=s;c>0;o=256*o+e[t+h],h+=p,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=n;c>0;a=256*a+e[t+h],h+=p,c-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,n),o-=u}return(f?-1:1)*a*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var a,s,l,u=8*o-i-1,c=(1<<u)-1,h=c>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,d=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+h>=1?p/l:p*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=c?(s=0,a=c):a+h>=1?(s=(t*l-1)*Math.pow(2,i),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;e[r+f]=255&s,f+=d,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;e[r+f]=255&a,f+=d,a/=256,u-=8);e[r+f-d]|=128*m}},function(e,t,r){e.exports=r(468),e.exports.parser=r(83)},function(e,t,r){var n=r(214),i=r(62),o=r(120)("engine.io-client:socket"),a=r(218),s=r(83),l=r(210),u=r(118);function c(e,t){if(!(this instanceof c))return new c(e,t);t=t||{},e&&"object"===typeof e&&(t=e,e=null),e?(e=l(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=l(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!==typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!==typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!==typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"===typeof this.query&&(this.query=u.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"===typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}e.exports=c,c.priorWebsocketSuccess=!1,i(c.prototype),c.protocol=s.protocol,c.Socket=c,c.Transport=r(155),c.transports=r(214),c.parser=r(83),c.prototype.createTransport=function(e){o('creating transport "%s"',e);var t=function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}(this.query);t.EIO=s.protocol,t.transport=e;var r=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new n[e]({query:t,socket:this,agent:r.agent||this.agent,hostname:r.hostname||this.hostname,port:r.port||this.port,secure:r.secure||this.secure,path:r.path||this.path,forceJSONP:r.forceJSONP||this.forceJSONP,jsonp:r.jsonp||this.jsonp,forceBase64:r.forceBase64||this.forceBase64,enablesXDR:r.enablesXDR||this.enablesXDR,timestampRequests:r.timestampRequests||this.timestampRequests,timestampParam:r.timestampParam||this.timestampParam,policyPort:r.policyPort||this.policyPort,pfx:r.pfx||this.pfx,key:r.key||this.key,passphrase:r.passphrase||this.passphrase,cert:r.cert||this.cert,ca:r.ca||this.ca,ciphers:r.ciphers||this.ciphers,rejectUnauthorized:r.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:r.perMessageDeflate||this.perMessageDeflate,extraHeaders:r.extraHeaders||this.extraHeaders,forceNode:r.forceNode||this.forceNode,localAddress:r.localAddress||this.localAddress,requestTimeout:r.requestTimeout||this.requestTimeout,protocols:r.protocols||void 0,isReactNative:this.isReactNative})},c.prototype.open=function(){var e;if(this.rememberUpgrade&&c.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(r){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},c.prototype.setTransport=function(e){o("setting transport %s",e.name);var t=this;this.transport&&(o("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},c.prototype.probe=function(e){o('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),r=!1,n=this;function i(){if(n.onlyBinaryUpgrades){var i=!this.supportsBinary&&n.transport.supportsBinary;r=r||i}r||(o('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",function(i){if(!r)if("pong"===i.type&&"probe"===i.data){if(o('probe transport "%s" pong',e),n.upgrading=!0,n.emit("upgrading",t),!t)return;c.priorWebsocketSuccess="websocket"===t.name,o('pausing current transport "%s"',n.transport.name),n.transport.pause(function(){r||"closed"!==n.readyState&&(o("changing transport and sending upgrade packet"),p(),n.setTransport(t),t.send([{type:"upgrade"}]),n.emit("upgrade",t),t=null,n.upgrading=!1,n.flush())})}else{o('probe transport "%s" failed',e);var a=new Error("probe error");a.transport=t.name,n.emit("upgradeError",a)}}))}function a(){r||(r=!0,p(),t.close(),t=null)}function s(r){var i=new Error("probe error: "+r);i.transport=t.name,a(),o('probe transport "%s" failed because of error: %s',e,r),n.emit("upgradeError",i)}function l(){s("transport closed")}function u(){s("socket closed")}function h(e){t&&e.name!==t.name&&(o('"%s" works - aborting "%s"',e.name,t.name),a())}function p(){t.removeListener("open",i),t.removeListener("error",s),t.removeListener("close",l),n.removeListener("close",u),n.removeListener("upgrading",h)}c.priorWebsocketSuccess=!1,t.once("open",i),t.once("error",s),t.once("close",l),this.once("close",u),this.once("upgrading",h),t.open()},c.prototype.onOpen=function(){if(o("socket open"),this.readyState="open",c.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){o("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},c.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(o('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else o('packet received with socket readyState "%s"',this.readyState)},c.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},c.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!==t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},c.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){o("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},c.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},c.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},c.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(o("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},c.prototype.write=c.prototype.send=function(e,t,r){return this.sendPacket("message",e,t,r),this},c.prototype.sendPacket=function(e,t,r,n){if("function"===typeof t&&(n=t,t=void 0),"function"===typeof r&&(n=r,r=null),"closing"!==this.readyState&&"closed"!==this.readyState){(r=r||{}).compress=!1!==r.compress;var i={type:e,data:t,options:r};this.emit("packetCreate",i),this.writeBuffer.push(i),n&&this.once("flush",n),this.flush()}},c.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?n():t()}):this.upgrading?n():t()}function t(){e.onClose("forced close"),o("socket closing - telling transport to close"),e.transport.close()}function r(){e.removeListener("upgrade",r),e.removeListener("upgradeError",r),t()}function n(){e.once("upgrade",r),e.once("upgradeError",r)}return this},c.prototype.onError=function(e){o("socket error %j",e),c.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},c.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){o('socket close with reason: "%s"',e);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0}},c.prototype.filterUpgrades=function(e){for(var t=[],r=0,n=e.length;r<n;r++)~a(this.transports,e[r])&&t.push(e[r]);return t}},function(e,t){try{e.exports="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(r){e.exports=!1}},function(e,t,r){var n=r(154),i=r(215),o=r(62),a=r(119),s=r(120)("engine.io-client:polling-xhr");function l(){}function u(e){if(i.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!==typeof location){var t="https:"===location.protocol,r=location.port;r||(r=t?443:80),this.xd="undefined"!==typeof location&&e.hostname!==location.hostname||r!==e.port,this.xs=e.secure!==t}}function c(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}if(e.exports=u,e.exports.Request=c,a(u,i),u.prototype.supportsBinary=!0,u.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new c(e)},u.prototype.doWrite=function(e,t){var r="string"!==typeof e&&void 0!==e,n=this.request({method:"POST",data:e,isBinary:r}),i=this;n.on("success",t),n.on("error",function(e){i.onError("xhr post error",e)}),this.sendXhr=n},u.prototype.doPoll=function(){s("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},o(c.prototype),c.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new n(e),r=this;try{s("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var i in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&t.setRequestHeader(i,this.extraHeaders[i])}catch(o){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(o){}try{t.setRequestHeader("Accept","*/*")}catch(o){}"withCredentials"in t&&(t.withCredentials=!0),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){r.onLoad()},t.onerror=function(){r.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");r.supportsBinary&&"application/octet-stream"===e&&(t.responseType="arraybuffer")}catch(o){}4===t.readyState&&(200===t.status||1223===t.status?r.onLoad():setTimeout(function(){r.onError(t.status)},0))},s("xhr data %s",this.data),t.send(this.data)}catch(o){return void setTimeout(function(){r.onError(o)},0)}"undefined"!==typeof document&&(this.index=c.requestsCount++,c.requests[this.index]=this)},c.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},c.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},c.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},c.prototype.cleanup=function(e){if("undefined"!==typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=l:this.xhr.onreadystatechange=l,e)try{this.xhr.abort()}catch(t){}"undefined"!==typeof document&&delete c.requests[this.index],this.xhr=null}},c.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(r){}e="application/octet-stream"===t&&this.xhr.response||this.xhr.responseText}catch(r){this.onError(r)}null!=e&&this.onData(e)},c.prototype.hasXDR=function(){return"undefined"!==typeof XDomainRequest&&!this.xs&&this.enablesXDR},c.prototype.abort=function(){this.cleanup()},c.requestsCount=0,c.requests={},"undefined"!==typeof document)if("function"===typeof attachEvent)attachEvent("onunload",p);else if("function"===typeof addEventListener){var h="onpagehide"in self?"pagehide":"unload";addEventListener(h,p,!1)}function p(){for(var e in c.requests)c.requests.hasOwnProperty(e)&&c.requests[e].abort()}},function(e,t){e.exports=Object.keys||function(e){var t=[],r=Object.prototype.hasOwnProperty;for(var n in e)r.call(e,n)&&t.push(n);return t}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t){e.exports=function(e,t,r){var n=e.byteLength;if(t=t||0,r=r||n,e.slice)return e.slice(t,r);if(t<0&&(t+=n),r<0&&(r+=n),r>n&&(r=n),t>=n||t>=r||0===n)return new ArrayBuffer(0);for(var i=new Uint8Array(e),o=new Uint8Array(r-t),a=t,s=0;a<r;a++,s++)o[s]=i[a];return o.buffer}},function(e,t){function r(){}e.exports=function(e,t,n){var i=!1;return n=n||r,o.count=e,0===e?t():o;function o(e,r){if(o.count<=0)throw new Error("after called too many times");--o.count,e?(i=!0,t(e),t=n):0!==o.count||i||t(null,r)}}},function(e,t){var r,n,i,o=String.fromCharCode;function a(e){for(var t,r,n=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}function s(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function l(e,t){return o(e>>t&63|128)}function u(e,t){if(0==(4294967168&e))return o(e);var r="";return 0==(4294965248&e)?r=o(e>>6&31|192):0==(4294901760&e)?(s(e,t)||(e=65533),r=o(e>>12&15|224),r+=l(e,6)):0==(4292870144&e)&&(r=o(e>>18&7|240),r+=l(e,12),r+=l(e,6)),r+=o(63&e|128)}function c(){if(i>=n)throw Error("Invalid byte index");var e=255&r[i];if(i++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function h(e){var t,o;if(i>n)throw Error("Invalid byte index");if(i==n)return!1;if(t=255&r[i],i++,0==(128&t))return t;if(192==(224&t)){if((o=(31&t)<<6|c())>=128)return o;throw Error("Invalid continuation byte")}if(224==(240&t)){if((o=(15&t)<<12|c()<<6|c())>=2048)return s(o,e)?o:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(o=(7&t)<<18|c()<<12|c()<<6|c())>=65536&&o<=1114111)return o;throw Error("Invalid UTF-8 detected")}e.exports={version:"2.1.2",encode:function(e,t){for(var r=!1!==(t=t||{}).strict,n=a(e),i=n.length,o=-1,s="";++o<i;)s+=u(n[o],r);return s},decode:function(e,t){var s=!1!==(t=t||{}).strict;r=a(e),n=r.length,i=0;for(var l,u=[];!1!==(l=h(s));)u.push(l);return function(e){for(var t,r=e.length,n=-1,i="";++n<r;)(t=e[n])>65535&&(i+=o((t-=65536)>>>10&1023|55296),t=56320|1023&t),i+=o(t);return i}(u)}}},function(e,t){!function(){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=new Uint8Array(256),n=0;n<e.length;n++)r[e.charCodeAt(n)]=n;t.encode=function(t){var r,n=new Uint8Array(t),i=n.length,o="";for(r=0;r<i;r+=3)o+=e[n[r]>>2],o+=e[(3&n[r])<<4|n[r+1]>>4],o+=e[(15&n[r+1])<<2|n[r+2]>>6],o+=e[63&n[r+2]];return i%3===2?o=o.substring(0,o.length-1)+"=":i%3===1&&(o=o.substring(0,o.length-2)+"=="),o},t.decode=function(e){var t,n,i,o,a,s=.75*e.length,l=e.length,u=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var c=new ArrayBuffer(s),h=new Uint8Array(c);for(t=0;t<l;t+=4)n=r[e.charCodeAt(t)],i=r[e.charCodeAt(t+1)],o=r[e.charCodeAt(t+2)],a=r[e.charCodeAt(t+3)],h[u++]=n<<2|i>>4,h[u++]=(15&i)<<4|o>>2,h[u++]=(3&o)<<6|63&a;return c}}()},function(e,t){var r="undefined"!==typeof r?r:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!==typeof MSBlobBuilder?MSBlobBuilder:"undefined"!==typeof MozBlobBuilder&&MozBlobBuilder,n=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),i=n&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),o=r&&r.prototype.append&&r.prototype.getBlob;function a(e){return e.map(function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var r=new Uint8Array(e.byteLength);r.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=r.buffer}return t}return e})}function s(e,t){t=t||{};var n=new r;return a(e).forEach(function(e){n.append(e)}),t.type?n.getBlob(t.type):n.getBlob()}function l(e,t){return new Blob(a(e),t||{})}"undefined"!==typeof Blob&&(s.prototype=Blob.prototype,l.prototype=Blob.prototype),e.exports=n?i?Blob:l:o?s:void 0},function(e,t,r){function n(e){var r;function n(){if(n.enabled){var e=n,i=+new Date,o=i-(r||i);e.diff=o,e.prev=r,e.curr=i,r=i;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!==typeof a[0]&&a.unshift("%O");var l=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(r,n){if("%%"===r)return r;l++;var i=t.formatters[n];if("function"===typeof i){var o=a[l];r=i.call(e,o),a.splice(l,1),l--}return r}),t.formatArgs.call(e,a),(n.log||t.log||console.log.bind(console)).apply(e,a)}}return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=function(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}(e),n.destroy=i,"function"===typeof t.init&&t.init(n),t.instances.push(n),n}function i(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=n.debug=n.default=n).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var r;t.save(e),t.names=[],t.skips=[];var n=("string"===typeof e?e:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(r=0;r<t.instances.length;r++){var o=t.instances[r];o.enabled=t.enabled(o.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(110),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t,r){(function(t){var n=r(215),i=r(119);e.exports=c;var o,a=/\n/g,s=/\\n/g;function l(){}function u(){return"undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof t?t:{}}function c(e){if(n.call(this,e),this.query=this.query||{},!o){var t=u();o=t.___eio=t.___eio||[]}this.index=o.length;var r=this;o.push(function(e){r.onData(e)}),this.query.j=this.index,"function"===typeof addEventListener&&addEventListener("beforeunload",function(){r.script&&(r.script.onerror=l)},!1)}i(c,n),c.prototype.supportsBinary=!1,c.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),n.prototype.doClose.call(this)},c.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var r=document.getElementsByTagName("script")[0];r?r.parentNode.insertBefore(t,r):(document.head||document.body).appendChild(t),this.script=t,"undefined"!==typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},c.prototype.doWrite=function(e,t){var r=this;if(!this.form){var n,i=document.createElement("form"),o=document.createElement("textarea"),l=this.iframeId="eio_iframe_"+this.index;i.className="socketio",i.style.position="absolute",i.style.top="-1000px",i.style.left="-1000px",i.target=l,i.method="POST",i.setAttribute("accept-charset","utf-8"),o.name="d",i.appendChild(o),document.body.appendChild(i),this.form=i,this.area=o}function u(){c(),t()}function c(){if(r.iframe)try{r.form.removeChild(r.iframe)}catch(t){r.onError("jsonp polling iframe removal error",t)}try{var e='<iframe src="javascript:0" name="'+r.iframeId+'">';n=document.createElement(e)}catch(t){(n=document.createElement("iframe")).name=r.iframeId,n.src="javascript:0"}n.id=r.iframeId,r.form.appendChild(n),r.iframe=n}this.form.action=this.uri(),c(),e=e.replace(s,"\\\n"),this.area.value=e.replace(a,"\\n");try{this.form.submit()}catch(h){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===r.iframe.readyState&&u()}:this.iframe.onload=u}}).call(this,r(72))},function(e,t,r){(function(t){var n,i,o=r(155),a=r(83),s=r(118),l=r(119),u=r(217),c=r(120)("engine.io-client:websocket");if("undefined"!==typeof WebSocket)n=WebSocket;else if("undefined"!==typeof self)n=self.WebSocket||self.MozWebSocket;else try{i=r(481)}catch(f){}var h=n||i;function p(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=n&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(h=i),o.call(this,e)}e.exports=p,l(p,o),p.prototype.name="websocket",p.prototype.supportsBinary=!0,p.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,r={agent:this.agent,perMessageDeflate:this.perMessageDeflate};r.pfx=this.pfx,r.key=this.key,r.passphrase=this.passphrase,r.cert=this.cert,r.ca=this.ca,r.ciphers=this.ciphers,r.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(r.headers=this.extraHeaders),this.localAddress&&(r.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new h(e,t):new h(e):new h(e,t,r)}catch(n){return this.emit("error",n)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},p.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},p.prototype.write=function(e){var r=this;this.writable=!1;for(var n=e.length,i=0,o=n;i<o;i++)!function(e){a.encodePacket(e,r.supportsBinary,function(i){if(!r.usingBrowserWebSocket){var o={};if(e.options&&(o.compress=e.options.compress),r.perMessageDeflate)("string"===typeof i?t.byteLength(i):i.length)<r.perMessageDeflate.threshold&&(o.compress=!1)}try{r.usingBrowserWebSocket?r.ws.send(i):r.ws.send(i,o)}catch(f){c("websocket closed before onclose event")}--n||s()})}(e[i]);function s(){r.emit("flush"),setTimeout(function(){r.writable=!0,r.emit("drain")},0)}},p.prototype.onClose=function(){o.prototype.onClose.call(this)},p.prototype.doClose=function(){"undefined"!==typeof this.ws&&this.ws.close()},p.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",r="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(r=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=u()),this.supportsBinary||(e.b64=1),(e=s.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+r+this.path+e},p.prototype.check=function(){return!!h&&!("__initialize"in h&&this.name===p.prototype.name)}}).call(this,r(153).Buffer)},,function(e,t){e.exports=function(e,t){for(var r=[],n=(t=t||0)||0;n<e.length;n++)r[n-t]=e[n];return r}},function(e,t){function r(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=r,r.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-r:e+r}return 0|Math.min(e,this.max)},r.prototype.reset=function(){this.attempts=0},r.prototype.setMin=function(e){this.ms=e},r.prototype.setMax=function(e){this.max=e},r.prototype.setJitter=function(e){this.jitter=e}},,,function(e,t,r){},,,function(e,t,r){"use strict";r.r(t);var n=r(1),i=r(5),o=r(0),a=r.n(o),s=(r(13),r(6)),l=r(2),u=r(21),c=a.a.forwardRef(function(e,t){var r=e.children,o=e.classes,l=e.className,c=e.color,h=void 0===c?"inherit":c,p=e.component,f=void 0===p?"svg":p,d=e.fontSize,m=void 0===d?"default":d,v=e.htmlColor,g=e.titleAccess,y=e.viewBox,b=void 0===y?"0 0 24 24":y,x=Object(i.a)(e,["children","classes","className","color","component","fontSize","htmlColor","titleAccess","viewBox"]);return a.a.createElement(f,Object(n.a)({className:Object(s.a)(o.root,l,"inherit"!==h&&o["color".concat(Object(u.a)(h))],"default"!==m&&o["fontSize".concat(Object(u.a)(m))]),focusable:"false",viewBox:b,color:v,"aria-hidden":g?"false":"true",role:g?"img":"presentation",ref:t},x),r,g?a.a.createElement("title",null,g):null)});c.muiName="SvgIcon";var h=Object(l.a)(function(e){return{root:{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0,fontSize:e.typography.pxToRem(24),transition:e.transitions.create("fill",{duration:e.transitions.duration.shorter})},colorPrimary:{color:e.palette.primary.main},colorSecondary:{color:e.palette.secondary.main},colorAction:{color:e.palette.action.active},colorError:{color:e.palette.error.main},colorDisabled:{color:e.palette.action.disabled},fontSizeInherit:{fontSize:"inherit"},fontSizeSmall:{fontSize:e.typography.pxToRem(20)},fontSizeLarge:{fontSize:e.typography.pxToRem(35)}}},{name:"MuiSvgIcon"})(c);r.d(t,"default",function(){return h})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";var n=r(1),i=r(5),o=r(0),a=r.n(o),s=(r(13),r(6)),l=r(2),u=r(242),c=r(15),h=r(52),p=r(8),f=r.n(p),d="undefined"===typeof window?a.a.useEffect:a.a.useLayoutEffect,m=a.a.forwardRef(function(e,t){var r=e.alignItems,o=void 0===r?"center":r,l=e.autoFocus,p=void 0!==l&&l,m=e.button,v=void 0!==m&&m,g=e.children,y=e.classes,b=e.className,x=e.component,w=e.ContainerComponent,S=void 0===w?"li":w,M=e.ContainerProps,_=(M=void 0===M?{}:M).className,T=Object(i.a)(M,["className"]),A=e.dense,C=e.disabled,E=void 0!==C&&C,L=e.disableGutters,N=void 0!==L&&L,P=e.divider,O=void 0!==P&&P,R=e.focusVisibleClassName,D=e.selected,F=void 0!==D&&D,k=Object(i.a)(e,["alignItems","autoFocus","button","children","classes","className","component","ContainerComponent","ContainerProps","dense","disabled","disableGutters","divider","focusVisibleClassName","selected"]),I=a.a.useContext(h.a),B={dense:A||I.dense||!1,alignItems:o},U=a.a.useRef(null);d(function(){p&&U.current&&U.current.focus()},[p]);var V=a.a.Children.toArray(g),j=V.length&&Object(c.a)(V[V.length-1],["ListItemSecondaryAction"]),z=a.a.useCallback(function(e){U.current=f.a.findDOMNode(e)},[]),G=Object(c.c)(z,t),W=Object(n.a)({className:Object(s.a)(y.root,b,B.dense&&y.dense,!N&&y.gutters,O&&y.divider,E&&y.disabled,v&&y.button,"center"!==o&&y.alignItemsFlexStart,j&&y.secondaryAction,F&&y.selected),disabled:E},k),H=x||"li";return v&&(W.component=x||"div",W.focusVisibleClassName=Object(s.a)(y.focusVisible,R),H=u.a),j?(H=W.component||x?H:"div","li"===S&&("li"===H?H="div":"li"===W.component&&(W.component="div")),a.a.createElement(h.a.Provider,{value:B},a.a.createElement(S,Object(n.a)({className:Object(s.a)(y.container,_),ref:G},T),a.a.createElement(H,W,V),V.pop()))):a.a.createElement(h.a.Provider,{value:B},a.a.createElement(H,Object(n.a)({ref:G},W),V))});t.a=Object(l.a)(function(e){return{root:{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left",paddingTop:8,paddingBottom:8,"&$focusVisible":{backgroundColor:e.palette.action.selected},"&$selected, &$selected:hover":{backgroundColor:e.palette.action.selected},"&$disabled":{opacity:.5}},container:{position:"relative"},focusVisible:{},dense:{paddingTop:4,paddingBottom:4},alignItemsFlexStart:{alignItems:"flex-start"},disabled:{},divider:{borderBottom:"1px solid ".concat(e.palette.divider),backgroundClip:"padding-box"},gutters:{paddingLeft:16,paddingRight:16},button:{transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:e.palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}},secondaryAction:{paddingRight:48},selected:{}}},{name:"MuiListItem"})(m)},function(e,t,r){"use strict";var n=r(0),i=r.n(n),o=(r(13),"undefined"!==typeof window?i.a.useLayoutEffect:i.a.useEffect);t.a=function(e){var t=e.children,r=e.defer,n=void 0!==r&&r,a=e.fallback,s=void 0===a?null:a,l=i.a.useState(!1),u=l[0],c=l[1];return o(function(){n||c(!0)},[n]),i.a.useEffect(function(){n&&c(!0)},[n]),i.a.createElement(i.a.Fragment,null,u?t:s)}},function(e,t,r){"use strict";t.a=function(e){var t=e.theme,r=e.name,n=e.props;if(!t||!t.props||!t.props[r])return n;var i,o=t.props[r];for(i in o)void 0===n[i]&&(n[i]=o[i]);return n}},function(e,t,r){"use strict";var n=r(1),i=r(5),o=r(0),a=r.n(o),s=(r(13),r(6)),l=r(2),u=r(52),c=a.a.forwardRef(function(e,t){var r=e.classes,o=e.className,l=Object(i.a)(e,["classes","className"]),c=a.a.useContext(u.a);return a.a.createElement("div",Object(n.a)({className:Object(s.a)(r.root,o,"flex-start"===c.alignItems&&r.alignItemsFlexStart),ref:t},l))});t.a=Object(l.a)(function(e){return{root:{minWidth:56,color:e.palette.action.active,flexShrink:0,display:"inline-flex"},alignItemsFlexStart:{marginTop:8}}},{name:"MuiListItemIcon"})(c)},function(e,t,r){"use strict";var n=r(1),i=r(5),o=r(0),a=r.n(o),s=(r(13),r(6)),l=r(2),u=r(523),c=r(52),h=a.a.forwardRef(function(e,t){var r=e.children,o=e.classes,l=e.className,h=e.disableTypography,p=void 0!==h&&h,f=e.inset,d=void 0!==f&&f,m=e.primary,v=e.primaryTypographyProps,g=e.secondary,y=e.secondaryTypographyProps,b=Object(i.a)(e,["children","classes","className","disableTypography","inset","primary","primaryTypographyProps","secondary","secondaryTypographyProps"]),x=a.a.useContext(c.a).dense,w=null!=m?m:r;null==w||w.type===u.a||p||(w=a.a.createElement(u.a,Object(n.a)({variant:x?"body2":"body1",className:o.primary,component:"span"},v),w));var S=g;return null==S||S.type===u.a||p||(S=a.a.createElement(u.a,Object(n.a)({variant:"body2",className:o.secondary,color:"textSecondary"},y),S)),a.a.createElement("div",Object(n.a)({className:Object(s.a)(o.root,l,x&&o.dense,d&&o.inset,w&&S&&o.multiline),ref:t},b),w,S)});t.a=Object(l.a)({root:{flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4},multiline:{marginTop:6,marginBottom:6},dense:{},inset:{paddingLeft:56},primary:{},secondary:{}},{name:"MuiListItemText"})(h)},function(e,t,r){"use strict";var n=r(1),i=r(5),o=r(0),a=r.n(o),s=(r(13),r(6)),l=r(2),u=r(21),c={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p"},h=a.a.forwardRef(function(e,t){var r=e.align,o=void 0===r?"inherit":r,l=e.classes,h=e.className,p=e.color,f=void 0===p?"initial":p,d=e.component,m=e.display,v=void 0===m?"initial":m,g=e.gutterBottom,y=void 0!==g&&g,b=e.noWrap,x=void 0!==b&&b,w=e.paragraph,S=void 0!==w&&w,M=e.variant,_=void 0===M?"body1":M,T=e.variantMapping,A=void 0===T?c:T,C=Object(i.a)(e,["align","classes","className","color","component","display","gutterBottom","noWrap","paragraph","variant","variantMapping"]),E=d||(S?"p":A[_]||c[_])||"span";return a.a.createElement(E,Object(n.a)({className:Object(s.a)(l.root,h,"inherit"!==_&&l[_],"initial"!==f&&l["color".concat(Object(u.a)(f))],x&&l.noWrap,y&&l.gutterBottom,S&&l.paragraph,"inherit"!==o&&l["align".concat(Object(u.a)(o))],"initial"!==v&&l["display".concat(Object(u.a)(v))]),ref:t},C))});t.a=Object(l.a)(function(e){return{root:{margin:0},body2:e.typography.body2,body1:e.typography.body1,caption:e.typography.caption,button:e.typography.button,h1:e.typography.h1,h2:e.typography.h2,h3:e.typography.h3,h4:e.typography.h4,h5:e.typography.h5,h6:e.typography.h6,subtitle1:e.typography.subtitle1,subtitle2:e.typography.subtitle2,overline:e.typography.overline,srOnly:{position:"absolute",height:1,width:1,overflow:"hidden"},alignLeft:{textAlign:"left"},alignCenter:{textAlign:"center"},alignRight:{textAlign:"right"},alignJustify:{textAlign:"justify"},noWrap:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},gutterBottom:{marginBottom:"0.35em"},paragraph:{marginBottom:16},colorInherit:{color:"inherit"},colorPrimary:{color:e.palette.primary.main},colorSecondary:{color:e.palette.secondary.main},colorTextPrimary:{color:e.palette.text.primary},colorTextSecondary:{color:e.palette.text.secondary},colorError:{color:e.palette.error.main},displayInline:{display:"inline"},displayBlock:{display:"block"}}},{name:"MuiTypography"})(h)},function(e,t,r){"use strict";var n=r(1),i=r(5),o=r(0),a=r.n(o),s=(r(13),r(6)),l=r(2),u=r(21);function c(e){var t,r,n;return t=e,r=0,n=1,e=(Math.min(Math.max(r,t),n)-r)/(n-r),e=(e-=1)*e*e+1}var h=a.a.forwardRef(function(e,t){var r,o=e.classes,l=e.className,h=e.color,p=void 0===h?"primary":h,f=e.disableShrink,d=void 0!==f&&f,m=e.size,v=void 0===m?40:m,g=e.style,y=e.thickness,b=void 0===y?3.6:y,x=e.value,w=void 0===x?0:x,S=e.variant,M=void 0===S?"indeterminate":S,_=Object(i.a)(e,["classes","className","color","disableShrink","size","style","thickness","value","variant"]),T={},A={},C={};if("determinate"===M||"static"===M){var E=2*Math.PI*((44-b)/2);T.strokeDasharray=E.toFixed(3),C["aria-valuenow"]=Math.round(w),"static"===M?(T.strokeDashoffset="".concat(((100-w)/100*E).toFixed(3),"px"),A.transform="rotate(-90deg)"):(T.strokeDashoffset="".concat((r=(100-w)/100,r*r*E).toFixed(3),"px"),A.transform="rotate(".concat((270*c(w/70)).toFixed(3),"deg)"))}return a.a.createElement("div",Object(n.a)({className:Object(s.a)(o.root,l,"inherit"!==p&&o["color".concat(Object(u.a)(p))],{indeterminate:o.indeterminate,static:o.static}[M]),style:Object(n.a)({width:v,height:v},A,{},g),ref:t,role:"progressbar"},C,_),a.a.createElement("svg",{className:o.svg,viewBox:"".concat(22," ").concat(22," ").concat(44," ").concat(44)},a.a.createElement("circle",{className:Object(s.a)(o.circle,d&&o.circleDisableShrink,{indeterminate:o.circleIndeterminate,static:o.circleStatic}[M]),style:T,cx:44,cy:44,r:(44-b)/2,fill:"none",strokeWidth:b})))});t.a=Object(l.a)(function(e){return{root:{display:"inline-block"},static:{transition:e.transitions.create("transform")},indeterminate:{animation:"$circular-rotate 1.4s linear infinite"},colorPrimary:{color:e.palette.primary.main},colorSecondary:{color:e.palette.secondary.main},svg:{display:"block"},circle:{stroke:"currentColor"},circleStatic:{transition:e.transitions.create("stroke-dashoffset")},circleIndeterminate:{animation:"$circular-dash 1.4s ease-in-out infinite",strokeDasharray:"80px, 200px",strokeDashoffset:"0px"},"@keyframes circular-rotate":{"100%":{transform:"rotate(360deg)"}},"@keyframes circular-dash":{"0%":{strokeDasharray:"1px, 200px",strokeDashoffset:"0px"},"50%":{strokeDasharray:"100px, 200px",strokeDashoffset:"-15px"},"100%":{strokeDasharray:"100px, 200px",strokeDashoffset:"-125px"}},circleDisableShrink:{animation:"none"}}},{name:"MuiCircularProgress",flip:!1})(h)},function(e,t,r){"use strict";var n=r(5),i=r(1),o=r(0),a=r.n(o),s=(r(13),r(6)),l=r(2),u=r(34),c=r(242),h=r(21),p=a.a.forwardRef(function(e,t){var r=e.children,o=e.classes,l=e.className,u=e.color,p=void 0===u?"default":u,f=e.component,d=void 0===f?"button":f,m=e.disabled,v=void 0!==m&&m,g=e.disableFocusRipple,y=void 0!==g&&g,b=e.focusVisibleClassName,x=e.fullWidth,w=void 0!==x&&x,S=e.size,M=void 0===S?"medium":S,_=e.type,T=void 0===_?"button":_,A=e.variant,C=void 0===A?"text":A,E=Object(n.a)(e,["children","classes","className","color","component","disabled","disableFocusRipple","focusVisibleClassName","fullWidth","size","type","variant"]),L="text"===C,N="outlined"===C,P="contained"===C,O="primary"===p,R="secondary"===p,D=Object(s.a)(o.root,l,L&&[o.text,O&&o.textPrimary,R&&o.textSecondary],N&&[o.outlined,O&&o.outlinedPrimary,R&&o.outlinedSecondary],P&&[o.contained,O&&o.containedPrimary,R&&o.containedSecondary],"medium"!==M&&o["size".concat(Object(h.a)(M))],v&&o.disabled,w&&o.fullWidth,{inherit:o.colorInherit}[p]);return a.a.createElement(c.a,Object(i.a)({className:D,component:d,disabled:v,focusRipple:!y,focusVisibleClassName:Object(s.a)(o.focusVisible,b),ref:t,type:T},E),a.a.createElement("span",{className:o.label},r))});t.a=Object(l.a)(function(e){return{root:Object(i.a)({},e.typography.button,{boxSizing:"border-box",minWidth:64,padding:"6px 16px",borderRadius:e.shape.borderRadius,color:e.palette.text.primary,transition:e.transitions.create(["background-color","box-shadow","border"],{duration:e.transitions.duration.short}),"&:hover":{textDecoration:"none",backgroundColor:Object(u.c)(e.palette.text.primary,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"},"&$disabled":{backgroundColor:"transparent"}},"&$disabled":{color:e.palette.action.disabled}}),label:{width:"100%",display:"inherit",alignItems:"inherit",justifyContent:"inherit"},text:{padding:"6px 8px"},textPrimary:{color:e.palette.primary.main,"&:hover":{backgroundColor:Object(u.c)(e.palette.primary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},textSecondary:{color:e.palette.secondary.main,"&:hover":{backgroundColor:Object(u.c)(e.palette.secondary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},outlined:{padding:"5px 16px",border:"1px solid ".concat("light"===e.palette.type?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"),"&$disabled":{border:"1px solid ".concat(e.palette.action.disabled)}},outlinedPrimary:{color:e.palette.primary.main,border:"1px solid ".concat(Object(u.c)(e.palette.primary.main,.5)),"&:hover":{border:"1px solid ".concat(e.palette.primary.main),backgroundColor:Object(u.c)(e.palette.primary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},outlinedSecondary:{color:e.palette.secondary.main,border:"1px solid ".concat(Object(u.c)(e.palette.secondary.main,.5)),"&:hover":{border:"1px solid ".concat(e.palette.secondary.main),backgroundColor:Object(u.c)(e.palette.secondary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"&$disabled":{border:"1px solid ".concat(e.palette.action.disabled)}},contained:{color:e.palette.getContrastText(e.palette.grey[300]),backgroundColor:e.palette.grey[300],boxShadow:e.shadows[2],"&$focusVisible":{boxShadow:e.shadows[6]},"&:active":{boxShadow:e.shadows[8]},"&$disabled":{color:e.palette.action.disabled,boxShadow:e.shadows[0],backgroundColor:e.palette.action.disabledBackground},"&:hover":{backgroundColor:e.palette.grey.A100,"@media (hover: none)":{backgroundColor:e.palette.grey[300]},"&$disabled":{backgroundColor:e.palette.action.disabledBackground}}},containedPrimary:{color:e.palette.primary.contrastText,backgroundColor:e.palette.primary.main,"&:hover":{backgroundColor:e.palette.primary.dark,"@media (hover: none)":{backgroundColor:e.palette.primary.main}}},containedSecondary:{color:e.palette.secondary.contrastText,backgroundColor:e.palette.secondary.main,"&:hover":{backgroundColor:e.palette.secondary.dark,"@media (hover: none)":{backgroundColor:e.palette.secondary.main}}},focusVisible:{},disabled:{},colorInherit:{color:"inherit",borderColor:"currentColor"},sizeSmall:{padding:"4px 8px",fontSize:e.typography.pxToRem(13)},sizeLarge:{padding:"8px 24px",fontSize:e.typography.pxToRem(15)},fullWidth:{width:"100%"}}},{name:"MuiButton"})(p)},function(e,t,r){"use strict";var n=r(1),i=r(5),o=r(0),a=r.n(o),s=(r(13),r(6)),l=r(2),u=r(52),c=a.a.forwardRef(function(e,t){var r=e.children,o=e.classes,l=e.className,c=e.component,h=void 0===c?"ul":c,p=e.dense,f=void 0!==p&&p,d=e.disablePadding,m=void 0!==d&&d,v=e.subheader,g=Object(i.a)(e,["children","classes","className","component","dense","disablePadding","subheader"]),y=a.a.useMemo(function(){return{dense:f}},[f]);return a.a.createElement(u.a.Provider,{value:y},a.a.createElement(h,Object(n.a)({className:Object(s.a)(o.root,l,f&&o.dense,!m&&o.padding,v&&o.subheader),ref:t},g),v,r))});t.a=Object(l.a)({root:{listStyle:"none",margin:0,padding:0,position:"relative"},padding:{paddingTop:8,paddingBottom:8},dense:{},subheader:{paddingTop:0}},{name:"MuiList"})(c)},function(e,t,r){"use strict";var n=r(1),i=r(5),o=r(0),a=r.n(o),s=(r(13),r(6)),l=r(2),u=r(21),c=a.a.forwardRef(function(e,t){var r=e.classes,o=e.className,l=e.color,c=void 0===l?"default":l,h=e.component,p=void 0===h?"li":h,f=e.disableGutters,d=void 0!==f&&f,m=e.disableSticky,v=void 0!==m&&m,g=e.inset,y=void 0!==g&&g,b=Object(i.a)(e,["classes","className","color","component","disableGutters","disableSticky","inset"]);return a.a.createElement(p,Object(n.a)({className:Object(s.a)(r.root,o,"default"!==c&&r["color".concat(Object(u.a)(c))],y&&r.inset,!v&&r.sticky,!d&&r.gutters),ref:t},b))});t.a=Object(l.a)(function(e){return{root:{boxSizing:"border-box",lineHeight:"48px",listStyle:"none",color:e.palette.text.secondary,fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(14)},colorPrimary:{color:e.palette.primary.main},colorInherit:{color:"inherit"},gutters:{paddingLeft:16,paddingRight:16},inset:{paddingLeft:72},sticky:{position:"sticky",top:0,zIndex:1,backgroundColor:"inherit"}}},{name:"MuiListSubheader"})(c)},function(e,t,r){"use strict";var n=r(5),i=r(1),o=r(0),a=r.n(o),s=(r(13),r(6)),l=r(2),u=a.a.forwardRef(function(e,t){var r=e.classes,o=e.className,l=e.component,u=void 0===l?"div":l,c=e.square,h=void 0!==c&&c,p=e.elevation,f=void 0===p?1:p,d=Object(n.a)(e,["classes","className","component","square","elevation"]);var m=Object(s.a)(r.root,r["elevation".concat(f)],o,!h&&r.rounded);return a.a.createElement(u,Object(i.a)({className:m,ref:t},d))});t.a=Object(l.a)(function(e){var t={};return e.shadows.forEach(function(e,r){t["elevation".concat(r)]={boxShadow:e}}),Object(i.a)({root:{backgroundColor:e.palette.background.paper,color:e.palette.text.primary,transition:e.transitions.create("box-shadow")},rounded:{borderRadius:e.shape.borderRadius}},t)},{name:"MuiPaper"})(u)},function(e,t,r){"use strict";var n=r(1),i=r(5),o=r(0),a=r.n(o),s=(r(13),r(537)),l=r(26),u=r(51),c=r(33),h=r(15),p={entering:{opacity:1},entered:{opacity:1}},f={enter:l.b.enteringScreen,exit:l.b.leavingScreen},d=a.a.forwardRef(function(e,t){var r=e.children,o=e.in,l=e.onEnter,d=e.onExit,m=e.style,v=e.timeout,g=void 0===v?f:v,y=Object(i.a)(e,["children","in","onEnter","onExit","style","timeout"]),b=Object(u.a)(),x=Object(h.c)(r.ref,t);return a.a.createElement(s.a,Object(n.a)({appear:!0,in:o,onEnter:function(e,t){Object(c.b)(e);var r=Object(c.a)({style:m,timeout:g},{mode:"enter"});e.style.webkitTransition=b.transitions.create("opacity",r),e.style.transition=b.transitions.create("opacity",r),l&&l(e,t)},onExit:function(e){var t=Object(c.a)({style:m,timeout:g},{mode:"exit"});e.style.webkitTransition=b.transitions.create("opacity",t),e.style.transition=b.transitions.create("opacity",t),d&&d(e)},timeout:g},y),function(e,t){return a.a.cloneElement(r,Object(n.a)({style:Object(n.a)({opacity:0,visibility:"exited"!==e||o?void 0:"hidden"},p[e],{},m,{},r.props.style),ref:x},t))})});t.a=d},function(e,t,r){"use strict";var n=r(5),i=r(1),o=r(0),a=r.n(o),s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l="object"===("undefined"===typeof window?"undefined":s(window))&&"object"===("undefined"===typeof document?"undefined":s(document))&&9===document.nodeType;var u=r(89),c=r(57),h=r(88),p=r(9),f={}.constructor;function d(e){if(null==e||"object"!==typeof e)return e;if(Array.isArray(e))return e.map(d);if(e.constructor!==f)return e;var t={};for(var r in e)t[r]=d(e[r]);return t}function m(e,t,r){void 0===e&&(e="unnamed");var n=r.jss,i=d(t),o=n.plugins.onCreateRule(e,i,r);return o||(e[0],null)}var v=function(e,t){for(var r="",n=0;n<e.length&&"!important"!==e[n];n++)r&&(r+=t),r+=e[n];return r};function g(e,t){if(void 0===t&&(t=!1),!Array.isArray(e))return e;var r="";if(Array.isArray(e[0]))for(var n=0;n<e.length&&"!important"!==e[n];n++)r&&(r+=", "),r+=v(e[n]," ");else r=v(e,", ");return t||"!important"!==e[e.length-1]||(r+=" !important"),r}function y(e,t){for(var r="",n=0;n<t;n++)r+="  ";return r+e}function b(e,t,r){void 0===r&&(r={});var n="";if(!t)return n;var i=r.indent,o=void 0===i?0:i,a=t.fallbacks;if(e&&o++,a)if(Array.isArray(a))for(var s=0;s<a.length;s++){var l=a[s];for(var u in l){var c=l[u];null!=c&&(n&&(n+="\n"),n+=""+y(u+": "+g(c)+";",o))}}else for(var h in a){var p=a[h];null!=p&&(n&&(n+="\n"),n+=""+y(h+": "+g(p)+";",o))}for(var f in t){var d=t[f];null!=d&&"fallbacks"!==f&&(n&&(n+="\n"),n+=""+y(f+": "+g(d)+";",o))}return(n||r.allowEmpty)&&e?(n&&(n="\n"+n+"\n"),y(e+" {"+n,--o)+y("}",o)):n}var x=/([[\].#*$><+~=|^:(),"'`\s])/g,w="undefined"!==typeof CSS&&CSS.escape,S=function(e){return w?w(e):e.replace(x,"\\$1")},M=function(){function e(e,t,r){this.type="style",this.key=void 0,this.isProcessed=!1,this.style=void 0,this.renderer=void 0,this.renderable=void 0,this.options=void 0;var n=r.sheet,i=r.Renderer;this.key=e,this.options=r,this.style=t,n?this.renderer=n.renderer:i&&(this.renderer=new i)}return e.prototype.prop=function(e,t,r){if(void 0===t)return this.style[e];var n=!!r&&r.force;if(!n&&this.style[e]===t)return this;var i=t;r&&!1===r.process||(i=this.options.jss.plugins.onChangeValue(t,e,this));var o=null==i||!1===i,a=e in this.style;if(o&&!a&&!n)return this;var s=o&&a;if(s?delete this.style[e]:this.style[e]=i,this.renderable&&this.renderer)return s?this.renderer.removeProperty(this.renderable,e):this.renderer.setProperty(this.renderable,e,i),this;var l=this.options.sheet;return l&&l.attached,this},e}(),_=function(e){function t(t,r,n){var i;(i=e.call(this,t,r,n)||this).selectorText=void 0,i.id=void 0,i.renderable=void 0;var o=n.selector,a=n.scoped,s=n.sheet,l=n.generateId;return o?i.selectorText=o:!1!==a&&(i.id=l(Object(h.a)(Object(h.a)(i)),s),i.selectorText="."+S(i.id)),i}Object(c.a)(t,e);var r=t.prototype;return r.applyTo=function(e){var t=this.renderer;if(t){var r=this.toJSON();for(var n in r)t.setProperty(e,n,r[n])}return this},r.toJSON=function(){var e={};for(var t in this.style){var r=this.style[t];"object"!==typeof r?e[t]=r:Array.isArray(r)&&(e[t]=g(r))}return e},r.toString=function(e){var t=this.options.sheet,r=!!t&&t.options.link?Object(i.a)({},e,{allowEmpty:!0}):e;return b(this.selectorText,this.style,r)},Object(u.a)(t,[{key:"selector",set:function(e){if(e!==this.selectorText){this.selectorText=e;var t=this.renderer,r=this.renderable;if(r&&t)t.setSelector(r,e)||t.replaceRule(r,this)}},get:function(){return this.selectorText}}]),t}(M),T={onCreateRule:function(e,t,r){return"@"===e[0]||r.parent&&"keyframes"===r.parent.type?null:new _(e,t,r)}},A={indent:1,children:!0},C=/@([\w-]+)/,E=function(){function e(e,t,r){this.type="conditional",this.at=void 0,this.key=void 0,this.rules=void 0,this.options=void 0,this.isProcessed=!1,this.renderable=void 0,this.key=e;var n=e.match(C);for(var o in this.at=n?n[1]:"unknown",this.options=r,this.rules=new Q(Object(i.a)({},r,{parent:this})),t)this.rules.add(o,t[o]);this.rules.process()}var t=e.prototype;return t.getRule=function(e){return this.rules.get(e)},t.indexOf=function(e){return this.rules.indexOf(e)},t.addRule=function(e,t,r){var n=this.rules.add(e,t,r);return n?(this.options.jss.plugins.onProcessRule(n),n):null},t.toString=function(e){if(void 0===e&&(e=A),null==e.indent&&(e.indent=A.indent),null==e.children&&(e.children=A.children),!1===e.children)return this.key+" {}";var t=this.rules.toString(e);return t?this.key+" {\n"+t+"\n}":""},e}(),L=/@media|@supports\s+/,N={onCreateRule:function(e,t,r){return L.test(e)?new E(e,t,r):null}},P={indent:1,children:!0},O=/@keyframes\s+([\w-]+)/,R=function(){function e(e,t,r){this.type="keyframes",this.at="@keyframes",this.key=void 0,this.name=void 0,this.id=void 0,this.rules=void 0,this.options=void 0,this.isProcessed=!1,this.renderable=void 0;var n=e.match(O);n&&n[1]?this.name=n[1]:this.name="noname",this.key=this.type+"-"+this.name,this.options=r;var o=r.scoped,a=r.sheet,s=r.generateId;for(var l in this.id=!1===o?this.name:S(s(this,a)),this.rules=new Q(Object(i.a)({},r,{parent:this})),t)this.rules.add(l,t[l],Object(i.a)({},r,{parent:this}));this.rules.process()}return e.prototype.toString=function(e){if(void 0===e&&(e=P),null==e.indent&&(e.indent=P.indent),null==e.children&&(e.children=P.children),!1===e.children)return this.at+" "+this.id+" {}";var t=this.rules.toString(e);return t&&(t="\n"+t+"\n"),this.at+" "+this.id+" {"+t+"}"},e}(),D=/@keyframes\s+/,F=/\$([\w-]+)/g,k=function(e,t){return"string"===typeof e?e.replace(F,function(e,r){return r in t?t[r]:e}):e},I=function(e,t,r){var n=e[t],i=k(n,r);i!==n&&(e[t]=i)},B={onCreateRule:function(e,t,r){return"string"===typeof e&&D.test(e)?new R(e,t,r):null},onProcessStyle:function(e,t,r){return"style"===t.type&&r?("animation-name"in e&&I(e,"animation-name",r.keyframes),"animation"in e&&I(e,"animation",r.keyframes),e):e},onChangeValue:function(e,t,r){var n=r.options.sheet;if(!n)return e;switch(t){case"animation":case"animation-name":return k(e,n.keyframes);default:return e}}},U=function(e){function t(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(t=e.call.apply(e,[this].concat(n))||this).renderable=void 0,t}return Object(c.a)(t,e),t.prototype.toString=function(e){var t=this.options.sheet,r=!!t&&t.options.link?Object(i.a)({},e,{allowEmpty:!0}):e;return b(this.key,this.style,r)},t}(M),V={onCreateRule:function(e,t,r){return r.parent&&"keyframes"===r.parent.type?new U(e,t,r):null}},j=function(){function e(e,t,r){this.type="font-face",this.at="@font-face",this.key=void 0,this.style=void 0,this.options=void 0,this.isProcessed=!1,this.renderable=void 0,this.key=e,this.style=t,this.options=r}return e.prototype.toString=function(e){if(Array.isArray(this.style)){for(var t="",r=0;r<this.style.length;r++)t+=b(this.key,this.style[r]),this.style[r+1]&&(t+="\n");return t}return b(this.key,this.style,e)},e}(),z={onCreateRule:function(e,t,r){return"@font-face"===e?new j(e,t,r):null}},G=function(){function e(e,t,r){this.type="viewport",this.at="@viewport",this.key=void 0,this.style=void 0,this.options=void 0,this.isProcessed=!1,this.renderable=void 0,this.key=e,this.style=t,this.options=r}return e.prototype.toString=function(e){return b(this.key,this.style,e)},e}(),W={onCreateRule:function(e,t,r){return"@viewport"===e||"@-ms-viewport"===e?new G(e,t,r):null}},H=function(){function e(e,t,r){this.type="simple",this.key=void 0,this.value=void 0,this.options=void 0,this.isProcessed=!1,this.renderable=void 0,this.key=e,this.value=t,this.options=r}return e.prototype.toString=function(e){if(Array.isArray(this.value)){for(var t="",r=0;r<this.value.length;r++)t+=this.key+" "+this.value[r]+";",this.value[r+1]&&(t+="\n");return t}return this.key+" "+this.value+";"},e}(),X={"@charset":!0,"@import":!0,"@namespace":!0},q=[T,N,B,V,z,W,{onCreateRule:function(e,t,r){return e in X?new H(e,t,r):null}}],Y={process:!0},K={force:!0,process:!0},Q=function(){function e(e){this.map={},this.raw={},this.index=[],this.options=void 0,this.classes=void 0,this.keyframes=void 0,this.options=e,this.classes=e.classes,this.keyframes=e.keyframes}var t=e.prototype;return t.add=function(e,t,r){var n=this.options,o=n.parent,a=n.sheet,s=n.jss,l=n.Renderer,u=n.generateId,c=n.scoped,h=Object(i.a)({classes:this.classes,parent:o,sheet:a,jss:s,Renderer:l,generateId:u,scoped:c},r);this.raw[e]=t,e in this.classes&&(h.selector="."+S(this.classes[e]));var p=m(e,t,h);if(!p)return null;this.register(p);var f=void 0===h.index?this.index.length:h.index;return this.index.splice(f,0,p),p},t.get=function(e){return this.map[e]},t.remove=function(e){this.unregister(e),delete this.raw[e.key],this.index.splice(this.indexOf(e),1)},t.indexOf=function(e){return this.index.indexOf(e)},t.process=function(){var e=this.options.jss.plugins;this.index.slice(0).forEach(e.onProcessRule,e)},t.register=function(e){this.map[e.key]=e,e instanceof _?(this.map[e.selector]=e,e.id&&(this.classes[e.key]=e.id)):e instanceof R&&this.keyframes&&(this.keyframes[e.name]=e.id)},t.unregister=function(e){delete this.map[e.key],e instanceof _?(delete this.map[e.selector],delete this.classes[e.key]):e instanceof R&&delete this.keyframes[e.name]},t.update=function(){var e,t,r;if("string"===typeof(arguments.length<=0?void 0:arguments[0])?(e=arguments.length<=0?void 0:arguments[0],t=arguments.length<=1?void 0:arguments[1],r=arguments.length<=2?void 0:arguments[2]):(t=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1],e=null),e)this.onUpdate(t,this.get(e),r);else for(var n=0;n<this.index.length;n++)this.onUpdate(t,this.index[n],r)},t.onUpdate=function(t,r,n){void 0===n&&(n=Y);var i=this.options,o=i.jss.plugins,a=i.sheet;if(r.rules instanceof e)r.rules.update(t,n);else{var s=r,l=s.style;if(o.onUpdate(t,r,a,n),n.process&&l&&l!==s.style){for(var u in o.onProcessStyle(s.style,s,a),s.style){var c=s.style[u];c!==l[u]&&s.prop(u,c,K)}for(var h in l){var p=s.style[h],f=l[h];null==p&&p!==f&&s.prop(h,null,K)}}}},t.toString=function(e){for(var t="",r=this.options.sheet,n=!!r&&r.options.link,i=0;i<this.index.length;i++){var o=this.index[i].toString(e);(o||n)&&(t&&(t+="\n"),t+=o)}return t},e}(),J=function(){function e(e,t){for(var r in this.options=void 0,this.deployed=void 0,this.attached=void 0,this.rules=void 0,this.renderer=void 0,this.classes=void 0,this.keyframes=void 0,this.queue=void 0,this.attached=!1,this.deployed=!1,this.classes={},this.keyframes={},this.options=Object(i.a)({},t,{sheet:this,parent:this,classes:this.classes,keyframes:this.keyframes}),t.Renderer&&(this.renderer=new t.Renderer(this)),this.rules=new Q(this.options),e)this.rules.add(r,e[r]);this.rules.process()}var t=e.prototype;return t.attach=function(){return this.attached?this:(this.renderer&&this.renderer.attach(),this.attached=!0,this.deployed||this.deploy(),this)},t.detach=function(){return this.attached?(this.renderer&&this.renderer.detach(),this.attached=!1,this):this},t.addRule=function(e,t,r){var n=this.queue;this.attached&&!n&&(this.queue=[]);var i=this.rules.add(e,t,r);return i?(this.options.jss.plugins.onProcessRule(i),this.attached?this.deployed?(n?n.push(i):(this.insertRule(i),this.queue&&(this.queue.forEach(this.insertRule,this),this.queue=void 0)),i):i:(this.deployed=!1,i)):null},t.insertRule=function(e){this.renderer&&this.renderer.insertRule(e)},t.addRules=function(e,t){var r=[];for(var n in e){var i=this.addRule(n,e[n],t);i&&r.push(i)}return r},t.getRule=function(e){return this.rules.get(e)},t.deleteRule=function(e){var t=this.rules.get(e);return!!t&&(this.rules.remove(t),!(this.attached&&t.renderable&&this.renderer)||this.renderer.deleteRule(t.renderable))},t.indexOf=function(e){return this.rules.indexOf(e)},t.deploy=function(){return this.renderer&&this.renderer.deploy(),this.deployed=!0,this},t.update=function(){var e;return(e=this.rules).update.apply(e,arguments),this},t.toString=function(e){return this.rules.toString(e)},e}(),Z=function(){function e(){this.plugins={internal:[],external:[]},this.registry=void 0}var t=e.prototype;return t.onCreateRule=function(e,t,r){for(var n=0;n<this.registry.onCreateRule.length;n++){var i=this.registry.onCreateRule[n](e,t,r);if(i)return i}return null},t.onProcessRule=function(e){if(!e.isProcessed){for(var t=e.options.sheet,r=0;r<this.registry.onProcessRule.length;r++)this.registry.onProcessRule[r](e,t);e.style&&this.onProcessStyle(e.style,e,t),e.isProcessed=!0}},t.onProcessStyle=function(e,t,r){for(var n=0;n<this.registry.onProcessStyle.length;n++)t.style=this.registry.onProcessStyle[n](t.style,t,r)},t.onProcessSheet=function(e){for(var t=0;t<this.registry.onProcessSheet.length;t++)this.registry.onProcessSheet[t](e)},t.onUpdate=function(e,t,r,n){for(var i=0;i<this.registry.onUpdate.length;i++)this.registry.onUpdate[i](e,t,r,n)},t.onChangeValue=function(e,t,r){for(var n=e,i=0;i<this.registry.onChangeValue.length;i++)n=this.registry.onChangeValue[i](n,t,r);return n},t.use=function(e,t){void 0===t&&(t={queue:"external"});var r=this.plugins[t.queue];-1===r.indexOf(e)&&(r.push(e),this.registry=[].concat(this.plugins.external,this.plugins.internal).reduce(function(e,t){for(var r in t)r in e&&e[r].push(t[r]);return e},{onCreateRule:[],onProcessRule:[],onProcessStyle:[],onProcessSheet:[],onChangeValue:[],onUpdate:[]}))},e}(),$=new(function(){function e(){this.registry=[]}var t=e.prototype;return t.add=function(e){var t=this.registry,r=e.options.index;if(-1===t.indexOf(e))if(0===t.length||r>=this.index)t.push(e);else for(var n=0;n<t.length;n++)if(t[n].options.index>r)return void t.splice(n,0,e)},t.reset=function(){this.registry=[]},t.remove=function(e){var t=this.registry.indexOf(e);this.registry.splice(t,1)},t.toString=function(e){for(var t=void 0===e?{}:e,r=t.attached,n=Object(p.a)(t,["attached"]),i="",o=0;o<this.registry.length;o++){var a=this.registry[o];null!=r&&a.attached!==r||(i&&(i+="\n"),i+=a.toString(n))}return i},Object(u.a)(e,[{key:"index",get:function(){return 0===this.registry.length?0:this.registry[this.registry.length-1].options.index}}]),e}()),ee="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),te="2f1acc6c3a606b082e5eef5e54414ffb";null==ee[te]&&(ee[te]=0);var re=ee[te]++,ne=function(e){void 0===e&&(e={});var t=0;return function(r,n){t+=1;var i="",o="";return n&&(n.options.classNamePrefix&&(o=n.options.classNamePrefix),null!=n.options.jss.id&&(i=String(n.options.jss.id))),e.minify?""+(o||"c")+re+i+t:o+r.key+"-"+re+(i?"-"+i:"")+"-"+t}},ie=function(e){var t;return function(){return t||(t=e()),t}};function oe(e,t){try{return e.attributeStyleMap?e.attributeStyleMap.get(t):e.style.getPropertyValue(t)}catch(r){return""}}function ae(e,t,r){try{var n=r;if(Array.isArray(r)&&(n=g(r,!0),"!important"===r[r.length-1]))return e.style.setProperty(t,n,"important"),!0;e.attributeStyleMap?e.attributeStyleMap.set(t,n):e.style.setProperty(t,n)}catch(i){return!1}return!0}function se(e,t){try{e.attributeStyleMap?e.attributeStyleMap.delete(t):e.style.removeProperty(t)}catch(r){}}function le(e,t){return e.selectorText=t,e.selectorText===t}var ue=ie(function(){return document.querySelector("head")});function ce(e){var t=$.registry;if(t.length>0){var r=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n.attached&&n.options.index>t.index&&n.options.insertionPoint===t.insertionPoint)return n}return null}(t,e);if(r&&r.renderer)return{parent:r.renderer.element.parentNode,node:r.renderer.element};if((r=function(e,t){for(var r=e.length-1;r>=0;r--){var n=e[r];if(n.attached&&n.options.insertionPoint===t.insertionPoint)return n}return null}(t,e))&&r.renderer)return{parent:r.renderer.element.parentNode,node:r.renderer.element.nextSibling}}var n=e.insertionPoint;if(n&&"string"===typeof n){var i=function(e){for(var t=ue(),r=0;r<t.childNodes.length;r++){var n=t.childNodes[r];if(8===n.nodeType&&n.nodeValue.trim()===e)return n}return null}(n);if(i)return{parent:i.parentNode,node:i.nextSibling}}return!1}var he=ie(function(){var e=document.querySelector('meta[property="csp-nonce"]');return e?e.getAttribute("content"):null}),pe=function(e,t,r){var n=e.cssRules.length;(void 0===r||r>n)&&(r=n);try{if("insertRule"in e)e.insertRule(t,r);else if("appendRule"in e){e.appendRule(t)}}catch(i){return!1}return e.cssRules[r]},fe=function(){var e=document.createElement("style");return e.textContent="\n",e},de=function(){function e(e){this.getPropertyValue=oe,this.setProperty=ae,this.removeProperty=se,this.setSelector=le,this.element=void 0,this.sheet=void 0,this.hasInsertedRules=!1,e&&$.add(e),this.sheet=e;var t=this.sheet?this.sheet.options:{},r=t.media,n=t.meta,i=t.element;this.element=i||fe(),this.element.setAttribute("data-jss",""),r&&this.element.setAttribute("media",r),n&&this.element.setAttribute("data-meta",n);var o=he();o&&this.element.setAttribute("nonce",o)}var t=e.prototype;return t.attach=function(){!this.element.parentNode&&this.sheet&&(!function(e,t){var r=t.insertionPoint,n=ce(t);if(!1!==n&&n.parent)n.parent.insertBefore(e,n.node);else if(r&&"number"===typeof r.nodeType){var i=r,o=i.parentNode;o&&o.insertBefore(e,i.nextSibling)}else ue().appendChild(e)}(this.element,this.sheet.options),!this.hasInsertedRules||this.sheet&&!this.sheet.deployed||(this.hasInsertedRules=!1,this.deploy()))},t.detach=function(){var e=this.element.parentNode;e&&e.removeChild(this.element)},t.deploy=function(){var e=this.sheet;e&&(e.options.link?this.insertRules(e.rules):this.element.textContent="\n"+e.toString()+"\n")},t.insertRules=function(e,t){for(var r=0;r<e.index.length;r++)this.insertRule(e.index[r],r,t)},t.insertRule=function(e,t,r){if(void 0===r&&(r=this.element.sheet),e.rules){var n=e,i=r;return("conditional"!==e.type&&"keyframes"!==e.type||!1!==(i=pe(r,n.toString({children:!1}),t)))&&(this.insertRules(n.rules,i),i)}var o=e.toString();if(!o)return!1;var a=pe(r,o,t);return!1!==a&&(this.hasInsertedRules=!0,e.renderable=a,a)},t.deleteRule=function(e){var t=this.element.sheet,r=this.indexOf(e);return-1!==r&&(t.deleteRule(r),!0)},t.indexOf=function(e){for(var t=this.element.sheet.cssRules,r=0;r<t.length;r++)if(e===t[r])return r;return-1},t.replaceRule=function(e,t){var r=this.indexOf(e);return-1!==r&&(this.element.sheet.deleteRule(r),this.insertRule(t,r))},t.getRules=function(){return this.element.sheet.cssRules},e}(),me=0,ve=function(){function e(e){this.id=me++,this.version="10.0.0-alpha.25",this.plugins=new Z,this.options={id:{minify:!1},createGenerateId:ne,Renderer:l?de:null,plugins:[]},this.generateId=ne({minify:!1});for(var t=0;t<q.length;t++)this.plugins.use(q[t],{queue:"internal"});this.setup(e)}var t=e.prototype;return t.setup=function(e){return void 0===e&&(e={}),e.createGenerateId&&(this.options.createGenerateId=e.createGenerateId),e.id&&(this.options.id=Object(i.a)({},this.options.id,e.id)),(e.createGenerateId||e.id)&&(this.generateId=this.options.createGenerateId(this.options.id)),null!=e.insertionPoint&&(this.options.insertionPoint=e.insertionPoint),"Renderer"in e&&(this.options.Renderer=e.Renderer),e.plugins&&this.use.apply(this,e.plugins),this},t.createStyleSheet=function(e,t){void 0===t&&(t={});var r=t.index;"number"!==typeof r&&(r=0===$.index?0:$.index+1);var n=new J(e,Object(i.a)({},t,{jss:this,generateId:t.generateId||this.generateId,insertionPoint:this.options.insertionPoint,Renderer:this.options.Renderer,index:r}));return this.plugins.onProcessSheet(n),n},t.removeStyleSheet=function(e){return e.detach(),$.remove(e),this},t.createRule=function(e,t,r){if(void 0===t&&(t={}),void 0===r&&(r={}),"object"===typeof e)return this.createRule(void 0,e,t);var n=Object(i.a)({},r,{jss:this,Renderer:this.options.Renderer});n.generateId||(n.generateId=this.generateId),n.classes||(n.classes={}),n.keyframes||(n.keyframes={});var o=m(e,t,n);return o&&this.plugins.onProcessRule(o),o},t.use=function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.forEach(function(t){e.plugins.use(t)}),this},e}();var ge="undefined"!==typeof CSS&&CSS&&"number"in CSS,ye=function(e){return new ve(e)};ye();var be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.baseClasses,r=e.newClasses;if(e.Component,!r)return t;var n=Object(i.a)({},t);return Object.keys(r).forEach(function(e){r[e]&&(n[e]="".concat(t[e]," ").concat(r[e]))}),n},xe={set:function(e,t,r,n){var i=e.get(t);i||(i=new Map,e.set(t,i)),i.set(r,n)},get:function(e,t,r){var n=e.get(t);return n?n.get(r):void 0},delete:function(e,t,r){e.get(t).delete(r)}},we=r(539),Se=(r(195),"function"===typeof Symbol&&Symbol.for?Symbol.for("mui.nested"):"__THEME_NESTED__"),Me=["checked","disabled","error","focused","focusVisible","required","expanded","selected"];var _e=Date.now(),Te="fnValues"+_e,Ae="fnStyle"+ ++_e;var Ce=function(){return{onCreateRule:function(e,t,r){if("function"!==typeof t)return null;var n=m(e,{},r);return n[Ae]=t,n},onProcessStyle:function(e,t){if(Te in t||Ae in t)return e;var r={};for(var n in e){var i=e[n];"function"===typeof i&&(delete e[n],r[n]=i)}return t[Te]=r,e},onUpdate:function(e,t,r,n){var i=t,o=i[Ae];o&&(i.style=o(e)||{});var a=i[Te];if(a)for(var s in a)i.prop(s,a[s](e),n)}}},Ee="@global",Le="@global ",Ne=function(){function e(e,t,r){for(var n in this.type="global",this.at=Ee,this.rules=void 0,this.options=void 0,this.key=void 0,this.isProcessed=!1,this.key=e,this.options=r,this.rules=new Q(Object(i.a)({},r,{parent:this})),t)this.rules.add(n,t[n]);this.rules.process()}var t=e.prototype;return t.getRule=function(e){return this.rules.get(e)},t.addRule=function(e,t,r){var n=this.rules.add(e,t,r);return this.options.jss.plugins.onProcessRule(n),n},t.indexOf=function(e){return this.rules.indexOf(e)},t.toString=function(){return this.rules.toString()},e}(),Pe=function(){function e(e,t,r){this.type="global",this.at=Ee,this.options=void 0,this.rule=void 0,this.isProcessed=!1,this.key=void 0,this.key=e,this.options=r;var n=e.substr(Le.length);this.rule=r.jss.createRule(n,t,Object(i.a)({},r,{parent:this}))}return e.prototype.toString=function(e){return this.rule?this.rule.toString(e):""},e}(),Oe=/\s*,\s*/g;function Re(e,t){for(var r=e.split(Oe),n="",i=0;i<r.length;i++)n+=t+" "+r[i].trim(),r[i+1]&&(n+=", ");return n}var De=function(){return{onCreateRule:function(e,t,r){if(!e)return null;if(e===Ee)return new Ne(e,t,r);if("@"===e[0]&&e.substr(0,Le.length)===Le)return new Pe(e,t,r);var n=r.parent;return n&&("global"===n.type||n.options.parent&&"global"===n.options.parent.type)&&(r.scoped=!1),!1===r.scoped&&(r.selector=e),null},onProcessRule:function(e){"style"===e.type&&(function(e){var t=e.options,r=e.style,n=r?r[Ee]:null;if(n){for(var o in n)t.sheet.addRule(o,n[o],Object(i.a)({},t,{selector:Re(o,e.selector)}));delete r[Ee]}}(e),function(e){var t=e.options,r=e.style;for(var n in r)if("@"===n[0]&&n.substr(0,Ee.length)===Ee){var o=Re(n.substr(Ee.length),e.selector);t.sheet.addRule(o,r[n],Object(i.a)({},t,{selector:o})),delete r[n]}}(e))}}},Fe=/\s*,\s*/g,ke=/&/g,Ie=/\$([\w-]+)/g;var Be=function(){function e(e,t){return function(r,n){var i=e.getRule(n)||t&&t.getRule(n);return i?(i=i).selector:n}}function t(e,t){for(var r=t.split(Fe),n=e.split(Fe),i="",o=0;o<r.length;o++)for(var a=r[o],s=0;s<n.length;s++){var l=n[s];i&&(i+=", "),i+=-1!==l.indexOf("&")?l.replace(ke,a):a+" "+l}return i}function r(e,t,r){if(r)return Object(i.a)({},r,{index:r.index+1});var n=e.options.nestingLevel;return n=void 0===n?1:n+1,Object(i.a)({},e.options,{nestingLevel:n,index:t.indexOf(e)+1})}return{onProcessStyle:function(n,o,a){if("style"!==o.type)return n;var s,l,u=o,c=u.options.parent;for(var h in n){var p=-1!==h.indexOf("&"),f="@"===h[0];if(p||f){if(s=r(u,c,s),p){var d=t(h,u.selector);l||(l=e(c,a)),d=d.replace(Ie,l),c.addRule(d,n[h],Object(i.a)({},s,{selector:d}))}else f&&c.addRule(h,{},s).addRule(u.key,n[h],{selector:u.selector});delete n[h]}}return n}}},Ue=/[A-Z]/g,Ve=/^ms-/,je={};function ze(e){return"-"+e.toLowerCase()}var Ge=function(e){if(je.hasOwnProperty(e))return je[e];var t=e.replace(Ue,ze);return je[e]=Ve.test(t)?"-"+t:t};function We(e){var t={};for(var r in e){t[0===r.indexOf("--")?r:Ge(r)]=e[r]}return e.fallbacks&&(Array.isArray(e.fallbacks)?t.fallbacks=e.fallbacks.map(We):t.fallbacks=We(e.fallbacks)),t}var He=function(){return{onProcessStyle:function(e){if(Array.isArray(e)){for(var t=0;t<e.length;t++)e[t]=We(e[t]);return e}return We(e)},onChangeValue:function(e,t,r){if(0===t.indexOf("--"))return e;var n=Ge(t);return t===n?e:(r.prop(n,e),null)}}},Xe=ge&&CSS?CSS.px:"px",qe=ge&&CSS?CSS.ms:"ms",Ye=ge&&CSS?CSS.percent:"%";function Ke(e){var t=/(-[a-z])/g,r=function(e){return e[1].toUpperCase()},n={};for(var i in e)n[i]=e[i],n[i.replace(t,r)]=e[i];return n}var Qe=Ke({"animation-delay":qe,"animation-duration":qe,"background-position":Xe,"background-position-x":Xe,"background-position-y":Xe,"background-size":Xe,border:Xe,"border-bottom":Xe,"border-bottom-left-radius":Xe,"border-bottom-right-radius":Xe,"border-bottom-width":Xe,"border-left":Xe,"border-left-width":Xe,"border-radius":Xe,"border-right":Xe,"border-right-width":Xe,"border-top":Xe,"border-top-left-radius":Xe,"border-top-right-radius":Xe,"border-top-width":Xe,"border-width":Xe,margin:Xe,"margin-bottom":Xe,"margin-left":Xe,"margin-right":Xe,"margin-top":Xe,padding:Xe,"padding-bottom":Xe,"padding-left":Xe,"padding-right":Xe,"padding-top":Xe,"mask-position-x":Xe,"mask-position-y":Xe,"mask-size":Xe,height:Xe,width:Xe,"min-height":Xe,"max-height":Xe,"min-width":Xe,"max-width":Xe,bottom:Xe,left:Xe,top:Xe,right:Xe,"box-shadow":Xe,"text-shadow":Xe,"column-gap":Xe,"column-rule":Xe,"column-rule-width":Xe,"column-width":Xe,"font-size":Xe,"font-size-delta":Xe,"letter-spacing":Xe,"text-indent":Xe,"text-stroke":Xe,"text-stroke-width":Xe,"word-spacing":Xe,motion:Xe,"motion-offset":Xe,outline:Xe,"outline-offset":Xe,"outline-width":Xe,perspective:Xe,"perspective-origin-x":Ye,"perspective-origin-y":Ye,"transform-origin":Ye,"transform-origin-x":Ye,"transform-origin-y":Ye,"transform-origin-z":Ye,"transition-delay":qe,"transition-duration":qe,"vertical-align":Xe,"flex-basis":Xe,"shape-margin":Xe,size:Xe,grid:Xe,"grid-gap":Xe,"grid-row-gap":Xe,"grid-column-gap":Xe,"grid-template-rows":Xe,"grid-template-columns":Xe,"grid-auto-rows":Xe,"grid-auto-columns":Xe,"box-shadow-x":Xe,"box-shadow-y":Xe,"box-shadow-blur":Xe,"box-shadow-spread":Xe,"font-line-height":Xe,"text-shadow-x":Xe,"text-shadow-y":Xe,"text-shadow-blur":Xe});function Je(e,t,r){if(!t)return t;if(Array.isArray(t))for(var n=0;n<t.length;n++)t[n]=Je(e,t[n],r);else if("object"===typeof t)if("fallbacks"===e)for(var i in t)t[i]=Je(i,t[i],r);else for(var o in t)t[o]=Je(e+"-"+o,t[o],r);else if("number"===typeof t)return r[e]?""+t+r[e]:Qe[e]?"function"===typeof Qe[e]?Qe[e](t).toString():""+t+Qe[e]:t.toString();return t}var Ze=function(e){void 0===e&&(e={});var t=Ke(e);return{onProcessStyle:function(e,r){if("style"!==r.type)return e;for(var n in e)e[n]=Je(n,e[n],t);return e},onChangeValue:function(e,r){return Je(r,e,t)}}},$e=r(87),et="",tt="",rt="",nt="",it=l&&"ontouchstart"in document.documentElement;if(l){var ot={Moz:"-moz-",ms:"-ms-",O:"-o-",Webkit:"-webkit-"},at=document.createElement("p").style;for(var st in ot)if(st+"Transform"in at){et=st,tt=ot[st];break}"Webkit"===et&&"msHyphens"in at&&(et="ms",tt=ot.ms,nt="edge"),"Webkit"===et&&"-apple-trailing-word"in at&&(rt="apple")}var lt={js:et,css:tt,vendor:rt,browser:nt,isTouch:it};var ut={noPrefill:["appearance"],supportedProperty:function(e){return"appearance"===e&&("ms"===lt.js?"-webkit-"+e:lt.css+e)}},ct=/[-\s]+(.)?/g;function ht(e,t){return t?t.toUpperCase():""}function pt(e){return e.replace(ct,ht)}function ft(e){return pt("-"+e)}var dt,mt={supportedProperty:function(e,t){return!!/^break-/.test(e)&&("Webkit"===lt.js?"WebkitColumn"+ft(e)in t&&lt.css+"column-"+e:"Moz"===lt.js&&("page"+ft(e)in t&&"page-"+e))}},vt={noPrefill:["color-adjust"],supportedProperty:function(e){return"color-adjust"===e&&("Webkit"===lt.js?lt.css+"print-"+e:e)}},gt={flex:"box-flex","flex-grow":"box-flex","flex-direction":["box-orient","box-direction"],order:"box-ordinal-group","align-items":"box-align","flex-flow":["box-orient","box-direction"],"justify-content":"box-pack"},yt=Object.keys(gt),bt=function(e){return lt.css+e},xt={"flex-grow":"flex-positive","flex-shrink":"flex-negative","flex-basis":"flex-preferred-size","justify-content":"flex-pack",order:"flex-order","align-items":"flex-align","align-content":"flex-line-pack"},wt=[ut,vt,{noPrefill:["mask"],supportedProperty:function(e,t){if(!/^mask/.test(e))return!1;if("Webkit"===lt.js){if(pt("mask-image")in t)return e;if(lt.js+ft("mask-image")in t)return lt.css+e}return e}},{noPrefill:["text-orientation"],supportedProperty:function(e){return"text-orientation"===e&&("apple"!==lt.vendor||lt.isTouch?e:lt.css+e)}},{noPrefill:["transform"],supportedProperty:function(e,t,r){return"transform"===e&&(r.transform?e:lt.css+e)}},{noPrefill:["transition"],supportedProperty:function(e,t,r){return"transition"===e&&(r.transition?e:lt.css+e)}},{noPrefill:["writing-mode"],supportedProperty:function(e){return"writing-mode"===e&&("Webkit"===lt.js||"ms"===lt.js?lt.css+e:e)}},mt,{supportedProperty:function(e,t){if(!/^(border|margin|padding)-inline/.test(e))return!1;if("Moz"===lt.js)return e;var r=e.replace("-inline","");return lt.js+ft(r)in t&&lt.css+r}},{supportedProperty:function(e,t){return pt(e)in t&&e}},{supportedProperty:function(e,t){var r=ft(e);return"-"===e[0]?e:"-"===e[0]&&"-"===e[1]?e:lt.js+r in t?lt.css+e:"Webkit"!==lt.js&&"Webkit"+r in t&&"-webkit-"+e}},{supportedProperty:function(e){return"scroll-snap"===e.substring(0,11)&&("ms"===lt.js?""+lt.css+e:e)}},{supportedProperty:function(e){return"overscroll-behavior"===e&&("ms"===lt.js?lt.css+"scroll-chaining":e)}},{supportedProperty:function(e,t){var r=xt[e];return!!r&&(lt.js+ft(r)in t&&lt.css+r)}},{supportedProperty:function(e,t,r){var n=r.multiple;if(yt.indexOf(e)>-1){var i=gt[e];if(!Array.isArray(i))return lt.js+ft(i)in t&&lt.css+i;if(!n)return!1;for(var o=0;o<i.length;o++)if(!(lt.js+ft(i[0])in t))return!1;return i.map(bt)}return!1}}],St=wt.filter(function(e){return e.supportedProperty}).map(function(e){return e.supportedProperty}),Mt=wt.filter(function(e){return e.noPrefill}).reduce(function(e,t){return e.push.apply(e,Object($e.a)(t.noPrefill)),e},[]),_t={};if(l){dt=document.createElement("p");var Tt=window.getComputedStyle(document.documentElement,"");for(var At in Tt)isNaN(At)||(_t[Tt[At]]=Tt[At]);Mt.forEach(function(e){return delete _t[e]})}function Ct(e,t){if(void 0===t&&(t={}),!dt)return e;if(null!=_t[e])return _t[e];"transition"!==e&&"transform"!==e||(t[e]=e in dt.style);for(var r=0;r<St.length&&(_t[e]=St[r](e,dt.style,t),!_t[e]);r++);try{dt.style[e]=""}catch(n){return!1}return _t[e]}var Et,Lt={},Nt={transition:1,"transition-property":1,"-webkit-transition":1,"-webkit-transition-property":1},Pt=/(^\s*[\w-]+)|, (\s*[\w-]+)(?![^()]*\))/g;function Ot(e,t,r){return"var"===t?"var":"all"===t?"all":"all"===r?", all":t?Ct(t):", "+Ct(r)}function Rt(e,t){var r=t;if(!Et||"content"===e)return t;if("string"!==typeof r||!isNaN(parseInt(r,10)))return r;var n=e+r;if(null!=Lt[n])return Lt[n];try{Et.style[e]=r}catch(i){return Lt[n]=!1,!1}if(Nt[e])r=r.replace(Pt,Ot);else if(""===Et.style[e]&&("-ms-flex"===(r=lt.css+r)&&(Et.style[e]="-ms-flexbox"),Et.style[e]=r,""===Et.style[e]))return Lt[n]=!1,!1;return Et.style[e]="",Lt[n]=r,Lt[n]}l&&(Et=document.createElement("p"));var Dt=function(){return{onProcessRule:function(e){if("keyframes"===e.type){var t=e;t.at="-"===(r=t.at)[1]?r:"ms"===lt.js?r:"@"+lt.css+"keyframes"+r.substr(10)}var r},onProcessStyle:function(e,t){if("style"!==t.type)return e;for(var r in e){var n=e[r],i=!1,o=Ct(r);o&&o!==r&&(i=!0);var a=!1,s=Rt(o,g(n));s&&s!==n&&(a=!0),(i||a)&&(i&&delete e[r],e[o||r]=s||n)}return e},onChangeValue:function(e,t){return Rt(t,g(e))||e}}};var Ft=function(){var e=function(e,t){return e.length===t.length?e>t?1:-1:e.length-t.length};return{onProcessStyle:function(t,r){if("style"!==r.type)return t;for(var n={},i=Object.keys(t).sort(e),o=0;o<i.length;o++)n[i[o]]=t[i[o]];return n}}};var kt=function(){return{plugins:[Ce(),De(),Be(),He(),Ze(),"undefined"===typeof window?null:Dt(),Ft()]}},It=ye(kt()),Bt={disableGeneration:!1,generateClassName:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.disableGlobal,r=void 0!==t&&t,n=e.productionPrefix,i=void 0===n?"jss":n,o=e.seed,a=void 0===o?"":o,s=""===a?"":"".concat(a,"-"),l=0;return function(e,t){l+=1;var n=t.options.name;if(n&&0===n.indexOf("Mui")&&!t.options.link&&!r){if(-1!==Me.indexOf(e.key))return"Mui-".concat(e.key);var o="".concat(s).concat(n,"-").concat(e.key);return t.options.theme[Se]&&""===a?"".concat(o,"-").concat(l):o}return"".concat(s).concat(i).concat(l)}}(),jss:It,sheetsCache:null,sheetsManager:new Map,sheetsRegistry:null},Ut=a.a.createContext(Bt);var Vt=-1e9;var jt=r(68),zt=r.n(jt);function Gt(e,t){return t}var Wt=function(e){var t="function"===typeof e;return{create:function(r,n){var o;try{o=t?e(r):e}catch(l){throw l}if(!n||!r.overrides||!r.overrides[n])return o;var a=r.overrides[n],s=Object(i.a)({},o);return Object.keys(a).forEach(function(e){s[e]=zt()(s[e],a[e],{arrayMerge:Gt})}),s},options:{}}},Ht={};function Xt(e,t){var r=e.state,n=e.theme,o=e.stylesOptions,a=e.stylesCreator,s=e.name;if(!o.disableGeneration){var l=xe.get(o.sheetsManager,a,n);l||(l={refs:0,staticSheet:null,dynamicStyles:null},xe.set(o.sheetsManager,a,n,l));var u=Object(i.a)({},a.options,{},o,{theme:n,flip:"boolean"===typeof o.flip?o.flip:"rtl"===n.direction});u.generateId=u.serverGenerateClassName||u.generateClassName;var c=o.sheetsRegistry;if(0===l.refs){var h;o.sheetsCache&&(h=xe.get(o.sheetsCache,a,n));var p=a.create(n,s);h||((h=o.jss.createStyleSheet(p,Object(i.a)({link:!1},u))).attach(),o.sheetsCache&&xe.set(o.sheetsCache,a,n,h)),c&&c.add(h),l.staticSheet=h,l.dynamicStyles=function e(t){var r=null;for(var n in t){var i=t[n],o=typeof i;if("function"===o)r||(r={}),r[n]=i;else if("object"===o&&null!==i&&!Array.isArray(i)){var a=e(i);a&&(r||(r={}),r[n]=a)}}return r}(p)}if(l.dynamicStyles){var f=o.jss.createStyleSheet(l.dynamicStyles,Object(i.a)({link:!0},u));f.update(t).attach(),r.dynamicSheet=f,r.classes=be({baseClasses:l.staticSheet.classes,newClasses:f.classes}),c&&c.add(f)}else r.classes=l.staticSheet.classes;l.refs+=1}}t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.name,o=t.classNamePrefix,s=t.Component,l=t.defaultTheme,u=void 0===l?Ht:l,c=Object(n.a)(t,["name","classNamePrefix","Component","defaultTheme"]),h=Wt(e),p=r||o||"makeStyles";return h.options={index:Vt+=1,name:r,meta:p,classNamePrefix:p},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(we.a)()||u,n=Object(i.a)({},a.a.useContext(Ut),{},c),o=a.a.useRef(),l=a.a.useRef();return function(e,t){var r,n=a.a.useRef([]),i=a.a.useMemo(function(){return{}},t);n.current!==i&&(n.current=i,r=e()),a.a.useEffect(function(){return function(){r&&r()}},[i])}(function(){var i={name:r,state:{},stylesCreator:h,stylesOptions:n,theme:t};return Xt(i,e),l.current=!1,o.current=i,function(){!function(e){var t=e.state,r=e.theme,n=e.stylesOptions,i=e.stylesCreator;if(!n.disableGeneration){var o=xe.get(n.sheetsManager,i,r);o.refs-=1;var a=n.sheetsRegistry;0===o.refs&&(xe.delete(n.sheetsManager,i,r),n.jss.removeStyleSheet(o.staticSheet),a&&a.remove(o.staticSheet)),t.dynamicSheet&&(n.jss.removeStyleSheet(t.dynamicSheet),a&&a.remove(t.dynamicSheet))}}(i)}},[t,h]),a.a.useEffect(function(){l.current&&function(e,t){var r=e.state;r.dynamicSheet&&r.dynamicSheet.update(t)}(o.current,e),l.current=!0}),function(e,t,r){var n=e.state;if(e.stylesOptions.disableGeneration)return t||{};n.cacheClasses||(n.cacheClasses={value:null,lastProp:null,lastJSS:{}});var i=!1;return n.classes!==n.cacheClasses.lastJSS&&(n.cacheClasses.lastJSS=n.classes,i=!0),t!==n.cacheClasses.lastProp&&(n.cacheClasses.lastProp=t,i=!0),i&&(n.cacheClasses.value=be({baseClasses:n.cacheClasses.lastJSS,newClasses:t,Component:r})),n.cacheClasses.value}(o.current,e.classes,s)}}},function(e,t,r){"use strict";var n=r(1),i=r(5),o=r(0),a=r.n(o),s=(r(13),r(8)),l=r.n(s),u=r(6),c=r(539),h=r(520),p=r(45),f=r(15);var d="undefined"!==typeof window?a.a.useLayoutEffect:a.a.useEffect;var m=a.a.forwardRef(function(e,t){var r=e.children,n=e.container,i=e.disablePortal,o=void 0!==i&&i,s=e.onRendered,u=a.a.useState(null),c=u[0],h=u[1],p=Object(f.c)(r.ref,t);return d(function(){o||h(function(e){return e="function"===typeof e?e():e,l.a.findDOMNode(e)}(n)||document.body)},[n,o]),d(function(){if(c&&!o)return Object(f.b)(t,c),function(){Object(f.b)(t,null)}},[t,c,o]),d(function(){s&&(c||o)&&s()},[s,c,o]),o?(a.a.Children.only(r),a.a.cloneElement(r,{ref:p})):c?l.a.createPortal(r,c):c}),v=r(21),g=r(42),y=r(125);var b=r(89),x=r(87);var w=function(){var e=document.createElement("div");e.style.width="99px",e.style.height="99px",e.style.position="absolute",e.style.top="-9999px",e.style.overflow="scroll",document.body.appendChild(e);var t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),t};var S=function(e){return Object(p.a)(e).defaultView||window};function M(e,t){t?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden")}function _(e){return parseInt(window.getComputedStyle(e)["padding-right"],10)||0}var T=["template","script","style"];function A(e,t,r,n,i){var o=[t,r].concat(Object(x.a)(n));[].forEach.call(e.children,function(e){-1===o.indexOf(e)&&function(e){return 1===e.nodeType&&-1===T.indexOf(e.tagName.toLowerCase())}(e)&&i(e)})}function C(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4?arguments[4]:void 0;A(e,t,r,n,function(e){return M(e,i)})}function E(e,t){var r=-1;return e.some(function(e,n){return!!t(e)&&(r=n,!0)}),r}function L(e,t){var r,n={},i={},o=[];if(!t.disableScrollLock&&(n.overflow=e.container.style.overflow,n["padding-right"]=e.container.style.paddingRight,i.overflow="hidden",function(e){var t=Object(p.a)(e);return t.body===e?S(t).innerWidth>t.documentElement.clientWidth:e.scrollHeight>e.clientHeight}(e.container))){var a=w();i["padding-right"]="".concat(_(e.container)+a,"px"),r=Object(p.a)(e.container).querySelectorAll(".mui-fixed"),[].forEach.call(r,function(e){o.push(e.style.paddingRight),e.style.paddingRight="".concat(_(e)+a,"px")})}Object.keys(i).forEach(function(t){e.container.style[t]=i[t]});return function(){r&&[].forEach.call(r,function(e,t){o[t]?e.style.paddingRight=o[t]:e.style.removeProperty("padding-right")}),Object.keys(n).forEach(function(t){n[t]?e.container.style.setProperty(t,n[t]):e.container.style.removeProperty(t)})}}var N=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.modals=[],this.containers=[]}return Object(b.a)(e,[{key:"add",value:function(e,t){var r=this.modals.indexOf(e);if(-1!==r)return r;r=this.modals.length,this.modals.push(e),e.modalRef&&M(e.modalRef,!1);var n=function(e){var t=[];return[].forEach.call(e.children,function(e){e.getAttribute&&"true"===e.getAttribute("aria-hidden")&&t.push(e)}),t}(t);C(t,e.mountNode,e.modalRef,n,!0);var i=E(this.containers,function(e){return e.container===t});return-1!==i?(this.containers[i].modals.push(e),r):(this.containers.push({modals:[e],container:t,restore:null,hiddenSiblingNodes:n}),r)}},{key:"mount",value:function(e,t){var r=E(this.containers,function(t){return-1!==t.modals.indexOf(e)}),n=this.containers[r];n.restore||(n.restore=L(n,t))}},{key:"remove",value:function(e){var t=this.modals.indexOf(e);if(-1===t)return t;var r=E(this.containers,function(t){return-1!==t.modals.indexOf(e)}),n=this.containers[r];if(n.modals.splice(n.modals.indexOf(e),1),this.modals.splice(t,1),0===n.modals.length)n.restore&&n.restore(),e.modalRef&&M(e.modalRef,!0),C(n.container,e.mountNode,e.modalRef,n.hiddenSiblingNodes,!1),this.containers.splice(r,1);else{var i=n.modals[n.modals.length-1];i.modalRef&&M(i.modalRef,!1)}return t}},{key:"isTopModal",value:function(e){return!!this.modals.length&&this.modals[this.modals.length-1]===e}}]),e}();var P=function(e){var t=e.children,r=e.disableAutoFocus,n=void 0!==r&&r,i=e.disableEnforceFocus,o=void 0!==i&&i,s=e.disableRestoreFocus,u=void 0!==s&&s,c=e.getDoc,h=e.isEnabled,d=e.open,m=a.a.useRef(),v=a.a.useRef(null),g=a.a.useRef(null),y=a.a.useRef(),b=a.a.useRef(null),x=a.a.useCallback(function(e){b.current=l.a.findDOMNode(e)},[]),w=Object(f.c)(t.ref,x);return a.a.useMemo(function(){d&&"undefined"!==typeof window&&(y.current=c().activeElement)},[d]),a.a.useEffect(function(){if(d){var e=Object(p.a)(b.current);n||!b.current||b.current.contains(e.activeElement)||(b.current.hasAttribute("tabIndex")||b.current.setAttribute("tabIndex",-1),b.current.focus());var t=function(){o||!h()||m.current?m.current=!1:b.current&&!b.current.contains(e.activeElement)&&b.current.focus()},r=function(t){!o&&h()&&9===t.keyCode&&e.activeElement===b.current&&(m.current=!0,t.shiftKey?g.current.focus():v.current.focus())};e.addEventListener("focus",t,!0),e.addEventListener("keydown",r,!0);var i=setInterval(function(){t()},50);return function(){clearInterval(i),e.removeEventListener("focus",t,!0),e.removeEventListener("keydown",r,!0),u||(y.current&&y.current.focus&&y.current.focus(),y.current=null)}}},[n,o,u,h,d]),a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{tabIndex:0,ref:v,"data-test":"sentinelStart"}),a.a.cloneElement(t,{ref:w}),a.a.createElement("div",{tabIndex:0,ref:g,"data-test":"sentinelEnd"}))},O={root:{zIndex:-1,position:"fixed",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",touchAction:"none"},invisible:{backgroundColor:"transparent"}},R=a.a.forwardRef(function(e,t){var r=e.invisible,o=void 0!==r&&r,s=e.open,l=Object(i.a)(e,["invisible","open"]);return s?a.a.createElement("div",Object(n.a)({"aria-hidden":!0,ref:t},l,{style:Object(n.a)({},O.root,{},o?O.invisible:{},{},l.style)})):null});var D=new N,F=a.a.forwardRef(function(e,t){var r=Object(c.a)(),o=Object(h.a)({name:"MuiModal",props:Object(n.a)({},e),theme:r}),s=o.BackdropComponent,u=void 0===s?R:s,d=o.BackdropProps,b=o.children,x=o.closeAfterTransition,w=void 0!==x&&x,S=o.container,_=o.disableAutoFocus,T=void 0!==_&&_,A=o.disableBackdropClick,C=void 0!==A&&A,E=o.disableEnforceFocus,L=void 0!==E&&E,N=o.disableEscapeKeyDown,O=void 0!==N&&N,F=o.disablePortal,k=void 0!==F&&F,I=o.disableRestoreFocus,B=void 0!==I&&I,U=o.disableScrollLock,V=void 0!==U&&U,j=o.hideBackdrop,z=void 0!==j&&j,G=o.keepMounted,W=void 0!==G&&G,H=o.manager,X=void 0===H?D:H,q=o.onBackdropClick,Y=o.onClose,K=o.onEscapeKeyDown,Q=o.onRendered,J=o.open,Z=Object(i.a)(o,["BackdropComponent","BackdropProps","children","closeAfterTransition","container","disableAutoFocus","disableBackdropClick","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","manager","onBackdropClick","onClose","onEscapeKeyDown","onRendered","open"]),$=a.a.useState(!0),ee=$[0],te=$[1],re=a.a.useRef({}),ne=a.a.useRef(null),ie=a.a.useRef(null),oe=Object(f.c)(ie,t),ae=function(e){return!!e.children&&e.children.props.hasOwnProperty("in")}(o),se=function(){return Object(p.a)(ne.current)},le=function(){return re.current.modalRef=ie.current,re.current.mountNode=ne.current,re.current},ue=function(){X.mount(le(),{disableScrollLock:V}),ie.current.scrollTop=0},ce=Object(g.a)(function(){var e=function(e){return e="function"===typeof e?e():e,l.a.findDOMNode(e)}(S)||se().body;X.add(le(),e),ie.current&&ue()}),he=a.a.useCallback(function(){return X.isTopModal(le())},[X]),pe=Object(g.a)(function(e){ne.current=e,e&&(Q&&Q(),J&&he()?ue():M(ie.current,!0))}),fe=a.a.useCallback(function(){X.remove(le())},[X]);if(a.a.useEffect(function(){return function(){fe()}},[fe]),a.a.useEffect(function(){J?ce():ae&&w||fe()},[J,fe,ae,w,ce]),!W&&!J&&(!ae||ee))return null;var de=function(e){return{root:{position:"fixed",zIndex:e.zIndex.modal,right:0,bottom:0,top:0,left:0},hidden:{visibility:"hidden"}}}(r||{zIndex:y.a}),me={};return void 0===b.role&&(me.role=b.role||"document"),void 0===b.tabIndex&&(me.tabIndex=b.tabIndex||"-1"),ae&&(me.onEnter=Object(v.b)(function(){te(!1)},b.props.onEnter),me.onExited=Object(v.b)(function(){te(!0),w&&fe()},b.props.onExited)),a.a.createElement(m,{ref:pe,container:S,disablePortal:k},a.a.createElement("div",Object(n.a)({ref:oe,onKeyDown:function(e){"Escape"===e.key&&he()&&(e.stopPropagation(),K&&K(e),!O&&Y&&Y(e,"escapeKeyDown"))},role:"presentation"},Z,{style:Object(n.a)({},de.root,{},!J&&ee?de.hidden:{},{},Z.style)}),z?null:a.a.createElement(u,Object(n.a)({open:J,onClick:function(e){e.target===e.currentTarget&&(q&&q(e),!C&&Y&&Y(e,"backdropClick"))}},d)),a.a.createElement(P,{disableEnforceFocus:L,disableAutoFocus:T,disableRestoreFocus:B,getDoc:se,isEnabled:he,open:J},a.a.cloneElement(b,me))))}),k=r(2),I=r(529),B=a.a.forwardRef(function(e,t){var r=e.children,o=e.classes,s=e.className,l=e.invisible,c=void 0!==l&&l,h=e.open,p=e.transitionDuration,f=Object(i.a)(e,["children","classes","className","invisible","open","transitionDuration"]);return a.a.createElement(I.a,Object(n.a)({in:h,timeout:p},f),a.a.createElement("div",{className:Object(u.a)(o.root,s,c&&o.invisible),"aria-hidden":!0,ref:t},r))}),U=Object(k.a)({root:{zIndex:-1,position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",touchAction:"none"},invisible:{backgroundColor:"transparent"}},{name:"MuiBackdrop"})(B),V=r(126),j=r(537),z=r(51),G=r(26),W=r(33);function H(e,t){var r=function(e,t){var r,n=t.getBoundingClientRect();if(t.fakeTransform)r=t.fakeTransform;else{var i=window.getComputedStyle(t);r=i.getPropertyValue("-webkit-transform")||i.getPropertyValue("transform")}var o=0,a=0;if(r&&"none"!==r&&"string"===typeof r){var s=r.split("(")[1].split(")")[0].split(",");o=parseInt(s[4],10),a=parseInt(s[5],10)}return"left"===e?"translateX(".concat(window.innerWidth,"px) translateX(-").concat(n.left-o,"px)"):"right"===e?"translateX(-".concat(n.left+n.width-o,"px)"):"up"===e?"translateY(".concat(window.innerHeight,"px) translateY(-").concat(n.top-a,"px)"):"translateY(-".concat(n.top+n.height-a,"px)")}(e,t);r&&(t.style.webkitTransform=r,t.style.transform=r)}var X={enter:G.b.enteringScreen,exit:G.b.leavingScreen},q=a.a.forwardRef(function(e,t){var r=e.children,o=e.direction,s=void 0===o?"down":o,u=e.in,c=e.onEnter,h=e.onEntering,p=e.onExit,d=e.onExited,m=e.style,v=e.timeout,g=void 0===v?X:v,y=Object(i.a)(e,["children","direction","in","onEnter","onEntering","onExit","onExited","style","timeout"]),b=Object(z.a)(),x=a.a.useRef(null),w=a.a.useCallback(function(e){x.current=l.a.findDOMNode(e)},[]),S=Object(f.c)(r.ref,w),M=Object(f.c)(S,t),_=a.a.useCallback(function(){x.current&&H(s,x.current)},[s]);return a.a.useEffect(function(){if(!u&&"down"!==s&&"right"!==s){var e=Object(V.a)(function(){x.current&&H(s,x.current)});return window.addEventListener("resize",e),function(){e.clear(),window.removeEventListener("resize",e)}}},[s,u]),a.a.useEffect(function(){u||_()},[u,_]),a.a.createElement(j.a,Object(n.a)({onEnter:function(e,t){var r=x.current;H(s,r),Object(W.b)(r),c&&c(r,t)},onEntering:function(e,t){var r=x.current,i=Object(W.a)({timeout:g,style:m},{mode:"enter"});r.style.webkitTransition=b.transitions.create("-webkit-transform",Object(n.a)({},i,{easing:b.transitions.easing.easeOut})),r.style.transition=b.transitions.create("transform",Object(n.a)({},i,{easing:b.transitions.easing.easeOut})),r.style.webkitTransform="none",r.style.transform="none",h&&h(r,t)},onExit:function(){var e=x.current,t=Object(W.a)({timeout:g,style:m},{mode:"exit"});e.style.webkitTransition=b.transitions.create("-webkit-transform",Object(n.a)({},t,{easing:b.transitions.easing.sharp})),e.style.transition=b.transitions.create("transform",Object(n.a)({},t,{easing:b.transitions.easing.sharp})),H(s,e),p&&p(e)},onExited:function(){var e=x.current;e.style.webkitTransition="",e.style.transition="",d&&d(e)},appear:!0,in:u,timeout:g},y),function(e,t){return a.a.cloneElement(r,Object(n.a)({ref:M,style:Object(n.a)({visibility:"exited"!==e||u?void 0:"hidden"},m,{},r.props.style)},t))})}),Y=r(528),K={left:"right",right:"left",top:"down",bottom:"up"};function Q(e){return-1!==["left","right"].indexOf(e)}function J(e,t){return"rtl"===e.direction&&Q(t)?K[t]:t}var Z={enter:G.b.enteringScreen,exit:G.b.leavingScreen},$=a.a.forwardRef(function(e,t){var r=e.anchor,o=void 0===r?"left":r,s=e.BackdropProps,l=e.children,c=e.classes,h=e.className,p=e.elevation,f=void 0===p?16:p,d=e.ModalProps,m=(d=void 0===d?{}:d).BackdropProps,g=Object(i.a)(d,["BackdropProps"]),y=e.onClose,b=e.open,x=void 0!==b&&b,w=e.PaperProps,S=e.SlideProps,M=e.transitionDuration,_=void 0===M?Z:M,T=e.variant,A=void 0===T?"temporary":T,C=Object(i.a)(e,["anchor","BackdropProps","children","classes","className","elevation","ModalProps","onClose","open","PaperProps","SlideProps","transitionDuration","variant"]),E=Object(z.a)(),L=a.a.useRef(!1);a.a.useEffect(function(){L.current=!0},[]);var N=J(E,o),P=a.a.createElement(Y.a,Object(n.a)({elevation:"temporary"===A?f:0,square:!0,className:Object(u.a)(c.paper,c["paperAnchor".concat(Object(v.a)(N))],"temporary"!==A&&c["paperAnchorDocked".concat(Object(v.a)(N))])},w),l);if("permanent"===A)return a.a.createElement("div",Object(n.a)({className:Object(u.a)(c.root,c.docked,h),ref:t},C),P);var O=a.a.createElement(q,Object(n.a)({in:x,direction:K[N],timeout:_,appear:L.current},S),P);return"persistent"===A?a.a.createElement("div",Object(n.a)({className:Object(u.a)(c.root,c.docked,h),ref:t},C),O):a.a.createElement(F,Object(n.a)({BackdropProps:Object(n.a)({},s,{},m,{transitionDuration:_}),BackdropComponent:U,className:Object(u.a)(c.root,c.modal,h),open:x,onClose:y,ref:t},C,g),O)}),ee=Object(k.a)(function(e){return{root:{},docked:{flex:"0 0 auto"},paper:{overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:e.zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0},paperAnchorLeft:{left:0,right:"auto"},paperAnchorRight:{left:"auto",right:0},paperAnchorTop:{top:0,left:0,bottom:"auto",right:0,height:"auto",maxHeight:"100%"},paperAnchorBottom:{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"},paperAnchorDockedLeft:{borderRight:"1px solid ".concat(e.palette.divider)},paperAnchorDockedTop:{borderBottom:"1px solid ".concat(e.palette.divider)},paperAnchorDockedRight:{borderLeft:"1px solid ".concat(e.palette.divider)},paperAnchorDockedBottom:{borderTop:"1px solid ".concat(e.palette.divider)},modal:{}}},{name:"MuiDrawer",flip:!1})($),te=r(519),re=r(29),ne=a.a.forwardRef(function(e,t){var r=e.anchor,o=e.classes,s=e.className,l=e.width,c=Object(i.a)(e,["anchor","classes","className","width"]);return a.a.createElement("div",Object(n.a)({className:Object(u.a)(o.root,o["anchor".concat(Object(v.a)(r))],s),ref:t,style:Object(re.a)({},Q(r)?"width":"height",l)},c))}),ie=Object(k.a)(function(e){return{root:{position:"fixed",top:0,left:0,bottom:0,zIndex:e.zIndex.drawer-1},anchorLeft:{right:"auto"},anchorRight:{left:"auto",right:0},anchorTop:{bottom:"auto",right:0},anchorBottom:{top:"auto",bottom:0,right:0}}},{name:"PrivateSwipeArea"})(ne),oe=null;function ae(e,t){return"right"===e?document.body.offsetWidth-t[0].pageX:t[0].pageX}function se(e,t){return"bottom"===e?window.innerHeight-t[0].clientY:t[0].clientY}function le(e,t){return e?t.clientWidth:t.clientHeight}function ue(e,t,r,n){return Math.min(Math.max(r?t-e:n+t-e,0),n)}var ce="undefined"!==typeof navigator&&/iPad|iPhone|iPod/.test(navigator.userAgent),he={enter:G.b.enteringScreen,exit:G.b.leavingScreen},pe="undefined"!==typeof window?a.a.useLayoutEffect:a.a.useEffect,fe=a.a.forwardRef(function(e,t){var r=e.anchor,o=void 0===r?"left":r,s=e.disableBackdropTransition,u=void 0!==s&&s,c=e.disableDiscovery,h=void 0!==c&&c,p=e.disableSwipeToOpen,f=void 0===p?ce:p,d=e.hideBackdrop,m=e.hysteresis,v=void 0===m?.55:m,g=e.minFlingVelocity,y=void 0===g?400:g,b=e.ModalProps,x=(b=void 0===b?{}:b).BackdropProps,w=Object(i.a)(b,["BackdropProps"]),S=e.onClose,M=e.onOpen,_=e.open,T=e.PaperProps,A=void 0===T?{}:T,C=e.SwipeAreaProps,E=e.swipeAreaWidth,L=void 0===E?20:E,N=e.transitionDuration,P=void 0===N?he:N,O=e.variant,R=void 0===O?"temporary":O,D=Object(i.a)(e,["anchor","disableBackdropTransition","disableDiscovery","disableSwipeToOpen","hideBackdrop","hysteresis","minFlingVelocity","ModalProps","onClose","onOpen","open","PaperProps","SwipeAreaProps","swipeAreaWidth","transitionDuration","variant"]),F=Object(z.a)(),k=a.a.useState(!1),I=k[0],B=k[1],U=a.a.useRef({isSwiping:null}),V=a.a.useRef(),j=a.a.useRef(),G=a.a.useRef(),H=a.a.useRef(!1),X=a.a.useRef(_);pe(function(){X.current=_},[_]);var q=a.a.useCallback(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.mode,n=void 0===r?null:r,i=t.changeTransition,a=void 0===i||i,s=J(F,o),l=-1!==["right","bottom"].indexOf(s)?1:-1,c=Q(o),h=c?"translate(".concat(l*e,"px, 0)"):"translate(0, ".concat(l*e,"px)"),p=G.current.style;p.webkitTransform=h,p.transform=h;var f="";if(n&&(f=F.transitions.create("all",Object(W.a)({timeout:P},{mode:n}))),a&&(p.webkitTransition=f,p.transition=f),!u&&!d){var m=j.current.style;m.opacity=1-e/le(c,G.current),a&&(m.webkitTransition=f,m.transition=f)}},[o,u,d,F,P]),Y=a.a.useCallback(function(e){if(H.current)if(oe=null,H.current=!1,B(!1),U.current.isSwiping){U.current.isSwiping=null;var t,r=J(F,o),n=Q(o);t=n?ae(r,e.changedTouches):se(r,e.changedTouches);var i=n?U.current.startX:U.current.startY,a=le(n,G.current),s=ue(t,i,X.current,a)/a;X.current?U.current.velocity>y||s>v?S():q(0,{mode:"exit"}):U.current.velocity<-y||1-s>v?M():q(le(n,G.current),{mode:"enter"})}else U.current.isSwiping=null},[o,v,y,S,M,q,F]),K=a.a.useCallback(function(e){if(G.current&&H.current){var t=J(F,o),r=Q(o),n=ae(t,e.touches),i=se(t,e.touches);if(null==U.current.isSwiping){var a=Math.abs(n-U.current.startX),s=Math.abs(i-U.current.startY);a>s&&e.cancelable&&e.preventDefault();var l=r?a>s&&a>3:s>a&&s>3;if(!0===l||(r?s>3:a>3)){if(U.current.isSwiping=l,!l)return void Y(e);U.current.startX=n,U.current.startY=i,h||X.current||(r?U.current.startX-=L:U.current.startY-=L)}}if(U.current.isSwiping){var u=r?U.current.startX:U.current.startY,c=le(r,G.current),p=ue(r?n:i,u,X.current,c);null===U.current.lastTranslate&&(U.current.lastTranslate=p,U.current.lastTime=performance.now()+1);var f=(p-U.current.lastTranslate)/(performance.now()-U.current.lastTime)*1e3;U.current.velocity=.4*U.current.velocity+.6*f,U.current.lastTranslate=p,U.current.lastTime=performance.now(),e.cancelable&&e.preventDefault(),q(p)}}},[q,Y,o,h,L,F]),Z=a.a.useCallback(function(e){if(null===oe||oe===U.current){var t=J(F,o),r=Q(o),n=ae(t,e.touches),i=se(t,e.touches);if(!X.current){if(f||e.target!==V.current)return;if(r){if(n>L)return}else if(i>L)return}oe=U.current,U.current.startX=n,U.current.startY=i,B(!0),!X.current&&G.current&&q(le(r,G.current)+(h?20:-L),{changeTransition:!1}),U.current.velocity=0,U.current.lastTime=null,U.current.lastTranslate=null,H.current=!0}},[q,o,h,f,L,F]);a.a.useEffect(function(){if("temporary"===R)return document.body.addEventListener("touchstart",Z),document.body.addEventListener("touchmove",K,{passive:!1}),document.body.addEventListener("touchend",Y),function(){document.body.removeEventListener("touchstart",Z),document.body.removeEventListener("touchmove",K,{passive:!1}),document.body.removeEventListener("touchend",Y)}},[R,Z,K,Y]),a.a.useEffect(function(){return function(){oe===U.current&&(oe=null)}},[]),a.a.useEffect(function(){_||B(!1)},[_]);var $=a.a.useCallback(function(e){j.current=l.a.findDOMNode(e)},[]),re=a.a.useCallback(function(e){G.current=l.a.findDOMNode(e)},[]);return a.a.createElement(a.a.Fragment,null,a.a.createElement(ee,Object(n.a)({open:!("temporary"!==R||!I)||_,variant:R,ModalProps:Object(n.a)({BackdropProps:Object(n.a)({},x,{ref:$})},w),PaperProps:Object(n.a)({},A,{style:Object(n.a)({pointerEvents:"temporary"!==R||_?"":"none"},A.style),ref:re}),anchor:o,transitionDuration:P,onClose:S,ref:t},D)),!f&&"temporary"===R&&a.a.createElement(te.a,null,a.a.createElement(ie,Object(n.a)({anchor:o,ref:V,width:L},C))))});t.a=fe},function(e,t,r){"use strict";var n=r(22),i=r.n(n),o=r(43),a=r(53),s=r(54),l=function(e){return Array.isArray(e)},u=function(e){return"string"===typeof e},c=r(124),h=function(e){return e[e.length-1]},p=r(157),f=r.n(p),d=function(e){return-1===e.indexOf("/")?f()(e):e.split("/").map(f.a).join("/")},m=function(e,t){return e.reduce(function(e,r){return t(e,r)},{})},v=r(122),g=Object(v.a)(o.a),y=r(46),b=function(e){return 0===e.length};function x(e,t){var r=void 0===t?{}:t,n=r.namespace,i=void 0===n?y.b:n,o=r.prefix;var a={};return Object.getOwnPropertyNames(e).forEach(function(t){var r=o?t.replace(""+o+i,""):t;return function t(r,n,i){var o=d(i.shift());b(i)?n[o]=e[r]:(n[o]||(n[o]={}),t(r,n[o],i))}(t,a,r.split(i))}),a}var w=function(e){return null===e};function S(e,t,r){void 0===t&&(t=s.a),i()(Object(a.a)(t)||w(t),"Expected payloadCreator to be a function, undefined or null");var n=w(t)||t===s.a?s.a:function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return e instanceof Error?e:t.apply(void 0,[e].concat(n))},o=Object(a.a)(r),l=e.toString(),u=function(){var t=n.apply(void 0,arguments),i={type:e};return t instanceof Error&&(i.error=!0),void 0!==t&&(i.payload=t),o&&(i.meta=r.apply(void 0,arguments)),i};return u.toString=function(){return l},u}function M(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){_(e,t,r[t])})}return e}function _(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var a=Object(o.a)(h(r))?r.pop():{};return i()(r.every(u)&&(u(e)||Object(o.a)(e)),"Expected optional object followed by string action types"),u(e)?C([e].concat(r),a):M({},function(e,t){return x(A(g(e,t)),t)}(e,a),C(r,a))}function A(e,t){var r=void 0===t?{}:t,n=r.prefix,o=r.namespace,u=void 0===o?y.b:o;return m(Object.keys(e),function(t,r){var o,h=e[r];i()(function(e){if(Object(a.a)(e)||Object(c.a)(e))return!0;if(l(e)){var t=e[0],r=void 0===t?s.a:t,n=e[1];return Object(a.a)(r)&&Object(a.a)(n)}return!1}(h),"Expected function, undefined, null, or array with payload and meta functions for "+r);var p=n?""+n+u+r:r,f=l(h)?S.apply(void 0,[p].concat(h)):S(p,h);return M({},t,((o={})[r]=f,o))})}function C(e,t){var r=A(m(e,function(e,t){var r;return M({},e,((r={})[t]=s.a,r))}),t);return m(Object.keys(r),function(e,t){var n;return M({},e,((n={})[d(t)]=r[t],n))})}r.d(t,"a",function(){return T})},function(e,t,r){"use strict";var n=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var n="function"!==typeof t[t.length-1]&&t.pop(),i=t;if("undefined"===typeof n)throw new TypeError("The initial state may not be undefined. If you do not want to set a value for this reducer, you can use null instead of undefined.");return function(e,t){for(var r=arguments.length,o=Array(r>2?r-2:0),a=2;a<r;a++)o[a-2]=arguments[a];var s="undefined"===typeof e,l="undefined"===typeof t;return s&&l&&n?n:i.reduce(function(e,r){return r.apply(void 0,[e,t].concat(o))},s&&!l&&n?n:e)}},i=r(22),o=r.n(i),a=r(43),s=r(66),l=r(84);var u=r(122),c=Object(u.a)(function(e){return(Object(a.a)(e)||Object(s.a)(e))&&!function(e){var t=Object(l.a)(e),r=t.every(function(e){return"next"===e||"throw"===e});return t.length&&t.length<=2&&r}(e)}),h=r(53),p=r(54),f=r(124),d=function(e){return void 0===e},m=function(e){return e.toString()},v=r(46);var g=r(123);function y(e,t,r){void 0===r&&(r={}),o()(Object(a.a)(e)||Object(s.a)(e),"Expected handlers to be a plain object.");var i=c(e,r),u=Object(l.a)(i).map(function(e){return function(e,t,r){void 0===t&&(t=p.a);var n=m(e).split(v.a);o()(!d(r),"defaultState for reducer handling "+n.join(", ")+" should be defined"),o()(Object(h.a)(t)||Object(a.a)(t),"Expected reducer to be a function or object with next and throw reducers");var i=Object(h.a)(t)?[t,t]:[t.next,t.throw].map(function(e){return Object(f.a)(e)?p.a:e}),s=i[0],l=i[1];return function(e,t){void 0===e&&(e=r);var i=t.type;return i&&-1!==n.indexOf(m(i))?(!0===t.error?l:s)(e,t):e}}(e,Object(g.a)(e,i),t)}),y=n.apply(void 0,u.concat([t]));return function(e,r){return void 0===e&&(e=t),y(e,r)}}r.d(t,"a",function(){return y})},function(e,t,r){"use strict";var n=r(1),i=r(5),o=r(0),a=r.n(o),s=(r(13),r(6));var l=a.a.createContext();var u=l,c=r(2),h=r(15),p=r(126);function f(e,t){return parseInt(e[t],10)||0}var d="undefined"!==typeof window?a.a.useLayoutEffect:a.a.useEffect,m={visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0},v=a.a.forwardRef(function(e,t){var r=e.onChange,o=e.rows,s=e.rowsMax,l=e.style,u=e.value,c=Object(i.a)(e,["onChange","rows","rowsMax","style","value"]),v=a.a.useRef(null!=u).current,g=a.a.useRef(null),y=Object(h.c)(t,g),b=a.a.useRef(null),x=a.a.useState({}),w=x[0],S=x[1],M=a.a.useCallback(function(){var t=g.current,r=window.getComputedStyle(t),n=b.current;n.style.width=r.width,n.value=t.value||e.placeholder||"x";var i=r["box-sizing"],a=f(r,"padding-bottom")+f(r,"padding-top"),l=f(r,"border-bottom-width")+f(r,"border-top-width"),u=n.scrollHeight-a;n.value="x";var c=n.scrollHeight-a,h=u;null!=o&&(h=Math.max(Number(o)*c,h)),null!=s&&(h=Math.min(Number(s)*c,h));var p=(h=Math.max(h,c))+("border-box"===i?a+l:0),d=Math.abs(h-u)<=1;S(function(e){return p>0&&Math.abs((e.outerHeightStyle||0)-p)>1||e.overflow!==d?{overflow:d,outerHeightStyle:p}:e})},[S,o,s,e.placeholder]);a.a.useEffect(function(){var e=Object(p.a)(function(){M()});return window.addEventListener("resize",e),function(){e.clear(),window.removeEventListener("resize",e)}},[M]),d(function(){M()});return a.a.createElement(a.a.Fragment,null,a.a.createElement("textarea",Object(n.a)({value:u,onChange:function(e){v||M(),r&&r(e)},ref:y,rows:o||1,style:Object(n.a)({height:w.outerHeightStyle,overflow:w.overflow?"hidden":null},l)},c)),a.a.createElement("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:b,tabIndex:-1,style:Object(n.a)({},m,{},l)}))});function g(e){return null!=e&&!(Array.isArray(e)&&0===e.length)}var y="undefined"===typeof window?a.a.useEffect:a.a.useLayoutEffect,b=a.a.forwardRef(function(e,t){var r=e["aria-describedby"],o=e.autoComplete,c=e.autoFocus,p=e.classes,f=e.className,d=e.defaultValue,m=e.disabled,b=e.endAdornment,x=(e.error,e.fullWidth),w=void 0!==x&&x,S=e.id,M=e.inputComponent,_=void 0===M?"input":M,T=e.inputProps,A=(T=void 0===T?{}:T).className,C=Object(i.a)(T,["className"]),E=e.inputRef,L=(e.margin,e.multiline),N=void 0!==L&&L,P=e.name,O=e.onBlur,R=e.onChange,D=e.onClick,F=e.onFocus,k=e.onKeyDown,I=e.onKeyUp,B=e.placeholder,U=e.readOnly,V=e.renderSuffix,j=e.rows,z=e.rowsMax,G=e.select,W=void 0!==G&&G,H=e.startAdornment,X=e.type,q=void 0===X?"text":X,Y=e.value,K=Object(i.a)(e,["aria-describedby","autoComplete","autoFocus","classes","className","defaultValue","disabled","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","rowsMax","select","startAdornment","type","value"]),Q=a.a.useRef(null!=Y).current,J=a.a.useRef(),Z=a.a.useCallback(function(e){0},[]),$=Object(h.c)(C.ref,Z),ee=Object(h.c)(E,$),te=Object(h.c)(J,ee),re=a.a.useState(!1),ne=re[0],ie=re[1],oe=a.a.useContext(l);var ae=function(e){var t=e.props,r=e.states,n=e.muiFormControl;return r.reduce(function(e,r){return e[r]=t[r],n&&"undefined"===typeof t[r]&&(e[r]=n[r]),e},{})}({props:e,muiFormControl:oe,states:["disabled","error","hiddenLabel","margin","required","filled"]});ae.focused=oe?oe.focused:ne,a.a.useEffect(function(){!oe&&m&&ne&&(ie(!1),O&&O())},[oe,m,ne,O]);var se=oe&&oe.onFilled,le=oe&&oe.onEmpty,ue=a.a.useCallback(function(e){!function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e&&(g(e.value)&&""!==e.value||t&&g(e.defaultValue)&&""!==e.defaultValue)}(e)?le&&le():se&&se()},[se,le]);y(function(){Q&&ue({value:Y})},[Y,ue,Q]);a.a.useEffect(function(){ue(J.current)},[]);var ce=_,he=Object(n.a)({},C,{ref:te});"string"!==typeof ce?he=Object(n.a)({inputRef:te,type:q},he,{ref:null}):N?j&&!z?ce="textarea":(he=Object(n.a)({rows:j,rowsMax:z},he),ce=v):he=Object(n.a)({type:q},he);return a.a.createElement("div",Object(n.a)({className:Object(s.a)(p.root,f,ae.disabled&&p.disabled,ae.error&&p.error,w&&p.fullWidth,ae.focused&&p.focused,oe&&p.formControl,N&&p.multiline,H&&p.adornedStart,b&&p.adornedEnd,{dense:p.marginDense}[ae.margin]),onClick:function(e){J.current&&e.currentTarget===e.target&&J.current.focus(),D&&D(e)},ref:t},K),H,a.a.createElement(u.Provider,{value:null},a.a.createElement(ce,Object(n.a)({"aria-invalid":ae.error,"aria-describedby":r,autoComplete:o,autoFocus:c,className:Object(s.a)(p.input,A,ae.disabled&&p.disabled,N&&p.inputMultiline,W&&p.inputSelect,ae.hiddenLabel&&p.inputHiddenLabel,H&&p.inputAdornedStart,b&&p.inputAdornedEnd,{search:p.inputTypeSearch}[q],{dense:p.inputMarginDense}[ae.margin]),defaultValue:d,disabled:ae.disabled,id:S,onAnimationStart:function(){ue({value:"x"})},name:P,onBlur:function(e){O&&O(e),oe&&oe.onBlur?oe.onBlur(e):ie(!1)},onChange:function(e){if(!Q){var t=e.target||J.current;if(null==t)throw new TypeError("Material-UI: Expected valid input target. Did you use a custom `inputComponent` and forget to forward refs? See https://material-ui.com/r/input-component-ref-interface for more info.");ue({value:t.value})}if(R){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];R.apply(void 0,[e].concat(n))}},onFocus:function(e){ae.disabled?e.stopPropagation():(F&&F(e),oe&&oe.onFocus?oe.onFocus(e):ie(!0))},onKeyDown:k,onKeyUp:I,placeholder:B,readOnly:U,required:ae.required,rows:j,value:Y},he))),b,V?V(Object(n.a)({},ae,{startAdornment:H})):null)}),x=Object(c.a)(function(e){var t="light"===e.palette.type,r={color:"currentColor",opacity:t?.42:.5,transition:e.transitions.create("opacity",{duration:e.transitions.duration.shorter})},n={opacity:"0 !important"},i={opacity:t?.42:.5};return{root:{fontFamily:e.typography.fontFamily,color:e.palette.text.primary,fontSize:e.typography.pxToRem(16),lineHeight:"1.1875em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center","&$disabled":{color:e.palette.text.disabled,cursor:"default"}},formControl:{},focused:{},disabled:{},adornedStart:{},adornedEnd:{},error:{},marginDense:{},multiline:{padding:"".concat(6,"px 0 ").concat(7,"px"),"&$marginDense":{paddingTop:3}},fullWidth:{width:"100%"},input:{font:"inherit",color:"currentColor",padding:"".concat(6,"px 0 ").concat(7,"px"),border:0,boxSizing:"content-box",background:"none",height:"1.1875em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%","&::-webkit-input-placeholder":r,"&::-moz-placeholder":r,"&:-ms-input-placeholder":r,"&::-ms-input-placeholder":r,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{"-webkit-appearance":"none"},"label[data-shrink=false] + $formControl &":{"&::-webkit-input-placeholder":n,"&::-moz-placeholder":n,"&:-ms-input-placeholder":n,"&::-ms-input-placeholder":n,"&:focus::-webkit-input-placeholder":i,"&:focus::-moz-placeholder":i,"&:focus:-ms-input-placeholder":i,"&:focus::-ms-input-placeholder":i},"&$disabled":{opacity:1},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"$auto-fill"}},"@keyframes auto-fill":{from:{}},inputMarginDense:{paddingTop:3},inputSelect:{paddingRight:24},inputMultiline:{height:"auto",resize:"none",padding:0},inputTypeSearch:{"-moz-appearance":"textfield","-webkit-appearance":"textfield"},inputAdornedStart:{},inputAdornedEnd:{},inputHiddenLabel:{}}},{name:"MuiInputBase"})(b),w=a.a.forwardRef(function(e,t){var r=e.disableUnderline,o=e.classes,l=e.fullWidth,u=void 0!==l&&l,c=e.inputComponent,h=void 0===c?"input":c,p=e.multiline,f=void 0!==p&&p,d=e.type,m=void 0===d?"text":d,v=Object(i.a)(e,["disableUnderline","classes","fullWidth","inputComponent","multiline","type"]);return a.a.createElement(x,Object(n.a)({classes:Object(n.a)({},o,{root:Object(s.a)(o.root,!r&&o.underline),underline:null}),fullWidth:u,inputComponent:h,multiline:f,ref:t,type:m},v))});w.muiName="Input";t.a=Object(c.a)(function(e){var t="light"===e.palette.type,r=t?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return{root:{position:"relative"},formControl:{"label + &":{marginTop:16}},focused:{},disabled:{},underline:{"&:after":{borderBottom:"2px solid ".concat(e.palette.primary[t?"dark":"light"]),left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},"&$focused:after":{transform:"scaleX(1)"},"&$error:after":{borderBottomColor:e.palette.error.main,transform:"scaleX(1)"},"&:before":{borderBottom:"1px solid ".concat(r),left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},"&:hover:not($disabled):before":{borderBottom:"2px solid ".concat(e.palette.text.primary),"@media (hover: none)":{borderBottom:"1px solid ".concat(r)}},"&$disabled:before":{borderBottomStyle:"dotted"}},error:{},multiline:{},fullWidth:{},input:{},inputMarginDense:{},inputMultiline:{},inputTypeSearch:{}}},{name:"MuiInput"})(w)},function(e,t,r){"use strict";var n=r(5),i=r(29),o=r(1),a=r(0),s=r.n(a),l=(r(13),r(6)),u=r(2),c=r(26),h=r(8),p=r.n(h),f=r(45),d=r(15),m=r(42);function v(e){return e.substring(2).toLowerCase()}var g=s.a.forwardRef(function(e,t){var r=e.children,n=e.mouseEvent,i=void 0===n?"onClick":n,o=e.touchEvent,a=void 0===o?"onTouchEnd":o,l=e.onClickAway,u=function(){var e=s.a.useRef(!1);return s.a.useEffect(function(){return e.current=!0,function(){e.current=!1}},[]),e}(),c=s.a.useRef(!1),h=s.a.useRef(null),g=Object(d.c)(h,t),y=s.a.useCallback(function(e){Object(d.b)(g,p.a.findDOMNode(e))},[g]),b=Object(d.c)(r.ref,y),x=Object(m.a)(function(e){if(!e.defaultPrevented&&u.current)if(c.current)c.current=!1;else{var t=h.current;if(t){var r=Object(f.a)(t);r.documentElement&&r.documentElement.contains(e.target)&&!t.contains(e.target)&&l(e)}}}),w=s.a.useCallback(function(){c.current=!0},[]);return s.a.useEffect(function(){if(!1!==a){var e=v(a);return document.addEventListener(e,x),document.addEventListener("touchmove",w),function(){document.removeEventListener(e,x),document.removeEventListener("touchmove",w)}}},[x,w,a]),s.a.useEffect(function(){if(!1!==i){var e=v(i);return document.addEventListener(e,x),function(){document.removeEventListener(e,x)}}},[x,i]),s.a.createElement(s.a.Fragment,null,s.a.cloneElement(r,{ref:b}))}),y=r(21),b=r(537),x=r(51),w=r(33);function S(e){return"scale(".concat(e,", ").concat(Math.pow(e,2),")")}var M={entering:{opacity:1,transform:S(1)},entered:{opacity:1,transform:"none"}},_=s.a.forwardRef(function(e,t){var r=e.children,i=e.in,a=e.onEnter,l=e.onExit,u=e.style,c=e.timeout,h=void 0===c?"auto":c,p=Object(n.a)(e,["children","in","onEnter","onExit","style","timeout"]),f=s.a.useRef(),m=s.a.useRef(),v=Object(d.c)(r.ref,t),g=Object(x.a)();return s.a.useEffect(function(){return function(){clearTimeout(f.current)}},[]),s.a.createElement(b.a,Object(o.a)({appear:!0,in:i,onEnter:function(e,t){Object(w.b)(e);var r,n=Object(w.a)({style:u,timeout:h},{mode:"enter"}),i=n.duration,o=n.delay;"auto"===h?(r=g.transitions.getAutoHeightDuration(e.clientHeight),m.current=r):r=i,e.style.transition=[g.transitions.create("opacity",{duration:r,delay:o}),g.transitions.create("transform",{duration:.666*r,delay:o})].join(","),a&&a(e,t)},onExit:function(e){var t,r=Object(w.a)({style:u,timeout:h},{mode:"exit"}),n=r.duration,i=r.delay;"auto"===h?(t=g.transitions.getAutoHeightDuration(e.clientHeight),m.current=t):t=n,e.style.transition=[g.transitions.create("opacity",{duration:t,delay:i}),g.transitions.create("transform",{duration:.666*t,delay:i||.333*t})].join(","),e.style.opacity="0",e.style.transform=S(.75),l&&l(e)},addEndListener:function(e,t){"auto"===h&&(f.current=setTimeout(t,m.current||0))},timeout:"auto"===h?null:h},p),function(e,t){return s.a.cloneElement(r,Object(o.a)({style:Object(o.a)({opacity:0,transform:S(.75),visibility:"exited"!==e||i?void 0:"hidden"},M[e],{},u,{},r.props.style),ref:v},t))})});_.muiSupportAuto=!0;var T=_,A=r(528),C=r(523),E=r(34),L=s.a.forwardRef(function(e,t){var r=e.action,i=e.classes,a=e.className,u=e.message,c=Object(n.a)(e,["action","classes","className","message"]);return s.a.createElement(A.a,Object(o.a)({component:C.a,variant:"body2",variantMapping:{body1:"div",body2:"div"},role:"alertdialog",square:!0,elevation:6,className:Object(l.a)(i.root,a),ref:t},c),s.a.createElement("div",{className:i.message},u),r?s.a.createElement("div",{className:i.action},r):null)}),N=Object(u.a)(function(e){var t="light"===e.palette.type?.8:.98,r=Object(E.b)(e.palette.background.default,t);return{root:Object(i.a)({color:e.palette.getContrastText(r),backgroundColor:r,display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",borderRadius:e.shape.borderRadius,flexGrow:1},e.breakpoints.up("sm"),{flexGrow:"initial",minWidth:288}),message:{padding:"8px 0"},action:{display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}}},{name:"MuiSnackbarContent"})(L),P=s.a.forwardRef(function(e,t){var r=e.action,i=e.anchorOrigin,a=(i=void 0===i?{vertical:"bottom",horizontal:"center"}:i).vertical,u=i.horizontal,h=e.autoHideDuration,p=e.children,f=e.classes,d=e.className,m=e.ClickAwayListenerProps,v=e.ContentProps,b=e.disableWindowBlurListener,x=void 0!==b&&b,w=e.message,S=e.onClose,M=e.onEnter,_=e.onEntered,A=e.onEntering,C=e.onExit,E=e.onExited,L=e.onExiting,P=e.onMouseEnter,O=e.onMouseLeave,R=e.open,D=e.resumeHideDuration,F=e.TransitionComponent,k=void 0===F?T:F,I=e.transitionDuration,B=void 0===I?{enter:c.b.enteringScreen,exit:c.b.leavingScreen}:I,U=e.TransitionProps,V=Object(n.a)(e,["action","anchorOrigin","autoHideDuration","children","classes","className","ClickAwayListenerProps","ContentProps","disableWindowBlurListener","message","onClose","onEnter","onEntered","onEntering","onExit","onExited","onExiting","onMouseEnter","onMouseLeave","open","resumeHideDuration","TransitionComponent","transitionDuration","TransitionProps"]),j=s.a.useRef(),z=s.a.useState(!0),G=z[0],W=z[1],H=s.a.useCallback(function(e){var t=null!=e?e:h;S&&null!=t&&(clearTimeout(j.current),j.current=setTimeout(function(){S&&null!=(null!=e?e:h)&&S(null,"timeout")},t))},[h,S]);s.a.useEffect(function(){return R&&H(),function(){clearTimeout(j.current)}},[R,H]);var X=function(){clearTimeout(j.current)},q=s.a.useCallback(function(){if(null!=h){if(null!=D)return void H(D);H(.5*h)}},[h,D,H]);return s.a.useEffect(function(){if(!x&&R)return window.addEventListener("focus",q),window.addEventListener("blur",X),function(){window.removeEventListener("focus",q),window.removeEventListener("blur",X)}},[x,q,R]),!R&&G?null:s.a.createElement(g,Object(o.a)({onClickAway:function(e){S&&S(e,"clickaway")}},m),s.a.createElement("div",Object(o.a)({className:Object(l.a)(f.root,f["anchorOrigin".concat(Object(y.a)(a)).concat(Object(y.a)(u))],d),onMouseEnter:function(e){P&&P(e),X()},onMouseLeave:function(e){O&&O(e),q()},ref:t},V),s.a.createElement(k,Object(o.a)({appear:!0,in:R,onEnter:Object(y.b)(function(){W(!1)},M),onEntered:_,onEntering:A,onExit:C,onExited:Object(y.b)(function(){W(!0)},E),onExiting:L,timeout:B,direction:"top"===a?"down":"up"},U),p||s.a.createElement(N,Object(o.a)({message:w,action:r},v)))))});t.a=Object(u.a)(function(e){var t={top:8},r={bottom:8},n={justifyContent:"flex-end"},a={justifyContent:"flex-start"},s={top:24},l={bottom:24},u={right:24},c={left:24},h={left:"50%",right:"auto",transform:"translateX(-50%)"};return{root:{zIndex:e.zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center"},anchorOriginTopCenter:Object(o.a)({},t,Object(i.a)({},e.breakpoints.up("sm"),Object(o.a)({},s,{},h))),anchorOriginBottomCenter:Object(o.a)({},r,Object(i.a)({},e.breakpoints.up("sm"),Object(o.a)({},l,{},h))),anchorOriginTopRight:Object(o.a)({},t,{},n,Object(i.a)({},e.breakpoints.up("sm"),Object(o.a)({left:"auto"},s,{},u))),anchorOriginBottomRight:Object(o.a)({},r,{},n,Object(i.a)({},e.breakpoints.up("sm"),Object(o.a)({left:"auto"},l,{},u))),anchorOriginTopLeft:Object(o.a)({},t,{},a,Object(i.a)({},e.breakpoints.up("sm"),Object(o.a)({right:"auto"},s,{},c))),anchorOriginBottomLeft:Object(o.a)({},r,{},a,Object(i.a)({},e.breakpoints.up("sm"),Object(o.a)({right:"auto"},l,{},c)))}},{flip:!1,name:"MuiSnackbar"})(P)},function(e,t,r){"use strict";var n=r(1),i=r(0),o=r.n(i),a=(r(13),r(530)),s=r(86);var l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(a.a)(e,Object(n.a)({defaultTheme:s.a},t))}(function(e){return{"@global":{html:{WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box"},"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:"bolder"},body:Object(n.a)({margin:0,color:e.palette.text.primary},e.typography.body2,{backgroundColor:e.palette.background.default,"@media print":{backgroundColor:e.palette.common.white},"&::backdrop":{backgroundColor:e.palette.background.default}})}}},{name:"MuiCssBaseline"});t.a=function(e){var t=e.children,r=void 0===t?null:t;return l(),o.a.createElement(o.a.Fragment,null,r)}},function(e,t,r){"use strict";var n=r(9),i=r(57),o=(r(7),r(0)),a=r.n(o),s=r(8),l=r.n(s),u=!1,c=r(77),h="unmounted",p="exited",f="entering",d="entered",m=function(e){function t(t,r){var n;n=e.call(this,t,r)||this;var i,o=r&&!r.isMounting?t.enter:t.appear;return n.appearStatus=null,t.in?o?(i=p,n.appearStatus=f):i=d:i=t.unmountOnExit||t.mountOnEnter?h:p,n.state={status:i},n.nextCallback=null,n}Object(i.a)(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===h?{status:p}:null};var r=t.prototype;return r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(e){var t=null;if(e!==this.props){var r=this.state.status;this.props.in?r!==f&&r!==d&&(t=f):r!==f&&r!==d||(t="exiting")}this.updateStatus(!1,t)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var e,t,r,n=this.props.timeout;return e=t=r=n,null!=n&&"number"!==typeof n&&(e=n.exit,t=n.enter,r=void 0!==n.appear?n.appear:t),{exit:e,enter:t,appear:r}},r.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t){this.cancelNextCallback();var r=l.a.findDOMNode(this);t===f?this.performEnter(r,e):this.performExit(r)}else this.props.unmountOnExit&&this.state.status===p&&this.setState({status:h})},r.performEnter=function(e,t){var r=this,n=this.props.enter,i=this.context?this.context.isMounting:t,o=this.getTimeouts(),a=i?o.appear:o.enter;!t&&!n||u?this.safeSetState({status:d},function(){r.props.onEntered(e)}):(this.props.onEnter(e,i),this.safeSetState({status:f},function(){r.props.onEntering(e,i),r.onTransitionEnd(e,a,function(){r.safeSetState({status:d},function(){r.props.onEntered(e,i)})})}))},r.performExit=function(e){var t=this,r=this.props.exit,n=this.getTimeouts();r&&!u?(this.props.onExit(e),this.safeSetState({status:"exiting"},function(){t.props.onExiting(e),t.onTransitionEnd(e,n.exit,function(){t.safeSetState({status:p},function(){t.props.onExited(e)})})})):this.safeSetState({status:p},function(){t.props.onExited(e)})},r.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},r.setNextCallback=function(e){var t=this,r=!0;return this.nextCallback=function(n){r&&(r=!1,t.nextCallback=null,e(n))},this.nextCallback.cancel=function(){r=!1},this.nextCallback},r.onTransitionEnd=function(e,t,r){this.setNextCallback(r);var n=null==t&&!this.props.addEndListener;e&&!n?(this.props.addEndListener&&this.props.addEndListener(e,this.nextCallback),null!=t&&setTimeout(this.nextCallback,t)):setTimeout(this.nextCallback,0)},r.render=function(){var e=this.state.status;if(e===h)return null;var t=this.props,r=t.children,i=Object(n.a)(t,["children"]);if(delete i.in,delete i.mountOnEnter,delete i.unmountOnExit,delete i.appear,delete i.enter,delete i.exit,delete i.timeout,delete i.addEndListener,delete i.onEnter,delete i.onEntering,delete i.onEntered,delete i.onExit,delete i.onExiting,delete i.onExited,"function"===typeof r)return a.a.createElement(c.a.Provider,{value:null},r(e,i));var o=a.a.Children.only(r);return a.a.createElement(c.a.Provider,{value:null},a.a.cloneElement(o,i))},t}(a.a.Component);function v(){}m.contextType=c.a,m.propTypes={},m.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:v,onEntering:v,onEntered:v,onExit:v,onExiting:v,onExited:v},m.UNMOUNTED=0,m.EXITED=1,m.ENTERING=2,m.ENTERED=3,m.EXITING=4;t.a=m},function(e,t,r){"use strict";var n=r(71),i=r.n(n),o=r(22),a=r.n(o),s=r(0),l=r.n(s),u=r(7),c=r.n(u),h=r(226),p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var d=function(e){return 0===l.a.Children.count(e)},m=function(e){function t(){var r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return r=n=f(this,e.call.apply(e,[this].concat(o))),n.state={match:n.computeMatch(n.props,n.context.router)},f(n,r)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getChildContext=function(){return{router:p({},this.context.router,{route:{location:this.props.location||this.context.router.route.location,match:this.state.match}})}},t.prototype.computeMatch=function(e,t){var r=e.computedMatch,n=e.location,i=e.path,o=e.strict,s=e.exact,l=e.sensitive;if(r)return r;a()(t,"You should not use <Route> or withRouter() outside a <Router>");var u=t.route,c=(n||u.location).pathname;return Object(h.a)(c,{path:i,strict:o,exact:s,sensitive:l},u.match)},t.prototype.componentWillMount=function(){i()(!(this.props.component&&this.props.render),"You should not use <Route component> and <Route render> in the same route; <Route render> will be ignored"),i()(!(this.props.component&&this.props.children&&!d(this.props.children)),"You should not use <Route component> and <Route children> in the same route; <Route children> will be ignored"),i()(!(this.props.render&&this.props.children&&!d(this.props.children)),"You should not use <Route render> and <Route children> in the same route; <Route children> will be ignored")},t.prototype.componentWillReceiveProps=function(e,t){i()(!(e.location&&!this.props.location),'<Route> elements should not change from uncontrolled to controlled (or vice versa). You initially used no "location" prop and then provided one on a subsequent render.'),i()(!(!e.location&&this.props.location),'<Route> elements should not change from controlled to uncontrolled (or vice versa). You provided a "location" prop initially but omitted it on a subsequent render.'),this.setState({match:this.computeMatch(e,t.router)})},t.prototype.render=function(){var e=this.state.match,t=this.props,r=t.children,n=t.component,i=t.render,o=this.context.router,a=o.history,s=o.route,u=o.staticContext,c={match:e,location:this.props.location||s.location,history:a,staticContext:u};return n?e?l.a.createElement(n,c):null:i?e?i(c):null:"function"===typeof r?r(c):r&&!d(r)?l.a.Children.only(r):null},t}(l.a.Component);m.propTypes={computedMatch:c.a.object,path:c.a.string,exact:c.a.bool,strict:c.a.bool,sensitive:c.a.bool,component:c.a.func,render:c.a.func,children:c.a.oneOfType([c.a.func,c.a.node]),location:c.a.object},m.contextTypes={router:c.a.shape({history:c.a.object.isRequired,route:c.a.object.isRequired,staticContext:c.a.object})},m.childContextTypes={router:c.a.object.isRequired};var v=m;t.a=v},function(e,t,r){"use strict";var n=r(0),i=r.n(n),o=i.a.createContext(null);function a(){return i.a.useContext(o)}r.d(t,"a",function(){return a})}]]);
//# sourceMappingURL=1.ac625d41.chunk.js.map